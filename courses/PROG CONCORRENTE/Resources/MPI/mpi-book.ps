%!PS-Adobe-2.0
%%Creator: dvipsk 5.58c Copyright 1986, 1994 Radical Eye Software
%%Title: book.dvi
%%Pages: 350
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%EndComments
%DVIPSCommandLine: dvips -o book.ps book
%DVIPSParameters: dpi=300, compressed, comments removed
%DVIPSSource:  TeX output 1995.08.28:1547
%%BeginProcSet: texc.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]/id ch-image N /rw ch-width 7 add 8 idiv string N /rc 0 N /gp 0 N
/cp 0 N{rc 0 ne{rc 1 sub /rc X rw}{G}ifelse}imagemask restore}B /G{{id
gp get /gp gp 1 add N dup 18 mod S 18 idiv pl S get exec}loop}B /adv{cp
add /cp X}B /chg{rw cp id gp 4 index getinterval putinterval dup gp add
/gp X adv}B /nd{/cp 0 N rw exit}B /lsh{rw cp 2 copy get dup 0 eq{pop 1}{
dup 255 eq{pop 254}{dup dup add 255 and S 1 and or}ifelse}ifelse put 1
adv}B /rsh{rw cp 2 copy get dup 0 eq{pop 128}{dup 255 eq{pop 127}{dup 2
idiv S 128 and or}ifelse}ifelse put 1 adv}B /clr{rw cp 2 index string
putinterval adv}B /set{rw cp fillstr 0 4 index getinterval putinterval
adv}B /fillstr 18 string 0 1 17{2 copy 255 put pop}for N /pl[{adv 1 chg}
{adv 1 chg nd}{1 add chg}{1 add chg nd}{adv lsh}{adv lsh nd}{adv rsh}{
adv rsh nd}{1 add adv}{/rc X nd}{1 add set}{1 add clr}{adv 2 chg}{adv 2
chg nd}{pop nd}]dup{bind pop}forall N /D{/cc X dup type /stringtype ne{]
}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
%%BeginProcSet: special.pro
TeXDict begin /SDict 200 dict N SDict begin /@SpecialDefaults{/hs 612 N
/vs 792 N /ho 0 N /vo 0 N /hsc 1 N /vsc 1 N /ang 0 N /CLIP 0 N /rwiSeen
false N /rhiSeen false N /letter{}N /note{}N /a4{}N /legal{}N}B
/@scaleunit 100 N /@hscale{@scaleunit div /hsc X}B /@vscale{@scaleunit
div /vsc X}B /@hsize{/hs X /CLIP 1 N}B /@vsize{/vs X /CLIP 1 N}B /@clip{
/CLIP 2 N}B /@hoffset{/ho X}B /@voffset{/vo X}B /@angle{/ang X}B /@rwi{
10 div /rwi X /rwiSeen true N}B /@rhi{10 div /rhi X /rhiSeen true N}B
/@llx{/llx X}B /@lly{/lly X}B /@urx{/urx X}B /@ury{/ury X}B /magscale
true def end /@MacSetUp{userdict /md known{userdict /md get type
/dicttype eq{userdict begin md length 10 add md maxlength ge{/md md dup
length 20 add dict copy def}if end md begin /letter{}N /note{}N /legal{}
N /od{txpose 1 0 mtx defaultmatrix dtransform S atan/pa X newpath
clippath mark{transform{itransform moveto}}{transform{itransform lineto}
}{6 -2 roll transform 6 -2 roll transform 6 -2 roll transform{
itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll curveto}}{{
closepath}}pathforall newpath counttomark array astore /gc xdf pop ct 39
0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}if}N
/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1 -1
scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3 get
ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip yflip
not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub neg 0
TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{noflips{TR
pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop 90 rotate 1
-1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg
TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr 1 get neg
sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr 2 get ppr
0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4 -1 roll add
2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S TR}if}N /cp
{pop pop showpage pm restore}N end}if}if}N /normalscale{Resolution 72
div VResolution 72 div neg scale magscale{DVImag dup scale}if 0 setgray}
N /psfts{S 65781.76 div N}N /startTexFig{/psf$SavedState save N userdict
maxlength dict begin /magscale true def normalscale currentpoint TR
/psf$ury psfts /psf$urx psfts /psf$lly psfts /psf$llx psfts /psf$y psfts
/psf$x psfts currentpoint /psf$cy X /psf$cx X /psf$sx psf$x psf$urx
psf$llx sub div N /psf$sy psf$y psf$ury psf$lly sub div N psf$sx psf$sy
scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub TR
/showpage{}N /erasepage{}N /copypage{}N /p 3 def @MacSetUp}N /doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N /endTexFig{end psf$SavedState restore}N /@beginspecial{SDict
begin /SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count /ocount X /dcount countdictstack N}N /@setspecial
{CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if /showpage{}N /erasepage{}N /copypage{}N newpath
}N /@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{
end}repeat grestore SpecialSave restore end}N /@defspecial{SDict begin}
N /@fedspecial{end}B /li{lineto}B /rl{rlineto}B /rc{rcurveto}B /np{
/SaveX currentpoint /SaveY X N 1 setlinecap newpath}N /st{stroke SaveX
SaveY moveto}N /fil{fill SaveX SaveY moveto}N /ellipse{/endangle X
/startangle X /yrad X /xrad X /savematrix matrix currentmatrix N TR xrad
yrad scale 0 0 1 startangle endangle arc savematrix setmatrix}N end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300 (book.dvi)
@start /Fa 58 122 df<EB07F0EB1818EB3038EB2030EB6000A45B3807FFE03800C060
A3380180C0A4EB818038030190A314A0EB00E000061300A2126612E45A1270151D819614
>12 D<12381278A2123812081210A2122012401280050A79960B>39
D<1310132013401380EA01005A12061204120C1208121812101230A212201260A3124012
C0AA1240A27EA27E0C227B980F>I<13801340A21320A21330AA13201360A3134013C0A2
1380120113005A120212065A12085A5A5A5A0C227F980F>I<1218123812781238120812
10A2122012401280050A7E830B>44 D<12FF12FE08027D870D>I<1230127812F0126005
047D830B>I<EA01E0EA0630EA0C10121812101230A2EA6030A4EAC060A3134013C0EA80
801281EAC1001246123C0C157B9412>48 D<134013C0A2EA0380121D1201A2EA0300A412
06A45AA45AEAFF800A157C9412>I<13F0EA0308EA040CEA090413061211A2EA220C1224
EA1818EA0030136013C0EA030012041218EA2004130CEA7C18EAC7F0EA81E00F157D9412
>I<13F8EA010CEA020612051209A2EA0A04EA0E0CEA00181370EA03E0EA00301310A213
18EA603012E0EAC020EA8060EA4180EA3F000F157D9412>I<EA060CEA07F813F0EA0880
1300A35AEA1780EA18601210EA0070A31260EAF0E012E0EA80C0EA8180EA4300123C0E15
7C9412>53 D<13F0EA03081206EA0C381218EA10001230A2EA6780EA68C0EA7040EAE060
12C0A313C0A21380EAC1001242123C0D157B9412>I<13F8EA010CEA06061204120CA2EA
0E0CEA0F18EA07B0EA03C0EA07F0EA0CF8EA3078EA601CA2EAC018A21310EA6020EA30C0
EA1F000F157D9412>56 D<13E0EA0310EA0608120C1218A213181230A213381210EA18F0
EA073012001360A2EAE0C01380EA8100128612780D157C9412>I<120C121EA2120C1200
A61230127812F01260070E7D8D0B>I<EB0180A21303A21307A2130B1313A2EB21C0A213
411381A2EA010113FFEA0201A212041208A2001813E038FE07F815177E961A>65
D<3803FFF03800E038141C140CA2EA01C0141CA2143838038070EBFFC014E0EB80703807
00301438A3000E1370A214E0EB01C0381C038038FFFE0016177E9619>I<EB3F04EBE088
38038058380600385A001C13105A123012700060130012E0A35A1440A214807EEB0100EA
60026C5AEA1818EA07E016177A961A>I<3803FFF03800E018140C140614073801C003A4
38038007A43807000EA2140C141C000E13181430146014C0381C038038FFFC0018177E96
1B>I<3803FFFE3800E00E1404A3EA01C0A21480A238038100138313FF1383EA07021408
A2EB0010120E143014201460381C01C0B5FC17177E9618>I<3803FFFE3800E00E1404A3
EA01C0A21480A238038100138313FF1383EA0702A390C7FC120EA45AEAFFC017177E9617
>I<EB3F04EBE08838038058380600385A001C13105A123012700060130012E0A338C01F
F8EB01C0A338E00380A21260EA300738181B00EA07E116177A961C>I<3903FE3FE03900
E00E00A448485AA448485AA2EBFFF8EB803848485AA4000E5BA448485A38FF8FF81B177E
961A>I<EA07FEEA00E0A4EA01C0A4EA0380A4EA0700A4120EA45AEAFF800F177E960E>I<
EB7FC0EB0E00A45BA45BA45BA4EA60E012F0A2EAE1C0EA4380003EC7FC12177D9613>I<
EA03FEEA00E0A4485AA4485AA448C7FC1420A21440120E14C014801301EA1C07B5120013
177E9616>76 D<D803F0EB3F800000EC780013B815B8EC0138D801385B1402A214040002
495A131C1410A20004EB21C01441A2148139081D0380A2130EA226180C07C7FC39FE083F
E021177E9620>I<3903F00FE00000EB0300140213B8A238011C04A3130E00025BA21307
A238040390A3EB01D0000813E01300A30018134012FE1B177E961A>I<EB1F80EBE0C038
01806038030030000613385A001C131812180038133812301270A314705A14E012603870
01C0EB038000301300EA380EEA1C18EA07E015177B961B>I<3803FFE03800E038141C14
0CA23801C01CA314383803807014E0EBFF80EB800048C7FCA4120EA45AB47E16177E9618
>I<EB7C4038018280EA03011206A2000C1300A2000EC7FCA2EA0FC0EA07F86C7EEA007C
130EA213061220485AA2EA60085BEAD860EA87C012177D9614>83
D<381FFFFC3838381C00201308126012401370128000001300A25BA4485AA4485AA448C7
FCEA7FF016177A961A>I<387FC1FC381C00601440A3481380A438700100A4EAE002A45B
5BA2EA6030EA3040EA1F80161779961A>I<38FF80FC381C0070146014401480A2EB0100
1302A2EA1E04120E5B5BA25BA25B5B120F6CC7FCA212061204161779961A>I<EA0390EA
0C701218EA303013601260A3EAC0C013C812401241EA62D0EA1C700D0E7C8D12>97
D<127C1218A45AA4EA6780EA68C0EA7040EA606012C0A4EA80C0A2EA8180EAC100124612
3C0B177C9610>I<EA07C0EA0C60EA30E01220EA60005AA35AA2EAC0201340EA6180EA3E
000B0E7C8D10>I<133E130CA41318A4EA03B0EA0C701218EA303013601260A3EAC0C013
C812401241EA62D0EA1C700F177C9612>I<EA0780EA1840EA302012601340EAFF80EAC0
00A413201340EA6180EA3E000B0E7C8D10>I<131C1336133E136C1360A313C0A2EA07F8
EA00C0A3EA0180A5EA0300A412021206A2126612E45A12700F1D81960B>I<EA01C4EA06
3CEA0C1C121813181230A3EA2030A3EA3070EA11E0EA0E601200A2EA60C012E0EAC380EA
7E000E147E8D10>I<121F1206A45AA4EA19E0EA1A30EA1C101218EA3030A4EA60601364
13C413C8EAC04813700E177D9612>I<1203120712061200A61218122C124CA2128C1218
A312301232126212641224123808177D960B>I<121F1206A45AA4EA1838134C139CEA19
18EA3200123C123FEA3180EA60C013C8A3EAC0D013600E177E9610>107
D<123E120CA41218A41230A41260A412C012C8A312D0126007177D9609>I<3830783C38
498CC6384E0502EA4C06389C0E06EA180CA348485A15801418A23960300900140E190E7D
8D1D>I<EA3078EA498CEA4E04124CEA9C0C1218A3EA301813191331A2EA6012131C100E
7D8D14>I<EA0780EA18C0EA3040EA6060A212C0A3EA80C0A2EA8180EAC1001246123C0B
0E7B8D12>I<EA0C38EA12C4EA1306A212261206A3EA0C0CA213181310EA1A20EA19C0EA
1800A25AA312FC0F147F8D12>I<EA30F0EA4B18EA4E38EA4C30EA98001218A35AA45AA2
0D0E7D8D0F>114 D<EA0780EA0C40EA18E0A2EA3800121EEA1F80EA07C01200126012E0
EAC180EAC300123E0B0E7D8D0F>I<1206A25AA4EAFF80EA1800A35AA45A1261A2126212
64123809147D930C>I<EA3804EA2C0C124CA2EA8C181218A3EA30301332A21372EA18B4
EA0F1C0F0E7D8D13>I<EA3810EA2C18124CA2EA8C101218A3EA3020A21340A2EA1880EA
0F000D0E7D8D10>I<38380410384C0C18A3388C18101218A338303020A3001013403818
588038078F00150E7D8D18>I<EA0E3CEA1346EA218E138CEA43001203A31206130812C6
EAE610EACA20EA71C00F0E7E8D10>I<EA3804EA2C0C124CA2EA8C181218A3EA3030A313
70EA18E0EA0F60120013C012E0EAE180EA4300123C0E147D8D11>I
E /Fb 2 63 df<140E143C14F0EB03C0EB0F00133C13F0EA03C0000FC7FC123C12F0A212
3C120FEA03C0EA00F0133C130FEB03C0EB00F0143C140E17167D931E>60
D<12E01278121EEA0780EA01E0EA0078131EEB0780EB01E0EB0078141EA21478EB01E0EB
0780EB1E001378EA01E0EA0780001EC7FC127812E017167D931E>62
D E /Fc 16 118 df<127012F812FCA2127C120C1218123012E012C0060A798414>44
D<EA1FC0EA7FF0EA7078EA2018EA001CA2EA07FC121FEA3C1C127012E0A3EA707C383FFF
80EA0F8F11107E8F14>97 D<EA03F8EA0FFEEA1C0EEA3804EA7000126012E0A412601270
EA380EEA1C1EEA0FFCEA03F00F107E8F14>99 D<137EA2130EA5EA07CEEA0FFEEA1C3EEA
301EEA700E12E0A61270EA301EEA383E381FEFC0EA07CF12177F9614>I<EA07E0EA0FF0
EA1C38EA301CEA700CEAE00EA2EAFFFEA2EAE00012601270EA380EEA1C1EEA0FFCEA03F0
0F107E8F14>I<13FCEA01FEEA038EEA07041300A3EA7FFE12FFEA0700ACEAFFF8A20F17
7F9614>I<1206120FA21206C7FCA4B4FCA21207ACEAFFF8A20D187C9714>105
D<EAFF80A21203B3EAFFFEA20F177E9614>108 D<EAFB8EEAFFDF383CF380A2EA38E3AA
38FEFBE013791310808F14>I<EAFC78EAFDFEEA1F86EA1E07121CAA38FF8FE0A2131080
8F14>I<EA07C0EA1FF0EA3C78EA701CA2EAE00EA6EA701CEA783CEA3C78EA1FF0EA07C0
0F107E8F14>I<EAFCF8EAFDFEEA1F07EA1E03001C1380EB01C0A6EB0380001E1300EA1F
0EEA1DFCEA1CF890C7FCA6B47EA21218808F14>I<EAFE1FEB7F80EA0EE3380F810090C7
FCA2120EA8EAFFF0A211107F8F14>114 D<EA0FD8EA3FF8EA603812C0A2EAF000EA7F80
EA3FF0EA07F8EA001CEA600612E012F0EAF81CEAFFF8EACFE00F107E8F14>I<1206120E
A4EA7FFC12FFEA0E00A8130EA3131CEA07F8EA01F00F157F9414>I<EAFC3FA2EA1C07AB
131F380FFFE0EA03E71310808F14>I E /Fd 2 50 df<121FEA3180EA60C0EA4040EAC0
60A8EA4040EA60C0EA3180EA1F000B107F8F0F>48 D<1218127812981218AC12FF08107D
8F0F>I E /Fe 1 66 df<14C0A21301A21303130514E01308131813101320A213401380
A23801FFF0EB007012025AA25A121838FE03FE17177F961A>65 D
E /Ff 1 1 df<EAFFFEA20F027D8516>0 D E /Fg 2 50 df<121EEA61801240EAC0C0A7
EA40801261EA1E000A0D7E8C0E>48 D<121812F81218AA12FF080D7D8C0E>I
E /Fh 1 106 df<1208A21200A41270129812B01230A21260126412681270060F7D8E0B>
105 D E /Fi 12 93 df<1430146014C0EB0180EB03005B130E130C5B1338133013705B
5B12015B1203A290C7FC5A1206120EA2120C121CA312181238A45AA75AB3A31270A77EA4
1218121CA3120C120EA2120612077E7FA212017F12007F13701330133813187F130E7F7F
EB0180EB00C014601430146377811F>18 D<12C012607E7E7E120E7E7E6C7E7F12007F13
70133013381318131CA2130C130E13061307A27F1480A3130114C0A4EB00E0A71470B3A3
14E0A7EB01C0A414801303A314005BA21306130E130C131CA213181338133013705B5B12
015B48C7FC5A120E120C5A5A5A5A14637F811F>I<12E0B3B3B3B3B3A6EAFFF8A30D6376
8118>22 D<1338B3B3B3B3B3A6EAFFF8A30D63808118>I<1470EB01F0EB03C0EB0780EB
0E005B5B5BA213F05BB3AC485AA3485A48C7FC1206120E12385A12C012707E120E120612
076C7E6C7EA36C7EB3AC7F1370A27F7F7FEB0780EB03C0EB01F0EB007014637B811F>26
D<1318137813F0EA01E0EA03C0EA0780EA0F005A121E123E123C127CA2127812F8B3A50D
25707E25>56 D<12F8B3A51278127CA2123C123E121E121F7EEA0780EA03C0EA01E0EA00
F0137813180D25708025>58 D<137CB3A613F8A313F0120113E0120313C0EA0780130012
0E5A5A12F012C012F012387E7E7E1380EA03C013E0120113F0120013F8A3137CB3A60E4D
798025>60 D<B712F0A20070C7EA0FF8007814006C1538001C151C6C150C000F15046C15
066C6C14026D14006C7E1200137013787F131C131E7F7F6D7EA291C8FC5B13065B5B1338
13305B5B120149140248C8120600061504000E150C000C151C4815384815F80070140F00
7FB612F0B7FC272A7E7F2C>80 D<B9FCA3D80FF8C7EA1FF0000316C000011680B3B3AC48
6CEC3FC0D80FFFECFFF0B5D8F00F13FFA3303A7E7F35>89 D<00E0ED0380B3B3A60070ED
0700A36C150EA26C5D001E153C000E15386C5D01C0EB01F06C6C495AD800F8EB0F80017F
017FC7FC90381FFFFC010713F001001380293A7E7F2E>91 D<ECFF80010713F0011F13FC
90387F007F01F8EB0F80D803E0EB03E048486D7E90C81270000E81001E153C001C151C48
81A24881A348ED0380B3B3A6293A7E7F2E>I E /Fj 7 116 df<124012E012601220A312
40A2128003097D820A>59 D<133C130C1318A41330EA07B0EA0C701210EA30601260A3EA
C0C013C8A21241EA62D0EA3C700E147E9311>100 D<1206120712061200A41238124CA2
128C12981218A212301232A21264A2123808147F930C>105 D<1330133813301300A4EA
01C0EA0260EA0430136012081200A213C0A4EA0180A4EA630012E312C612780D1A81930E
>I<3830F87C38590C86384E0D06EA9C0EEA980C1218A248485A15801418A23960301900
140E190D7F8C1D>109 D<EA30F8EA590C124E129C12981218A2EA301813191331A2EA60
32131C100D7F8C15>I<1207EA1880EA19C0EA3180EA3800121E7EEA0380124112E1EAC1
001282127C0A0D7E8C10>115 D E /Fk 14 117 df<120FEA30C0EA6060A2EA4020EAC0
30A9EA4020EA6060A2EA30C0EA0F000C137E9211>48 D<120C121C12EC120CAFEAFFC00A
137D9211>I<121FEA60C01360EAF07013301260EA0070A2136013C012011380EA02005A
EA08101210EA2020EA7FE012FF0C137E9211>I<EA0FC0EA3070EA7038A31200133013E0
EA0FC0EA007013381318131C126012F01318EAE038EA6070EA1FC00E137F9211>I<1360
13E0A2EA016012021206120C120812101220126012C0EAFFFCEA0060A5EA03FC0E137F92
11>I<EA6060EA7FC01380EA44001240A3124FEA70C0EA40E0EA00601370A212E0A21360
EA40E0EA21C0EA1F000C137E9211>I<EA07C0EA0C20EA10701220EA6000A25A12CFEAD0
C0EAE060EAC0201330A31240EA6020EA2060EA10C0EA0F000C137E9211>I<1240EA7FFC
13F8EA4010EA80301320EA00401380EA0100A25A12021206A2120EA512040E147E9311>
I<EA0FC0EA1070EA20181260A21270EA3C30EA3F60EA0F8013E0EA31F0EA6078EAC01C13
0CA3EA6018EA3030EA0FC00E137F9211>I<387FFFE0B512F0C8FCA6B512F06C13E0140A
7E8B19>61 D<12FCA212C0B3A712FCA2061D7E9509>91 D<12FCA2120CB3A712FCA2061D
809509>93 D<12F01230A6EA33E0EA3430EA38181230A9EAFC7E0F147F9312>104
D<1210A312301270EAFF80EA3000A71380A3EA1100120E09127F910D>116
D E /Fl 21 118 df<EA01801203EA06005A5A123812301270A25AA71270A21230123812
187E7EEA0380120109197B9612>40 D<128012C0126012301218121C120C120EA21207A7
120EA2120C121C12181230126012C0128008197C9612>I<EA07C0EA0FE0EA1C70EA3838
EA701CA2EAE00EA7131EEA701CA2EA3838EA1C70EA0FE0EA07C00F147F9312>48
D<1206A2120E121E12FE12EE120EACEAFFE0A20B147D9312>I<EA0F80EA3FC0EA70E0EA
E0701338A2124012001330137013E013C0EA0180EA030012065AEA18381230EA7FF8A20D
147E9312>I<EAFFC0A2EAE000B3A4EAFFC0A20A1A7A9612>91 D<EAFFC0A21201B3A412
FFA20A1A7F9612>93 D<EA1FC0EA3FF0EA3838EA101C1200EA07FC123FEA781C12E0A3EA
703C383FFF80EA1FCF110E7F8D12>97 D<12F8A21238A4EA3BE0EA3FF0EA3C38EA381C13
0C130EA4130C131CEA3C38EA3FF0EA1BC00F147F9312>I<13F8A21338A4EA07B8EA1FF8
EA3878EA7038126012E0A41260EA70781238EA1FFEEA0FBE0F147F9312>100
D<EA0780EA1FE0EA38701270EA603812E0EAFFF8A2EAE0001260EA70381238EA1FF0EA07
C00D0E7E8D12>I<1206120FA21206C7FCA3127FA21207AAEAFFF0A20C157D9412>105
D<12F8A21238A4EA3BFCA2EA38F0EA39E0EA3BC0EA3F80A213C0EA3DE0123813701338EA
FC7EA20F147F9312>107 D<EAF71CEAFFBEEA79E7A2EA71C7A838F9E780EAF8E3110E80
8D12>109 D<EAF9E0EAFFF0EA3E38123C1238A8EAFE3EA20F0E7F8D12>I<EA0F80EA3FE0
1238EA7070EAE038A5EAF078EA7070EA38E0123FEA0F800D0E7E8D12>I<EAFBE0EAFFF0
EA3C38EA381C130C130EA4130C131CEA3C38EA3FF0EA3BC0EA3800A512FEA20F157F8D12
>I<EAFC78EAFDFCEA1F9CEA1E081300121CA7EAFFC0A20E0E7E8D12>114
D<EA1FF0123FEA607012C0EAE000127FEA3FE0EA0FF0EA0078EA601812E0EAF030EAFFE0
EADFC00D0E7E8D12>I<1206120EA3EA7FF812FFEA0E00A7131CA3EA07F8EA01E00E127F
9112>I<EAF8F8A2EA3838A91378EA1FFEEA0FBE0F0E7F8D12>I E
/Fm 3 55 df<B512C0A212027D871A>0 D<1204A3EAC460EAF5E0EA3F80EA0E00EA3F80
EAF5E0EAC460EA0400A30B0D7E8D11>3 D<1303A21306A2130C1318A21330A2136013C0
A2EA0180A2EA0300A212065AA25AA25A5AA25A1240101A7C9300>54
D E /Fn 2 104 df<133C13E0EA01C0EA0380ADEA0700121E12F8121E1207EA0380ADEA
01C0EA00E0133C0E257E9B13>102 D<12F8121E1207EA0380ADEA01C0EA00E0133C13E0
EA01C0EA0380ADEA0700121E12F80E257E9B13>I E /Fo 17 118
df<127012F8A3127005057D840B>46 D<EA07F0EA1C1C487EEA780FEA7007A200F01380
A900701300A2EA780FEA380E6C5AEA07F011157F9414>48 D<EA0180120712FFA21207AF
EAFFF8A20D157D9414>I<EA0FC0EA3FF8EA70FCEAF83C133E131E1270EA003E133C1338
137013E0EA01C0EA0380EA0606120CEA180EEA3FFC127F12FFA20F157E9414>I<EA0FC0
EA1FF0EA3078EA787C133CA2EA107CEA007813E0120FEA0078133CA2133E127012F8A213
3CEA7078EA3FF0EA0FC00F157E9414>I<130C131C133C137C13FCEA01BCEA033C120612
0C12181230126012C0B51280A238003C00A43803FF80A211157F9414>I<EA700CEA7FF8
13F013E01380EA6000A3EA67E0EA7870EA603C1200133EA2127012F0A2EAE03CEA7078EA
3FF0EA0FC00F157E9414>I<EA03F0EA0FF8EA1E1CEA383CA2EA7018130012F0EAF3E0EA
F438EAF81C12F0131EA31270A2EA781CEA3C38EA1FF0EA07E00F157E9414>I<1260EA7F
FFA213FE13FCEAE018EAC030A2EA006013C012011380120312071300A25AA5120610167E
9514>I<EA07E0EA1FF0EA3838EA701CA21278127EEA7FB8EA3FE0EA1FF0EA0FF8EA3BFC
EA70FEEAE07E131E130EA2EAF00CEA781CEA3FF0EA0FE00F157E9414>I<EA0FC0EA1FF0
EA3838EA703CEAF01CA2131EA31270133EEA385EEA0F9EEA001E131C1230EA783C1338EA
70F0EA3FE0EA1F800F157E9414>I<B512F0A2EA1F001470143814181306A21400130E13
FEA2130E1306A390C7FCA5EAFFF0A215177E961A>70 D<EA07F0EA1C18EA380CEA7806EA
700712F0A2B5FCEAF000A212701278EA3803EA1E06EA03FC100F7F8E13>101
D<EA0FE738183B80EA301B38701C00A4EA30186C5AEA2FE00020C7FC1230EA3FF813FE7F
38700780EAE003A338700700EA380EEA0FF811167F8E14>103 D<1238127CA312381200
A412FCA2123CAB12FFA208187F970B>105 D<EAF870EAF99CEA3A3CA2EA3C181300A8EA
FF80A20E0F7F8E11>114 D<EAFC3FA2EA3C0FAA5B381C2FC0EA0FCF120F7E8E17>117
D E /Fp 30 123 df<EA01F8EA0700120C5A123812301270EA7FC0EAE000A51260A27EEA
1860EA0F800D127E9111>15 D<126012F0A2126004047C830C>58
D<126012F0A212701210A41220A212401280040C7C830C>I<EC0380EC0F00143C14F0EB
03C0010FC7FC133C13F0EA03C0000FC8FC123C12F0A2123C120FEA03C0EA00F0133C130F
EB03C0EB00F0143C140FEC038019187D9520>I<12E01278121EEA0780EA01E0EA007813
1EEB0780EB01E0EB0078141EEC0780A2EC1E001478EB01E0EB0780011EC7FC1378EA01E0
EA0780001EC8FC127812E019187D9520>62 D<001FB512F0391C03807039300700300020
142012601240130E1280A2000014005BA45BA45BA45BA41201EA7FFF1C1C7F9B18>84
D<EA01E3EA0717EA0C0F1218EA380E12301270A2485AA4EB3880A3EA607838319900EA1E
0E11127E9116>97 D<123F1207A2120EA45AA4EA39E0EA3A30EA3C1812381270131CA3EA
E038A313301370136013C01261EA2300121E0E1D7E9C12>I<EA01F0EA030C120CEA1C1E
EA383CEA3018EA7000A25AA51304EA60081310EA3060EA1F800F127E9112>I<EB07E013
00A2EB01C0A4EB0380A43801E700EA0717EA0C0F1218EA380E12301270A2485AA4EB3880
A3EA607838319900EA1E0E131D7E9C16>I<EA01F0EA0708120CEA1804EA38081230EA70
30EA7FC0EAE000A51304EA60081310EA3060EA0F800E127E9113>I<EB01E0EB0630EB0E
7814F0EB1C601400A45BA23803FFC038003800A25BA55BA5485AA55B1203A20063C7FC12
F312F612E4127815257E9C14>I<EB38C013C5EA0183EA0303000713801206120EA2381C
0700A4130EA3EA0C1EEA047CEA039CEA001CA25B1260EAF0301370EAE0C0007FC7FC121A
809114>I<EA01C01203A2EA0180C7FCA6121C12271247A21287A2120EA25AA35A1380A2
1270EA71001232121C0A1C7E9B0E>105 D<1307130FA213061300A61378139CEA010C12
02131C12041200A21338A41370A413E0A4EA01C01261EAF180EAF30012E6127C1024809B
11>I<EA0FC01201A2485AA448C7FCA4EA0E07EB0880EB11C01323381C4780EB8300001D
C7FC121EEA3FC0EA38E01370A2EA7071A31372EAE032EA601C121D7E9C16>I<EA1F8012
03A2EA0700A4120EA45AA45AA45AA412E2A312E412641238091D7F9C0C>I<39381F81F0
394E20C618394640E81CEB80F0EA8F00008E13E0120EA2391C01C038A315703938038071
A215E115E23970070064D83003133820127E9124>I<EA3C1F384E6180384681C0EA4701
128F128E120EA2381C0380A3EB070000381310A2130E1420387006403830038014127E91
19>I<13F8EA030CEA0E06487E1218123000701380A238E00700A3130EA25BEA60185BEA
30E0EA0F8011127E9114>I<380787803809C8603808D03013E0EA11C014381201A23803
8070A31460380700E014C0EB0180EB8300EA0E86137890C7FCA25AA4123CB4FC151A8191
15>I<EA3C3CEA4E42EA4687EA470FEA8E1E130CEA0E00A25AA45AA45A123010127E9113>
114 D<EA01F0EA060CEA0C04130EEA180CEA1C00121FEA0FE013F0EA03F8EA0038EA201C
EA701812F01310EA8030EA6060EA1F800F127E9113>I<13C01201A3EA0380A4EAFFF0EA
0700A3120EA45AA4EA3820A21340A2EA1880EA0F000C1A80990F>I<001C13C0EA270112
47A238870380A2120EA2381C0700A438180E20A3EA1C1E380C26403807C38013127E9118
>I<EA1C03EA270712471303EA8701A2120EA2EA1C02A3130412181308A2EA1C10EA0C20
EA07C010127E9114>I<001CEBC080392701C1C0124714C03987038040A2120EA2391C07
0080A3EC0100EA1806A2381C0E02EB0F04380E13083803E1F01A127E911E>I<38078780
3808C8403810F0C03820F1E0EBE3C03840E1803800E000A2485AA43863808012F3EB8100
12E5EA84C6EA787813127E9118>I<001C13C0EA27011247A238870380A2120EA2381C07
00A4EA180EA3EA1C1EEA0C3CEA07DCEA001C1318EA6038EAF0305B485AEA4180003EC7FC
121A7E9114>I<EA0381EA07C1EA0FF6EA081CEA1008EA0010132013401380EA01001202
5AEA08041210EA3C18EA67F8EA43F0EA81E010127E9113>I E /Fq
73 123 df<3803F07C000713FC380E11C4381C0380A638FF83F0A2381C0380AF161A8099
16>11 D<EB0380EA01E3120338062000000EC7FCA638FFE380A2EA0E03AF111B809A15>
I<3801E3801203EA0623EA0E03A6EAFFE3A2EA0E03AF111A809915>I<EA01E0487EEA07
38EA061C120EA35BA25B5B3807C0061380140C120F381FC018EA39E00070133038E0F070
EB7860EB3CC0EB1F8038F00F0138783FC3383FF9FF380FC07C181A7E991D>38
D<EA0180EA03001206120E120C121C1218123812301270A3126012E0AC12601270A31230
12381218121C120C120E12067EEA018009267D9B0F>40 D<12C012607E12381218121C12
0C120E12061207A37E1380AC13005AA31206120E120C121C1218123812305A5A09267E9B
0F>I<120313801300A2EAE31CEAFB7CEA7FF8EA1FE0EA0780EA1FE0EA7FF8EAFB7CEAE3
1CEA0300A2138013000E117E9B13>I<12E0A312601240A312C003087C820B>44
D<EAFFC0A20A0280890D>I<12E0A303037C820B>I<EA07E0EA1FF8EA3C3CEA381CEA700E
A2EA6006EAE007AAEA6006EA700EA2EA381CEA3C3CEA1FF8EA07E010187F9713>48
D<5A1207B4FCA21207B2EA7FF0A20C187D9713>I<EA0FC0EA1FF0EA3878EA601CEAE01E
1240130E1200131EA2131C133C1338137013E0EA01C0EA0380EA070012065A5A5AEA7FFE
A20F187F9713>I<EA07E0EA0FF8EA3C3CEA301E1260EA200EEA001E131C133C1378EA07
F013E0EA0038131C130E130FA31280EAC00EEA601EEA383CEA1FF8EA07E010187F9713>
I<1378A213B8A21201EA0338A212071206120E121C121812381230127012E0B5FCA2EA00
38A610187F9713>I<EA3FFCA2EA3800A7EA3BC0EA3FF0EA3C38EA383CEA001C131EA412
40EAC03C1260EA7878EA1FF0EA0FC00F187F9713>I<EA01F8EA07FCEA0F04EA1C005A12
301270A25AEAE7F0EAEFFCEAF81CEAF00E130712E0A312601270130E1238EA1C3CEA0FF8
EA07E010187F9713>I<B5FCA2EA0007130E131C13381378137013F013E0120113C01203
A2EA0780A4EA0F00A610187F9713>I<EA07E0EA1FF8EA3C3CEA381CEA700EA4EA381CEA
1C38EA07E0A2EA1C38EA300CEA700EEAE007A4EA700EA2EA3C3CEA1FF8EA07E010187F97
13>I<EA07E0EA1FF0EA3C38EA701C130E12E013061307A3130F1270EA381FEA3FF7EA0F
E7EA0007130EA2130C131CEA1038EA3070EA1FE0EA0F8010187F9713>I<12E0A31200AB
12E0A303117C900B>I<B61280A2C9FCA6B61280A2190A7E8D1E>61
D<1338137CA2135C13CEA2EA01CF138F1387000313801307380703C0A21206380E01E0A2
EA0FFF4813F0EA1C004813F81478A248137C143C126000E0131E171A7F991A>65
D<EAFFF813FE38F00F80EB03C0130114E0A4EB03C0EB0780B512005B38F03F80EB07C0EB
01E0130014F0A4EB01E01303EB0FC0B5120013FC141A7D991A>I<EB7FC03801FFF0EA07
C0380F0030001E13005AA25AA25AA81278A27EA26C13106C13303807C0F03801FFE03800
7F80141A7E9919>I<EAFFFC13FF38F00F80EB03C0EB01E0EB00F014701478A2143CA814
381478A214F0EB01E0EB03C0EB0F80B5120013FC161A7D991C>I<B51280A200F0C7FCA9
B5FCA200F0C7FCABB51280A2111A7D9917>I<B5FCA2EAF000AAEAFFFEA2EAF000AC101A
7D9916>I<137F3801FFE03807C0F0380F0070001E1330481300A25AA25AA5EB07F8A2EB
00381278A27EA27E7E3807C0F83801FFE038007F80151A7E991A>I<00F013F0ABB5FCA2
EAF000AD141A7D991B>I<12F0B3A8041A7D990B>I<00F0137814F0EB01E0EB03C0EB0780
EB0F00131E5B5B5BEAF1E0EAF3F012F7EAFF78EAFE7CEAFC3C487E12F07F14801307EB03
C014E01301EB00F014F8151A7D991B>75 D<12F0B3A6EAFFFEA20F1A7D9915>I<00FCEB
07E0A300EE130DA200EF131D00E71319A2EB803900E31331A2EBC071A238E1E0E1A200E0
13C1A213F1EB7181A2137BEB3B01A2131EA31B1A7D9922>I<00FC1370A27EA212EFA2EA
E780A2EAE3C0A2EAE1E0A2EAE0F0A21378A2133CA2131EA2130FA2EB07F0A21303A2141A
7D991B>I<13FE3803FF80380783C0380F01E0381E00F0481378003813380078133CA248
131EA80078133CA200381338003C13786C13F0380F01E0380783C03803FF803800FE0017
1A7E991C>I<EAFFF813FE38F00F80EB03C0A2EB01E0A5EB03C0A2EB0F8038FFFE0013F8
00F0C7FCAB131A7D9919>I<13FE3803FF80380783C0380F01E0381E00F0481378003813
380078133CA248131EA80078133CA238383C38383C1C78381E1EF0380F0FE0380787C038
03FF80C613C0EB03E01301EB00F014F8147C171F7E991C>I<EAFFF813FE38F00F80EB03
C0130114E0A414C01303EB0F8038FFFE0013F8EAF038133C131C131E7FA2EB0780A2EB03
C0EB01E0A2EB00F0141A7D9919>I<EA07F0EA1FFCEA381EEA700EEA6006EAE000A37E7E
127FEA3FE0EA1FF8EA07FCEA00FE131E130F1307A312C0130E12E0EA783CEA3FF8EA07E0
101A7E9915>I<B512FEA238003C00B3A6171A7F991A>I<00F013E0B3A2387801C0A2383C
0380381E0F00EA0FFEEA03F8131A7D991A>I<00F0130EA20078130C141CA26C1338A212
3E001E1370A26C13E0A3380781C0A23803C18013C3A23801E30013E7EA00E6A213F6137C
A21338171A7F991A>I<3AF003F00380A300F813703A7807780700A21306393C0E3806EC
3C0EA2EB0C1CD81E1C130CEC1E1C1318000EEB0E18120F9038380F3813300007EB0730A2
13200003EB032013A001E013E013C000016D5A211A7F9924>I<00F8133C007C1378003C
13F06C13E0EA0F01EB03C0380783803803C700EA01CF13FE6C5A1378A2137C13FEEA01EE
EA03C7EB8780380703C0EA0F01000E13E0381C00F0003C137848137C0070133C00F0133E
171A7F991A>I<00F8EB0780007C14006C130E001E131E001F131C6C6C5A00071378EBC0
706C6C5A1201EBF1C0EA00FBEB7B80013FC7FCA2131EAB191A80991A>I<B512C0A23800
0780A2EB0F005B131E5BA25B13F85B485AA2485A12075B48C7FCA2121E123E123C5AA2B5
12C0A2121A7E9917>I<EA0FC0EA3FF0EA7878EA6038EA401C1200A213FC120FEA3F1C12
7812E0A3EA707CEA7FFCEA1F9C0E117F9012>97 D<12E0A9EAE7C0EAFFF0EAF878EAF038
EAE01C130C130EA5131CA2EAF0381370EAFFE0EAE7C00F1A7D9914>I<EA07E0EA0FF8EA
1C1CEA380CEA7000126012E0A512601270EA3804EA1C1CEA0FFCEA07F00E117F9011>I<
130EA9EA07CEEA0FFEEA1C1EEA380E1270A212E0A51270A2EA381EEA3C3EEA1FEEEA07CE
0F1A7F9914>I<EA07C0EA1FF0EA3C70EA7018A2EAE00CA2EAFFFCA2EAE000A212601270
7EEA3C0CEA1FFCEA07F00E117F9011>I<EA03F01207EA0E10EA1C00A6EAFFC0A2EA1C00
AF0C1A80990C>I<38078780EA1FFF38387C001370487EA46C5AA2EA3FE0EA77800070C7
FCA2EA3FF013FC7FEA700F487EA3EA700EEA781EEA1FF8EA07E011197F9013>I<12E0A9
EAE3C0EAEFF0EAF870EAF038A212E0AC0D1A7D9914>I<12F0A41200A61270B1041B7E9A
0A>I<EA0780A4C7FCA6EA0380B3A3EAC700B4FC123C0922829A0A>I<12E0A9137C137813
F0EAE1E0EAE3C0EAE780EAEF00B4FC138012FBEAF3C0EAE1E012E013F013701338133C0E
1A7D9913>I<12E0B3A8031A7D990A>I<38E3C0F038EFF3FC38F8761C38F03C0EA2EAE038
AC17117D901E>I<EAE3C0EAEFF0EAF870EAF038A212E0AC0D117D9014>I<EA07E0EA1FF8
EA3C3CEA381CEA700EEA6006EAE007A5EAF00FEA700EEA781EEA3C3CEA1FF8EA07E01011
7F9013>I<EAE7C0EAFFF0EAF878EAF038EAE01CA2130EA5131CA2EAF0381370EAFFE0EA
E7C0EAE000A70F187D9014>I<EA03CEEA0FFEEA1C3EEA381EEA700EA212E0A51270A2EA
381EEA3C3EEA1FFEEA07CEEA000EA70F187F9014>I<EAE1C012E712EFEAFE0012F85AA2
5AAA0A117E900D>I<EA1F80EA3FE0EA7060EAE000A312F8EA7F80EA3FC0EA07E0EA00F0
1370128012C0EAF0E0EA7FC0EA1F800C117F900F>I<1238A4EAFFC0A2EA3800AC1360EA
1FE0EA0F800B157F940E>I<EAE038AD137813F8127FEA3F380D117D9014>I<EAE00EA212
F0EA701CA2EA38181338A2EA1C301370A2EA0E6013E0A2EA07C0A2EA03800F117F9012>
I<38E0780E137CA2136C3870CC1C13CEA23838C618383986381387138338190330A2001D
1370380F01E0120EA217117F901A>I<EA7007EA780EEA381CEA1C3CEA0E386C5A6C5A5B
1201487EEA0770EA0E30EA0C38EA1C1C487E487E00F013801111809012>I<EAE00EA212
70131C1278EA3838A2121C1370120CEA0E60A2EA06E013C012031380A31300A21206128E
12FC5A0F187F9012>I<EAFFF8A2EA007013F013E0EA01C0EA0380A2EA0700120EA25A5A
12781270EAFFFCA20E117F9011>I E /Fr 87 126 df<126012F0AF12601200A4126012
F0A212600419779816>33 D<EAE038EAF078A7EAE038A2EA60300D0B7C9816>I<EA0387
A6387FFFC0B512E0A238070E00A3EA0E1CA4B512E0A26C13C0381C3800A613197F9816>
I<13C01201A3EA07F0EA1FFC487EEA7DCF3871C780EAE1C313C7A238F1C300EA79C0123F
EA1FF0EA07FCEA01FE13CF13C73861C38012F1A212E13871C700EA79DFEA3FFEEA1FF8EA
07E0EA01C0A2120011207E9C16>I<38380180EA7C03A238EE0700A2130EA35B127C5B12
38C65AA35BA2485AA3485AEB8380380707C0A2380E0EE0A3121CA2383807C0A238180380
13207F9C16>I<EA0380EA07E0120FEA1E70121CA3EBF7E013E7EA1DC7000F1300138E13
0E121F485AEA7B9C1273EAE1F8A238E0F0E0A2EA71F8387FFFC0EA3F9F381E070013197F
9816>I<12301278127C123C121CA41238127812F012E01240060D789816>I<13E01201EA
0380EA0700120E5AA25AA25AA35AA91270A37EA27EA27E7EEA0380EA01E012000B217A9C
16>I<12C07E12707E7E7EA27EA2EA0380A3EA01C0A9EA0380A3EA0700A2120EA25A5A5A
5A5A0A217B9C16>I<EA0380A4EAE38EEAF39EEAFFFEEA3FF8EA0FE0A2EA3FF8EAFFFEEA
F39EEAE38EEA0380A40F127D9516>I<13E0A8B512E0A33800E000A813137F9516>I<1238
127C127EA2123E120E121E121C127812F01260070B798416>I<B51280A311037E8D16>I<
127012F8A312700505788416>I<EB01801303A2EB0700A2130EA25BA25BA25BA25BA248
5AA2485AA248C7FCA2120EA25AA25AA25AA25AA25A11207E9C16>I<EA03E0EA0FF8487E
EA1E3CEA380EEA780FEA7007A238E00380A8EAF00700701300A2EA780FEA3C1E6C5AEA1F
FC6C5AEA03E011197E9816>I<12035AA25A5AB4FCA212E71207AEEAFFF8A30D197B9816>
I<EA07E0EA1FF8487EEA783EEAE00700F01380130312601200A2EB0700A2130E5B5B5B5B
485A485A000FC7FC381E03801238EA7FFFB5FC7E11197E9816>I<EA07E0EA1FF8487EEA
781E130712301200A2130E133EEA07FC13F013FCEA001E13077F1480A2126012F038E007
00EA781EEA3FFC6C5AEA07E011197E9816>I<137C13FC13DC1201EA039CA2EA071C120F
120E121E123C1238127812F0B512E0A338001C00A53801FFC0A313197F9816>I<EA3FFE
127FA20070C7FCA7EA77F0EA7FFC7FEA780FEA300738000380A2126012F0A238E00700EA
781EEA3FFC6C5AEA07E011197E9816>I<13F8EA03FC487EEA0F07EA1C0F1238EA780600
70C7FCA2EAE3F8EAEFFCB47EEAF80F487EEB038012E0A21270A2130700381300EA3C1EEA
1FFC6C5AEA03E011197E9816>I<12E0B51280A338E00F00131EEA001C5B137813705BA2
485AA3485AA448C7FCA7111A7E9916>I<EA07F0EA1FFC487EEA7C1F38F00780EAE003A3
38700700EA7C1FEA1FFCEA07F0EA1FFCEA3C1EEA700700F01380EAE003A3EAF007007013
00EA7C1FEA3FFE6C5AEA07F011197E9816>I<EA03E0EA0FF8487EEA3C1EEA700E7F12E0
14801303A213071270EA780FEA3FFFEA1FFBEA0FE338000700A21230EA780E5BEA707CEA
3FF8EA1FE0EA0F8011197E9816>I<127012F8A312701200A8127012F8A3127005127891
16>I<1238127CA312381200A812381278127CA2123C121CA21238127012F01240061879
9116>I<EB01801307131FEB3E0013F8485AEA07C0485A003EC7FC12FC12F012FC123EEA
0F806C7EEA01F06C7E133EEB1F801307130111157E9616>I<387FFFC0B512E0A2C8FCA5
B512E0A26C13C0130B7F9116>I<12C012F012FC123EEA0F806C7EEA01F06C7E133EEB1F
801307131FEB3E0013F8485AEA07C0485A003EC7FC12FC12F012C011157E9616>I<13E0
487EA213B0A2EA03B8A31318EA071CA5EA0E0EA2EA0FFEA2487EEA1C07A3387E0FC038FF
1FE0387E0FC013197F9816>65 D<EA7FF8EAFFFE6C7EEA1C0714801303A4EB0700EA1FFF
5BA2EA1C1FEB038014C01301A41303EB0780EA7FFFB51200EA7FFC12197F9816>I<3801
F180EA07FBEA0FFFEA1F0FEA3C07EA38031270A200F0C7FC5AA77E38700380A21238383C
0700EA1F0FEA0FFE6C5AEA01F011197E9816>I<EA7FF8EAFFFE6C7EEA1C0FEB0780EB03
C01301A214E01300A8EB01C0A21303EB0780130F387FFF00485AEA7FF81319809816>I<
387FFFC0B5FC7EEA1C01A490C7FCA2131CA2EA1FFCA3EA1C1CA290C7FC14E0A5EA7FFFB5
FC7E13197F9816>I<387FFFE0B5FC7EEA1C00A41400A2131CA2EA1FFCA3EA1C1CA290C7
FCA6EA7F80487E6C5A13197F9816>I<3801F180EA07FBEA0FFFEA1F0FEA3C07EA380312
70A200F0C7FC5AA4EB1FC014E014C038F00380127013071238123CEA1E0FEA0FFFEA07FB
EA01F313197F9816>I<387F07F038FF8FF8387F07F0381C01C0A7EA1FFFA3EA1C01A938
7F07F038FF8FF8387F07F01519809816>I<EA7FFCEAFFFEEA7FFCEA0380B3EA7FFCEAFF
FEEA7FFC0F197D9816>I<387F0FE038FF8FF0387F0FE0381C0780EB0F00130E5B133C5B
5B5BEA1DF0121F7F1338EA1E1C121C7FA27FA2EB0380387F07E038FF8FF0387F07E01419
809816>75 D<B47E7F5B001CC7FCAE144014E0A4B5FCA313197F9816>I<38FC07E0EAFE
0FA2383A0B80EA3B1BA513BBEA39B3A413F3EA38E3A21303A538FE0FE0A313197F9816>
I<387E07F038FF0FF8387F07F0381D81C0A313C1121C13E1A213611371A313311339A213
19131D130DA3EA7F07EAFF87EA7F031519809816>I<EA1FFC487E487EEA780F38F00780
EAE003AEEAF007A238780F00EA7FFF6C5A6C5A11197E9816>I<EA7FF8EAFFFE6C7E381C
0F80130314C01301A313031480130F381FFF005B13F8001CC7FCA7127F487E6CC7FC1219
7F9816>I<EA1FFC487E487EEA780F38F00780EAE003AD13E312E1EAF0F738787F00EA7F
FF6C5A6C5AEA001C131E130E130F7FA2111F7E9816>I<EA7FF0EAFFFC6C7EEA1C0FEB07
801303A41307EB0F00EA1FFE5B7FEA1C0E7FA414101438A2387F03F0EAFF83387F01E015
19809816>I<EA07E3EA1FFF5AEA781FEAF00712E0A290C7FC7E1278EA3F80EA1FF0EA07
FCC67E130F7FEB0380A2126012E0EB0700EAF80FEAFFFE5BEAC7F011197E9816>I<387F
FFE0B5FCA2EAE0E0A400001300AFEA07FC487E6C5A13197F9816>I<387F07F038FF8FF8
387F07F0381C01C0B0380E0380A23807070013FF6C5AEA00F81519809816>I<38FE0FE0
A338380380EA3C07001C1300A3EA1E0FEA0E0EA46C5AA4EA031813B8A3EA01B013F0A26C
5A13197F9816>I<387E03F038FF07F8387E03F0383800E0A4381C01C0A3137113F9A213
D9A2000C1380A3EA0DDD138DA338078F00A213071519809816>I<387F1F80EB3FC0EB1F
80380E1E00131C12075BEA03B813F012015B120012017F120313B81207131C120FEA0E0E
A2487E387E0FC038FF1FE0387E0FC013197F9816>I<38FE0FE0EAFF1FEAFE0F381C0700
A2EA0E0EA26C5AA3EA03B8A2EA01F0A26C5AA8EA03F8487E6C5A13197F9816>I<387FFF
80B5FCA238E007005B131E131CEA003C5B137013F0485A5B1203485A90C7FC5A381E0380
121C123C12781270B5FCA311197E9816>I<EAFFF0A3EAE000B3A8EAFFF0A30C20789C16>
I<12C07EA21270A27EA27EA27EA27EA26C7EA26C7EA26C7EA21370A27FA27FA27FA27FA2
EB0380A2130111207E9C16>I<EAFFF0A3EA0070B3A8EAFFF0A30C207F9C16>I<B51280A3
11037E7E16>95 D<EA1FE0487E487EEA783CEA300E1200A2EA03FE121FEA3E0E127012E0
A3EA783E387FFFE0EA3FE7EA0F8313127E9116>97 D<12FCA3121CA4137CEA1DFEEA1FFF
EB0780381E03C0EA1C01EB00E0A6EB01C0EA1E03381F0780EBFF00EA1DFEEA0C7813197F
9816>I<EA03F8EA0FFCEA1FFEEA3C1EEA780CEA70005AA57EEA70071278EA3E0EEA1FFC
EA0FF8EA03F010127D9116>I<133FA31307A4EA03C7EA0FF748B4FCEA3C1F487EEA7007
12E0A6EA700F12786C5A381FFFE0EA0FF7EA07C713197F9816>I<EA03F0EA0FFC487EEA
3C0F487E3870038012E0B5FCA300E0C7FCA2387003801278EA3E07381FFF00EA07FEEA01
F811127E9116>I<131E137F3801FF8013C7380383001380A2EA7FFFB5FCA2EA0380ACEA
7FFC487E6C5A11197F9816>I<3803E3C03807F7E0EA0FFF381C1CC038380E00A56C5AEA
0FF8485AEA1BE00038C7FC1218EA1FFC13FF481380387003C038E000E0A4387001C0EA7C
07383FFF80380FFE00EA03F8131C7F9116>I<12FCA3121CA41378EA1DFCEA1FFE130FEA
1E07121CAA38FF8FE0139F138F13197F9816>I<1203EA0780A2EA0300C7FCA4EAFF80A3
1203ACEAFFFC13FE13FC0F1A7C9916>I<13301378A213301300A4EA0FF8121F120FEA00
38B3EA6070EAF0F0EAFFE0EA7FC0EA3F800D237E9916>I<127E12FE127E120EA4EB7FE0
A3EB0F00131E5B5B5B120F7F13BC131EEA0E0E7F1480387F87F0EAFFCFEA7F8714198098
16>I<EA7FC012FF127F1201B3EA7FFFB512806C130011197E9816>I<38F9C38038FFEFC0
EBFFE0EA3C78A2EA3870AA38FE7CF8A31512809116>I<EAFC78EAFDFCB47EEA1F0FEA1E
07121CAA38FF8FE0139F138F13127F9116>I<EA03E0EA0FF8487EEA3C1E487EEA700738
E00380A5EAF00700701300EA780FEA3C1EEA1FFC6C5AEA03E011127E9116>I<EAFC7CEA
FDFEB5FC381F0780381E03C0EA1C01EB00E0A6EB01C0EA1E03381F0780EBFF00EA1DFEEA
1C7890C7FCA6B47EA3131B7F9116>I<3803E380EA0FF3EA1FFBEA3E0FEA78071270EAE0
03A6EA70071278EA3C1FEA1FFBEA0FF3EA03E3EA0003A6EB1FF0EB3FF8EB1FF0151B7F91
16>I<387F0FC038FF3FE0EA7F7F3807F040EBC0005BA290C7FCA8EA7FFC12FF127F1312
7F9116>I<EA0FECEA3FFC127FEAF03CEAE01CA2EA7000EA7F80EA1FF0EA07F8EA003CEA
600E12E012F0EAF81EEAFFFC13F8EAC7E00F127D9116>I<12035AA4EA7FFFB5FCA20007
C7FCA75BEB0380A3EB8700EA03FE6C5A6C5A11177F9616>I<EAFC3FA3EA1C07AB131F38
1FFFE0EA0FF7EA07C713127F9116>I<387F1FC038FF9FE0387F1FC0381C0700A2EA0E0E
A36C5AA4EA03B8A3EA01F0A26C5A13127F9116>I<38FF1FE0A338380380A4EA39F3A200
19130013B3A3EA1DB71317EA1F1FEA0F1EEA0E0E13127F9116>I<387F1FC0133F131F38
0F1E006C5AEA03B813F012016C5A12017FEA03B8EA073C131CEA0E0E387F1FC038FF3FE0
387F1FC013127F9116>I<387F1FC038FF9FE0387F1FC0381C0700120E130EA212075BA2
EA039CA21398EA01B8A2EA00F0A35BA3485A1279127BEA7F8090C7FC123C131B7F9116>
I<383FFFC05AA238700780EB0F00131EC65A5B485A485AEA078048C7FC381E01C0123C12
78B5FCA312127F9116>I<EB1F80137F13FF3801E0005BA91203EA7F8048C7FCA26C7EEA
03C01201A97F3800FF80137F131F11207E9C16>I<127CB4FC7FEA03C01201A97F6CB4FC
EB7F80A2EBFF00EA01E05BA91203B45A90C7FC127C11207E9C16>125
D E /Fs 68 124 df<90383FE3F83901F03F1C3903C03E3E0007137CEA0F80151C1500A5
B612C0A2390F807C00AE397FE1FF80A21F1D809C1C>11 D<EB3FC03801F0303803C03800
07137CEA0F80A2143891C7FCA4B512FCA2380F807CAE397FE1FF80A2191D809C1B>I<EB
3FFC3801F07CEA03C01207EA0F80A7B512FCA2380F807CAE397FF3FF80A2191D809C1B>
I<90393FE1FFE03901F03F833903C03E030007137E380F807CA7B7FCA2390F807C03AE3A
7FF3FF9FFCA2261D809C28>15 D<127012F812FCA3127C1204A21208A312101220124006
0E7D850D>44 D<EAFFF8A40D04808A10>I<127812FCA4127806067D850D>I<EB01801303
A2EB0700A3130EA25BA35BA35BA25BA3485AA3485AA348C7FCA2120EA35AA35AA25AA35A
A25A11297D9E18>I<EA03F8EA0F1EEA1C07003C1380EA3803007813C0A300F813E0AC00
7813C0A200381380EA3C07001C1300EA0F1EEA03F8131B7E9A18>I<1360EA01E0120F12
FF12F31203B3A2387FFF80A2111B7D9A18>I<EA07F8EA1FFE38383F8038780FC0EAFC07
14E01303A21278EA000714C0A2EB0F80EB1F00131E13385B5B38018060EA030012060008
13E0381FFFC05A5AB5FCA2131B7E9A18>I<EA07F8EA1FFEEA3C1FEB0F80387C07C0127E
127C123838000F80A2EB1E005BEA03F8EA001EEB0F80EB07C0A214E01230127812FCA214
C038780F80EB1F00EA1FFEEA07F8131B7E9A18>I<EB018013031307130F131F133F136F
13CF138F1201EA030F1206120C12181230126012C0B512F8A238000F80A6EBFFF8A2151B
7F9A18>I<38380180383FFF005B5B5B13C00030C7FCA4EA31F8EA361E38380F80EA3007
000013C014E0A3127812F8A214C012F038600F8038381F00EA1FFEEA07F0131B7E9A18>
I<137EEA03FF38078180380F03C0EA1E07123C387C03800078C7FCA212F813F8EAFB0E38
FA0780EAFC0314C000F813E0A41278A214C0123CEB0780381E0F00EA07FEEA03F8131B7E
9A18>I<1260387FFFE0A214C01480A238E00300EAC0065B5BC65AA25B13E0A212015B12
03A41207A66C5A131C7D9B18>I<EA03F8EA0FFE381E0F80EA3807EB03C01278127C127E
387F8380383FC70013FE6C5A6C7E6C7E001D138038387FC038781FE0EA700FEAF0031301
A3007813C0EB0380EA3E07381FFE00EA03F8131B7E9A18>I<EA03F8EA0FFEEA1E0F383C
07801278EB03C012F8A214E0A4EA78071238EA3C0BEA0E1BEA03E3EA000314C0A2EA3807
007C13801400EA780FEA383CEA1FF8EA0FE0131B7E9A18>I<127812FCA412781200A612
7812FCA4127806127D910D>I<EA0FF0EA303CEA601EEAF01F12F8A21270EA003E133C13
7013E0EA01C01380A2EA0300A5C7FCA4EA0780EA0FC0A4EA0780101D7D9C17>63
D<EB0380A2497EA3497EA2497E131BEB3BF81331A2EB60FCA2EBE0FEEBC07EA248487E90
B5FC481480EB001F4814C00006130FA248EB07E0A239FF803FFEA21F1C7E9B24>65
D<B512F814FF390FC01F80EC0FC0140715E0A515C0EC0F80EC3F00EBFFFE9038C00F80EC
07C0EC03E0A215F0A5EC07E0A2EC1FC0B6120014FC1C1C7E9B22>I<90381FE0209038FF
F8E03803F80F3807C003380F800148C7FC123E1560127E127C00FC1400A8007C1460127E
123E15C07E390F8001803907C003003803F80E3800FFFCEB1FE01B1C7D9B22>I<B512F8
14FF390FC01FC0EC07E0EC01F015F8140015FC157CA2157EA8157CA315F8A2EC01F0EC07
E0EC1FC0B6120014F81F1C7E9B25>I<B6FCA2380FC01F1407801580A214C1A39038C1C0
0013C313FFA213C313C113C01560A2EC00E015C0A21401A21403EC0F80B6FCA21B1C7E9B
1F>I<B6FCA2380FC01F1407801580A2140114C1A2ECC00013C113C313FFA213C313C113
C0A391C7FCA6EAFFFEA2191C7E9B1E>I<90380FF00890387FFE383901FC07F83807E001
390F80007848C7FC481438123E007E1418127C00FC1400A6EC7FFFA2007CEB01F8127E12
3E123F7EEA0F80EA07E03801FC0739007FFE7890380FF818201C7D9B26>I<39FFFC3FFF
A2390FC003F0AA90B5FCA2EBC003AC39FFFC3FFFA2201C7E9B25>I<EAFFFCA2EA0FC0B3
A6EAFFFCA20E1C7E9B12>I<EAFFFEA2EA0FC0AF1403A31407A21406140E141E147EB512
FEA2181C7E9B1D>76 D<D8FFC0EB03FF6D5B000F15F0D80DF0130DA3D80CF81319A2017C
1331A26D1361A26D13C1A390380F8181A2903807C301A2EB03E6A2EB01FCA3EB00F8A23A
FFC0701FFFA2281C7E9B2D>I<39FFE003FFA2390FF000307FEA0DFCEA0CFE137E7FEB1F
8014C0EB0FE0EB07F01303EB01F814FCEB00FE147F143FEC1FB015F0140F140714031401
1400A2D8FFC013701530201C7E9B25>I<EB3FE03801F07C3803C01E390F800F80391F00
07C0001E1303003E14E0007E14F0007C1301A200FC14F8A8007C14F0007E1303A2003E14
E0003F13076C14C0390F800F803903C01E003801F07C38003FE01D1C7D9B24>I<B512F8
14FE390FC03F80140FEC07C015E0A515C0A2EC0F80EC3F00EBFFFC01C0C7FCABEAFFFCA2
1B1C7E9B21>I<B512F014FE380FC03FEC0F806E7E81A55D4A5A023EC7FCEBFFF0EBC07C
80143F6E7EA6ED8180A2EC0FC13AFFFC07C300EC01FE211C7E9B24>82
D<3807F820381FFEE0EA3C07EA7801EA700012F01460A26C130012FEEAFFE0EA7FFE6C7E
1480000F13C06C13E0EA007FEB03F01301130012C0A214E07E38F001C0EAFC0338EFFF00
EA83FC141C7D9B1B>I<007FB512E0A238781F81007013800060146000E0147000C01430
A400001400B03807FFFEA21C1C7E9B21>I<39FFFC03FFA2390FC00030B3120715606C6C
13E03901F001C03900FC078090387FFE00EB0FF8201C7E9B25>I<3AFFFC01FF80A23A0F
C00018006D1338000714306D1370000314607F00015CA26C6C485AA2EBFE03017E90C7FC
EB7F07EB3F061486EB1F8CA2EB0FD8A214F86D5AA26D5AA26D5AA2211C7F9B24>I<3BFF
F87FFE0FFCA23B0FC007E000C081D9E003130100071680EC07F801F014030003D90FFC13
00140CD801F81406EC1CFE9039FC187E0E0000150CEC303F01FE141CD97E701398EC601F
013F14B002E013F0ECC00F011F5CEC8007A2010F5CEC00036D5CA22E1C7F9B31>I<397F
FE1FFEA23907F001803803F803000149C7FCEBFC066C6C5AEB7F1C6D5A14B0EB1FE0130F
A26D7E6D7E1307497EEB0CFEEB187EEB387F496C7E9038601FC013C000016D7E48486C7E
EB00033AFFF01FFF80A2211C7F9B24>I<EA0FF8EA1C1E383E0F80130714C0121C120013
7FEA07E7EA1F07123C127C12F8A3EA780B383E13F8EA0FE115127F9117>97
D<B4FCA2121FA9EB3F80EBE1E0EB8070EB0078143CA2143EA6143CA21478EB8070381EC1
E0381C3F00171D7F9C1B>I<EA03FCEA0E0EEA1C1F123C1278130E00F8C7FCA61278EB01
80123C381C0300EA0E0EEA03F811127E9115>I<EB0FF0A21301A9EA01F9EA0F07EA1C03
EA3C011278A212F8A61278A2123CEA1C03380F0FFEEA03F9171D7E9C1B>I<EA03FCEA0F
07381C0380383C01C0127814E012F8A2B5FC00F8C7FCA3127814607E6C13C0380F038038
01FC0013127F9116>I<137F3801E3803803C7C0EA0787120FEB8380EB8000A5EAFFF8A2
EA0F80AEEA7FF0A2121D809C0F>I<3803F0F0380E1F38EA3C0F3838073000781380A400
381300EA3C0FEA1E1CEA33F00030C7FCA3EA3FFF14C06C13E014F0387801F838F00078A3
00701370007813F0381E03C03807FF00151B7F9118>I<B4FCA2121FA9EB0FC0EB31E0EB
40F0EB80F8A21300AB38FFE7FFA2181D7F9C1B>I<121E123FA4121EC7FCA6127FA2121F
AEEAFFC0A20A1E7F9D0E>I<137813FCA413781300A6EA03FCA2EA007CB2127012F81378
13F0EA70E0EA1F800E26839D0F>I<B4FCA2121FA9EB03FCA2EB01C0EB0300130E5B5B13
7813FC13BE131F7F1480EB07C0EB03E0130138FFE7FEA2171D7F9C19>I<B4FCA2121FB3
A7EAFFE0A20B1D7F9C0E>I<39FF0FC07E903831E18F3A1F40F20780D980FC13C0A2EB00
F8AB3AFFE7FF3FF8A225127F9128>I<38FF0FC0EB31E0381F40F0EB80F8A21300AB38FF
E7FFA218127F911B>I<EA01FC380F0780381C01C0003C13E0387800F0A200F813F8A600
7813F0A2383C01E0381E03C0380F07803801FC0015127F9118>I<38FF3F80EBE1E0381F
80F0EB0078147C143C143EA6143C147C1478EB80F0EBC1E0EB3F0090C7FCA6EAFFE0A217
1A7F911B>I<3803F060380F0CE0EA1E07EA3C03127C127812F8A61278127C123CEA1C07
EA0E0FEA03F3EA0003A6EB1FFCA2161A7E9119>I<EAFE3E1347381E8F80A3381F070090
C7FCAAEAFFE0A211127F9114>I<EA1FD8EA3078EA601812E0A2EAF000EAFF80EA7FE013
F0EA1FF8EA07FCEA007CEAC01CA212E01318EAF830EACFC00E127E9113>I<1203A45AA2
5AA2EA3FFC12FFEA1F00A9130CA4EA0F08EA0798EA03F00E1A7F9913>I<38FF07F8A2EA
1F00AC1301120F380786FFEA01F818127F911B>I<38FFC1FCA2381F00601380000F13C0
A23807C180A23803E300A213F7EA01F613FE6C5AA21378A2133016127F9119>I<39FF8F
F8FEA2391F03E030A3390F87F06013869038C6F8E03907CC78C0A23903FC7D80EBF83D14
3F3901F01F00A20000131EEBE00EA21F127F9122>I<38FFC7FCA2381F81C0380F838038
07C700EA03EEEA01FC5B1200137C13FEEA01DF38039F80EA070F380607C0380C03E038FF
07FCA216127F9119>I<38FFC1FCA2381F00601380000F13C0A23807C180A23803E300A2
13F7EA01F613FE6C5AA21378A21330A25B1270EAF8E05BEAF9800073C7FC123E161A7F91
19>I<387FFF8038781F00EA703FEA603E5B13FC5BEA01F01203485AEBC180EA0F81121F
1303003E1300EA7E07EA7C0FB5FC11127F9115>I<B512FE1701808B18>I
E /Ft 15 111 df<B61280A219027D8A20>0 D<126012F0A2126004047C8B0C>I<004013
2000C01360006013C03830018038180300EA0C066C5A6C5AEA01B0EA00E0A2EA01B0EA03
18EA060C487E487E38300180386000C04813600040132013147A9320>I<1203A4EAC30C
EAE31CEA7338EA1FE0EA0780A2EA1FE0EA7338EAE31CEAC30CEA0300A40E127D9215>I<
EA03C0EA0FF0EA1C38EA300CEA6006A2EAC003A4EA6006A2EA300CEA1C38EA0FF0EA03C0
10107E9115>14 D<EA03C0EA0FF0EA1FF8EA3FFCEA7FFEA2B5FCA4EA7FFEA2EA3FFCEA1F
F8EA0FF0EA03C010107E9115>I<EC01801407EC1E001478EB01E0EB0780011EC7FC1378
EA01E0EA0780001EC8FC127812E01278121EEA0780EA01E0EA0078131EEB0780EB01E0EB
0078141EEC0780140191C7FCA7007FB5FCB6128019227D9920>20
D<12C012F0123C120FEA03C0EA00F0133C130FEB03C0EB00F0143C140FEC0380EC0F0014
3C14F0EB03C0010FC7FC133C13F0EA03C0000FC8FC123C127012C0C9FCA7007FB5FCB612
8019227D9920>I<EB7FF8EA01FF38078000000EC7FC12185AA25AA25AA3B512F8A200C0
C7FCA31260A27EA27E120E6C7E3801FFF8EA007F151A7D961C>50
D<1460A214C0A2EB0180A3EB0300A21306A25BA25BA35BA25BA25BA2485AA248C7FCA312
06A25AA25AA25AA35AA25A124013287A9D00>54 D<1304130CB3A7B612E0A21B1C7D9B21
>63 D<0040130200C01306B20060130CA26C1318001C1370380F01E03803FF803800FE00
171A7E981C>91 D<133C13E0EA01C013801203AD13005A121C12F0121C12077E1380AD12
0113C0EA00E0133C0E297D9E15>102 D<12F0121C12077E1380AD120113C0EA00E0133C
13E0EA01C013801203AD13005A121C12F00E297D9E15>I<12C0A21260A37EA37EA37EA3
7EA27EA3EA0180A3EA00C0A31360A21330A31318A3130CA31306A31303130110297E9E15
>110 D E /Fu 9 58 df<163E167F4B5A15075D157F4AB5FC141F49B6FC0007B7FCB8FC
A414E3EBFE03EAF800C7FCB3B3B3B3007FB912F0A73C6173E056>49
D<ED7FFF020FB512FC91B77E010316F0010F16FC013F16FF4983484848C66C14E04801E0
010F804801800103804848C880001F043F7F6D6C6E7F486D6E148080486D6E14C06E80B5
18E06E801AF0A2831AF8A46C5BA26C5B6C5B6C5B6C5BD801FEC9FCCB14F05FA21AE0A24D
14C0A24D1480A24D1400614D5B614D5B614D5B94B55A4C91C7FC604C5B4C13F04C5B4C5B
95C8FC4C5AEE7FF84C5A4B5B4B13804B90C9FC4B48EC03F8ED1FF84B5A4B48EC07F04B5A
4A90C8FC4A5A4A5A4A48150FEC1FE04A4816E04A5A4AC9121FEB01FC494816FF49B9FC5B
4918C05B5B90BAFC5A5A5A4819805A5A5ABBFCA31A00A3456178E056>I<92381FFFC002
03B512FE021FECFFE0027F15F849B712FE49707E49D9F007804990C780D91FF8023F7FD9
3FE06E7F494882D9FFF06E7F4801FC826E80486D1780A26F16C04880A86C5C1A806C91C7
FC6C495C6D481700EB1FF0D903805E90C9485BA24D5B614D5B94B55A61040349C7FC4C5B
041F13F00303B55A0203B6C8FC4A14FC17FF18E06E15FC91C7000713FF040014C0053F13
F0717F717F717F857114801AC07114E01AF0A21AF8A27114FCA213382603FF8017FE487F
487F487F487F487FA2B57EA31AFCA35F1AF86C5B1AF05C6C494A14E04A17C06C494A1480
6C90C8FC494B14006C6C6C4A5B6C01E04A5BC601FC91B512F090277FFFE0075C6D90B712
80010F94C7FC010316F8D9007F15E0020F4AC8FCDA007F13C0476279E056>I<F007F04E
7EA2181F183F187F18FF5FA25F5F5F5FA25F5F94B5FC5EA25E5E5EEE1FEFEE3FCF178FEE
7F0F16FFED01FEED03FC16F8ED07F0ED0FE0151FED3FC01680ED7F0015FE14014A5A4A5A
5D4A5A141F4A5A4A5A92C7FC14FE495A1303495A5C495A495A133F495A91C8FC13FE485A
1203485A485A5B485A485A127F48C9FC90BB12E0A7CA003F01F8C7FCB1037FB812E0A74B
617BE056>I<0170173801FC17FCD9FFC0150F02F815FFDAFFE0013F5B92B7FC61616161
96C7FC60606060606095C8FC17FC17F017C04CC9FC16F0DA0070CAFC92CBFCAD92380FFF
E092B512FE0207ECFFC0023F15F091B712FCDBF00313FF92C76C7F02F8021F13E002E06E
7F4A6E7F91C880496F7F5B01786F7F90C91580A21AC0A27114E0A21AF0A41AF8A2EA03FE
EA0FFF487F487F487F80B5FCA41AF0A44A4A14E07E4A17C05C6C48C8158001F85DD81FE0
18004D5B6C6C5FD807FC4B5B6C6C4B5B6C6C6C4A5B6C01E091B55AD97FF801035C90273F
FF801F91C7FC6D90B612FC010716F0010116C06D6C4AC8FC020F14F0020049C9FC456278
E056>I<933807FFE093B512FE03076E7E031F15E092B77E0203824A9138007FFC021F01
F8EB07FE4A01C0EB01FF4A90C813804A481407010301F84A13C049495C49495C4E13E049
5B494991B5FC5B90B5C8FCA2485B5A7213C0485B72138048711300725A4A6F5A4894C8FC
A35AA25CA248150C4BB5FC030714E0031F14FC4B14FFB549819226FE001F13E0DAF1F801
077FDAF3F06D7F4B6D7FDAF7C06D7FDAFF806E7E1A8092C86C13C0A24A17E01AF05C7213
F8A24A17FCA41AFE5C7EA77EA46C7F1AFCA27EA21AF87E606C6D17F0A26C19E06C6D17C0
606D6C17806D93B512006D6D5D6D6D495B6D01F001075B6D6D011F5B6D01FF90B512C06D
91B65A023F93C7FC020F15FC020315F0DA007F1480030701F0C8FC476279E056>I<EA03
F8A2487E13FFECFFC092B912C0A35AA31B801B0062625A626262626297C7FC4860A201F8
C9EA0FFC01E04C5A495F4E5A494C5A007F4D5A5F90C94890C8FC4D5A4D5A604D5A00FE4C
5A4D5A17FFC9485B95C9FC4C5A16074C5A5F161F4C5AA24C5A16FFA24B5BA25D4B5BA25D
A24B90CAFCA25DA25D5EA215FFA25CA35CA25EA25CA45CA65CAC6E5BA26E5B6E5B6E5BDA
003ECBFC4A6677E456>I<92380FFFF092B67E020715F0021F15FC027F15FF49B812C049
9026F8007F7F4990C700077FD90FFC02017FD91FF06E6C7ED93FC06F7E017F161F4A6F7E
01FF824890C9148084A24819C084A2487FA280808014FC02FF4B138015C08103F84A1300
15FE6C6E6C495A70131F04F05C6C03FC495A04FF495A6C933881FFE005E35B6D92B5C7FC
6D5E18F86D16E06D826D16FC6D16FF6D836D6C16E06E828591B87E0103834983011F019F
168090263FFE0716C090387FFC0149486C16E04801E0013F15F048150F4849010315F848
4913004890C86C14FC171F48481507050114FE007F8249163F180F00FF8349828484A219
7FA2193F1AFCA27F007F19F8A36DEF7FF0123F6DEFFFE06C6D17C06C5F6E4B13806C01F0
4B13006C6D4B5A6C01FEED7FFC6CD9FFC049485A013F01FC013F13E06D90B75A010794C7
FC010116FCD9003F15F0020792C8FCDA001F13E0476279E056>I<92380FFFE04AB512FE
020FECFFC0023F15F091B712FC0103824949C67F4901F0013F13C0013F01C0010F7F4949
6D7F90B5C76C7F48498048496E7F4884727E485B481980844819C05C1AE05AA21AF0A2B5
821AF8A41AFCA71AFE607EA46C5FA26C7F95B5FC7E6C5EA26C6D5C7E6C6DEC07DF6D6CEC
0F9F6D6D131F6D6DEB3F1F6D01F013FE010390B512FC6D03F814FC6D6C14F0020F14C002
01140091C7126093C7FC1AF860A31AF0A2EB7FC0496C17E0487F486D4B13C0487F1A8048
7F95B51200A24D5B615F4A5E4D5B6C495E4A4A5B4A4A5B6C49027F90C7FC6C48C8485A6D
6C01035B6C01E0010F5BD97FFE017F13E06DB75A6D93C8FC010715FC010115E06D6C91C9
FC020713E0476279E056>I E /Fv 63 123 df<EBFE7C380381C6380603CE000E138400
1C1380A6B512F0381C0380AE38FF8FF0171A809916>11 D<13FEEA038138060180EA0E03
381C010090C7FCA5B51280EA1C03AE38FF8FF0141A809915>I<EA60C0EAF1E0EAF9F0EA
68D0EA0810A3EA1020A2EA2040EA40800C0B7F9913>34 D<1380EA010012025A120C1208
12185AA35AA412E0AA1260A47EA37E1208120C12047E7EEA008009267D9B0F>40
D<7E12407E7E12181208120C7EA37EA41380AA1300A41206A35A1208121812105A5A5A09
267E9B0F>I<126012F0A212701210A31220A21240A2040B7D830B>44
D<EAFFC0A20A0280880D>I<126012F0A2126004047D830B>I<1304130C1318A31330A313
60A313C0A3EA0180A3EA0300A31206A35AA35AA35AA35AA35AA20E257E9B13>I<EA07E0
EA1C38EA381CEA300CEA700EEA6006A2EAE007AAEA6006A2EA700EEA300CEA381CEA1C38
EA07E010187F9713>I<12035AB4FC1207B3A2EA7FF80D187D9713>I<EA0F80EA1060EA20
30EA4038EA803CEAC01C12E01240EA003C1338A21370136013C0EA018013001202EA0404
12081210EA3008EA3FF8127F12FF0E187E9713>I<EA07E0EA1838EA201CEA601EEA700E
EA201E1200131CA213381370EA07E0EA0038131C130E130FA212E0A212C0EA400EEA601C
EA1838EA07E010187F9713>I<1318A21338137813F813B8EA01381202A2120412081218
12101220124012C0B5FCEA0038A6EA03FF10187F9713>I<EA3018EA3FF013E01380EA20
00A5EA2FC0EA3060EA2030EA00381318131CA2124012E0A2EA8018EA40381330EA30E0EA
0F800E187E9713>I<EA01F8EA0704EA0C06EA180E123013001270126012E0EAE3E0EAE4
18EAE80CEAF00EEAE0061307A31260A2EA7006EA300EEA180CEA0C38EA07E010187F9713
>I<1240EA7FFF13FEA2EA4004EA80081310A2EA00201340A21380120113005AA25A1206
A2120EA5120410197E9813>I<EA07E0EA1818EA300CEA20061260A21270EA780CEA3E18
EA1F30EA07C0EA03E0EA0CF8EA307CEA601E130FEAC0071303A3EA6002EA2004EA1818EA
07E010187F9713>I<EA07E0EA1C30EA3018EA700CEA600EEAE006A21307A31260EA700F
EA3017EA1827EA07C7EA00071306130E130C12701318EA6030EA3060EA0F8010187F9713
>I<126012F0A212601200A8126012F0A2126004107D8F0B>I<126012F0A212601200A812
6012F0A212701210A31220A21240A204177D8F0B>I<B61280A2C9FCA6B61280A2190A7E
8D1E>61 D<130CA3131EA2132F1327A2EB4380A3EB81C0A200017F1300A248B47E380200
70A2487FA3487FA2003C131EB4EBFFC01A1A7F991D>65 D<EB3F023801C0C63803002E00
0E131E48130E14065A007813021270A200F01300A600701302A21278003813047E14087E
000313303801C0C038003F00171A7E991C>67 D<B57E380E00E01470808080A280A21580
A81500A25C140E5CA2147814E0B51280191A7F991D>I<B512F8380E003814181408140C
1404A3EB0100A35BEA0FFFEA0E037FA3EB0002A314061404A2140C143CB512FC171A7F99
1A>I<B512F8380E003814181408140C1404A3EB0100A35BEA0FFFEA0E037FA390C7FCA8
EAFFE0161A7F9919>I<EB3F023801C0C63803002E000E131E48130E14065A0078130212
70A200F090C7FCA5903801FFC03970000E00A2127812387EA27E000313163801C0663800
3F821A1A7E991E>I<EAFF80EA1C00B3A6EAFF80091A7E990E>73
D<EAFFE0000EC7FCB01408A3141814101430147014F0B5FC151A7F9918>76
D<B414FF000F14F0A2390B800170A23809C002A33808E004A2EB7008A3EB3810A3EB1C20
A2EB0E40A3EB0780A2EB0300121C39FF8307FF201A7F9923>I<00FEEB7FC0000FEB0E00
1404EA0B80EA09C0A2EA08E01370A21338131CA2130E1307EB0384A2EB01C4EB00E4A214
74143CA2141C140C121C38FF80041A1A7F991D>I<137F3801C1C038070070000E7F487F
003C131E0038130E0078130F00707F00F01480A80078EB0F00A20038130E003C131E001C
131C6C5B6C5B3801C1C0D8007FC7FC191A7E991E>I<B51280380E01E0EB007014781438
143CA4143814781470EB01E0380FFF80000EC7FCABEAFFE0161A7F991A>I<007FB5FC38
701C0700401301A200C0148000801300A300001400B13803FFE0191A7F991C>84
D<39FFE07FC0390E000E001404B200065B12076C5B6C6C5A3800E0C0013FC7FC1A1A7F99
1D>I<EA2040A2EA4080A2EA8100A3EAE1C0EAF1E0A2EA60C00B0B7A9913>92
D<EA1FC0EA38707FEA101C1200A2EA03FCEA1E1C1238127012E01480A2133CEA705F381F
8F0011107F8F13>97 D<12FC121CA913FCEA1D07381E0380381C01C0130014E0A6EB01C0
1480381E0300EA1906EA10F8131A809915>I<EA07F8EA1C1C1238EA700813005AA61270
1304EA3808EA1C18EA07E00E107F8F11>I<133F1307A9EA03E7EA0C17EA180F487E1270
12E0A6126012706C5AEA1C373807C7E0131A7F9915>I<EA07C0EA1C30EA30181270EA60
0C12E0EAFFFCEAE000A41260EA7004EA3808EA1C18EA07E00E107F8F11>I<EA01F0EA07
18EA0E38EA1C101300A6EAFFC0EA1C00AEEAFF800D1A80990C>I<EA0FCF381871803830
3000EA7038A4EA30306C5AEA2FC00060C7FCA21270EA3FF013FC6C7EEA600FEAC003A4EA
6006EA381CEA07E011187F8F13>I<12FC121CA9137CEA1D87381E0380A2121CAB38FF9F
F0141A809915>I<1218123CA212181200A612FC121CAE12FF081A80990A>I<EA0180EA03
C0A2EA0180C7FCA6EA0FC01201B21241EAE180EAE300127E0A2182990C>I<12FC121CA9
EB1FC0EB0F00130C5B13205B13E0121DEA1E70EA1C7813387F131E7F148038FF9FE0131A
809914>I<12FC121CB3A6EAFF80091A80990A>I<38FC7C1F391D8E6380391E0781C0A200
1C1301AB39FF9FE7F81D107F8F20>I<EAFC7CEA1D87381E0380A2121CAB38FF9FF01410
808F15>I<EA07E0EA1C38EA300CEA700EEA6006EAE007A6EA6006EA700EEA381CEA1C38
EA07E010107F8F13>I<EAFCFCEA1D07381E0380381C01C0A2EB00E0A6EB01C01480381E
0300EA1D06EA1CF890C7FCA6B47E1317808F15>I<EA03E1EA0C13EA180BEA300FEA7007
12E0A61270A26C5AEA1C37EA07C7EA0007A6EB3FE013177F8F14>I<EAFC78EA1D9CEA1E
1C1308EA1C00ABEAFF800E10808F0F>I<EA1F20EA60E0EA402012C0A2EAF000127FEA3F
C0EA1FE0EA00F0EA8070133012C01320EAF040EA8F800C107F8F0F>I<1208A41218A212
38EAFFC0EA3800A81320A41218EA1C40EA07800B177F960F>I<38FC1F80EA1C03AB1307
120CEA0E0B3803F3F01410808F15>I<38FF0F80383C0700EA1C061304A26C5AA26C5AA3
EA03A0A2EA01C0A36C5A11107F8F14>I<39FE7F1F8039381C0700003C1306381C0C0413
0E380E16081317A238072310149013A33803C1A014E0380180C0A319107F8F1C>I<38FE
3F80383C1E00EA1C086C5AEA0F306C5A6C5A12017F1203EA0270487E1208EA181CEA381E
38FC3FC012107F8F14>I<38FF0F80383C0700EA1C061304A26C5AA26C5AA3EA03A0A2EA
01C0A36C5AA248C7FCA212E112E212E4127811177F8F14>I<EAFFF8EAE07012C0EA80E0
EA81C0A2EA0380EA0700A2EA0E04121CA2EA380812701338EAFFF80E107F8F11>I
E /Fw 76 123 df<9038FC1F800001133F0003137F390700E000380E01C0A738FFE1FCA2
380E01C0B0191D809C18>11 D<3801F1C0120312071301120EA7EAFFF1A2EA0E01B0121D
809C16>13 D<13F0EA03F8487E131CEA060E120EA4131E5B133813786C5A9038E0018013
C0390F800300EA1FC0123D3879E0060070130E38F0700C38E07818EB3C386D5AEB0EE038
600FC0D87007134039381FE0C0381FF8FF390FE03F001A1F7E9D1F>38
D<EA01C0EA0380EA0700120EA25AA25AA35AA45AAE1270A47EA37EA27EA27EEA0380EA01
C00A2A7D9E10>40 D<12E012707E7EA27EA27EA3EA0380A4EA01C0AEEA0380A4EA0700A3
120EA25AA25A5A5A0A2A7E9E10>I<120313801300A2EAE31CEAF33CEAFB7CEA3FF0EA0F
C0A2EA3FF0EAFB7CEAF33CEAE31CEA0300A2138013000E127D9E15>I<1306ADB612E0A2
D80006C7FCAD1B1C7E9720>I<12E0A312601240A312C003087C820C>I<EAFFE0A20B0280
890E>I<12E0A303037C820C>I<130113031306A3130CA31318A31330A31360A213C0A3EA
0180A3EA0300A31206A25AA35AA35AA35AA35AA210297E9E15>I<EA03C0EA0FF0EA1FF8
EA3C3CEA381CEA700EA3EAE007ADEA700EA3EA381CEA3C3CEA1FF8EA0FF0EA07E0101D7E
9B15>I<5A1207123FB4FC12C71207B3A3EAFFF8A20D1C7C9B15>I<EA07C0EA1FF0EA3878
EA701CEA601EEAE00EEAC00F124013071200A2130F130E131E131C133C137813F0EA01E0
13C0EA0380EA0700120E5A5A5AB5FCA2101C7E9B15>I<EA07E0EA1FF0EA3838EA701CEA
E01E1240A21200A2131C133C1378EA07F013E013F0EA003C131C131E130FA41280A2EAC0
1EEA601CEA383CEA1FF0EA07C0101D7E9B15>I<133C137C135C13DCA2EA019C1203A2EA
071CA2120EA2121CA212381278127012F0B512C0A238001C00A7121B7F9A15>I<EA3FFF
A20038C7FCA7EA39F0EA3FF87F131EEA3C0FA2383807801200A638400F0012E0EA701E6C
5AEA1FF8EA07E0111C7F9A15>I<13F8EA03FCEA0704EA0E005A5AA25AA2EA71F0EAE7F8
EAEFFCEAFC3CEAF81EEAF00E130712E0A51270A2130E1230EA381CEA1C38EA0FF0EA03E0
101D7E9B15>I<B5FCA2EA0007130E131CA213381378137013F013E01201A2EA03C0A3EA
0780A413005AA6101B7E9A15>I<EA07E0EA1FF8EA3C3CEA700EA2EAE007A4EA700EA2EA
3C3CEA1FF8EA07E0EA1FF8EA3C3CEA700EA2EAE007A6EA700EEA781EEA3C3CEA1FF8EA07
E0101D7E9B15>I<EA03C0EA0FF0EA1C38EA381CEA700C130E12E013061307A5130F1270
EA781FEA3C3FEA3FF7EA1FE7EA0F86EA000EA2130C131C1318EA2038EA70F0EA3FC0EA0F
80101D7E9B15>I<12E0A31200AC12E0A303127C910C>I<007FB512C0B612E0C9FCA8B612
E06C14C01B0C7E8F20>61 D<131C133EA2132E1367A2EBE78013C713C300017F13831381
00037F1301486C7EA21206000E1378380FFFF8A2381C003CA2121800387FA248131F8012
6000E0EB0780191D7F9C1C>65 D<EAFFF813FF38F00F80EB03C0EB01E0EB00F0A5EB01E0
EB07C0B51280EBFE00EBFF8038F01FC0EB03E0EB01F013001478A514F0EB01E0EB07C0B5
1280EBFC00151D7C9C1C>I<EB3FC03801FFF8EA03C03807801848C7FC121E5AA25AA35A
A91278A37EA27E6C1308380780183803C0783801FFF038003F80151F7D9D1B>I<EAFFFC
13FF38F00F80EB03E01301EB00F014781438143CA2141C141EA8143CA3147814F0A2EB03
E0EB0FC0B5120013FC171D7C9C1E>I<B512C0A200F0C7FCABB51280A200F0C7FCACB512
C0A2121D7C9C19>I<B51280A200F0C7FCABB5FCA200F0C7FCAE111D7C9C18>I<EB3FC0EB
FFF83803E07C3807801C380F000C001E1300121C123C12381278A25AA6EB03FCA2EB001C
1278A21238123C121C121E7EEA07803803E07C3800FFF8EB3FC0161F7E9D1C>I<00F013
F0ADB5FCA2EAF000AE141D7C9C1D>I<12F0B3AB041D7C9C0C>I<00F0133C147814F0EB01
E0EB03C0EB0780EB0F00131E5B5B5B5BEAF1F012F3EAF778EAFE7CEAFC3C7FEAF81F487E
14801307EB03C014E01301EB00F0A21478147C161D7C9C1D>75 D<12F0B3A9B5FCA2101D
7D9C16>I<00FCEB07E0A300EE130DA300E71319A3EB803900E31331EBC071A200E11361
A2EBE0E1A200E013C113F1EB7181A3EB3B01A3131EA313001B1D7C9C24>I<00FC1370A2
7E12EE12EF12E7A2138012E313C0A2EAE1E0A212E013F013701378A2133CA2131C131E13
0EA2130F130714F01303A2141D7C9C1D>I<133F3801FFE0487F3807C0F8380F807C381E
001E003E131F003C7F48EB0780A348EB03C0A86C130700781480A2007C130F003C140000
3E5B6C133E6C6C5A6C6C5A6CB45A6C5BD8003FC7FC1A1F7E9D1F>I<EAFFFC13FF38F00F
80EB03C0EB01E0EB00F0A6EB01E01303EB0FC0B51280EBFE0000F0C7FCAD141D7C9C1B>
I<133F3801FFE0487F3807C0F8380F807C48487E003E7F003C7F48EB0780A348EB03C0A9
0078EB0780A2130E393C0F0F00383E079F381E03DE380F83FC6C6C5A6CB45A6C7F38003F
78EB003C143E80EC0F801A237E9D1F>I<EAFFF813FF38F00F80EB03C0EB01E0EB00F0A5
EB01E01303EB0FC0B51280140013F8EAF03C131C131E7FA2EB0780A2EB03C0A2EB01E0EB
00F0A21478151D7C9C1B>I<EA03F8EA0FFEEA1C0F487E487E0060C7FC12E0A47E127812
7FEA3FE0EA1FFCEA07FEEA01FF38001F801307EB03C0A21301A400C01380EAE00338F007
00EA7C0EEA1FFCEA07F0121F7E9D17>I<B61280A2D8001EC7FCB3A9191D7F9C1C>I<00F0
1370B3A5007813E0A2383C01C0381E0380EA0F073807FE00EA01F8141E7C9C1D>I<00F0
EB0380A2007814005CA26C130EA2123E001E5BA26C5BA36C6C5AA23803C06014E0A26C6C
5A13E1A23800F18013F30173C7FCA2137B133EA2131C191D7F9C1C>I<00F001F81370A3
007801B81360D9019C13E0A3D83C03EB01C0141E140E001E15809038070F031306140700
0F1500010E1387130C0007EB0386A2019C138E019813CE0003EB01CCA339019000C801D0
13D801F013F85B00001470241D7F9C27>I<00F8130E007C131E003C5B6C13386C13785C
380781E03803C1C0EA01C3EBE780D800F7C7FC137E133E133CA2137E1377EBE780EA01E3
3803C1C0EB81E048C67E487F000E1378487F003C133E487F00707F00F01480191D7F9C1C
>I<00F8EB01E0007C14C06CEB0380001E1307001F1400380F800E0007131EEBC01C3803
E03C000113386D5A000013F0EB78E0EB7DC0133F6D5A91C7FC7FAC1B1D809C1C>I<387F
FFF0A2380001E0130314C013071480EB0F005B131E133E133C5B13F85B12015B485A1207
5B120F90C7FC121E123E123C127C1278B512F0A2141D7E9C19>I<12FFA312E0B3B112FF
A308297D9E0C>I<12FFA31207B3B112FFA30829809E0C>93 D<EA0FC0EA3FF0EA7FF8EA
7038EA401C1200A213FC120F123FEA781C12E0A3EAF07CEA7FFC13DCEA3F1C0E127E9114
>97 D<12E0ABEAE3E0EAEFF8EAFFFCEAF83EEAE01E130E1307A6130EEAF01EEAF83CEAFF
F8EAEFF0EAE3E0101D7D9C15>I<EA03F0EA0FFCEA1FFEEA3C0EEA7802EA70005AA61270
EA7802EA3C0EEA1FFEEA0FFCEA03F00F127F9112>I<1307ABEA07C7EA1FF7EA3FFFEA3C
1FEA7807127012E0A61270EA780FEA3C1FEA3FFFEA1FF7EA07C7101D7F9C15>I<EA07E0
EA0FF0EA3FF8EA3C3CEA700C130EEAFFFEA3EAE000A31270EA7802EA3C0EEA1FFEEA0FFC
EA03F00F127F9112>I<13FC12011203EA0700120EA7EAFFE0A2EA0E00B00E1D809C0D>I<
3807C3C0EA0FFF5A38383800487EA56C5AEA3FF05BEA77C00070C7FCA2EA3FFC13FF4813
80EA700738E001C0A3EAF003387C0F80383FFF006C5AEA07F8121B7F9115>I<12E0ABEA
E3E0EAEFF0EAFFF8EAF83CEAF01C12E0AD0E1D7D9C15>I<12F0A41200A71270B2041D7E
9C0A>I<EA03C0A4C7FCA7EA01C0B3A412C3EAFF801300123E0A25839C0B>I<12E0AB133C
137813F0EAE1E0EAE3C0EAE780EAEF00B4FC138012FBEAF9C0EAF1E012E013F013781338
133C131E0F1D7D9C14>I<12E0B3AB031D7D9C0A>I<38E3F03F39EFF8FF80D8FFFD13C039
F81F81E038F00F00EAE00EAD1B127D9122>I<EAE3E0EAEFF0EAFFF8EAF83CEAF01C12E0
AD0E127D9115>I<EA03F0EA0FFC487EEA3C0F38780780EA700338E001C0A5EAF0030070
1380EA7807383C0F00EA1FFE6C5AEA03F012127F9115>I<EAE3E0EAEFF8EAFFFCEAF83E
EAE01E130E1307A5130F130EEAF01EEAF87CEAFFF8EAEFF0EAE3E0EAE000A8101A7D9115
>I<EA07C7EA0FF7EA1FFFEA3E1FEA780FEA700712F012E0A51270EA780FEA3C1FEA3FFF
EA1FF7EA07C7EA0007A8101A7F9115>I<EAE38012E712EFEAFC005A5AA25AAB09127D91
0E>I<EA1FC0EA3FF0127FEAF030EAE000A27E127FEA3FC0EA1FE0EA01F0EA0038A21280
EAF078EAFFF0EA7FE0EA1FC00D127F9110>I<121CA6EAFFE0A2EA1C00AC1320EA1FF012
0FEA07C00C187F970F>I<EAE01CAE137CEAFFFCEA7FDCEA3F1C0E127D9115>I<EAE007A2
12F0EA700EA2EA381CA3EA1C38A3EA0E70A2EA0660120713E0EA03C0A210127F9113>I<
39E03E0380A3D870371300EB7707A213733838E38EA33818E18C381CC1CC001D13DCA238
0D80D8000F13F8A20007137019127F911C>I<3870038038780700EA3C0EEA1C1C120E6C
5AEA03F06C5A5B7F487EEA0738EA0618EA0E1C487E487E3870038000F013C01212809113
>I<EAE007A2EA700EA21278EA381CA2121C1338120CEA0E3013701206EA0760120313C0
1201A21380A2EA0300A25A12FE5A5A101A7F9113>I<EA7FFCA3EA007813F013E01201EA
03C01380EA07005A121E121C123C5AEAFFFCA30E127F9112>I E
/Fx 1 98 df<13201370A313B8A3EA011CA2EA031EEA020EA2487EEA07FFEA0407380803
80A2001813C01301123838FC07F815157F9419>97 D E /Fy 2 14
df<EA4001EAC003EA6006EA300CEA1818EA0C30EA0660EA03C0EA0180A2EA03C0EA0660
EA0C30EA1818EA300CEA6006EAC003EA400110127B901B>2 D<EB0FC0EB7FF83801F03E
38038007390600018048EB00C0481460481430A2481418A248140CA700601418A26C1430
A26C14606C14C06CEB018039038007003801F03E38007FF8EB0FC01E1D7E9623>13
D E /Fz 81 128 df<EBFCF83807839CEA0E07001C13081400A5B512E0381C0700AC387F
1FE01617809615>11 D<13FCEA0782EA0E07121C130290C7FCA4B5FCEA1C07AC387F1FC0
1217809614>I<EBFC7E380703C1390E078380001C1303EC010091C7FCA4B61280381C07
03AC397F1FCFE01B1780961D>14 D<EA60C0EAF1E0A21270EA1020A2EA2040A2EA4080A2
0B0A7F9612>34 D<126012F0A212701210A21220A21240A2040A7D960A>39
D<120112021204120C1218A21230A212701260A312E0AA1260A312701230A21218A2120C
12041202120108227D980E>I<12801240122012301218A2120CA2120E1206A31207AA12
06A3120E120CA21218A2123012201240128008227E980E>I<126012F0A212701210A212
20A21240A2040A7D830A>44 D<EAFF80A2090280870C>I<126012F0A2126004047D830A>
I<130813181330A31360A313C0A3EA0180A3EA0300A21206A35AA35AA35AA35AA35AA20D
217E9812>I<EA07C0EA1830EA3018EA701CEA600CA2EAE00EA9EA600CA2EA701CEA3018
EA1C70EA07C00F157F9412>I<1206120E12FE120EB1EAFFE00B157D9412>I<EA0F80EA30
E0EA4070EA8030EAC03812E0124012001370A2136013C0EA0180EA03001206EA0C081208
EA1018EA3FF0127F12FF0D157E9412>I<EA0FE0EA3030EA6018EA701CA2120013181338
1360EA07E0EA00301318130C130EA212E0A2EAC00CEA4018EA3030EA0FE00F157F9412>
I<1330A2137013F012011370120212041208121812101220124012C0EAFFFEEA0070A5EA
03FE0F157F9412>I<EA6030EA7FE013C0EA44001240A4EA4F80EA70E0EA4070EA003013
38A2124012E0A2EA8030EA4060EA20C0EA1F000D157E9412>I<EA01F0EA0608EA080CEA
181C1230EA7000126012E0EAE3E0EAEC30EAF018130CEAE00EA31260A2EA300C1318EA18
30EA07C00F157F9412>I<1240EA7FFE13FC13F8EAC008EA80101320EA00401380A2EA01
005AA212021206A2120EA512040F167E9512>I<EA07E0EA1830EA2018EA600CA21270EA
7818EA3E10EA1F60EA07C0EA0FF0EA18F8EA607C131EEAC00E1306A21304EA600CEA3830
EA0FE00F157F9412>I<EA07C0EA1830EA30181260EAE00CA2130EA3EA601E1230EA186E
EA0F8EEA000E130C131CEA7018A2EA6030EA20E0EA1F800F157F9412>I<126012F0A212
601200A6126012F0A21260040E7D8D0A>I<126012F0A212601200A6126012F0A2127012
10A21220A21240A204147D8D0A>I<EA1F80EA60E0EA807012E0A21240EA00E0EA01C013
80EA03001202A5C7FCA41206120FA212060C177E9611>63 D<13101338A3135CA3138EA3
EA0107A238020380A33807FFC0EA0401A2380800E0A2001813F0123838FE03FE17177F96
1A>65 D<EAFFFE381C0380EB00E014601470A414E0EB01C0381FFF8014C0381C00E01470
14301438A4147014E0EB01C0B5120015177F9619>I<EBFC1038038330380E00B0481370
481330123000701310126012E01400A51410126012700030132012386C13406C13803803
8300EA00FC14177E9619>I<B5FC381C01C0EB00E0143014381418141C140C140EA7140C
141CA2143814301460EB01C0B5120017177F961B>I<B512E0EA1C00146014201410A3EB
0400A3130CEA1FFCEA1C0C13041408A2130014181410A2143014F0B5FC15177F9618>I<
B512E0EA1C00146014201410A3EB0400A3130CEA1FFCEA1C0C1304A390C7FCA6EAFFC014
177F9617>I<EB7E0838038198380600584813384813185A00701308A25A1400A4EB03FE
EB00381270A212307E7E7E380380D838007F0817177E961C>I<38FF83FE381C0070AA38
1FFFF0381C0070AA38FF83FE17177F961A>I<EAFFE0EA0E00B3A3EAFFE00B177F960D>I<
EA0FF8EA00E0B112E0A2EAC1C0EA6180EA1F000D177E9612>I<38FF80FE381C00781460
14401480EB0100130613085B13381378139CEA1D0E121EEA1C07EB0380EB01C0A2EB00E0
14701478147C38FF80FF18177F961B>I<EAFFC0001CC7FCAD1420A31460A2144014C013
03B5FC13177F9616>I<00FEEB03F8001E14C000171305A338138009A23811C011A33810
E021A2EB7041A3EB3881A2EB1D01A2130EA2123839FE040FF81D177F9620>I<00FC13FE
001E1338001F13101217EA1380EA11C0A2EA10E013701338A2131C130E130F1307EB0390
EB01D0A2EB00F014701430123800FE131017177F961A>I<13FCEA0303380E01C0381C00
E048137000301330007013380060131800E0131CA700701338A200301330003813706C13
E0380E01C038030300EA00FC16177E961B>I<EAFFFE381C0380EB00C014601470A41460
14C0EB0380381FFE00001CC7FCAAB47E14177F9618>I<13FCEA0303380E01C0381C00E0
4813700030133000701338A248131CA700601318007013380030133038387870381C84E0
380E85C0380383003800FE0413021303148CEB01F8A2EB00F0161D7E961B>I<EAFFFC38
1C0380EB00C014E01470A414E014C0EB0380381FFE00381C0780EB01C0EB00E0A514E1A2
147238FF803C18177F961A>I<EA0FC4EA302CEA601CEA400CEAC004A3EAE0001270127F
EA3FE0EA0FF8EA01FCEA001C130E13061280A3EAC004EAE008EAD810EA87E00F177E9614
>I<387FFFF83860381800401308A200801304A300001300AF3803FF8016177F9619>I<38
FF80FE381C00381410B06C132012066C13403801818038007E0017177F961A>I<B4137E
003C1338001C1310A26C1320A2000F13606C1340A238038080A213C100011300A2EA00E2
A213F21374A21338A3131017177F961A>I<3AFF07FC3F803A3C00E00E00001C1404A2EB
0170000E5CA2EB023800075CA2EB041CD803845BA2EB880ED801C85BA2EBD007D800F05B
A3EBE003016090C7FCA221177F9624>I<38FF83FC381F01E0380E00807EEB8100EA0382
EA01C213E4EA00E81378A21338137C135E138EEA0187EB0780EA0203380601C0000413E0
EA0C00001C13F038FF03FE17177F961A>I<39FF803F80391E001C00000E13086C5BEB80
30000313206C6C5A13E000005B13F10171C7FC133A133E131CA9EBFF80191780961A>I<
B5128038F0070012C0130EEA801E131C5BEA007813705BA2485A485AA2380700805A120E
EA1C01003C13001238485A130FB5FC11177E9616>I<12FCA212C0B3AB12FCA206217D98
0A>I<EA2040A2EA4080A2EA8100A2EAE1C0EAF1E0A2EA60C00B0A7B9612>I<12FCA2120C
B3AB12FCA2062180980A>I<EA3FC0EA70601330EA20381200EA03F8EA1E3812301270EA
E039A21379EA70FFEA1F1E100E7F8D12>97 D<12F81238A8EA39F0EA3E0CEA380613077F
1480A414005B1306EA361CEA21F011177F9614>I<EA07F0EA18381230EA7010EA600012
E0A41260EA70081230EA1830EA07C00D0E7F8D10>I<133E130EA8EA07CEEA1C3EEA300E
1270126012E0A412601270EA301EEA182E3807CF8011177F9614>I<EA0FC0EA1860EA30
30EA7038EAE018EAFFF8EAE000A31260EA7008EA3010EA1830EA07C00D0E7F8D10>I<EA
03E0EA0670120EEA1C201300A5EAFF80EA1C00ACEA7F800C1780960B>I<EA0F9EEA18E3
EA3060EA7070A3EA3060EA18C0EA2F80EA20001260EA3FE013F813FCEA600EEAC006A3EA
600CEA3838EA0FE010157F8D12>I<12F81238A813F8EA3B1CEA3C0E1238AA38FE3F8011
177F9614>I<12301278A212301200A512F81238AC12FE07177F960A>I<1203EA0780A2EA
0300C7FCA5EA1F801203AF1243EAE30012E7127C091D82960B>I<12F81238A8133E1338
1330134013801239EA3FC0EA39E0123813F01378133CA2EAFE7F10177F9613>I<12F812
38B3A312FE07177F960A>I<38F8F83E383B1CC7393C0F0380EA380EAA39FE3F8FE01B0E
7F8D1E>I<EAF8F8EA3B1CEA3C0E1238AA38FE3F80110E7F8D14>I<EA07C0EA1830EA3018
EA600CA2EAE00EA5EA701CEA3018EA1830EA07C00F0E7F8D12>I<EAF9F0EA3E1CEA3806
13077F1480A414005B130EEA3E1CEA39F00038C7FCA512FE11147F8D14>I<EA07C2EA1C
26EA381EEA700E126012E0A412601270EA301EEA1C2EEA07CEEA000EA5EB3F8011147F8D
13>I<EAF9E0EA3A70123CEA38201300A9B4FC0C0E7F8D0E>I<EA1F40EA60C0EAC040A2EA
E000B4FCEA7F80EA1FC0EA01E0EA8060A212C0EAE0C0EA9F000B0E7F8D0E>I<1208A312
18A21238EAFFC0EA3800A71340A4EA1C80EA0F000A147F930E>I<EAF83EEA380EAA131E
EA1C2E3807CF80110E7F8D14>I<EAFE1FEA380EEA3C0CEA1C08A2EA0E10A2EA0720A213
E0EA03C0A2EA0180A2100E7F8D13>I<38FEFE7C383838381410133C001C1320134C381E
4E60380ECE401387000713801303A200031300EA0201160E7F8D19>I<EAFE3FEA3C1CEA
1C10EA0E20EA074013C0EA0380EA01C0EA02E0EA04F0EA0870EA1838EA383CEAFC7F100E
7F8D13>I<EAFE1FEA380EEA3C0CEA1C08A2EA0E10A2EA0720A213E0EA03C0A2EA0180A2
1300A212E2A212A4127810147F8D13>I<EAFFF0EAC0E01280EA81C0EA83801287EA0700
120EEA1E08121CEA3818EA70101330EAFFF00D0E7F8D10>I<B512801101808812>I<EA60
C0EAF1E0A2EA60C00B047D9612>127 D E /FA 90 128 df<EB7E1F3901C1B180390303
E3C0000713C3000EEBC180903801C000A6B512FC380E01C0B0387F87FC1A1D809C18>11
D<137E3801C180EA0301380703C0120EEB018090C7FCA5B512C0EA0E01B0387F87F8151D
809C17>I<EB7FC0EA01C1EA03031207EA0E01A7B5FCEA0E01B0387FCFF8151D809C17>I<
90383F07E03901C09C18380380F0D80701133C000E13E00100131892C7FCA5B612FC390E
00E01CB03A7FC7FCFF80211D809C23>I<90383F07FC3901C0DC1C390381F03CEA070100
0EEBE01C1300A6B612FC390E00E01CB03A7FC7FCFF80211D809C23>I<EAFFFC0E017D98
15>22 D<126012F0A71260AD1200A5126012F0A21260041E7C9D0C>33
D<EA6060EAF0F0EAF8F8EA6868EA0808A3EA1010A2EA2020EA4040EA80800D0C7F9C15>
I<9038030180A39038060300A5EB0C06A4495A007FB512F8B612FC3900301800A4495AA4
B612FC6C14F83900C0600048485AA438030180A4D80603C7FCA31E257E9C23>I<126012
F012F812681208A31210A2122012401280050C7C9C0C>39 D<1380EA0100120212065AA2
5AA25AA35AA412E0AC1260A47EA37EA27EA27E12027EEA0080092A7C9E10>I<7E12407E
12307EA27EA27EA37EA41380AC1300A41206A35AA25AA25A12205A5A092A7E9E10>I<13
06ADB612E0A2D80006C7FCAD1B1C7E9720>43 D<126012F0A212701210A41220A2124012
80040C7C830C>I<EAFFE0A20B0280890E>I<126012F0A2126004047C830C>I<13011303
1306A3130CA31318A31330A31360A213C0A3EA0180A3EA0300A31206A25AA35AA35AA35A
A35AA210297E9E15>I<EA03C0EA0C30EA1818EA300CA2EA700EEA6006A2EAE007ADEA60
06A2EA700EEA300CA2EA1818EA0C30EA07E0101D7E9B15>I<5A1207123F12C71207B3A5
EAFFF80D1C7C9B15>I<EA07C0EA1830EA201CEA400C130EEAF00F12F81307A21270EA00
0F130EA2131CA213381370136013C0EA0180EA0300EA0601120C1218EA1002EA3FFE127F
12FF101C7E9B15>I<EA07E0EA1830EA201CA2EA781E130E131E1238EA001CA213181330
1360EA07C0EA0030131CA2130E130FA2127012F8A3EAF00EEA401C1220EA1830EA07C010
1D7E9B15>I<130CA2131C133CA2135C13DC139CEA011C120312021204120C1208121012
301220124012C0B512C038001C00A73801FFC0121C7F9B15>I<EA300CEA3FF813F013C0
EA2000A6EA23E0EA2C30EA3018131CEA200E1200130FA3126012F0A3EA800EEA401E131C
EA2038EA1870EA07C0101D7E9B15>I<13F0EA030CEA0404EA0C0EEA181E1230130CEA70
00A21260EAE3E0EAE430EAE818EAF00C130EEAE0061307A51260A2EA7006EA300E130CEA
1818EA0C30EA03E0101D7E9B15>I<1240387FFF801400A2EA4002485AA25B485AA25B13
60134013C0A212015BA21203A41207A66CC7FC111D7E9B15>I<EA03E0EA0C30EA1008EA
200C13061260A21270A2EA7C0CEA3E18EA3FB0EA1FE0EA07F013F8EA18FCEA307EEA601E
130FEAC0071303A4EA60021304EA300CEA1C10EA07E0101D7E9B15>I<EA03C0EA0C30EA
1818EA300C1270EA600EEAE006A21307A51260EA700F1230EA1817EA0C27EA07C7EA0006
A2130EEA300C127813181270EA2030EA10C0EA0F80101D7E9B15>I<126012F0A2126012
00AA126012F0A2126004127C910C>I<126012F0A212601200AA126012F0A212701210A4
1220A212401280041A7C910C>I<007FB512C0B612E0C9FCA8B612E06C14C01B0C7E8F20>
61 D<EA0FE0EA3038EA401CEAE00E12F0A3EA000C131C1330136013C0138012011300A6
C7FCA51203EA0780A2EA03000F1D7E9C14>63 D<1306A3130FA3EB1780A2EB37C01323A2
EB43E01341A2EB80F0A338010078A2EBFFF83802003CA3487FA2000C131F80001E5BB4EB
FFF01C1D7F9C1F>65 D<B512C0380F00788080140E140FA4140E141E5C14F8EBFFF0EB00
3C8080801580A5EC0F00A2141E1478B512E0191C7F9B1D>I<90381F8080EBE061380180
1938070007000E13035A14015A00781300A2127000F01400A8007014801278A212386CEB
0100A26C13026C5B380180083800E030EB1FC0191E7E9C1E>I<B512C0380F00F0143C14
0E80A2EC038015C01401A215E0A815C0A21403158014071500140E5C1470B512C01B1C7E
9B20>I<B512FC380F003C140C1404A214061402A213011400A35B13FF13037FA3140113
001402A31406A2140C143CB512FC181C7E9B1C>I<B512F8380F007814181408A2140C14
04A213011400A35B13FF13037FA490C7FCA8EAFFF8161C7E9B1B>I<90381F8080EBE061
3801801938070007000E13035A14015A00781300A2127000F01400A6ECFFF0EC0F800070
13071278A212387EA27E6C130B380180113800E06090381F80001C1E7E9C21>I<39FFF0
FFF0390F000F00AC90B5FCEB000FAD39FFF0FFF01C1C7F9B1F>I<EAFFF0EA0F00B3A8EA
FFF00C1C7F9B0F>I<3807FF8038007C00133CB3127012F8A21338EA7078EA4070EA30E0
EA0F80111D7F9B15>I<39FFF01FE0390F000780EC060014045C5C5C5C5C49C7FC130213
06130FEB17801327EB43C0EB81E013016D7E1478A280143E141E80158015C039FFF03FF0
1C1C7F9B20>I<EAFFF8EA0F8090C7FCB01408A31418A2141014301470EB01F0B5FC151C
7E9B1A>I<B46CEBFF80000FECF800A2390BC00178A33809E002A23808F004A3EB7808A3
EB3C10A3EB1E20A3EB0F40A2EB0780A3EB0300121C3AFF8307FF80211C7E9B26>I<B4EB
1FF0390F8003809038C00100120BEA09E0EA08F0A21378133C133E131E130F14811307EB
03C1EB01E114F113001479147D143D141FA2808080121CB46C7E1C1C7F9B1F>I<EB3F80
EBE0E03803803848487E000E7F487F003C148000381303007814C0A20070130100F014E0
A8007014C000781303A200381480003C1307001C14006C130E6C5B6C6C5A3800E0E0EB3F
801B1E7E9C20>I<B51280380F00E01478143C141C141EA5141C143C147814E0EBFF8090
C7FCACEAFFF0171C7E9B1C>I<EB3F80EBE0E03803803848487E000E7F487F003C148000
381303007814C0A20070130100F014E0A8007014C000781303A200381480383C0E07D81C
111300380E208E0007135C3803A0783900F0E020133FEB0060EC3060EC38E0EC3FC0A2EC
1F80EC0F001B257E9C20>I<B5FC380F01E0EB007880141C141EA4141C143C5CEB01E001
FFC7FCEB01E0EB0070147880A61510A2141CA239FFF00E20C7EA03C01C1D7E9B1F>I<38
07E080EA1C19EA30051303EA600112E01300A36C13007E127CEA7FC0EA3FF8EA1FFEEA07
FFC61380130FEB07C0130313011280A300C01380A238E00300EAD002EACC0CEA83F8121E
7E9C17>I<007FB512C038700F010060130000401440A200C014201280A300001400B149
7E3803FFFC1B1C7F9B1E>I<39FFF01FF0390F000380EC0100B3A26C1302138000035BEA
01C03800E018EB7060EB0F801C1D7F9B1F>I<39FFE00FF0391F0003C0EC01806C1400A2
38078002A213C000035BA2EBE00C00011308A26C6C5AA213F8EB7820A26D5AA36D5AA213
1F6DC7FCA21306A31C1D7F9B1F>I<3AFFE1FFC0FF3A1F003E003C001E013C13186C6D13
10A32607801F1320A33A03C0278040A33A01E043C080A33A00F081E100A39038F900F301
7913F2A2017E137E013E137CA2013C133C011C1338A20118131801081310281D7F9B2B>
I<39FFF07FC0390FC01E003807800CEBC00800035B6C6C5A13F000005BEB7880137C013D
C7FC133E7F7F80A2EB13C0EB23E01321EB40F0497E14783801007C00027F141E0006131F
001F148039FF807FF01C1C7F9B1F>I<39FFF003FC390F8001E00007EB00C06D13800003
EB01006D5A000113026C6C5A13F8EB7808EB7C18EB3C10EB3E20131F6D5A14C06D5AABEB
7FF81E1C809B1F>I<387FFFF0EA7C01007013E0386003C0A238400780130F1400131E12
005B137C13785BA2485A1203EBC010EA0780A2EA0F00481330001E13205A14604813E0EA
F803B5FC141C7E9B19>I<12FEA212C0B3B312FEA207297C9E0C>I<EA0808EA1010EA2020
EA4040A2EA8080A3EAB0B0EAF8F8EA7878EA30300D0C7A9C15>I<12FEA21206B3B312FE
A20729809E0C>I<1208121012201240A21280A312B012F812781230050C7D9C0C>96
D<EA1FC0EA3070EA78387F12301200A2EA01FCEA0F1C12381270126000E01340A3EA603C
38304E80381F870012127E9115>I<12FC121CAA137CEA1D87381E0180381C00C014E014
601470A6146014E014C0381E018038190700EA10FC141D7F9C17>I<EA03F8EA0C0CEA18
1E1230EA700CEA600012E0A61260EA70021230EA1804EA0C18EA03E00F127F9112>I<EB
1F801303AAEA03F3EA0E0BEA1807EA30031270126012E0A6126012701230EA1807EA0E1B
3803E3F0141D7F9C17>I<EA07E0EA0C30EA1818EA300CEA700EEA600612E0EAFFFEEAE0
00A41260EA70021230EA1804EA0C18EA03E00F127F9112>I<13F8EA018CEA071E1206EA
0E0C1300A6EAFFE0EA0E00B0EA7FE00F1D809C0D>I<EB03803807C4C0EA1C7838383880
38301800EA701CA4EA3018EA38386C5AEA27C00020C7FCA21230EA3FF86CB4FC1480EA20
03386001C0EAC000A33860018038300300EA1C0EEA07F8121C7F9215>I<12FC121CAA13
7C1387EA1D03001E1380121CAD38FF9FF0141D7F9C17>I<1218123CA21218C7FCA712FC
121CB0EAFF80091D7F9C0C>I<13C0EA01E0A2EA00C01300A7EA07E01200B3A21260EAF0
C012F1EA6180EA3E000B25839C0D>I<12FC121CAAEB0FE0EB0780EB06005B13105B5B13
E0121DEA1E70EA1C781338133C131C7F130F148038FF9FE0131D7F9C16>I<12FC121CB3
A9EAFF80091D7F9C0C>I<39FC7E07E0391C838838391D019018001EEBE01C001C13C0AD
3AFF8FF8FF8021127F9124>I<EAFC7CEA1C87EA1D03001E1380121CAD38FF9FF014127F
9117>I<EA03F0EA0E1CEA1806487E00701380EA600100E013C0A600601380EA70030030
1300EA1806EA0E1CEA03F012127F9115>I<EAFC7CEA1D87381E0180001C13C0EB00E0A2
1470A614E0A2EB01C0001E1380381D0700EA1CFC90C7FCA7B47E141A7F9117>I<3803E0
80EA0E19EA1805EA3807EA7003A212E0A61270A2EA38071218EA0E1BEA03E3EA0003A7EB
1FF0141A7F9116>I<EAFCE0EA1D38EA1E78A2EA1C301300ACEAFFC00D127F9110>I<EA1F
90EA2070EA4030EAC010A212E0EAF800EA7F80EA3FE0EA0FF0EA00F8EA8038131812C0A2
EAE010EAD060EA8FC00D127F9110>I<1204A4120CA2121C123CEAFFE0EA1C00A91310A5
120CEA0E20EA03C00C1A7F9910>I<38FC1F80EA1C03AD1307120CEA0E1B3803E3F01412
7F9117>I<38FF07E0383C0380381C0100A2EA0E02A2EA0F06EA0704A2EA0388A213C8EA
01D0A2EA00E0A3134013127F9116>I<39FF3FC7E0393C0703C0001CEB01801500130B00
0E1382A21311000713C4A213203803A0E8A2EBC06800011370A2EB8030000013201B127F
911E>I<38FF0FE0381E0700EA1C06EA0E046C5AEA039013B0EA01E012007F12011338EA
021C1204EA0C0E487E003C138038FE1FF014127F9116>I<38FF07E0383C0380381C0100
A2EA0E02A2EA0F06EA0704A2EA0388A213C8EA01D0A2EA00E0A31340A25BA212F000F1C7
FC12F312661238131A7F9116>I<EA7FFCEA70381260EA407013F013E0EA41C012031380
EA0700EA0F04120E121CEA3C0CEA380812701338EAFFF80E127F9112>I<B512F0140180
8B15>I<B812802901808B2A>I<EA6060EAF0F0A2EA60600C047C9C15>127
D E /FB 50 124 df<903801F03C9038071C47010C13C7EC19C690381C01801403131813
38A2EC0700A20003B512F03900700700A3140EA213E0A35CA2EA01C0A35CA2EA0380A214
30EB0070A248136038C630E038E638C038CC3180D8781EC7FC2025819C19>11
D<14FE90380301801306EB0C03EB1C0191C7FC13181338A43803FFFE3800700EA35CA213
E0A25CA3EA01C01472A438038034141891C7FC90C8FCA25A12C612E65A12781925819C17
>I<903801FEE0EB0707130E010C13C0EB1C01A213189038380380A40003B51200380070
07A3140EA213E0A25CA3EA01C01439A43803801A140C91C7FC90C8FCA25A12C612E65A12
781B25819C18>I<1218123CA31204A21208A21210122012401280060C779C0D>39
D<13031306130813181330136013C0A2EA0180EA0300A21206A25AA2121C1218A2123812
30A21270A21260A412E0A51260A51220123012107EA2102A7B9E11>I<1310A21308130C
13041306A51307A51306A4130EA2130CA2131C1318A213381330A21360A213C0A2EA0180
EA0300A212065A5A121012605A102A809E11>I<EAFFC0A30A037D890F>45
D<1230127812F0126005047C830D>I<1206120FA212061200AA1230127812F012600812
7C910D>58 D<1418A21438A21478A214B8EB0138A2EB023C141C1304130C13081310A213
20A2EB7FFCEBC01C1380EA0100141E0002130EA25A120C001C131EB4EBFFC01A1D7E9C1F
>65 D<903803F02090381E0C6090383002E09038E003C03801C001EA038048C7FC000E14
80121E121C123C15005AA35AA41404A35C12705C6C5B00185B6C485AD80706C7FCEA01F8
1B1E7A9C1E>67 D<48B5FC39003C03C090383800E0A21570A24913781538A215785BA448
4813F0A315E03803800115C0140315803907000700140E5C5C000E13E0B512801D1C7E9B
1F>I<48B512F038003C00013813301520A35BA214081500495AA21430EBFFF03801C020
A439038040801400A2EC0100EA07005C14021406000E133CB512FC1C1C7E9B1C>I<48B5
12F038003C00013813301520A35BA214081500495AA21430EBFFF03801C020A448485A91
C7FCA348C8FCA45AEAFFF01C1C7E9B1B>I<903803F02090381E0C6090383002E09038E0
03C03801C001EA038048C7FC000E1480121E121C123C15005AA35AA2903801FF80903800
1E00141CA400705BA27E001813786C139038070710D801F8C7FC1B1E7A9C20>I<3A01FF
C3FF803A003C00780001381370A4495BA449485AA390B5FC3901C00380A4484848C7FCA4
3807000EA448131E39FFE1FFC0211C7E9B1F>I<EA03FFEA00781370A413E0A4EA01C0A4
EA0380A4EA0700A4120EA4121EEAFFC0101C7D9B10>I<D801FEEB01FED8003E14E0012E
EB03C01505A21509014EEB0B801513152313470187EB4700A21587EC0107D80107130E14
021404A20002495AEB0388149014A000045C14C0A2000C1380001CEB007839FF8307FF27
1C7E9B25>77 D<D801FCEBFF80D8001CEB1C00012E13181510A2132701475B13431480A2
903881C040A3EB80E0D801005B1470A300020139C7FCA3141D48131E140EA2120C001C13
04EAFF80211C7E9B1F>I<3801FFFE39003C038090383801C0EC00E0A3EB7001A315C0EB
E0031580EC0700141C3801FFF001C0C7FCA3485AA448C8FCA45AEAFFE01B1C7E9B1C>80
D<3801FFFE39003C078090383801C015E01400A2EB7001A3EC03C001E01380EC0700141C
EBFFE03801C03080141CA2EA0380A43807003C1520A348144039FFE01E80C7EA0F001B1D
7E9B1E>82 D<EB0F84EB304CEB403CEB8018EA01005AA200061310A214001207A2EA03E0
13FC6CB4FC38007F80EB07C01301A21300A21220A238600180A2EB03001302EAF004EACC
18EA83E0161E7D9C17>I<001FB512C0381C070138300E0000201480126012405B1280A2
000014005BA45BA45BA4485AA41203EA7FFE1A1C799B1E>I<397FF03FE0390F00070000
0E13061404A3485BA4485BA4485BA4485BA35CA249C7FCEA60025B6C5AEA1830EA07C01B
1D789B1F>I<39FF801FC0393C000700001C1304A25C5CA25CA25C5CA26C48C7FCA21302
5BA25BA25B5B120F6C5AA25B90C8FCA21206A21A1D779B1F>I<EA01E3EA0717EA0C0F12
18EA380E12301270A2EAE01CA41339A3EA6079EA319AEA1E0C10127C9115>97
D<123F1207A2120EA45AA4EA39E0EA3A18EA3C0C12381270130EA3EAE01CA31318133813
301360EA60C0EA3180EA1E000F1D7C9C13>I<13F8EA0304120EEA1C0EEA181CEA300012
70A25AA51304EA60081310EA3060EA0F800F127C9113>I<EB07E01300A2EB01C0A4EB03
80A43801E700EA0717EA0C0F1218EA380E12301270A2485AA41339A3EA6079EA319AEA1E
0C131D7C9C15>I<13F8EA0704120CEA1802EA38041230EA7008EA7FF0EAE000A5EA6004
1308EA30101360EA0F800F127C9113>I<EB03C0EB0670130CEB1C601400A25BA53803FF
8038007000A55BA5485AA5485AA390C7FCA25A12C612E65A12781425819C0D>I<EB78C0
EA01C5EA03031206000E1380120C121CA238380700A4130EA3EA181EEA0C7CEA079CEA00
1CA25BA2EAC030EAE070EAC1C0007FC7FC121A7E9113>I<EA0FC01201A2485AA448C7FC
A4EA0E3E13C3380F0380120E121E121CA338380700A3130E00701340A2131C1480EAE00C
38600700121D7E9C15>I<EA01801203EA0100C7FCA7121C12261247A2128EA2120E5AA3
5AA21271A31272A2123C091C7C9B0D>I<EA0FC01201A2485AA448C7FCA4380E07801308
EB11C01321381C4180EB8000001DC7FC121EEA3FC0EA38E01370A2EA7071A31372EAE032
EA601C121D7E9C13>107 D<EA1F801203A2EA0700A4120EA45AA45AA45AA412E2A312E4
12641238091D7D9C0B>I<391C1E078039266318C0394683A0E0384703C0008E1380A212
0EA2391C0701C0A3EC0380D8380E1388A2EC0708151039701C032039300C01C01D127C91
22>I<EA383EEA4CC3384D0380124E129E129C121CA238380700A3130E00701340A2131C
1480EAE00C3860070012127C9117>I<13F8EA030CEA0E06487E1218123000701380A238
E00700A3130EA25BEA60185BEA30E0EA0F8011127C9115>I<380387803804C860EBD030
13E0EA09C014381201A238038070A31460380700E014C0EB0180EB8300EA0E86137890C7
FCA25AA45AB4FC151A809115>I<EA01E1EA0713EA0C0F1218EA380E12301270A2EAE01C
A41338A3EA6078EA31F0EA1E701200A213E0A4EA01C0EA0FF8101A7C9113>I<EA1C3CEA
2642EA4687EA4707EA8E061300120EA25AA45AA45A123010127C9112>I<EA01F0EA0608
120C131CEA1818EA1C00121F13C0EA0FF01207EA00781338EA603012E012C0EA8060EA60
C0EA1F000E127D9111>I<12035AA3120EA4EAFFE0EA1C00A35AA45AA4EAE080A2EAE100
A2126612380B1A7C990E>I<381C0180EA2E03124EA2388E0700A2121CA2EA380EA43830
1C80A3EA383C38184D00EA0F8611127C9116>I<EA1C06EA2E0EEA4E06A2EA8E02A2121C
A2EA3804A313081230A21310EA3820EA1840EA0F800F127C9113>I<381E018338270387
1247148338870701A2120EA2381C0E02A31404EA180C131C1408EA1C1E380C26303807C3
C018127C911C>I<38038780380CC840380870E012103820E0C014001200A2485AA4EA03
811263EAE38212C5EA8584EA787813127E9113>I<381C0180EA2E03124EA2388E0700A2
121CA2EA380EA4EA301CA3EA383CEA1878EA0FB8EA003813301370EAE0605BEA81800043
C7FC123C111A7C9114>I<B512C012017C8B15>123 D E /FC 36
123 df<127012F012F8A212781208A31210A31220A21240050E7C840D>44
D<EAFFF0A20C02808A0F>I<90380FE0109038381C309038E002703803C00139078000F0
48C71270121E15305A1510127C127800F81400A91278007C1410123CA26C1420A27E6C6C
13406C6C13803900E00300EB380CEB0FF01C217E9F21>67 D<B512F83807801EEC0780EC
03C0EC01E0EC00F015701578A2153CA3153EA8153CA2157C1578A215F0EC01E0EC03C0EC
0780EC1E00B512F81F1F7F9E23>I<B61280380F000F14031401140015C01540A3144015
00A214C0130113FF130113001440A3EC0020A31540A315C01401EC0380140FB6FC1B1F7E
9E1F>I<39FFF07FF8390F000780AD90B5FCEB0007AF39FFF07FF81D1F7E9E22>72
D<EAFFF0EA0F00B3ABEAFFF00C1F7E9E10>I<3807FFC038003E00131EB3A3122012F8A3
EAF01CEA403CEA6038EA1070EA0FC012207F9E17>I<39FFF007FC390F0003E0EC018015
0014025C5C5C5C5C5C49C7FC5B497E130FEB13C0EB21E01341EB80F0EB0078A28080A280
EC0780A2EC03C015E015F039FFF01FFE1F1F7E9E23>I<EAFFF8EA0F8090C7FCB21402A4
14061404A2140C141C147CB512FC171F7E9E1C>I<B46CEB07FE000715C0A2D805C0130B
A2D804E01313A301701323A26D1343A36D1383A290380E0103A3EB0702A3EB0384A2EB01
C8A3EB00F0A21460121FD8FFE0EB7FFE271F7F9E2A>I<EB1FE0EB70383801C00E48487E
39070003804814C0001EEB01E048EB00F0A2007C14F8A20078147800F8147CA900781478
007C14F8A2003C14F0003E1301001E14E06CEB03C06C148039038007003801E01E380070
38EB1FE01E217E9F23>79 D<B512E0380F007C141E80EC0780A215C0A41580A2EC0F0014
1E147CEBFFE090C8FCAEEAFFF01A1F7E9E1F>I<3803F040380C0CC0EA1803EA3001EA60
00A212E01440A36C13007E127CEA7F80EA3FF86CB4FC00071380C613C0EB1FE013031301
EB00F014707EA46C136014E06C13C038F8018038C60300EA81FC14217E9F19>83
D<007FB512E038780F010060EB006000401420A200C0143000801410A400001400B3497E
3803FFFC1C1F7E9E21>I<3BFFF07FF81FF03B1F000FC007C06C903907800180170015C0
01805C00071502EC09E013C000035DEC19F01410D801E05CA2EC2078D800F05CA2EC403C
01785CA2EC801E017C1460013C144090383D000F133F6D5CA2011E1307010E91C7FCA201
0C7F010413022C207F9E2F>87 D<EA1FE0EA3030EA7818131CEA300E1200A313FEEA078E
EA1E0E1238127800F01310A3131E127838386720380F83C014147E9317>97
D<121C12FC121CAA137CEA1D87381E0180EB00C0001C13E01470A21478A6147014F014E0
001E13C0381A018038198700EA107C15207E9F19>I<EA01FCEA0706EA1C0F1238130600
78C7FC127012F0A61270127800381380A2381C0100EA0706EA01F811147F9314>I<EB01
C0130F1301AAEA01F1EA070DEA0C03EA180112381278127012F0A61270A21238EA180312
0CEA070D3801F1F815207F9F19>I<EA03F0EA0E1C487E487EA21270EB038012F0A2B5FC
00F0C7FCA31270A26C1380A2381C0100EA0706EA01F811147F9314>I<14E03803E330EA
0E3CEA1C1C38380E00EA780FA5EA380E6C5AEA1E38EA33E00020C7FCA21230A2EA3FFE38
1FFF8014C0383001E038600070481330A4006013606C13C0381C03803803FC00141F7F94
17>103 D<121C12FC121CAA137C1386EA1D03001E1380A2121CAE38FF8FF014207E9F19>
I<1238127CA31238C7FCA6121C12FC121CB1EAFF80091F7F9E0C>I<121C12FC121CAAEB
1FE0EB0780EB060013045B5B5B136013E0EA1DF0EA1E70EA1C38133C131C7F130F7F1480
14C038FF9FF014207E9F18>107 D<121C12FC121CB3ABEAFF8009207F9F0C>I<391C3E03
E039FCC30C30391D039038391E01E01CA2001C13C0AE3AFF8FF8FF8021147E9326>I<EA
1C7CEAFC86EA1D03001E1380A2121CAE38FF8FF014147E9319>I<EA01F8EA070E381C03
80383801C0A2387000E0A200F013F0A6007013E0A2383801C0A2381C038038070E00EA01
F814147F9317>I<EA1CF0EAFD18EA1E3CA21318EA1C00AEEAFFC00E147E9312>114
D<EA0FC8EA3038EA6018EAC008A3EAE000127CEA3FE0EA1FF0EA07F8EA003CEA800E1306
12C0A21304EAE00CEAD818EA87E00F147F9312>I<1202A31206A2120EA2123EEAFFF8EA
0E00AB1304A5EA07081203EA01F00E1C7F9B12>I<381C0380EAFC1FEA1C03AE1307120C
EA061B3803E3F014147E9319>I<38FF83F8383E00E0001C13C06C1380A338070100A213
83EA0382A2EA01C4A213E4EA00E8A21370A3132015147F9318>I<39FF9FE1FC393C0780
70391C030060EC8020000E1440A214C0D80704138014E0A239038861001471A23801D032
143A143E3800E01CA2EB6018EB40081E147F9321>I<EA7FFFEA700E1260EA401C133813
781370EA00E0120113C0EA038012071301120E121EEA1C03EA3802EA7006130EEAFFFE10
147F9314>122 D E /FD 62 125 df<EB0FE0EB7FF8EBF81C3801E07C1203EA07C0A214
3891C7FCA3EBC1FEB5FCA23807C03EB0393FF9FFC0A21A20809F1D>12
D<EAFFF0A40C047F8B11>45 D<1238127C12FEA3127C123807077C860F>I<146014E0A2
EB01C0A2EB0380A3EB0700A3130EA25BA35BA35BA25BA3485AA2485AA348C7FCA3120EA2
5AA35AA35AA25AA25A132D7DA11A>I<EA01FCEA07FF381F07C0EA1E03003E13E0387C01
F0A300FC13F8AD007C13F0A3383E03E0001E13C0EA1F8F3807FF00EA01FC151D7E9C1A>
I<137013F0120712FF12F91201B3A4387FFFC0A2121D7D9C1A>I<EA03FC381FFF803838
1FC0387C07E038FE03F0A214F81301127C1238EA000314F0A2EB07E0EB0FC01400131E5B
13705B3801C018EA0380EA0600481338381FFFF05A5AB5FCA2151D7E9C1A>I<EA03FC38
0FFF80381C0FC0383C07E0387E03F0A31307003C13E01200EB0FC0EB3F803803FE005B38
000F80EB07C0EB03E014F014F81238127C12FEA214F012FC387807E0383C0FC0381FFF80
3803FC00151D7E9C1A>I<EB01C013031307A2130F131F133B1373136313C3EA01831203
EA0703120E120C12181238127012E0B512FEA2380007C0A6EBFFFEA2171D7F9C1A>I<00
1C13E0EA1FFF14C01480140013FC13C00018C7FCA4EA19FE381FFF80381E07C0381803E0
381001F0120014F8A2127812FCA314F0EA7803007013E0383C0FC0380FFF00EA03FC151D
7E9C1A>I<133F3801FFC03807C0E0EA0F81381F03F0121E123E127CEB01E090C7FCEAFC
1013FF00FD13C0EB03E038FE01F0A200FC13F8A4127CA3003C13F0123E381E03E0380F07
C03807FF803801FE00151D7E9C1A>I<1260387FFFF8A214F014E014C038E0018038C003
00A21306C65A5B13381330137013F0A2485AA21203A41207A56C5A6C5A151E7D9D1A>I<
EA01FE380FFF80381E07C0383801E0EB00F01278A2127C127FEBC1E0383FE3C0381FFF80
380FFE003807FF8014C0001F13E0383C3FF0EA780FEB03F8EAF00113001478A214701278
007C13E0383E03C0380FFF803803FC00151D7E9C1A>I<EA01FCEA0FFF381F0780383E03
C0007C13E0130100FC13F0A314F8A4EA7C03A2EA3E05EA1FFDEA07F9EA0041EB01F0123C
127EEB03E0A214C0383C078038381F00EA1FFCEA07F0151D7E9C1A>I<EA07F8EA1FFE38
381F80EA780F00FC13C0A3127838301F8000001300133E5B13705BA25BA690C7FCA4EA01
C0487E487EA36C5A6C5A12207D9F19>63 D<14E0A2497EA3497EA2EB06FCA2EB0EFEEB0C
7EA2497EA201307F141F01707FEB600FA2496C7E90B5FC4880EB8003000380EB0001A200
066D7EA2000E803AFFE00FFFE0A2231F7E9E28>65 D<B512FEECFFC03907C007E0EC03F0
EC01F815FCA515F8140315F0EC0FE090B5128015C09038C003F0EC01F815FC140015FEA5
15FC1401EC03F8EC07F0B612E015001F1F7E9E25>I<903807FC0290383FFF0E9038FE03
DE3903F000FE4848133E4848131E485A48C7120EA2481406127EA200FE1400A7127E1506
127F7E150C6C7E6C6C13186C6C13386C6C13703900FE01C090383FFF80903807FC001F1F
7D9E26>I<B512FEECFFC03907E007F0EC01F86E7E157E81A2ED1F80A316C0A91680A3ED
3F00A2157E5D4A5AEC07F0B612C04AC7FC221F7E9E28>I<B612E0A23807E00714011400
156015701530A21430A21500147014F013FFA213E014701430150CA214001518A3153815
7815F8EC03F0B6FCA21E1F7E9E22>I<B612E0A23807E00714011400156015701530A214
30A21500147014F013FFA213E014701430A391C7FCA8B57EA21C1F7E9E21>I<903807FC
0290383FFF0E9038FE03DE3903F000FE4848133E4848131E485A48C7120EA2481406127E
A200FE91C7FCA591381FFFE0A2007E9038007E00A2127F7EA26C7E6C7E6C7E6C6C13FE38
00FE0190383FFF8E903807FC06231F7D9E29>I<B5380FFFF0A23A07E0007E00AC90B512
FEA29038E0007EADB5380FFFF0A2241F7E9E29>I<B5FCA2EA07E0B3A9B5FCA2101F7E9E
14>I<3803FFFCA238000FC0B3A21210127C12FEA21480EAFC1F38783F00EA3FFEEA0FF0
161F7F9E1B>I<B57EA2D807E0C7FCB115C0A31401A3EC0380A2140F141FB6FCA21A1F7E
9E1F>76 D<D8FFE0EC3FF86D147F00071600D806F814DFA3017CEB019FA26DEB031FA26D
1306A290380F800CA2903807C018A3903803E030A2903801F060A2903800F8C0A2EC7D80
A2EC3F00A3141ED8FFF0903803FFF8140C2D1F7E9E32>I<D8FFE0EBFFF07F0007EC0600
7FEA06FC137E7F1480131FEB0FC0EB07E0EB03F0EB01F814FC1300147E143FEC1F8615C6
EC0FE61407EC03F6EC01FE1400A2157E153E151E150ED8FFF01306A2241F7E9E29>I<EB
1FF890B5FC3901F81F803907E007E0390FC003F0391F8001F890C7FC4814FC4814FE007E
147EA200FE147FA9007E147E007F14FEA26C14FCEB8001001F14F8390FC003F03907E007
E03901F81F806CB51200EB1FF8201F7D9E27>I<B512FEECFF803907E00FE0EC03F0EC01
F8A215FCA515F8A2EC03F0EC0FE090B51280ECFE0001E0C7FCACB5FCA21E1F7E9E24>I<
B512FCECFF803907E00FE0EC03F081140181A45D14035DEC0FE090B5128002FCC7FCEBE0
3FEC0F8081140781A381A31630EC03F802011360B53800FFC0ED3F80241F7E9E27>82
D<3803FC08380FFF38381E03F8EA3800481378143812F01418A26C13007EEA7FC013FE38
3FFF806C13C06C13E06C13F0C613F81307EB00FC147C143C12C0A36C1338147800F81370
38FE01E038EFFFC000811300161F7D9E1D>I<007FB512FCA2397C07E07C0070141C0060
140CA200E0140E00C01406A400001400B10003B512C0A21F1E7E9D24>I<B53801FFE0A2
3A07E0000C00B3A400035C6C7E5D6C6C5B90387E03C090381FFF80D903FCC7FC231F7E9E
28>I<D8FFFEEB3FF8A2D80FE0EB0380000715006D5B000314067F00015C7F00005CA201
7E5BA2017F13706D1360EC80E0011F5B14C090380FC180A2D907E3C7FCA2EB03F6A214FE
6D5AA26D5AA21470A2251F7F9E28>I<3CFFFC0FFFC0FFE0A23C0FC000FC000E007F0007
6E130CA26D151C0003D901BF1318A2D801F85D9138031F80A22600FC076D5AEC060F01FE
15E0903A7E0C07E0C0A2013FECE18091381803F1A2D91FB801FBC7FCECB00102F013FF6D
486C5AA201075C4A137CA2010314784A133801011430331F7F9E36>I<EA07FC381FFF80
383F07C0EB03E0EB01F0A2120C1200133FEA07FDEA1F81EA3E01127C12F8A3EAFC02EA7E
0C383FF87E380FE03E17147F9319>97 D<B4FCA2121FAAEB1FC0EB7FF0EBE0F8EB807CEB
007E143EA2143FA6143EA2147C1380381EC1F8381C7FE038181F8018207E9F1D>I<EA01
FE3807FF80381F0FC0123EA2127CEB030000FCC7FCA6127C127E003E1360003F13C0EA1F
813807FF00EA01FC13147E9317>I<EB07F8A21300AAEA01F8EA07FEEA1F83EA3E01EA7E
00127CA212FCA6127CA2127EEA3E01EA1F07380FFEFFEA03F818207E9F1D>I<EA01FE38
07FF80380F83C0381E01E0383E00F05A14F812FCB5FCA200FCC7FCA3127CA26C1318121E
380F80703807FFE0C6138015147F9318>I<EB3F80EBFFC03803E3E0EA07C71387120FEB
83C0EB8000A5EAFFFCA2EA0F80B0EA7FF8A213207F9F10>I<3803FC3C380FFFFE381E07
9E383C03DE007C13E0A5003C13C0381E0780381FFF00EA13FC0030C7FCA21238383FFF80
6C13F06C13F84813FC3878007C0070133E00F0131EA30078133CA2383F01F8380FFFE000
011300171E7F931A>I<B4FCA2121FAAEB0FC0EB3FE0EB61F0EBC0F813801300AD38FFE7
FFA218207D9F1D>I<121C123E127FA3123E121CC7FCA6B4FCA2121FB0EAFFE0A20B217E
A00E>I<B4FCA2121FAAEB01FEA2EB00F014C0EB0380EB0700130C5B137C13FC139E130F
001E1380EB07C01303EB01E014F0EB00F838FFC3FFA218207E9F1C>107
D<B4FCA2121FB3AAEAFFE0A20B207E9F0E>I<3AFE0FE03F8090391FF07FC03A1E70F9C3
E09039407D01F0EB807E121FEB007CAC3AFFE3FF8FFEA227147D932C>I<38FE0FC0EB3F
E0381E61F0EBC0F81380EA1F00AD38FFE7FFA218147D931D>I<48B4FC000713C0381F83
F0383E00F8A248137CA200FC137EA6007C137CA26C13F8A2381F83F03807FFC000011300
17147F931A>I<38FF1FC0EB7FF0381FE1F8EB80FCEB007EA2143E143FA6143E147E147C
EB80FCEBC1F8EB7FE0EB1F8090C7FCA7EAFFE0A2181D7E931D>I<3801F8183807FE3838
1F8778383F01F8123EEA7E00127C12FCA6127C127EA2EA3F01EA1F87EA0FFEEA03F8C7FC
A7EB07FFA2181D7E931C>I<EAFE3EEB7F80381ECFC0138FA2121FEB030090C7FCABEAFF
F0A212147E9316>I<EA0FE6EA3FFEEA701EEA600EEAE006A2EAF800EAFFC0EA7FF8EA3F
FCEA1FFE1203EA001FEAC007A212E0EAF006EAF81EEAFFFCEAC7F010147E9315>I<1203
A45AA25AA2123FEAFFFCA2EA1F00AA1306A5EA0F8CEA07F8EA03F00F1D7F9C14>I<38FF
07F8A2EA1F00AD1301A2EA0F063807FCFF6C5A18147D931D>I<39FFE07F80A2391F001C
00380F8018A26C6C5AA26C6C5AA2EBF0E000015B13F900005B13FF6DC7FCA2133EA2131C
A219147F931C>I<3AFFC7FE1FE0A23A1F00F0030014F8D80F801306A29038C1BC0E0007
140CEBC3BE3903E31E18A29038F60F380001143001FE13B03900FC07E0A2EBF80301785B
A2903830018023147F9326>I<38FFC0FFA2380F80703807C0606D5A3803E180EA01F36C
B4C7FC137E133E133F497E136FEBC7C0380183E0380381F048C67E000E7F39FF81FF80A2
19147F931C>I<39FFE07F80A2391F001C00380F8018A26C6C5AA26C6C5AA2EBF0E00001
5B13F900005B13FF6DC7FCA2133EA2131CA21318A2EA783012FC5BEAC0E0EAE1C0EA7F80
001EC8FC191D7F931C>I<383FFFE0A2383C07C038380F80EA701F38603F00133E5BC65A
1201485AEBE060EA07C0EA0F80001F13E0383F00C0EA3E01EA7C03B5FCA213147F9317>
I<B912E0A23302808C34>124 D E /FE 18 117 df<123C127E12FFA4127E123C1200A6
123C127E12FFA4127E123C08167C9510>58 D<49B41340011FEBC1C090387F80F33901FC
001FD803F0130F4848130748481303121F48481301A2007F140090C8FCA2481500A87E16
C07F123F15016C6C1480120F6C6CEB03006C6C1306D801FC131C39007F807890381FFFE0
010190C7FC22227DA129>67 D<B51280A23807F000B3ACB51280A211227EA116>73
D<D8FFF0913807FF806D5C0007EEF000D806FC141BA2017E1433A36D1463A26D6C13C3A2
90390FC00183A2903907E00303A2903803F006A3903801F80CA2903800FC18A2EC7E30A2
EC3F60A2EC1FC0A3EC0F80A23CFFF007007FFF80A231227EA136>77
D<B67E15F03907F003F86E7E6E7E157FA21680A51600A215FE4A5A4A5A90B55A158001F0
C8FCADB57EA221227EA127>80 D<B6FC15E03907F007F8EC01FC6E7E157F1680A6160015
FE4A5AEC07F890B512E015809038F00FC0EC03F081140181A481A2160315FF80ED7F86B5
38803FFCED0FF828227EA12B>82 D<007FB612C0A2397E03F80F00781403007014010060
140000E015E0A200C01560A400001500B348B512F0A223217EA028>84
D<EBFF80000713E0380F83F0EA1F03123E127E387C01E090C7FC12FCA6127C127EA2003E
13186C1330380FC0603807FFC0C6130015167E9519>99 D<13FE3807FF80380F83C0381E
01E0383E00F0127E007C13F8147812FCB512F8A200FCC7FCA3127CA26C1318A26C133038
0F80E03803FFC0C6130015167E951A>101 D<EB1F80EBFFE03801F1F0EA03E31207EA0F
C3EBC1E0EBC000A6EAFFFEA2EA0FC0B2EA7FFCA214237EA212>I<B47EA2121FABEB83F0
EB8FFCEB987EEBA03EEBC03FA21380AE39FFF1FFE0A21B237DA220>104
D<EAFF80A2121FB3ADEAFFF0A20C237EA20F>108 D<3AFF03F803F890390FFE0FFE3A1F
183F183F9039201F201F014001C01380A201801380AE3BFFF0FFF0FFF0A22C167D9531>
I<38FF03F0EB0FFC381F187EEB203EEB403FA21380AE39FFF1FFE0A21B167D9520>I<13
FF000713E0380F81F0381F00F8003E137C48133EA300FC133FA7007C133E007E137E003E
137C6C13F8380F81F03807FFE0C6130018167E951D>I<38FF87F0EBBFFC381FF07EEBC0
1F9038800F8015C0A2EC07E0A715C0140FA2EC1F8001C01300EBF07EEBBFFCEB8FE00180
C7FCA8EAFFF0A21B207E9520>I<38FF0F80EB1FE0381F33F013631343A2EBC1E0EB8000
ADEAFFF8A214167E9518>114 D<487EA41203A21207A2120F123FB5FCA2EA1F80ABEB81
80A5380F830013C3EA07FEEA01F811207F9F16>116 D E end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 263 a FE(MPI:)19 b(The)g(Complete)h(Reference)p
eop
%%Page: 2 2
2 1 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 507 a FD(Scien)o(ti\014c)19 b(and)f(Engineering)h
(Computation)249 561 y FC(Jan)o(usz)d(Ko)o(w)o(alik,)f(Editor)249
669 y FB(Data-Par)n(al)r(lel)f(Pr)n(o)n(gr)n(amming)h(on)g(MIMD)h
(Computers)249 723 y FA(b)o(y)e(Philip)f(J.)g(Hatc)o(her)i(and)f(Mic)o
(hael)f(J.)h(Quinn,)f(1991)249 812 y FB(Unstructur)n(e)n(d)h
(Scienti\014c)i(Computation)f(on)g(Sc)n(alable)g(Multipr)n(o)n(c)n
(essors)249 866 y FA(edited)g(b)o(y)e(Piyush)h(Mehrotra,)g(Jo)q(el)g
(Saltz,)g(and)f(Rob)q(ert)i(V)m(oigt,)d(1991)249 954
y FB(Par)n(al)r(lel)i(Computational)h(Fluid)g(Dynamics:)k
(Implementations)d(and)f(R)n(esults)249 1008 y FA(edited)g(b)o(y)e
(Horst)i(D.)e(Simon,)e(1992)249 1096 y FB(Enterprise)i(Inte)n(gr)n
(ation)g(Mo)n(deling:)19 b(Pr)n(o)n(c)n(e)n(e)n(dings)13
b(of)h(the)f(First)g(International)g(Confer)n(enc)n(e)249
1150 y FA(edited)i(b)o(y)e(Charles)i(J.)e(P)o(etrie,)h(Jr.,)g(1992)249
1239 y FB(The)h(High)g(Performanc)n(e)f(F)m(ortr)n(an)h(Handb)n(o)n(ok)
249 1293 y FA(b)o(y)f(Charles)h(H.)f(Ko)q(elb)q(el,)g(Da)o(vid)g(B.)g
(Lo)o(v)o(eman,)e(Rob)q(ert)j(S.)f(Sc)o(hreib)q(er,)h(Guy)f(L.)g
(Steele)h(Jr.)249 1347 y(and)f(Mary)g(E.)f(Zosel,)h(1993)249
1429 y FB(Using)h(MPI:)g(Portable)f(Par)n(al)r(lel)g(Pr)n(o)n(gr)n
(amming)h(with)f(the)h(Message-Passing)g(Interfac)n(e)249
1483 y FA(b)o(y)f(William)c(Gropp,)j(Ewing)g(Lusk,)h(and)g(An)o(thon)o
(y)f(Skjellum,)e(1994)249 1571 y FB(PVM:)j(Par)n(al)r(lel)f(Virtual)g
(Machine{A)h(User's)f(Guide)i(and)f(T)m(utorial)f(for)g(Network)g(Par)n
(al)r(lel)249 1625 y(Computing)249 1677 y FA(b)o(y)i(Al)f(Geist,)h
(Adam)f(Beguelin,)h(Jac)o(k)g(Dongarra,)f(W)m(eic)o(heng)h(Jiang,)f
(Bob)h(Manc)o(hek,)h(and)249 1731 y(V)m(aidy)d(Sunderam,)g(1994)249
1813 y FB(Enabling)i(T)m(e)n(chnolo)n(gies)g(for)g(Peta\015ops)h
(Computing)249 1867 y FA(b)o(y)e(Thomas)e(Sterling,)h(P)o(aul)h
(Messina,)f(and)h(P)o(aul)f(H.)h(Smith)249 1955 y FB(A)o(n)h(Intr)n(o)n
(duction)g(to)g(High-Performanc)n(e)f(Scienti\014c)i(Computing)249
2009 y FA(b)o(y)11 b(Llo)o(yd)g(D.)g(F)m(osdic)o(k,)g(Elizab)q(eth)h
(R.)e(Jessup,)j(Carolyn)e(J.C.)g(Sc)o(hauble,)h(and)f(Gitta)g(Domik)249
2098 y FB(Pr)n(actic)n(al)j(Par)n(al)r(lel)g(Pr)n(o)n(gr)n(amming)249
2152 y FA(b)o(y)g(Gregory)g(V.)f(Wilson)249 2240 y FB(MPI:)i(The)g
(Complete)f(R)n(efer)n(enc)n(e)249 2294 y FA(b)o(y)i(Marc)h(Snir,)f
(Stev)o(e)h(Otto,)g(Stev)o(en)g(Huss-Lederman,)g(Da)o(vid)e(W)m(alk)o
(er,)g(and)i(Jac)o(k)f(Don-)249 2348 y(garra)p eop
%%Page: 3 3
3 2 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 263 a FE(MPI:)19 b(The)g(Complete)h(Reference)249
571 y FC(Marc)15 b(Snir)249 625 y(Stev)o(e)g(Otto)249
679 y(Stev)o(en)h(Huss-Lederman)249 733 y(Da)o(vid)f(W)l(alk)o(er)249
787 y(Jac)o(k)g(Dongarra)249 2391 y(The)h(MIT)f(Press)249
2445 y(Cam)o(bridge,)g(Massac)o(h)o(usetts)249 2499 y(London,)g
(England)p eop
%%Page: 4 4
4 3 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 259 506 a Fz(c)249 507 y Fy(\015)12 b Fz(1996)e(Massac)o(h)o
(usetts)g(Institute)f(of)i(T)m(ec)o(hnology)249 582 y(All)h(righ)o(ts)e
(reserv)o(ed.)j(No)f(part)f(of)g(this)g(b)q(o)q(ok)f(ma)o(y)g(b)q(e)h
(repro)q(duced)e(in)i(an)o(y)f(form)h(b)o(y)g(an)o(y)f(electronic)f(or)
249 619 y(mec)o(hanical)f(means)i(\(including)f(photo)q(cop)o(yin)o(g,)
f(recording,)h(or)i(information)d(storage)i(and)h(retriev)n(al\))249
657 y(without)f(p)q(ermission)f(in)i(writing)g(from)f(the)h(publisher.)
249 731 y(P)o(arts)g(of)g(this)g(b)q(o)q(ok)f(came)g(from,)g(\\MPI:)i
(A)g(Message-P)o(assing)d(In)o(terface)g(Standard")f(b)o(y)j(the)g
(Message)249 769 y(P)o(assing)f(In)o(terface)f(F)m(orum.)14
b(That)e(do)q(cumen)o(t)c(is)945 768 y(c)935 769 y Fy(\015)k
Fz(the)f(Univ)o(ersit)o(y)e(of)j(T)m(ennessee.)h(These)e(sections)f(w)o
(ere)249 806 y(copied)g(b)o(y)h(p)q(ermission)e(of)i(the)g(Univ)o
(ersit)o(y)e(of)j(T)m(ennessee.)249 881 y(This)g(b)q(o)q(ok)e(w)o(as)i
(set)f(in)g(L)590 877 y Fx(a)610 881 y Fz(T)629 891 y(E)650
881 y(X)h(b)o(y)f(the)g(authors)e(and)i(w)o(as)h(prin)o(ted)d(and)i(b)q
(ound)f(in)h(the)g(United)f(States)g(of)249 918 y(America.)249
993 y(Library)g(of)h(Congress)g(Cataloging-in)o(-Pub)o(lica)o(tio)o(n)e
(Data)p eop
%%Page: 5 5
5 4 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 260 a FD(Con)o(ten)o(ts)354 514 y FA(Series)15
b(F)m(orew)o(ord)1070 b(ix)354 580 y(Preface)1224 b(xi)249
680 y FD(1)79 b(In)o(tro)q(duction)1082 b FA(1)249 755
y(1.1)51 b(The)14 b(Goals)f(of)g Fw(MPI)1046 b FA(3)249
821 y(1.2)51 b(Who)13 b(Should)g(Use)i(This)f(Standard?)770
b(4)249 888 y(1.3)51 b(What)13 b(Platforms)f(are)j(T)m(argets)f(for)f
(Implemen)o(tation?)471 b(4)249 954 y(1.4)51 b(What)13
b(is)h(Included)g(in)g Fw(MPI)p FA(?)898 b(5)249 1020
y(1.5)51 b(What)13 b(is)h(Not)g(Included)g(in)g Fw(MPI)p
FA(?)816 b(5)249 1087 y(1.6)51 b(V)m(ersion)14 b(of)f
Fw(MPI)1099 b FA(6)249 1153 y(1.7)51 b Fw(MPI)13 b FA(Con)o(v)o(en)o
(tions)g(and)h(Design)g(Choices)691 b(6)249 1220 y(1.8)51
b(Seman)o(tic)12 b(T)m(erms)1078 b(8)249 1286 y(1.9)51
b(Language)13 b(Binding)1018 b(12)249 1398 y FD(2)79
b(P)o(oin)o(t-to-P)o(oin)o(t)18 b(Comm)o(unication)644
b FA(15)249 1473 y(2.1)51 b(In)o(tro)q(duction)14 b(and)g(Ov)o(erview)
857 b(15)249 1539 y(2.2)51 b(Blo)q(c)o(king)13 b(Send)h(and)g(Receiv)o
(e)h(Op)q(erations)645 b(18)249 1606 y(2.3)51 b(Datat)o(yp)q(e)13
b(Matc)o(hing)h(and)g(Data)f(Con)o(v)o(ersion)597 b(26)249
1672 y(2.4)51 b(Seman)o(tics)13 b(of)g(Blo)q(c)o(king)g(P)o(oin)o
(t-to-p)q(oin)o(t)677 b(32)249 1738 y(2.5)51 b(Example)12
b(|)h(Jacobi)h(iteration)836 b(39)249 1805 y(2.6)51 b(Send-Receiv)o(e)
1111 b(44)249 1871 y(2.7)51 b(Null)13 b(Pro)q(cesses)1089
b(47)249 1938 y(2.8)51 b(Non)o(blo)q(c)o(king)12 b(Comm)o(unicatio)o(n)
820 b(49)249 2004 y(2.9)51 b(Multiple)13 b(Completions)953
b(67)249 2071 y(2.10)30 b(Prob)q(e)14 b(and)g(Cancel)1024
b(75)249 2137 y(2.11)30 b(P)o(ersisten)o(t)15 b(Comm)o(unicatio)o(n)c
(Requests)695 b(81)249 2203 y(2.12)30 b(Comm)n(unication-Co)o(m)o
(plete)11 b(Calls)i(with)h(Null)f(Request)i(Handles)268
b(86)249 2270 y(2.13)30 b(Comm)n(unication)11 b(Mo)q(des)930
b(89)249 2382 y FD(3)79 b(User-De\014ned)17 b(Datat)o(yp)q(es)h(and)g
(P)o(ac)o(king)481 b FA(101)249 2457 y(3.1)51 b(In)o(tro)q(duction)1100
b(101)p eop
%%Page: 6 6
6 5 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(vi)1315 b(Con)o(ten)o(ts)249 507
y FA(3.2)51 b(In)o(tro)q(duction)14 b(to)g(User-De\014ned)h(Datat)o(yp)
q(es)603 b(101)249 574 y(3.3)51 b(Datat)o(yp)q(e)13 b(Constructors)913
b(105)249 640 y(3.4)51 b(Use)14 b(of)g(Deriv)o(ed)g(Datat)o(yp)q(es)861
b(123)249 707 y(3.5)51 b(Address)15 b(F)m(unction)1009
b(128)249 773 y(3.6)51 b(Lo)o(w)o(er-b)q(ound)14 b(and)f(Upp)q(er-b)q
(ound)i(Mark)o(ers)595 b(130)249 839 y(3.7)51 b(Absolute)14
b(Addresses)976 b(133)249 906 y(3.8)51 b(P)o(ac)o(k)14
b(and)f(Unpac)o(k)1009 b(135)249 1018 y FD(4)79 b(Collectiv)o(e)18
b(Comm)o(unications)704 b FA(147)249 1093 y(4.1)51 b(In)o(tro)q
(duction)14 b(and)g(Ov)o(erview)836 b(147)249 1159 y(4.2)51
b(Op)q(erational)13 b(Details)971 b(150)249 1225 y(4.3)51
b(Comm)n(unicator)11 b(Argumen)o(t)862 b(151)249 1292
y(4.4)51 b(Barrier)14 b(Sync)o(hronization)894 b(152)249
1358 y(4.5)51 b(Broadcast)1146 b(152)249 1425 y(4.6)51
b(Gather)1200 b(154)249 1491 y(4.7)51 b(Scatter)1199
b(165)249 1558 y(4.8)51 b(Gather)14 b(to)f(All)1081 b(170)249
1624 y(4.9)51 b(All)13 b(to)g(All)g(Scatter/Gather)865
b(173)249 1690 y(4.10)30 b(Global)12 b(Reduction)i(Op)q(erations)795
b(175)249 1757 y(4.11)30 b(Scan)1242 b(188)249 1823 y(4.12)30
b(User-De\014ned)15 b(Op)q(erations)g(for)f(Reduce)g(and)g(Scan)491
b(189)249 1890 y(4.13)30 b(The)14 b(Seman)o(tics)f(of)g(Collectiv)o(e)h
(Comm)o(uni)o(cations)502 b(195)249 2002 y FD(5)79 b(Comm)o(unicators)
967 b FA(201)249 2076 y(5.1)51 b(In)o(tro)q(duction)1100
b(201)249 2143 y(5.2)51 b(Ov)o(erview)1158 b(203)249
2209 y(5.3)51 b(Group)13 b(Managemen)o(t)964 b(207)249
2276 y(5.4)51 b(Comm)n(unicator)11 b(Managemen)o(t)811
b(216)249 2342 y(5.5)51 b(Safe)13 b(P)o(arallel)g(Libraries)927
b(223)249 2408 y(5.6)51 b(Cac)o(hing)1180 b(229)249 2475
y(5.7)51 b(In)o(tercomm)o(unication)961 b(243)p eop
%%Page: 7 7
7 6 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(Con)o(ten)o(ts)1304 b(vii)249 507
y FD(6)79 b(Pro)q(cess)16 b(T)l(op)q(ologies)898 b FA(253)249
582 y(6.1)51 b(In)o(tro)q(duction)1100 b(253)249 648
y(6.2)51 b(Virtual)13 b(T)m(op)q(ologies)990 b(254)249
715 y(6.3)51 b(Ov)o(erlapping)13 b(T)m(op)q(ologies)899
b(255)249 781 y(6.4)51 b(Em)o(b)q(edding)12 b(in)i Fw(MPI)984
b FA(256)249 848 y(6.5)51 b(Cartesian)14 b(T)m(op)q(ology)e(F)m
(unctions)783 b(257)249 914 y(6.6)51 b(Graph)13 b(T)m(op)q(ology)f(F)m
(unctions)841 b(267)249 981 y(6.7)51 b(T)m(op)q(ology)12
b(Inquiry)h(F)m(unctions)824 b(273)249 1047 y(6.8)51
b(An)14 b(Application)f(Example)874 b(273)249 1159 y
FD(7)79 b(En)o(vironmen)o(tal)17 b(Managemen)o(t)679
b FA(287)249 1234 y(7.1)51 b(Implemen)o(tation)10 b(Information)811
b(287)249 1300 y(7.2)51 b(Timers)13 b(and)g(Sync)o(hronization)815
b(290)249 1367 y(7.3)51 b(Initialization)11 b(and)j(Exit)923
b(291)249 1433 y(7.4)51 b(Error)14 b(Handling)1050 b(293)249
1499 y(7.5)51 b(In)o(teraction)14 b(with)g(Executing)g(En)o(vironmen)o
(t)589 b(301)249 1611 y FD(8)79 b(The)17 b Fw(MPI)g FD(Pro\014ling)h
(In)o(terface)713 b FA(303)249 1686 y(8.1)51 b(Requiremen)o(ts)1079
b(303)249 1753 y(8.2)51 b(Discussion)1138 b(303)249 1819
y(8.3)51 b(Logic)13 b(of)g(the)i(Design)975 b(304)249
1885 y(8.4)51 b(Examples)1151 b(306)249 1952 y(8.5)51
b(Multiple)13 b(Lev)o(els)h(of)f(In)o(terception)770
b(310)249 2064 y FD(9)79 b(Conclusions)1057 b FA(311)249
2139 y(9.1)51 b(Design)13 b(Issues)1088 b(311)249 2205
y(9.2)51 b(P)o(ortable)14 b(Programmi)o(ng)d(with)j Fw(MPI)728
b FA(314)249 2271 y(9.3)51 b(Heterogeneous)16 b(Computing)11
b(with)j Fw(MPI)665 b FA(321)249 2338 y(9.4)51 b Fw(MPI)13
b FA(Implemen)o(tations)934 b(323)249 2404 y(9.5)51 b(Extensions)14
b(to)g Fw(MPI)992 b FA(324)354 2483 y(Bibliograph)o(y)1093
b(327)p eop
%%Page: 8 8
8 7 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(viii)1295 b(Con)o(ten)o(ts)354 507
y FA(Index)1226 b(329)354 574 y(Constan)o(ts)14 b(Index)1031
b(333)354 640 y(F)m(unction)13 b(Index)1053 b(335)p eop
%%Page: 9 9
9 8 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 260 a FD(Series)17 b(F)l(orew)o(ord)249 561
y FA(The)c(w)o(orld)f(of)h(mo)q(dern)f(computing)f(p)q(oten)o(tially)g
(o\013ers)j(man)o(y)d(helpful)h(metho)q(ds)g(and)h(to)q(ols)249
615 y(to)f(scien)o(tists)i(and)e(engineers,)i(but)f(the)g(fast)f(pace)h
(of)f(c)o(hange)h(in)f(computer)g(hardw)o(are,)h(soft-)249
669 y(w)o(are,)j(and)g(algorithms)e(often)i(mak)o(es)e(practical)i(use)
h(of)e(the)i(new)o(est)g(computing)d(tec)o(hnol-)249
723 y(ogy)h(di\016cult.)22 b(The)16 b(Scien)o(ti\014c)g(and)f
(Engineering)h(Computation)d(series)k(fo)q(cuses)g(on)e(rapid)249
777 y(adv)n(ances)k(in)e(computing)g(tec)o(hnologies)h(and)g(attempts)f
(to)h(facilitate)f(transferring)i(these)249 831 y(tec)o(hnologies)f(to)
f(applications)g(in)g(science)i(and)f(engineering.)29
b(It)18 b(will)e(include)i(b)q(o)q(oks)g(on)249 885 y(theories,)13
b(metho)q(ds,)e(and)g(original)f(applications)h(in)g(suc)o(h)h(areas)h
(as)e(parallelism,)e(large-scale)249 939 y(sim)o(ulations,)15
b(time-critical)g(computing,)g(computer-aided)h(design)h(and)g
(engineering,)h(use)249 993 y(of)11 b(computers)g(in)g(man)o
(ufacturing,)f(visualization)f(of)i(scien)o(ti\014c)h(data,)f(and)g(h)o
(uman-mac)o(hine)249 1047 y(in)o(terface)k(tec)o(hnology)m(.)291
1101 y(The)g(series)i(will)d(help)i(scien)o(tists)g(and)g(engineers)g
(to)g(understand)g(the)g(curren)o(t)h(w)o(orld)e(of)249
1155 y(adv)n(anced)d(computation)d(and)i(to)g(an)o(ticipate)g(future)h
(dev)o(elopmen)o(ts)f(that)g(will)f(impact)g(their)249
1209 y(computing)i(en)o(vironmen)o(ts)g(and)i(op)q(en)f(up)h(new)g
(capabilities)e(and)h(mo)q(des)g(of)g(computation.)291
1263 y(This)i(b)q(o)q(ok)h(is)g(ab)q(out)f(the)i(Message)g(P)o(assing)f
(In)o(terface)h(\()p Fw(MPI)p FA(\),)e(an)g(imp)q(ortan)o(t)f(and)i
(in-)249 1317 y(creasingly)i(p)q(opular)g(standarized)g(and)g(p)q
(ortable)g(message)g(passing)g(system)f(that)h(brings)249
1371 y(us)i(closer)g(to)f(the)h(p)q(oten)o(tial)f(dev)o(elopmen)o(t)g
(of)f(practical)i(and)f(cost-e\013ectiv)o(e)i(large-scale)249
1425 y(parallel)c(applications.)31 b(It)19 b(giv)o(es)f(a)g(complete)g
(sp)q(eci\014cation)h(of)f(the)h Fw(MPI)f FA(standard)h(and)249
1479 y(pro)o(vides)i(illustrativ)o(e)f(programmi)o(ng)e(examples.)38
b(This)20 b(adv)n(anced)h(lev)o(el)g(b)q(o)q(ok)f(supple-)249
1533 y(men)o(ts)12 b(the)i(companion,)c(in)o(tro)q(ductory)j(v)o(olume)
e(in)h(the)i(Series)f(b)o(y)g(William)c(Gropp,)j(Ewing)249
1587 y(Lusk)k(and)f(An)o(thon)o(y)g(Skjellum,)d FB(Using)k(MPI:)h
(Portable)e(Par)n(al)r(lel)h(Pr)n(o)n(gr)n(amming)f(with)g(the)249
1641 y(Message-Passing)h(Interfac)n(e)p FA(.)249 1794
y(Jan)o(usz)f(S.)e(Ko)o(w)o(alik)p eop
%%Page: 10 10
10 9 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v eop
%%Page: 11 11
11 10 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 260 a FD(Preface)291 561 y Fw(MPI)p FA(,)18
b(the)i(Message)h(P)o(assing)f(In)o(terface,)h(is)f(a)f(standardized)i
(and)e(p)q(ortable)h(message-)249 615 y(passing)f(system)h(designed)g
(b)o(y)f(a)g(group)g(of)g(researc)o(hers)j(from)c(academia)g(and)h
(industry)249 669 y(to)h(function)g(on)g(a)g(wide)h(v)n(ariet)o(y)e(of)
h(parallel)f(computers.)38 b(The)20 b(standard)h(de\014nes)h(the)249
723 y(syn)o(tax)16 b(and)f(seman)o(tics)h(of)f(a)h(core)g(of)f(library)
g(routines)i(useful)f(to)f(a)h(wide)g(range)g(of)f(users)249
777 y(writing)e(p)q(ortable)i(message-passing)e(programs)g(in)g(F)m
(ortran)h(77)g(or)g(C.)f(Sev)o(eral)i(w)o(ell-tested)249
831 y(and)j(e\016cien)o(t)g(implemen)o(tations)d(of)j
Fw(MPI)f FA(already)h(exist,)h(including)e(some)g(that)h(are)h(free)249
885 y(and)g(in)g(the)h(public)f(domain.)31 b(These)21
b(are)e(b)q(eginning)g(to)g(foster)h(the)g(dev)o(elopmen)o(t)e(of)h(a)
249 939 y(parallel)e(soft)o(w)o(are)g(industry)m(,)h(and)g(there)h(is)e
(excitemen)o(t)h(among)d(computing)h(researc)o(hers)249
993 y(and)k(v)o(endors)h(that)f(the)h(dev)o(elopmen)o(t)e(of)h(p)q
(ortable)g(and)g(scalable,)h(large-scale)g(parallel)249
1047 y(applications)13 b(is)h(no)o(w)f(feasible.)291
1101 y(The)k Fw(MPI)f FA(standardization)h(e\013ort)h(in)o(v)o(olv)o
(ed)e(o)o(v)o(er)h(80)f(p)q(eople)i(from)d(40)i(organizations,)249
1155 y(mainly)e(from)i(the)h(United)h(States)g(and)f(Europ)q(e.)31
b(Most)19 b(of)e(the)i(ma)r(jor)d(v)o(endors)j(of)e(con-)249
1209 y(curren)o(t)g(computers)f(at)g(the)h(time)d(w)o(ere)j(in)o(v)o
(olv)o(ed)e(in)g Fw(MPI)p FA(,)g(along)g(with)g(researc)o(hers)k(from)
249 1263 y(univ)o(ersities,)f(go)o(v)o(ernmen)o(t)e(lab)q(oratories,)i
(and)f(industry)m(.)28 b(The)18 b(standardization)f(pro)q(cess)249
1317 y(b)q(egan)12 b(with)f(the)h(W)m(orkshop)f(on)h(Standards)g(for)f
(Message)i(P)o(assing)e(in)g(a)h(Distributed)g(Mem-)249
1371 y(ory)18 b(En)o(vironmen)o(t,)f(sp)q(onsored)i(b)o(y)f(the)h(Cen)o
(ter)g(for)e(Researc)o(h)i(on)f(P)o(arallel)f(Computing,)249
1425 y(held)h(April)f(29-30,)f(1992,)h(in)g(William)o(sburg,)f
(Virginia)g([29)o(].)28 b(A)18 b(preliminary)d(draft)j(pro-)249
1479 y(p)q(osal,)12 b(kno)o(wn)h(as)g(MPI1,)g(w)o(as)g(put)g(forw)o
(ard)g(b)o(y)g(Dongarra,)f(Hemp)q(el,)g(Hey)m(,)h(and)g(W)m(alk)o(er)f
(in)249 1533 y(No)o(v)o(em)o(b)q(er)h(1992,)g(and)g(a)h(revised)h(v)o
(ersion)f(w)o(as)g(completed)f(in)g(F)m(ebruary)i(1993)d([11)o(].)291
1587 y(In)f(No)o(v)o(em)o(b)q(er)h(1992,)e(a)i(meeting)f(of)g(the)i
Fw(MPI)e FA(w)o(orking)g(group)g(w)o(as)h(held)g(in)g(Minneap)q(olis,)
249 1641 y(at)19 b(whic)o(h)h(it)f(w)o(as)g(decided)i(to)e(place)h(the)
g(standardization)f(pro)q(cess)i(on)e(a)g(more)g(formal)249
1694 y(fo)q(oting.)d(The)11 b Fw(MPI)f FA(w)o(orking)f(group)i(met)e
(ev)o(ery)j(6)e(w)o(eeks)h(throughout)g(the)g(\014rst)g(9)g(mon)o(ths)e
(of)249 1748 y(1993.)16 b(The)d(draft)e Fw(MPI)g FA(standard)i(w)o(as)e
(presen)o(ted)j(at)e(the)g(Sup)q(ercomputing)g('93)e(conference)249
1802 y(in)19 b(No)o(v)o(em)o(b)q(er)f(1993.)32 b(After)19
b(a)g(p)q(erio)q(d)g(of)f(public)h(commen)o(ts,)f(whic)o(h)h(resulted)h
(in)e(some)249 1856 y(c)o(hanges)d(in)e Fw(MPI)p FA(,)g(v)o(ersion)h
(1.0)f(of)g Fw(MPI)g FA(w)o(as)h(released)h(in)f(June)g(1994.)291
1910 y(These)k(meetings)e(and)h(the)h(email)d(discussion)i(together)h
(constituted)h(the)e Fw(MPI)g FA(F)m(orum,)249 1964 y(mem)o(b)q(ership)
c(of)g(whic)o(h)h(has)g(b)q(een)h(op)q(en)g(to)f(all)f(mem)o(b)q(ers)f
(of)i(the)g(high)g(p)q(erformance)g(com-)249 2018 y(puting)g(comm)o
(uni)o(t)o(y)m(.)291 2072 y(This)19 b(b)q(o)q(ok)h(serv)o(es)h(as)f(an)
f(annotated)h(reference)i(man)o(ual)17 b(for)j Fw(MPI)p
FA(,)e(and)i(a)f(complete)249 2126 y(sp)q(eci\014cation)11
b(of)g(the)g(standard)g(is)g(presen)o(ted.)19 b(W)m(e)10
b(rep)q(eat)i(the)f(material)e(already)h(published)249
2180 y(in)g(the)h Fw(MPI)e FA(sp)q(eci\014cation)i(do)q(cumen)o(t)f
([15)o(],)g(though)g(an)g(attempt)f(to)h(clarify)f(has)i(b)q(een)g
(made.)249 2234 y(The)g(annotations)g(mainly)d(tak)o(e)j(the)g(form)f
(of)g(explaining)f(wh)o(y)i(certain)h(design)f(c)o(hoices)g(w)o(ere)249
2288 y(made,)g(ho)o(w)h(users)i(are)f(mean)o(t)e(to)h(use)i(the)f(in)o
(terface,)g(and)f(ho)o(w)g Fw(MPI)g FA(implem)o(en)o(tors)f(should)249
2342 y(construct)16 b(a)e(v)o(ersion)h(of)f Fw(MPI)p
FA(.)f(Man)o(y)h(detailed,)g(illustrativ)o(e)g(programmi)o(ng)d
(examples)j(are)249 2396 y(also)h(giv)o(en,)h(with)f(an)h(ey)o(e)g(to)o
(w)o(ard)g(illumina)o(ting)d(the)j(more)f(adv)n(anced)h(or)g(subtle)g
(features)249 2450 y(of)d Fw(MPI)p FA(.)291 2504 y(The)h(complete)g(in)
o(terface)h(is)f(presen)o(ted)i(in)e(this)g(b)q(o)q(ok,)g(and)g(w)o(e)g
(are)h(not)f(hesitan)o(t)g(to)g(ex-)p eop
%%Page: 12 12
12 11 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(xii)1331 b(Preface)249 507 y FA(plain)11
b(ev)o(en)h(the)g(most)f(esoteric)i(features)g(or)e(consequences)k(of)c
(the)h(standard.)18 b(As)12 b(suc)o(h,)g(this)249 561
y(v)o(olume)h(do)q(es)i(not)f(w)o(ork)g(as)g(a)g(gen)o(tle)h(in)o(tro)q
(duction)f(to)g Fw(MPI)p FA(,)f(nor)i(as)f(a)g(tutorial.)19
b(F)m(or)14 b(suc)o(h)249 615 y(purp)q(oses,)j(w)o(e)f(recommend)e(the)
j(companion)c(v)o(olume)h(in)h(this)h(series)h(b)o(y)e(William)d
(Gropp,)249 669 y(Ewing)17 b(Lusk,)h(and)g(An)o(thon)o(y)f(Skjellum,)f
FB(Using)i(MPI:)g(Portable)g(Par)n(al)r(lel)f(Pr)n(o)n(gr)n(amming)249
723 y(with)g(the)g(Message-Passing)h(Interfac)n(e)p FA(.)26
b(The)17 b(parallel)e(application)g(dev)o(elop)q(er)j(will)d(w)o(an)o
(t)249 777 y(to)f(ha)o(v)o(e)g(copies)g(of)f(b)q(oth)h(b)q(o)q(oks)g
(handy)m(.)291 831 y(F)m(or)i(a)g(\014rst)i(reading,)f(and)f(as)h(a)g
(go)q(o)q(d)f(in)o(tro)q(duction)h(to)f Fw(MPI)p FA(,)g(the)h(reader)h
(should)f(\014rst)249 885 y(read:)27 b(Chapter)19 b(1,)g(through)f
(Section)h(1.7.1;)f(the)h(material)e(on)h(p)q(oin)o(t)f(to)i(p)q(oin)o
(t)e(comm)o(u-)249 939 y(nications)g(co)o(v)o(ered)i(in)e(Sections)i
(2.1)d(through)i(2.5)f(and)g(Section)h(2.8;)g(the)g(simpler)f(forms)249
993 y(of)e(collectiv)o(e)h(comm)o(unicatio)o(ns)e(explained)h(in)g
(Sections)i(4.1)d(through)i(4.7;)f(and)h(the)g(basic)249
1047 y(in)o(tro)q(duction)f(to)f(comm)o(unicators)f(giv)o(en)h(in)h
(Sections)g(5.1)f(through)h(5.2.)20 b(This)15 b(will)e(giv)o(e)i(a)249
1101 y(fair)f(understanding)i(of)e Fw(MPI)p FA(,)g(and)h(will)e(allo)o
(w)h(the)h(construction)h(of)f(parallel)e(applications)249
1155 y(of)g(mo)q(derate)h(complexit)o(y)m(.)291 1209
y(This)i(b)q(o)q(ok)h(is)g(based)h(on)e(the)i(hard)f(w)o(ork)f(of)h
(man)o(y)e(p)q(eople)i(in)g(the)g Fw(MPI)g FA(F)m(orum.)25
b(The)249 1263 y(authors)12 b(gratefully)f(recognize)i(the)g(mem)o(b)q
(ers)e(of)g(the)i(forum,)d(esp)q(ecially)i(the)g(con)o(tributions)249
1317 y(made)g(b)o(y)g(mem)o(b)q(ers)f(who)i(serv)o(ed)h(in)e(p)q
(ositions)g(of)g(resp)q(onsibilit)o(y:)17 b(Lyndon)c(Clark)o(e,)f
(James)249 1371 y(Co)o(wnie,)i(Al)f(Geist,)h(William)d(Gropp,)i(Rolf)g
(Hemp)q(el,)g(Rob)q(ert)i(Knigh)o(ten,)f(Ric)o(hard)g(Little-)249
1425 y(\014eld,)c(Ewing)g(Lusk,)g(P)o(aul)g(Pierce,)h(and)f(An)o(thon)o
(y)g(Skjellum.)k(Other)e(con)o(tributors)e(w)o(ere:)17
b(Ed)249 1479 y(Anderson,)d(Rob)q(ert)g(Babb,)f(Jo)q(e)h(Baron,)f(Eric)
h(Barszcz,)h(Scott)f(Berryman,)f(Rob)g(Bjornson,)249
1533 y(Nathan)d(Doss,)h(Anne)g(Elster,)h(Jim)d(F)m(eeney)m(,)i(Vince)g
(F)m(ernando,)f(Sam)f(Fineb)q(erg,)j(Jon)e(Flo)o(w)o(er,)249
1587 y(Daniel)g(F)m(ry)o(e,)h(Ian)g(Glendinning,)f(Adam)f(Green)o(b)q
(erg,)k(Rob)q(ert)e(Harrison,)g(Leslie)g(Hart,)h(T)m(om)249
1641 y(Haupt,)f(Don)f(Heller,)h(T)m(om)d(Henderson,)13
b(An)o(thon)o(y)d(Hey)m(,)h(Alex)f(Ho,)h(C.T.)e(Ho)o(w)o(ard)h(Ho,)h
(Gary)249 1694 y(Ho)o(w)o(ell,)16 b(John)h(Kap)q(enga,)f(James)g(Kohl,)
h(Susan)g(Krauss,)g(Bob)g(Leary)m(,)g(Arth)o(ur)g(Maccab)q(e,)249
1748 y(P)o(eter)12 b(Madams,)d(Alan)g(Main)o(w)o(aring,)g(Oliv)o(er)h
(McBry)o(an,)h(Phil)e(McKinley)m(,)h(Charles)h(Mosher,)249
1802 y(Dan)k(Nessett,)j(P)o(eter)f(P)o(ac)o(heco,)f(Ho)o(w)o(ard)f(P)o
(almer,)f(Sanja)o(y)h(Rank)n(a,)f(P)o(eter)j(Rigsb)q(ee,)f(Arc)o(h)249
1856 y(Robison,)e(Eric)o(h)i(Sc)o(hikuta,)f(Mark)g(Sears,)h(Am)o(buj)e
(Singh,)h(Alan)g(Sussman,)f(Rob)q(ert)i(T)m(om-)249 1910
y(linson,)g(Rob)q(ert)h(G.)f(V)m(oigt,)g(Dennis)h(W)m(eeks,)g(Stephen)h
(Wheat,)f(and)f(Stev)o(en)i(Zenith.)27 b(W)m(e)249 1964
y(esp)q(ecially)11 b(thank)f(William)d(Gropp)k(and)f(Ewing)g(Lusk)h
(for)g(help)f(in)h(formatting)d(this)j(v)o(olume.)291
2018 y(Supp)q(ort)i(for)g Fw(MPI)g FA(meetings)f(came)h(in)g(part)g
(from)f(ARP)m(A)h(and)g(NSF)g(under)h(gran)o(t)f(ASC-)249
2072 y(9310330,)i(NSF)i(Science)h(and)e(T)m(ec)o(hnology)g(Cen)o(ter)i
(Co)q(op)q(erativ)o(e)f(agreemen)o(t)f(No.)26 b(CCR-)249
2126 y(8809615,)11 b(and)h(the)h(Commission)d(of)i(the)h(Europ)q(ean)g
(Comm)o(unit)o(y)c(through)k(Esprit)g(Pro)r(ject)249
2180 y(P6643.)22 b(The)15 b(Univ)o(ersit)o(y)g(of)g(T)m(ennessee)j
(also)c(made)g(\014nancial)h(con)o(tributions)g(to)g(the)h
Fw(MPI)249 2234 y FA(F)m(orum.)p eop
%%Page: 13 13
13 12 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 263 a FE(MPI:)19 b(The)g(Complete)h(Reference)p
eop
%%Page: 14 14
14 13 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(xiv)1321 b(Preface)p eop
%%Page: 1 15
1 14 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 325 a Fu(1)25 b FD(In)o(tro)q(duction)291
561 y FA(Message)14 b(passing)g(is)f(a)h(programmi)o(ng)d(paradigm)g
(used)k(widely)e(on)g(parallel)g(computers,)249 615 y(esp)q(ecially)18
b(Scalable)g(P)o(arallel)f(Computers)g(\(SPCs\))i(with)f(distributed)g
(memory)m(,)e(and)i(on)249 669 y(Net)o(w)o(orks)c(of)e(W)m(orkstations)
g(\(NO)o(Ws\).)19 b(Although)12 b(there)j(are)e(man)o(y)e(v)n
(ariations,)h(the)h(basic)249 723 y(concept)g(of)d(pro)q(cesses)k(comm)
o(unicating)8 b(through)j(messages)g(is)g(w)o(ell)g(understo)q(o)q(d.)
18 b(Ov)o(er)12 b(the)249 777 y(last)f(ten)g(y)o(ears,)g(substan)o
(tial)g(progress)h(has)f(b)q(een)h(made)d(in)h(casting)h(signi\014can)o
(t)f(applications)249 831 y(in)o(to)k(this)g(paradigm.)k(Eac)o(h)d(v)o
(endor)g(has)g(implem)o(en)o(ted)e(its)h(o)o(wn)g(v)n(arian)o(t.)19
b(More)c(recen)o(tly)m(,)249 885 y(sev)o(eral)i(public-domain)d
(systems)j(ha)o(v)o(e)f(demonstrated)h(that)f(a)h(message-passing)f
(system)249 939 y(can)j(b)q(e)h(e\016cien)o(tly)f(and)g(p)q(ortably)g
(implem)o(en)o(ted.)32 b(It)19 b(is)g(th)o(us)h(an)f(appropriate)g
(time)f(to)249 993 y(de\014ne)g(b)q(oth)f(the)h(syn)o(tax)f(and)g
(seman)o(tics)g(of)f(a)h(standard)h(core)g(of)e(library)h(routines)g
(that)249 1047 y(will)h(b)q(e)h(useful)h(to)f(a)f(wide)h(range)h(of)e
(users)j(and)e(e\016cien)o(tly)g(implem)o(en)o(table)e(on)i(a)f(wide)
249 1101 y(range)e(of)f(computers.)24 b(This)16 b(e\013ort)g(has)g(b)q
(een)h(undertak)o(en)g(o)o(v)o(er)e(the)i(last)e(three)i(y)o(ears)g(b)o
(y)249 1155 y(the)11 b(Message)g(P)o(assing)f(In)o(terface)h(\()p
Fw(MPI)p FA(\))f(F)m(orum,)f(a)h(group)g(of)f(more)g(than)h(80)g(p)q
(eople)h(from)d(40)249 1209 y(organizations,)13 b(represen)o(ting)j(v)o
(endors)g(of)d(parallel)h(systems,)g(industrial)g(users,)h(industrial)
249 1263 y(and)f(national)e(researc)o(h)k(lab)q(oratories,)d(and)h
(univ)o(ersities.)291 1317 y(The)k(designers)h(of)e Fw(MPI)h
FA(sough)o(t)g(to)f(mak)o(e)g(use)i(of)e(the)h(most)f(attractiv)o(e)h
(features)h(of)f(a)249 1371 y(n)o(um)o(b)q(er)12 b(of)g(existing)g
(message-passing)g(systems,)g(rather)i(than)e(selecting)h(one)g(of)f
(them)g(and)249 1425 y(adopting)19 b(it)h(as)g(the)h(standard.)37
b(Th)o(us,)22 b Fw(MPI)d FA(has)h(b)q(een)i(strongly)e(in\015uenced)h
(b)o(y)f(w)o(ork)249 1479 y(at)c(the)h(IBM)g(T.)f(J.)g(W)m(atson)f
(Researc)o(h)j(Cen)o(ter)f([1,)e(2],)h(In)o(tel's)g(NX/2)g([24)o(],)g
(Express)i([23)o(],)249 1533 y(nCUBE's)d(V)m(ertex)h([22)o(],)e(p4)g
([6,)g(5],)g(and)g(P)m(ARMA)o(CS)g([3,)g(7].)20 b(Other)15
b(imp)q(ortan)o(t)e(con)o(tribu-)249 1587 y(tions)i(ha)o(v)o(e)g(come)f
(from)g(Zip)q(co)q(de)i([25)o(,)f(26)o(],)g(Chimp)e([13)o(,)i(14)o(],)g
(PVM)g([17)o(,)g(27)o(],)g(Chameleon)249 1641 y([19)o(],)d(and)h(PICL)g
([18)o(].)k(The)d Fw(MPI)e FA(F)m(orum)f(iden)o(ti\014ed)i(some)f
(critical)h(shortcomings)f(of)g(exist-)249 1694 y(ing)h
(message-passing)h(systems,)g(in)f(areas)i(suc)o(h)f(as)g(complex)f
(data)h(la)o(y)o(outs)f(or)h(supp)q(ort)h(for)249 1748
y(mo)q(dularit)o(y)e(and)i(safe)g(comm)o(unication.)j(This)d(led)h(to)f
(the)g(in)o(tro)q(duction)g(of)g(new)g(features)249 1802
y(in)e Fw(MPI)p FA(.)291 1856 y(The)j Fw(MPI)f FA(standard)h(de\014nes)
i(the)e(user)h(in)o(terface)f(and)g(functionalit)o(y)e(for)i(a)f(wide)h
(range)249 1910 y(of)j(message-passing)g(capabilities.)35
b(Since)21 b(its)e(completion)f(in)i(June)g(of)f(1994,)h
Fw(MPI)f FA(has)249 1964 y(b)q(ecome)f(widely)g(accepted)i(and)e(used.)
33 b(Implemen)o(tations)15 b(are)k(a)o(v)n(ailable)d(on)i(a)g(range)h
(of)249 2018 y(mac)o(hines)13 b(from)f(SPCs)j(to)f(NO)o(Ws.)k(A)c(gro)o
(wing)f(n)o(um)o(b)q(er)h(of)f(SPCs)h(ha)o(v)o(e)g(an)g
Fw(MPI)f FA(supplied)249 2072 y(and)j(supp)q(orted)i(b)o(y)e(the)g(v)o
(endor.)26 b(Because)18 b(of)d(this,)i Fw(MPI)e FA(has)i(ac)o(hiev)o
(ed)f(one)h(of)e(its)h(goals)249 2126 y(|)e(adding)f(credibilit)o(y)h
(to)g(parallel)f(computing.)k(Third)d(part)o(y)g(v)o(endors,)h(researc)
o(hers,)i(and)249 2180 y(others)h(no)o(w)e(ha)o(v)o(e)g(a)h(reliable)f
(and)h(p)q(ortable)f(w)o(a)o(y)g(to)h(express)h(message-passing,)f
(parallel)249 2234 y(programs.)291 2288 y(The)d(ma)r(jor)d(goal)i(of)g
Fw(MPI)p FA(,)f(as)i(with)f(most)f(standards,)i(is)f(a)h(degree)g(of)f
(p)q(ortabilit)o(y)f(across)249 2342 y(di\013eren)o(t)18
b(mac)o(hines.)28 b(The)18 b(exp)q(ectation)g(is)f(for)g(a)g(degree)i
(of)e(p)q(ortabilit)o(y)f(comparable)g(to)249 2396 y(that)f(giv)o(en)f
(b)o(y)g(programmi)o(ng)e(languages)h(suc)o(h)j(as)e(F)m(ortran.)20
b(This)14 b(means)g(that)g(the)h(same)249 2450 y(message-passing)10
b(source)i(co)q(de)g(can)f(b)q(e)g(executed)i(on)e(a)f(v)n(ariet)o(y)g
(of)g(mac)o(hines)g(as)h(long)f(as)h(the)249 2504 y Fw(MPI)h
FA(library)f(is)h(a)o(v)n(ailable,)e(while)h(some)h(tuning)f(migh)o(t)f
(b)q(e)j(needed)h(to)e(tak)o(e)g(b)q(est)h(adv)n(an)o(tage)986
2613 y(1)p eop
%%Page: 2 16
2 15 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(2)1294 b(Chapter)13 b(1)249 507
y FA(of)19 b(the)h(features)g(of)f(eac)o(h)h(system.)34
b(Though)18 b(message)h(passing)h(is)f(often)g(though)o(t)g(of)g(in)249
561 y(the)c(con)o(text)f(of)g(distributed-memory)e(parallel)h
(computers,)g(the)i(same)e(co)q(de)i(can)f(run)g(w)o(ell)249
615 y(on)i(a)f(shared-memory)f(parallel)h(computer.)23
b(It)16 b(can)g(run)g(on)f(a)h(net)o(w)o(ork)g(of)f(w)o(orkstations,)
249 669 y(or,)j(indeed,)h(as)e(a)g(set)i(of)e(pro)q(cesses)j(running)d
(on)h(a)f(single)g(w)o(orkstation.)29 b(Kno)o(wing)16
b(that)249 723 y(e\016cien)o(t)d Fw(MPI)g FA(implem)o(en)o(tations)d
(exist)j(across)h(a)f(wide)f(v)n(ariet)o(y)h(of)f(computers)h(giv)o(es)
g(a)f(high)249 777 y(degree)h(of)f(\015exibilit)o(y)e(in)h(co)q(de)i
(dev)o(elopmen)o(t,)e(debugging,)g(and)h(in)f(c)o(ho)q(osing)h(a)f
(platform)f(for)249 831 y(pro)q(duction)k(runs.)291 885
y(Another)h(t)o(yp)q(e)f(of)g(compatibilit)o(y)d(o\013ered)k(b)o(y)f
Fw(MPI)f FA(is)h(the)h(abilit)o(y)d(to)i(run)h(transparen)o(tly)249
939 y(on)20 b(heterogeneous)i(systems,)g(that)e(is,)h(collections)f(of)
g(pro)q(cessors)i(with)e(distinct)h(arc)o(hi-)249 993
y(tectures.)29 b(It)17 b(is)g(p)q(ossible)g(for)g(an)g
Fw(MPI)f FA(implemen)o(tatio)o(n)e(to)j(span)g(suc)o(h)h(a)e
(heterogeneous)249 1047 y(collection,)11 b(y)o(et)g(pro)o(vide)g(a)g
(virtual)f(computing)f(mo)q(del)h(that)h(hides)g(man)o(y)f(arc)o
(hitectural)h(dif-)249 1101 y(ferences.)24 b(The)16 b(user)h(need)f
(not)f(w)o(orry)g(whether)i(the)f(co)q(de)g(is)f(sending)h(messages)f
(b)q(et)o(w)o(een)249 1155 y(pro)q(cessors)k(of)e(lik)o(e)f(or)i(unlik)
o(e)e(arc)o(hitecture.)30 b(The)18 b Fw(MPI)e FA(implemen)o(tatio)o(n)f
(will)g(automat-)249 1209 y(ically)k(do)g(an)o(y)h(necessary)i(data)e
(con)o(v)o(ersion)g(and)g(utilize)f(the)i(correct)h(comm)o(uni)o
(cations)249 1263 y(proto)q(col.)f(Ho)o(w)o(ev)o(er,)15
b Fw(MPI)g FA(do)q(es)g(not)g(prohibit)g(implem)o(en)o(tations)d(that)k
(are)f(targeted)h(to)f(a)249 1317 y(single,)f(homogeneous)g(system,)g
(and)g(do)q(es)h(not)g(mandate)e(that)i(distinct)g(implem)o(en)o
(tations)249 1371 y(b)q(e)g(in)o(terop)q(erable.)20 b(Users)c(that)e
(wish)h(to)f(run)g(on)h(an)f(heterogeneous)i(system)e(m)o(ust)f(use)j
(an)249 1425 y Fw(MPI)d FA(implemen)o(tation)e(designed)j(to)g(supp)q
(ort)h(heterogeneit)o(y)m(.)291 1479 y(P)o(ortabilit)o(y)8
b(is)h(cen)o(tral)h(but)g(the)g(standard)g(will)e(not)h(gain)g(wide)g
(usage)h(if)f(this)h(w)o(as)f(ac)o(hiev)o(ed)249 1533
y(at)i(the)h(exp)q(ense)h(of)e(p)q(erformance.)17 b(F)m(or)11
b(example,)f(F)m(ortran)h(is)h(commonl)o(y)c(used)13
b(o)o(v)o(er)e(assem-)249 1587 y(bly)j(languages)h(b)q(ecause)h
(compilers)e(are)i(almost)d(alw)o(a)o(ys)g(a)o(v)n(ailable)g(that)i
(yield)f(acceptable)249 1641 y(p)q(erformance)j(compared)f(to)h(the)g
(non-p)q(ortable)g(alternativ)o(e)f(of)g(assem)o(bly)g(languages.)26
b(A)249 1694 y(crucial)12 b(p)q(oin)o(t)g(is)g(that)g
Fw(MPI)f FA(w)o(as)i(carefully)e(designed)i(so)f(as)h(to)f(allo)o(w)e
(e\016cien)o(t)j(implem)o(en)o(ta-)249 1748 y(tions.)20
b(The)15 b(design)f(c)o(hoices)i(seem)e(to)g(ha)o(v)o(e)h(b)q(een)g
(made)e(correctly)m(,)i(since)h Fw(MPI)d FA(implemen-)249
1802 y(tations)g(o)o(v)o(er)f(a)h(wide)g(range)g(of)f(platforms)f(are)i
(ac)o(hieving)f(high)g(p)q(erformance,)h(comparable)249
1856 y(to)h(that)g(of)f(less)i(p)q(ortable,)e(v)o(endor-sp)q(eci\014c)j
(systems.)291 1910 y(An)g(imp)q(ortan)o(t)e(design)j(goal)e(of)g
Fw(MPI)h FA(w)o(as)g(to)g(allo)o(w)f(e\016cien)o(t)h(implemen)o
(tations)d(across)249 1964 y(mac)o(hines)h(of)g(di\013ering)g(c)o
(haracteristics.)22 b(F)m(or)14 b(example,)f Fw(MPI)h
FA(carefully)g(a)o(v)o(oids)g(sp)q(ecifying)249 2018
y(ho)o(w)h(op)q(erations)h(will)e(tak)o(e)h(place.)23
b(It)15 b(only)g(sp)q(eci\014es)i(what)e(an)g(op)q(eration)h(do)q(es)g
(logically)m(.)249 2072 y(As)d(a)g(result,)g Fw(MPI)f
FA(can)h(b)q(e)h(easily)e(implemen)o(ted)f(on)h(systems)h(that)g
(bu\013er)h(messages)f(at)g(the)249 2126 y(sender,)j(receiv)o(er,)g(or)
f(do)g(no)f(bu\013ering)h(at)g(all.)k(Implemen)o(tations)12
b(can)j(tak)o(e)g(adv)n(an)o(tage)f(of)249 2180 y(sp)q(eci\014c)e
(features)f(of)f(the)h(comm)o(unication)c(subsystem)j(of)g(v)n(arious)g
(mac)o(hines.)16 b(On)10 b(mac)o(hines)249 2234 y(with)i(in)o(telligen)
o(t)f(comm)o(unicatio)o(n)e(copro)q(cessors,)15 b(m)o(uc)o(h)c(of)g
(the)i(message)f(passing)g(proto)q(col)249 2288 y(can)g(b)q(e)h
(o\017oaded)e(to)h(this)g(copro)q(cessor.)19 b(On)13
b(other)f(systems,)g(most)f(of)g(the)i(comm)o(unicatio)o(n)249
2342 y(co)q(de)19 b(is)g(executed)h(b)o(y)e(the)h(main)e(pro)q(cessor.)
33 b(Another)20 b(example)d(is)h(the)h(use)h(of)d(opaque)249
2396 y(ob)r(jects)f(in)f Fw(MPI)p FA(.)f(By)h(hiding)f(the)h(details)g
(of)f(ho)o(w)h Fw(MPI)p FA(-sp)q(eci\014c)h(ob)r(jects)g(are)f
(represen)o(ted,)249 2450 y(eac)o(h)f(implemen)o(tation)d(is)j(free)g
(to)g(do)g(whatev)o(er)g(is)g(b)q(est)h(under)g(the)f(circumstances.)
291 2504 y(Another)f(design)g(c)o(hoice)g(leading)f(to)h(e\016ciency)g
(is)g(the)g(a)o(v)o(oidance)f(of)g(unnecessary)j(w)o(ork.)p
eop
%%Page: 3 17
3 16 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(In)o(tro)q(duction)1267 b(3)249
507 y Fw(MPI)12 b FA(w)o(as)h(carefully)g(designed)h(so)f(as)g(to)g(a)o
(v)o(oid)f(a)g(requiremen)o(t)h(for)g(large)g(amoun)o(ts)f(of)g(extra)
249 561 y(information)i(with)i(eac)o(h)h(message,)f(or)h(the)g(need)h
(for)e(complex)f(enco)q(ding)i(or)f(deco)q(ding)h(of)249
615 y(message)g(headers.)29 b Fw(MPI)16 b FA(also)g(a)o(v)o(oids)g
(extra)i(computation)d(or)i(tests)i(in)d(critical)h(routines)249
669 y(since)j(this)f(can)g(degrade)g(p)q(erformance.)33
b(Another)20 b(w)o(a)o(y)e(of)g(minim)o(izing)d(w)o(ork)k(is)f(to)h
(en-)249 723 y(courage)c(the)g(reuse)i(of)d(previous)h(computations.)k
Fw(MPI)14 b FA(pro)o(vides)g(this)h(capabilit)o(y)e(through)249
777 y(constructs)j(suc)o(h)e(as)g(p)q(ersisten)o(t)i(comm)o(unicati)o
(on)11 b(requests)16 b(and)d(cac)o(hing)h(of)f(attributes)i(on)249
831 y(comm)o(unicators.)g(The)e(design)g(of)f Fw(MPI)g
FA(a)o(v)o(oids)f(the)i(need)h(for)e(extra)h(cop)o(ying)f(and)g
(bu\013ering)249 885 y(of)j(data:)21 b(in)14 b(man)o(y)g(cases,)j(data)
e(can)g(b)q(e)h(mo)o(v)o(ed)e(from)g(the)i(user)g(memory)d(directly)j
(to)f(the)249 939 y(wire,)f(and)f(b)q(e)i(receiv)o(ed)g(directly)f
(from)e(the)j(wire)f(to)g(the)g(receiv)o(er)i(memory)m(.)291
993 y Fw(MPI)10 b FA(w)o(as)h(designed)g(to)g(encourage)h(o)o(v)o
(erlap)e(of)h(comm)o(unicati)o(on)d(and)j(computation,)e(so)i(as)249
1047 y(to)i(tak)o(e)g(adv)n(an)o(tage)f(of)g(in)o(telligen)o(t)g(comm)o
(unicatio)o(n)e(agen)o(ts,)j(and)g(to)g(hide)g(comm)o(unicatio)o(n)249
1101 y(latencies.)25 b(This)16 b(is)g(ac)o(hiev)o(ed)h(b)o(y)e(the)i
(use)g(of)e(non)o(blo)q(c)o(king)g(comm)o(unication)e(calls,)j(whic)o
(h)249 1155 y(separate)f(the)g(initiation)d(of)h(a)g(comm)o(unication)e
(from)h(its)i(completion.)291 1209 y(Scalabilit)o(y)g(is)j(an)f(imp)q
(ortan)o(t)f(goal)h(of)g(parallel)f(pro)q(cessing.)28
b Fw(MPI)16 b FA(allo)o(ws)g(or)g(supp)q(orts)249 1263
y(scalabilit)o(y)e(through)h(sev)o(eral)h(of)e(its)h(design)h
(features.)23 b(F)m(or)15 b(example,)e(an)i(application)f(can)249
1317 y(create)i(subgroups)g(of)e(pro)q(cesses)j(that,)e(in)f(turn,)h
(allo)o(ws)e(collectiv)o(e)i(comm)o(unicati)o(on)d(op)q(er-)249
1371 y(ations)18 b(to)g(limit)d(their)j(scop)q(e)h(to)f(the)h(pro)q
(cesses)i(in)o(v)o(olv)o(ed.)29 b(Another)19 b(tec)o(hnique)g(used)g
(is)249 1425 y(to)d(pro)o(vide)f(functionalit)o(y)f(without)h(a)h
(computation)e(that)h(scales)i(as)e(the)i(n)o(um)o(b)q(er)e(of)g(pro-)
249 1479 y(cesses.)20 b(F)m(or)14 b(example,)e(a)h(t)o(w)o
(o-dimensional)e(Cartesian)j(top)q(ology)f(can)h(b)q(e)g(sub)q(divided)
g(in)o(to)249 1533 y(its)g(one-dimensional)e(ro)o(ws)i(or)g(columns)f
(without)h(explicitly)f(en)o(umerating)g(the)h(pro)q(cesses.)291
1641 y(Finally)m(,)d Fw(MPI)p FA(,)i(as)h(all)e(go)q(o)q(d)i
(standards,)g(is)g(v)n(aluable)e(in)i(that)g(it)f(de\014nes)i(a)f(kno)o
(wn,)f(mini-)249 1694 y(m)o(um)e(b)q(eha)o(vior)k(of)e(message-passing)
h(implemen)o(tations.)i(This)f(reliev)o(es)g(the)g(programmer)249
1748 y(from)e(ha)o(ving)g(to)i(w)o(orry)g(ab)q(out)f(certain)h
(problems)f(that)h(can)g(arise.)20 b(One)c(example)d(is)h(that)249
1802 y Fw(MPI)g FA(guaran)o(tees)h(that)f(the)h(underlying)f
(transmission)f(of)h(messages)g(is)g(reliable.)19 b(The)14
b(user)249 1856 y(need)h(not)f(c)o(hec)o(k)h(if)e(a)g(message)h(is)g
(receiv)o(ed)h(correctly)m(.)249 1977 y FD(1.1)52 b(The)18
b(Goals)g(of)g Fw(MPI)249 2085 y FA(The)g(goal)e(of)g(the)i(Message)g
(P)o(assing)f(In)o(terface,)i(simply)c(stated,)j(is)f(to)g(dev)o(elop)g
(a)g(widely)249 2139 y(used)e(standard)g(for)e(writing)h
(message-passing)f(programs.)18 b(As)c(suc)o(h)h(the)g(in)o(terface)g
(should)249 2193 y(establish)f(a)g(practical,)f(p)q(ortable,)h
(e\016cien)o(t,)g(and)f(\015exible)h(standard)g(for)g(message)f
(passing.)291 2247 y(A)h(list)f(of)g(the)i(goals)e(of)g
Fw(MPI)g FA(app)q(ears)i(b)q(elo)o(w.)249 2330 y Ft(\017)29
b FA(Design)16 b(an)g(application)e(programming)f(in)o(terface.)25
b(Although)15 b Fw(MPI)h FA(is)g(curren)o(tly)h(used)249
2384 y(as)i(a)f(run-time)g(for)g(parallel)g(compilers)g(and)g(for)h(v)n
(arious)f(libraries,)h(the)g(design)g(of)f Fw(MPI)249
2438 y FA(primarily)11 b(re\015ects)16 b(the)f(p)q(erceiv)o(ed)g(needs)
h(of)d(application)f(programmers.)249 2492 y Ft(\017)29
b FA(Allo)o(w)8 b(e\016cien)o(t)i(comm)o(unication.)k(Av)o(oid)8
b(memory-to-m)o(em)o(ory)f(cop)o(ying,)i(allo)o(w)f(o)o(v)o(erlap)p
eop
%%Page: 4 18
4 17 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(4)1294 b(Chapter)13 b(1)249 507
y FA(of)i(computation)e(and)i(comm)o(unication,)d(and)j(o\017oad)g(to)g
(a)g(comm)o(unicati)o(on)e(copro)q(cessor-)249 561 y(pro)q(cessor,)i
(where)g(a)o(v)n(ailable.)249 615 y Ft(\017)29 b FA(Allo)o(w)12
b(for)i(implemen)o(tatio)o(ns)e(that)i(can)g(b)q(e)g(used)h(in)f(a)f
(heterogeneous)j(en)o(vironmen)o(t.)249 669 y Ft(\017)29
b FA(Allo)o(w)8 b(con)o(v)o(enien)o(t)i(C)g(and)g(F)m(ortran)f(77)h
(bindings)f(for)g(the)h(in)o(terface.)18 b(Also,)10 b(the)g(seman)o
(tics)249 723 y(of)j(the)i(in)o(terface)f(should)g(b)q(e)g(language)f
(indep)q(enden)o(t.)249 777 y Ft(\017)29 b FA(Pro)o(vide)15
b(a)g(reliable)f(comm)o(unication)e(in)o(terface.)22
b(The)16 b(user)g(need)g(not)f(cop)q(e)h(with)f(com-)249
831 y(m)o(unication)d(failures.)249 885 y Ft(\017)29
b FA(De\014ne)17 b(an)f(in)o(terface)g(not)g(to)q(o)g(di\013eren)o(t)h
(from)e(curren)o(t)i(practice,)h(suc)o(h)e(as)h(PVM,)f(NX,)249
939 y(Express,)f(p4,)e(etc.,)h(and)g(pro)o(vides)g(extensions)h(that)f
(allo)o(w)e(greater)j(\015exibilit)o(y)m(.)249 993 y
Ft(\017)29 b FA(De\014ne)15 b(an)g(in)o(terface)g(that)g(can)g(b)q(e)g
(implemen)o(ted)d(on)j(man)o(y)d(v)o(endor's)j(platforms,)e(with)249
1047 y(no)h(signi\014can)o(t)f(c)o(hanges)i(in)e(the)i(underlying)e
(comm)o(unication)e(and)i(system)h(soft)o(w)o(are.)249
1101 y Ft(\017)29 b FA(The)14 b(in)o(terface)h(should)e(b)q(e)i
(designed)f(to)g(allo)o(w)e(for)i(thread-safet)o(y)m(.)249
1221 y FD(1.2)52 b(Who)18 b(Should)g(Use)f(This)h(Standard?)249
1329 y FA(The)i Fw(MPI)f FA(standard)h(is)f(in)o(tended)i(for)e(use)h
(b)o(y)g(all)e(those)i(who)g(w)o(an)o(t)f(to)g(write)h(p)q(ortable)249
1383 y(message-passing)10 b(programs)f(in)h(F)m(ortran)h(77)f(and)g(C.)
g(This)g(includes)h(individual)e(application)249 1437
y(programmers,)19 b(dev)o(elop)q(ers)i(of)e(soft)o(w)o(are)g(designed)i
(to)e(run)h(on)f(parallel)g(mac)o(hines,)h(and)249 1491
y(creators)14 b(of)e(en)o(vironmen)o(ts)g(and)g(to)q(ols.)17
b(In)c(order)g(to)g(b)q(e)g(attractiv)o(e)g(to)f(this)h(wide)f
(audience,)249 1545 y(the)e(standard)g(m)o(ust)f(pro)o(vide)h(a)f
(simple,)f(easy-to-use)j(in)o(terface)f(for)g(the)g(basic)g(user)g
(while)g(not)249 1599 y(seman)o(tically)g(precluding)i(the)g(high-p)q
(erformance)f(message-passing)h(op)q(erations)g(a)o(v)n(ailable)249
1653 y(on)i(adv)n(anced)g(mac)o(hines.)249 1773 y FD(1.3)52
b(What)18 b(Platforms)g(are)f(T)l(argets)g(for)g(Implemen)o(tation?)249
1881 y FA(The)g(attractiv)o(eness)g(of)f(the)g(message-passing)g
(paradigm)e(at)h(least)i(partially)d(stems)i(from)249
1935 y(its)e(wide)f(p)q(ortabilit)o(y)m(.)k(Programs)12
b(expressed)k(this)e(w)o(a)o(y)f(ma)o(y)f(run)i(on)f
(distributed-memory)249 1989 y(m)o(ulticomputers,)20
b(shared-memory)f(m)o(ultipro)q(cessors,)j(net)o(w)o(orks)f(of)f(w)o
(orkstations,)i(and)249 2043 y(com)o(binations)16 b(of)h(all)f(of)h
(these.)31 b(The)19 b(paradigm)c(will)h(not)i(b)q(e)g(made)f(obsolete)h
(b)o(y)g(arc)o(hi-)249 2097 y(tectures)h(com)o(bining)14
b(the)j(shared-)g(and)g(distributed-memory)d(views,)j(or)f(b)o(y)h
(increases)h(in)249 2151 y(net)o(w)o(ork)h(sp)q(eeds.)34
b(Th)o(us,)20 b(it)e(should)g(b)q(e)h(b)q(oth)g(p)q(ossible)g(and)f
(useful)h(to)g(implem)o(en)o(t)d(this)249 2205 y(standard)k(on)g(a)f
(great)h(v)n(ariet)o(y)g(of)f(mac)o(hines,)h(including)f(those)h(\\mac)
o(hines")e(consisting)249 2259 y(of)g(collections)h(of)f(other)h(mac)o
(hines,)f(parallel)g(or)g(not,)i(connected)g(b)o(y)f(a)f(comm)o
(unicatio)o(n)249 2313 y(net)o(w)o(ork.)291 2367 y(The)e(in)o(terface)h
(is)f(suitable)g(for)g(use)h(b)o(y)f(fully)f(general)h(Multiple)g
(Instruction,)h(Multiple)249 2421 y(Data)c(\(MIMD\))g(programs,)e(or)j
(Multiple)e(Program,)g(Multiple)g(Data)h(\(MPMD\))g(programs,)249
2475 y(where)f(eac)o(h)f(pro)q(cess)i(follo)o(ws)c(a)i(distinct)g
(execution)h(path)f(through)g(the)g(same)f(co)q(de,)i(or)f(ev)o(en)p
eop
%%Page: 5 19
5 18 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(In)o(tro)q(duction)1267 b(5)249
507 y FA(executes)15 b(a)d(di\013eren)o(t)i(co)q(de.)k(It)13
b(is)f(also)g(suitable)g(for)g(those)i(written)f(in)f(the)h(more)e
(restricted)249 561 y(st)o(yle)20 b(of)e(Single)h(Program,)g(Multiple)f
(Data)h(\(SPMD\),)g(where)h(all)f(pro)q(cesses)i(follo)o(w)d(the)249
615 y(same)13 b(execution)i(path)f(through)g(the)h(same)e(program.)k
(Although)c(no)h(explicit)g(supp)q(ort)h(for)249 669
y(threads)e(is)e(pro)o(vided,)h(the)g(in)o(terface)g(has)g(b)q(een)g
(designed)g(so)g(as)g(not)f(to)h(prejudice)g(their)g(use.)249
723 y(With)17 b(this)g(v)o(ersion)g(of)g Fw(MPI)f FA(no)h(supp)q(ort)i
(is)e(pro)o(vided)g(for)g(dynamic)e(spa)o(wning)i(of)f(tasks;)249
777 y(suc)o(h)f(supp)q(ort)f(is)g(exp)q(ected)i(in)e(future)g(v)o
(ersions)g(of)g Fw(MPI)p FA(;)e(see)k(Section)e(9.5.)291
831 y Fw(MPI)c FA(pro)o(vides)h(man)o(y)e(features)j(in)o(tended)f(to)g
(impro)o(v)o(e)e(p)q(erformance)h(on)h(scalable)g(parallel)249
885 y(computers)k(with)f(sp)q(ecialized)h(in)o(terpro)q(cessor)i(comm)o
(unication)11 b(hardw)o(are.)21 b(Th)o(us,)14 b(w)o(e)h(ex-)249
939 y(p)q(ect)c(that)f(nativ)o(e,)g(high-p)q(erformance)f(implem)o(en)o
(tations)e(of)j Fw(MPI)f FA(will)f(b)q(e)i(pro)o(vided)g(on)g(suc)o(h)
249 993 y(mac)o(hines.)16 b(A)o(t)11 b(the)g(same)e(time,)g(implemen)o
(tations)f(of)h Fw(MPI)h FA(on)g(top)h(of)e(standard)i(Unix)f(in)o
(ter-)249 1047 y(pro)q(cessor)16 b(comm)o(uni)o(cation)11
b(proto)q(cols)i(will)g(pro)o(vide)g(p)q(ortabilit)o(y)f(to)i(w)o
(orkstation)f(clusters)249 1101 y(and)19 b(heterogeneous)j(net)o(w)o
(orks)e(of)f(w)o(orkstations.)35 b(Sev)o(eral)20 b(proprietary)m(,)g
(nativ)o(e)f(imple-)249 1155 y(men)o(tations)c(of)h Fw(MPI)p
FA(,)g(and)g(public)h(domain,)d(p)q(ortable)j(implemen)o(tati)o(on)d
(of)i Fw(MPI)g FA(are)h(no)o(w)249 1209 y(a)o(v)n(ailable.)f(See)f
(Section)f(9.4)f(for)g(more)g(information)e(ab)q(out)j
Fw(MPI)f FA(implemen)o(tations.)249 1329 y FD(1.4)52
b(What)18 b(is)g(Included)g(in)g Fw(MPI)p FD(?)249 1437
y FA(The)c(standard)h(includes:)249 1520 y Ft(\017)29
b FA(P)o(oin)o(t-to-p)q(oin)o(t)12 b(comm)o(unication)249
1574 y Ft(\017)29 b FA(Collectiv)o(e)13 b(op)q(erations)249
1628 y Ft(\017)29 b FA(Pro)q(cess)16 b(groups)249 1682
y Ft(\017)29 b FA(Comm)o(uni)o(cation)11 b(domains)249
1736 y Ft(\017)29 b FA(Pro)q(cess)16 b(top)q(ologies)249
1790 y Ft(\017)29 b FA(En)o(vironmen)o(tal)12 b(Managemen)o(t)h(and)g
(inquiry)249 1844 y Ft(\017)29 b FA(Pro\014ling)13 b(in)o(terface)249
1898 y Ft(\017)29 b FA(Bindings)13 b(for)h(F)m(ortran)g(77)f(and)h(C)
249 2018 y FD(1.5)52 b(What)18 b(is)g(Not)g(Included)g(in)g
Fw(MPI)p FD(?)249 2126 y Fw(MPI)13 b FA(do)q(es)i(not)f(sp)q(ecify:)249
2209 y Ft(\017)29 b FA(Explicit)13 b(shared-memory)f(op)q(erations)249
2263 y Ft(\017)29 b FA(Op)q(erations)14 b(that)f(require)h(more)f(op)q
(erating)g(system)g(supp)q(ort)h(than)f(w)o(as)h(standard)f(dur-)249
2317 y(ing)h(the)h(adoption)f(of)f Fw(MPI)p FA(;)h(for)g(example,)f(in)
o(terrupt-driv)o(en)i(receiv)o(es,)h(remote)e(execution,)249
2371 y(or)g(activ)o(e)g(messages)249 2425 y Ft(\017)29
b FA(Program)12 b(construction)j(to)q(ols)249 2479 y
Ft(\017)29 b FA(Debugging)13 b(facilities)p eop
%%Page: 6 20
6 19 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(6)1294 b(Chapter)13 b(1)249 507
y Ft(\017)29 b FA(Explicit)13 b(supp)q(ort)i(for)e(threads)249
561 y Ft(\017)29 b FA(Supp)q(ort)14 b(for)g(task)g(managemen)o(t)249
615 y Ft(\017)29 b FA(I/O)14 b(functions)291 698 y(There)19
b(are)g(man)o(y)e(features)j(that)e(w)o(ere)i(considered)g(and)e(not)g
(included)h(in)f Fw(MPI)p FA(.)g(This)249 752 y(happ)q(ened)g(for)e(a)h
(n)o(um)o(b)q(er)f(of)g(reasons:)25 b(the)17 b(time)f(constrain)o(t)h
(that)f(w)o(as)h(self-imp)q(osed)f(b)o(y)249 806 y(the)h
Fw(MPI)f FA(F)m(orum)f(in)h(\014nishing)g(the)h(standard;)h(the)f
(feeling)f(that)h(not)g(enough)f(exp)q(erience)249 860
y(w)o(as)j(a)o(v)n(ailable)e(on)i(some)f(of)g(these)j(topics;)g(and)e
(the)h(concern)g(that)f(additional)e(features)249 914
y(w)o(ould)c(dela)o(y)h(the)g(app)q(earance)h(of)e(implemen)o(tations.)
291 968 y(F)m(eatures)18 b(that)g(are)h(not)e(included)h(can)g(alw)o(a)
o(ys)f(b)q(e)i(o\013ered)g(as)e(extensions)i(b)o(y)f(sp)q(eci\014c)249
1022 y(implemen)o(tations.)31 b(F)m(uture)19 b(v)o(ersions)h(of)f
Fw(MPI)f FA(will)g(address)i(some)f(of)f(these)j(issues)f(\(see)249
1076 y(Section)14 b(9.5\).)249 1196 y FD(1.6)52 b(V)l(ersion)17
b(of)g Fw(MPI)249 1304 y FA(The)h(original)e Fw(MPI)h
FA(standard)h(w)o(as)f(created)i(b)o(y)e(the)h(Message)h(P)o(assing)f
(In)o(terface)g(F)m(orum)249 1358 y(\(MPIF\).)g(The)g(public)g(release)
h(of)e(v)o(ersion)h(1.0)f(of)g(MPI)h(w)o(as)g(made)f(in)g(June)i(1994.)
29 b(The)249 1412 y(MPIF)15 b(b)q(egan)g(meeting)f(again)f(in)i(Marc)o
(h)g(1995.)k(One)d(of)e(the)h(\014rst)h(tasks)f(undertak)o(en)h(w)o(as)
249 1466 y(to)k(mak)o(e)e(clari\014cations)i(and)g(corrections)h(to)f
(the)g Fw(MPI)g FA(standard.)36 b(The)21 b(c)o(hanges)f(from)249
1520 y(v)o(ersion)d(1.0)e(to)h(v)o(ersion)h(1.1)e(of)h(the)h
Fw(MPI)f FA(standard)g(w)o(ere)i(limited)c(to)i(\\corrections")h(that)
249 1574 y(w)o(ere)i(deemed)f(urgen)o(t)g(and)g(necessary)m(.)31
b(This)17 b(w)o(ork)h(w)o(as)g(completed)f(in)g(June)i(1995)e(and)249
1628 y(v)o(ersion)g(1.1)f(of)g(the)i(standard)f(w)o(as)g(released.)28
b(This)17 b(b)q(o)q(ok)f(re\015ects)j(the)f(up)q(dated)f(v)o(ersion)249
1682 y(1.1)c(of)g(the)i Fw(MPI)e FA(standard.)249 1802
y FD(1.7)52 b Fw(MPI)17 b FD(Con)o(v)o(en)o(tions)f(and)i(Design)g
(Choices)249 1910 y FA(This)13 b(section)g(explains)g(notational)e
(terms)h(and)h(con)o(v)o(en)o(tions)g(used)h(throughout)e(this)h(b)q(o)
q(ok.)249 1993 y Fs(1.7.1)48 b(Do)q(cumen)o(t)14 b(Notation)249
2076 y FB(R)n(ationale.)52 b FA(Throughout)16 b(this)h(do)q(cumen)o(t,)
f(the)h(rationale)f(for)g(design)g(c)o(hoices)i(made)d(in)249
2130 y(the)g(in)o(terface)g(sp)q(eci\014cation)g(is)g(set)g(o\013)g(in)
f(this)g(format.)k(Some)13 b(readers)j(ma)o(y)d(wish)h(to)h(skip)249
2184 y(these)h(sections,)f(while)g(readers)h(in)o(terested)g(in)e(in)o
(terface)h(design)g(ma)o(y)e(w)o(an)o(t)h(to)g(read)h(them)249
2238 y(carefully)m(.)i(\()p FB(End)f(of)f(r)n(ationale.)p
FA(\))249 2330 y FB(A)n(dvic)n(e)i(to)h(users.)54 b FA(Throughout)17
b(this)g(do)q(cumen)o(t,)f(material)f(that)i(sp)q(eaks)h(to)e(users)j
(and)249 2384 y(illustrates)g(usage)g(is)f(set)h(o\013)g(in)f(this)h
(format.)30 b(Some)17 b(readers)j(ma)o(y)d(wish)h(to)h(skip)f(these)249
2438 y(sections,)e(while)f(readers)i(in)o(terested)g(in)e(programmi)o
(ng)e(in)h Fw(MPI)h FA(ma)o(y)e(w)o(an)o(t)i(to)g(read)h(them)249
2492 y(carefully)m(.)h(\()p FB(End)f(of)f(advic)n(e)g(to)g(users.)p
FA(\))p eop
%%Page: 7 21
7 20 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(In)o(tro)q(duction)1267 b(7)249
507 y FB(A)n(dvic)n(e)17 b(to)h(implementors.)54 b FA(Throughout)16
b(this)h(do)q(cumen)o(t,)g(material)e(that)h(is)h(primarily)249
561 y(commen)o(tary)d(to)h(implemen)o(tors)e(is)j(set)g(o\013)g(in)f
(this)h(format.)22 b(Some)14 b(readers)j(ma)o(y)d(wish)i(to)249
615 y(skip)f(these)i(sections,)f(while)f(readers)h(in)o(terested)h(in)e
Fw(MPI)f FA(implemen)o(tations)f(ma)o(y)g(w)o(an)o(t)i(to)249
669 y(read)f(them)g(carefully)m(.)j(\()p FB(End)e(of)g(advic)n(e)g(to)g
(implementors.)p FA(\))249 760 y Fs(1.7.2)48 b(Pro)q(cedure)14
b(Sp)q(eci\014cation)249 843 y Fw(MPI)j FA(pro)q(cedures)j(are)e(sp)q
(eci\014ed)i(using)d(a)h(language)f(indep)q(enden)o(t)i(notation.)29
b(The)18 b(argu-)249 897 y(men)o(ts)13 b(of)f(pro)q(cedure)k(calls)d
(are)g(mark)o(ed)f(as)i Fv(IN)p FA(,)e Fv(OUT)h FA(or)g
Fv(INOUT)p FA(.)f(The)h(meanings)f(of)h(these)249 951
y(are:)249 1034 y Ft(\017)29 b FA(the)14 b(call)f(uses)j(but)e(do)q(es)
g(not)g(up)q(date)h(an)e(argumen)o(t)g(mark)o(ed)g Fv(IN)p
FA(,)249 1088 y Ft(\017)29 b FA(the)14 b(call)f(ma)o(y)f(up)q(date)j
(an)f(argumen)o(t)e(mark)o(ed)h Fv(OUT)p FA(,)249 1142
y Ft(\017)29 b FA(the)14 b(call)f(b)q(oth)h(uses)i(and)d(up)q(dates)i
(an)f(argumen)o(t)f(mark)o(ed)f Fv(INOUT)p FA(.)291 1225
y(There)20 b(is)f(one)h(sp)q(ecial)g(case)g(|)f(if)g(an)g(argumen)o(t)f
(is)h(a)g(handle)h(to)f(an)g(opaque)h(ob)r(ject)249 1279
y(\(de\014ned)13 b(in)e(Section)h(1.8.3\),)f(and)g(the)h(ob)r(ject)h
(is)f(up)q(dated)g(b)o(y)g(the)g(pro)q(cedure)h(call,)e(then)i(the)249
1333 y(argumen)o(t)e(is)g(mark)o(ed)f Fv(OUT)p FA(.)h(It)g(is)h(mark)o
(ed)e(this)i(w)o(a)o(y)f(ev)o(en)h(though)f(the)h(handle)g(itself)f(is)
h(not)249 1387 y(mo)q(di\014ed)g(|)g(w)o(e)h(use)h(the)g
Fv(OUT)e FA(attribute)h(to)g(denote)h(that)f(what)g(the)h(handle)e
FB(r)n(efer)n(enc)n(es)h FA(is)249 1441 y(up)q(dated.)291
1495 y(The)18 b(de\014nition)f(of)g Fw(MPI)g FA(tries)i(to)e(a)o(v)o
(oid,)g(to)h(the)g(largest)g(p)q(ossible)g(exten)o(t,)h(the)f(use)h(of)
249 1549 y Fv(INOUT)11 b FA(argumen)o(ts,)g(b)q(ecause)i(suc)o(h)g(use)
g(is)e(error-prone,)i(esp)q(ecially)f(for)g(scalar)g(argumen)o(ts.)291
1603 y(A)17 b(common)d(o)q(ccurrence)19 b(for)e Fw(MPI)f
FA(functions)h(is)f(an)h(argumen)o(t)f(that)h(is)f(used)i(as)f
Fv(IN)g FA(b)o(y)249 1657 y(some)f(pro)q(cesses)j(and)d
Fv(OUT)g FA(b)o(y)h(other)g(pro)q(cesses.)29 b(Suc)o(h)17
b(an)f(argumen)o(t)f(is,)i(syn)o(tactically)m(,)249 1711
y(an)e Fv(INOUT)f FA(argumen)o(t)f(and)i(is)g(mark)o(ed)e(as)i(suc)o
(h,)h(although,)d(seman)o(tically)m(,)g(it)h(is)h(not)g(used)249
1765 y(in)e(one)i(call)e(b)q(oth)h(for)f(input)h(and)g(for)f(output.)
291 1819 y(Another)k(frequen)o(t)g(situation)f(arises)h(when)g(an)g
(argumen)o(t)e(v)n(alue)h(is)h(needed)h(only)d(b)o(y)i(a)249
1873 y(subset)f(of)d(the)i(pro)q(cesses.)22 b(When)15
b(an)f(argumen)o(t)f(is)h(not)h(signi\014can)o(t)e(at)i(a)f(pro)q(cess)
i(then)f(an)249 1927 y(arbitrary)f(v)n(alue)f(can)h(b)q(e)h(passed)g
(as)f(the)g(argumen)o(t.)291 1981 y(Unless)20 b(sp)q(eci\014ed)h
(otherwise,)h(an)d(argumen)o(t)g(of)g(t)o(yp)q(e)h Fv(OUT)f
FA(or)g(t)o(yp)q(e)i Fv(INOUT)d FA(cannot)249 2035 y(b)q(e)f(aliased)e
(with)h(an)o(y)g(other)g(argumen)o(t)f(passed)i(to)f(an)g
Fw(MPI)g FA(pro)q(cedure.)26 b(An)16 b(example)f(of)249
2089 y(argumen)o(t)e(aliasing)f(in)h(C)h(app)q(ears)h(b)q(elo)o(w.)j
(If)13 b(w)o(e)h(de\014ne)h(a)f(C)g(pro)q(cedure)h(lik)o(e)f(this,)249
2174 y Fr(void)21 b(copyIntBuffer\()e(int)i(*pin,)g(int)g(*pout,)g(int)
g(len)g(\))249 2228 y({)65 b(int)21 b(i;)336 2282 y(for)g(\(i=0;)g
(i<len;)g(++i\))g(*pout++)f(=)i(*pin++;)249 2336 y(})249
2422 y FA(then)15 b(a)e(call)g(to)h(it)g(in)f(the)h(follo)o(wing)e(co)q
(de)i(fragmen)o(t)f(has)h(aliased)f(argumen)o(ts.)249
2508 y Fr(int)21 b(a[10];)p eop
%%Page: 8 22
8 21 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(8)1294 b(Chapter)13 b(1)249 507
y Fr(copyIntBuffer\()19 b(a,)i(a+3,)g(7\);)249 594 y
FA(Although)c(the)h(C)f(language)f(allo)o(ws)g(this,)i(suc)o(h)g(usage)
g(of)e Fw(MPI)h FA(pro)q(cedures)i(is)f(forbidden)249
648 y(unless)d(otherwise)g(sp)q(eci\014ed.)k(Note)14
b(that)g(F)m(ortran)g(prohibits)g(aliasing)e(of)h(argumen)o(ts.)291
702 y(All)h Fw(MPI)h FA(functions)h(are)g(\014rst)h(sp)q(eci\014ed)g
(in)e(the)h(language-indep)q(enden)o(t)g(notation.)23
b(Im-)249 756 y(mediately)11 b(b)q(elo)o(w)i(this,)g(the)g(ANSI)g(C)g
(v)o(ersion)g(of)f(the)i(function)e(is)h(sho)o(wn,)g(and)f(b)q(elo)o(w)
h(this,)249 810 y(a)h(v)o(ersion)g(of)f(the)h(same)f(function)h(in)f(F)
m(ortran)h(77.)249 931 y FD(1.8)52 b(Seman)o(tic)18 b(T)l(erms)249
1039 y FA(This)c(section)g(describ)q(es)i(seman)o(tic)d(terms)h(used)h
(in)e(this)h(b)q(o)q(ok.)249 1122 y Fs(1.8.1)48 b(Pro)q(cesses)249
1205 y FA(An)13 b Fw(MPI)g FA(program)e(consists)j(of)f(autonomous)e
(pro)q(cesses,)16 b(executing)e(their)f(o)o(wn)g(\(C)g(or)g(F)m(or-)249
1259 y(tran\))k(co)q(de,)h(in)e(an)h(MIMD)f(st)o(yle.)27
b(The)17 b(co)q(des)h(executed)h(b)o(y)e(eac)o(h)g(pro)q(cess)h(need)g
(not)f(b)q(e)249 1313 y(iden)o(tical.)k(The)15 b(pro)q(cesses)j(comm)o
(unicate)13 b(via)h(calls)h(to)g Fw(MPI)f FA(comm)o(unication)e
(primitiv)o(es.)249 1367 y(T)o(ypically)m(,)e(eac)o(h)j(pro)q(cess)h
(executes)h(in)d(its)g(o)o(wn)g(address)h(space,)h(although)d
(shared-memory)249 1421 y(implemen)o(tations)k(of)i Fw(MPI)f
FA(are)j(p)q(ossible.)29 b(This)17 b(do)q(cumen)o(t)h(sp)q(eci\014es)h
(the)f(b)q(eha)o(vior)g(of)f(a)249 1474 y(parallel)e(program)g
(assuming)g(that)i(only)e Fw(MPI)h FA(calls)g(are)h(used)h(for)e(comm)o
(unicati)o(on.)23 b(The)249 1528 y(in)o(teraction)15
b(of)g(an)f Fw(MPI)h FA(program)e(with)i(other)h(p)q(ossible)f(means)f
(of)h(comm)o(unicatio)o(n)e(\(e.g.,)249 1582 y(shared)i(memory\))c(is)j
(not)g(sp)q(eci\014ed.)291 1636 y Fw(MPI)i FA(do)q(es)i(not)g(sp)q
(ecify)g(the)g(execution)g(mo)q(del)e(for)h(eac)o(h)h(pro)q(cess.)30
b(A)18 b(pro)q(cess)h(can)f(b)q(e)249 1690 y(sequen)o(tial,)13
b(or)f(can)h(b)q(e)g(m)o(ulti-threaded,)e(with)i(threads)g(p)q(ossibly)
g(executing)g(concurren)o(tly)m(.)249 1744 y(Care)18
b(has)f(b)q(een)h(tak)o(en)g(to)f(mak)o(e)f Fw(MPI)g
FA(\\thread-safe,")i(b)o(y)f(a)o(v)o(oiding)e(the)j(use)g(of)f
(implicit)249 1798 y(state.)26 b(The)17 b(desired)h(in)o(teraction)e
(of)g Fw(MPI)f FA(with)h(threads)i(is)e(that)g(concurren)o(t)i(threads)
g(b)q(e)249 1852 y(all)13 b(allo)o(w)o(ed)f(to)i(execute)i
Fw(MPI)d FA(calls,)g(and)h(calls)f(b)q(e)i(reen)o(tran)o(t;)g(a)e(blo)q
(c)o(king)g Fw(MPI)g FA(call)g(blo)q(c)o(ks)249 1906
y(only)g(the)i(in)o(v)o(oking)d(thread,)i(allo)o(wing)d(the)k(sc)o
(heduling)f(of)f(another)h(thread.)291 1960 y Fw(MPI)e
FA(do)q(es)h(not)g(pro)o(vide)f(mec)o(hanisms)f(to)i(sp)q(ecify)g(the)g
(initial)e(allo)q(cation)g(of)h(pro)q(cesses)k(to)249
2014 y(an)f Fw(MPI)f FA(computation)g(and)g(their)i(binding)e(to)h(ph)o
(ysical)f(pro)q(cessors.)24 b(It)15 b(is)g(exp)q(ected)i(that)249
2068 y(v)o(endors)e(will)d(pro)o(vide)h(mec)o(hanisms)f(to)i(do)f(so)h
(either)h(at)f(load)e(time)h(or)h(at)f(run)h(time.)j(Suc)o(h)249
2122 y(mec)o(hanisms)11 b(will)h(allo)o(w)g(the)i(sp)q(eci\014cation)g
(of)e(the)i(initial)e(n)o(um)o(b)q(er)g(of)h(required)h(pro)q(cesses,)
249 2176 y(the)20 b(co)q(de)f(to)g(b)q(e)g(executed)i(b)o(y)e(eac)o(h)g
(initial)e(pro)q(cess,)k(and)e(the)g(allo)q(cation)f(of)g(pro)q(cesses)
249 2230 y(to)f(pro)q(cessors.)30 b(Also,)18 b(the)f(curren)o(t)i
(standard)f(do)q(es)g(not)f(pro)o(vide)g(for)g(dynamic)e(creation)249
2284 y(or)h(deletion)g(of)g(pro)q(cesses)j(during)d(program)e
(execution)j(\(the)g(total)f(n)o(um)o(b)q(er)f(of)h(pro)q(cesses)249
2338 y(is)h(\014xed\);)i(ho)o(w)o(ev)o(er,)f Fw(MPI)f
FA(design)g(is)g(consisten)o(t)i(with)d(suc)o(h)i(extensions,)h(whic)o
(h)e(are)h(no)o(w)249 2392 y(under)e(consideration)g(\(see)g(Section)g
(9.5\).)22 b(Finally)m(,)13 b Fw(MPI)h FA(alw)o(a)o(ys)h(iden)o
(ti\014es)g(pro)q(cesses)j(ac-)249 2446 y(cording)c(to)g(their)h
(relativ)o(e)f(rank)g(in)g(a)g(group,)g(that)g(is,)g(consecutiv)o(e)h
(in)o(tegers)h(in)d(the)i(range)249 2500 y Fr(0..groupsize-1)p
FA(.)p eop
%%Page: 9 23
9 22 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(In)o(tro)q(duction)1267 b(9)249
507 y Fs(1.8.2)48 b(T)o(yp)q(es)15 b(of)h Fw(MPI)f Fs(Calls)249
590 y FA(When)f(discussing)h Fw(MPI)e FA(pro)q(cedures)j(the)e(follo)o
(wing)e(terms)h(are)i(used.)249 682 y Fs(lo)q(cal)20
b FA(If)14 b(the)g(completion)f(of)g(the)i(pro)q(cedure)h(dep)q(ends)g
(only)d(on)h(the)g(lo)q(cal)g(executing)h(pro-)249 736
y(cess.)24 b(Suc)o(h)15 b(an)g(op)q(eration)g(do)q(es)h(not)f(require)i
(an)e(explicit)f(comm)o(unication)e(with)j(another)249
790 y(user)20 b(pro)q(cess.)35 b Fw(MPI)19 b FA(calls)f(that)h
(generate)i(lo)q(cal)d(ob)r(jects)i(or)f(query)g(the)h(status)g(of)e
(lo)q(cal)249 844 y(ob)r(jects)d(are)f(lo)q(cal.)249
914 y Fs(non-lo)q(cal)19 b FA(If)14 b(completion)f(of)h(the)h(pro)q
(cedure)h(ma)o(y)d(require)i(the)g(execution)h(of)d(some)h
Fw(MPI)249 968 y FA(pro)q(cedure)i(on)e(another)g(pro)q(cess.)20
b(Man)o(y)13 b Fw(MPI)g FA(comm)o(unication)e(calls)i(are)i(non-lo)q
(cal.)249 1039 y Fs(blo)q(c)o(king)k FA(If)c(return)j(from)c(the)j(pro)
q(cedure)h(indicates)e(the)h(user)g(is)f(allo)o(w)o(ed)f(to)h(re-use)i
(re-)249 1093 y(sources)f(sp)q(eci\014ed)f(in)e(the)i(call.)j(An)o(y)c
(visible)f(c)o(hange)h(in)g(the)g(state)h(of)e(the)h(calling)f(pro)q
(cess)249 1147 y(a\013ected)h(b)o(y)f(a)g(blo)q(c)o(king)f(call)g(o)q
(ccurs)i(b)q(efore)g(the)f(call)f(returns.)249 1217 y
Fs(non)o(blo)q(c)o(kin)o(g)18 b FA(If)f(the)i(pro)q(cedure)g(ma)o(y)d
(return)j(b)q(efore)g(the)f(op)q(eration)f(initiated)g(b)o(y)h(the)249
1271 y(call)c(completes,)h(and)f(b)q(efore)i(the)f(user)h(is)f(allo)o
(w)o(ed)f(to)h(re-use)h(resources)h(\(suc)o(h)f(as)f(bu\013ers\))249
1325 y(sp)q(eci\014ed)k(in)d(the)i(call.)26 b(A)18 b(non)o(blo)q(c)o
(king)d(call)h(ma)o(y)g(initiate)g(c)o(hanges)h(in)g(the)h(state)f(of)g
(the)249 1379 y(calling)c(pro)q(cess)k(that)e(actually)e(tak)o(e)i
(place)g(after)g(the)g(call)f(returned:)21 b(e.g.)f(a)15
b(non)o(blo)q(c)o(king)249 1433 y(call)f(can)h(initiate)e(a)i(receiv)o
(e)h(op)q(eration,)e(but)g(the)i(message)e(is)g(actually)g(receiv)o(ed)
i(after)f(the)249 1487 y(call)e(returned.)249 1558 y
Fs(collectiv)o(e)18 b FA(If)c(all)e(pro)q(cesses)17 b(in)c(a)h(pro)q
(cess)i(group)d(need)i(to)f(in)o(v)o(ok)o(e)f(the)h(pro)q(cedure.)249
1649 y Fs(1.8.3)48 b(Opaque)15 b(Ob)s(jects)249 1732
y Fw(MPI)h FA(manages)f(system)h(memory)e(that)i(is)h(used)g(for)f
(bu\013ering)h(messages)f(and)h(for)f(storing)249 1786
y(in)o(ternal)k(represen)o(tations)i(of)d(v)n(arious)h
Fw(MPI)f FA(ob)r(jects)j(suc)o(h)f(as)f(groups,)h(comm)o(unicators,)249
1840 y(datat)o(yp)q(es,)f(etc.)33 b(This)19 b(memory)d(is)j(not)f
(directly)h(accessible)h(to)f(the)g(user,)i(and)d(ob)r(jects)249
1894 y(stored)f(there)g(are)f Fs(opaque)p FA(:)21 b(their)16
b(size)h(and)e(shap)q(e)i(is)e(not)h(visible)f(to)h(the)g(user.)25
b(Opaque)249 1948 y(ob)r(jects)15 b(are)g(accessed)h(via)d
Fs(handles)p FA(,)e(whic)o(h)j(exist)g(in)28 b(user)15
b(space.)k Fw(MPI)13 b FA(pro)q(cedures)j(that)249 2002
y(op)q(erate)j(on)f(opaque)g(ob)r(jects)i(are)e(passed)i(handle)e
(argumen)o(ts)f(to)h(access)i(these)g(ob)r(jects.)249
2056 y(In)c(addition)e(to)i(their)g(use)g(b)o(y)f Fw(MPI)g
FA(calls)g(for)h(ob)r(ject)g(access,)i(handles)d(can)h(participate)g
(in)249 2110 y(assignmen)o(ts)d(and)h(comparisons.)291
2164 y(In)i(F)m(ortran,)g(all)f(handles)i(ha)o(v)o(e)f(t)o(yp)q(e)h
Fr(INTEGER)p FA(.)d(In)i(C,)g(a)g(di\013eren)o(t)h(handle)f(t)o(yp)q(e)
h(is)f(de-)249 2218 y(\014ned)f(for)f(eac)o(h)g(category)h(of)f(ob)r
(jects.)20 b(Implemen)o(tations)11 b(should)j(use)h(t)o(yp)q(es)g(that)
g(supp)q(ort)249 2271 y(assignmen)o(t)e(and)h(equalit)o(y)f(op)q
(erators.)291 2325 y(In)h(F)m(ortran,)h(the)g(handle)g(can)g(b)q(e)g
(an)g(index)g(in)f(a)g(table)h(of)f(opaque)h(ob)r(jects,)h(while)e(in)g
(C)249 2379 y(it)g(can)g(b)q(e)g(suc)o(h)h(an)e(index)h(or)g(a)f(p)q
(oin)o(ter)h(to)g(the)h(ob)r(ject.)j(More)d(bizarre)f(p)q(ossibilities)
g(exist.)291 2433 y(Opaque)i(ob)r(jects)i(are)f(allo)q(cated)e(and)i
(deallo)q(cated)f(b)o(y)g(calls)g(that)g(are)h(sp)q(eci\014c)h(to)e
(eac)o(h)249 2487 y(ob)r(ject)f(t)o(yp)q(e.)21 b(These)15
b(are)g(listed)g(in)f(the)h(sections)g(where)h(the)f(ob)r(jects)h(are)e
(describ)q(ed.)22 b(The)p eop
%%Page: 10 24
10 23 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(10)1275 b(Chapter)13 b(1)249 507
y FA(calls)f(accept)h(a)f(handle)g(argumen)o(t)f(of)h(matc)o(hing)e(t)o
(yp)q(e.)18 b(In)12 b(an)g(allo)q(cate)g(call)f(this)h(is)g(an)g
Fv(OUT)249 561 y FA(argumen)o(t)i(that)i(returns)h(a)e(v)n(alid)f
(reference)k(to)e(the)g(ob)r(ject.)24 b(In)15 b(a)h(call)e(to)i(deallo)
q(cate)f(this)249 615 y(is)g(an)g Fv(INOUT)g FA(argumen)o(t)f(whic)o(h)
h(returns)i(with)e(a)g(\\n)o(ull)f(handle")h(v)n(alue.)22
b Fw(MPI)14 b FA(pro)o(vides)i(a)249 669 y(\\n)o(ull)11
b(handle")h(constan)o(t)h(for)e(eac)o(h)i(ob)r(ject)g(t)o(yp)q(e.)18
b(Comparisons)11 b(to)h(this)g(constan)o(t)h(are)g(used)249
723 y(to)k(test)i(for)e(v)n(alidit)o(y)e(of)i(the)g(handle.)29
b Fw(MPI)16 b FA(calls)h(do)g(not)h(c)o(hange)f(the)h(v)n(alue)f(of)g
(handles,)249 777 y(with)i(the)g(exception)h(of)f(calls)f(that)i(allo)q
(cate)e(and)h(deallo)q(cate)g(ob)r(jects,)i(and)e(of)g(the)g(call)249
831 y Fw(MPI)p 326 831 13 2 v 14 w(TYPE)p 448 831 V 15
w(COMMIT)p FA(,)12 b(de\014ned)j(in)f(Section)g(3.4.)291
885 y(A)19 b(n)o(ull)f(handle)h(argumen)o(t)f(is)h(an)g(erroneous)i
Fv(IN)e FA(argumen)o(t)f(in)g Fw(MPI)h FA(calls,)h(unless)g(an)249
939 y(exception)14 b(is)f(explicitly)f(stated)i(in)f(the)g(text)h(that)
f(de\014nes)i(the)e(function.)18 b(Suc)o(h)13 b(exceptions)249
993 y(are)20 b(allo)o(w)o(ed)e(for)h(handles)g(to)g(request)i(ob)r
(jects)g(in)d(W)m(ait)g(and)h(T)m(est)h(calls)f(\(Section)h(2.9\).)249
1047 y(Otherwise,)h(a)d(n)o(ull)g(handle)g(can)h(only)f(b)q(e)h(passed)
h(to)e(a)g(function)h(that)f(allo)q(cates)h(a)f(new)249
1101 y(ob)r(ject)d(and)e(returns)j(a)e(reference)i(to)e(it)f(in)h(the)g
(handle.)291 1155 y(A)e(call)f(to)i(deallo)q(cate)f(in)o(v)n(alidates)f
(the)i(handle)f(and)g(marks)f(the)i(ob)r(ject)g(for)f(deallo)q(cation.)
249 1209 y(The)20 b(ob)r(ject)f(is)g(not)g(accessible)i(to)e(the)h
(user)g(after)f(the)h(call.)33 b(Ho)o(w)o(ev)o(er,)20
b Fw(MPI)e FA(need)j(not)249 1263 y(deallo)q(cate)f(the)h(ob)r(ject)g
(immediately)l(.)34 b(An)o(y)21 b(op)q(eration)f(p)q(ending)g(\(at)g
(the)h(time)e(of)h(the)249 1317 y(deallo)q(cate\))g(that)h(in)o(v)o
(olv)o(es)e(this)h(ob)r(ject)h(will)e(complete)h(normally;)g(the)h(ob)r
(ject)g(will)e(b)q(e)249 1371 y(deallo)q(cated)14 b(afterw)o(ards.)291
1425 y(An)j(opaque)g(ob)r(ject)h(and)f(its)g(handle)g(are)h
(signi\014can)o(t)e(only)h(at)g(the)h(pro)q(cess)g(where)h(the)249
1479 y(ob)r(ject)c(w)o(as)f(created,)g(and)g(cannot)g(b)q(e)h
(transferred)g(to)f(another)g(pro)q(cess.)291 1533 y
Fw(MPI)d FA(pro)o(vides)i(certain)g(prede\014ned)h(opaque)e(ob)r(jects)
h(and)f(prede\014ned,)i(static)f(handles)g(to)249 1587
y(these)i(ob)r(jects.)20 b(Suc)o(h)14 b(ob)r(jects)h(ma)o(y)d(not)i(b)q
(e)g(destro)o(y)o(ed.)249 1674 y FB(R)n(ationale.)38
b FA(This)14 b(design)h(hides)f(the)h(in)o(ternal)f(represen)o(tation)h
(used)g(for)f Fw(MPI)g FA(data)f(struc-)249 1728 y(tures,)h(th)o(us)f
(allo)o(wing)e(similar)g(calls)h(in)h(C)g(and)f(F)m(ortran.)18
b(It)13 b(also)f(a)o(v)o(oids)g(con\015icts)i(with)f(the)249
1782 y(t)o(yping)f(rules)h(in)e(these)j(languages,)e(and)g(easily)g
(allo)o(ws)f(future)i(extensions)g(of)f(functionalit)o(y)m(.)249
1836 y(The)18 b(mec)o(hanism)d(for)i(opaque)g(ob)r(jects)i(used)f(here)
h(lo)q(osely)e(follo)o(ws)e(the)k(POSIX)f(F)m(ortran)249
1890 y(binding)13 b(standard.)249 1956 y(The)h(explicit)e(separation)h
(of)g(user)h(space)g(handles)g(and)f(\\)p Fw(MPI)f FA(space")i(ob)r
(jects)g(allo)o(ws)e(deal-)249 2010 y(lo)q(cation)h(calls)g(to)g(b)q(e)
h(made)f(at)g(appropriate)h(p)q(oin)o(ts)f(in)g(the)h(user)h(program.)h
(If)d(the)h(opaque)249 2064 y(ob)r(jects)f(w)o(ere)h(in)d(user)j
(space,)f(one)f(w)o(ould)g(ha)o(v)o(e)g(to)g(b)q(e)h(v)o(ery)f(careful)
h(not)f(to)g(go)f(out)i(of)e(scop)q(e)249 2118 y(b)q(efore)h(an)o(y)f
(p)q(ending)g(op)q(eration)g(requiring)g(that)g(ob)r(ject)h(completed.)
17 b(The)11 b(sp)q(eci\014ed)i(design)249 2172 y(allo)o(ws)h(an)g(ob)r
(ject)i(to)f(b)q(e)g(mark)o(ed)f(for)g(deallo)q(cation,)g(the)h(user)h
(program)e(can)h(then)g(go)g(out)249 2226 y(of)e(scop)q(e,)i(and)f(the)
g(ob)r(ject)h(itself)e(p)q(ersists)j(un)o(til)d(an)o(y)g(p)q(ending)h
(op)q(erations)g(are)h(complete.)249 2292 y(The)h(requiremen)o(t)f
(that)g(handles)g(supp)q(ort)h(assignmen)o(t/comparison)c(is)j(made)f
(since)i(suc)o(h)249 2346 y(op)q(erations)10 b(are)g(common.)k(This)9
b(restricts)j(the)e(domain)e(of)h(p)q(ossible)h(implem)o(en)o(tations.)
k(The)249 2400 y(alternativ)o(e)9 b(w)o(ould)g(ha)o(v)o(e)g(b)q(een)i
(to)e(allo)o(w)f(handles)i(to)f(ha)o(v)o(e)h(b)q(een)g(an)g(arbitrary)m
(,)f(opaque)g(t)o(yp)q(e.)249 2454 y(This)18 b(w)o(ould)f(force)h(the)g
(in)o(tro)q(duction)g(of)f(routines)h(to)g(do)f(assignmen)o(t)g(and)g
(comparison,)249 2508 y(adding)c(complexit)o(y)m(,)e(and)j(w)o(as)g
(therefore)h(ruled)f(out.)k(\()p FB(End)e(of)f(r)n(ationale.)p
FA(\))p eop
%%Page: 11 25
11 24 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(In)o(tro)q(duction)1248 b(11)249
507 y FB(A)n(dvic)n(e)11 b(to)g(users.)34 b FA(A)9 b(user)i(ma)o(y)d
(acciden)o(tly)i(create)h(a)e(dangling)g(reference)j(b)o(y)d(assigning)
g(to)h(a)249 561 y(handle)g(the)h(v)n(alue)e(of)g(another)i(handle,)f
(and)g(then)h(deallo)q(cating)e(the)h(ob)r(ject)h(asso)q(ciated)g(with)
249 615 y(these)16 b(handles.)i(Con)o(v)o(ersely)m(,)c(if)f(a)h(handle)
f(v)n(ariable)g(is)h(deallo)q(cated)g(b)q(efore)h(the)g(asso)q(ciated)
249 669 y(ob)r(ject)g(is)e(freed,)i(then)f(the)h(ob)r(ject)f(b)q
(ecomes)g(inaccessible)h(\(this)f(ma)o(y)e(o)q(ccur,)j(for)e(example,)
249 723 y(if)i(the)i(handle)f(is)g(a)g(lo)q(cal)f(v)n(ariable)g(within)
g(a)h(subroutine,)h(and)f(the)g(subroutine)h(is)f(exited)249
777 y(b)q(efore)c(the)f(asso)q(ciated)g(ob)r(ject)h(is)f(deallo)q
(cated\).)17 b(It)11 b(is)f(the)h(user's)h(resp)q(onsibilit)o(y)e(to)h
(manage)249 831 y(correctly)k(suc)o(h)g(references.)21
b(\()p FB(End)15 b(of)g(advic)n(e)g(to)g(users.)p FA(\))249
922 y FB(A)n(dvic)n(e)i(to)f(implementors.)49 b FA(The)17
b(in)o(tended)f(seman)o(tics)g(of)f(opaque)h(ob)r(jects)h(is)f(that)g
(eac)o(h)249 976 y(opaque)10 b(ob)r(ject)h(is)f(separate)i(from)c(eac)o
(h)j(other;)h(eac)o(h)e(call)g(to)g(allo)q(cate)g(suc)o(h)h(an)f(ob)r
(ject)h(copies)249 1030 y(all)k(the)h(information)d(required)k(for)f
(the)g(ob)r(ject.)25 b(Implemen)o(tations)13 b(ma)o(y)h(a)o(v)o(oid)h
(excessiv)o(e)249 1084 y(cop)o(ying)g(b)o(y)g(substituting)h
(referencing)h(for)f(cop)o(ying.)22 b(F)m(or)15 b(example,)g(a)g(deriv)
o(ed)h(datat)o(yp)q(e)249 1138 y(ma)o(y)d(con)o(tain)h(references)k(to)
c(its)h(comp)q(onen)o(ts,)f(rather)i(then)f(copies)g(of)g(its)f(comp)q
(onen)o(ts;)h(a)249 1192 y(call)10 b(to)h Fw(MPI)p 447
1192 13 2 v 14 w(COMM)p 591 1192 V 15 w(GROUP)e FA(ma)o(y)g(return)j(a)
e(reference)k(to)c(the)i(group)f(asso)q(ciated)g(with)g(the)249
1246 y(comm)o(unicator,)e(rather)k(than)g(a)e(cop)o(y)i(of)e(this)h
(group.)18 b(In)12 b(suc)o(h)h(cases,)g(the)g(implemen)o(tatio)o(n)249
1300 y(m)o(ust)h(main)o(tain)d(reference)18 b(coun)o(ts,)c(and)h(allo)q
(cate)f(and)g(deallo)q(cate)h(ob)r(jects)h(suc)o(h)f(that)g(the)249
1354 y(visible)e(e\013ect)j(is)e(as)g(if)f(the)h(ob)r(jects)h(w)o(ere)g
(copied.)j(\()p FB(End)e(of)f(advic)n(e)g(to)g(implementors.)p
FA(\))249 1445 y Fs(1.8.4)48 b(Named)16 b(Constan)o(ts)249
1528 y Fw(MPI)e FA(pro)q(cedures)j(sometimes)c(assign)h(a)h(sp)q(ecial)
g(meaning)d(to)j(a)f(sp)q(ecial)h(v)n(alue)f(of)g(an)h(argu-)249
1582 y(men)o(t.)29 b(F)m(or)17 b(example,)g Fq(tag)h
FA(is)g(an)g(in)o(teger-v)n(alued)f(argumen)o(t)g(of)g(p)q(oin)o
(t-to-p)q(oin)o(t)f(comm)o(u-)249 1636 y(nication)h(op)q(erations,)g
(that)h(can)f(tak)o(e)g(a)g(sp)q(ecial)h(wild-card)e(v)n(alue,)h
Fq(MPI)p 1452 1636 12 2 v 13 w(ANY)p 1544 1636 V 13 w(T)m(A)o(G)p
FA(.)f(Suc)o(h)249 1690 y(argumen)o(ts)g(will)f(ha)o(v)o(e)h(a)h(range)
g(of)f(regular)g(v)n(alues,)h(whic)o(h)f(is)h(a)f(prop)q(er)h(subrange)
h(of)e(the)249 1744 y(range)g(of)f(v)n(alues)h(of)f(the)h(corresp)q
(onding)h(t)o(yp)q(e)f(of)f(the)i(v)n(ariable.)22 b(Sp)q(ecial)16
b(v)n(alues)g(\(suc)o(h)g(as)249 1798 y Fq(MPI)p 321
1798 V 13 w(ANY)p 413 1798 V 13 w(T)m(A)o(G)p FA(\))f(will)f(b)q(e)i
(outside)g(the)g(regular)g(range.)23 b(The)16 b(range)g(of)f(regular)h
(v)n(alues)f(can)249 1852 y(b)q(e)g(queried)f(using)g(en)o(vironmen)o
(tal)e(inquiry)h(functions)h(\(Chapter)h(7\).)291 1906
y Fw(MPI)8 b FA(also)h(pro)o(vides)g(prede\014ned)i(named)e(constan)o
(t)g(handles,)h(suc)o(h)g(as)g Fq(MPI)p 1466 1906 V 12
w(COMM)p 1599 1906 V 13 w(W)o(ORLD)p FA(,)249 1960 y(whic)o(h)17
b(is)g(a)g(handle)g(to)g(an)g(ob)r(ject)g(that)h(represen)o(ts)h(all)d
(pro)q(cesses)k(a)o(v)n(ailable)15 b(at)i(start-up)249
2014 y(time)c(and)g(allo)o(w)o(ed)g(to)h(comm)o(unicate)d(with)j(an)o
(y)f(of)g(them.)291 2068 y(All)d(named)g(constan)o(ts,)i(with)f(the)g
(exception)h(of)f Fq(MPI)p 1140 2068 V 12 w(BOTTOM)h
FA(in)e(F)m(ortran,)h(can)h(b)q(e)g(used)249 2122 y(in)i
(initialization)e(expressions)k(or)f(assignmen)o(ts.)k(These)d(constan)
o(ts)f(do)f(not)h(c)o(hange)g(v)n(alues)249 2176 y(during)e(execution.)
18 b(Opaque)13 b(ob)r(jects)h(accessed)i(b)o(y)c(constan)o(t)i(handles)
f(are)g(de\014ned)h(and)f(do)249 2230 y(not)g(c)o(hange)h(v)n(alue)e(b)
q(et)o(w)o(een)j Fw(MPI)e FA(initialization)d(\()p Fw(MPI)p
1147 2230 13 2 v 15 w(INIT\(\))j FA(call\))f(and)i Fw(MPI)e
FA(completion)249 2284 y(\()p Fw(MPI)p 342 2284 V 15
w(FINALIZE\(\))h FA(call\).)249 2367 y Fs(1.8.5)48 b(Choice)15
b(Argumen)o(ts)249 2450 y Fw(MPI)9 b FA(functions)h(sometimes)e(use)i
(argumen)o(ts)f(with)g(a)h(c)o(hoice)g(\(or)g(union\))f(data)g(t)o(yp)q
(e.)18 b(Distinct)249 2504 y(calls)12 b(to)f(the)i(same)e(routine)h(ma)
o(y)e(pass)j(b)o(y)e(reference)k(actual)d(argumen)o(ts)f(of)g
(di\013eren)o(t)i(t)o(yp)q(es.)p eop
%%Page: 12 26
12 25 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(12)1275 b(Chapter)13 b(1)249 507
y FA(The)f(mec)o(hanism)d(for)i(pro)o(viding)f(suc)o(h)j(argumen)o(ts)d
(will)g(di\013er)i(from)e(language)g(to)i(language.)249
561 y(F)m(or)h(F)m(ortran,)g(w)o(e)h(use)h Fp(<)p Fw(t)o(yp)q(e)p
Fp(>)g FA(to)f(represen)o(t)i(a)d(c)o(hoice)h(v)n(ariable,)f(for)g(C,)g
(w)o(e)h(use)h Fw(\(void)f(*\))p FA(.)249 682 y FD(1.9)52
b(Language)19 b(Binding)249 790 y FA(This)13 b(section)h(de\014nes)g
(the)g(rules)g(for)e Fw(MPI)h FA(language)f(binding)g(in)g(F)m(ortran)h
(77)g(and)g(ANSI)g(C.)249 844 y(De\014ned)i(here)g(are)f(v)n(arious)g
(ob)r(ject)g(represen)o(tations,)i(as)e(w)o(ell)f(as)h(the)h(naming)c
(con)o(v)o(en)o(tions)249 897 y(used)k(for)e(expressing)i(this)f
(standard.)291 951 y(It)e(is)g(exp)q(ected)j(that)e(an)o(y)f(F)m
(ortran)g(90)g(and)g(C++)h(implemen)o(tatio)o(ns)d(use)k(the)f(F)m
(ortran)f(77)249 1005 y(and)k(ANSI)h(C)f(bindings,)g(resp)q(ectiv)o
(ely)m(.)27 b(Although)16 b(w)o(e)g(consider)i(it)e(premature)g(to)g
(de\014ne)249 1059 y(other)h(bindings)f(to)h(F)m(ortran)f(90)g(and)h
(C++,)g(the)g(curren)o(t)h(bindings)e(are)h(designed)h(to)e(en-)249
1113 y(courage,)f(rather)g(than)g(discourage,)g(exp)q(erimen)o(tation)e
(with)i(b)q(etter)h(bindings)e(that)h(migh)o(t)249 1167
y(b)q(e)g(adopted)f(later.)291 1221 y(Since)g(the)g(w)o(ord)g(P)m
(ARAMETER)f(is)h(a)f(k)o(eyw)o(ord)h(in)f(the)h(F)m(ortran)g(language,)
e(w)o(e)i(use)h(the)249 1275 y(w)o(ord)j(\\argumen)o(t")e(to)h(denote)i
(the)f(argumen)o(ts)f(to)h(a)f(subroutine.)30 b(These)19
b(are)f(normally)249 1329 y(referred)g(to)e(as)h(parameters)f(in)g(C,)g
(ho)o(w)o(ev)o(er,)h(w)o(e)g(exp)q(ect)g(that)g(C)f(programmers)f(will)
g(un-)249 1383 y(derstand)f(the)f(w)o(ord)g(\\argumen)o(t")e(\(whic)o
(h)h(has)h(no)f(sp)q(eci\014c)i(meaning)d(in)h(C\),)h(th)o(us)g(allo)o
(wing)249 1437 y(us)h(to)g(a)o(v)o(oid)f(unnecessary)j(confusion)d(for)
h(F)m(ortran)f(programmers.)291 1491 y(There)i(are)f(sev)o(eral)g(imp)q
(ortan)o(t)e(language)h(binding)g(issues)i(not)f(addressed)i(b)o(y)d
(this)h(stan-)249 1545 y(dard.)26 b(This)16 b(standard)h(do)q(es)g(not)
f(discuss)i(the)f(in)o(terop)q(erabilit)o(y)f(of)g(message)g(passing)g
(b)q(e-)249 1599 y(t)o(w)o(een)11 b(languages.)16 b(It)10
b(is)g(fully)f(exp)q(ected)j(that)f(go)q(o)q(d)e(qualit)o(y)g(implemen)
o(tatio)o(ns)f(will)h(pro)o(vide)249 1653 y(suc)o(h)15
b(in)o(terop)q(erabilit)o(y)m(.)249 1736 y Fs(1.9.1)48
b(F)l(ortran)14 b(77)i(Binding)d(Issues)249 1819 y FA(All)i
Fw(MPI)h FA(names)f(ha)o(v)o(e)h(an)f Fr(MPI)p 765 1819
14 2 v 31 w FA(pre\014x,)i(and)f(all)f(c)o(haracters)j(are)e(upp)q(er)h
(case.)25 b(Programs)249 1873 y(should)11 b(not)h(declare)g(v)n
(ariables)f(or)h(functions)f(with)h(names)e(with)i(the)g(pre\014x,)g
Fr(MPI)p 1557 1873 V 27 w FA(or)f Fr(PMPI)p 1720 1873
V 15 w FA(,)249 1927 y(to)j(a)o(v)o(oid)e(p)q(ossible)i(name)f
(collisions.)291 1981 y(All)k Fw(MPI)g FA(F)m(ortran)h(subroutines)i
(ha)o(v)o(e)e(a)g(return)h(co)q(de)g(in)f(the)g(last)g(argumen)o(t.)30
b(A)18 b(few)249 2035 y Fw(MPI)d FA(op)q(erations)i(are)f(functions,)g
(whic)o(h)g(do)g(not)g(ha)o(v)o(e)g(the)h(return)g(co)q(de)g(argumen)o
(t.)23 b(The)249 2089 y(return)15 b(co)q(de)g(v)n(alue)e(for)g
(successful)j(completion)c(is)h Fq(MPI)p 1156 2089 12
2 v 13 w(SUCCESS)p FA(.)h(Other)g(error)h(co)q(des)g(are)249
2143 y(implemen)o(tation)10 b(dep)q(enden)o(t;)16 b(see)f(Chapter)f(7.)
291 2197 y(Handles)h(are)g(represen)o(ted)j(in)d(F)m(ortran)g(as)g
Fr(INTEGER)p FA(s.)20 b(Binary-v)n(alued)14 b(v)n(ariables)h(are)g(of)
249 2251 y(t)o(yp)q(e)f Fr(LOGICAL)p FA(.)291 2305 y(Arra)o(y)g
(argumen)o(ts)f(are)h(indexed)g(from)e(one.)291 2359
y(Unless)j(explicitly)f(stated,)i(the)f Fw(MPI)f FA(F77)h(binding)f(is)
g(consisten)o(t)i(with)f(ANSI)g(standard)249 2413 y(F)m(ortran)j(77.)29
b(There)18 b(are)g(sev)o(eral)h(p)q(oin)o(ts)e(where)i(the)f
Fw(MPI)f FA(standard)i(div)o(erges)f(from)e(the)249 2467
y(ANSI)e(F)m(ortran)f(77)g(standard.)18 b(These)d(exceptions)g(are)f
(consisten)o(t)h(with)e(common)d(practice)p eop
%%Page: 13 27
13 26 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(In)o(tro)q(duction)1248 b(13)445
533 y Fr(double)21 b(precision)f(a)445 587 y(integer)h(b)445
641 y(...)445 695 y(call)g(MPI_send\(a,...\))445 748
y(call)g(MPI_send\(b,...\))249 852 y Fo(Figure)13 b(1.1)249
890 y Fz(An)f(example)d(of)i(calling)f(a)h(routine)f(with)h(mismatc)o
(hed)e(formal)g(and)i(actual)f(argumen)o(ts.)249 1012
y FA(in)j(the)i(F)m(ortran)f(comm)o(unit)o(y)l(.)h(In)f(particular:)249
1095 y Ft(\017)29 b Fw(MPI)13 b FA(iden)o(ti\014ers)i(are)f(limited)e
(to)h(thirt)o(y)m(,)g(not)h(six,)f(signi\014can)o(t)h(c)o(haracters.)
249 1149 y Ft(\017)29 b Fw(MPI)13 b FA(iden)o(ti\014ers)i(ma)o(y)d(con)
o(tain)h(underscores)j(after)f(the)f(\014rst)h(c)o(haracter.)249
1203 y Ft(\017)29 b FA(An)10 b Fw(MPI)f FA(subroutine)h(with)g(a)f(c)o
(hoice)h(argumen)o(t)f(ma)o(y)f(b)q(e)i(called)f(with)h(di\013eren)o(t)
h(argumen)o(t)249 1257 y(t)o(yp)q(es.)23 b(An)15 b(example)f(is)h(sho)o
(wn)g(in)g(Figure)h(1.1.)21 b(This)15 b(violates)f(the)i(letter)g(of)f
(the)h(F)m(ortran)249 1311 y(standard,)c(but)f(suc)o(h)h(a)f(violation)
e(is)i(common)d(practice.)18 b(An)12 b(alternativ)o(e)f(w)o(ould)f(b)q
(e)i(to)f(ha)o(v)o(e)249 1365 y(a)j(separate)h(v)o(ersion)f(of)f
Fw(MPI)p 713 1365 13 2 v 14 w(SEND)h FA(for)g(eac)o(h)g(data)g(t)o(yp)q
(e.)249 1456 y FB(A)n(dvic)n(e)20 b(to)f(implementors.)68
b FA(Although)19 b(not)g(required,)i(it)e(is)g(strongly)g(suggested)h
(that)249 1510 y(named)15 b Fw(MPI)g FA(constan)o(ts)h(\()p
Fr(PARAMETER)p FA(s\))f(b)q(e)h(pro)o(vided)f(in)h(an)f(include)h
(\014le,)32 b(called)15 b Fw(mpif.h)p FA(.)249 1564 y(On)i(systems)h
(that)f(do)f(not)h(supp)q(ort)h(include)f(\014les,)h(the)g(implem)o(en)
o(tation)c(should)j(sp)q(ecify)249 1618 y(the)e(v)n(alues)e(of)g(named)
g(constan)o(ts.)249 1689 y(V)m(endors)j(are)f(encouraged)h(to)f(pro)o
(vide)g(t)o(yp)q(e)h(declarations)f(and)g(in)o(terface)g(blo)q(c)o(ks)g
(for)g Fw(MPI)249 1743 y FA(functions)i(in)g(the)h Fr(mpif.h)e
FA(\014le)h(on)g(F)m(ortran)g(systems)h(that)f(supp)q(ort)h(those.)29
b(Suc)o(h)17 b(decla-)249 1797 y(rations)f(can)g(b)q(e)g(used)h(to)f(a)
o(v)o(oid)e(some)h(of)g(the)i(limitatio)o(ns)d(of)h(the)h(F)m(ortran)g
(77)f(binding)g(of)249 1851 y Fw(MPI)p FA(.)g(F)m(or)i(example,)e(the)i
(C)g(binding)e(sp)q(eci\014es)k(that)e(\\addresses")h(are)f(of)f(t)o
(yp)q(e)h Fq(MPI)p 1653 1851 12 2 v 12 w(Aint)p FA(;)249
1905 y(this)f(t)o(yp)q(e)g(can)f(b)q(e)i(de\014ned)f(to)g(b)q(e)g(a)f
(64)g(bit)g(in)o(teger,)h(on)g(systems)f(with)h(64)f(bit)g(addresses.)
249 1959 y(This)i(feature)g(is)g(not)g(a)o(v)n(ailable)d(in)j(the)g(F)m
(ortran)g(77)f(binding,)g(where)i(\\addresses")h(are)e(of)249
2013 y(t)o(yp)q(e)c Fr(INTEGER)p FA(.)e(By)i(pro)o(viding)f(an)h(in)o
(terface)g(blo)q(c)o(k)f(where)i(\\address")g(parameters)f(are)g(de-)
249 2067 y(\014ned)18 b(to)f(b)q(e)g(of)g(t)o(yp)q(e)g
Fr(INTEGER\(8\))p FA(,)f(the)h(implemen)o(tor)d(can)k(pro)o(vide)f
(supp)q(ort)h(for)e(64)h(bit)249 2121 y(addresses,)f(while)d(main)o
(taining)e(compatibilit)o(y)g(with)i(the)i Fw(MPI)e FA(standard.)19
b(\()p FB(End)d(of)f(advic)n(e)249 2175 y(to)g(implementors.)p
FA(\))291 2266 y(All)20 b Fw(MPI)g FA(named)g(constan)o(ts)h(can)g(b)q
(e)h(used)g(wherev)o(er)g(an)f(en)o(tit)o(y)f(declared)i(with)f(the)249
2320 y Fr(PARAMETER)14 b FA(attribute)i(can)h(b)q(e)f(used)h(in)e(F)m
(ortran.)24 b(There)17 b(is)f(one)g(exception)h(to)f(this)g(rule:)249
2374 y(the)11 b Fw(MPI)f FA(constan)o(t)i Fq(MPI)p 639
2374 V 12 w(BOTTOM)f FA(\(section)h(3.7\))e(can)g(only)g(b)q(e)i(used)f
(as)g(a)f(bu\013er)i(argumen)o(t.)p eop
%%Page: 14 28
14 27 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(14)1275 b(Chapter)13 b(1)249 507
y Fs(1.9.2)48 b(C)16 b(Binding)d(Issues)249 590 y FA(W)m(e)e(use)h(the)
g(ANSI)g(C)f(declaration)g(format.)16 b(All)10 b Fw(MPI)h
FA(names)f(ha)o(v)o(e)i(an)f Fr(MPI)p 1465 590 14 2 v
26 w FA(pre\014x,)h(de\014ned)249 644 y(constan)o(ts)h(are)f(in)f(all)g
(capital)g(letters,)i(and)f(de\014ned)g(t)o(yp)q(es)h(and)f(functions)g
(ha)o(v)o(e)f(one)h(capital)249 698 y(letter)g(after)f(the)h(pre\014x.)
17 b(Programs)10 b(m)o(ust)g(not)h(declare)h(v)n(ariables)e(or)h
(functions)g(with)f(names)249 752 y(b)q(eginning)j(with)h(the)g
(pre\014x)h Fr(MPI)p 791 752 V 29 w FA(or)e Fr(PMPI)p
958 752 V 15 w FA(.)18 b(This)c(is)g(mandated)e(to)i(a)o(v)o(oid)f(p)q
(ossible)h(name)249 806 y(collisions.)291 860 y(The)c(de\014nition)f
(of)h(named)f(constan)o(ts,)i(function)e(protot)o(yp)q(es,)i(and)f(t)o
(yp)q(e)h(de\014nitions)e(m)o(ust)249 914 y(b)q(e)15
b(supplied)f(in)f(an)h(include)g(\014le)f Fw(mpi.h)p
FA(.)291 968 y(Almost)k(all)g(C)i(functions)g(return)h(an)e(error)i(co)
q(de.)34 b(The)19 b(successful)h(return)g(co)q(de)g(will)249
1022 y(b)q(e)15 b Fr(MPI)p 375 1022 V 15 w(SUCCESS)p
FA(,)d(but)i(failure)g(return)h(co)q(des)g(are)g(implemen)o(tatio)o(n)d
(dep)q(enden)o(t.)20 b(A)14 b(few)g(C)249 1076 y(functions)g(do)g(not)f
(return)j(error)e(co)q(des,)h(so)f(that)g(they)g(can)g(b)q(e)h
(implemen)o(ted)c(as)j(macros.)291 1130 y(T)o(yp)q(e)i(declarations)g
(are)g(pro)o(vided)f(for)h(handles)g(to)f(eac)o(h)i(category)f(of)f
(opaque)h(ob)r(jects.)249 1184 y(Either)f(a)e(p)q(oin)o(ter)h(or)g(an)g
(in)o(teger)g(t)o(yp)q(e)h(is)e(used.)291 1238 y(Arra)o(y)h(argumen)o
(ts)f(are)h(indexed)g(from)e(zero.)291 1292 y(Logical)19
b(\015ags)h(are)g(in)o(tegers)i(with)d(v)n(alue)h(0)g(meaning)f
(\\false")g(and)h(a)g(non-zero)h(v)n(alue)249 1346 y(meaning)12
b(\\true.")291 1400 y(Choice)i(argumen)o(ts)f(are)h(p)q(oin)o(ters)h
(of)e(t)o(yp)q(e)h Fr(void*)p FA(.)291 1454 y(Address)g(argumen)o(ts)e
(are)h(of)f Fw(MPI)g FA(de\014ned)h(t)o(yp)q(e)g Fq(MPI)p
1155 1454 12 2 v 13 w(Aint)p FA(.)j(This)d(is)f(de\014ned)i(to)e(b)q(e)
h(an)g Fq(int)249 1508 y FA(of)g(the)i(size)f(needed)i(to)e(hold)f(an)o
(y)g(v)n(alid)g(address)i(on)e(the)i(target)f(arc)o(hitecture.)291
1562 y(All)d(named)f Fw(MPI)h FA(constan)o(ts)i(can)f(b)q(e)h(used)f
(in)g(initialization)d(expressions)k(or)f(assignmen)o(ts)249
1616 y(lik)o(e)h(C)h(constan)o(ts.)p eop
%%Page: 15 29
15 28 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 325 a Fu(2)25 b FD(P)o(oin)o(t-to-P)o(oin)o(t)18
b(Comm)o(unication)249 628 y(2.1)52 b(In)o(tro)q(duction)19
b(and)f(Ov)o(erview)249 736 y FA(The)e(basic)f(comm)o(unicati)o(on)d
(mec)o(hanism)h(of)h Fw(MPI)h FA(is)f(the)i(transmittal)d(of)i(data)f
(b)q(et)o(w)o(een)j(a)249 790 y(pair)11 b(of)f(pro)q(cesses,)k(one)d
(side)h(sending,)f(the)h(other,)g(receiving.)17 b(W)m(e)11
b(call)f(this)i(\\p)q(oin)o(t)e(to)h(p)q(oin)o(t)249
844 y(comm)o(unication.)o(")23 b(Almost)15 b(all)g(the)i(constructs)h
(of)e Fw(MPI)f FA(are)i(built)f(around)g(the)h(p)q(oin)o(t)f(to)249
897 y(p)q(oin)o(t)d(op)q(erations)g(and)g(so)g(this)h(c)o(hapter)g(is)f
(fundamen)o(tal.)i(It)f(is)f(also)f(quite)h(a)g(long)f(c)o(hapter)249
951 y(since:)18 b(there)12 b(are)f(man)o(y)f(v)n(arian)o(ts)g(to)h(the)
h(p)q(oin)o(t)e(to)h(p)q(oin)o(t)g(op)q(erations;)g(there)i(is)e(m)o
(uc)o(h)f(to)h(sa)o(y)249 1005 y(in)i(terms)g(of)g(the)h(seman)o(tics)f
(of)g(the)h(op)q(erations;)f(and)g(related)h(topics,)f(suc)o(h)h(as)g
(probing)f(for)249 1059 y(messages,)i(are)h(explained)f(here)h(b)q
(ecause)h(they)f(are)g(used)g(in)f(conjunction)g(with)g(the)h(p)q(oin)o
(t)249 1113 y(to)e(p)q(oin)o(t)f(op)q(erations.)291 1167
y Fw(MPI)h FA(pro)o(vides)i(a)f(set)i(of)d(send)j(and)e(receiv)o(e)i
(functions)e(that)h(allo)o(w)e(the)i(comm)o(unicatio)o(n)249
1221 y(of)c Fs(t)o(yp)q(ed)e FA(data)i(with)g(an)f(asso)q(ciated)i
Fs(tag)p FA(.)k(T)o(yping)11 b(of)h(the)h(message)e(con)o(ten)o(ts)i
(is)f(necessary)249 1275 y(for)k(heterogeneous)h(supp)q(ort)g(|)e(the)i
(t)o(yp)q(e)f(information)d(is)j(needed)h(so)f(that)g(correct)i(data)
249 1329 y(represen)o(tation)e(con)o(v)o(ersions)g(can)f(b)q(e)g(p)q
(erformed)f(as)h(data)g(is)f(sen)o(t)i(from)d(one)i(arc)o(hitecture)249
1383 y(to)i(another.)27 b(The)17 b(tag)g(allo)o(ws)e(selectivit)o(y)i
(of)g(messages)f(at)h(the)h(receiving)f(end:)24 b(one)17
b(can)249 1437 y(receiv)o(e)g(on)e(a)h(particular)f(tag,)g(or)h(one)g
(can)g(wild-card)f(this)h(quan)o(tit)o(y)m(,)e(allo)o(wing)f(reception)
249 1491 y(of)f(messages)h(with)g(an)o(y)f(tag.)17 b(Message)d
(selectivit)o(y)f(on)g(the)g(source)h(pro)q(cess)h(of)d(the)i(message)
249 1545 y(is)g(also)f(pro)o(vided.)291 1599 y(A)g(fragmen)o(t)e(of)h
(C)h(co)q(de)h(app)q(ears)g(in)e(Example)f(2.1)h(for)h(the)g(example)f
(of)g(pro)q(cess)j(0)e(send-)249 1653 y(ing)j(a)g(message)h(to)f(pro)q
(cess)i(1.)26 b(The)17 b(co)q(de)h(executes)h(on)d(b)q(oth)h(pro)q
(cess)h(0)e(and)h(pro)q(cess)h(1.)249 1707 y(Pro)q(cess)d(0)e(sends)h
(a)e(c)o(haracter)j(string)e(using)f Fr(MPI)p 1049 1707
14 2 v 15 w(Send\(\))p FA(.)17 b(The)c(\014rst)h(three)g(parameters)f
(of)249 1761 y(the)f(send)h(call)e(sp)q(ecify)h(the)h(data)e(to)h(b)q
(e)g(sen)o(t:)18 b(the)12 b(outgoing)f(data)g(is)h(to)f(b)q(e)i(tak)o
(en)f(from)e Fr(msg)p FA(;)249 1815 y(it)18 b(consists)g(of)g
Fr(strlen\(msg\)+1)d FA(en)o(tries,)k(eac)o(h)g(of)e(t)o(yp)q(e)h
Fr(MPI)p 1268 1815 V 15 w(CHAR)f FA(\(The)i(string)f
Fr("Hello)249 1869 y(there")d FA(con)o(tains)i Fr(strlen\(msg\)=11)c
FA(signi\014can)o(t)j(c)o(haracters.)28 b(In)17 b(addition,)e(w)o(e)i
(are)g(also)249 1923 y(sending)e(the)f Fr('\\0')g FA(string)g
(terminator)f(c)o(haracter\).)21 b(The)15 b(fourth)f(parameter)g(sp)q
(eci\014es)i(the)249 1977 y(message)e(destination,)f(whic)o(h)h(is)g
(pro)q(cess)i(1.)i(The)d(\014fth)e(parameter)h(sp)q(eci\014es)i(the)f
(message)249 2031 y(tag.)25 b(Finally)m(,)14 b(the)j(last)f(parameter)g
(is)g(a)g Fs(comm)o(unicator)d FA(that)k(sp)q(eci\014es)h(a)e
Fs(comm)o(uni-)249 2085 y(cation)k(domain)d FA(for)h(this)h(comm)o
(unicatio)o(n.)30 b(Among)16 b(other)k(things,)f(a)f(comm)o(unicator)
249 2139 y(serv)o(es)f(to)e(de\014ne)h(a)f(set)h(of)e(pro)q(cesses)k
(that)d(can)h(b)q(e)f(con)o(tacted.)23 b(Eac)o(h)16 b(suc)o(h)f(pro)q
(cess)i(is)e(la-)249 2193 y(b)q(eled)g(b)o(y)e(a)h(pro)q(cess)i
Fs(rank)p FA(.)i(Pro)q(cess)e(ranks)e(are)h(in)o(tegers)f(and)g(are)h
(disco)o(v)o(ered)f(b)o(y)g(inquiry)249 2247 y(to)f(a)f(comm)o
(unicator)e(\(see)k(the)f(call)f(to)g Fr(MPI)p 947 2247
V 15 w(Comm)p 1050 2247 V 15 w(rank\(\))p FA(\).)17 b
Fr(MPI)p 1308 2247 V 15 w(COMM)p 1411 2247 V 14 w(WORLD)12
b FA(is)g(a)h(default)249 2301 y(comm)o(unicator)i(pro)o(vided)j(up)q
(on)g(start-up)h(that)f(de\014nes)h(an)f(initial)e(comm)o(unication)f
(do-)249 2355 y(main)d(for)h(all)g(the)i(pro)q(cesses)h(that)e
(participate)g(in)f(the)i(computation.)h(Muc)o(h)e(more)f(will)g(b)q(e)
249 2408 y(said)h(ab)q(out)f(comm)o(unicators)f(in)h(Chapter)i(5.)291
2462 y(The)9 b(receiving)h(pro)q(cess)h(sp)q(eci\014ed)g(that)f(the)g
(incoming)d(data)i(w)o(as)g(to)g(b)q(e)h(placed)g(in)f
Fr(msg)g FA(and)976 2613 y(15)p eop
%%Page: 16 30
16 29 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(16)1275 b(Chapter)13 b(2)249 507
y FA(that)i(it)f(had)g(a)h(maxim)n(um)10 b(size)16 b(of)e(20)g(en)o
(tries,)h(of)f(t)o(yp)q(e)h Fr(MPI)p 1233 507 14 2 v
15 w(CHAR)p FA(.)f(The)h(v)n(ariable)e Fr(status)p FA(,)249
561 y(set)g(b)o(y)e Fr(MPI)p 436 561 V 15 w(Recv\(\))p
FA(,)f(giv)o(es)i(information)c(on)k(the)g(source)h(and)e(tag)g(of)g
(the)h(message)f(and)h(ho)o(w)249 615 y(man)o(y)g(elemen)o(ts)i(w)o
(ere)i(actually)d(receiv)o(ed.)20 b(F)m(or)14 b(example,)e(the)j
(receiv)o(er)h(can)e(examine)f(this)249 669 y(v)n(ariable)j(to)h
(\014nd)g(out)h(the)f(actual)g(length)g(of)g(the)h(c)o(haracter)g
(string)f(receiv)o(ed.)30 b(Datat)o(yp)q(e)249 723 y(matc)o(hing)18
b(\(b)q(et)o(w)o(een)j(sender)g(and)e(receiv)o(er\))i(and)e(data)g(con)
o(v)o(ersion)39 b(on)19 b(heterogeneous)249 777 y(systems)14
b(are)g(discussed)i(in)d(more)g(detail)h(in)f(Section)h(2.3.)249
868 y Fs(Example)h(2.1)21 b FA(C)14 b(co)q(de.)19 b(Pro)q(cess)d(0)d
(sends)i(a)f(message)f(to)h(pro)q(cess)i(1.)249 922 y
Fr(char)21 b(msg[20];)249 976 y(int)g(myrank,)g(tag)g(=)g(99;)249
1030 y(MPI_Status)f(status;)249 1084 y(...)249 1138 y(MPI_Comm_rank\()f
(MPI_COMM_WORLD,)g(&myrank)h(\);)43 b(/*)22 b(find)f(my)g(rank)g(*/)249
1192 y(if)g(\(myrank)g(==)g(0\))h({)314 1246 y(strcpy\()f(msg,)g
("Hello)f(there"\);)314 1300 y(MPI_Send\()g(msg,)h(strlen\(msg\)+1,)e
(MPI_CHAR,)h(1,)i(tag,)f(MPI_COMM_WORLD\))o(;)249 1354
y(})h(else)f(if)g(\(myrank)f(==)i(1\))f({)314 1408 y(MPI_Recv\()f(msg,)
h(20,)h(MPI_CHAR,)d(0,)j(tag,)f(MPI_COMM_WORLD,)d(&status\);)249
1462 y(})291 1553 y FA(The)c(F)m(ortran)g(v)o(ersion)g(of)f(this)h(co)q
(de)h(is)f(sho)o(wn)g(in)f(Example)f(2.2.)18 b(In)c(order)g(to)g(mak)o
(e)e(our)249 1607 y(F)m(ortran)g(examples)e(more)h(readable,)h(w)o(e)g
(use)h(F)m(ortran)e(90)h(syn)o(tax,)f(here)i(and)f(in)f(man)o(y)f
(other)249 1661 y(places)20 b(in)e(this)i(b)q(o)q(ok.)33
b(The)20 b(examples)e(can)h(b)q(e)h(easily)f(rewritten)h(in)f(standard)
h(F)m(ortran)249 1715 y(77.)34 b(The)20 b(F)m(ortran)g(co)q(de)g(is)f
(essen)o(tially)h(iden)o(tical)f(to)g(the)h(C)g(co)q(de.)35
b(All)19 b Fw(MPI)g FA(calls)g(are)249 1769 y(pro)q(cedures,)g(and)e
(an)f(additional)f(parameter)i(is)f(used)i(to)f(return)h(the)f(v)n
(alue)f(returned)j(b)o(y)249 1823 y(the)f(corresp)q(onding)g(C)f
(function.)28 b(Note)18 b(that)f(F)m(ortran)g(strings)h(ha)o(v)o(e)f
(\014xed)h(size)g(and)f(are)249 1877 y(not)g(n)o(ull-terminated.)27
b(The)17 b(receiv)o(e)i(op)q(eration)e(stores)i Fr("Hello)h(there")c
FA(in)h(the)h(\014rst)g(11)249 1931 y(p)q(ositions)c(of)f
Fw(msg)p FA(.)249 2022 y Fs(Example)i(2.2)21 b FA(F)m(ortran)14
b(co)q(de.)249 2076 y Fr(CHARACTER*20)19 b(msg)249 2130
y(INTEGER)h(myrank,)h(ierr,)g(status\(MPI_STAT)o(US_SI)o(ZE\))249
2184 y(INTEGER)f(tag)i(=)f(99)249 2238 y(...)249 2292
y(CALL)g(MPI_COMM_RANK\()e(MPI_COMM_WORLD,)g(myrank,)h(ierr\))249
2346 y(IF)h(\(myrank)g(.EQ.)g(0\))g(THEN)336 2400 y(msg)g(=)h("Hello)f
(there")336 2454 y(CALL)g(MPI_SEND\()f(msg,)h(11,)g(MPI_CHARACTER,)e
(1,)663 2508 y(tag,)i(MPI_COMM_WORLD,)e(ierr\))p eop
%%Page: 17 31
17 30 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(17)249 507 y Fr(ELSE)21 b(IF)g(\(myrank)g(.EQ.)g(1\))g(THEN)336
561 y(CALL)g(MPI_RECV\()f(msg,)h(20,)g(MPI_CHARACTER,)e(0,)663
615 y(tag,)i(MPI_COMM_WORLD,)e(status,)h(ierr\))249 669
y(END)h(IF)291 765 y FA(These)f(examples)f(emplo)o(y)o(ed)e
FB(blo)n(cking)j FA(send)g(and)f(receiv)o(e)i(functions.)34
b(The)20 b(send)g(call)249 819 y(blo)q(c)o(ks)e(un)o(til)e(the)j(send)f
(bu\013er)h(can)e(b)q(e)i(reclaimed)d(\(i.e.,)i(after)f(the)i(send,)f
(pro)q(cess)i(0)d(can)249 873 y(safely)e(o)o(v)o(er-write)h(the)h(con)o
(ten)o(ts)g(of)e Fr(msg)p FA(\).)23 b(Similarly)l(,)13
b(the)j(receiv)o(e)h(function)f(blo)q(c)o(ks)f(un)o(til)249
927 y(the)f(receiv)o(e)h(bu\013er)f(actually)f(con)o(tains)g(the)h(con)
o(ten)o(ts)h(of)e(the)h(message.)k Fw(MPI)12 b FA(also)h(pro)o(vides)
249 981 y FB(nonblo)n(cking)k FA(send)f(and)f(receiv)o(e)i(functions)f
(that)f(allo)o(w)f(the)i(p)q(ossible)g(o)o(v)o(erlap)f(of)g(message)249
1034 y(transmittal)10 b(with)h(computation,)f(or)i(the)g(o)o(v)o(erlap)
f(of)h(m)o(ultiple)d(message)i(transmittals)g(with)249
1088 y(one-another.)23 b(Non-blo)q(c)o(king)14 b(functions)i(alw)o(a)o
(ys)e(come)h(in)g(t)o(w)o(o)g(parts:)21 b(the)16 b(p)q(osting)f(func-)
249 1142 y(tions,)g(whic)o(h)f(b)q(egin)h(the)h(requested)h(op)q
(eration;)e(and)g(the)g(test-for-completion)f(functions,)249
1196 y(whic)o(h)i(allo)o(w)e(the)i(application)e(program)h(to)g(disco)o
(v)o(er)h(whether)h(the)g(requested)h(op)q(eration)249
1250 y(has)f(completed.)24 b(Our)17 b(c)o(hapter)h(b)q(egins)e(b)o(y)g
(explaining)f(blo)q(c)o(king)h(functions)g(in)g(detail,)g(in)249
1304 y(Section)d(2.2{2.7,)c(while)j(non)o(blo)q(c)o(king)f(functions)h
(are)h(co)o(v)o(ered)g(later,)f(in)f(Sections)i(2.8{2.12.)291
1358 y(W)m(e)i(ha)o(v)o(e)h(already)g(said)f(rather)i(a)f(lot)f(ab)q
(out)h(a)g(simple)f(transmittal)f(of)h(data)h(from)e(one)249
1412 y(pro)q(cess)k(to)e(another,)h(but)f(there)h(is)f(ev)o(en)h(more.)
24 b(T)m(o)15 b(understand)i(wh)o(y)m(,)f(w)o(e)g(examine)f(t)o(w)o(o)
249 1466 y(asp)q(ects)f(of)e(the)h(comm)o(uni)o(cation:)h(the)f(seman)o
(tics)f(of)g(the)g(comm)o(unication)d(primitiv)o(es,)i(and)249
1520 y(the)j(underlying)f(proto)q(cols)g(that)g(implemen)o(t)d(them.)17
b(Consider)d(the)g(previous)f(example,)f(on)249 1574
y(pro)q(cess)17 b(0,)d(after)h(the)g(blo)q(c)o(king)f(send)i(has)f
(completed.)20 b(The)15 b(question)h(arises:)k(if)14
b(the)i(send)249 1628 y(has)11 b(completed,)f(do)q(es)i(this)e(tell)h
(us)g(an)o(ything)f(ab)q(out)g(the)i(receiving)f(pro)q(cess?)19
b(Can)10 b(w)o(e)h(kno)o(w)249 1682 y(that)j(the)g(receiv)o(e)i(has)e
(\014nished,)g(or)g(ev)o(en,)g(that)g(it)f(has)h(b)q(egun?)291
1736 y(Suc)o(h)g(questions)g(of)g(seman)o(tics)f(are)h(related)h(to)e
(the)i(nature)f(of)g(the)g(underlying)g(proto)q(col)249
1790 y(implemen)o(ting)g(the)19 b(op)q(erations.)29 b(If)17
b(one)h(wishes)h(to)e(implemen)o(t)e(a)i(proto)q(col)h(minim)o(izing)
249 1844 y(the)e(cop)o(ying)e(and)h(bu\013ering)h(of)e(data,)h(the)g
(most)f(natural)h(seman)o(tics)g(migh)o(t)e(b)q(e)i(the)h(\\ren-)249
1898 y(dezv)o(ous")10 b(v)o(ersion,)g(where)h(completion)d(of)g(the)i
(send)h(implies)c(the)j(receiv)o(e)h(has)f(b)q(een)g(initiated)249
1952 y(\(at)15 b(least\).)20 b(On)15 b(the)g(other)g(hand,)f(a)g(proto)
q(col)g(that)h(attempts)f(to)g(blo)q(c)o(k)h(pro)q(cesses)i(for)d(the)
249 2006 y(minim)o(al)d(amoun)o(t)i(of)g(time)g(will)g(necessarily)j
(end)f(up)f(doing)g(more)f(bu\013ering)i(and)f(cop)o(ying)249
2060 y(of)f(data)h(and)g(will)e(ha)o(v)o(e)i(\\bu\013ering")f(seman)o
(tics.)291 2114 y(The)i(trouble)h(is,)f(one)h(c)o(hoice)g(of)f(seman)o
(tics)g(is)g(not)h(b)q(est)g(for)f(all)g(applications,)f(nor)h(is)h(it)
249 2168 y(b)q(est)i(for)e(all)f(arc)o(hitectures.)28
b(Because)18 b(the)f(primary)e(goal)g(of)h Fw(MPI)g FA(is)g(to)h
(standardize)g(the)249 2222 y(op)q(erations,)d(y)o(et)g(not)h
(sacri\014ce)g(p)q(erformance,)f(the)g(decision)h(w)o(as)f(made)f(to)h
(include)g(all)f(the)249 2276 y(ma)r(jor)f(c)o(hoices)j(for)f(p)q(oin)o
(t)f(to)h(p)q(oin)o(t)f(seman)o(tics)g(in)h(the)g(standard.)291
2330 y(The)k(ab)q(o)o(v)o(e)g(complexities)f(are)h(manifested)f(in)h
Fw(MPI)f FA(b)o(y)h(the)g(existence)i(of)e Fs(mo)q(des)f
FA(for)249 2384 y(p)q(oin)o(t)h(to)h(p)q(oin)o(t)g(comm)o(uni)o
(cation.)30 b(Both)19 b(blo)q(c)o(king)f(and)h(non)o(blo)q(c)o(king)f
(comm)o(uni)o(cations)249 2438 y(ha)o(v)o(e)e(mo)q(des.)23
b(The)16 b(mo)q(de)f(allo)o(ws)g(one)h(to)g(c)o(ho)q(ose)g(the)h(seman)
o(tics)e(of)g(the)i(send)g(op)q(eration)249 2492 y(and,)c(in)h
(e\013ect,)h(to)f(in\015uence)h(the)f(underlying)g(proto)q(col)f(of)h
(the)g(transfer)h(of)e(data.)p eop
%%Page: 18 32
18 31 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(18)1275 b(Chapter)13 b(2)291 507
y FA(In)e Fs(standard)e FA(mo)q(de)g(the)j(completion)d(of)i(the)g
(send)h(do)q(es)g(not)f(necessarily)h(mean)e(that)h(the)249
561 y(matc)o(hing)f(receiv)o(e)j(has)f(started,)g(and)g(no)f
(assumption)f(should)i(b)q(e)g(made)e(in)i(the)g(application)249
615 y(program)h(ab)q(out)h(whether)i(the)f(out-going)e(data)h(is)g
(bu\013ered)i(b)o(y)e Fw(MPI)p FA(.)f(In)h Fs(bu\013ered)e
FA(mo)q(de)249 669 y(the)k(user)g(can)g(guaran)o(tee)g(that)f(a)g
(certain)h(amoun)o(t)e(of)h(bu\013ering)g(space)i(is)e(a)o(v)n
(ailable.)20 b(The)249 723 y(catc)o(h)14 b(is)g(that)f(the)i(space)f(m)
o(ust)f(b)q(e)h(explicitly)f(pro)o(vided)g(b)o(y)h(the)g(application)e
(program.)k(In)249 777 y Fs(sync)o(hronous)d FA(mo)q(de)i(a)h(rendezv)o
(ous)h(seman)o(tics)e(b)q(et)o(w)o(een)j(sender)f(and)f(receiv)o(er)h
(is)f(used.)249 831 y(Finally)m(,)e(there)j(is)e Fs(ready)g
FA(mo)q(de.)23 b(This)16 b(allo)o(ws)e(the)i(user)h(to)f(exploit)f
(extra)h(kno)o(wledge)g(to)249 885 y(simplify)10 b(the)j(proto)q(col)g
(and)g(p)q(oten)o(tially)e(ac)o(hiev)o(e)i(higher)g(p)q(erformance.)18
b(In)13 b(a)f(ready-mo)q(de)249 939 y(send,)17 b(the)g(user)g(asserts)g
(that)f(the)h(matc)o(hing)d(receiv)o(e)j(already)f(has)g(b)q(een)h(p)q
(osted.)26 b(Mo)q(des)249 993 y(are)14 b(co)o(v)o(ered)h(in)f(Section)g
(2.13.)249 1113 y FD(2.2)52 b(Blo)q(c)o(king)19 b(Send)e(and)h(Receiv)o
(e)g(Op)q(erations)249 1221 y FA(This)c(section)g(describ)q(es)i
(standard-mo)q(de,)d(blo)q(c)o(king)g(sends)i(and)f(receiv)o(es.)249
1304 y Fs(2.2.1)48 b(Blo)q(c)o(king)14 b(Send)208 1458
y Fw(MPI)p 285 1458 13 2 v 14 w(SEND\(buf,)g(count,)h(datat)o(yp)q(e,)f
(dest,)h(tag,)e(comm\))332 1533 y Fv(IN)158 b Fw(buf)491
b Fv(initial)16 b(address)e(of)f(send)h(bu\013er)332
1583 y(IN)158 b Fw(count)450 b Fv(n)o(um)o(b)q(er)14
b(of)f(en)o(tries)h(to)f(send)332 1633 y(IN)158 b Fw(datat)o(yp)q(e)397
b Fv(datat)o(yp)q(e)14 b(of)f(eac)o(h)g(en)o(try)332
1682 y(IN)158 b Fw(dest)476 b Fv(rank)14 b(of)f(destination)332
1732 y(IN)158 b Fw(tag)490 b Fv(message)14 b(tag)332
1782 y(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)249
1892 y Fr(int)21 b(MPI)p 405 1892 14 2 v 15 w(Send\(void*)f(buf,)h(int)
g(count,)g(MPI)p 1075 1892 V 15 w(Datatype)f(datatype,)g(int)h(dest,)
540 1946 y(int)g(tag,)g(MPI)p 805 1946 V 15 w(Comm)g(comm\))249
2030 y(MPI)p 318 2030 V 15 w(SEND\(BUF,)f(COUNT,)h(DATATYPE,)f(DEST,)g
(TAG,)h(COMM,)g(IERROR\))336 2084 y(<type>)g(BUF\(*\))336
2138 y(INTEGER)g(COUNT,)f(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(IERROR)291
2222 y Fw(MPI)p 368 2222 13 2 v 14 w(SEND)g FA(p)q(erforms)f(a)g
(standard-mo)q(de,)h(blo)q(c)o(king)e(send.)39 b(The)21
b(seman)o(tics)f(of)f(this)249 2276 y(function)c(are)g(describ)q(ed)i
(in)d(Section)i(2.4.)k(The)c(argumen)o(ts)e(to)h Fw(MPI)p
1369 2276 V 14 w(SEND)g FA(are)h(describ)q(ed)249 2330
y(in)d(the)i(follo)o(wing)c(subsections.)p eop
%%Page: 19 33
19 32 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(19)249 507 y Fs(2.2.2)48 b(Send)14 b(Bu\013er)h(and)g(Message)h
(Data)249 590 y FA(The)g(send)g(bu\013er)h(sp)q(eci\014ed)g(b)o(y)e
Fw(MPI)p 858 590 13 2 v 14 w(SEND)h FA(consists)g(of)f
Fw(count)i FA(successiv)o(e)g(en)o(tries)g(of)e(the)249
644 y(t)o(yp)q(e)i(indicated)f(b)o(y)g Fw(datat)o(yp)q(e)p
FA(,)i(starting)e(with)g(the)h(en)o(try)g(at)f(address)h
Fw(buf)p FA(.)26 b(Note)17 b(that)f(w)o(e)249 698 y(sp)q(ecify)k(the)f
(message)g(length)g(in)g(terms)g(of)f(n)o(um)o(b)q(er)g(of)h
FB(entries)p FA(,)g(not)g(n)o(um)o(b)q(er)f(of)h FB(bytes)p
FA(.)249 752 y(The)h(former)e(is)h(mac)o(hine)f(indep)q(enden)o(t)j
(and)e(facilitates)f(p)q(ortable)i(programmi)o(ng.)31
b(The)249 806 y Fw(count)14 b FA(ma)o(y)e(b)q(e)i(zero,)g(in)e(whic)o
(h)i(case)g(the)g(data)f(part)g(of)g(the)h(message)f(is)g(empt)o(y)m(.)
k(The)c(basic)249 860 y(datat)o(yp)q(es)i(corresp)q(ond)h(to)f(the)g
(basic)g(datat)o(yp)q(es)g(of)f(the)h(host)g(language.)k(P)o(ossible)c
(v)n(alues)249 914 y(of)e(this)g(argumen)o(t)f(for)h(F)m(ortran)g(and)g
(the)g(corresp)q(onding)h(F)m(ortran)f(t)o(yp)q(es)h(are)g(listed)f(b)q
(elo)o(w.)p 550 969 893 2 v 549 1023 2 54 v 575 1007
a(MPI)h(datat)o(yp)q(e)p 1043 1023 V 239 w(F)m(ortran)g(datat)o(yp)q(e)
p 1442 1023 V 550 1025 893 2 v 549 1079 2 54 v 575 1063
a Fq(MPI)p 647 1063 12 2 v 13 w(INTEGER)p 1043 1079 2
54 v 250 w Fr(INTEGER)p 1442 1079 V 549 1133 V 575 1117
a Fq(MPI)p 647 1117 12 2 v 13 w(REAL)p 1043 1133 2 54
v 316 w Fr(REAL)p 1442 1133 V 549 1187 V 575 1171 a Fq(MPI)p
647 1171 12 2 v 13 w(DOUBLE)p 812 1171 V 14 w(PRECISION)p
1043 1187 2 54 v 49 w Fr(DOUBLE)20 b(PRECISION)p 1442
1187 V 549 1241 V 575 1225 a Fq(MPI)p 647 1225 12 2 v
13 w(COMPLEX)p 1043 1241 2 54 v 229 w Fr(COMPLEX)p 1442
1241 V 549 1295 V 575 1279 a Fq(MPI)p 647 1279 12 2 v
13 w(LOGICAL)p 1043 1295 2 54 v 253 w Fr(LOGICAL)p 1442
1295 V 549 1349 V 575 1333 a Fq(MPI)p 647 1333 12 2 v
13 w(CHARA)o(CTER)p 1043 1349 2 54 v 184 w Fr(CHARACTER\(1\))p
1442 1349 V 549 1403 V 575 1387 a Fq(MPI)p 647 1387 12
2 v 13 w(BYTE)p 1043 1403 2 54 v 1442 1403 V 549 1457
V 575 1441 a(MPI)p 647 1441 12 2 v 13 w(P)m(A)o(CKED)p
1043 1457 2 54 v 1442 1457 V 550 1458 893 2 v 249 1533
a FA(P)o(ossible)d(v)n(alues)f(for)g(this)h(argumen)o(t)e(for)i(C)f
(and)h(the)g(corresp)q(onding)g(C)g(t)o(yp)q(es)g(are)g(listed)249
1587 y(b)q(elo)o(w.)p 543 1626 906 2 v 542 1680 2 54
v 568 1664 a(MPI)e(datat)o(yp)q(e)p 1006 1680 V 208 w(C)f(datat)o(yp)q
(e)p 1448 1680 V 543 1682 906 2 v 542 1736 2 54 v 568
1719 a Fq(MPI)p 640 1719 12 2 v 13 w(CHAR)p 1006 1736
2 54 v 278 w Fr(signed)20 b(char)p 1448 1736 V 542 1790
V 568 1773 a Fq(MPI)p 640 1773 12 2 v 13 w(SHORT)p 1006
1790 2 54 v 254 w Fr(signed)g(short)h(int)p 1448 1790
V 542 1843 V 568 1827 a Fq(MPI)p 640 1827 12 2 v 13 w(INT)p
1006 1843 2 54 v 317 w Fr(signed)f(int)p 1448 1843 V
542 1897 V 568 1881 a Fq(MPI)p 640 1881 12 2 v 13 w(LONG)p
1006 1897 2 54 v 279 w Fr(signed)g(long)h(int)p 1448
1897 V 542 1951 V 568 1935 a Fq(MPI)p 640 1935 12 2 v
13 w(UNSIGNED)p 842 1935 V 14 w(CHAR)p 1006 1951 2 54
v 75 w Fr(unsigned)f(char)p 1448 1951 V 542 2005 V 568
1989 a Fq(MPI)p 640 1989 12 2 v 13 w(UNSIGNED)p 842 1989
V 14 w(SHORT)p 1006 2005 2 54 v 51 w Fr(unsigned)g(short)h(int)p
1448 2005 V 542 2059 V 568 2043 a Fq(MPI)p 640 2043 12
2 v 13 w(UNSIGNED)p 1006 2059 2 54 v 192 w Fr(unsigned)f(int)p
1448 2059 V 542 2113 V 568 2097 a Fq(MPI)p 640 2097 12
2 v 13 w(UNSIGNED)p 842 2097 V 14 w(LONG)p 1006 2113
2 54 v 76 w Fr(unsigned)g(long)h(int)p 1448 2113 V 542
2167 V 568 2151 a Fq(MPI)p 640 2151 12 2 v 13 w(FLO)o(A)m(T)p
1006 2167 2 54 v 262 w Fr(float)p 1448 2167 V 542 2221
V 568 2205 a Fq(MPI)p 640 2205 12 2 v 13 w(DOUBLE)p 1006
2221 2 54 v 229 w Fr(double)p 1448 2221 V 542 2275 V
568 2259 a Fq(MPI)p 640 2259 12 2 v 13 w(LONG)p 755 2259
V 14 w(DOUBLE)p 1006 2275 2 54 v 113 w Fr(long)g(double)p
1448 2275 V 542 2329 V 568 2313 a Fq(MPI)p 640 2313 12
2 v 13 w(BYTE)p 1006 2329 2 54 v 1448 2329 V 542 2383
V 568 2367 a(MPI)p 640 2367 12 2 v 13 w(P)m(A)o(CKED)p
1006 2383 2 54 v 1448 2383 V 543 2385 906 2 v 291 2451
a FA(The)c(datat)o(yp)q(es)h Fq(MPI)p 645 2451 12 2 v
13 w(BYTE)f FA(and)g Fq(MPI)p 930 2451 V 13 w(P)m(A)o(CKED)e
FA(do)j(not)f(corresp)q(ond)i(to)e(a)g(F)m(ortran)g(or)249
2505 y(C)i(datat)o(yp)q(e.)32 b(A)19 b(v)n(alue)f(of)g(t)o(yp)q(e)h
Fq(MPI)p 886 2505 V 13 w(BYTE)f FA(consists)i(of)e(a)g(b)o(yte)h(\(8)f
(binary)h(digits\).)31 b(A)p eop
%%Page: 20 34
20 33 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(20)1275 b(Chapter)13 b(2)249 507
y FA(b)o(yte)19 b(is)f(unin)o(terpreted)i(and)e(is)g(di\013eren)o(t)h
(from)e(a)h(c)o(haracter.)32 b(Di\013eren)o(t)19 b(mac)o(hines)e(ma)o
(y)249 561 y(ha)o(v)o(e)h(di\013eren)o(t)i(represen)o(tations)g(for)e
(c)o(haracters,)j(or)d(ma)o(y)f(use)i(more)f(than)g(one)h(b)o(yte)g(to)
249 615 y(represen)o(t)f(c)o(haracters.)23 b(On)16 b(the)g(other)f
(hand,)g(a)g(b)o(yte)h(has)f(the)h(same)e(binary)h(v)n(alue)g(on)g(all)
249 669 y(mac)o(hines.)i(The)d(use)h(of)e Fq(MPI)p 720
669 12 2 v 13 w(P)m(A)o(CKED)f FA(is)i(explained)f(in)h(Section)g(3.8.)
291 723 y Fw(MPI)e FA(requires)i(supp)q(ort)g(of)f(the)h(datat)o(yp)q
(es)f(listed)g(ab)q(o)o(v)o(e,)g(whic)o(h)g(matc)o(h)f(the)i(basic)f
(data-)249 777 y(t)o(yp)q(es)j(of)e(F)m(ortran)h(77)f(and)h(ANSI)g(C.)f
(Additional)g Fw(MPI)g FA(datat)o(yp)q(es)h(should)g(b)q(e)g(pro)o
(vided)g(if)249 831 y(the)e(host)f(language)f(has)h(additional)e(data)h
(t)o(yp)q(es.)18 b(Some)11 b(examples)g(are:)17 b Fq(MPI)p
1503 831 V 13 w(LONG)p 1618 831 V 14 w(LONG)p FA(,)249
885 y(for)f(C)g(in)o(tegers)g(declared)h(to)f(b)q(e)h(of)e(t)o(yp)q(e)h
Fw(longlong)p FA(;)h Fq(MPI)p 1185 885 V 12 w(DOUBLE)p
1349 885 V 14 w(COMPLEX)e FA(for)h(double)249 939 y(precision)c
(complex)d(in)i(F)m(ortran)g(declared)h(to)f(b)q(e)g(of)g(t)o(yp)q(e)g
Fq(DOUBLE)f(COMPLEX)p FA(;)g Fq(MPI)p 1608 939 V 12 w(REAL2)p
FA(,)249 993 y Fq(MPI)p 321 993 V 13 w(REAL4)g FA(and)g
Fq(MPI)p 605 993 V 12 w(REAL8)g FA(for)g(F)m(ortran)g(reals,)h
(declared)g(to)f(b)q(e)h(of)20 b(t)o(yp)q(e)10 b Fq(REAL*2)p
FA(,)h Fq(REAL*4)249 1047 y FA(and)f Fq(REAL*8)p FA(,)g(resp)q(ectiv)o
(ely;)i Fq(MPI)p 788 1047 V 13 w(INTEGER1)d(MPI)p 1060
1047 V 13 w(INTEGER2)h FA(and)f Fq(MPI)p 1409 1047 V
13 w(INTEGER4)h FA(for)f(F)m(or-)249 1101 y(tran)16 b(in)o(tegers,)g
(declared)h(to)e(b)q(e)i(of)e(t)o(yp)q(e)31 b Fq(INTEGER*1)p
FA(,)16 b Fq(INTEGER*2)g FA(and)f Fq(INTEGER*4)p FA(,)h(re-)249
1155 y(sp)q(ectiv)o(ely)m(.)i(In)12 b(addition,)f Fw(MPI)h
FA(pro)o(vides)h(a)f(mec)o(hanism)e(for)i(users)i(to)e(de\014ne)i(new,)
e(deriv)o(ed,)249 1209 y(datat)o(yp)q(es.)19 b(This)13
b(is)h(explained)g(in)f(Chapter)i(3.)249 1292 y Fs(2.2.3)48
b(Message)16 b(En)o(v)o(elop)q(e)249 1375 y FA(In)j(addition)e(to)i
(data,)g(messages)g(carry)g(information)d(that)j(is)f(used)i(to)e
(distinguish)h(and)249 1429 y(selectiv)o(ely)i(receiv)o(e)g(them.)36
b(This)20 b(information)d(consists)22 b(of)d(a)h(\014xed)h(n)o(um)o(b)q
(er)e(of)g(\014elds,)249 1483 y(whic)o(h)14 b(w)o(e)g(collectiv)o(ely)f
(call)g(the)i Fs(message)g(en)o(v)o(elop)q(e)p FA(.)h(These)f(\014elds)
f(are)550 1564 y Fs(source)p FA(,)e Fs(destination)o
FA(,)e Fs(tag)p FA(,)j(and)h Fs(comm)o(unicator)p FA(.)249
1645 y(The)g(message)e(source)j(is)e(implicitl)o(y)d(determined)j(b)o
(y)g(the)h(iden)o(tit)o(y)e(of)h(the)h(message)e(sender.)249
1699 y(The)i(other)h(\014elds)f(are)h(sp)q(eci\014ed)g(b)o(y)f(argumen)
o(ts)f(in)g(the)i(send)f(op)q(eration.)291 1753 y(The)h
Fw(comm)e FA(argumen)o(t)h(sp)q(eci\014es)j(the)f Fs(comm)o(unicator)c
FA(used)k(for)f(the)h(send)g(op)q(eration.)249 1807 y(The)g(comm)o
(unicator)e(is)h(a)h(lo)q(cal)f(ob)r(ject)i(that)f(represen)o(ts)j(a)c
Fs(comm)o(unication)g(domain)p FA(.)249 1861 y(A)e(comm)o(uni)o(cation)
d(domain)g(is)i(a)g(global,)f(distributed)i(structure)h(that)f(allo)o
(ws)e(pro)q(cesses)k(in)249 1914 y(a)h Fs(group)32 b
FA(to)17 b(comm)o(unicate)d(with)j(eac)o(h)g(other,)g(or)g(to)g(comm)o
(unicate)d(with)i(pro)q(cesses)k(in)249 1968 y(another)15
b(group.)20 b(A)14 b(comm)o(unication)d(domain)i(of)h(the)h(\014rst)g
(t)o(yp)q(e)g(\(comm)o(unication)c(within)249 2022 y(a)h(group\))h(is)g
(represen)o(ted)i(b)o(y)d(an)h Fs(in)o(tracomm)o(un)o(i)o(cator)p
FA(,)c(whereas)14 b(a)f(comm)o(unicati)o(on)d(do-)249
2076 y(main)18 b(of)h(the)h(second)h(t)o(yp)q(e)f(\(comm)o(unication)d
(b)q(et)o(w)o(een)k(groups\))f(is)g(represen)o(ted)i(b)o(y)e(an)249
2130 y Fs(in)o(tercomm)o(u)o(ni)o(cator)p FA(.)14 b(Pro)q(cesses)h(in)c
(a)h(group)f(are)i(ordered,)g(and)e(are)h(iden)o(ti\014ed)g(b)o(y)g
(their)249 2184 y(in)o(teger)j Fs(rank)p FA(.)43 b(Pro)q(cesses)17
b(ma)o(y)c(participate)i(in)g(sev)o(eral)g(comm)o(unication)d(domains;)
h(dis-)249 2238 y(tinct)k(comm)o(unication)c(domains)i(ma)o(y)g(ha)o(v)
o(e)i(partially)e(or)i(ev)o(en)g(completely)f(o)o(v)o(erlapping)249
2292 y(groups)j(of)f(pro)q(cesses.)34 b(Eac)o(h)19 b(comm)o(unicati)o
(on)d(domain)g(supp)q(orts)k(a)e(disjoin)o(t)f(stream)h(of)249
2346 y(comm)o(unications.)h(Th)o(us,)d(a)f(pro)q(cess)i(ma)o(y)c(b)q(e)
j(able)f(to)g(comm)o(unicate)e(with)i(another)h(pro-)249
2400 y(cess)i(via)e(t)o(w)o(o)h(distinct)g(comm)o(unicatio)o(n)d
(domains,)h(using)i(t)o(w)o(o)f(distinct)h(comm)o(unicators.)249
2454 y(The)g(same)f(pro)q(cess)i(ma)o(y)d(b)q(e)i(iden)o(ti\014ed)g(b)o
(y)g(a)f(di\013eren)o(t)i(rank)e(in)g(the)i(t)o(w)o(o)e(domains;)g(and)
249 2508 y(comm)o(unications)8 b(in)j(the)g(t)o(w)o(o)g(domains)e(do)i
(not)g(in)o(terfere.)18 b Fw(MPI)11 b FA(applications)f(b)q(egin)h
(with)g(a)p eop
%%Page: 21 35
21 34 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(21)249 507 y FA(default)12 b(comm)o(unication)d(domain)h(that)i
(includes)h(all)e(pro)q(cesses)k(\(of)d(this)h(parallel)e(job\);)h(the)
249 561 y(default)i(comm)o(unicator)e Fq(MPI)p 733 561
12 2 v 13 w(COMM)p 867 561 V 13 w(W)o(ORLD)j FA(represen)o(ts)i(this)e
(comm)o(unicatio)o(n)d(domain.)249 615 y(Comm)o(uni)o(cators)g(are)i
(explained)g(further)h(in)e(Chapter)i(5.)291 669 y(The)g(message)g
(destination)h(is)f(sp)q(eci\014ed)i(b)o(y)e(the)h Fw(dest)31
b FA(argumen)o(t.)22 b(The)16 b(range)f(of)g(v)n(alid)249
723 y(v)n(alues)h(for)g Fw(dest)h FA(is)f Fw(0,...,n-1)p
FA(,)e(where)j Fw(n)f FA(is)g(the)h(n)o(um)o(b)q(er)f(of)f(pro)q
(cesses)k(in)d(the)h(group.)25 b(This)249 777 y(range)18
b(includes)f(the)h(rank)g(of)e(the)i(sender:)27 b(if)16
b Fw(comm)g FA(is)h(an)g(in)o(tracomm)o(unicator,)e(then)j(a)249
831 y(pro)q(cess)13 b(ma)o(y)c(send)j(a)e(message)h(to)g(itself.)17
b(If)10 b(the)i(comm)o(unicator)c(is)j(an)f(in)o(tercomm)o(unicator,)
249 885 y(then)15 b(destinations)f(are)g(iden)o(ti\014ed)g(b)o(y)g
(their)g(rank)g(in)f(the)i(remote)e(group.)291 939 y(The)i(in)o
(teger-v)n(alued)g(message)g(tag)g(is)g(sp)q(eci\014ed)i(b)o(y)e(the)h
Fw(tag)f FA(argumen)o(t.)44 b(This)15 b(in)o(teger)249
993 y(can)k(b)q(e)g(used)g(b)o(y)f(the)h(application)e(to)h
(distinguish)g(messages.)31 b(The)19 b(range)f(of)g(v)n(alid)f(tag)249
1047 y(v)n(alues)d(is)h Fw(0,...,UB)o FA(,)c(where)16
b(the)f(v)n(alue)f(of)g Fw(UB)f FA(is)h(implemen)o(tation)d(dep)q
(enden)o(t.)22 b(It)15 b(is)f(found)249 1101 y(b)o(y)e(querying)g(the)g
(v)n(alue)g(of)f(the)h(attribute)h Fq(MPI)p 1009 1101
V 13 w(T)m(A)o(G)p 1096 1101 V 13 w(UB)p FA(,)e(as)h(describ)q(ed)i(in)
d(Chapter)i(7.)k Fw(MPI)249 1155 y FA(requires)e(that)f
Fw(UB)f FA(b)q(e)i(no)e(less)i(than)f(32767.)249 1238
y Fs(2.2.4)48 b(Commen)o(ts)14 b(on)i(Send)249 1321 y
FB(A)n(dvic)n(e)f(to)h(users.)40 b FA(Comm)o(unicators)12
b(pro)o(vide)i(an)g(imp)q(ortan)o(t)f(encapsulation)i(mec)o(hanism)249
1375 y(for)h(libraries)f(and)h(mo)q(dules.)23 b(They)16
b(allo)o(w)f(mo)q(dules)g(to)g(ha)o(v)o(e)h(their)g(o)o(wn)g(comm)o
(unicatio)o(n)249 1429 y(space)g(and)e(their)h(o)o(wn)f(pro)q(cess)j(n)
o(um)o(b)q(ering)c(sc)o(heme.)20 b(Chapter)15 b(5)g(discusses)h
(functions)f(for)249 1483 y(de\014ning)f(new)g(comm)o(unicators)e(and)h
(use)i(of)e(comm)o(unicators)f(for)h(library)h(design.)249
1553 y(Users)g(that)f(are)f(comfortable)f(with)h(the)h(notion)f(of)g(a)
g(\015at)g(name)g(space)h(for)f(pro)q(cesses)j(and)e(a)249
1607 y(single)f(comm)o(unicatio)o(n)e(domain,)f(as)j(o\013ered)i(b)o(y)
e(most)f(existing)g(comm)o(unication)e(libraries,)249
1661 y(need)16 b(only)f(use)h(the)g(prede\014ned)h(v)n(ariable)d
Fq(MPI)p 1017 1661 V 13 w(COMM)p 1151 1661 V 13 w(W)o(ORLD)h
FA(as)h(the)g Fw(comm)d FA(argumen)o(t.)249 1715 y(This)e(will)e(allo)o
(w)g(comm)o(unication)e(with)k(all)e(the)j(pro)q(cesses)h(a)o(v)n
(ailable)c(at)h(initialization)e(time.)249 1769 y(\()p
FB(End)16 b(of)f(advic)n(e)g(to)g(users.)p FA(\))249
1861 y FB(A)n(dvic)n(e)21 b(to)g(implementors.)76 b FA(The)21
b(message)f(en)o(v)o(elop)q(e)h(is)g(often)g(enco)q(ded)h(b)o(y)e(a)g
(\014xed-)249 1914 y(length)11 b(message)g(header.)18
b(This)11 b(header)h(carries)g(a)f(comm)o(unication)d(domain)g(id)j
(\(sometimes)249 1968 y(referred)17 b(to)e(as)g(the)h
Fs(con)o(text)g(id)p FA(.)k(This)15 b(id)g(need)h(not)f(b)q(e)h(system)
f(wide)g(unique;)g(nor)h(do)q(es)249 2022 y(it)h(need)i(to)f(b)q(e)g
(iden)o(tical)f(at)h(all)e(pro)q(cesses)21 b(within)c(a)g(group.)29
b(It)18 b(is)g(su\016cien)o(t)g(that)g(eac)o(h)249 2076
y(ordered)h(pair)e(of)g(comm)o(unicating)d(pro)q(cesses)20
b(agree)f(to)e(asso)q(ciate)h(a)g(particular)f(id)g(v)n(alue)249
2130 y(with)g(eac)o(h)h(comm)o(unication)d(domain)g(they)j(use.)30
b(In)17 b(addition,)g(the)i(header)f(will)e(usually)249
2184 y(carry)g(message)g(source)h(and)f(tag;)f(source)i(can)f(b)q(e)h
(represen)o(ted)h(as)e(rank)g(within)f(group)g(or)249
2238 y(as)f(an)g(absolute)g(task)g(id.)249 2309 y(The)g(con)o(text)h
(id)e(can)h(b)q(e)g(view)o(ed)g(as)f(an)h(additional)e(tag)h(\014eld.)
18 b(It)c(di\013ers)g(from)e(the)i(regular)249 2363 y(message)f(tag)g
(in)g(that)h(wild)f(card)h(matc)o(hing)d(is)j(not)f(allo)o(w)o(ed)f(on)
h(this)h(\014eld,)f(and)h(that)f(v)n(alue)249 2417 y(setting)j(for)g
(this)g(\014eld)f(is)h(con)o(trolled)g(b)o(y)f(comm)o(unicator)e
(manipulation)g(functions.)24 b(\()p FB(End)249 2471
y(of)15 b(advic)n(e)g(to)g(implementors.)p FA(\))p eop
%%Page: 22 36
22 35 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(22)1275 b(Chapter)13 b(2)249 507
y Fs(2.2.5)48 b(Blo)q(c)o(king)14 b(Receiv)o(e)208 661
y Fw(MPI)p 285 661 13 2 v 14 w(RECV)f(\(buf,)h(count,)g(datat)o(yp)q
(e,)h(source,)f(tag,)f(comm,)f(status\))332 736 y Fv(OUT)114
b Fw(buf)491 b Fv(initial)16 b(address)e(of)f(receiv)o(e)h(bu\013er)332
786 y(IN)158 b Fw(count)450 b Fv(max)14 b(n)o(um)o(b)q(er)f(of)g(en)o
(tries)h(to)f(receiv)o(e)332 836 y(IN)158 b Fw(datat)o(yp)q(e)397
b Fv(datat)o(yp)q(e)14 b(of)f(eac)o(h)g(en)o(try)332
885 y(IN)158 b Fw(source)438 b Fv(rank)14 b(of)f(source)332
935 y(IN)158 b Fw(tag)490 b Fv(message)14 b(tag)332 985
y(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)332 1035
y(OUT)114 b Fw(status)443 b Fv(return)14 b(status)249
1145 y Fr(int)21 b(MPI)p 405 1145 14 2 v 15 w(Recv\(void*)f(buf,)h(int)
g(count,)g(MPI)p 1075 1145 V 15 w(Datatype)f(datatype,)g(int)h(source,)
540 1199 y(int)g(tag,)g(MPI)p 805 1199 V 15 w(Comm)g(comm,)g(MPI)p
1126 1199 V 15 w(Status)f(*status\))249 1283 y(MPI)p
318 1283 V 15 w(RECV\(BUF,)g(COUNT,)h(DATATYPE,)f(SOURCE,)g(TAG,)h
(COMM,)g(STATUS,)f(IERROR\))336 1337 y(<type>)h(BUF\(*\))336
1391 y(INTEGER)g(COUNT,)f(DATATYPE,)g(SOURCE,)g(TAG,)h(COMM,)336
1445 y(STATUS\(MPI)p 559 1445 V 14 w(STATUS)p 705 1445
V 14 w(SIZE\),)g(IERROR)291 1529 y Fw(MPI)p 368 1529
13 2 v 14 w(RECV)16 b FA(p)q(erforms)g(a)h(standard-mo)q(de,)f(blo)q(c)
o(king)g(receiv)o(e.)28 b(The)18 b(seman)o(tics)e(of)g(this)249
1583 y(function)f(are)g(describ)q(ed)i(in)e(Section)g(2.4.)21
b(The)16 b(argumen)o(ts)e(to)h Fw(MPI)p 1370 1583 V 14
w(RECV)f FA(are)i(describ)q(ed)249 1637 y(in)d(the)i(follo)o(wing)c
(subsections.)249 1720 y Fs(2.2.6)48 b(Receiv)o(e)15
b(Bu\013er)249 1803 y FA(The)d(receiv)o(e)i(bu\013er)e(consists)h(of)23
b(storage)13 b(su\016cien)o(t)f(to)g(con)o(tain)f Fw(count)i
FA(consecutiv)o(e)g(en)o(tries)249 1857 y(of)e(the)h(t)o(yp)q(e)f(sp)q
(eci\014ed)i(b)o(y)e Fw(datat)o(yp)q(e)p FA(,)i(starting)e(at)g
(address)i Fw(buf)p FA(.)18 b(The)11 b(length)h(of)e(the)i(receiv)o(ed)
249 1911 y(message)h(m)o(ust)f(b)q(e)h(less)h(than)f(or)g(equal)f(to)h
(the)h(length)f(of)f(the)i(receiv)o(e)g(bu\013er.)19
b(An)13 b(o)o(v)o(er\015o)o(w)249 1965 y(error)j(o)q(ccurs)h(if)d(all)g
(incoming)f(data)i(do)q(es)h(not)f(\014t,)g(without)g(truncation,)g(in)
o(to)f(the)i(receiv)o(e)249 2019 y(bu\013er.)i(W)m(e)11
b(explain)f(in)h(Chapter)g(7)g(ho)o(w)f(to)h(c)o(hec)o(k)h(for)f
(errors.)18 b(If)11 b(a)g(message)f(that)h(is)g(shorter)249
2072 y(than)16 b(the)h(receiv)o(e)g(bu\013er)g(arriv)o(es,)g(then)g
(the)f(incoming)e(message)i(is)g(stored)h(in)f(the)g(initial)249
2126 y(lo)q(cations)d(of)h(the)g(receiv)o(e)h(bu\013er,)g(and)e(the)i
(remaining)d(lo)q(cations)h(are)h(not)g(mo)q(di\014ed.)249
2209 y Fs(2.2.7)48 b(Message)16 b(Selection)249 2293
y FA(The)g(selection)g(of)f(a)h(message)f(b)o(y)g(a)h(receiv)o(e)h(op)q
(eration)e(is)g(go)o(v)o(erned)h(b)o(y)31 b(the)16 b(v)n(alue)f(of)g
(its)249 2346 y(message)h(en)o(v)o(elop)q(e.)27 b(A)16
b(message)h(can)f(b)q(e)h(receiv)o(ed)h(if)e(its)g(en)o(v)o(elop)q(e)h
(matc)o(hes)g(the)g Fw(source)p FA(,)249 2400 y Fw(tag)e
FA(and)g Fw(comm)e FA(v)n(alues)h(sp)q(eci\014ed)j(b)o(y)e(the)g
(receiv)o(e)i(op)q(eration.)k(The)15 b(receiv)o(er)i(ma)o(y)c(sp)q
(ecify)249 2454 y(a)18 b(wildcard)g(v)n(alue)g(for)f
Fw(source)j FA(\()p Fq(MPI)p 856 2454 12 2 v 13 w(ANY)p
948 2454 V 13 w(SOURCE)p FA(\),)e(and/or)g(a)g(wildcard)g(v)n(alue)g
(for)g Fw(tag)p eop
%%Page: 23 37
23 36 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(23)249 507 y FA(\()p Fq(MPI)p 337 507 12 2 v 13
w(ANY)p 429 507 V 13 w(T)m(A)o(G)p FA(\),)12 b(indicating)g(that)h(an)o
(y)f(source)i(and/or)f(tag)f(are)i(acceptable.)19 b(One)13
b(cannot)249 561 y(sp)q(ecify)i(a)e(wildcard)h(v)n(alue)f(for)g
Fw(comm)p FA(.)291 615 y(The)i(argumen)o(t)e Fw(source)p
FA(,)i(if)f(di\013eren)o(t)h(from)e Fq(MPI)p 1072 615
V 13 w(ANY)p 1164 615 V 13 w(SOURCE)p FA(,)29 b(is)15
b(sp)q(eci\014ed)h(as)e(a)g(rank)249 669 y(within)d(the)i(pro)q(cess)h
(group)e(asso)q(ciated)h(with)e(the)i(comm)o(unicator)c(\(remote)j(pro)
q(cess)i(group,)249 723 y(for)20 b(in)o(tercomm)o(unicators\).)36
b(The)21 b(range)g(of)e(v)n(alid)g(v)n(alues)h(for)h(the)g
Fw(source)g FA(argumen)o(t)f(is)249 777 y Ft(f)p Fw(0,...,n-1)p
Ft(g[)p Fn(f)p Fq(M)o(PI)p 546 777 V 11 w(ANY)p 636 777
V 13 w(SOURCE)p Fn(g)p FA(,)15 b(where)i Fw(n)e FA(is)g(the)h(n)o(um)o
(b)q(er)e(of)h(pro)q(cesses)i(in)e(this)g(group.)249
831 y(This)h(range)f(includes)h(the)h(receiv)o(er's)g(rank:)k(if)15
b Fw(comm)e FA(is)j(an)f(in)o(tracomm)o(unicator,)d(then)17
b(a)249 885 y(pro)q(cess)i(ma)o(y)c(receiv)o(e)k(a)e(message)g(from)f
(itself.)27 b(The)18 b(range)g(of)e(v)n(alid)g(v)n(alues)h(for)g(the)h
Fw(tag)249 939 y FA(argumen)o(t)13 b(is)h Ft(f)p Fw(0,...,U)o(B)p
Ft(g[)o Fn(f)p Fq(MPI)p 773 939 V 10 w(ANY)p 863 939
V 14 w(T)m(A)o(G)p Fn(g)p FA(.)249 1022 y Fs(2.2.8)48
b(Return)14 b(Status)249 1105 y FA(The)e(receiv)o(e)g(call)e(do)q(es)i
(not)f(sp)q(ecify)h(the)f(size)h(of)f(an)f(incoming)f(message,)i(but)g
(only)g(an)f(upp)q(er)249 1159 y(b)q(ound.)31 b(The)19
b(source)h(or)e(tag)g(of)g(a)f(receiv)o(ed)j(message)e(ma)o(y)e(not)j
(b)q(e)g(kno)o(wn)e(if)h(wildcard)249 1213 y(v)n(alues)12
b(w)o(ere)h(used)h(in)d(a)h(receiv)o(e)i(op)q(eration.)j(Also,)12
b(if)g(m)o(ultiple)e(requests)k(are)f(completed)f(b)o(y)249
1267 y(a)j(single)g Fw(MPI)g FA(function)h(\(see)g(Section)g(2.9\),)f
(a)g(distinct)h(error)g(co)q(de)h(ma)o(y)c(b)q(e)k(returned)g(for)249
1321 y(eac)o(h)c(request.)20 b(\(Usually)m(,)11 b(the)j(error)g(co)q
(de)f(is)g(returned)i(as)e(the)g(v)n(alue)f(of)g(the)i(function)f(in)f
(C,)249 1375 y(and)i(as)g(the)g(v)n(alue)f(of)h(the)g
Fw(IERROR)e FA(argumen)o(t)h(in)h(F)m(ortran.\))291 1429
y(This)g(information)e(is)j(returned)h(b)o(y)f(the)g
Fw(status)g FA(argumen)o(t)f(of)g Fw(MPI)p 1385 1429
13 2 v 14 w(RECV)p FA(.)f(The)j(t)o(yp)q(e)f(of)249 1483
y Fw(status)c FA(is)g(de\014ned)h(b)o(y)f Fw(MPI)p FA(.)e(Status)j(v)n
(ariables)e(need)i(to)f(b)q(e)g(explicitly)f(allo)q(cated)h(b)o(y)f
(the)i(user,)249 1537 y(that)i(is,)f(they)i(are)f(not)g(system)f(ob)r
(jects.)291 1591 y(In)k(C,)g Fw(status)h FA(is)g(a)f(structure)j(of)d
(t)o(yp)q(e)i Fq(MPI)p 1013 1591 12 2 v 12 w(Status)f
FA(that)g(con)o(tains)f(three)i(\014elds)g(named)249
1645 y Fq(MPI)p 321 1645 V 13 w(SOURCE)p FA(,)9 b Fq(MPI)p
573 1645 V 13 w(T)m(A)o(G)p FA(,)f(and)h Fq(MPI)p 826
1645 V 12 w(ERROR)p FA(;)g(the)h(structure)i(ma)o(y)7
b(con)o(tain)i(additional)e(\014elds.)249 1699 y(Th)o(us,)j
Fw(status.)p Fq(MPI)p 549 1699 V 12 w(SOURCE)p FA(,)g
Fw(status.)p Fq(MPI)p 916 1699 V 12 w(T)m(A)o(G)f FA(and)g
Fw(status.)p Fq(MPI)p 1272 1699 V 12 w(ERROR)g FA(con)o(tain)g(the)h
(source,)249 1753 y(tag)k(and)f(error)i(co)q(de,)f(resp)q(ectiv)o(ely)m
(,)h(of)e(the)i(receiv)o(ed)g(message.)291 1807 y(In)e(F)m(ortran,)f
Fw(status)i FA(is)e(an)h(arra)o(y)g(of)g Fr(INTEGER)p
FA(s)f(of)g(length)h Fq(MPI)p 1298 1807 V 13 w(ST)m(A)m(TUS)p
1451 1807 V 14 w(SIZE)p FA(.)h(The)f(three)249 1861 y(constan)o(ts)f
Fq(MPI)p 502 1861 V 12 w(SOURCE)p FA(,)f Fq(MPI)p 755
1861 V 13 w(T)m(A)o(G)f FA(and)g Fq(MPI)p 999 1861 V
13 w(ERROR)21 b FA(are)12 b(the)f(indices)g(of)f(the)i(en)o(tries)f
(that)249 1914 y(store)17 b(the)f(source,)h(tag)f(and)g(error)g
(\014elds.)25 b(Th)o(us)16 b Fw(status)p Fq(\(MPI)p 1253
1914 V 13 w(SOURCE\))p FA(,)g Fw(status)p Fq(\(MPI)p
1645 1914 V 12 w(T)m(A)o(G\))249 1968 y FA(and)c Fw(status)p
Fq(\(MPI)p 518 1968 V 12 w(ERROR\))g FA(con)o(tain,)f(resp)q(ectiv)o
(ely)m(,)i(the)f(source,)h(the)f(tag)f(and)h(the)g(error)h(co)q(de)249
2022 y(of)g(the)i(receiv)o(ed)g(message.)291 2076 y(The)h(status)h
(argumen)o(t)d(also)i(returns)h(information)c(on)j(the)h(length)e(of)h
(the)g(message)g(re-)249 2130 y(ceiv)o(ed.)24 b(Ho)o(w)o(ev)o(er,)17
b(this)e(information)e(is)j(not)f(directly)h(a)o(v)n(ailable)e(as)i(a)f
(\014eld)h(of)f(the)i(status)249 2184 y(v)n(ariable)c(and)h(a)f(call)g
(to)h Fw(MPI)p 724 2184 13 2 v 14 w(GET)p 819 2184 V
15 w(COUNT)f FA(is)h(required)h(to)e(\\deco)q(de")i(this)f
(information.)p eop
%%Page: 24 38
24 37 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(24)1275 b(Chapter)13 b(2)249 507
y Fw(MPI)p 326 507 13 2 v 14 w(GET)p 421 507 V 15 w(COUNT\(status,)g
(datat)o(yp)q(e,)i(count\))332 582 y Fv(IN)158 b Fw(status)443
b Fv(return)14 b(status)f(of)g(receiv)o(e)h(op)q(eration)332
632 y(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14
b(of)f(eac)o(h)g(receiv)o(e)h(bu\013er)g(en)o(try)332
682 y(OUT)114 b Fw(count)450 b Fv(n)o(um)o(b)q(er)14
b(of)f(receiv)o(ed)h(en)o(tries)249 792 y Fr(int)21 b(MPI)p
405 792 14 2 v 15 w(Get)p 486 792 V 15 w(count\(MPI)p
699 792 V 14 w(Status)g(*status,)f(MPI)p 1128 792 V 15
w(Datatype)g(datatype,)540 846 y(int)h(*count\))249 930
y(MPI)p 318 930 V 15 w(GET)p 399 930 V 15 w(COUNT\(STATUS,)e(DATATYPE,)
h(COUNT,)h(IERROR\))336 984 y(INTEGER)g(STATUS\(MPI)p
734 984 V 13 w(STATUS)p 879 984 V 15 w(SIZE\),)f(DATATYPE,)g(COUNT,)h
(IERROR)291 1068 y Fw(MPI)p 368 1068 13 2 v 14 w(GET)p
463 1068 V 15 w(COUNT)13 b FA(tak)o(es)h(as)g(input)g(the)g
Fw(status)g FA(set)h(b)o(y)e Fw(MPI)p 1288 1068 V 15
w(RECV)f FA(and)i(computes)g(the)249 1122 y(n)o(um)o(b)q(er)9
b(of)g(en)o(tries)h(receiv)o(ed.)18 b(The)10 b(n)o(um)o(b)q(er)f(of)g
(en)o(tries)i(is)e(returned)i(in)e Fw(count)p FA(.)18
b(The)10 b Fw(datat)o(yp)q(e)249 1176 y FA(argumen)o(t)k(should)i(matc)
o(h)e(the)i(argumen)o(t)e(pro)o(vided)i(to)f(the)h(receiv)o(e)h(call)e
(that)g(set)i Fw(status)p FA(.)249 1230 y(\(Section)d(3.4)f(explains)h
(that)g Fw(MPI)p 805 1230 V 14 w(GET)p 900 1230 V 15
w(COUNT)f FA(ma)o(y)e(return,)k(in)e(certain)i(situations,)e(the)249
1283 y(v)n(alue)g Fq(MPI)p 428 1283 12 2 v 13 w(UNDEFINED)p
FA(.\))249 1367 y Fs(2.2.9)48 b(Commen)o(ts)14 b(on)i(Receiv)o(e)249
1450 y FA(Note)k(the)g(asymmetry)d(b)q(et)o(w)o(een)j(send)h(and)e
(receiv)o(e)h(op)q(erations.)35 b(A)19 b(receiv)o(e)i(op)q(eration)249
1504 y(ma)o(y)13 b(accept)i(messages)g(from)e(an)h(arbitrary)h(sender,)
g(but)g(a)f(send)i(op)q(eration)e(m)o(ust)g(sp)q(ecify)249
1557 y(a)g(unique)h(receiv)o(er.)22 b(This)15 b(matc)o(hes)f(a)h
(\\push")f(comm)o(unication)e(mec)o(hanism,)g(where)k(data)249
1611 y(transfer)21 b(is)e(e\013ected)j(b)o(y)d(the)h(sender,)i(rather)f
(than)e(a)h(\\pull")e(mec)o(hanism,)g(where)j(data)249
1665 y(transfer)15 b(is)f(e\013ected)i(b)o(y)d(the)i(receiv)o(er.)291
1719 y(Source)h(equal)f(to)g(destination)g(is)g(allo)o(w)o(ed,)e(that)j
(is,)e(a)h(pro)q(cess)i(can)f(send)g(a)f(message)g(to)249
1773 y(itself.)h(Ho)o(w)o(ev)o(er,)11 b(for)f(suc)o(h)g(a)g(comm)o
(unicatio)o(n)d(to)j(succeed,)i(it)e(is)g(required)g(that)g(the)h
(message)249 1827 y(b)q(e)17 b(bu\013ered)i(b)o(y)d(the)h(system)g(b)q
(et)o(w)o(een)h(the)f(completion)e(of)h(the)h(send)h(call)e(and)g(the)i
(start)249 1881 y(of)c(the)i(receiv)o(e)g(call.)k(The)c(amoun)o(t)d(of)
h(bu\013er)i(space)g(a)o(v)n(ailable)d(and)i(the)g(bu\013er)h(allo)q
(cation)249 1935 y(p)q(olicy)f(are)g(implemen)o(tation)d(dep)q(enden)o
(t.)23 b(Therefore,)16 b(it)f(is)g(unsafe)h(and)f(non-p)q(ortable)g(to)
249 1989 y(send)h(self-messages)f(with)f(the)h(standard-mo)q(de,)f(blo)
q(c)o(king)g(send)i(and)e(receiv)o(e)31 b(op)q(erations)249
2043 y(describ)q(ed)17 b(so)e(far,)f(since)i(this)f(ma)o(y)e(lead)i(to)
f(deadlo)q(c)o(k.)21 b(More)16 b(discussions)g(of)e(this)h(app)q(ear)
249 2097 y(in)e(Section)i(2.4.)249 2188 y FB(A)n(dvic)n(e)i(to)g
(users.)49 b FA(A)16 b(receiv)o(e)h(op)q(eration)f(m)o(ust)f(sp)q
(ecify)i(the)g(t)o(yp)q(e)f(of)g(the)g(en)o(tries)h(of)f(the)249
2242 y(incoming)11 b(message,)i(and)g(an)g(upp)q(er)h(b)q(ound)f(on)g
(the)h(n)o(um)o(b)q(er)e(of)h(en)o(tries.)19 b(In)13
b(some)f(cases,)j(a)249 2296 y(pro)q(cess)g(ma)o(y)c(exp)q(ect)k(sev)o
(eral)e(messages)g(of)g(di\013eren)o(t)h(lengths)f(or)g(t)o(yp)q(es.)19
b(The)13 b(pro)q(cess)i(will)249 2350 y(p)q(ost)i(a)g(receiv)o(e)h(for)
e(eac)o(h)h(message)g(it)f(exp)q(ects)j(and)d(use)i(message)e(tags)h
(to)g(disam)o(biguate)249 2404 y(incoming)12 b(messages.)249
2475 y(In)20 b(other)h(cases,)h(a)d(pro)q(cess)j(ma)o(y)c(exp)q(ect)k
(only)d(one)h(message,)h(but)f(this)g(message)f(is)h(of)p
eop
%%Page: 25 39
25 38 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(25)249 507 y FA(unkno)o(wn)18 b(t)o(yp)q(e)i(or)e(length.)33
b(If)18 b(there)i(are)f(only)f(few)h(p)q(ossible)g(kinds)g(of)f
(incoming)e(mes-)249 561 y(sages,)e(then)h(eac)o(h)g(suc)o(h)f(kind)g
(can)g(b)q(e)h(iden)o(ti\014ed)f(b)o(y)g(a)g(di\013eren)o(t)h(tag)e(v)n
(alue.)18 b(The)d(function)249 615 y Fw(MPI)p 326 615
13 2 v 14 w(PROBE)d FA(describ)q(ed)k(in)d(Section)h(2.10)e(can)i(b)q
(e)g(used)h(to)e(c)o(hec)o(k)i(for)e(incoming)e(messages)249
669 y(without)j(actually)f(receiving)h(them.)k(The)c(receiving)h(pro)q
(cess)h(can)e(\014rst)h(test)g(the)f(tag)g(v)n(alue)249
723 y(of)e(the)i(incoming)d(message)i(and)f(then)i(receiv)o(e)g(it)f
(with)g(an)g(appropriate)g(receiv)o(e)h(op)q(eration.)249
794 y(In)f(the)h(most)e(general)h(case,)h(it)f(ma)o(y)e(not)i(b)q(e)h
(p)q(ossible)f(to)g(represen)o(t)j(eac)o(h)d(message)g(kind)g(b)o(y)249
848 y(a)h(di\013eren)o(t)h(tag)f(v)n(alue.)k(A)c(t)o(w)o(o-phase)g
(proto)q(col)g(ma)o(y)f(b)q(e)h(used:)39 b(the)15 b(sender)g(\014rst)g
(sends)h(a)249 902 y(message)10 b(con)o(taining)g(a)g(description)h(of)
e(the)j(data,)e(then)h(the)g(data)f(itself.)17 b(The)10
b(t)o(w)o(o)g(messages)249 956 y(are)19 b(guaran)o(teed)g(to)f(arriv)o
(e)h(in)f(the)h(correct)h(order)g(at)e(the)h(destination,)g(as)g
(discussed)h(in)249 1010 y(Section)13 b(2.4.)j(An)c(alternativ)o(e)g
(approac)o(h)g(is)g(to)g(use)h(the)g(pac)o(king)e(and)h(unpac)o(king)f
(functions)249 1064 y(describ)q(ed)g(in)e(Section)h(3.8.)16
b(These)10 b(allo)o(w)e(the)i(sender)h(to)e(pac)o(k)h(in)f(one)h
(message)f(a)g(description)249 1117 y(of)14 b(the)h(data,)f(follo)o(w)o
(ed)f(b)o(y)h(the)h(data)g(itself,)f(th)o(us)h(creating)f(a)h(\\self-t)
o(yp)q(ed")f(message.)20 b(The)249 1171 y(receiv)o(er)c(can)f(\014rst)h
(extract)31 b(the)15 b(data)f(description)i(and)e(next)i(use)f(it)g(to)
f(extract)i(the)g(data)249 1225 y(itself.)249 1296 y(Sup)q
(er\014cially)m(,)e(tags)h(and)f(comm)o(unicators)f(ful\014ll)g(a)h
(similar)f(function.)20 b(Both)15 b(allo)o(w)f(one)h(to)249
1350 y(partition)g(comm)o(unications)e(in)o(to)j(distinct)g(classes,)i
(with)e(sends)h(matc)o(hing)d(only)i(receiv)o(es)249
1404 y(from)g(the)i(same)f(class.)30 b(T)m(ags)17 b(o\013er)h(imp)q
(erfect)g(protection)g(since)h(wildcard)e(receiv)o(es)i(cir-)249
1458 y(cum)o(v)o(en)o(t)c(the)i(protection)g(pro)o(vided)e(b)o(y)h
(tags,)g(while)g(comm)o(unicators)e(are)i(allo)q(cated)g(and)249
1512 y(managed)e(using)h(sp)q(ecial,)h(safer)g(op)q(erations.)23
b(It)15 b(is)h(preferable)g(to)f(use)i(comm)o(uni)o(cators)d(to)249
1566 y(pro)o(vide)k(protected)h(comm)o(unication)14 b(domains)i(across)
j(mo)q(dules)e(or)g(libraries.)30 b(T)m(ags)17 b(are)249
1620 y(used)38 b(to)18 b(discriminate)f(b)q(et)o(w)o(een)j(di\013eren)o
(t)f(kinds)f(of)g(messages)g(within)g(one)h(mo)q(dule)d(or)249
1674 y(library)m(.)249 1744 y Fw(MPI)11 b FA(o\013ers)h(a)f(v)n(ariet)o
(y)g(of)f(mec)o(hanisms)g(for)h(matc)o(hing)e(incoming)g(messages)i(to)
g(receiv)o(e)i(op)q(er-)249 1798 y(ations.)18 b(Often)o(times,)13
b(matc)o(hing)f(b)o(y)i(sender)h(or)f(b)o(y)g(tag)f(will)g(b)q(e)h
(su\016cien)o(t)h(to)e(matc)o(h)g(sends)249 1852 y(and)k(receiv)o(es)i
(correctly)m(.)28 b(Nev)o(ertheless,)19 b(it)e(is)g(preferable)h(to)e
(a)o(v)o(oid)g(the)i(use)f(of)g(wildcard)249 1906 y(receiv)o(es)f
(whenev)o(er)h(p)q(ossible.)41 b(Narro)o(w)o(er)16 b(matc)o(hing)c
(criteria)k(result)f(in)f(safer)h(co)q(de,)h(with)249
1960 y(less)32 b(opp)q(ortunities)15 b(for)g(message)h(misma)o(tc)o(h)d
(or)j(nondeterministic)f(b)q(eha)o(vior.)22 b(Narro)o(w)o(er)249
2014 y(matc)o(hing)10 b(criteria)i(ma)o(y)d(also)i(lead)g(to)h(impro)o
(v)o(ed)e(p)q(erformance.)17 b(\()p FB(End)c(of)g(advic)n(e)g(to)g
(users.)p FA(\))249 2105 y FB(R)n(ationale.)37 b FA(Wh)o(y)13
b(is)h(status)h(information)c(returned)k(via)e(a)h(sp)q(ecial)g
Fw(status)g FA(v)n(ariable?)249 2176 y(Some)d(libraries)i(return)g
(this)g(information)c(via)j Fv(INOUT)f Fw(count)p FA(,)j
Fw(tag)e FA(and)g Fw(source)i FA(argumen)o(ts,)249 2230
y(th)o(us)f(using)g(them)e(b)q(oth)i(to)g(sp)q(ecify)g(the)g(selection)
h(criteria)f(for)f(incoming)e(messages)j(and)g(to)249
2284 y(return)18 b(the)e(actual)g(en)o(v)o(elop)q(e)h(v)n(alues)f(of)g
(the)h(receiv)o(ed)h(message.)25 b(The)16 b(use)h(of)f(a)g(separate)249
2338 y(argumen)o(t)10 b(prev)o(en)o(ts)i(errors)f(asso)q(ciated)h(with)
e Fv(INOUT)g FA(argumen)o(ts)g(\(for)g(example,)f(using)i(the)249
2392 y Fq(MPI)p 321 2392 12 2 v 13 w(ANY)p 413 2392 V
13 w(T)m(A)o(G)g FA(constan)o(t)h(as)g(the)h(tag)e(argumen)o(t)g(in)g
(a)h(send\).)18 b(Another)13 b(p)q(oten)o(tial)e(source)i(of)249
2446 y(errors,)g(for)e(non)o(blo)q(c)o(king)g(comm)o(unicati)o(ons,)e
(is)j(that)g(status)g(information)d(ma)o(y)g(b)q(e)k(up)q(dated)249
2500 y(after)i(the)f(call)g(that)g(passed)i(in)d Fw(count)p
FA(,)i Fw(tag)f FA(and)g Fw(source)p FA(.)21 b(In)14
b(\\old-st)o(yle")f(designs,)h(an)g(error)p eop
%%Page: 26 40
26 39 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(26)1275 b(Chapter)13 b(2)249 507
y FA(could)e(o)q(ccur)i(if)e(the)h(receiv)o(er)h(accesses)h(or)d
(deallo)q(cates)h(these)h(v)n(ariables)e(b)q(efore)h(the)g(comm)o(u-)
249 561 y(nication)k(completed.)25 b(Instead,)18 b(in)e(the)h
Fw(MPI)f FA(design)h(for)f(non)o(blo)q(c)o(king)f(comm)o(unicatio)o
(ns,)249 615 y(the)e Fw(status)g FA(argumen)o(t)f(is)h(passed)g(to)g
(the)g(call)f(that)h(completes)g(the)g(comm)o(unicatio)o(n,)d(and)j(is)
249 669 y(up)q(dated)i(b)o(y)e(this)h(call.)249 740 y(Other)21
b(libraries)f(return)i(status)f(b)o(y)f(calls)g(that)g(refer)h
(implicitly)c(to)j(the)h(\\last)f(message)249 794 y(receiv)o(ed.")f
(This)14 b(is)g(not)g(thread)g(safe.)249 864 y(Wh)o(y)f(isn't)h
Fw(count)h FA(a)e(\014eld)h(of)g(the)g Fw(status)g FA(v)n(ariable?)249
935 y(On)j(some)f(systems,)h(it)g(ma)o(y)e(b)q(e)i(faster)h(to)e
(receiv)o(e)i(data)f(without)f(coun)o(ting)h(the)g(n)o(um)o(b)q(er)249
989 y(of)d(en)o(tries)h(receiv)o(ed.)20 b(Incoming)13
b(messages)h(do)g(not)g(carry)h(an)f(en)o(try)h(coun)o(t.)k(Indeed,)c
(when)249 1043 y(user-de\014ned)f(datat)o(yp)q(es)f(are)g(used)g(\(see)
h(Chapter)e(3\),)g(it)g(ma)o(y)e(not)j(b)q(e)f(p)q(ossible)h(to)f
(compute)249 1097 y(suc)o(h)17 b(a)f(coun)o(t)g(at)g(the)g(sender.)26
b(Instead,)17 b(incoming)d(messages)i(carry)g(a)g(b)o(yte)g(coun)o(t.)
25 b(The)249 1151 y(translation)13 b(of)h(a)f(b)o(yte)h(coun)o(t)h(in)o
(to)e(an)g(en)o(try)i(coun)o(t)f(ma)o(y)e(b)q(e)j(time)d(consuming,)g
(esp)q(ecially)249 1205 y(for)17 b(user-de\014ned)i(datat)o(yp)q(es,)f
(and)f(ma)o(y)e(not)i(b)q(e)g(needed)i(b)o(y)e(the)g(receiv)o(er.)29
b(The)18 b(curren)o(t)249 1259 y(design)c(a)o(v)o(oids)f(the)h(need)h
(for)f(computing)e(an)i(en)o(try)g(coun)o(t)g(in)g(those)g(situations)g
(where)h(the)249 1313 y(coun)o(t)f(is)g(not)g(needed.)249
1383 y(Note)g(that)g(the)h(curren)o(t)g(design)f(allo)o(ws)f(implemen)o
(tatio)o(ns)f(that)i(compute)f(a)h(coun)o(t)g(during)249
1437 y(receiv)o(es)i(and)d(store)i(the)g(coun)o(t)f(in)f(a)h(\014eld)g
(of)f(the)i Fw(status)f FA(v)n(ariable.)i(\()p FB(End)g(of)f(r)n
(ationale.)p FA(\))249 1528 y FB(A)n(dvic)n(e)d(to)h(implementors.)34
b FA(Ev)o(en)12 b(though)f(no)h(sp)q(eci\014c)g(b)q(eha)o(vior)g(is)f
(mandated)f(b)o(y)h Fw(MPI)g FA(for)249 1582 y(erroneous)k(programs,)c
(the)j(recommended)e(handling)g(of)g(o)o(v)o(er\015o)o(w)h(situations)g
(is)g(to)g(return,)249 1636 y(in)g Fw(status)p FA(,)f(information)e(ab)
q(out)j(the)h(source,)g(tag)e(and)h(size)h(of)e(the)i(incoming)d
(message.)17 b(The)249 1690 y(receiv)o(e)j(op)q(eration)f(will)f
(return)i(an)f(error)h(co)q(de.)34 b(A)19 b(qualit)o(y)f(implemen)o
(tatio)o(n)e(will)i(also)249 1744 y(ensure)e(that)d(memory)f(that)i(is)
g(outside)g(the)g(receiv)o(e)h(bu\013er)g(will)e(not)h(b)q(e)g(o)o(v)o
(erwritten.)249 1815 y(In)20 b(the)g(case)h(of)e(a)g(message)g(shorter)
i(than)f(the)g(receiv)o(e)h(bu\013er,)g Fw(MPI)e FA(is)h(quite)f
(strict)i(in)249 1869 y(that)15 b(it)g(allo)o(ws)e(no)i(mo)q
(di\014cation)e(of)h(the)h(other)h(lo)q(cations)e(in)h(the)g(bu\013er.)
22 b(A)15 b(more)f(lenien)o(t)249 1923 y(statemen)o(t)h(w)o(ould)f
(allo)o(w)f(for)h(some)g(optimizations)f(but)i(this)f(is)h(not)g(allo)o
(w)o(ed.)k(The)c(imple-)249 1977 y(men)o(tation)g(m)o(ust)h(b)q(e)i
(ready)f(to)g(end)g(a)g(cop)o(y)g(in)o(to)f(the)i(receiv)o(er)g(memory)
d(exactly)i(at)g(the)249 2031 y(end)c(of)e(the)i(receiv)o(ed)h(data,)e
(ev)o(en)h(if)e(it)h(is)g(at)g(a)g(non-w)o(ord-aligned)f(address.)19
b(\()p FB(End)14 b(of)f(advic)n(e)249 2085 y(to)i(implementors.)p
FA(\))249 2205 y FD(2.3)52 b(Datat)o(yp)q(e)19 b(Matc)o(hing)f(and)g
(Data)h(Con)o(v)o(ersion)249 2313 y Fs(2.3.1)48 b(T)o(yp)q(e)16
b(Matc)o(hing)e(Rules)249 2396 y FA(One)h(can)f(think)f(of)h(message)f
(transfer)i(as)f(consisting)g(of)f(the)i(follo)o(wing)c(three)k
(phases.)249 2479 y(1.)20 b(Data)13 b(is)h(copied)g(out)g(of)f(the)i
(send)g(bu\013er)f(and)g(a)g(message)f(is)h(assem)o(bled.)p
eop
%%Page: 27 41
27 40 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(27)249 507 y FA(2.)20 b(A)14 b(message)g(is)f(transferred)j(from)
c(sender)k(to)d(receiv)o(er.)249 561 y(3.)20 b(Data)e(is)h(copied)g
(from)e(the)j(incoming)d(message)h(and)h(disassem)o(bled)f(in)o(to)h
(the)g(receiv)o(e)249 615 y(bu\013er.)291 698 y(T)o(yp)q(e)g(matc)o
(hing)f(m)o(ust)g(b)q(e)i(observ)o(ed)h(at)e(eac)o(h)h(of)f(these)i
(phases.)35 b(The)20 b(t)o(yp)q(e)g(of)f(eac)o(h)249
752 y(v)n(ariable)c(in)h(the)h(sender)g(bu\013er)h(m)o(ust)d(matc)o(h)g
(the)i(t)o(yp)q(e)f(sp)q(eci\014ed)i(for)e(that)g(en)o(try)h(b)o(y)f
(the)249 806 y(send)j(op)q(eration.)32 b(The)18 b(t)o(yp)q(e)h(sp)q
(eci\014ed)h(b)o(y)e(the)h(send)g(op)q(eration)g(m)o(ust)e(matc)o(h)g
(the)i(t)o(yp)q(e)249 860 y(sp)q(eci\014ed)d(b)o(y)e(the)h(receiv)o(e)h
(op)q(eration.)j(Finally)m(,)12 b(the)j(t)o(yp)q(e)g(of)e(eac)o(h)i(v)n
(ariable)e(in)h(the)h(receiv)o(e)249 914 y(bu\013er)k(m)o(ust)d(matc)o
(h)g(the)i(t)o(yp)q(e)g(sp)q(eci\014ed)i(for)d(that)g(en)o(try)h(b)o(y)
g(the)g(receiv)o(e)h(op)q(eration.)28 b(A)249 968 y(program)12
b(that)i(fails)f(to)h(observ)o(e)h(these)g(rules)f(is)g(erroneous.)291
1022 y(T)m(o)j(de\014ne)h(t)o(yp)q(e)h(matc)o(hing)c(precisely)m(,)k(w)
o(e)f(need)h(to)e(deal)h(with)f(t)o(w)o(o)g(issues:)27
b(matc)o(hing)249 1076 y(of)17 b(t)o(yp)q(es)h(of)e(v)n(ariables)h(of)g
(the)g(host)h(language)e(with)h(t)o(yp)q(es)h(sp)q(eci\014ed)h(in)e
(comm)o(unicatio)o(n)249 1130 y(op)q(erations,)d(and)f(matc)o(hing)f
(of)i(t)o(yp)q(es)h(b)q(et)o(w)o(een)g(sender)g(and)f(receiv)o(er.)291
1184 y(The)j(t)o(yp)q(es)g(b)q(et)o(w)o(een)h(a)f(send)g(and)g(receiv)o
(e)h(matc)o(h)d(if)h(b)q(oth)h(op)q(erations)g(sp)q(ecify)g(iden)o(ti-)
249 1238 y(cal)e(t)o(yp)q(e)g(names.)21 b(That)14 b(is,)h
Fq(MPI)p 787 1238 12 2 v 13 w(INTEGER)f FA(matc)o(hes)h
Fq(MPI)p 1207 1238 V 13 w(INTEGER)p FA(,)f Fq(MPI)p 1477
1238 V 12 w(REAL)h FA(matc)o(hes)249 1292 y Fq(MPI)p
321 1292 V 13 w(REAL)p FA(,)d(and)i(so)g(on.)j(The)e(one)e(exception)i
(to)e(this)h(rule)g(is)g(that)f(the)i(t)o(yp)q(e)f Fq(MPI)p
1585 1292 V 12 w(P)m(A)o(CKED)249 1346 y FA(can)g(matc)o(h)f(an)o(y)g
(other)i(t)o(yp)q(e)f(\(Section)h(3.8\).)291 1400 y(The)h(t)o(yp)q(e)g
(of)f(a)g(v)n(ariable)f(matc)o(hes)h(the)i(t)o(yp)q(e)f(sp)q(eci\014ed)
h(in)e(the)h(comm)o(unication)c(op)q(era-)249 1454 y(tion)i(if)f(the)i
(datat)o(yp)q(e)g(name)e(used)i(b)o(y)f(that)g(op)q(eration)h(corresp)q
(onds)h(to)e(the)h(basic)f(t)o(yp)q(e)h(of)249 1508 y(the)i(host)g
(program)f(v)n(ariable.)25 b(F)m(or)16 b(example,)g(an)h(en)o(try)g
(with)f(t)o(yp)q(e)i(name)d Fq(MPI)p 1572 1508 V 13 w(INTEGER)249
1562 y FA(matc)o(hes)h(a)h(F)m(ortran)f(v)n(ariable)g(of)g(t)o(yp)q(e)h
Fr(INTEGER)p FA(.)e(T)m(ables)i(sho)o(wing)f(this)g(corresp)q(ondence)
249 1616 y(for)f(F)m(ortran)h(and)f(C)h(app)q(ear)g(in)f(Section)h
(2.2.2.)21 b(There)c(are)f(t)o(w)o(o)f(exceptions)i(to)e(this)h(rule:)
249 1670 y(an)c(en)o(try)h(with)f(t)o(yp)q(e)g(name)f
Fq(MPI)p 777 1670 V 13 w(BYTE)h FA(or)g Fq(MPI)p 1022
1670 V 13 w(P)m(A)o(CKED)e FA(can)i(b)q(e)h(used)g(to)f(matc)o(h)f(an)o
(y)h(b)o(yte)249 1724 y(of)18 b(storage)h(\(on)g(a)f(b)o
(yte-addressable)i(mac)o(hine\),)38 b(irresp)q(ectiv)o(e)20
b(of)e(the)h(datat)o(yp)q(e)g(of)f(the)249 1778 y(v)n(ariable)f(that)h
(con)o(tains)g(this)g(b)o(yte.)31 b(The)19 b(t)o(yp)q(e)f
Fq(MPI)p 1135 1778 V 13 w(BYTE)g FA(allo)o(ws)f(one)h(to)g(transfer)h
(the)249 1831 y(binary)e(v)n(alue)g(of)g(a)g(b)o(yte)h(in)f(memory)e
(unc)o(hanged.)30 b(The)18 b(t)o(yp)q(e)g Fq(MPI)p 1387
1831 V 12 w(P)m(A)o(CKED)e FA(is)h(used)i(to)249 1885
y(send)c(data)f(that)g(has)g(b)q(een)h(explicitly)e(pac)o(k)o(ed)h
(with)g(calls)f(to)h Fw(MPI)p 1333 1885 13 2 v 14 w(P)m(A)o(CK)p
FA(,)e(or)i(receiv)o(e)h(data)249 1939 y(that)f(will)e(b)q(e)j
(explicitly)e(unpac)o(k)o(ed)h(with)g(calls)f(to)h Fw(MPI)p
1152 1939 V 14 w(UNP)m(A)o(CK)e FA(\(Section)i(3.8\).)291
1993 y(The)g(follo)o(wing)d(examples)i(illustrate)h(t)o(yp)q(e)g(matc)o
(hing.)249 2076 y Fs(Example)h(2.3)21 b FA(Sender)15
b(and)f(receiv)o(er)h(sp)q(ecify)g(matc)o(hing)d(t)o(yp)q(es.)249
2130 y Fr(CALL)21 b(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))249
2184 y(IF)g(\(rank.EQ.0\))f(THEN)336 2238 y(CALL)h(MPI_SEND\(a\(1\),)e
(10,)i(MPI_REAL,)f(1,)i(tag,)f(comm,)f(ierr\))249 2292
y(ELSE)h(IF)g(\(rank.EQ.1\))f(THEN)336 2346 y(CALL)h(MPI_RECV\(b\(1\),)
e(15,)i(MPI_REAL,)f(0,)i(tag,)f(comm,)f(status,)h(ierr\))249
2400 y(END)g(IF)p eop
%%Page: 28 42
28 41 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(28)1275 b(Chapter)13 b(2)249 507
y FA(This)k(co)q(de)h(is)e(correct)j(if)d(b)q(oth)h Fw(a)g
FA(and)g Fw(b)g FA(are)g(real)g(arra)o(ys)g(of)g(size)g
Ft(\025)g FA(10.)27 b(\(In)17 b(F)m(ortran,)g(it)249
561 y(migh)o(t)12 b(b)q(e)j(correct)h(to)e(use)h(this)g(co)q(de)g(ev)o
(en)g(if)e Fw(a)h FA(or)h Fw(b)f FA(ha)o(v)o(e)g(size)h
Fp(<)e FA(10,)g(e.g.,)g Fw(a\(1\))i FA(migh)o(t)d(b)q(e)249
615 y(b)q(e)j(equiv)n(alenced)f(to)f(an)h(arra)o(y)g(with)f(ten)i
(reals.\))249 711 y Fs(Example)g(2.4)21 b FA(Sender)15
b(and)f(receiv)o(er)h(do)f(not)g(sp)q(ecify)g(matc)o(hing)e(t)o(yp)q
(es.)249 765 y Fr(CALL)21 b(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))
249 819 y(IF)g(\(rank.EQ.0\))f(THEN)336 873 y(CALL)h(MPI_SEND\(a\(1\),)
e(10,)i(MPI_REAL,)f(1,)i(tag,)f(comm,)f(ierr\))249 927
y(ELSE)h(IF)g(\(rank.EQ.1\))f(THEN)336 981 y(CALL)h(MPI_RECV\(b\(1\),)e
(40,)i(MPI_BYTE,)f(0,)i(tag,)f(comm,)f(status,)h(ierr\))249
1034 y(END)g(IF)249 1142 y FA(This)12 b(co)q(de)h(is)f(erroneous,)h
(since)g(sender)h(and)e(receiv)o(er)h(do)f(not)g(pro)o(vide)g(matc)o
(hing)e(datat)o(yp)q(e)249 1196 y(argumen)o(ts.)249 1292
y Fs(Example)15 b(2.5)21 b FA(Sender)15 b(and)f(receiv)o(er)h(sp)q
(ecify)g(comm)o(unicati)o(on)c(of)i(un)o(t)o(yp)q(ed)i(v)n(alues.)249
1346 y Fr(CALL)21 b(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))249
1400 y(IF)g(\(rank.EQ.0\))f(THEN)336 1454 y(CALL)h(MPI_SEND\(a\(1\),)e
(40,)i(MPI_BYTE,)f(1,)i(tag,)f(comm,)f(ierr\))249 1508
y(ELSE)h(IF)g(\(rank.EQ.1\))f(THEN)336 1562 y(CALL)h(MPI_RECV\(b\(1\),)
e(60,)i(MPI_BYTE,)f(0,)i(tag,)f(comm,)f(status,)h(ierr\))249
1616 y(END)g(IF)249 1724 y FA(This)13 b(co)q(de)h(is)e(correct,)j
(irresp)q(ectiv)o(e)g(of)d(the)h(t)o(yp)q(e)h(and)f(size)g(of)g
Fw(a)f FA(and)h Fw(b)g FA(\(unless)h(this)f(results)249
1778 y(in)g(an)h(out)g(of)f(b)q(ound)h(memory)e(access\).)249
1873 y Fs(T)o(yp)q(e)21 b Fq(MPI)p 449 1873 12 2 v 12
w(CHARA)o(CTER)40 b FA(The)19 b(t)o(yp)q(e)g Fq(MPI)p
986 1873 V 13 w(CHARA)o(CTER)d FA(matc)o(hes)i(one)g(c)o(haracter)i(of)
e(a)249 1927 y(F)m(ortran)d(v)n(ariable)e(of)h(t)o(yp)q(e)h
Fr(CHARACTER)p FA(,)d(rather)k(then)f(the)g(en)o(tire)h(c)o(haracter)g
(string)e(stored)249 1981 y(in)h(the)g(v)n(ariable.)20
b(F)m(ortran)15 b(v)n(ariables)f(of)h(t)o(yp)q(e)g Fr(CHARACTER)e
FA(or)i(substrings)h(are)g(transferred)249 2035 y(as)e(if)f(they)h(w)o
(ere)h(arra)o(ys)f(of)g(c)o(haracters.)19 b(This)14 b(is)g(illustrated)
g(in)f(the)h(example)f(b)q(elo)o(w.)249 2130 y Fs(Example)i(2.6)21
b FA(T)m(ransfer)14 b(of)f(F)m(ortran)h Fr(CHARACTER)p
FA(s.)249 2184 y Fr(CHARACTER*10)19 b(a)249 2238 y(CHARACTER*10)g(b)249
2346 y(CALL)i(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))249
2400 y(IF)g(\(rank.EQ.0\))f(THEN)336 2454 y(CALL)h(MPI_SEND\(a,)f(5,)h
(MPI_CHARACTER,)e(1,)i(tag,)g(comm,)g(ierr\))249 2508
y(ELSE)g(IF)g(\(rank.EQ.1\))f(THEN)p eop
%%Page: 29 43
29 42 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(29)336 507 y Fr(CALL)21 b(MPI_RECV\(b\(6:10\),5)o(,MPI_)o(CHARA)o
(CTER,)o(0,tag)o(,comm)o(,sta)o(tus,i)o(err\))249 561
y(END)g(IF)249 669 y FA(The)15 b(last)g(\014v)o(e)f(c)o(haracters)j(of)
d(string)h Fq(b)f FA(at)h(pro)q(cess)h(1)f(are)g(replaced)g(b)o(y)g
(the)g(\014rst)g(\014v)o(e)g(c)o(har-)249 723 y(acters)g(of)f(string)g
Fq(a)g FA(at)g(pro)q(cess)h(0.)249 819 y FB(A)n(dvic)n(e)20
b(to)h(users.)72 b FA(If)19 b(a)h(bu\013er)g(of)g(t)o(yp)q(e)g
Fq(MPI)p 1058 819 12 2 v 13 w(BYTE)f FA(is)h(passed)h(as)e(an)h
(argumen)o(t)f(to)249 873 y Fw(MPI)p 326 873 13 2 v 14
w(SEND)p FA(,)f(then)g Fw(MPI)f FA(will)f(send)i(the)g(data)g(stored)g
(at)g(con)o(tiguous)f(lo)q(cations,)g(starting)249 927
y(from)10 b(the)j(address)g(indicated)f(b)o(y)g(the)h
Fw(buf)f FA(argumen)o(t.)k(This)c(ma)o(y)e(ha)o(v)o(e)i(unexp)q(ected)i
(results)249 981 y(when)i(the)g(data)f(la)o(y)o(out)f(is)i(not)f(as)h
(a)f(casual)g(user)i(w)o(ould)d(exp)q(ect)j(it)e(to)h(b)q(e.)23
b(F)m(or)15 b(example,)249 1034 y(some)d(F)m(ortran)h(compilers)e
(implemen)o(t)f(v)n(ariables)j(of)f(t)o(yp)q(e)h Fr(CHARACTER)e
FA(as)i(a)f(structure)j(that)249 1088 y(con)o(tains)g(the)h(c)o
(haracter)h(length)e(and)g(a)g(p)q(oin)o(ter)g(to)h(the)f(actual)g
(string.)23 b(In)15 b(suc)o(h)h(an)f(en)o(vi-)249 1142
y(ronmen)o(t,)d(sending)i(and)g(receiving)g(a)f(F)m(ortran)h
Fr(CHARACTER)e FA(v)n(ariable)g(using)i(the)g Fq(MPI)p
1632 1142 12 2 v 13 w(BYTE)249 1196 y FA(t)o(yp)q(e)j(will)d(not)i(ha)o
(v)o(e)g(the)h(an)o(ticipated)e(result)i(of)f(transferring)g(the)h(c)o
(haracter)g(string.)25 b(F)m(or)249 1250 y(this)18 b(reason,)g(the)g
(user)h(is)f(advised)f(to)h(use)g(t)o(yp)q(ed)g(comm)o(unications)d
(whenev)o(er)k(p)q(ossible.)249 1304 y(\()p FB(End)d(of)f(advic)n(e)g
(to)g(users.)p FA(\))249 1396 y FB(R)n(ationale.)59 b
FA(Wh)o(y)17 b(do)q(es)i Fw(MPI)e FA(force)h(the)g(user)h(to)e(sp)q
(ecify)h(datat)o(yp)q(es?)30 b(After)18 b(all,)f(t)o(yp)q(e)249
1450 y(information)11 b(is)j(a)o(v)n(ailable)d(in)j(the)g(source)i
(program.)249 1520 y Fw(MPI)e FA(is)h(mean)o(t)f(to)h(b)q(e)h(implemen)
o(ted)d(as)i(a)g(library)m(,)e(with)i(no)g(need)h(for)f(additional)e
(prepro-)249 1574 y(cessing)18 b(or)f(compilation.)24
b(Th)o(us,)17 b(one)h(cannot)f(assume)f(that)h(a)g(comm)o(unicati)o(on)
d(call)i(has)249 1628 y(information)c(on)i(the)h(datat)o(yp)q(e)g(of)f
(v)n(ariables)g(in)g(the)h(comm)o(unication)d(bu\013er.)21
b(This)14 b(infor-)249 1682 y(mation)g(m)o(ust)g(b)q(e)j(supplied)e(at)
h(calling)e(time,)h(either)h(b)o(y)g(calling)e(a)i(di\013eren)o(t)g
(function)g(for)249 1736 y(eac)o(h)i(datat)o(yp)q(e,)g(or)f(b)o(y)g
(passing)h(the)g(datat)o(yp)q(e)f(information)e(as)i(an)g(explicit)g
(parameter.)249 1790 y(Datat)o(yp)q(e)c(information)d(is)j(needed)i
(for)e(heterogeneous)i(supp)q(ort)f(and)f(is)g(further)h(discussed)249
1844 y(in)f(Section)i(2.3.2.)249 1914 y(F)m(utures)g(extensions)g(of)e
Fw(MPI)h FA(migh)o(t)e(tak)o(e)i(adv)n(an)o(tage)f(of)g(p)q
(olymorphism)e(in)i(C++)i(or)f(F)m(or-)249 1968 y(tran)g(90)f(in)h
(order)h(to)e(pass)i(the)f(datat)o(yp)q(e)g(information)d(implicitly)m
(.)k(\()p FB(End)g(of)g(r)n(ationale.)p FA(\))249 2060
y FB(A)n(dvic)n(e)g(to)f(implementors.)36 b FA(Some)13
b(compilers)f(pass)j(F)m(ortran)e Fr(CHARACTER)f FA(argumen)o(ts)h(as)h
(a)249 2114 y(structure)h(with)d(a)g(length)h(and)f(a)g(p)q(oin)o(ter)h
(to)f(the)h(actual)f(string.)18 b(In)12 b(suc)o(h)i(an)e(en)o(vironmen)
o(t,)249 2168 y Fw(MPI)e FA(send)h(or)g(receiv)o(e)h(calls)e(need)h(to)
f(dereference)k(the)d(p)q(oin)o(ter)g(in)f(order)h(to)f(reac)o(h)i(the)
f(string.)249 2222 y(\()p FB(End)16 b(of)f(advic)n(e)g(to)g
(implementors.)p FA(\))249 2313 y Fs(2.3.2)48 b(Data)15
b(Con)o(v)o(ersion)249 2396 y FA(One)h(of)f(the)h(goals)f(of)g
Fw(MPI)g FA(is)g(to)g(supp)q(ort)i(parallel)d(computations)g(across)i
(heterogeneous)249 2450 y(en)o(vironmen)o(ts.)24 b(Comm)o(uni)o(cation)
13 b(in)j(a)g(heterogeneous)i(en)o(vironmen)o(t)d(ma)o(y)f(require)j
(data)249 2504 y(con)o(v)o(ersions.)i(W)m(e)13 b(use)i(the)f(follo)o
(wing)e(terminology)m(.)p eop
%%Page: 30 44
30 43 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(30)1275 b(Chapter)13 b(2)249 507
y Fs(T)o(yp)q(e)j(con)o(v)o(ersion)i FA(c)o(hanges)g(the)h(datat)o(yp)q
(e)f(of)f(a)h(v)n(alue,)f(for)h(example,)f(b)o(y)g(rounding)h(a)249
561 y Fr(REAL)13 b FA(to)h(an)f Fr(INTEGER)p FA(.)249
632 y Fs(Represen)o(tati)o(on)g(con)o(v)o(ersion)18 b
FA(c)o(hanges)j(the)f(binary)g(represen)o(tation)i(of)e(a)g(v)n(alue,)h
(for)249 686 y(example,)10 b(c)o(hanging)g(b)o(yte)h(ordering,)g(or)g
(c)o(hanging)f(32-bit)g(\015oating)g(p)q(oin)o(t)h(to)f(64-bit)g
(\015oating)249 740 y(p)q(oin)o(t.)291 823 y(The)19 b(t)o(yp)q(e)g
(matc)o(hing)e(rules)j(imply)c(that)j Fw(MPI)g FA(comm)o(unicati)o(ons)
d(nev)o(er)k(do)f(t)o(yp)q(e)g(con-)249 877 y(v)o(ersion.)38
b(On)21 b(the)g(other)g(hand,)h Fw(MPI)d FA(requires)j(that)f(a)f
(represen)o(tation)i(con)o(v)o(ersion)f(b)q(e)249 931
y(p)q(erformed)12 b(when)i(a)e(t)o(yp)q(ed)h(v)n(alue)f(is)h
(transferred)h(across)f(en)o(vironmen)o(ts)f(that)h(use)g(di\013eren)o
(t)249 985 y(represen)o(tations)j(for)e(suc)o(h)g(a)g(v)n(alue.)j
Fw(MPI)d FA(do)q(es)g(not)g(sp)q(ecify)h(the)f(detailed)g(rules)h(for)e
(repre-)249 1039 y(sen)o(tation)i(con)o(v)o(ersion.)23
b(Suc)o(h)15 b(a)g(con)o(v)o(ersion)h(is)f(exp)q(ected)i(to)e(preserv)o
(e)i(in)o(teger,)f(logical)d(or)249 1093 y(c)o(haracter)h(v)n(alues,)d
(and)h(to)g(con)o(v)o(ert)h(a)f(\015oating)f(p)q(oin)o(t)g(v)n(alue)h
(to)f(the)i(nearest)h(v)n(alue)d(that)h(can)249 1147
y(b)q(e)j(represen)o(ted)h(on)e(the)g(target)h(system.)291
1201 y(Ov)o(er\015o)o(w)f(and)f(under\015o)o(w)h(exceptions)h(ma)o(y)d
(o)q(ccur)i(during)g(\015oating)e(p)q(oin)o(t)h(con)o(v)o(ersions.)267
1254 y(Con)o(v)o(ersion)e(of)h(in)o(tegers)g(or)g(c)o(haracters)i(ma)o
(y)c(also)h(lead)h(to)f(exceptions)i(when)g(a)e(v)n(alue)g(that)249
1308 y(can)16 b(b)q(e)h(represen)o(ted)h(in)e(one)g(system)f(cannot)h
(b)q(e)h(represen)o(ted)h(in)e(the)g(other)h(system.)23
b(An)249 1362 y(exception)12 b(o)q(ccurring)g(during)f(represen)o
(tation)i(con)o(v)o(ersion)e(results)h(in)f(a)g(failure)f(of)h(the)h
(com-)249 1416 y(m)o(unication.)k(An)d(error)h(o)q(ccurs)h(either)f(in)
f(the)h(send)g(op)q(eration,)e(or)i(the)f(receiv)o(e)i(op)q(eration,)
249 1470 y(or)f(b)q(oth.)291 1524 y(If)i(a)h(v)n(alue)f(sen)o(t)i(in)e
(a)h(message)f(is)h(un)o(t)o(yp)q(ed)g(\(i.e.,)g(of)f(t)o(yp)q(e)h
Fq(MPI)p 1350 1524 12 2 v 13 w(BYTE)p FA(\),)33 b(then)18
b(the)f(bi-)249 1578 y(nary)i(represen)o(tation)i(of)d(the)i(b)o(yte)g
(stored)g(at)f(the)h(receiv)o(er)h(is)e(iden)o(tical)f(to)h(the)h
(binary)249 1632 y(represen)o(tation)e(of)e(the)h(b)o(yte)f(loaded)g
(at)g(the)h(sender.)27 b(This)17 b(holds)f(true,)h(whether)h(sender)249
1686 y(and)e(receiv)o(er)h(run)f(in)g(the)g(same)f(or)h(in)f(distinct)h
(en)o(vironmen)o(ts.)23 b(No)16 b(represen)o(tation)h(con-)249
1740 y(v)o(ersion)i(is)g(done.)33 b(Note)20 b(that)e(represen)o(tation)
j(con)o(v)o(ersion)e(ma)o(y)e(o)q(ccur)j(when)f(v)n(alues)g(of)249
1794 y(t)o(yp)q(e)12 b Fq(MPI)p 412 1794 V 13 w(CHARA)o(CTER)e
FA(or)i Fq(MPI)p 781 1794 V 13 w(CHAR)e FA(are)j(transferred,)g(for)e
(example,)g(from)f(an)h(EBCDIC)249 1848 y(enco)q(ding)j(to)g(an)g(ASCI)
q(I)g(enco)q(ding.)291 1902 y(No)k(represen)o(tation)i(con)o(v)o
(ersion)e(need)i(o)q(ccur)f(when)g(an)g Fw(MPI)e FA(program)g(executes)
k(in)d(a)249 1956 y(homogeneous)13 b(system,)g(where)i(all)e(pro)q
(cesses)j(run)f(in)e(the)i(same)e(en)o(vironmen)o(t.)291
2010 y(Consider)e(the)g(three)h(examples,)e(2.3{2.5.)15
b(The)c(\014rst)h(program)d(is)i(correct,)h(assuming)d(that)249
2064 y Fw(a)k FA(and)g Fw(b)g FA(are)g Fr(REAL)f FA(arra)o(ys)h(of)g
(size)g Ft(\025)f FA(10.)17 b(If)c(the)g(sender)i(and)e(receiv)o(er)h
(execute)h(in)d(di\013eren)o(t)249 2118 y(en)o(vironmen)o(ts,)g(then)h
(the)g(ten)g(real)f(v)n(alues)g(that)g(are)h(fetc)o(hed)h(from)c(the)j
(send)h(bu\013er)f(will)e(b)q(e)249 2172 y(con)o(v)o(erted)k(to)e(the)h
(represen)o(tation)h(for)f(reals)g(on)f(the)h(receiv)o(er)h(site)f(b)q
(efore)g(they)g(are)g(stored)249 2226 y(in)k(the)h(receiv)o(e)h
(bu\013er.)32 b(While)18 b(the)h(n)o(um)o(b)q(er)f(of)g(real)g(elemen)o
(ts)g(fetc)o(hed)i(from)c(the)k(send)249 2280 y(bu\013er)13
b(equal)f(the)h(n)o(um)o(b)q(er)f(of)f(real)i(elemen)o(ts)f(stored)h
(in)f(the)h(receiv)o(e)g(bu\013er,)h(the)e(n)o(um)o(b)q(er)g(of)249
2334 y(b)o(ytes)k(stored)g(need)g(not)f(equal)g(the)h(n)o(um)o(b)q(er)e
(of)h(b)o(ytes)g(loaded.)22 b(F)m(or)14 b(example,)g(the)i(sender)249
2388 y(ma)o(y)f(use)i(a)g(four)f(b)o(yte)h(represen)o(tation)h(and)f
(the)g(receiv)o(er)h(an)e(eigh)o(t)h(b)o(yte)g(represen)o(tation)249
2442 y(for)d(reals.)291 2496 y(The)g(second)h(program)d(is)i
(erroneous,)h(and)e(its)h(b)q(eha)o(vior)g(is)g(unde\014ned.)p
eop
%%Page: 31 45
31 44 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(31)291 507 y FA(The)14 b(third)g(program)e(is)i(correct.)20
b(The)15 b(exact)f(same)g(sequence)i(of)d(fort)o(y)h(b)o(ytes)g(that)g
(w)o(ere)249 561 y(loaded)g(from)e(the)j(send)g(bu\013er)g(will)e(b)q
(e)i(stored)g(in)f(the)g(receiv)o(e)i(bu\013er,)f(ev)o(en)f(if)g
(sender)i(and)249 615 y(receiv)o(er)j(run)f(in)g(a)f(di\013eren)o(t)i
(en)o(vironmen)o(t.)28 b(The)18 b(message)g(sen)o(t)g(has)g(exactly)g
(the)g(same)249 669 y(length)e(\(in)g(b)o(ytes\))i(and)e(the)h(same)e
(binary)h(represen)o(tation)i(as)f(the)g(message)f(receiv)o(ed.)27
b(If)249 723 y Fw(a)17 b FA(and)g Fw(b)g FA(are)h(of)e(di\013eren)o(t)i
(t)o(yp)q(es,)g(or)f(if)g(they)g(are)h(of)e(the)i(same)e(t)o(yp)q(e)h
(but)h(di\013eren)o(t)g(data)249 777 y(represen)o(tations)k(are)e
(used,)h(then)g(the)f(bits)g(stored)g(in)f(the)i(receiv)o(e)g(bu\013er)
f(ma)o(y)e(enco)q(de)249 831 y(v)n(alues)c(that)g(are)g(di\013eren)o(t)
h(from)d(the)i(v)n(alues)g(they)g(enco)q(ded)i(in)d(the)i(send)f
(bu\013er.)291 885 y(Represen)o(tation)f(con)o(v)o(ersion)g(also)e
(applies)h(to)h(the)g(en)o(v)o(elop)q(e)g(of)e(a)h(message.)18
b(The)13 b(source,)249 939 y(destination)h(and)f(tag)h(are)g(all)f(in)o
(tegers)i(that)f(ma)o(y)e(need)i(to)g(b)q(e)h(con)o(v)o(erted.)291
993 y Fw(MPI)g FA(do)q(es)i(not)e(require)i(supp)q(ort)g(for)e(in)o
(ter-language)h(comm)o(uni)o(cation.)21 b(The)c(b)q(eha)o(vior)249
1047 y(of)f(a)h(program)e(is)i(unde\014ned)h(if)d(messages)i(are)g(sen)
o(t)h(b)o(y)f(a)f(C)h(pro)q(cess)h(and)f(receiv)o(ed)h(b)o(y)f(a)249
1101 y(F)m(ortran)d(pro)q(cess,)h(or)f(vice-v)o(ersa.)249
1184 y Fs(2.3.3)48 b(Commen)o(ts)14 b(on)i(Data)f(Con)o(v)o(ersion)249
1267 y FB(R)n(ationale.)41 b Fw(MPI)13 b FA(do)q(es)j(not)e(handle)g
(in)o(ter-language)g(comm)o(unication)d(b)q(ecause)16
b(there)g(are)249 1321 y(no)j(agreed-up)q(on)h(standards)g(for)f(the)h
(corresp)q(ondence)i(b)q(et)o(w)o(een)f(C)e(t)o(yp)q(es)h(and)g(F)m
(ortran)249 1375 y(t)o(yp)q(es.)37 b(Therefore,)23 b
Fw(MPI)c FA(applications)g(that)h(mix)e(languages)h(w)o(ould)g(not)h(b)
q(e)h(p)q(ortable.)249 1429 y(V)m(endors)10 b(are)g(exp)q(ected)i(to)d
(pro)o(vide)g(in)o(ter-language)g(comm)o(unication)d(consisten)o(t)11
b(with)e(their)249 1483 y(supp)q(ort)15 b(for)e(in)o(ter-language)g
(pro)q(cedure)j(in)o(v)o(o)q(cation.)h(\()p FB(End)f(of)e(r)n
(ationale.)p FA(\))249 1574 y FB(A)n(dvic)n(e)k(to)f(implementors.)55
b FA(The)17 b(datat)o(yp)q(e)g(matc)o(hing)e(rules)j(do)f(not)g
(require)g(messages)249 1628 y(to)g(carry)g(data)f(t)o(yp)q(e)i
(information.)24 b(Both)17 b(sender)h(and)f(receiv)o(er)h(pro)o(vide)f
(complete)f(data)249 1682 y(t)o(yp)q(e)h(information.)22
b(In)16 b(a)g(heterogeneous)i(en)o(vironmen)o(t,)d(one)h(can)h(either)g
(use)g(a)f(mac)o(hine)249 1736 y(indep)q(enden)o(t)h(enco)q(ding)f(suc)
o(h)g(as)f(XDR,)g(or)g(ha)o(v)o(e)h(the)g(receiv)o(er)h(con)o(v)o(ert)f
(from)e(the)i(sender)249 1790 y(represen)o(tation)g(to)d(its)h(o)o(wn,)
f(or)h(ev)o(en)h(ha)o(v)o(e)e(the)i(sender)g(do)f(the)g(con)o(v)o
(ersion.)249 1861 y(Additional)19 b(t)o(yp)q(e)h(information)d(migh)o
(t)h(b)q(e)i(added)h(to)f(messages)g(in)f(order)i(to)f(allo)o(w)e(the)
249 1914 y(system)13 b(to)g(detect)j(misma)o(tc)o(hes)c(b)q(et)o(w)o
(een)j(datat)o(yp)q(e)e(at)h(sender)h(and)e(receiv)o(er.)19
b(This)14 b(migh)o(t)249 1968 y(b)q(e)h(particularly)e(useful)h(in)f(a)
h(slo)o(w)o(er)g(but)g(safer)g(debug)g(mo)q(de)f(for)h
Fw(MPI)p FA(.)249 2039 y(Although)g Fw(MPI)g FA(do)q(es)i(not)e(sp)q
(ecify)i(in)o(terfaces)f(b)q(et)o(w)o(een)h(C)f(and)g(F)m(ortran,)f(v)o
(endors)h(are)g(ex-)249 2093 y(p)q(ected)e(to)e(pro)o(vide)g(suc)o(h)i
(in)o(terfaces,)f(so)f(as)h(to)f(allo)o(w)f(F)m(ortran)h(programs)f(to)
h(in)o(v)o(ok)o(e)g(parallel)249 2147 y(libraries)19
b(written)g(in)f(C,)h(or)f(comm)o(unicate)f(with)h(serv)o(ers)j
(running)e(C)f(co)q(des)i(\(and)f(vice-)249 2201 y(v)o(ersa\).)j
(Initialization)12 b(for)j(F)m(ortran)f(and)h(C)g(should)f(b)q(e)i
(compatible,)d(mec)o(hanisms)g(should)249 2255 y(b)q(e)i(pro)o(vided)f
(for)f(passing)h Fw(MPI)f FA(ob)r(jects)i(as)f(parameters)g(in)g(in)o
(terlanguage)f(pro)q(cedural)i(in-)249 2309 y(v)o(o)q(cations,)h(and)g
(in)o(ter-language)g(comm)o(uni)o(cation)d(should)j(b)q(e)h(supp)q
(orted.)26 b(F)m(or)16 b(example,)249 2363 y(consider)j(a)e(system)g
(where)i(a)e(F)m(ortran)h(caller)f(can)h(pass)g(an)f
Fr(INTEGER)g FA(actual)g(parameter)249 2417 y(to)e(a)f(C)h(routine)f
(with)h(an)f Fr(int)g FA(formal)e(parameter.)20 b(In)15
b(suc)o(h)h(a)e(system)g(a)h(F)m(ortran)f(routine)249
2471 y(should)g(b)q(e)h(able)g(to)f(send)h(a)f(message)h(with)f(datat)o
(yp)q(e)g Fq(MPI)p 1210 2471 12 2 v 13 w(INTEGER)g FA(to)h(b)q(e)g
(receiv)o(ed)g(b)o(y)g(a)p eop
%%Page: 32 46
32 45 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(32)1275 b(Chapter)13 b(2)249 507
y FA(C)h(routine)g(with)g(datat)o(yp)q(e)g Fq(MPI)p 777
507 12 2 v 12 w(INT)p FA(.)28 b(\()p FB(End)15 b(of)g(advic)n(e)g(to)g
(implementors.)p FA(\))249 628 y FD(2.4)52 b(Seman)o(tics)18
b(of)f(Blo)q(c)o(king)i(P)o(oin)o(t-to-p)q(oin)o(t)249
736 y FA(This)14 b(section)g(describ)q(es)i(the)e(main)d(prop)q(erties)
k(of)e(the)i(send)f(and)g(receiv)o(e)g(calls)g(in)o(tro)q(duced)249
790 y(in)f(Section)g(2.2.)k(In)o(terested)e(readers)g(can)e(\014nd)h(a)
f(more)f(formal)e(treatmen)o(t)j(of)g(the)h(issues)g(in)249
844 y(this)g(section)h(in)e([10)o(].)249 927 y Fs(2.4.1)48
b(Bu\013ering)13 b(and)j(Safet)o(y)249 1010 y FA(The)h(receiv)o(e)h
(describ)q(ed)h(in)d(Section)h(2.2.5)e(can)i(b)q(e)h(started)f(whether)
h(or)f(not)g(a)f(matc)o(hing)249 1064 y(send)h(has)g(b)q(een)g(p)q
(osted.)26 b(That)17 b(v)o(ersion)f(of)g(receiv)o(e)h(is)f
Fs(blo)q(c)o(king)p FA(.)23 b(It)17 b(returns)h(only)d(after)249
1117 y(the)i(receiv)o(e)g(bu\013er)g(con)o(tains)f(the)g(newly)g
(receiv)o(ed)h(message.)24 b(A)16 b(receiv)o(e)h(could)f(complete)249
1171 y(b)q(efore)f(the)g(matc)o(hing)e(send)i(has)g(completed)f(\(of)g
(course,)i(it)e(can)g(complete)g(only)g(after)h(the)249
1225 y(matc)o(hing)d(send)j(has)f(started\).)291 1279
y(The)i(send)i(op)q(eration)e(describ)q(ed)i(in)e(Section)h(2.2.1)d
(can)j(b)q(e)g(started)g(whether)h(or)e(not)h(a)249 1333
y(matc)o(hing)d(receiv)o(e)i(has)g(b)q(een)g(p)q(osted.)24
b(That)15 b(v)o(ersion)g(of)g(send)i(is)e Fs(blo)q(c)o(king)p
FA(.)20 b(It)15 b(do)q(es)i(not)249 1387 y(return)g(un)o(til)f(the)g
(message)g(data)g(and)g(en)o(v)o(elop)q(e)h(ha)o(v)o(e)f(b)q(een)h
(safely)f(stored)h(a)o(w)o(a)o(y)e(so)h(that)249 1441
y(the)j(sender)g(is)f(free)g(to)g(access)i(and)e(o)o(v)o(erwrite)g(the)
g(send)h(bu\013er.)31 b(The)18 b(send)h(call)e(is)h(also)249
1495 y(p)q(oten)o(tially)e Fs(non-lo)q(cal)p FA(.)27
b(The)18 b(message)f(migh)o(t)f(b)q(e)i(copied)g(directly)f(in)o(to)g
(the)h(matc)o(hing)249 1549 y(receiv)o(e)g(bu\013er,)f(or)g(it)f(migh)o
(t)e(b)q(e)j(copied)g(in)o(to)f(a)g(temp)q(orary)f(system)i(bu\013er.)
26 b(In)17 b(the)g(\014rst)249 1603 y(case,)d(the)g(send)g(call)f(will)
f(not)h(complete)g(un)o(til)f(a)h(matc)o(hing)e(receiv)o(e)k(call)e(o)q
(ccurs,)h(and)f(so,)g(if)249 1657 y(the)f(sending)g(pro)q(cess)h(is)e
(single-threaded,)h(then)g(it)f(will)f(b)q(e)i(blo)q(c)o(k)o(ed)f(un)o
(til)f(this)i(time.)k(In)11 b(the)249 1711 y(second)i(case,)g(the)g
(send)g(call)e(ma)o(y)f(return)j(ahead)f(of)g(the)g(matc)o(hing)f
(receiv)o(e)i(call,)e(allo)o(wing)f(a)249 1765 y(single-threaded)i(pro)
q(cess)h(to)e(con)o(tin)o(ue)g(with)g(its)g(computation.)16
b(The)11 b Fw(MPI)g FA(implemen)o(tatio)o(n)249 1819
y(ma)o(y)h(mak)o(e)h(either)i(of)f(these)i(c)o(hoices.)k(It)14
b(migh)o(t)e(blo)q(c)o(k)i(the)h(sender)h(or)e(it)g(migh)o(t)f
(bu\013er)i(the)249 1873 y(data.)291 1927 y(Message)j(bu\013ering)f
(decouples)h(the)f(send)h(and)f(receiv)o(e)h(op)q(erations.)28
b(A)17 b(blo)q(c)o(king)f(send)249 1981 y(migh)o(t)e(complete)h(as)h
(so)q(on)g(as)g(the)g(message)g(w)o(as)g(bu\013ered,)h(ev)o(en)f(if)f
(no)h(matc)o(hing)e(receiv)o(e)249 2035 y(has)i(b)q(een)i(executed)g(b)
o(y)e(the)h(receiv)o(er.)26 b(On)17 b(the)g(other)g(hand,)f(message)g
(bu\013ering)g(can)h(b)q(e)249 2089 y(exp)q(ensiv)o(e,)e(as)g(it)f(en)o
(tails)g(additional)e(memory-to-m)o(em)o(ory)f(cop)o(ying,)j(and)g(it)g
(requires)i(the)249 2143 y(allo)q(cation)c(of)i(memory)d(for)j
(bu\013ering.)k(The)c(c)o(hoice)h(of)e(the)i(righ)o(t)e(amoun)o(t)f(of)
h(bu\013er)i(space)249 2197 y(to)e(allo)q(cate)h(for)f(comm)o(unicatio)
o(n)e(and)i(of)g(the)h(bu\013ering)g(p)q(olicy)f(to)h(use)g(is)f
(application)g(and)249 2251 y(implemen)o(tation)g(dep)q(enden)o(t.)26
b(Therefore,)18 b Fw(MPI)e FA(o\013ers)h(the)g(c)o(hoice)f(of)g(sev)o
(eral)h(comm)o(uni-)249 2305 y(cation)e(mo)q(des)f(that)h(allo)o(w)f
(one)h(to)g(con)o(trol)g(the)h(c)o(hoice)f(of)g(the)g(comm)o(unication)
d(proto)q(col.)249 2359 y(Mo)q(des)i(are)f(describ)q(ed)i(in)25
b(Section)13 b(2.13.)k(The)c(c)o(hoice)h(of)e(a)h(bu\013ering)g(p)q
(olicy)f(for)h(the)g(stan-)249 2413 y(dard)j(mo)q(de)f(send)i(describ)q
(ed)h(in)32 b(Section)16 b(2.2.1)e(is)i(left)g(to)g(the)h(implemen)o
(tati)o(on.)22 b(In)16 b(an)o(y)249 2467 y(case,)e(lac)o(k)e(of)g
(bu\013er)i(space)f(will)f(not)g(cause)i(a)f(standard)g(send)g(call)f
(to)h(fail,)e(but)i(will)e(merely)p eop
%%Page: 33 47
33 46 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(33)249 507 y FA(cause)19 b(it)f(to)f(blo)q(c)o(k.)30
b(In)18 b(w)o(ell-constructed)h(programs,)f(this)g(results)h(in)e(a)h
(useful)g(throttle)249 561 y(e\013ect.)j(Consider)15
b(a)f(situation)f(where)j(a)e(pro)q(ducer)h(rep)q(eatedly)h(pro)q
(duces)g(new)f(v)n(alues)f(and)249 615 y(sends)i(them)f(to)g(a)g
(consumer.)21 b(Assume)15 b(that)g(the)h(pro)q(ducer)h(pro)q(duces)f
(new)g(v)n(alues)f(faster)249 669 y(than)h(the)h(consumer)f(can)g
(consume)g(them.)23 b(If)16 b(standard)g(sends)i(are)e(used,)h(then)g
(the)g(pro-)249 723 y(ducer)d(will)e(b)q(e)i(automatically)c
(throttled,)j(as)g(its)g(send)h(op)q(erations)f(will)f(blo)q(c)o(k)h
(when)g(bu\013er)249 777 y(space)i(is)f(una)o(v)n(ailable.)291
831 y(In)c(ill-constructed)h(programs,)e(blo)q(c)o(king)h(ma)o(y)e
(lead)i(to)g(a)g Fs(deadlo)q(c)o(k)f FA(situation,)h(where)i(all)249
885 y(pro)q(cesses)k(are)e(blo)q(c)o(k)o(ed,)f(and)h(no)f(progress)i(o)
q(ccurs.)k(Suc)o(h)14 b(programs)e(ma)o(y)g(complete)h(when)249
939 y(su\016cien)o(t)k(bu\013er)g(space)h(is)e(a)o(v)n(ailable,)e(but)j
(will)e(fail)g(on)h(systems)h(that)f(do)g(less)i(bu\013ering,)249
993 y(or)g(when)g(data)g(sets)h(\(and)f(message)g(sizes\))h(are)f
(increased.)32 b(Since)18 b(an)o(y)g(system)g(will)e(run)249
1047 y(out)g(of)g(bu\013er)h(resources)i(as)d(message)g(sizes)h(are)g
(increased,)g(and)f(some)g(implem)o(en)o(tations)249
1101 y(ma)o(y)11 b(w)o(an)o(t)h(to)h(pro)o(vide)g(little)f
(bu\013ering,)h Fw(MPI)f FA(tak)o(es)h(the)h(p)q(osition)e(that)h
Fs(safe)f FA(programs)g(do)249 1155 y(not)i(rely)h(on)f(system)g
(bu\013ering,)h(and)f(will)f(complete)h(correctly)h(irresp)q(ectiv)o(e)
i(of)c(the)i(bu\013er)249 1209 y(allo)q(cation)j(p)q(olicy)g(used)i(b)o
(y)f Fw(MPI)p FA(.)f(Bu\013ering)i(ma)o(y)d(c)o(hange)i(the)h(p)q
(erformance)f(of)f(a)h(safe)249 1263 y(program,)12 b(but)i(it)f(do)q
(esn't)i(a\013ect)g(the)f(result)h(of)e(the)i(program.)291
1317 y Fw(MPI)d FA(do)q(es)h(not)g(enforce)g(a)g(safe)g(programmi)o(ng)
c(st)o(yle.)18 b(Users)d(are)e(free)g(to)g(tak)o(e)f(adv)n(an)o(tage)
249 1371 y(of)18 b(kno)o(wledge)g(of)h(the)g(bu\013ering)g(p)q(olicy)f
(of)g(an)g(implemen)o(tation)d(in)j(order)i(to)e(relax)h(the)249
1425 y(safet)o(y)14 b(requiremen)o(ts,)g(though)f(doing)g(so)h(will)f
(lessen)i(the)f(p)q(ortabilit)o(y)f(of)g(the)i(program.)291
1479 y(The)f(follo)o(wing)d(examples)i(illustrate)h(safe)g(programmi)o
(ng)d(issues.)249 1574 y Fs(Example)k(2.7)21 b FA(An)14
b(exc)o(hange)h(of)e(messages.)249 1628 y Fr(CALL)21
b(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))249 1682 y(IF)g
(\(rank.EQ.0\))f(THEN)336 1736 y(CALL)h(MPI_SEND\(sendbuf,)d(count,)j
(MPI_REAL,)f(1,)h(tag,)g(comm,)g(ierr\))336 1790 y(CALL)g
(MPI_RECV\(recvbuf,)d(count,)j(MPI_REAL,)f(1,)h(tag,)g(comm,)g(status,)
f(ierr\))249 1844 y(ELSE)h(IF)g(\(rank.EQ.1\))f(THEN)336
1898 y(CALL)h(MPI_RECV\(recvbuf,)d(count,)j(MPI_REAL,)f(0,)h(tag,)g
(comm,)g(status,)f(ierr\))336 1952 y(CALL)h(MPI_SEND\(sendbuf,)d
(count,)j(MPI_REAL,)f(0,)h(tag,)g(comm,)g(ierr\))249
2006 y(END)g(IF)249 2114 y FA(This)15 b(program)f(succeeds)k(ev)o(en)e
(if)f(no)g(bu\013er)h(space)h(for)e(data)g(is)g(a)o(v)n(ailable.)20
b(The)c(program)249 2168 y(is)e(safe)g(and)g(will)e(alw)o(a)o(ys)h
(complete)g(correctly)m(.)249 2263 y Fs(Example)i(2.8)21
b FA(An)14 b(attempt)f(to)h(exc)o(hange)g(messages.)249
2317 y Fr(CALL)21 b(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))249
2371 y(IF)g(\(rank.EQ.0\))f(THEN)336 2425 y(CALL)h(MPI_RECV\(recvbuf,)d
(count,)j(MPI_REAL,)f(1,)h(tag,)g(comm,)g(status,)f(ierr\))336
2479 y(CALL)h(MPI_SEND\(sendbuf,)d(count,)j(MPI_REAL,)f(1,)h(tag,)g
(comm,)g(ierr\))p eop
%%Page: 34 48
34 47 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(34)1275 b(Chapter)13 b(2)249 507
y Fr(ELSE)21 b(IF)g(\(rank.EQ.1\))f(THEN)336 561 y(CALL)h
(MPI_RECV\(recvbuf,)d(count,)j(MPI_REAL,)f(0,)h(tag,)g(comm,)g(status,)
f(ierr\))336 615 y(CALL)h(MPI_SEND\(sendbuf,)d(count,)j(MPI_REAL,)f(0,)
h(tag,)g(comm,)g(ierr\))249 669 y(END)g(IF)249 777 y
FA(The)c(receiv)o(e)g(op)q(eration)f(of)f(the)i(\014rst)f(pro)q(cess)i
(m)o(ust)d(complete)h(b)q(efore)g(its)g(send,)h(and)f(can)249
831 y(complete)11 b(only)g(if)f(the)j(matc)o(hing)c(send)k(of)e(the)h
(second)g(pro)q(cessor)i(is)d(executed.)19 b(The)12 b(receiv)o(e)249
885 y(op)q(eration)17 b(of)f(the)i(second)g(pro)q(cess)h(m)o(ust)d
(complete)g(b)q(efore)i(its)f(send)h(and)f(can)g(complete)249
939 y(only)12 b(if)f(the)i(matc)o(hing)e(send)i(of)f(the)h(\014rst)g
(pro)q(cess)i(is)d(executed.)19 b(This)13 b(program)e(will)f(alw)o(a)o
(ys)249 993 y(deadlo)q(c)o(k.)249 1088 y Fs(Example)15
b(2.9)21 b FA(An)14 b(exc)o(hange)h(that)e(relies)i(on)f(bu\013ering.)
249 1142 y Fr(CALL)21 b(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))249
1196 y(IF)g(\(rank.EQ.0\))f(THEN)336 1250 y(CALL)h(MPI_SEND\(sendbuf,)d
(count,)j(MPI_REAL,)f(1,)h(tag,)g(comm,)g(ierr\))336
1304 y(CALL)g(MPI_RECV\(recvbuf,)d(count,)j(MPI_REAL,)f(1,)h(tag,)g
(comm,)g(status,)f(ierr\))249 1358 y(ELSE)h(IF)g(\(rank.EQ.1\))f(THEN)
336 1412 y(CALL)h(MPI_SEND\(sendbuf,)d(count,)j(MPI_REAL,)f(0,)h(tag,)g
(comm,)g(ierr\))336 1466 y(CALL)g(MPI_RECV\(recvbuf,)d(count,)j
(MPI_REAL,)f(0,)h(tag,)g(comm,)g(status,)f(ierr\))249
1520 y(END)h(IF)249 1628 y FA(The)13 b(message)f(sen)o(t)i(b)o(y)e(eac)
o(h)i(pro)q(cess)g(m)o(ust)e(b)q(e)h(copied)g(somewhere)g(b)q(efore)g
(the)g(send)h(op)q(er-)249 1682 y(ation)g(returns)j(and)e(the)h(receiv)
o(e)g(op)q(eration)f(starts.)23 b(F)m(or)15 b(the)h(program)d(to)i
(complete,)g(it)g(is)249 1736 y(necessary)e(that)e(at)g(least)g(one)g
(of)g(the)g(t)o(w)o(o)g(messages)g(b)q(e)h(bu\013ered.)18
b(Th)o(us,)11 b(this)h(program)d(will)249 1790 y(succeed)16
b(only)e(if)f(the)h(comm)o(unication)d(system)j(will)e(bu\013er)j(at)f
(least)g Fw(count)i FA(w)o(ords)e(of)f(data.)249 1844
y(Otherwise,)i(the)f(program)d(will)h(deadlo)q(c)o(k.)18
b(The)c(success)i(of)d(this)g(program)f(will)g(dep)q(end)j(on)249
1898 y(the)g(amoun)o(t)e(of)h(bu\013er)h(space)h(a)o(v)n(ailable)c(in)i
(a)g(particular)g(implemen)o(tation,)d(on)j(the)h(bu\013er)249
1952 y(allo)q(cation)i(p)q(olicy)g(used,)j(and)d(on)h(other)h
(concurren)o(t)h(comm)o(unicatio)o(n)15 b(o)q(ccurring)k(in)f(the)249
2006 y(system.)g(This)c(program)e(is)i(unsafe.)249 2101
y FB(A)n(dvic)n(e)g(to)h(users.)36 b FA(Safet)o(y)13
b(is)h(a)f(v)o(ery)h(imp)q(ortan)o(t)d(issue)k(in)e(the)h(design)f(of)g
(message)h(passing)249 2155 y(programs.)33 b Fw(MPI)18
b FA(o\013ers)i(man)o(y)d(features)k(that)e(help)g(in)g(writing)f(safe)
h(programs,)g(in)g(ad-)249 2209 y(dition)d(to)h(the)h(tec)o(hniques)g
(that)f(w)o(ere)h(outlined)f(ab)q(o)o(v)o(e.)27 b(Non)o(blo)q(c)o(king)
16 b(message)h(passing)249 2263 y(op)q(erations,)g(as)f(describ)q(ed)i
(in)e(Section)h(2.8,)e(can)i(b)q(e)g(used)g(to)f(a)o(v)o(oid)f(the)i
(need)h(for)e(bu\013er-)249 2317 y(ing)e(outgoing)g(messages.)21
b(This)14 b(eliminates)g(deadlo)q(c)o(ks)h(due)g(to)g(lac)o(k)f(of)g
(bu\013er)i(space,)g(and)249 2371 y(p)q(oten)o(tially)f(impro)o(v)o(es)
f(p)q(erformance,)i(b)o(y)g(a)o(v)o(oiding)d(the)k(o)o(v)o(erheads)g
(of)e(allo)q(cating)f(bu\013ers)249 2425 y(and)h(cop)o(ying)f(messages)
i(in)o(to)e(bu\013ers.)23 b(Use)16 b(of)f(other)h(comm)o(unicati)o(on)c
(mo)q(des,)j(describ)q(ed)249 2479 y(in)e(Section)i(2.13,)d(can)i(also)
f(a)o(v)o(oid)g(deadlo)q(c)o(k)h(situations)f(due)i(to)e(lac)o(k)h(of)f
(bu\013er)i(space.)p eop
%%Page: 35 49
35 48 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(35)249 507 y FA(Qualit)o(y)10 b Fw(MPI)f FA(implemen)o(tations)f
(attempt)h(to)i(b)q(e)g(lenien)o(t)f(to)g(the)h(user,)h(b)o(y)e(pro)o
(viding)g(bu\013er-)249 561 y(ing)i(for)g(standard)i(blo)q(c)o(king)d
(sends)j(whenev)o(er)h(feasible.)i(Programs)12 b(that)g(require)i
(bu\013ering)249 615 y(in)j(order)i(to)e(progress)i(will)e(not)g(t)o
(ypically)g(break,)h(unless)h(they)f(mo)o(v)o(e)e(large)i(amoun)o(ts)e
(of)249 669 y(data.)i(The)c(ca)o(v)o(eat,)g(of)f(course,)i(is)e(that)h
(\\large")f(is)h(a)g(relativ)o(e)f(term.)249 740 y(Safet)o(y)h(is)f
(further)i(discussed)h(in)d(Section)i(9.2.)i(\()p FB(End)e(of)g(advic)n
(e)g(to)g(users.)p FA(\))249 831 y FB(A)n(dvic)n(e)j(to)g
(implementors.)57 b FA(The)18 b(c)o(hallenge)f(facing)g(implem)o(en)o
(tors)f(is)h(to)g(b)q(e)h(as)f(lenien)o(t)249 885 y(as)e(p)q(ossible)f
(to)h(applications)e(that)i(require)g(bu\013ering,)f(without)g(hamp)q
(ering)g(p)q(erformance)249 939 y(of)h(applications)g(that)g(do)h(not)f
(require)i(bu\013ering.)23 b(Applications)15 b(should)g(not)h(deadlo)q
(c)o(k)f(if)249 993 y(memory)e(is)j(a)o(v)n(ailable)d(to)j(allo)o(w)e
(progress)j(in)e(the)h(comm)o(unication.)k(But)d(cop)o(ying)e(should)
249 1047 y(b)q(e)g(a)o(v)o(oided)e(when)h(it)g(is)f(not)h(necessary)m
(.)20 b(\()p FB(End)15 b(of)g(advic)n(e)g(to)g(implementors.)p
FA(\))249 1138 y Fs(2.4.2)48 b(Multithre)o(adi)o(ng)249
1221 y Fw(MPI)20 b FA(do)q(es)h(not)g(sp)q(ecify)g(the)h(in)o
(teraction)e(of)g(blo)q(c)o(king)g(comm)o(unicatio)o(n)e(calls)i(with)h
(the)249 1275 y(thread)c(sc)o(heduler)h(in)e(a)g(m)o(ulti-threaded)f
(implemen)o(tation)e(of)j Fw(MPI)p FA(.)f(The)i(desired)g(b)q(eha)o(v-)
249 1329 y(ior)e(is)g(that)h(a)f(blo)q(c)o(king)f(comm)o(unication)e
(call)j(blo)q(c)o(ks)g(only)g(the)h(issuing)f(thread,)h(allo)o(wing)249
1383 y(another)f(thread)g(to)f(b)q(e)i(sc)o(heduled.)21
b(The)15 b(blo)q(c)o(k)o(ed)f(thread)h(will)e(b)q(e)i(resc)o(heduled)i
(when)e(the)249 1437 y(blo)q(c)o(k)o(ed)e(call)f(is)h(satis\014ed.)18
b(That)13 b(is,)f(when)i(data)e(has)h(b)q(een)h(copied)g(out)e(of)h
(the)g(send)h(bu\013er,)249 1491 y(for)c(a)h(send)g(op)q(eration,)g(or)
g(copied)g(in)o(to)f(the)h(receiv)o(e)h(bu\013er,)g(for)e(a)g(receiv)o
(e)i(op)q(eration.)17 b(When)249 1545 y(a)e(thread)h(executes)i
(concurren)o(tly)e(with)f(a)g(blo)q(c)o(k)o(ed)h(comm)o(unicati)o(on)d
(op)q(eration,)i(it)g(is)g(the)249 1599 y(user's)f(resp)q(onsibilit)o
(y)e(not)h(to)f(access)j(or)d(mo)q(dify)e(a)j(comm)o(unicatio)o(n)d
(bu\013er)k(un)o(til)e(the)h(com-)249 1653 y(m)o(unication)f
(completes.)17 b(Otherwise,)e(the)g(outcome)e(of)g(the)i(computation)d
(is)i(unde\014ned.)249 1736 y Fs(2.4.3)48 b(Order)249
1819 y FA(Messages)16 b(are)f FB(non-overtaking)p FA(.)22
b(Conceptually)m(,)13 b(one)i(ma)o(y)e(think)h(of)g(successiv)o(e)j
(messages)249 1873 y(sen)o(t)f(b)o(y)e(a)g(pro)q(cess)j(to)d(another)i
(pro)q(cess)g(as)f(ordered)h(in)e(a)g(sequence.)23 b(Receiv)o(e)15
b(op)q(erations)249 1927 y(p)q(osted)d(b)o(y)f(a)f(pro)q(cess)j(are)e
(also)g(ordered)h(in)e(a)h(sequence.)19 b(Eac)o(h)12
b(incoming)c(message)j(matc)o(hes)249 1981 y(the)i(\014rst)f(matc)o
(hing)f(receiv)o(e)i(in)f(the)g(sequence.)20 b(This)12
b(is)g(illustrated)f(in)h(Figure)g(2.1.)k(Pro)q(cess)249
2035 y(zero)i(sends)f(t)o(w)o(o)g(messages)f(to)h(pro)q(cess)h(one)f
(and)f(pro)q(cess)j(t)o(w)o(o)d(sends)i(three)g(messages)f(to)249
2089 y(pro)q(cess)22 b(one.)35 b(Pro)q(cess)22 b(one)e(p)q(osts)g
(\014v)o(e)g(receiv)o(es.)37 b(All)19 b(comm)o(unications)e(o)q(ccur)k
(in)e(the)249 2143 y(same)13 b(comm)o(unication)e(domain.)17
b(The)e(\014rst)g(message)f(sen)o(t)h(b)o(y)f(pro)q(cess)i(zero)g(and)e
(the)h(\014rst)249 2197 y(message)j(sen)o(t)i(b)o(y)e(pro)q(cess)i(t)o
(w)o(o)e(can)h(b)q(e)g(receiv)o(ed)h(in)e(either)h(order,)h(since)f
(the)h(\014rst)f(t)o(w)o(o)249 2251 y(p)q(osted)d(receiv)o(es)h(matc)o
(h)d(either.)24 b(The)15 b(second)i(message)e(of)f(pro)q(cess)j(t)o(w)o
(o)e(will)f(b)q(e)i(receiv)o(ed)249 2305 y(b)q(efore)f(the)f(third)g
(message,)f(ev)o(en)i(though)e(the)i(third)f(and)g(fourth)f(receiv)o
(es)j(matc)o(h)d(either.)291 2359 y(Th)o(us,)h(if)f(a)h(sender)i(sends)
f(t)o(w)o(o)f(messages)g(in)g(succession)i(to)e(the)h(same)e
(destination,)h(and)249 2413 y(b)q(oth)f(matc)o(h)e(the)i(same)e
(receiv)o(e,)j(then)f(the)g(receiv)o(e)g(cannot)g(get)g(the)g(second)g
(message)f(if)g(the)249 2467 y(\014rst)g(message)f(is)g(still)f(p)q
(ending.)17 b(If)11 b(a)g(receiv)o(er)h(p)q(osts)g(t)o(w)o(o)f(receiv)o
(es)i(in)d(succession,)j(and)e(b)q(oth)p eop
%%Page: 36 50
36 49 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(36)1275 b(Chapter)13 b(2)249 466
y
 20921694 11188078 0 0 33351352 17826856 startTexFig
 249 466 a
%%BeginDocument: ../figures/pt2pt-Order1.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-54.0 288.0 translate 0.900 -0.900 scale
/Times-Roman findfont 18.00 scalefont setfont
554 174 m 
gs 1 -1 scale (Time) col-1 show gr
0.500 setlinewidth
% Polyline
n 199 199 m 199 139 l  139 139 l  139 199 l  clp gs col-1 s gr
% Polyline
n 259 199 m 259 139 l  199 139 l  199 199 l  clp gs col-1 s gr
% Polyline
n 319 199 m 319 139 l  259 139 l  259 199 l  clp gs col-1 s gr
% Polyline
n 379 199 m 379 139 l  319 139 l  319 199 l  clp gs col-1 s gr
% Polyline
n 439 199 m 439 139 l  379 139 l  379 199 l  clp gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
144 189 m 
gs 1 -1 scale (tag = 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
204 189 m 
gs 1 -1 scale (tag = 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
264 189 m 
gs 1 -1 scale (tag = *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
144 159 m 
gs 1 -1 scale (src = *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
204 159 m 
gs 1 -1 scale (src = *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
324 189 m 
gs 1 -1 scale (tag = *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
384 189 m 
gs 1 -1 scale (tag = *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
384 159 m 
gs 1 -1 scale (src = *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
264 159 m 
gs 1 -1 scale (src = 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
324 159 m 
gs 1 -1 scale (src = 2) col-1 show gr
% Polyline
n 179 259 m 229 199 l gs col-1 s gr
n 222.342 203.865 m 229.000 199.000 l 225.415 206.426 l gs 2 setlinejoin col-1 s gr
% Polyline
n 239 259 m 289 199 l gs col-1 s gr
n 282.342 203.865 m 289.000 199.000 l 285.415 206.426 l gs 2 setlinejoin col-1 s gr
% Polyline
n 314 259 m 349 199 l gs col-1 s gr
n 343.241 204.902 m 349.000 199.000 l 346.697 206.918 l gs 2 setlinejoin col-1 s gr
% Polyline
n 159 79 m 159 139 l gs col-1 s gr
n 161.000 131.000 m 159.000 139.000 l 157.000 131.000 l gs 2 setlinejoin col-1 s gr
	[4.000000] 0 setdash
% Polyline
n 179 79 m 229 139 l gs col-1 s gr
	[] 0 setdash
n 225.415 131.574 m 229.000 139.000 l 222.342 134.135 l gs 2 setlinejoin col-1 s gr
n 615.000 178.000 m 623.000 180.000 l 615.000 182.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 623 180 m 522 180 l gs col-1 s gr
	[4.000000] 0 setdash
% Polyline
n 159 259 m 159 199 l gs col-1 s gr
	[] 0 setdash
n 157.000 207.000 m 159.000 199.000 l 161.000 207.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
154 304 m 
gs 1 -1 scale (tag = 1) col-1 show gr
% Polyline
n 244 79 m 409 139 l gs col-1 s gr
n 402.165 134.386 m 409.000 139.000 l 400.798 138.146 l gs 2 setlinejoin col-1 s gr
% Polyline
n 139 319 m 139 259 l  209 259 l  209 319 l  clp gs col-1 s gr
% Polyline
n 139 79 m 139 19 l  209 19 l  209 79 l  clp gs col-1 s gr
% Polyline
n 209 79 m 209 19 l  279 19 l  279 79 l  clp gs col-1 s gr
% Polyline
n 209 319 m 209 259 l  279 259 l  279 319 l  clp gs col-1 s gr
% Polyline
n 279 319 m 279 259 l  349 259 l  349 319 l  clp gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
59 299 m 
gs 1 -1 scale (process 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 79 m 
gs 1 -1 scale (\(send\)) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 199 m 
gs 1 -1 scale (\(recv\)) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 319 m 
gs 1 -1 scale (\(send\)) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 59 m 
gs 1 -1 scale (process 0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 179 m 
gs 1 -1 scale (process 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
144 39 m 
gs 1 -1 scale (dest = 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
149 64 m 
gs 1 -1 scale (tag = 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
214 39 m 
gs 1 -1 scale (dest = 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
219 64 m 
gs 1 -1 scale (tag = 4) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
284 279 m 
gs 1 -1 scale (dest = 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
289 304 m 
gs 1 -1 scale (tag = 3) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
219 279 m 
gs 1 -1 scale (dest = 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
224 304 m 
gs 1 -1 scale (tag = 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
149 279 m 
gs 1 -1 scale (dest = 1) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1237 a Fo(Figure)g(2.1)249 1274 y Fz(Messages)e(are)f(matc)o(hed)f
(in)j(order.)249 1397 y FA(matc)o(h)h(the)i(same)e(message,)h(then)h
(the)g(second)g(receiv)o(e)g(op)q(eration)f(cannot)h(b)q(e)g
(satis\014ed)g(b)o(y)249 1451 y(this)f(message,)f(if)g(the)i(\014rst)f
(receiv)o(e)i(is)d(still)g(p)q(ending.)291 1505 y(These)21
b(requiremen)o(ts)f(further)g(de\014ne)h(message)f(matc)o(hing.)70
b(They)20 b(guaran)o(tee)g(that)249 1559 y(message-passing)11
b(co)q(de)h(is)f(deterministic,)f(if)h(pro)q(cesses)i(are)f
(single-threaded)g(and)f(the)h(wild-)249 1613 y(card)j
Fq(MPI)p 414 1613 12 2 v 13 w(ANY)p 506 1613 V 13 w(SOURCE)g
FA(is)f(not)h(used)g(in)f(receiv)o(es.)22 b(Some)13 b(other)i
Fw(MPI)f FA(functions,)g(suc)o(h)h(as)249 1667 y Fw(MPI)p
326 1667 13 2 v 14 w(CANCEL)f FA(or)f Fw(MPI)p 637 1667
V 15 w(W)m(AIT)m(ANY)p FA(,)f(are)i(additional)e(sources)k(of)d
(nondeterminism.)291 1721 y(In)k(a)g(single-threaded)i(pro)q(cess)g
(all)d(comm)o(unication)e(op)q(erations)k(are)g(ordered)h(accord-)249
1774 y(ing)h(to)h(program)e(execution)j(order.)39 b(The)22
b(situation)e(is)g(di\013eren)o(t)i(when)g(pro)q(cesses)h(are)249
1828 y(m)o(ulti-threaded.)17 b(The)d(seman)o(tics)f(of)g(thread)h
(execution)g(ma)o(y)e(not)h(de\014ne)i(a)e(relativ)o(e)h(order)249
1882 y(b)q(et)o(w)o(een)h(t)o(w)o(o)f(comm)o(uni)o(cation)d(op)q
(erations)j(executed)i(b)o(y)d(t)o(w)o(o)g(distinct)i(threads.)k(The)14
b(op-)249 1936 y(erations)h(are)f(logically)e(concurren)o(t,)k(ev)o(en)
e(if)g(one)g(ph)o(ysically)f(precedes)k(the)e(other.)k(In)14
b(this)249 1990 y(case,)h(no)f(order)g(constrain)o(ts)h(apply)m(.)j(Tw)
o(o)13 b(messages)i(sen)o(t)g(b)o(y)e(concurren)o(t)j(threads)f(can)g
(b)q(e)249 2044 y(receiv)o(ed)f(in)f(an)o(y)f(order.)18
b(Similarly)m(,)9 b(if)j(t)o(w)o(o)h(receiv)o(e)h(op)q(erations)f(that)
g(are)g(logically)e(concur-)249 2098 y(ren)o(t)16 b(receiv)o(e)g(t)o(w)
o(o)f(successiv)o(ely)h(sen)o(t)g(messages,)f(then)h(the)f(t)o(w)o(o)g
(messages)g(can)g(matc)o(h)f(the)249 2152 y(receiv)o(es)i(in)d(either)i
(order.)291 2206 y(It)g(is)g(imp)q(ortan)o(t)e(to)i(understand)h(what)f
(is)g(guaran)o(teed)g(b)o(y)g(the)h(ordering)f(prop)q(ert)o(y)h(and)249
2260 y(what)h(is)f(not.)27 b(Bet)o(w)o(een)18 b(an)o(y)e(pair)g(of)g
(comm)o(unicating)e(pro)q(cesses,)19 b(messages)e(\015o)o(w)f(in)h(or-)
249 2314 y(der.)i(This)14 b(do)q(es)h(not)f(imply)d(a)j(consisten)o(t,)
h(total)e(order)i(on)f(comm)o(unicati)o(on)d(ev)o(en)o(ts)k(in)f(the)
249 2368 y(system.)k(Consider)c(the)h(follo)o(wing)c(example.)p
eop
%%Page: 37 51
37 50 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(37)249 507 y Fs(Example)15 b(2.10)21 b FA(Order)15
b(preserving)g(is)f(not)f(transitiv)o(e.)249 561 y Fr(CALL)21
b(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))249 615 y(IF)g
(\(rank.EQ.0\))f(THEN)314 669 y(CALL)h(MPI_SEND\(buf1,)e(count,)i
(MPI_REAL,)f(2,)h(tag,)g(comm,)g(ierr\))314 723 y(CALL)g
(MPI_SEND\(buf2,)e(count,)i(MPI_REAL,)f(1,)h(tag,)g(comm,)g(ierr\))249
777 y(ELSE)g(IF)g(\(rank.EQ.1\))f(THEN)314 831 y(CALL)h
(MPI_RECV\(buf2,)e(count,)i(MPI_REAL,)f(0,)h(tag,)g(comm,)g(status,)f
(ierr\))314 885 y(CALL)h(MPI_SEND\(buf2,)e(count,)i(MPI_REAL,)f(2,)h
(tag,)g(comm,)g(ierr\))249 939 y(ELSE)g(IF)g(\(rank.EQ.2\))314
993 y(CALL)g(MPI_RECV\(buf1,)e(count,)i(MPI_REAL,)f(MPI_ANY_SOURCE,)e
(tag,)1186 1047 y(comm,)j(status,)f(ierr\))314 1101 y(CALL)h
(MPI_RECV\(buf2,)e(count,)i(MPI_REAL,)f(MPI_ANY_SOURCE,)e(tag,)1186
1155 y(comm,)j(status,)f(ierr\))249 1209 y(END)h(IF)249
1263 y FA(Pro)q(cess)c(zero)f(sends)g(a)f(message)g(to)g(pro)q(cess)i
(t)o(w)o(o)d(and)h(next)h(sends)g(a)f(message)g(to)g(pro)q(cess)249
1317 y(one.)21 b(Pro)q(cess)c(one)e(receiv)o(es)h(the)g(message)e(from)
f(pro)q(cess)k(zero,)e(then)h(sends)g(a)e(message)h(to)249
1371 y(pro)q(cess)k(t)o(w)o(o.)27 b(Pro)q(cess)19 b(t)o(w)o(o)e(receiv)
o(es)h(t)o(w)o(o)f(messages,)g(with)g Fr(source)k(=)g(dontcare)p
FA(.)26 b(The)249 1425 y(t)o(w)o(o)15 b(incoming)e(messages)j(can)g(b)q
(e)g(receiv)o(ed)h(b)o(y)e(pro)q(cess)i(t)o(w)o(o)e(in)g(an)o(y)g
(order,)h(ev)o(en)h(though)249 1479 y(pro)q(cess)h(one)f(sen)o(t)g(its)
f(message)g(after)g(it)g(receiv)o(ed)i(the)e(second)i(message)e(sen)o
(t)h(b)o(y)f(pro)q(cess)249 1533 y(zero.)j(The)14 b(reason)g(is)g(that)
g(comm)o(unicatio)o(n)d(dela)o(ys)j(can)g(b)q(e)g(arbitrary)f(and)h
Fw(MPI)f FA(do)q(es)i(not)249 1587 y(enforce)k(global)d(serialization)h
(of)g(comm)o(unications.)27 b(Th)o(us,)18 b(the)h(somewhat)e(parado)o
(xical)249 1641 y(outcome)e(illustrated)g(in)g(Figure)g(2.2)f(can)i(o)q
(ccur.)24 b(If)14 b(pro)q(cess)k(zero)e(had)f(sen)o(t)h(directly)g(t)o
(w)o(o)249 1694 y(messages)11 b(to)g(pro)q(cess)h(t)o(w)o(o)f(then)g
(these)i(t)o(w)o(o)d(messages)h(w)o(ould)f(ha)o(v)o(e)h(b)q(een)h
(receiv)o(ed)g(in)e(order.)249 1748 y(Since)17 b(it)f(rela)o(y)o(ed)g
(the)h(second)h(message)e(via)f(pro)q(cess)j(one,)f(then)g(the)g
(messages)f(ma)o(y)f(no)o(w)249 1802 y(arriv)o(e)f(out)g(of)f(order.)19
b(In)14 b(practice,)g(suc)o(h)h(an)e(o)q(ccurrence)k(is)d(unlik)o(ely)m
(.)249 1906 y Fs(2.4.4)48 b(Progress)249 1989 y FA(If)14
b(a)g(pair)g(of)g(matc)o(hing)f(send)i(and)g(receiv)o(es)h(ha)o(v)o(e)e
(b)q(een)i(initiated)e(on)g(t)o(w)o(o)g(pro)q(cesses,)j(then)249
2043 y(at)e(least)h(one)g(of)f(these)i(t)o(w)o(o)e(op)q(erations)g
(will)f(complete,)h(indep)q(enden)o(tly)h(of)f(other)h(actions)249
2097 y(in)e(the)i(system.)k(The)c(send)f(op)q(eration)g(will)e
(complete,)h(unless)i(the)f(receiv)o(e)h(is)f(satis\014ed)h(b)o(y)249
2151 y(another)g(message.)24 b(The)16 b(receiv)o(e)h(op)q(eration)f
(will)e(complete,)h(unless)i(the)f(message)g(sen)o(t)h(is)249
2205 y(consumed)d(b)o(y)f(another)i(matc)o(hing)d(receiv)o(e)j(p)q
(osted)g(at)e(the)i(same)e(destination)h(pro)q(cess.)249
2292 y FB(A)n(dvic)n(e)f(to)g(implementors.)35 b FA(This)12
b(requiremen)o(t)f(imp)q(oses)h(constrain)o(ts)g(on)g(implemen)o(tatio)
o(n)249 2346 y(strategies.)25 b(Supp)q(ose,)17 b(for)f(example,)e(that)
i(a)g(pro)q(cess)i(executes)g(t)o(w)o(o)d(successiv)o(e)j(blo)q(c)o
(king)249 2400 y(send)13 b(calls.)k(The)c(message)f(sen)o(t)i(b)o(y)e
(the)h(\014rst)g(call)f(is)g(bu\013ered,)i(and)e(the)h(second)g(call)f
(starts.)249 2454 y(Then,)20 b(if)e(a)h(receiv)o(e)h(is)f(p)q(osted)h
(that)f(matc)o(hes)f(this)h(second)i(send,)f(the)g(second)g(message)249
2508 y(should)13 b(b)q(e)h(able)f(to)g(o)o(v)o(ertak)o(e)h(the)g
(\014rst)g(bu\013ered)h(one.)j(\()p FB(End)d(of)f(advic)n(e)h(to)f
(implementors.)p FA(\))p eop
%%Page: 38 52
38 51 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(38)1275 b(Chapter)13 b(2)621 466
y
 11840716 11367081 0 0 20523909 19734528 startTexFig
 621 466 a
%%BeginDocument: ../figures/pt2pt-Order2.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-54.0 342.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 346 299 m 339 299 339 372 7 arcto 4 {pop} repeat 339 379 392 379 7 arcto 4 {pop} repeat 399 379 399 306 7 arcto 4 {pop} repeat 399 299 346 299 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 66 99 m 59 99 59 172 7 arcto 4 {pop} repeat 59 179 112 179 7 arcto 4 {pop} repeat 119 179 119 106 7 arcto 4 {pop} repeat 119 99 66 99 7 arcto 4 {pop} repeat clp gs col-1 s gr
1.000 setlinewidth
% Polyline
n 229 269 m 279 319 l  349 319 l gs col-1 s gr
n 333.000 315.000 m 349.000 319.000 l 333.000 323.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 89 169 m 139 219 l  209 219 l gs col-1 s gr
n 193.000 215.000 m 209.000 219.000 l 193.000 223.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 74 129 m 69 139 l  69 219 l  199 359 l  349 359 l gs col-1 s gr
n 333.000 355.000 m 349.000 359.000 l 333.000 363.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
59 59 m 
gs 1 -1 scale (Process 0) col-1 show gr
0.500 setlinewidth
% Polyline
n 206 199 m 199 199 199 272 7 arcto 4 {pop} repeat 199 279 252 279 7 arcto 4 {pop} repeat 259 279 259 206 7 arcto 4 {pop} repeat 259 199 206 199 7 arcto 4 {pop} repeat clp gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
199 164 m 
gs 1 -1 scale (Process 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
354 364 m 
gs 1 -1 scale (recv) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
214 224 m 
gs 1 -1 scale (recv) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
214 264 m 
gs 1 -1 scale (send) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
339 259 m 
gs 1 -1 scale (Process 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
74 124 m 
gs 1 -1 scale (send) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
74 164 m 
gs 1 -1 scale (send) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
354 324 m 
gs 1 -1 scale (recv) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1248 a Fo(Figure)g(2.2)249 1285 y Fz(Order)e(preserving)e(is)i
(not)g(transitiv)o(e.)249 1408 y Fs(2.4.5)48 b(F)l(airness)249
1491 y Fw(MPI)16 b FA(mak)o(es)g(no)h(guaran)o(tee)g(of)f
FB(fairness)h FA(in)f(the)i(handling)e(of)g(comm)o(unicatio)o(n.)24
b(Supp)q(ose)249 1545 y(that)16 b(a)f(send)i(is)e(p)q(osted.)24
b(Then)17 b(it)e(is)g(p)q(ossible)h(that)g(the)g(destination)g(pro)q
(cess)h(rep)q(eatedly)249 1599 y(p)q(osts)f(a)f(receiv)o(e)h(that)f
(matc)o(hes)f(this)i(send,)f(y)o(et)h(the)f(message)g(is)g(nev)o(er)h
(receiv)o(ed,)g(b)q(ecause)249 1653 y(it)i(is)g(rep)q(eatedly)h(o)o(v)o
(ertak)o(en)g(b)o(y)e(other)i(messages,)g(sen)o(t)g(from)d(other)j
(sources.)33 b(The)18 b(sce-)249 1707 y(nario)f(requires)i(that)e(the)h
(receiv)o(e)h(used)g(the)f(wildcard)f Fq(MPI)p 1245 1707
12 2 v 13 w(ANY)p 1337 1707 V 13 w(SOURCE)h FA(as)g(its)f(source)249
1761 y(argumen)o(t.)291 1815 y(Similarl)o(y)m(,)11 b(supp)q(ose)k(that)
f(a)g(receiv)o(e)i(is)e(p)q(osted)h(b)o(y)f(a)g(m)o(ulti-threaded)f
(pro)q(cess.)21 b(Then)15 b(it)249 1869 y(is)e(p)q(ossible)h(that)g
(messages)f(that)h(matc)o(h)e(this)i(receiv)o(e)h(are)e(rep)q(eatedly)i
(consumed,)e(y)o(et)h(the)249 1923 y(receiv)o(e)k(is)f(nev)o(er)h
(satis\014ed,)g(b)q(ecause)g(it)f(is)g(o)o(v)o(ertak)o(en)g(b)o(y)g
(other)g(receiv)o(es)i(p)q(osted)f(at)e(this)249 1977
y(no)q(de)f(b)o(y)f(other)h(threads.)20 b(It)15 b(is)f(the)h
(programmer's)d(resp)q(onsibilit)o(y)i(to)g(prev)o(en)o(t)h(starv)n
(ation)249 2031 y(in)e(suc)o(h)i(situations.)p eop
%%Page: 39 53
39 52 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(39)249 507 y FD(2.5)52 b(Example)18 b(|)g(Jacobi)g(iteration)249
615 y FA(W)m(e)12 b(shall)g(use)h(the)g(follo)o(wing)d(example)h(to)i
(illustrate)f(the)h(material)e(in)o(tro)q(duced)i(so)g(far,)f(and)249
669 y(to)i(motiv)n(ate)e(new)i(functions.)249 752 y Fs(Example)h(2.11)
21 b FA(Jacobi)14 b(iteration)f({)h(sequen)o(tial)g(co)q(de)249
806 y Fr(REAL)21 b(A\(0:n+1,0:n+1\),)e(B\(1:n,1:n\))249
860 y(...)249 968 y(!)j(Main)f(Loop)249 1022 y(DO)g
(WHILE\(.NOT.converged)o(\))314 1076 y(!)h(perform)e(4)i(point)f
(stencil)314 1130 y(DO)h(j=1,)f(n)380 1184 y(DO)g(i=1,)g(n)445
1238 y(B\(i,j\))g(=0.25*\(A\(i-1,j\)+)o(A\(i+1)o(,j\)+A)o(\(i,j-)o
(1\)+A\()o(i,j+)o(1\)\))380 1292 y(END)g(DO)314 1346
y(END)h(DO)314 1454 y(!)g(copy)f(result)g(back)g(into)f(array)h(A)314
1508 y(DO)h(j=1,n)380 1562 y(DO)f(i=1,n)445 1616 y(A\(i,j\))g(=)g
(B\(i,j\))380 1670 y(END)g(DO)314 1724 y(END)h(DO)249
1778 y(...)249 1831 y(!)g(Convergence)d(test)i(omitted)249
1885 y(END)g(DO)249 1939 y FA(The)d(co)q(de)g(fragmen)o(t)e(describ)q
(es)j(the)f(main)e(lo)q(op)g(of)h(an)g(iterativ)o(e)g(solv)o(er)h
(where,)h(at)e(eac)o(h)249 1993 y(iteration,)k(the)f(v)n(alue)g(at)g(a)
f(p)q(oin)o(t)h(is)g(replaced)h(b)o(y)f(the)g(a)o(v)o(erage)g(of)g(the)
g(North,)i(South,)249 2047 y(East)14 b(and)f(W)m(est)h(neigh)o(b)q(ors)
f(\(a)h(four)f(p)q(oin)o(t)g(stencil)g(is)h(used)g(to)f(k)o(eep)h(the)g
(example)e(simple\).)249 2101 y(Boundary)17 b(v)n(alues)g(do)g(not)g(c)
o(hange.)28 b(W)m(e)16 b(fo)q(cus)i(on)f(the)g(inner)h(lo)q(op,)e
(where)j(most)c(of)i(the)249 2155 y(computation)12 b(is)i(done,)g(and)f
(use)i(F)m(ortran)f(90)f(syn)o(tax,)h(for)f(clarit)o(y)m(.)291
2238 y(Since)i(this)h(co)q(de)g(has)g(a)f(simple)f(structure,)j(a)e
(data-parallel)f(approac)o(h)i(can)f(b)q(e)h(used)h(to)249
2292 y(deriv)o(e)g(an)e(equiv)n(alen)o(t)h(parallel)f(co)q(de.)25
b(The)16 b(arra)o(y)g(is)g(distributed)h(across)g(pro)q(cesses,)i(and)
249 2346 y(eac)o(h)14 b(pro)q(cess)h(is)e(assigned)g(the)h(task)f(of)f
(up)q(dating)h(the)h(en)o(tries)g(on)f(the)g(part)h(of)e(the)i(arra)o
(y)f(it)249 2400 y(o)o(wns.)291 2454 y(A)h(parallel)f(algorithm)e(is)j
(deriv)o(ed)h(from)d(a)i(c)o(hoice)h(of)e(data)h(distribution.)k(The)d
(distribu-)249 2508 y(tion)g(should)h(b)q(e)h(balanced,)f(allo)q
(cating)e(\(roughly\))i(the)g(same)f(n)o(um)o(b)q(er)h(of)f(en)o(tries)
i(to)f(eac)o(h)p eop
%%Page: 40 54
40 53 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(40)1275 b(Chapter)13 b(2)249 507
y FA(pro)q(cessor;)i(and)e(it)f(should)h(minimi)o(ze)e(comm)o
(unication.)j(Figure)g(2.3)e(illustrates)h(t)o(w)o(o)f(p)q(ossi-)249
561 y(ble)h(distributions:)18 b(a)13 b(1D)g(\(blo)q(c)o(k\))g
(distribution,)g(where)h(the)g(matrix)e(is)h(partitioned)g(in)g(one)249
615 y(dimension,)f(and)i(a)f(2D)h(\(blo)q(c)o(k,blo)q(c)o(k\))f
(distribution,)g(where)i(the)f(matrix)e(is)i(partitioned)g(in)249
669 y(t)o(w)o(o)f(dimensions.)546 719 y
 14208860 6393984 0 0 26049576 11840716 startTexFig
 546 719 a
%%BeginDocument: ../figures/pt2pt-Jacobi1.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-72.0 324.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 519 239 m 439 239 l  439 159 l  519 159 l  clp gs 0.50 setgray fill gr
gs col0 s gr
% Polyline
n 159 319 m 119 319 l  119 159 l  159 159 l  clp gs 0.00 setgray fill gr
gs col0 s gr
% Polyline
n 439 319 m 359 319 l  359 239 l  439 239 l  clp gs 0.00 setgray fill gr
gs col0 s gr
% Polyline
n 119 319 m 119 159 l  79 159 l  79 319 l  clp gs 1.00 setgray fill gr
gs col0 s gr
% Polyline
n 239 319 m 199 319 l  199 159 l  239 159 l  clp gs 0.50 setgray fill gr
gs col0 s gr
% Polyline
n 439 239 m 439 159 l  359 159 l  359 239 l  clp gs 1.00 setgray fill gr
gs col0 s gr
/Times-Bold findfont 18.00 scalefont setfont
379 359 m 
gs 1 -1 scale (2D partition) col-1 show gr
% Polyline
n 519 319 m 439 319 l  439 239 l  519 239 l  clp gs 0.85 setgray fill gr
gs col0 s gr
% Polyline
n 199 319 m 159 319 l  159 159 l  199 159 l  clp gs 0.85 setgray fill gr
gs col0 s gr
/Times-Bold findfont 18.00 scalefont setfont
99 359 m 
gs 1 -1 scale (1D partition) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1186 a Fo(Figure)g(2.3)249 1224 y Fz(Blo)q(c)o(k)e(partitionin)o
(g)e(of)i(a)g(matrix.)291 1334 y FA(Since)k(the)h(comm)o(unication)c(o)
q(ccurs)k(at)f(blo)q(c)o(k)g(b)q(oundaries,)h(comm)o(uni)o(cation)c(v)o
(olume)i(is)249 1388 y(minim)o(ized)g(b)o(y)i(the)h(2D)f(partition)f
(whic)o(h)h(has)h(a)e(b)q(etter)j(area)f(to)f(p)q(erimeter)g(ratio.)25
b(Ho)o(w-)249 1442 y(ev)o(er,)20 b(in)d(this)i(partition,)f(eac)o(h)g
(pro)q(cessor)i(comm)o(unicates)d(with)h(four)f(neigh)o(b)q(ors,)j
(rather)249 1496 y(than)15 b(t)o(w)o(o)f(neigh)o(b)q(ors)h(in)f(the)i
(1D)e(partition.)19 b(When)c(the)h(ratio)e(of)g Fr(n/P)g
FA(\()p Fr(P)g FA(n)o(um)o(b)q(er)g(of)h(pro-)249 1550
y(cessors\))g(is)f(small,)c(comm)o(unication)g(time)i(will)g(b)q(e)i
(dominated)d(b)o(y)i(the)h(\014xed)g(o)o(v)o(erhead)g(p)q(er)249
1604 y(message,)j(and)f(the)i(\014rst)f(partition)f(will)f(lead)i(to)f
(b)q(etter)i(p)q(erformance.)27 b(When)17 b(the)g(ratio)249
1658 y(is)g(large,)g(the)h(second)g(partition)e(will)g(result)i(in)f(b)
q(etter)h(p)q(erformance.)28 b(In)17 b(order)h(to)f(k)o(eep)249
1712 y(the)h(example)e(simple,)g(w)o(e)h(shall)g(use)h(the)g(\014rst)g
(partition;)f(a)g(realistic)g(co)q(de)h(w)o(ould)f(use)h(a)249
1766 y(\\p)q(oly)o(algorithm)o(")13 b(that)i(selects)i(one)f(of)f(the)h
(t)o(w)o(o)f(partitions,)f(according)i(to)f(problem)f(size,)249
1820 y(n)o(um)o(b)q(er)f(of)h(pro)q(cessors,)h(and)f(comm)o(unicatio)o
(n)d(p)q(erformance)j(parameters.)291 1873 y(The)j(v)n(alue)f(of)g(eac)
o(h)h(p)q(oin)o(t)f(in)h(the)g(arra)o(y)g Fr(B)f FA(is)h(computed)f
(from)f(the)i(v)n(alue)f(of)g(the)i(four)249 1927 y(neigh)o(b)q(ors)d
(in)g(arra)o(y)f Fr(A)p FA(.)h(Comm)n(unications)d(are)j(needed)i(at)d
(blo)q(c)o(k)h(b)q(oundaries)g(in)g(order)h(to)249 1981
y(receiv)o(e)g(v)n(alues)f(of)f(neigh)o(b)q(or)h(p)q(oin)o(ts)f(whic)o
(h)h(are)g(o)o(wned)g(b)o(y)g(another)g(pro)q(cessor.)23
b(Comm)o(u-)249 2035 y(nications)14 b(are)g(simpli\014ed)e(if)h(an)h(o)
o(v)o(erlap)f(area)h(is)g(allo)q(cated)f(at)h(eac)o(h)g(pro)q(cessor)i
(for)e(storing)249 2089 y(the)i(v)n(alues)e(to)h(b)q(e)g(receiv)o(ed)i
(from)c(the)i(neigh)o(b)q(or)g(pro)q(cessor.)23 b(Essen)o(tially)m(,)14
b(storage)h(is)g(allo-)249 2143 y(cated)j(for)e(eac)o(h)h(en)o(try)h(b)
q(oth)f(at)g(the)g(pro)q(ducer)h(and)f(at)g(the)g(consumer)g(of)f(that)
h(en)o(try)m(.)27 b(If)249 2197 y(an)16 b(en)o(try)h(is)f(pro)q(duced)h
(b)o(y)f(one)h(pro)q(cessor)h(and)e(consumed)f(b)o(y)h(another,)h(then)
g(storage)g(is)249 2251 y(allo)q(cated)d(for)g(this)g(en)o(try)h(at)f
(b)q(oth)h(pro)q(cessors.)21 b(With)14 b(suc)o(h)h(sc)o(heme)g(there)g
(is)f(no)g(need)i(for)249 2305 y(dynamic)e(allo)q(cation)g(of)h(comm)o
(unicatio)o(n)e(bu\013ers,)k(and)e(the)h(lo)q(cation)f(of)g(eac)o(h)h
(v)n(ariable)f(is)249 2359 y(\014xed.)k(Suc)o(h)14 b(sc)o(heme)g(w)o
(orks)g(whenev)o(er)i(the)e(data)g(dep)q(endencies)j(in)c(the)i
(computation)d(are)249 2413 y(\014xed)h(and)f(simple.)j(In)e(our)f
(case,)h(they)f(are)h(describ)q(ed)h(b)o(y)d(a)h(four)g(p)q(oin)o(t)g
(stencil.)18 b(Therefore,)249 2467 y(a)c(one-column)e(o)o(v)o(erlap)h
(is)h(needed,)h(for)e(a)h(1D)f(partition.)p eop
%%Page: 41 55
41 54 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(41)291 507 y FA(W)m(e)13 b(shall)g(partition)f(arra)o(y)i
Fr(A)f FA(with)g(one)h(column)e(o)o(v)o(erlap.)17 b(No)d(suc)o(h)g(o)o
(v)o(erlap)f(is)g(required)249 561 y(for)g(arra)o(y)f
Fr(B)p FA(.)h(Figure)g(2.4)f(sho)o(ws)h(the)g(extra)h(columns)d(in)i
Fr(A)g FA(and)f(ho)o(w)h(data)g(is)f(transfered)j(for)249
615 y(eac)o(h)f(iteration.)291 669 y(W)m(e)g(shall)g(use)h(an)g
(algorithm)d(where)k(all)e(v)n(alues)g(needed)i(from)d(a)i(neigh)o(b)q
(or)f(are)i(brough)o(t)249 723 y(in)d(one)h(message.)k(Coalescing)c(of)
f(comm)o(unicatio)o(ns)f(in)h(this)h(manner)f(reduces)j(the)e(n)o(um)o
(b)q(er)249 777 y(of)f(messages)h(and)g(generally)g(impro)o(v)o(es)e(p)
q(erformance.)246 835 y
 23681433 15629742 0 0 34930114 23155179 startTexFig
 246 835 a
%%BeginDocument: ../figures/pt2pt-Jacobi2.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-18.0 360.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 299 79 m 299 99 l gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 299 199 m 299 219 l gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 379 199 m 379 219 l gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 379 79 m 379 99 l gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 299 199 m 299 99 l  279 99 l  279 199 l  clp gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 499 199 m 499 99 l  479 99 l  479 199 l  clp gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 499 79 m 499 99 l gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 499 199 m 499 219 l gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 119 399 m 119 299 l  99 299 l  99 399 l  clp gs col-1 s gr
% Polyline
n 159 399 m 159 299 l  119 299 l  119 399 l  clp gs col-1 s gr
% Polyline
n 179 399 m 179 299 l  159 299 l  159 399 l  clp gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 360 399 m 360 299 l  320 299 l  320 399 l  clp gs col-1 s gr
% Polyline
n 380 399 m 380 299 l  360 299 l  360 399 l  clp gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 559 399 m 559 299 l  519 299 l  519 399 l  clp gs col-1 s gr
% Polyline
n 579 399 m 579 299 l  559 299 l  559 399 l  clp gs col-1 s gr
% Polyline
n 297 352 m 206 148 l gs col-1 s gr
n 207.433 156.121 m 206.000 148.000 l 211.086 154.491 l gs 2 setlinejoin col-1 s gr
% Polyline
n 494 349 m 406 149 l gs col-1 s gr
n 407.391 157.128 m 406.000 149.000 l 411.053 155.517 l gs 2 setlinejoin col-1 s gr
	[4.000000] 0 setdash
% Polyline
n 184 352 m 271 158 l gs col-1 s gr
	[] 0 setdash
n 265.902 164.481 m 271.000 158.000 l 269.551 166.118 l gs 2 setlinejoin col-1 s gr
n 384 356 m 384 356 l gs col-1 s gr
	[4.000000] 0 setdash
% Polyline
n 385 355 m 471 154 l gs col-1 s gr
	[] 0 setdash
n 466.014 160.568 m 471.000 154.000 l 469.692 162.142 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
99 29 m 
gs 1 -1 scale (Process 0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
299 29 m 
gs 1 -1 scale (Process 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
499 29 m 
gs 1 -1 scale (Process 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
84 396 m 
gs 1 -1 scale (n) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
84 317 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
105 293 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
128 290 m 
gs 1 -1 scale (o  o) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
162 292 m 
gs 1 -1 scale (m) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
117 72 m 
gs 1 -1 scale (o  o  o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
322 73 m 
gs 1 -1 scale (o  o  o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
522 73 m 
gs 1 -1 scale (o  o  o) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
45 217 m 
gs 1 -1 scale (n+1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
247 216 m 
gs 1 -1 scale (n+1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
448 216 m 
gs 1 -1 scale (n+1) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
65 129 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
65 152 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
65 175 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
265 131 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
265 154 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
265 177 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
466 128 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
466 151 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
466 174 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
88 341 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
88 364 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
306 295 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
330 292 m 
gs 1 -1 scale (o  o) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
363 294 m 
gs 1 -1 scale (m) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
505 293 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
529 290 m 
gs 1 -1 scale (o  o) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
562 292 m 
gs 1 -1 scale (m) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
285 317 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
486 317 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
285 396 m 
gs 1 -1 scale (n) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
483 396 m 
gs 1 -1 scale (n) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
287 342 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
287 365 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
486 344 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
486 367 m 
gs 1 -1 scale (o) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
19 357 m 
gs 1 -1 scale (B) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
20 159 m 
gs 1 -1 scale (A) col-1 show gr
% Polyline
n 99 219 m 99 79 l  79 79 l  79 219 l  clp gs col-1 s gr
% Polyline
n 199 99 m 199 79 l  79 79 l  79 99 l  clp gs col-1 s gr
% Polyline
n 179 79 m 179 99 l gs col-1 s gr
% Polyline
n 179 199 m 179 219 l gs col-1 s gr
% Polyline
n 199 219 m 199 199 l  79 199 l  79 219 l  clp gs col-1 s gr
% Polyline
n 199 199 m 199 99 l  179 99 l  179 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 399 99 m 399 79 l  279 79 l  279 99 l  clp gs col-1 s gr
% Polyline
n 399 219 m 399 199 l  279 199 l  279 219 l  clp gs col-1 s gr
% Polyline
n 399 199 m 399 99 l  379 99 l  379 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 599 99 m 599 79 l  479 79 l  479 99 l  clp gs col-1 s gr
% Polyline
n 599 219 m 599 199 l  479 199 l  479 219 l  clp gs col-1 s gr
% Polyline
n 599 219 m 599 79 l  579 79 l  579 219 l  clp gs col-1 s gr
% Polyline
n 320 399 m 320 299 l  300 299 l  300 399 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 519 399 m 519 299 l  499 299 l  499 399 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
86 73 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
173 72 m 
gs 1 -1 scale (m+1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
286 73 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
374 72 m 
gs 1 -1 scale (m+1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
484 72 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
576 73 m 
gs 1 -1 scale (m+1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
65 96 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
265 96 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
464 96 m 
gs 1 -1 scale (0) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1887 a Fo(Figure)h(2.4)249 1925 y Fz(1D)e(blo)q(c)o(k)g
(partitionin)o(g)e(with)i(o)o(v)o(erlap)f(and)g(comm)o(unicat)o(ion)e
(pattern)i(for)h(jacobi)e(iteration.)291 2027 y FA(The)14
b(resulting)g(parallel)f(algorithm)e(is)j(sho)o(wn)f(b)q(elo)o(w.)249
2122 y Fs(Example)i(2.12)21 b FA(Jacobi)14 b(iteration)f({)h(\014rst)g
(v)o(ersion)g(of)g(parallel)e(co)q(de)249 2176 y Fr(...)249
2230 y(REAL,)21 b(ALLOCATABLE)e(A\(:,:\),)i(B\(:,:\))249
2284 y(...)249 2338 y(!)h(Compute)e(number)h(of)g(processes)f(and)h
(myrank)249 2392 y(CALL)g(MPI_COMM_SIZE\(comm)o(,)e(p,)i(ierr\))249
2446 y(CALL)g(MPI_COMM_RANK\(comm)o(,)e(myrank,)h(ierr\))p
eop
%%Page: 42 56
42 55 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(42)1275 b(Chapter)13 b(2)249 507
y Fr(!)22 b(Compute)e(size)h(of)g(local)g(block)249 561
y(m)h(=)f(n/p)249 615 y(IF)g(\(myrank.LT.\(n-p*m\)\))d(THEN)314
669 y(m)k(=)g(m+1)249 723 y(END)f(IF)249 831 y(!)h(Allocate)e(local)h
(arrays)249 885 y(ALLOCATE)f(\(A\(0:n+1,0:m+1\),)f(B\(n,m\)\))249
939 y(...)249 993 y(!)j(Main)f(loop)249 1047 y(DO)g(WHILE)g(\(.NOT.)g
(converged\))314 1101 y(!)h(Compute)314 1155 y(DO)g(j=1,m)380
1209 y(DO)f(i=1,n)445 1263 y(B\(i,j\))g(=)g(0.25*\(A\(i-1,j\)+A\(i+)o
(1,j\)+)o(A\(i,j)o(-1\)+A)o(\(i,j)o(+1\)\))380 1317 y(END)g(DO)314
1371 y(END)h(DO)314 1425 y(DO)g(j=1,m)380 1479 y(DO)f(i=1,n)445
1533 y(A\(i,j\))g(=)g(B\(i,j\))380 1587 y(END)g(DO)314
1641 y(END)h(DO)314 1748 y(!)g(Communicate)314 1802 y(IF)g
(\(myrank.GT.0\))d(THEN)380 1856 y(CALL)i(MPI_SEND\(B\(1,1\),)d(n,)k
(MPI_REAL,)e(myrank-1,)g(tag,)g(comm,)h(ierr\))380 1910
y(CALL)g(MPI_RECV\(A\(1,0\),)d(n,)k(MPI_REAL,)e(myrank-1,)g(tag,)g
(comm,)1426 1964 y(status,)g(ierr\))314 2018 y(END)i(IF)314
2072 y(IF)g(\(myrank.LT.p-1\))d(THEN)380 2126 y(CALL)i
(MPI_SEND\(B\(1,m\),)d(n,)k(MPI_REAL,)e(myrank+1,)g(tag,)g(comm,)h
(ierr\))380 2180 y(CALL)g(MPI_RECV\(A\(1,m+1)o(\),)e(n,)i(MPI_REAL,)f
(myrank+1,)g(tag,)h(comm,)1426 2234 y(status,)f(ierr\))314
2288 y(END)i(IF)314 2342 y(...)249 2396 y(END)f(DO)249
2450 y FA(This)16 b(co)q(de)g(has)g(a)f(comm)o(unicatio)o(n)e(pattern)j
(similar)e(to)h(the)h(co)q(de)h(in)e(Example)f(2.9.)22
b(It)16 b(is)249 2504 y(unsafe,)d(since)h(eac)o(h)f(pro)q(cessor)h
(\014rst)g(sends)g(messages)f(to)g(its)f(t)o(w)o(o)h(neigh)o(b)q(ors,)f
(next)i(receiv)o(es)p eop
%%Page: 43 57
43 56 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(43)249 507 y FA(the)15 b(messages)f(they)g(ha)o(v)o(e)g(sen)o(t.)
291 590 y(One)h(w)o(a)o(y)e(to)h(get)h(a)f(safe)g(v)o(ersion)h(of)e
(this)i(co)q(de)g(is)f(to)g(alternate)h(the)f(order)h(of)f(sends)i(and)
249 644 y(receiv)o(es:)23 b(o)q(dd)15 b(rank)g(pro)q(cesses)j(will)c
(\014rst)j(send,)f(next)g(receiv)o(e,)g(and)f(ev)o(en)h(rank)g(pro)q
(cesses)249 698 y(will)j(\014rst)h(receiv)o(e,)j(next)d(send.)38
b(Th)o(us,)21 b(one)f(ac)o(hiev)o(es)h(the)g(comm)o(uni)o(cation)c
(pattern)k(of)249 752 y(Example)12 b(2.7.)291 806 y(The)20
b(mo)q(di\014ed)e(main)g(lo)q(op)h(is)h(sho)o(wn)g(b)q(elo)o(w.)35
b(W)m(e)20 b(shall)f(later)h(see)h(simpler)e(w)o(a)o(ys)g(of)249
860 y(dealing)13 b(with)h(this)g(problem.)249 943 y Fs(Example)h(2.13)
21 b FA(Main)13 b(lo)q(op)g(of)g(Jacobi)h(iteration)g({)f(safe)h(v)o
(ersion)g(of)g(parallel)e(co)q(de)249 997 y Fr(...)249
1051 y(!)22 b(Main)f(loop)249 1105 y(DO)g(WHILE\(.NOT.)f(converged\))
314 1159 y(!)i(Compute)314 1213 y(DO)g(j=1,m)380 1267
y(DO)f(i=1,n)445 1321 y(B\(i,j\))g(=)g(0.25*\(A\(i-1,j\)+A\(i+)o
(1,j\)+)o(A\(i,j)o(-1\)+A)o(\(i,j)o(+1\)\))380 1375 y(END)g(DO)314
1429 y(END)h(DO)314 1483 y(DO)g(j=1,m)380 1537 y(DO)f(i=1,n)445
1591 y(A\(i,j\))g(=)g(B\(i,j\))380 1645 y(END)g(DO)314
1699 y(END)h(DO)314 1807 y(!)g(Communicate)314 1861 y(IF)g
(\(MOD\(myrank,2\).EQ)o(.1\))c(THEN)380 1914 y(CALL)j
(MPI_SEND\(B\(1,1\),)d(n,)k(MPI_REAL,)e(myrank-1,)g(tag,)1339
1968 y(comm,)g(ierr\))380 2022 y(CALL)h(MPI_RECV\(A\(1,0\),)d(n,)k
(MPI_REAL,)e(myrank-1,)g(tag,)1164 2076 y(comm,)h(status,)f(ierr\))380
2130 y(IF)h(\(myrank.LT.p-1\))e(THEN)445 2184 y(CALL)i
(MPI_SEND\(B\(1,m\),)e(n,)i(MPI_REAL,)f(myrank+1,)g(tag,)1339
2238 y(comm,)g(ierr\))445 2292 y(CALL)h(MPI_RECV\(A\(1,m+1\),)d(n,)k
(MPI_REAL,)e(myrank+1,)f(tag,)1164 2346 y(comm,)i(status,)f(ierr\))380
2400 y(END)h(IF)314 2454 y(ELSE)65 b(!)22 b(myrank)e(is)i(even)380
2508 y(IF)f(\(myrank.GT.0\))e(THEN)p eop
%%Page: 44 58
44 57 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(44)1275 b(Chapter)13 b(2)445 507
y Fr(CALL)21 b(MPI_RECV\(A\(1,0\),)e(n,)i(MPI_REAL,)f(myrank-1,)g(tag,)
1164 561 y(comm,)h(status,)f(ierr\))445 615 y(CALL)h
(MPI_SEND\(B\(1,1\),)e(n,)i(MPI_REAL,)f(myrank-1,)g(tag,)1339
669 y(comm,)g(ierr\))380 723 y(END)h(IF)380 777 y(IF)g
(\(myrank.LT.p-1\))e(THEN)445 831 y(CALL)i(MPI_RECV\(A\(1,m+1\),)d(n,)k
(MPI_REAL,)e(myrank+1,)f(tag,)1164 885 y(comm,)i(status,)f(ierr\))445
939 y(CALL)h(MPI_SEND\(B\(1,m\),)e(n,)i(MPI_REAL,)f(myrank+1,)g(tag,)
1339 993 y(comm,)g(ierr\))380 1047 y(END)h(IF)314 1101
y(END)h(IF)249 1155 y(...)249 1209 y(END)f(DO)249 1329
y FD(2.6)52 b(Send-Receiv)o(e)249 1437 y FA(The)15 b(exc)o(hange)g
(comm)o(unication)d(pattern)j(exhibited)g(b)o(y)f(the)h(last)g(example)
e(is)i(su\016cien)o(tly)249 1491 y(frequen)o(t)g(to)g(justify)f(sp)q
(ecial)h(supp)q(ort.)20 b(The)15 b Fs(send-receiv)o(e)d
FA(op)q(eration)j(com)o(bines,)e(in)h(one)249 1545 y(call,)e(the)i
(sending)g(of)f(one)g(message)g(to)h(a)f(destination)g(and)g(the)h
(receiving)g(of)e(another)i(mes-)249 1599 y(sage)e(from)e(a)h(source.)
19 b(The)12 b(source)h(and)e(destination)h(are)g(p)q(ossibly)f(the)h
(same.)17 b(Send-receiv)o(e)249 1653 y(is)i(useful)g(for)g(comm)o
(unications)d(patterns)21 b(where)f(eac)o(h)f(no)q(de)h(b)q(oth)f
(sends)i(and)e(receiv)o(es)249 1707 y(messages.)28 b(One)18
b(example)e(is)h(an)g(exc)o(hange)h(of)f(data)g(b)q(et)o(w)o(een)h(t)o
(w)o(o)f(pro)q(cesses.)31 b(Another)249 1761 y(example)10
b(is)i(a)f(shift)h(op)q(eration)f(across)i(a)e(c)o(hain)g(of)g(pro)q
(cesses.)20 b(A)12 b(safe)g(program)e(that)h(imple-)249
1815 y(men)o(ts)i(suc)o(h)h(shift)g(will)e(need)i(to)g(use)g(an)f(o)q
(dd/ev)o(en)h(ordering)g(of)f(comm)o(unicatio)o(ns,)e(similar)249
1869 y(to)18 b(the)h(one)g(used)g(in)f(Example)f(2.13.)31
b(When)18 b(send-receiv)o(e)j(is)d(used,)i(data)e(\015o)o(ws)h(sim)o
(ul-)249 1923 y(taneously)d(in)g(b)q(oth)g(directions)h(\(logically)m
(,)d(at)i(least\))h(and)f(cycles)h(in)f(the)h(comm)o(unicatio)o(n)249
1977 y(pattern)e(do)e(not)h(lead)g(to)g(deadlo)q(c)o(k.)291
2031 y(Send-receiv)o(e)k(can)e(b)q(e)h(used)g(in)f(conjunction)g(with)g
(the)h(functions)g(describ)q(ed)h(in)e(Chap-)249 2085
y(ter)j(6)f(to)g(p)q(erform)f(shifts)i(on)f(logical)e(top)q(ologies.)31
b(Also,)18 b(send-receiv)o(e)i(can)f(b)q(e)g(used)g(for)249
2139 y(implemen)o(ting)14 b(remote)i(pro)q(cedure)j(calls:)24
b(one)17 b(blo)q(c)o(king)f(send-receiv)o(e)j(call)d(can)h(b)q(e)h
(used)249 2193 y(for)e(sending)h(the)f(input)h(parameters)f(to)g(the)h
(callee)f(and)h(receiving)f(bac)o(k)g(the)h(output)g(pa-)249
2247 y(rameters.)291 2301 y(There)g(is)g(compatibilit)o(y)c(b)q(et)o(w)
o(een)18 b(send-receiv)o(e)h(and)d(normal)f(sends)j(and)e(receiv)o(es.)
28 b(A)249 2355 y(message)13 b(sen)o(t)i(b)o(y)e(a)g(send-receiv)o(e)j
(can)e(b)q(e)g(receiv)o(ed)h(b)o(y)e(a)g(regular)h(receiv)o(e)h(or)e
(prob)q(ed)h(b)o(y)g(a)249 2408 y(regular)g(prob)q(e,)g(and)g(a)f
(send-receiv)o(e)j(can)e(receiv)o(e)i(a)d(message)h(sen)o(t)h(b)o(y)e
(a)h(regular)g(send.)p eop
%%Page: 45 59
45 58 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(45)249 507 y Fw(MPI)p 326 507 13 2 v 14 w(SENDRECV\(sendbuf,)24
b(sendcount,)h(sendt)o(yp)q(e,)h(dest,)d(sendtag,)h(recvbuf,)h
(recvcount,)249 561 y(recvt)o(yp)q(e,)16 b(source,)e(recvtag,)h(comm,)c
(status\))332 636 y Fv(IN)158 b Fw(sendbuf)415 b Fv(initial)16
b(address)e(of)f(send)h(bu\013er)332 686 y(IN)158 b Fw(sendcount)374
b Fv(n)o(um)o(b)q(er)14 b(of)f(en)o(tries)h(to)f(send)332
736 y(IN)158 b Fw(sendt)o(yp)q(e)397 b Fv(t)o(yp)q(e)14
b(of)e(en)o(tries)i(in)g(send)g(bu\013er)332 785 y(IN)158
b Fw(dest)476 b Fv(rank)14 b(of)f(destination)332 835
y(IN)158 b Fw(sendtag)414 b Fv(send)14 b(tag)332 885
y(OUT)114 b Fw(recvbuf)422 b Fv(initial)16 b(address)e(of)f(receiv)o(e)
h(bu\013er)332 935 y(IN)158 b Fw(recvcount)381 b Fv(max)14
b(n)o(um)o(b)q(er)f(of)g(en)o(tries)h(to)f(receiv)o(e)332
985 y(IN)158 b Fw(recvt)o(yp)q(e)404 b Fv(t)o(yp)q(e)14
b(of)e(en)o(tries)i(in)g(receiv)o(e)g(bu\013er)332 1034
y(IN)158 b Fw(source)438 b Fv(rank)14 b(of)f(source)332
1084 y(IN)158 b Fw(recvtag)421 b Fv(receiv)o(e)14 b(tag)332
1134 y(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)332
1184 y(OUT)114 b Fw(status)443 b Fv(return)14 b(status)249
1294 y Fr(int)21 b(MPI)p 405 1294 14 2 v 15 w(Sendrecv\(void)e
(*sendbuf,)h(int)i(sendcount,)d(MPI)p 1336 1294 V 15
w(Datatype)h(sendtype,)540 1348 y(int)h(dest,)g(int)g(sendtag,)f(void)h
(*recvbuf,)f(int)h(recvcount,)540 1402 y(MPI)p 609 1402
V 15 w(Datatype)f(recvtype,)g(int)h(source,)540 1456
y(MPI)p 609 1456 V 15 w(Datatype)f(recvtag,)g(MPI)p 1082
1456 V 15 w(Comm)h(comm,)g(MPI)p 1403 1456 V 15 w(Status)f(*status\))
249 1540 y(MPI)p 318 1540 V 15 w(SENDRECV\(SENDBUF,)e(SENDCOUNT,)i
(SENDTYPE,)g(DEST,)h(SENDTAG,)f(RECVBUF,)540 1594 y(RECVCOUNT,)f
(RECVTYPE,)h(SOURCE,)h(RECVTAG,)f(COMM,)h(STATUS,)540
1648 y(IERROR\))336 1702 y(<type>)g(SENDBUF\(*\),)e(RECVBUF\(*\))336
1756 y(INTEGER)i(SENDCOUNT,)e(SENDTYPE,)h(DEST,)h(SENDTAG,)f
(RECVCOUNT,)g(RECVTYPE,)336 1810 y(SOURCE,)h(RECV)g(TAG,)g(COMM,)f
(STATUS\(MPI)p 1082 1810 V 14 w(STATUS)p 1228 1810 V
14 w(SIZE\),)h(IERROR)291 1894 y Fw(MPI)p 368 1894 13
2 v 14 w(SENDRECV)13 b FA(executes)j(a)e(blo)q(c)o(king)f(send)i(and)f
(receiv)o(e)i(op)q(eration.)i(Both)d(the)g(send)249 1948
y(and)k(receiv)o(e)h(use)f(the)h(same)e(comm)o(uni)o(cator,)f(but)i(ha)
o(v)o(e)g(distinct)g(tag)f(argumen)o(ts.)32 b(The)249
2002 y(send)12 b(bu\013er)h(and)e(receiv)o(e)i(bu\013ers)g(m)o(ust)d(b)
q(e)j(disjoin)o(t,)d(and)h(ma)o(y)f(ha)o(v)o(e)h(di\013eren)o(t)i
(lengths)f(and)249 2056 y(datat)o(yp)q(es.)19 b(The)14
b(next)g(function)g(handles)g(the)h(case)g(where)g(the)f(bu\013ers)h
(are)g(not)e(disjoin)o(t.)291 2110 y(The)f(seman)o(tics)g(of)g(a)g
(send-receiv)o(e)j(op)q(eration)d(is)g(what)g(w)o(ould)g(b)q(e)h
(obtained)f(if)g(the)g(caller)249 2164 y(fork)o(ed)18
b(t)o(w)o(o)g(concurren)o(t)i(threads,)f(one)g(to)e(execute)j(the)f
(send,)h(and)e(one)g(to)g(execute)i(the)249 2217 y(receiv)o(e,)15
b(follo)o(w)o(ed)d(b)o(y)i(a)f(join)g(of)g(these)j(t)o(w)o(o)d
(threads.)p eop
%%Page: 46 60
46 59 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(46)1275 b(Chapter)13 b(2)249 507
y Fw(MPI)p 326 507 13 2 v 14 w(SENDRECV)p 554 507 V 14
w(REPLA)o(CE\(buf,)c(count,)i(datat)o(yp)q(e,)g(dest,)f(sendtag,)h
(source,)g(recvtag,)g(comm,)249 561 y(status\))332 636
y Fv(INOUT)71 b Fw(buf)491 b Fv(initial)14 b(address)e(of)e(send)i(and)
f(receiv)o(e)h(bu\013er)332 686 y(IN)158 b Fw(count)450
b Fv(n)o(um)o(b)q(er)20 b(of)f(en)o(tries)h(in)g(send)g(and)g(receiv)o
(e)1079 740 y(bu\013er)332 790 y(IN)158 b Fw(datat)o(yp)q(e)397
b Fv(t)o(yp)q(e)11 b(of)f(en)o(tries)h(in)g(send)g(and)g(receiv)o(e)g
(bu\013er)332 839 y(IN)158 b Fw(dest)476 b Fv(rank)14
b(of)f(destination)332 889 y(IN)158 b Fw(sendtag)414
b Fv(send)14 b(message)g(tag)332 939 y(IN)158 b Fw(source)438
b Fv(rank)14 b(of)f(source)332 989 y(IN)158 b Fw(recvtag)421
b Fv(receiv)o(e)14 b(message)g(tag)332 1039 y(IN)158
b Fw(comm)439 b Fv(comm)o(unicator)332 1088 y(OUT)114
b Fw(status)443 b Fv(status)14 b(ob)r(ject)249 1199 y
Fr(int)21 b(MPI)p 405 1199 14 2 v 15 w(Sendrecv)p 596
1199 V 14 w(replace\(void*)e(buf,)i(int)h(count,)e(MPI)p
1330 1199 V 15 w(Datatype)g(datatype,)540 1253 y(int)h(dest,)g(int)g
(sendtag,)f(int)h(source,)f(int)i(recvtag,)540 1307 y(MPI)p
609 1307 V 15 w(Comm)f(comm,)f(MPI)p 929 1307 V 16 w(Status)g
(*status\))249 1390 y(MPI)p 318 1390 V 15 w(SENDRECV)p
509 1390 V 14 w(REPLACE\(BUF,)f(COUNT,)i(DATATYPE,)f(DEST,)h(SENDTAG,)f
(SOURCE,)540 1444 y(RECVTAG,)g(COMM,)h(STATUS,)f(IERROR\))336
1498 y(<type>)h(BUF\(*\))336 1552 y(INTEGER)g(COUNT,)f(DATATYPE,)g
(DEST,)h(SENDTAG,)f(SOURCE,)g(RECVTAG,)g(COMM,)336 1606
y(STATUS\(MPI)p 559 1606 V 14 w(STATUS)p 705 1606 V 14
w(SIZE\),)h(IERROR)291 1690 y Fw(MPI)p 368 1690 13 2
v 14 w(SENDRECV)p 596 1690 V 14 w(REPLA)o(CE)f FA(executes)j(a)e(blo)q
(c)o(king)g(send)h(and)f(receiv)o(e.)42 b(The)22 b(same)249
1744 y(bu\013er)d(is)e(used)i(b)q(oth)f(for)f(the)h(send)h(and)e(for)g
(the)i(receiv)o(e,)g(so)f(that)f(the)i(message)e(sen)o(t)i(is)249
1798 y(replaced)c(b)o(y)f(the)g(message)g(receiv)o(ed.)291
1852 y(The)k(example)f(b)q(elo)o(w)h(sho)o(ws)g(the)g(main)e(lo)q(op)i
(of)f(the)i(parallel)d(Jacobi)i(co)q(de,)i(reimple-)249
1906 y(men)o(ted)14 b(using)f(send-receiv)o(e.)249 2002
y Fs(Example)i(2.14)21 b FA(Main)13 b(lo)q(op)g(of)g(Jacobi)h(co)q(de)h
({)e(v)o(ersion)h(using)g(send-receiv)o(e.)249 2056 y
Fr(...)249 2110 y(!)22 b(Main)f(loop)249 2164 y(DO)g
(WHILE\(.NOT.converged)o(\))314 2217 y(!)h(Compute)314
2271 y(DO)g(j=1,m)380 2325 y(DO)f(i=1,n)445 2379 y(B\(i,j\))g(=)g
(0.25*\(A\(i-1,j\)+A\(i+)o(1,j\)+)o(A\(i,j)o(-1\)+A)o(\(i,j)o(+1\)\))
380 2433 y(END)g(DO)314 2487 y(END)h(DO)p eop
%%Page: 47 61
47 60 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(47)314 507 y Fr(DO)22 b(j=1,m)380 561 y(DO)f(i=1,n)445
615 y(A\(i,j\))g(=)g(B\(i,j\))380 669 y(END)g(DO)314
723 y(END)h(DO)314 831 y(!)g(Communicate)314 885 y(IF)g
(\(myrank.GT.0\))d(THEN)380 939 y(CALL)i(MPI_SENDRECV\(B\(1)o(,1\),)d
(n,)k(MPI_REAL,)e(myrank-1,)g(tag,)467 993 y(A\(1,0\),)g(n,)i
(MPI_REAL,)e(myrank-1,)g(tag,)h(comm,)f(status,)h(ierr\))314
1047 y(END)h(IF)314 1101 y(IF)g(\(myrank.LT.p-1\))d(THEN)380
1155 y(CALL)i(MPI_SENDRECV\(B\(1)o(,m\),)d(n,)k(MPI_REAL,)e(myrank+1,)g
(tag,)445 1209 y(A\(1,m+1\),)g(n,)i(MPI_REAL,)d(myrank+1,)h(tag,)h
(comm,)g(status,)f(ierr\))314 1263 y(END)i(IF)249 1317
y(...)249 1371 y(END)f(DO)249 1425 y FA(This)14 b(co)q(de)h(is)e(safe,)
h(not)o(withstanding)f(the)i(cyclic)f(comm)o(unicati)o(on)d(pattern.)
249 1520 y FB(A)n(dvic)n(e)20 b(to)h(implementors.)72
b FA(Additional,)19 b(in)o(termediate)g(bu\013ering)h(is)g(needed)h
(for)f(the)249 1574 y(replace)f(v)n(arian)o(t.)31 b(Only)18
b(a)h(\014xed)g(amoun)o(t)d(of)i(bu\013er)i(space)f(should)f(b)q(e)h
(used,)h(otherwise)249 1628 y(send-receiv)o(e)c(will)c(not)i(b)q(e)g
(more)f(robust)i(then)f(the)g(equiv)n(alen)o(t)g(pair)f(of)g(blo)q(c)o
(king)g(send)i(and)249 1682 y(receiv)o(e)g(calls.)j(\()p
FB(End)e(of)e(advic)n(e)i(to)e(implementors.)p FA(\))249
1802 y FD(2.7)52 b(Null)19 b(Pro)q(cesses)249 1910 y
FA(In)14 b(man)o(y)d(instances,)j(it)f(is)h(con)o(v)o(enien)o(t)g(to)f
(sp)q(ecify)h(a)f(\\dumm)o(y")d(source)15 b(or)e(destination)h(for)249
1964 y(comm)o(unication.)291 2018 y(In)j(the)h(Jacobi)f(example,)g
(this)g(will)f(a)o(v)o(oid)g(sp)q(ecial)i(handling)e(of)h(b)q(oundary)g
(pro)q(cesses.)249 2072 y(This)c(also)f(simpli\014es)f(handling)h(of)g
(b)q(oundaries)h(in)g(the)g(case)h(of)e(a)h(non-circular)g(shift,)f
(when)249 2126 y(used)j(in)e(conjunction)h(with)g(the)g(functions)g
(describ)q(ed)i(in)d(Chapter)i(6.)291 2180 y(The)20 b(sp)q(ecial)g(v)n
(alue)f Fq(MPI)p 708 2180 12 2 v 13 w(PROC)p 824 2180
V 13 w(NULL)i FA(can)f(b)q(e)g(used)h(instead)f(of)g(a)f(rank)h(wherev)
o(er)i(a)249 2234 y(source)15 b(or)e(a)g(destination)g(argumen)o(t)f
(is)h(required)h(in)f(a)g(comm)o(unication)d(function.)17
b(A)d(com-)249 2288 y(m)o(unication)d(with)h(pro)q(cess)j
Fq(MPI)p 773 2288 V 12 w(PROC)p 888 2288 V 13 w(NULL)e
FA(has)g(no)g(e\013ect.)19 b(A)13 b(send)h(to)e Fq(MPI)p
1521 2288 V 13 w(PROC)p 1637 2288 V 13 w(NULL)249 2342
y FA(succeeds)k(and)d(returns)i(as)e(so)q(on)h(as)f(p)q(ossible.)18
b(A)13 b(receiv)o(e)i(from)c Fq(MPI)p 1355 2342 V 13
w(PROC)p 1471 2342 V 13 w(NULL)j FA(succeeds)249 2396
y(and)g(returns)i(as)f(so)q(on)f(as)h(p)q(ossible)g(with)f(no)g(mo)q
(di\014cations)e(to)j(the)g(receiv)o(e)h(bu\013er.)k(When)249
2450 y(a)13 b(receiv)o(e)i(with)e Fw(source)i FA(=)e
Fq(MPI)p 753 2450 V 13 w(PROC)p 869 2450 V 13 w(NULL)h
FA(is)f(executed)i(then)f(the)g(status)h(ob)r(ject)f(returns)249
2504 y Fw(source)h FA(=)f Fq(MPI)p 490 2504 V 13 w(PROC)p
606 2504 V 13 w(NULL)p FA(,)g Fw(tag)f FA(=)h Fq(MPI)p
925 2504 V 13 w(ANY)p 1017 2504 V 13 w(T)m(A)o(G)f FA(and)h
Fw(count)h(=)f(0)p FA(.)p eop
%%Page: 48 62
48 61 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(48)1275 b(Chapter)13 b(2)291 507
y FA(W)m(e)g(tak)o(e)g(adv)n(an)o(tage)g(of)g(n)o(ull)g(pro)q(cesses)j
(to)e(further)g(simplify)d(the)j(parallel)f(Jacobi)g(co)q(de.)249
648 y Fs(Example)i(2.15)21 b FA(Jacobi)12 b(co)q(de)h({)g(v)o(ersion)f
(of)g(parallel)g(co)q(de)h(using)f(sendrecv)j(and)d(n)o(ull)g(pro-)249
702 y(cesses.)249 756 y Fr(...)249 810 y(REAL,)21 b(ALLOCATABLE)e
(A\(:,:\),)i(B\(:,:\))249 864 y(...)249 918 y(!)h(Compute)e(number)h
(of)g(processes)f(and)h(myrank)249 972 y(CALL)g(MPI_COMM_SIZE\(comm)o
(,)e(p,)i(ierr\))249 1026 y(CALL)g(MPI_COMM_RANK\(comm)o(,)e(myrank,)h
(ierr\))249 1134 y(!)i(Compute)e(size)h(of)g(local)g(block)249
1188 y(m)h(=)f(n/p)249 1242 y(IF)g(\(myrank.LT.\(n-p*m\)\))d(THEN)314
1296 y(m)k(=)g(m+1)249 1350 y(END)f(IF)249 1458 y(!)h(Compute)e
(neighbors)249 1512 y(IF)h(\(myrank.EQ.0\))f(THEN)314
1566 y(left)h(=)h(MPI_PROC_NULL)249 1620 y(ELSE)314 1674
y(left)f(=)h(myrank)f(-1)249 1728 y(END)g(IF)249 1782
y(IF)g(\(myrank.EQ.p-1\))e(THEN)314 1836 y(right)i(=)h(MPI_PROC_NULL)
249 1890 y(ELSE)314 1944 y(right)f(=)h(myrank+1)249 1998
y(END)f(IF)249 2105 y(!)h(Allocate)e(local)h(arrays)249
2159 y(ALLOCATE)f(\(A\(0:n+1,0:m+1\),)f(B\(n,m\)\))249
2213 y(...)249 2267 y(!)j(Main)f(loop)249 2321 y(DO)g(WHILE\(.NOT.)f
(converged\))314 2375 y(!)i(Compute)314 2429 y(DO)g(j=1,m)380
2483 y(DO)f(i=1,n)p eop
%%Page: 49 63
49 62 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(49)445 507 y Fr(B\(i,j\))21 b(=)g(0.25*\(A\(i-1,j\)+A\(i+)o
(1,j\)+)o(A\(i,j)o(-1\)+A)o(\(i,j)o(+1\)\))380 561 y(END)g(DO)314
615 y(END)h(DO)314 669 y(DO)g(j=1,m)380 723 y(DO)f(i=1,n)445
777 y(A\(i,j\))g(=)g(B\(i,j\))380 831 y(END)g(DO)314
885 y(END)h(DO)314 993 y(!)g(Communicate)314 1047 y(CALL)f
(MPI_SENDRECV\(B\(1,1\))o(,)e(n,)i(MPI_REAL,)f(left,)h(tag,)511
1101 y(A\(1,0\),)f(n,)h(MPI_REAL,)f(left,)h(tag,)g(comm,)g(status,)f
(ierr\))314 1155 y(CALL)65 b(MPI_SENDRECV\(B\(1,)o(m\),)19
b(n,)i(MPI_REAL,)f(right,)h(tag,)445 1209 y(A\(1,m+1\),)f(n,)i
(MPI_REAL,)d(right,)i(tag,)g(comm,)g(status,)f(ierr\))249
1263 y(...)249 1317 y(END)h(DO)249 1371 y FA(The)12 b(b)q(oundary)f
(test)h(that)g(w)o(as)f(previously)g(executed)i(inside)e(the)h(lo)q(op)
f(has)g(b)q(een)i(e\013ectiv)o(ely)249 1425 y(mo)o(v)o(ed)18
b(outside)i(the)h(lo)q(op.)35 b(Although)19 b(this)h(is)g(not)g(exp)q
(ected)i(to)d(c)o(hange)i(p)q(erformance)249 1479 y(signi\014can)o(tly)
m(,)12 b(the)i(co)q(de)h(is)f(simpli\014ed.)249 1599
y FD(2.8)52 b(Non)o(blo)q(c)o(king)18 b(Comm)o(unication)249
1707 y FA(One)12 b(can)f(impro)o(v)o(e)f(p)q(erformance)h(on)g(man)o(y)
e(systems)j(b)o(y)f(o)o(v)o(erlapping)f(comm)o(unicatio)o(n)f(and)249
1761 y(computation.)16 b(This)e(is)g(esp)q(ecially)f(true)i(on)e
(systems)h(where)h(comm)o(unication)c(can)i(b)q(e)i(exe-)249
1815 y(cuted)e(autonomously)d(b)o(y)h(an)h(in)o(telligen)o(t)f(comm)o
(unicati)o(on)e(con)o(troller.)17 b(Multi-threading)12
b(is)249 1869 y(one)g(mec)o(hanism)e(for)h(ac)o(hieving)g(suc)o(h)i(o)o
(v)o(erlap.)j(While)11 b(one)h(thread)h(is)f(blo)q(c)o(k)o(ed,)f(w)o
(aiting)g(for)249 1923 y(a)i(comm)o(unication)e(to)i(complete,)g
(another)h(thread)g(ma)o(y)e(execute)k(on)d(the)h(same)f(pro)q(cessor.)
249 1977 y(This)g(mec)o(hanism)e(is)i(e\016cien)o(t)g(if)g(the)g
(system)g(supp)q(orts)i(ligh)o(t-w)o(eigh)o(t)c(threads)j(that)f(are)h
(in-)249 2031 y(tegrated)g(with)e(the)h(comm)o(unicatio)o(n)d
(subsystem.)18 b(An)12 b(alternativ)o(e)h(mec)o(hanism)d(that)i(often)
249 2085 y(giv)o(es)g(b)q(etter)h(p)q(erformance)f(is)f(to)h(use)h
Fs(non)o(blo)q(c)o(kin)o(g)e(comm)o(unicati)o(on)p FA(.)j(A)24
b(non)o(blo)q(c)o(king)249 2139 y Fs(p)q(ost-send)10
b FA(initiates)i(a)g(send)h(op)q(eration,)g(but)f(do)q(es)h(not)g
(complete)e(it.)17 b(The)c(p)q(ost-send)h(will)249 2193
y(return)i(b)q(efore)f(the)g(message)f(is)g(copied)g(out)h(of)e(the)i
(send)g(bu\013er.)21 b(A)14 b(separate)i Fs(complete-)249
2247 y(send)11 b FA(call)h(is)g(needed)i(to)e(complete)g(the)h(comm)o
(unication,)c(that)k(is,)f(to)g(v)o(erify)g(that)h(the)g(data)249
2301 y(has)18 b(b)q(een)h(copied)f(out)f(of)g(the)h(send)h(bu\013er.)30
b(With)17 b(suitable)h(hardw)o(are,)g(the)g(transfer)h(of)249
2355 y(data)13 b(out)h(of)e(the)j(sender)g(memory)c(ma)o(y)g(pro)q
(ceed)k(concurren)o(tly)g(with)e(computations)f(done)249
2408 y(at)18 b(the)h(sender)h(after)e(the)h(send)g(w)o(as)f(initiated)g
(and)g(b)q(efore)g(it)g(completed.)31 b(Similarly)l(,)16
b(a)249 2462 y(non)o(blo)q(c)o(king)e Fs(p)q(ost-receiv)o(e)f
FA(initiates)i(a)g(receiv)o(e)i(op)q(eration,)e(but)h(do)q(es)g(not)f
(complete)g(it.)p eop
%%Page: 50 64
50 63 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(50)1275 b(Chapter)13 b(2)249 507
y FA(The)j(call)e(will)g(return)i(b)q(efore)g(a)f(message)g(is)g
(stored)h(in)o(to)e(the)i(receiv)o(e)g(bu\013er.)23 b(A)15
b(separate)249 561 y Fs(complete-receiv)o(e)10 b FA(is)i(needed)j(to)e
(complete)f(the)i(receiv)o(e)g(op)q(eration)f(and)g(v)o(erify)g(that)g
(the)249 615 y(data)h(has)g(b)q(een)h(receiv)o(ed)g(in)o(to)e(the)i
(receiv)o(e)g(bu\013er.)291 669 y(A)g(non)o(blo)q(c)o(king)f(send)i
(can)f(b)q(e)h(p)q(osted)g(whether)g(a)f(matc)o(hing)e(receiv)o(e)k
(has)e(b)q(een)h(p)q(osted)249 723 y(or)e(not.)k(The)d(p)q(ost-send)g
(call)e(has)h(lo)q(cal)g(completion)e(seman)o(tics:)18
b(it)13 b(returns)j(immedia)o(tely)m(,)249 777 y(irresp)q(ectiv)o(e)e
(of)d(the)h(status)h(of)e(other)i(pro)q(cesses.)20 b(If)11
b(the)i(call)e(causes)i(some)e(system)g(resource)249
831 y(to)g(b)q(e)h(exhausted,)h(then)e(it)g(will)f(fail)g(and)h(return)
h(an)f(error)h(co)q(de.)18 b(Qualit)o(y)11 b(implem)o(en)o(tations)249
885 y(of)e Fw(MPI)g FA(should)g(ensure)i(that)e(this)g(happ)q(ens)i
(only)d(in)h(\\pathological")e(cases.)18 b(That)9 b(is,)h(an)f
Fw(MPI)249 939 y FA(implemen)o(tation)i(should)k(b)q(e)g(able)f(to)h
(supp)q(ort)g(a)g(large)f(n)o(um)o(b)q(er)g(of)g(p)q(ending)h(non)o
(blo)q(c)o(king)249 993 y(op)q(erations.)291 1047 y(The)j
(complete-send)g(returns)h(when)f(data)g(has)f(b)q(een)i(copied)f(out)g
(of)f(the)h(send)h(bu\013er.)249 1101 y(The)12 b(complete-send)g(has)g
(non-lo)q(cal)f(completion)f(seman)o(tics.)17 b(The)12
b(call)f(ma)o(y)f(return)j(b)q(efore)249 1155 y(a)k(matc)o(hing)d
(receiv)o(e)k(is)f(p)q(osted,)h(if)e(the)h(message)g(is)f(bu\013ered.)
28 b(On)17 b(the)h(other)f(hand,)g(the)249 1209 y(complete-send)d(ma)o
(y)e(not)i(return)h(un)o(til)e(a)h(matc)o(hing)e(receiv)o(e)j(is)e(p)q
(osted.)291 1263 y(There)k(is)f(compatibilit)o(y)e(b)q(et)o(w)o(een)k
(blo)q(c)o(king)d(and)h(non)o(blo)q(c)o(king)f(comm)o(unication)e
(func-)249 1317 y(tions.)18 b(Non)o(blo)q(c)o(king)13
b(sends)i(can)f(b)q(e)g(matc)o(hed)g(with)f(blo)q(c)o(king)g(receiv)o
(es,)i(and)f(vice-v)o(ersa.)249 1405 y FB(A)n(dvic)n(e)g(to)g(users.)36
b FA(The)13 b(use)h(of)e(non)o(blo)q(c)o(king)g(sends)i(allo)o(ws)e
(the)h(sender)i(to)e(pro)q(ceed)h(ahead)249 1459 y(of)19
b(the)h(receiv)o(er,)i(so)e(that)g(the)g(computation)e(is)h(more)g
(toleran)o(t)h(of)f(\015uctuations)h(in)f(the)249 1513
y(sp)q(eeds)d(of)d(the)i(t)o(w)o(o)e(pro)q(cesses.)249
1581 y(The)h Fw(MPI)g FA(message-passing)f(mo)q(del)g(\014ts)h(a)g
(\\push")g(mo)q(del,)e(where)j(comm)o(unication)c(is)j(ini-)249
1635 y(tiated)i(b)o(y)g(the)h(sender.)27 b(The)16 b(comm)o(unication)d
(will)i(generally)h(ha)o(v)o(e)g(lo)o(w)o(er)g(o)o(v)o(erhead)g(if)g(a)
249 1689 y(receiv)o(e)f(bu\013er)g(is)f(already)g(p)q(osted)h(when)f
(the)h(sender)g(initiates)f(the)g(comm)o(unication.)h(The)249
1743 y(use)e(of)f(non)o(blo)q(c)o(king)g(receiv)o(es)i(allo)o(ws)d(one)
i(to)g(p)q(ost)g(receiv)o(es)h(\\early")e(and)g(so)h(ac)o(hiev)o(e)g
(lo)o(w)o(er)249 1797 y(comm)o(unication)c(o)o(v)o(erheads)14
b(without)e(blo)q(c)o(king)f(the)j(receiv)o(er)g(while)e(it)g(w)o(aits)
g(for)h(the)g(send.)249 1851 y(\()p FB(End)j(of)f(advic)n(e)g(to)g
(users.)p FA(\))249 1939 y Fs(2.8.1)48 b(Request)15 b(Ob)s(jects)249
2022 y FA(Non)o(blo)q(c)o(king)g(comm)o(unications)f(use)j
Fs(request)e FA(ob)r(jects)j(to)e(iden)o(tify)g(comm)o(unicatio)o(n)e
(op-)249 2076 y(erations)k(and)g(link)e(the)j(p)q(osting)e(op)q
(eration)h(with)f(the)h(completion)e(op)q(eration.)30
b(Request)249 2130 y(ob)r(jects)19 b(are)g(allo)q(cated)e(b)o(y)h
Fw(MPI)f FA(and)h(reside)h(in)f Fw(MPI)f FA(\\system")g(memory)m(.)27
b(The)19 b(request)249 2184 y(ob)r(ject)13 b(is)f(opaque)g(in)f(the)i
(sense)h(that)e(the)h(t)o(yp)q(e)f(and)g(structure)i(of)e(the)g(ob)r
(ject)h(is)f(not)g(visible)249 2238 y(to)h(users.)19
b(The)13 b(application)e(program)g(can)i(only)f(manipulate)f(handles)i
(to)f(request)j(ob)r(jects,)249 2292 y(not)k(the)g(ob)r(jects)h
(themselv)o(es.)33 b(The)19 b(system)g(ma)o(y)e(use)i(the)h(request)g
(ob)r(ject)g(to)e(iden)o(tify)249 2346 y(v)n(arious)11
b(prop)q(erties)i(of)e(a)g(comm)o(unication)e(op)q(eration,)i(suc)o(h)h
(as)g(the)g(comm)o(unication)c(bu\013er)249 2400 y(that)15
b(is)g(asso)q(ciated)g(with)g(it,)f(or)h(to)f(store)i(information)c(ab)
q(out)j(the)g(status)h(of)e(the)h(p)q(ending)249 2454
y(comm)o(unication)g(op)q(eration.)30 b(The)18 b(user)h(ma)o(y)d
(access)k(request)g(ob)r(jects)f(through)f(v)n(arious)249
2508 y Fw(MPI)13 b FA(calls)h(to)f(inquire)h(ab)q(out)g(the)g(status)h
(of)e(p)q(ending)h(comm)o(unication)d(op)q(erations.)p
eop
%%Page: 51 65
51 64 bop 2 223 2 150 v 2 76 150 2 v 1928 76 V 2076 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(51)291 507 y FA(The)11 b(sp)q(ecial)f(v)n(alue)g
Fr(MPI)p 677 507 14 2 v 15 w(REQUEST)p 846 507 V 15 w(NULL)f
FA(is)i(used)g(to)g(indicate)f(an)g(in)o(v)n(alid)f(request)j(handle.)
249 561 y(Op)q(erations)j(that)f(deallo)q(cate)g(request)h(ob)r(jects)g
(set)g(the)f(request)i(handle)e(to)f(this)h(v)n(alue.)249
644 y Fs(2.8.2)48 b(P)o(osting)13 b(Op)q(erations)249
727 y FA(Calls)c(that)i(p)q(ost)f(send)h(or)f(receiv)o(e)i(op)q
(erations)e(ha)o(v)o(e)g(the)h(same)e(names)g(as)i(the)f(corresp)q
(onding)249 781 y(blo)q(c)o(king)k(calls,)h(except)h(that)f(an)g
(additional)e(pre\014x)j(of)e Fw(I)h FA(\(for)g(imm)o(ediate\))e
(indicates)i(that)249 835 y(the)g(call)e(is)g(non)o(blo)q(c)o(king.)249
960 y Fw(MPI)p 326 960 13 2 v 14 w(ISEND\(buf,)h(count,)h(datat)o(yp)q
(e,)f(dest,)h(tag,)e(comm,)e(request\))332 1035 y Fv(IN)158
b Fw(buf)491 b Fv(initial)16 b(address)e(of)f(send)h(bu\013er)332
1085 y(IN)158 b Fw(count)450 b Fv(n)o(um)o(b)q(er)14
b(of)f(en)o(tries)h(in)g(send)f(bu\013er)332 1134 y(IN)158
b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14 b(of)f(eac)o(h)g(send)h
(bu\013er)g(en)o(try)332 1184 y(IN)158 b Fw(dest)476
b Fv(rank)14 b(of)f(destination)332 1234 y(IN)158 b Fw(tag)490
b Fv(message)14 b(tag)332 1284 y(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)332 1334 y(OUT)114 b Fw(request)423
b Fv(request)14 b(handle)249 1444 y Fr(int)21 b(MPI)p
405 1444 14 2 v 15 w(Isend\(void*)f(buf,)h(int)g(count,)g(MPI)p
1097 1444 V 15 w(Datatype)f(datatype,)g(int)h(dest,)540
1498 y(int)g(tag,)g(MPI)p 805 1498 V 15 w(Comm)g(comm,)g(MPI)p
1126 1498 V 15 w(Request)f(*request\))249 1582 y(MPI)p
318 1582 V 15 w(ISEND\(BUF,)g(COUNT,)g(DATATYPE,)g(DEST,)h(TAG,)g
(COMM,)g(REQUEST,)f(IERROR\))336 1636 y(<type>)h(BUF\(*\))336
1690 y(INTEGER)g(COUNT,)f(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(REQUEST,)f
(IERROR)291 1774 y Fw(MPI)p 368 1774 13 2 v 14 w(ISEND)14
b FA(p)q(osts)g(a)g(standard-mo)q(de,)e(non)o(blo)q(c)o(king)h(send.)
249 1898 y Fw(MPI)p 326 1898 V 14 w(IRECV)g(\(buf,)h(count,)g(datat)o
(yp)q(e,)h(source,)f(tag,)f(comm,)f(request\))332 1973
y Fv(OUT)114 b Fw(buf)491 b Fv(initial)16 b(address)e(of)f(receiv)o(e)h
(bu\013er)332 2023 y(IN)158 b Fw(count)450 b Fv(n)o(um)o(b)q(er)14
b(of)f(en)o(tries)h(in)g(receiv)o(e)g(bu\013er)332 2073
y(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14
b(of)f(eac)o(h)g(receiv)o(e)h(bu\013er)g(en)o(try)332
2123 y(IN)158 b Fw(source)438 b Fv(rank)14 b(of)f(source)332
2172 y(IN)158 b Fw(tag)490 b Fv(message)14 b(tag)332
2222 y(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)332
2272 y(OUT)114 b Fw(request)423 b Fv(request)14 b(handle)249
2382 y Fr(int)21 b(MPI)p 405 2382 14 2 v 15 w(Irecv\(void*)f(buf,)h
(int)g(count,)g(MPI)p 1097 2382 V 15 w(Datatype)f(datatype,)540
2436 y(int)h(source,)f(int)h(tag,)g(MPI)p 1066 2436 V
15 w(Comm)g(comm,)540 2490 y(MPI)p 609 2490 V 15 w(Request)f
(*request\))p eop
%%Page: 52 66
52 65 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(52)1275 b(Chapter)13 b(2)249 507
y Fr(MPI)p 318 507 14 2 v 15 w(IRECV\(BUF,)20 b(COUNT,)g(DATATYPE,)g
(SOURCE,)h(TAG,)g(COMM,)f(REQUEST,)h(IERROR\))336 561
y(<type>)g(BUF\(*\))336 615 y(INTEGER)g(COUNT,)f(DATATYPE,)g(SOURCE,)g
(TAG,)h(COMM,)g(REQUEST,)f(IERROR)291 699 y Fw(MPI)p
368 699 13 2 v 14 w(IRECV)12 b FA(p)q(osts)j(a)e(non)o(blo)q(c)o(king)g
(receiv)o(e.)291 753 y(These)k(calls)f(allo)q(cate)g(a)g(request)i(ob)r
(ject)f(and)f(return)i(a)e(handle)g(to)g(it)g(in)g Fw(request)p
FA(.)27 b(The)249 807 y(request)14 b(is)d(used)i(to)f(query)g(the)h
(status)f(of)f(the)i(comm)o(unicatio)o(n)c(or)j(w)o(ait)f(for)h(its)g
(completion.)291 861 y(A)j(non)o(blo)q(c)o(king)g(p)q(ost-send)i(call)e
(indicates)h(that)g(the)g(system)g(ma)o(y)d(start)k(cop)o(ying)e(data)
249 915 y(out)j(of)f(the)i(send)g(bu\013er.)32 b(The)18
b(sender)i(m)o(ust)d(not)h(access)i(an)o(y)d(part)h(of)g(the)g(send)h
(bu\013er)249 969 y(\(neither)14 b(for)e(loads)g(nor)g(for)g(stores\))i
(after)f(a)f(non)o(blo)q(c)o(king)f(send)i(op)q(eration)g(is)f(p)q
(osted,)h(un)o(til)249 1023 y(the)i(complete-send)f(returns.)291
1077 y(A)e(non)o(blo)q(c)o(king)f(p)q(ost-receiv)o(e)i(indicates)g
(that)f(the)g(system)g(ma)o(y)e(start)j(writing)e(data)h(in)o(to)249
1131 y(the)i(receiv)o(e)g(bu\013er.)19 b(The)13 b(receiv)o(er)i(m)o
(ust)d(not)g(access)j(an)o(y)e(part)g(of)f(the)i(receiv)o(e)g(bu\013er)
g(after)249 1185 y(a)g(non)o(blo)q(c)o(king)e(receiv)o(e)j(op)q
(eration)f(is)g(p)q(osted,)g(un)o(til)f(the)i(complete-receiv)o(e)f
(returns.)249 1276 y FB(R)n(ationale.)38 b FA(W)m(e)14
b(prohibit)f(read)i(accesses)h(to)e(a)g(send)h(bu\013er)g(while)f(it)f
(is)h(b)q(eing)g(used,)h(ev)o(en)249 1330 y(though)e(the)i(send)f(op)q
(eration)g(is)f(not)h(supp)q(osed)g(to)g(alter)f(the)i(con)o(ten)o(t)f
(of)f(this)h(bu\013er.)19 b(This)249 1384 y(ma)o(y)10
b(seem)i(more)f(stringen)o(t)i(than)f(necessary)m(,)h(but)g(the)f
(additional)f(restriction)i(causes)g(little)249 1438
y(loss)18 b(of)f(functionalit)o(y)f(and)h(allo)o(ws)f(b)q(etter)j(p)q
(erformance)f(on)f(some)g(systems)h(|)f(consider)249
1492 y(the)f(case)g(where)g(data)f(transfer)i(is)e(done)g(b)o(y)g(a)g
(DMA)g(engine)h(that)f(is)g(not)g(cac)o(he-coheren)o(t)249
1546 y(with)f(the)g(main)e(pro)q(cessor.)20 b(\()p FB(End)15
b(of)g(r)n(ationale.)p FA(\))249 1637 y Fs(2.8.3)48 b(Completion)13
b(Op)q(erations)249 1720 y FA(The)j(functions)g Fw(MPI)p
594 1720 V 14 w(W)m(AIT)f FA(and)g Fw(MPI)p 884 1720
V 15 w(TEST)h FA(are)g(used)g(to)g(complete)f(non)o(blo)q(c)o(king)f
(sends)249 1774 y(and)k(receiv)o(es.)31 b(The)18 b(completion)e(of)h(a)
h(send)g(indicates)h(that)e(the)i(sender)g(is)f(no)o(w)f(free)i(to)249
1828 y(access)14 b(the)f(send)g(bu\013er.)18 b(The)13
b(completion)d(of)i(a)g(receiv)o(e)h(indicates)g(that)f(the)h(receiv)o
(e)g(bu\013er)249 1882 y(con)o(tains)h(the)g(message,)f(the)i(receiv)o
(er)g(is)f(free)g(to)g(access)h(it,)e(and)h(that)g(the)g(status)h(ob)r
(ject)g(is)249 1936 y(set.)249 2061 y Fw(MPI)p 326 2061
V 14 w(W)m(AIT\(request,)g(status\))332 2136 y Fv(INOUT)71
b Fw(request)423 b Fv(request)14 b(handle)332 2186 y(OUT)114
b Fw(status)443 b Fv(status)14 b(ob)r(ject)249 2296 y
Fr(int)21 b(MPI)p 405 2296 14 2 v 15 w(Wait\(MPI)p 596
2296 V 14 w(Request)g(*request,)f(MPI)p 1069 2296 V 15
w(Status)g(*status\))249 2380 y(MPI)p 318 2380 V 15 w(WAIT\(REQUEST,)f
(STATUS,)i(IERROR\))336 2434 y(INTEGER)g(REQUEST,)f(STATUS\(MPI)p
930 2434 V 13 w(STATUS)p 1075 2434 V 15 w(SIZE\),)g(IERROR)p
eop
%%Page: 53 67
53 66 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(53)291 507 y FA(A)11 b(call)g(to)h Fw(MPI)p 533
507 13 2 v 14 w(W)m(AIT)f FA(returns)i(when)f(the)h(op)q(eration)e
(iden)o(ti\014ed)h(b)o(y)f Fw(request)j FA(is)d(complete.)249
561 y(If)j(the)h(system)f(ob)r(ject)g(p)q(oin)o(ted)h(to)f(b)o(y)g
Fw(request)h FA(w)o(as)g(originally)c(created)16 b(b)o(y)e(a)g(non)o
(blo)q(c)o(king)249 615 y(send)20 b(or)g(receiv)o(e,)h(then)g(the)f(ob)
r(ject)g(is)f(deallo)q(cated)h(b)o(y)f Fw(MPI)p 1280
615 V 14 w(W)m(AIT)g FA(and)g Fw(request)i FA(is)e(set)249
669 y(to)i Fq(MPI)p 379 669 12 2 v 12 w(REQUEST)p 563
669 V 15 w(NULL)p FA(.)g(The)g(status)h(ob)r(ject)f(is)g(set)h(to)e
(con)o(tain)g(information)e(on)j(the)249 723 y(completed)13
b(op)q(eration.)18 b Fw(MPI)p 726 723 13 2 v 15 w(W)m(AIT)13
b FA(has)h(non-lo)q(cal)e(completion)h(seman)o(tics.)249
848 y Fw(MPI)p 326 848 V 14 w(TEST\(request,)j(\015ag,)d(status\))332
923 y Fv(INOUT)71 b Fw(request)423 b Fv(request)14 b(handle)332
972 y(OUT)114 b Fw(\015ag)483 b Fq(true)13 b Fv(if)g(op)q(eration)i
(completed)332 1022 y(OUT)114 b Fw(status)443 b Fv(status)14
b(ob)r(ject)249 1132 y Fr(int)21 b(MPI)p 405 1132 14
2 v 15 w(Test\(MPI)p 596 1132 V 14 w(Request)g(*request,)f(int)h
(*flag,)f(MPI)p 1308 1132 V 15 w(Status)h(*status\))249
1216 y(MPI)p 318 1216 V 15 w(TEST\(REQUEST,)e(FLAG,)i(STATUS,)f
(IERROR\))336 1270 y(LOGICAL)h(FLAG)336 1324 y(INTEGER)g(REQUEST,)f
(STATUS\(MPI)p 930 1324 V 13 w(STATUS)p 1075 1324 V 15
w(SIZE\),)g(IERROR)291 1408 y FA(A)15 b(call)g(to)g Fw(MPI)p
544 1408 13 2 v 15 w(TEST)h FA(returns)h Fw(\015ag)e(=)h(true)h
FA(if)d(the)j(op)q(eration)e(iden)o(ti\014ed)h(b)o(y)f
Fw(request)j FA(is)249 1462 y(complete.)g(In)d(this)f(case,)h(the)g
(status)g(ob)r(ject)g(is)f(set)h(to)f(con)o(tain)g(information)d(on)j
(the)h(com-)249 1516 y(pleted)g(op)q(eration.)i(If)d(the)g(system)g(ob)
r(ject)h(p)q(oin)o(ted)f(to)f(b)o(y)h Fw(request)i FA(w)o(as)d
(originally)f(created)249 1570 y(b)o(y)h(a)g(non)o(blo)q(c)o(king)g
(send)h(or)g(receiv)o(e,)g(then)g(the)g(ob)r(ject)g(is)g(deallo)q
(cated)f(b)o(y)g Fw(MPI)p 1546 1570 V 15 w(TEST)h FA(and)249
1624 y(request)e(is)d(set)i(to)f Fq(MPI)p 607 1624 12
2 v 13 w(REQUEST)p 792 1624 V 15 w(NULL)p FA(.)g(The)g(call)f(returns)j
Fw(\015ag)d(=)i(false)p FA(,)f(otherwise.)17 b(In)10
b(this)249 1678 y(case,)17 b(the)f(v)n(alue)f(of)g(the)h(status)g(ob)r
(ject)h(is)e(unde\014ned.)24 b Fw(MPI)p 1237 1678 13
2 v 15 w(TEST)16 b FA(has)f(lo)q(cal)g(completion)249
1732 y(seman)o(tics.)291 1786 y(F)m(or)k(b)q(oth)g Fw(MPI)p
551 1786 V 14 w(W)m(AIT)g FA(and)g Fw(MPI)p 849 1786
V 15 w(TEST)p FA(,)g(information)d(on)k(the)g(completed)f(op)q(eration)
249 1840 y(is)e(returned)i(in)e Fw(status)p FA(.)28 b(The)18
b(con)o(ten)o(t)g(of)f(the)h(status)g(ob)r(ject)g(for)f(a)g(receiv)o(e)
h(op)q(eration)g(is)249 1894 y(accessed)g(as)e(describ)q(ed)h(in)e
(Section)h(2.2.8.)22 b(The)16 b(con)o(ten)o(ts)h(of)e(a)g(status)h(ob)r
(ject)h(for)e(a)h(send)249 1948 y(op)q(eration)k(is)g(unde\014ned,)j
(except)f(that)e(the)h(query)g(function)f Fw(MPI)p 1377
1948 V 15 w(TEST)p 1496 1948 V 15 w(CANCELLED)249 2002
y FA(\(Section)14 b(2.10\))f(can)h(b)q(e)h(applied)e(to)h(it.)249
2093 y FB(A)n(dvic)n(e)e(to)h(users.)35 b FA(The)12 b(use)g(of)f
Fw(MPI)p 842 2093 V 14 w(TEST)h FA(allo)o(ws)e(one)i(to)f(sc)o(hedule)h
(alternativ)o(e)g(activities)249 2147 y(within)h(a)h(single)f(thread)i
(of)e(execution.)19 b(\()p FB(End)d(of)e(advic)n(e)i(to)f(users.)p
FA(\))249 2239 y FB(A)n(dvic)n(e)j(to)f(implementors.)54
b FA(In)17 b(a)g(m)o(ulti-threaded)e(en)o(vironmen)o(t,)h(a)h(call)f
(to)h Fw(MPI)p 1628 2239 V 14 w(W)m(AIT)249 2293 y FA(should)f(blo)q(c)
o(k)f(only)g(the)i(calling)d(thread,)j(allo)o(wing)c(another)k(thread)f
(to)g(b)q(e)h(sc)o(heduled)g(for)249 2346 y(execution.)i(\()p
FB(End)d(of)e(advic)n(e)i(to)e(implementors.)p FA(\))249
2438 y FB(R)n(ationale.)75 b Fw(MPI)p 585 2438 V 14 w(W)m(AIT)20
b FA(and)g Fw(MPI)p 885 2438 V 14 w(TEST)h FA(are)f(de\014ned)h(so)g
(that)f Fw(MPI)p 1477 2438 V 14 w(TEST)h FA(returns)249
2492 y(successfully)15 b(\(with)f Fw(\015ag)f(=)h(true)p
FA(\))h(exactly)f(in)g(those)g(situation)f(where)i Fw(MPI)p
1473 2492 V 14 w(W)m(AIT)e FA(returns.)p eop
%%Page: 54 68
54 67 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(54)1275 b(Chapter)13 b(2)249 507
y FA(In)19 b(those)h(cases,)h(b)q(oth)f(return)g(the)g(same)e
(information)e(in)j Fw(status)p FA(.)33 b(This)19 b(allo)o(ws)f(one)i
(to)249 561 y(replace)f(a)e(blo)q(c)o(king)g(call)g(to)g
Fw(MPI)p 812 561 13 2 v 15 w(W)m(AIT)g FA(with)g(a)g(non)o(blo)q(c)o
(king)g(call)g(to)g Fw(MPI)p 1528 561 V 15 w(TEST)h FA(with)249
615 y(few)d(c)o(hanges)g(in)f(the)h(program.)k(The)c(same)e(design)i
(logic)e(will)g(b)q(e)j(follo)o(w)o(ed)d(for)h(the)h(m)o(ulti-)249
669 y(completion)d(op)q(erations)i(of)g(Section)g(2.9.)j(\()p
FB(End)f(of)e(r)n(ationale.)p FA(\))249 760 y Fs(2.8.4)48
b(Examples)249 844 y FA(W)m(e)13 b(illustrate)h(the)g(use)g(of)f(non)o
(blo)q(c)o(king)g(comm)o(unicatio)o(n)e(for)i(the)i(same)d(Jacobi)i
(computa-)249 897 y(tion)e(used)i(in)e(previous)h(examples)f(\(Example)
f(2.11{2.15\).)16 b(T)m(o)11 b(ac)o(hiev)o(e)i(maxim)o(um)8
b(o)o(v)o(erlap)249 951 y(b)q(et)o(w)o(een)20 b(computation)d(and)h
(comm)o(unication,)e(comm)o(unicatio)o(ns)g(should)j(b)q(e)g(started)g
(as)249 1005 y(so)q(on)13 b(as)f(p)q(ossible)h(and)f(completed)g(as)h
(late)f(as)h(p)q(ossible.)18 b(That)12 b(is,)g(sends)i(should)e(b)q(e)h
(p)q(osted)249 1059 y(as)k(so)q(on)h(as)f(the)h(data)f(to)g(b)q(e)h
(sen)o(t)g(is)f(a)o(v)n(ailable;)f(receiv)o(es)j(should)e(b)q(e)h(p)q
(osted)g(as)f(so)q(on)g(as)249 1113 y(the)g(receiv)o(e)h(bu\013er)g
(can)f(b)q(e)g(reused;)i(sends)f(should)f(b)q(e)g(completed)f(just)h(b)
q(efore)g(the)h(send)249 1167 y(bu\013er)c(is)f(to)g(b)q(e)g(reused;)i
(and)e(receiv)o(es)h(should)f(b)q(e)h(completed)e(just)h(b)q(efore)h
(the)g(data)e(in)h(the)249 1221 y(receiv)o(e)h(bu\013er)g(is)f(to)g(b)q
(e)h(used.)k(Sometimes,)11 b(the)i(o)o(v)o(erlap)g(can)g(b)q(e)h
(increased)g(b)o(y)f(reordering)249 1275 y(computations.)249
1371 y Fs(Example)i(2.16)21 b FA(Use)15 b(of)e(non)o(blo)q(c)o(king)f
(comm)o(unications)f(in)j(Jacobi)f(computation.)249 1425
y Fr(...)249 1479 y(REAL,)21 b(ALLOCATABLE)e(A\(:,:\),)i(B\(:,:\))249
1533 y(INTEGER)f(req\(4\))249 1587 y(INTEGER)g(status\(MPI_STATUS_S)o
(IZE,4)o(\))249 1641 y(...)249 1694 y(!)i(Compute)e(number)h(of)g
(processes)f(and)h(myrank)249 1748 y(CALL)g(MPI_COMM_SIZE\(comm)o(,)e
(p,)i(ierr\))249 1802 y(CALL)g(MPI_COMM_RANK\(comm)o(,)e(myrank,)h
(ierr\))249 1910 y(!)i(Compute)e(size)h(of)g(local)g(block)249
1964 y(m)h(=)f(n/p)249 2018 y(IF)g(\(myrank.LT.\(n-p*m\)\))d(THEN)314
2072 y(m)k(=)g(m+1)249 2126 y(END)f(IF)249 2234 y(!)h(Compute)e
(neighbors)249 2288 y(IF)h(\(myrank.EQ.0\))f(THEN)314
2342 y(left)h(=)h(MPI_PROC_NULL)249 2396 y(ELSE)314 2450
y(left)f(=)h(myrank)f(-1)249 2504 y(END)g(IF)p eop
%%Page: 55 69
55 68 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(55)249 507 y Fr(IF)21 b(\(myrank.EQ.p-1\))e(THEN)314
561 y(right)i(=)h(MPI_PROC_NULL)249 615 y(ELSE)314 669
y(right)f(=)h(myrank+1)249 723 y(ENDIF)249 831 y(!)g(Allocate)e(local)h
(arrays)249 885 y(ALLOCATE)f(\(A\(0:n+1,0:m+1\),)f(B\(n,m\)\))249
939 y(...)249 993 y(!)j(Main)f(loop)249 1047 y(DO)g
(WHILE\(.NOT.converged)o(\))314 1155 y(!)h(Compute)e(boundary)h
(columns)314 1209 y(DO)h(i=1,n)380 1263 y(B\(i,1\))e(=)i
(0.25*\(A\(i-1,1\)+A\()o(i+1,1)o(\)+A\(i)o(,0\)+A)o(\(i,2\))o(\))380
1317 y(B\(i,m\))e(=)i(0.25*\(A\(i-1,m\)+A\()o(i+1,m)o(\)+A\(i)o(,m-1\))
o(+A\(i,)o(m+1\))o(\))314 1371 y(END)g(DO)314 1479 y(!)g(Start)f
(communication)314 1533 y(CALL)g(MPI_ISEND\(B\(1,1\),)e(n,)i(MPI_REAL,)
f(left,)h(tag,)g(comm,)f(req\(1\),)h(ierr\))314 1587
y(CALL)g(MPI_ISEND\(B\(1,m\),)e(n,)i(MPI_REAL,)f(right,)h(tag,)g(comm,)
f(req\(2\),)h(ierr\))314 1641 y(CALL)g(MPI_IRECV\(A\(1,0\),)e(n,)i
(MPI_REAL,)f(left,)h(tag,)g(comm,)f(req\(3\),)h(ierr\))314
1694 y(CALL)g(MPI_IRECV\(A\(1,m+1\),)d(n,)k(MPI_REAL,)e(right,)g(tag,)h
(comm,)g(req\(4\),)f(ierr\))314 1802 y(!)i(Compute)e(interior)314
1856 y(DO)i(j=2,m-1)380 1910 y(DO)f(i=1,n)445 1964 y(B\(i,j\))g(=)g
(0.25*\(A\(i-1,j\)+A\(i+)o(1,j\)+)o(A\(i,j)o(-1\)+A)o(\(i,j)o(+1\)\))
380 2018 y(END)g(DO)314 2072 y(END)h(DO)314 2126 y(DO)g(j=1,m)380
2180 y(DO)f(i=1,n)445 2234 y(A\(i,j\))g(=)g(B\(i,j\))380
2288 y(END)g(DO)314 2342 y(END)h(DO)314 2450 y(!)g(Complete)e
(communication)314 2504 y(DO)i(i=1,4)p eop
%%Page: 56 70
56 69 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(56)1275 b(Chapter)13 b(2)380 507
y Fr(CALL)21 b(MPI_WAIT\(req\(i\),)d(status\(1,i\),)i(ierr\))314
561 y(END)i(DO)249 615 y(...)249 669 y(END)f(DO)249 723
y FA(The)e(comm)o(unication)c(calls)k(use)g(the)g(leftmost)f(and)g
(righ)o(tmost)f(columns)h(of)g(lo)q(cal)g(arra)o(y)249
777 y Fr(B)f FA(and)g(set)h(the)g(leftmost)e(and)h(righ)o(tmost)f
(columns)g(of)h(lo)q(cal)f(arra)o(y)h Fr(A)p FA(.)g(The)h(send)g
(bu\013ers)249 831 y(are)f(made)f(a)o(v)n(ailable)f(early)i(b)o(y)f
(separating)i(the)f(up)q(date)h(of)e(the)i(leftmost)d(and)i(righ)o
(tmost)249 885 y(columns)h(of)h Fr(B)g FA(from)f(the)i(up)q(date)g(of)f
(the)h(in)o(terior)f(of)g Fr(B)p FA(.)g(Since)h(this)f(is)g(also)g
(where)i(the)249 939 y(leftmost)15 b(and)g(righ)o(tmost)f(columns)h(of)
g Fr(A)h FA(are)g(used,)h(the)f(comm)o(unication)d(can)j(b)q(e)g
(started)249 993 y(immediately)9 b(after)k(these)h(columns)d(are)i(up)q
(dated)g(and)g(can)g(b)q(e)g(completed)f(just)g(b)q(efore)i(the)249
1047 y(next)g(iteration.)291 1130 y(The)k(next)h(example)d(sho)o(ws)j
(a)f(m)o(ultiple-pro)q(ducer,)f(single-consumer)h(co)q(de.)31
b(The)19 b(last)249 1184 y(pro)q(cess)d(in)d(the)i(group)e(consumes)h
(messages)g(sen)o(t)h(b)o(y)f(the)g(other)h(pro)q(cesses.)249
1267 y Fs(Example)g(2.17)21 b FA(Multiple-pro)q(ducer,)d
(single-consumer)e(co)q(de)i(using)e(non)o(blo)q(c)o(king)g(com-)249
1321 y(m)o(unication)249 1375 y Fr(...)249 1429 y(typedef)k(struct)h({)
293 1483 y(char)g(data[MAXSIZE];)293 1537 y(int)g(datasize;)293
1591 y(MPI_Request)e(req;)249 1645 y(})j(Buffer;)249
1699 y(Buffer)f(buffer[];)249 1753 y(MPI_Status)f(status;)249
1807 y(...)249 1914 y(MPI_Comm_rank\(comm)o(,)f(&rank\);)249
1968 y(MPI_Comm_size\(comm)o(,)g(&size\);)249 2022 y(if\(rank)h(!=)i
(size-1\))42 b({)h(/*)22 b(producer)e(code)43 b(*/)314
2076 y(/*)22 b(initialization)d(-)i(producer)f(allocates)g(one)i
(buffer)e(*/)314 2130 y(buffer)h(=)h(\(Buffer)e(*\)malloc\(sizeof\(B)o
(uffer)o(\)\);)314 2184 y(while\(1\))h({)43 b(/*)21 b(main)g(loop)g(*/)
380 2238 y(/*)g(producer)f(fills)h(data)g(buffer)g(and)g(returns)445
2292 y(number)g(of)g(bytes)g(stored)f(in)i(buffer)e(*/)380
2346 y(produce\()g(buffer->data,)f(&buffer->datasize\))o(;)380
2400 y(/*)i(send)g(data)g(*/)380 2454 y(MPI_Send\(buffer->)o(data)o(,)e
(buffer->datasize,)f(MPI_CHAR,)598 2508 y(size-1,)i(tag,)h(comm\);)p
eop
%%Page: 57 71
57 70 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(57)380 507 y Fr(})314 561 y(})249 615 y(else)21
b({)h(/*)f(rank)g(==)g(size-1;)g(consumer)f(code)h(*/)314
669 y(/*)h(initialization)d(-)i(consumer)f(allocates)g(one)i(buffer)750
723 y(per)f(producer)g(*/)314 777 y(buffer)g(=)h(\(Buffer)e
(*\)malloc\(sizeof\(B)o(uffer)o(\)*\(si)o(ze-1\))o(\);)314
831 y(for\(i=0;)42 b(i<)22 b(size-1;)e(i++\))380 885
y(/*)h(post)g(a)h(receive)e(from)h(each)g(producer)f(*/)380
939 y(MPI_Irecv\(buffer[)o(i].d)o(ata,)e(MAXSIZE,)j(MPI_CHAR,)f(i,)h
(tag,)1055 993 y(comm,)g(&\(buffer[i].req\)\);)314 1101
y(for\(i=0;)g(;)g(i=\(i+1\)\045\(size-1\)\))d({)k(/*)f(main)g(loop)g
(*/)380 1155 y(MPI_Wait\(&\(buffer)o([i].)o(req\),)d(&status\);)380
1209 y(/*)j(find)g(number)g(of)g(bytes)g(actually)f(received)g(*/)380
1263 y(MPI_Get_count\(&st)o(atus)o(,)f(MPI_CHAR,)h(&\(buffer[i].datas)o
(ize\)\))o(;)380 1317 y(/*)h(consume)g(empties)f(data)h(buffer)f(*/)380
1371 y(consume\(buffer[i])o(.dat)o(a,)f(buffer[i].datasiz)o(e\);)380
1425 y(/*)i(post)g(new)g(receive)g(*/)380 1479 y(MPI_Irecv\(buffer[)o
(i].d)o(ata,)d(MAXSIZE,)j(MPI_CHAR,)f(i,)h(tag,)598 1533
y(comm,)g(&\(buffer[i].req)o(\)\);)380 1587 y(})314 1641
y(})249 1694 y(})249 1748 y FA(Eac)o(h)14 b(pro)q(ducer)g(runs)h(an)e
(in\014nite)g(lo)q(op)f(where)j(it)e(rep)q(eatedly)h(pro)q(duces)h(one)
f(message)f(and)249 1802 y(sends)i(it.)j(The)c(consumer)g(serv)o(es)h
(eac)o(h)f(pro)q(ducer)i(in)d(turn,)h(b)o(y)f(receiving)h(its)g
(message)g(and)249 1856 y(consuming)f(it.)291 1943 y(The)g(example)e
(imp)q(oses)g(a)i(strict)g(round-robin)f(discipline,)g(since)h(the)g
(consumer)g(receiv)o(es)249 1997 y(one)19 b(message)g(from)e(eac)o(h)i
(pro)q(ducer,)i(in)d(turn.)33 b(In)19 b(some)f(cases)i(it)f(is)f
(preferable)i(to)f(use)249 2051 y(a)c(\\\014rst-come-\014rst-serv)o
(ed")i(discipline.)k(This)15 b(is)h(ac)o(hiev)o(ed)f(b)o(y)g(using)g
Fw(MPI)p 1489 2051 13 2 v 14 w(TEST)p FA(,)h(rather)249
2105 y(than)f Fw(MPI)p 424 2105 V 14 w(W)m(AIT)p FA(,)e(as)i(sho)o(wn)f
(b)q(elo)o(w.)20 b(Note)15 b(that)g Fw(MPI)e FA(can)i(only)f(o\013er)h
(an)f(appro)o(ximation)249 2158 y(to)e(\014rst-come-\014rst-serv)o(ed,)
j(since)e(messages)f(do)h(not)f(necessarily)i(arriv)o(e)e(in)g(the)i
(order)f(they)249 2212 y(w)o(ere)i(sen)o(t.)249 2292
y Fs(Example)g(2.18)21 b FA(Multiple-pro)q(ducer,)10
b(single-consumer)f(co)q(de,)i(mo)q(di\014ed)c(to)j(use)g(test)g
(calls.)249 2346 y Fr(...)249 2400 y(typedef)20 b(struct)h({)293
2454 y(char)g(data[MAXSIZE];)293 2508 y(int)g(datasize;)p
eop
%%Page: 58 72
58 71 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(58)1275 b(Chapter)13 b(2)293 507
y Fr(MPI_Request)19 b(req;)249 561 y(})j(Buffer;)249
615 y(Buffer)f(buffer[];)249 669 y(MPI_Status)f(status;)249
723 y(...)249 777 y(MPI_Comm_rank\(comm)o(,)f(&rank\);)249
831 y(MPI_Comm_size\(comm)o(,)g(&size\);)249 885 y(if\(rank)h(!=)i
(size-1\))42 b({)h(/*)22 b(producer)e(code)43 b(*/)314
939 y(buffer)21 b(=)h(\(Buffer)e(*\)malloc\(sizeof\(B)o(uffer)o(\)\);)
314 993 y(while\(1\))h({)43 b(/*)21 b(main)g(loop)g(*/)380
1047 y(produce\()f(buffer->data,)f(&buffer->datasize\))o(;)380
1101 y(MPI_Send\(buffer->)o(data)o(,)g(buffer->datasize,)f(MPI_CHAR,)
1077 1155 y(size-1,)j(tag,)g(comm\);)380 1209 y(})314
1263 y(})249 1317 y(else)g({)h(/*)f(rank)g(==)g(size-1;)g(consumer)f
(code)h(*/)314 1371 y(buffer)g(=)h(\(Buffer)e(*\)malloc\(sizeof\(B)o
(uffer)o(\)*\(si)o(ze-1\))o(\);)314 1425 y(for\(i=0;)42
b(i<)22 b(size-1;)e(i++\))380 1479 y(MPI_Irecv\(buffer[)o(i].d)o(ata,)e
(MAXSIZE,)j(MPI_CHAR,)f(i,)h(tag,)1055 1533 y(comm,)g
(&buffer[i].req\);)314 1587 y(i)h(=)g(0;)314 1641 y(while\(1\))f({)g
(/*)h(main)f(loop)f(*/)380 1694 y(for)h(\(flag=0;)f(!flag;)h(i=)g
(\(i+1\)\045\(size-1\)\))445 1748 y(/*)h(busy-wait)e(for)h(completed)f
(receive)g(*/)445 1802 y(MPI_Test\(&\(buffer[)o(i].re)o(q\),)f(&flag,)h
(&status\);)380 1856 y(MPI_Get_count\(&st)o(atus)o(,)f(MPI_CHAR,)h
(&buffer[i].datasi)o(ze\);)380 1910 y(consume\(buffer[i])o(.dat)o(a,)f
(buffer[i].datasiz)o(e\);)380 1964 y(MPI_Irecv\(buffer[)o(i].d)o(ata,)f
(MAXSIZE,)j(MPI_CHAR,)f(i,)h(tag,)1077 2018 y(comm,)g
(&buffer[i].req\);)380 2072 y(})293 2126 y(})249 2180
y FA(If)12 b(there)h(is)f(no)g(message)g(p)q(ending)g(from)e(a)i(pro)q
(ducer,)i(then)f(the)f(consumer)g(pro)q(cess)i(skips)f(to)249
2234 y(the)h(next)g(pro)q(ducer.)19 b(A)14 b(more)e(e\016cien)o(t)i
(implemen)o(tatio)o(n)d(that)i(do)q(es)h(not)f(require)i(m)o(ultiple)
249 2288 y(test)g(calls)e(and)h(busy-w)o(aiting)f(will)f(b)q(e)j
(presen)o(ted)h(in)d(Section)i(2.9.)249 2371 y Fs(2.8.5)48
b(F)l(reeing)14 b(Requests)249 2454 y FA(A)h(request)h(ob)r(ject)f(is)f
(deallo)q(cated)h(automatically)c(b)o(y)j(a)g(successful)j(call)c(to)i
Fw(MPI)p 1577 2454 13 2 v 14 w(W)m(AIT)e FA(or)249 2508
y Fw(MPI)p 326 2508 V 14 w(TEST)p FA(.)g(In)g(addition,)f(a)g(request)j
(ob)r(ject)f(can)f(b)q(e)g(explicitly)f(deallo)q(cated)h(b)o(y)g(using)
g(the)p eop
%%Page: 59 73
59 72 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(59)249 507 y FA(follo)o(wing)11 b(op)q(eration.)249
632 y Fw(MPI)p 326 632 13 2 v 14 w(REQUEST)p 528 632
V 14 w(FREE\(request\))332 707 y Fv(INOUT)71 b Fw(request)423
b Fv(request)14 b(handle)249 817 y Fr(int)21 b(MPI)p
405 817 14 2 v 15 w(Request)p 574 817 V 15 w(free\(MPI)p
765 817 V 14 w(Request)f(*request\))249 901 y(MPI)p 318
901 V 15 w(REQUEST)p 487 901 V 14 w(FREE\(REQUEST,)f(IERROR\))336
955 y(INTEGER)i(REQUEST,)f(IERROR)291 1039 y Fw(MPI)p
368 1039 13 2 v 14 w(REQUEST)p 570 1039 V 14 w(FREE)13
b FA(marks)f(the)j(request)g(ob)r(ject)g(for)f(deallo)q(cation)f(and)g
(sets)j Fw(request)249 1093 y FA(to)10 b Fq(MPI)p 368
1093 12 2 v 13 w(REQUEST)p 553 1093 V 15 w(NULL)p FA(.)g(An)h(ongoing)e
(comm)o(unicatio)o(n)f(asso)q(ciated)j(with)f(the)h(request)h(will)249
1147 y(b)q(e)i(allo)o(w)o(ed)d(to)i(complete.)k(The)c(request)i(b)q
(ecomes)e(una)o(v)n(ailable)d(after)k(it)e(is)h(deallo)q(cated,)f(as)
249 1201 y(the)j(handle)f(is)g(reset)h(to)f Fq(MPI)p
719 1201 V 13 w(REQUEST)p 904 1201 V 15 w(NULL)p FA(.)g(Ho)o(w)o(ev)o
(er,)g(the)h(request)h(ob)r(ject)f(itself)e(need)249
1255 y(not)i(b)q(e)g(deallo)q(cated)g(imm)o(ediately)m(.)i(If)e(the)g
(comm)o(unicatio)o(n)d(asso)q(ciated)j(with)g(this)g(ob)r(ject)249
1309 y(is)e(still)g(ongoing,)e(and)i(the)h(ob)r(ject)g(is)g(required)g
(for)f(its)g(correct)i(completion,)c(then)j Fw(MPI)f
FA(will)249 1363 y(not)h(deallo)q(cate)g(the)g(ob)r(ject)h(un)o(til)e
(after)h(its)g(completion.)291 1417 y Fw(MPI)p 368 1417
13 2 v 14 w(REQUEST)p 570 1417 V 14 w(FREE)f FA(cannot)i(b)q(e)g(used)h
(for)e(cancelling)h(an)f(ongoing)f(comm)o(unication.)249
1471 y(F)m(or)18 b(that)g(purp)q(ose,)i(one)e(should)g(use)h
Fw(MPI)p 964 1471 V 14 w(CANCEL)p FA(,)e(describ)q(ed)j(in)e(Section)g
(2.10.)30 b(One)249 1525 y(should)20 b(use)i Fw(MPI)p
543 1525 V 14 w(REQUEST)p 745 1525 V 14 w(FREE)d FA(when)i(the)g(logic)
e(of)h(the)h(program)e(is)h(suc)o(h)h(that)g(a)249 1579
y(non)o(blo)q(c)o(king)14 b(comm)o(unication)e(is)j(kno)o(wn)g(to)g(ha)
o(v)o(e)g(terminated)g(and,)g(therefore,)i(a)e(call)g(to)249
1632 y Fw(MPI)p 326 1632 V 14 w(W)m(AIT)g FA(or)g Fw(MPI)p
586 1632 V 15 w(TEST)g FA(is)h(sup)q(er\015uous.)24 b(F)m(or)15
b(example,)f(the)i(program)d(could)j(b)q(e)g(suc)o(h)249
1686 y(that)h(a)g(send)h(command)c(generates)k(a)f(reply)g(from)e(the)j
(receiv)o(er.)29 b(If)16 b(the)i(reply)f(has)g(b)q(een)249
1740 y(successfully)e(receiv)o(ed,)g(then)f(the)h(send)g(is)e(kno)o(wn)
h(to)g(b)q(e)g(complete.)249 1836 y Fs(Example)h(2.19)21
b FA(An)14 b(example)e(using)i Fw(MPI)p 968 1836 V 14
w(REQUEST)p 1170 1836 V 14 w(FREE)p FA(.)249 1890 y Fr(CALL)21
b(MPI_COMM_RANK\(MPI_)o(COMM)o(_WORL)o(D,)e(rank,)i(ierr\))249
1944 y(IF\(rank.EQ.0\))e(THEN)336 1998 y(DO)j(i=1,)f(n)380
2052 y(CALL)g(MPI_ISEND\(outval)o(,)e(1,)i(MPI_REAL,)f(1,)i(0,)f(comm,)
g(req,)g(ierr\))380 2106 y(CALL)g(MPI_REQUEST_FREE)o(\(req,)d(ierr\))
380 2160 y(CALL)j(MPI_IRECV\(inval,)d(1,)k(MPI_REAL,)e(1,)h(0,)g(comm,)
g(req,)g(ierr\))380 2214 y(CALL)g(MPI_WAIT\(req,)e(status,)h(ierr\))336
2268 y(END)h(DO)249 2322 y(ELSE)g(IF)g(\(rank.EQ.1\))f(THEN)336
2376 y(CALL)h(MPI_IRECV\(inval,)e(1,)i(MPI_REAL,)f(0,)h(0,)h(comm,)f
(req,)f(ierr\))336 2429 y(CALL)h(MPI_WAIT\(req,)e(status,)i(ierr\))336
2483 y(DO)h(i=1,)f(n-1)p eop
%%Page: 60 74
60 73 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(60)1275 b(Chapter)13 b(2)402 507
y Fr(CALL)21 b(MPI_ISEND\(outva)o(l,)e(1,)i(MPI_REAL,)f(0,)i(0,)f
(comm,)g(req,)g(ierr\))402 561 y(CALL)g(MPI_REQUEST_FRE)o(E\(req)o(,)e
(ierr\))402 615 y(CALL)i(MPI_IRECV\(inval)o(,)e(1,)i(MPI_REAL,)f(0,)i
(0,)f(comm,)g(req,)g(ierr\))402 669 y(CALL)g(MPI_WAIT\(req,)e(status,)h
(ierr\))336 723 y(END)h(DO)336 777 y(CALL)g(MPI_ISEND\(outval,)d(1,)k
(MPI_REAL,)e(0,)h(0,)h(comm,)e(req,)h(ierr\))336 831
y(CALL)g(MPI_WAIT\(req,)e(status\))249 885 y(END)i(IF)249
1034 y FB(A)n(dvic)n(e)13 b(to)g(users.)35 b FA(Requests)14
b(should)d(not)h(b)q(e)h(freed)g(explicitly)e(unless)h(the)h(comm)o
(unicatio)o(n)249 1088 y(is)18 b(kno)o(wn)g(to)g(complete.)30
b(Receiv)o(e)19 b(requests)h(should)e(nev)o(er)h(b)q(e)g(freed)g
(without)e(a)h(call)g(to)249 1142 y Fw(MPI)p 326 1142
13 2 v 14 w(W)m(AIT)d FA(or)f Fw(MPI)p 585 1142 V 15
w(TEST)p FA(,)h(since)g(only)g(suc)o(h)g(a)g(call)f(can)h(guaran)o(tee)
h(that)f(a)g(non)o(blo)q(c)o(king)249 1196 y(receiv)o(e)k(op)q(eration)
f(has)g(completed.)30 b(This)18 b(is)g(explained)g(in)f(Section)i
(2.8.6.)28 b(If)18 b(an)f(error)249 1250 y(o)q(ccurs)11
b(during)e(a)g(comm)o(unication)e(after)i(the)h(request)i(ob)r(ject)e
(has)g(b)q(een)g(freed,)h(then)f(an)f(error)249 1304
y(co)q(de)14 b(cannot)f(b)q(e)g(returned)i(to)d(the)i(user)g(\(the)f
(error)h(co)q(de)f(w)o(ould)f(normally)f(b)q(e)i(returned)i(to)249
1358 y(the)g Fw(MPI)p 398 1358 V 14 w(TEST)g FA(or)f
Fw(MPI)p 657 1358 V 15 w(W)m(AIT)f FA(request\).)21 b(Therefore,)16
b(suc)o(h)f(an)f(error)h(will)e(b)q(e)i(treated)h(b)o(y)249
1412 y Fw(MPI)d FA(as)h(fatal.)j(\()p FB(End)f(of)f(advic)n(e)g(to)g
(users.)p FA(\))249 1504 y Fs(2.8.6)48 b(Seman)o(tics)13
b(of)j(Non)o(blo)q(c)o(king)d(Comm)o(unication)o(s)249
1587 y FA(The)i(seman)o(tics)f(of)g(non)o(blo)q(c)o(king)f(comm)o
(unicati)o(on)f(is)i(de\014ned)h(b)o(y)f(suitably)g(extending)h(the)249
1641 y(de\014nitions)f(in)f(Section)i(2.4.)249 1753 y
Fs(Order)40 b FA(Non)o(blo)q(c)o(king)13 b(comm)o(uni)o(cation)e(op)q
(erations)j(are)g(ordered)g(according)g(to)g(the)g(exe-)249
1807 y(cution)g(order)g(of)f(the)h(p)q(osting)g(calls.)j(The)e(non-o)o
(v)o(ertaking)d(requiremen)o(t)i(of)f(Section)h(2.4)f(is)249
1861 y(extended)i(to)f(non)o(blo)q(c)o(king)f(comm)o(unicatio)o(n.)249
1956 y Fs(Example)i(2.20)21 b FA(Message)15 b(ordering)f(for)f(non)o
(blo)q(c)o(king)g(op)q(erations.)249 2010 y Fr(CALL)21
b(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))249 2064 y(IF)g
(\(rank.EQ.0\))f(THEN)380 2118 y(CALL)h(MPI_ISEND\(a,)e(1,)i(MPI_REAL,)
f(1,)i(0,)f(comm,)g(r1,)g(ierr\))380 2172 y(CALL)g(MPI_ISEND\(b,)e(1,)i
(MPI_REAL,)f(1,)i(0,)f(comm,)g(r2,)g(ierr\))249 2226
y(ELSE)g(IF)g(\(rank.EQ.1\))f(THEN)380 2280 y(CALL)h(MPI_IRECV\(a,)e
(1,)i(MPI_REAL,)f(0,)i(0,)f(comm,)g(r1,)g(ierr\))380
2334 y(CALL)g(MPI_IRECV\(b,)e(1,)i(MPI_REAL,)f(0,)i(0,)f(comm,)g(r2,)g
(ierr\))249 2388 y(END)g(IF)249 2442 y(CALL)g(MPI_WAIT\(r2,status)o(\))
249 2496 y(CALL)g(MPI_WAIT\(r1,status)o(\))p eop
%%Page: 61 75
61 74 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(61)249 561 y FA(The)18 b(\014rst)g(send)g(of)f(pro)q(cess)i(zero)
f(will)e(matc)o(h)h(the)g(\014rst)i(receiv)o(e)f(of)f(pro)q(cess)i
(one,)f(ev)o(en)g(if)249 615 y(b)q(oth)c(messages)g(are)g(sen)o(t)h(b)q
(efore)g(pro)q(cess)g(one)g(executes)h(either)e(receiv)o(e.)291
711 y(The)g(order)h(requiremen)o(t)f(sp)q(eci\014es)i(ho)o(w)d(p)q
(ost-send)j(calls)d(are)i(matc)o(hed)e(to)h(p)q(ost-receiv)o(e)249
765 y(calls.)j(There)11 b(are)h(no)e(restrictions)i(on)e(the)i(order)f
(in)f(whic)o(h)h(op)q(erations)g(complete.)16 b(Consider)249
819 y(the)f(co)q(de)f(in)g(Example)26 b(2.21.)249 914
y Fs(Example)15 b(2.21)21 b FA(Order)15 b(of)e(completion)f(for)i(non)o
(blo)q(c)o(king)f(comm)o(uni)o(cations.)249 968 y Fr(CALL)21
b(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))249 1022 y(flag1)g(=)g
(.FALSE.)249 1076 y(flag2)g(=)g(.FALSE.)249 1130 y(IF)g(\(rank.EQ.0\))f
(THEN)314 1184 y(CALL)h(MPI_ISEND\(a,)f(n,)h(MPI_REAL,)f(1,)h(0,)h
(comm,)f(r1,)g(ierr\))314 1238 y(CALL)g(MPI_ISEND\(b,)f(1,)h(MPI_REAL,)
f(1,)h(0,)h(comm,)f(r2,)g(ierr\))314 1292 y(DO)h(WHILE)f
(\(.NOT.\(flag1.AN)o(D.fla)o(g2\)\))380 1346 y(IF)g(\(.NOT.flag1\))f
(CALL)g(MPI_TEST\(r1,)g(flag1,)g(s,)i(ierr\))380 1400
y(IF)f(\(.NOT.flag2\))f(CALL)g(MPI_TEST\(r2,)g(flag2,)g(s,)i(ierr\))314
1454 y(END)g(DO)249 1508 y(ELSE)f(IF)g(\(rank.EQ.1\))f(THEN)314
1562 y(CALL)h(MPI_IRECV\(a,)f(n,)h(MPI_REAL,)f(0,)h(0,)h(comm,)f(r1,)g
(ierr\))314 1616 y(CALL)g(MPI_IRECV\(b,)f(1,)h(MPI_REAL,)f(0,)h(0,)h
(comm,)f(r2,)g(ierr\))314 1670 y(DO)h(WHILE)f(\(.NOT.\(flag1.AN)o
(D.fla)o(g2\)\))380 1724 y(IF)g(\(.NOT.flag1\))f(CALL)g(MPI_TEST\(r1,)g
(flag1,)g(s,)i(ierr\))380 1778 y(IF)f(\(.NOT.flag2\))f(CALL)g
(MPI_TEST\(r2,)g(flag2,)g(s,)i(ierr\))314 1831 y(END)g(DO)249
1885 y(END)f(IF)249 1993 y FA(As)d(in)e(Example)g(2.20,)g(the)i
(\014rst)g(send)g(of)f(pro)q(cess)i(zero)f(will)e(matc)o(h)g(the)i
(\014rst)g(receiv)o(e)g(of)249 2047 y(pro)q(cess)f(one.)k(Ho)o(w)o(ev)o
(er,)15 b(the)g(second)h(receiv)o(e)g(ma)o(y)d(complete)h(ahead)h(of)g
(the)g(\014rst)h(receiv)o(e,)249 2101 y(and)h(the)h(second)h(send)f(ma)
o(y)d(complete)i(ahead)g(of)g(the)h(\014rst)g(send,)h(esp)q(ecially)e
(if)g(the)h(\014rst)249 2155 y(comm)o(unication)10 b(in)o(v)o(olv)o(es)
j(more)g(data)h(than)g(the)g(second.)291 2251 y(Since)g(the)h
(completion)d(of)i(a)g(receiv)o(e)h(can)g(tak)o(e)f(an)g(arbitrary)g
(amoun)o(t)e(of)i(time,)e(there)k(is)249 2305 y(no)11
b(w)o(a)o(y)f(to)h(infer)g(that)g(the)h(receiv)o(e)g(op)q(eration)f
(completed,)g(short)g(of)g(executing)g(a)g(complete-)249
2359 y(receiv)o(e)j(call.)j(On)c(the)g(other)g(hand,)f(the)i
(completion)c(of)i(a)h(send)g(op)q(eration)g(can)f(b)q(e)i(inferred)249
2413 y(indirectly)g(from)e(the)i(completion)f(of)g(a)g(matc)o(hing)g
(receiv)o(e.)p eop
%%Page: 62 76
62 75 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(62)1275 b(Chapter)13 b(2)249 507
y Fs(Progress)40 b FA(A)15 b(comm)o(unication)d(is)j
FB(enable)n(d)g FA(once)h(a)f(send)h(and)f(a)g(matc)o(hing)e(receiv)o
(e)k(ha)o(v)o(e)249 561 y(b)q(een)11 b(p)q(osted)f(b)o(y)f(t)o(w)o(o)g
(pro)q(cesses.)20 b(The)10 b(progress)g(rule)g(requires)h(that)e(once)i
(a)e(comm)o(unicatio)o(n)249 615 y(is)h(enabled,)g(then)g(either)h(the)
f(send)h(or)f(the)g(receiv)o(e)h(will)d(pro)q(ceed)k(to)d(completion)f
(\(they)j(migh)o(t)249 669 y(not)j(b)q(oth)f(complete)g(as)h(the)g
(send)h(migh)o(t)d(b)q(e)i(matc)o(hed)f(b)o(y)g(another)h(receiv)o(e)h
(or)f(the)g(receiv)o(e)249 723 y(migh)o(t)g(b)q(e)i(matc)o(hed)f(b)o(y)
h(another)g(send\).)24 b(Th)o(us,)16 b(a)g(call)f(to)g
Fw(MPI)p 1306 723 13 2 v 15 w(W)m(AIT)f FA(that)i(completes)g(a)249
777 y(receiv)o(e)g(will)d(ev)o(en)o(tually)g(return)j(if)d(a)i(matc)o
(hing)d(send)j(has)g(b)q(een)g(started,)g(unless)h(the)f(send)249
831 y(is)g(satis\014ed)h(b)o(y)f(another)h(receiv)o(e.)24
b(In)15 b(particular,)g(if)f(the)i(matc)o(hing)e(send)i(is)f(non)o(blo)
q(c)o(king,)249 885 y(then)e(the)f(receiv)o(e)h(completes)f(ev)o(en)h
(if)e(no)g(complete-send)h(call)f(is)h(made)f(on)h(the)g(sender)i
(side.)291 939 y(Similarl)o(y)m(,)7 b(a)j(call)f(to)h
Fw(MPI)p 699 939 V 14 w(W)m(AIT)f FA(that)h(completes)g(a)f(send)i(ev)o
(en)o(tually)f(returns)h(if)e(a)h(matc)o(h-)249 993 y(ing)g(receiv)o(e)
i(has)f(b)q(een)g(started,)h(unless)g(the)f(receiv)o(e)h(is)e
(satis\014ed)h(b)o(y)g(another)g(send,)g(and)g(ev)o(en)249
1047 y(if)i(no)h(complete-receiv)o(e)g(call)f(is)h(made)f(on)g(the)i
(receiving)f(side.)249 1142 y Fs(Example)h(2.22)21 b
FA(An)14 b(illustration)e(of)i(progress)h(seman)o(tics.)249
1196 y Fr(CALL)21 b(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))249
1250 y(IF)g(\(rank.EQ.0\))f(THEN)380 1304 y(CALL)h(MPI_SEND\(a,)e
(count,)i(MPI_REAL,)f(1,)h(0,)h(comm,)e(ierr\))380 1358
y(CALL)h(MPI_SEND\(b,)e(count,)i(MPI_REAL,)f(1,)h(1,)h(comm,)e(ierr\))
249 1412 y(ELSE)h(IF)g(\(rank.EQ.1\))f(THEN)380 1466
y(CALL)h(MPI_IRECV\(a,)e(count,)i(MPI_REAL,)f(0,)h(0,)g(comm,)g(r,)g
(ierr\))380 1520 y(CALL)g(MPI_RECV\(b,)e(count,)i(MPI_REAL,)f(0,)h(1,)h
(comm,)e(status,)h(ierr\))380 1574 y(CALL)g(MPI_WAIT\(r,)e(status,)i
(ierr\))249 1628 y(END)g(IF)249 1736 y FA(This)14 b(program)e(is)i
(safe)g(and)g(should)g(not)g(deadlo)q(c)o(k.)k(The)c(\014rst)h(send)g
(of)e(pro)q(cess)j(zero)e(m)o(ust)249 1790 y(complete)d(after)h(pro)q
(cess)i(one)e(p)q(osts)h(the)f(matc)o(hing)e(\(non)o(blo)q(c)o(king\))h
(receiv)o(e)i(ev)o(en)g(if)e(pro)q(cess)249 1844 y(one)h(has)g(not)g(y)
o(et)g(reac)o(hed)i(the)e(call)f(to)h Fw(MPI)p 953 1844
V 15 w(W)m(AIT)p FA(.)e(Th)o(us,)i(pro)q(cess)i(zero)f(will)d(con)o
(tin)o(ue)j(and)249 1898 y(execute)j(the)e(second)h(send,)g(allo)o
(wing)c(pro)q(cess)16 b(one)e(to)g(complete)f(execution.)291
1993 y(If)f(a)g(call)f(to)h Fw(MPI)p 564 1993 V 15 w(TEST)g
FA(that)h(completes)f(a)g(receiv)o(e)h(is)g(rep)q(eatedly)g(made)e
(with)h(the)h(same)249 2047 y(argumen)o(ts,)19 b(and)f(a)h(matc)o(hing)
d(send)k(has)f(b)q(een)h(started,)g(then)g(the)f(call)f(will)f(ev)o(en)
o(tually)249 2101 y(return)k Fw(\015ag)f(=)h(true)p FA(,)h(unless)f
(the)g(send)g(is)f(satis\014ed)h(b)o(y)f(another)g(receiv)o(e.)39
b(If)19 b(a)h(call)g(to)249 2155 y Fw(MPI)p 326 2155
V 14 w(TEST)f FA(that)g(completes)f(a)g(send)i(is)e(rep)q(eatedly)i
(made)d(with)h(the)h(same)f(argumen)o(ts,)249 2209 y(and)12
b(a)h(matc)o(hing)e(receiv)o(e)i(has)g(b)q(een)h(started,)f(then)h(the)
f(call)f(will)f(ev)o(en)o(tually)h(return)i Fw(\015ag)e(=)249
2263 y(true)p FA(,)j(unless)f(the)h(receiv)o(e)g(is)f(satis\014ed)g(b)o
(y)g(another)g(send.)249 2375 y Fs(F)l(airness)40 b FA(The)15
b(statemen)o(t)g(made)e(in)h(Section)h(2.4)f(concerning)i(fairness)f
(applies)f(to)h(non-)249 2429 y(blo)q(c)o(king)e(comm)o(unicatio)o(ns.)
j(Namely)m(,)11 b Fw(MPI)i FA(do)q(es)i(not)f(guaran)o(tee)g(fairness.)
p eop
%%Page: 63 77
63 76 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(63)249 507 y Fs(Bu\013ering)18 b(and)i(resource)e(limitation)o(s)
38 b FA(The)19 b(use)f(of)f(non)o(blo)q(c)o(king)g(comm)o(unicatio)o(n)
249 561 y(alleviates)d(the)i(need)g(for)e(bu\013ering,)h(since)h(a)e
(sending)h(pro)q(cess)i(ma)o(y)c(progress)j(after)f(it)f(has)249
615 y(p)q(osted)20 b(a)g(send.)35 b(Therefore,)22 b(the)e(constrain)o
(ts)g(of)f(safe)g(programming)d(can)j(b)q(e)i(relaxed.)249
669 y(Ho)o(w)o(ev)o(er,)14 b(some)f(amoun)o(t)f(of)h(storage)i(is)e
(consumed)h(b)o(y)g(a)f(p)q(ending)h(comm)o(unication.)h(A)o(t)f(a)249
723 y(minim)n(um)o(,)9 b(the)14 b(comm)o(unicatio)o(n)c(subsystem)j
(needs)h(to)f(cop)o(y)g(the)g(parameters)g(of)f(a)g(p)q(osted)249
777 y(send)19 b(or)g(receiv)o(e)h(b)q(efore)f(the)g(call)f(returns.)33
b(If)18 b(this)h(storage)g(is)f(exhausted,)j(then)e(a)f(call)249
831 y(that)d(p)q(osts)h(a)e(new)i(comm)o(unicatio)o(n)c(will)i(fail,)f
(since)j(p)q(ost-send)g(or)f(p)q(ost-receiv)o(e)h(calls)f(are)249
885 y(not)j(allo)o(w)o(ed)g(to)g(blo)q(c)o(k.)31 b(A)19
b(high)f(qualit)o(y)f(implemen)o(tatio)o(n)f(will)h(consume)h(only)g(a)
g(\014xed)249 939 y(amoun)o(t)10 b(of)i(storage)g(p)q(er)h(p)q(osted,)g
(non)o(blo)q(c)o(king)d(comm)o(unication,)f(th)o(us)j(supp)q(orting)g
(a)g(large)249 993 y(n)o(um)o(b)q(er)f(of)h(p)q(ending)g(comm)o
(unications.)j(The)d(failure)f(of)h(a)g(parallel)f(program)f(that)i
(exceeds)249 1047 y(the)h(b)q(ounds)g(on)f(the)h(n)o(um)o(b)q(er)e(of)h
(p)q(ending)h(non)o(blo)q(c)o(king)e(comm)o(unicati)o(ons,)f(lik)o(e)h
(the)i(failure)249 1101 y(of)j(a)h(sequen)o(tial)g(program)f(that)h
(exceeds)i(the)e(b)q(ound)g(on)g(stac)o(k)h(size,)g(should)e(b)q(e)i
(seen)g(as)249 1155 y(a)g(pathological)e(case,)k(due)f(either)g(to)f(a)
g(pathological)f(program)f(or)j(a)f(pathological)e Fw(MPI)249
1209 y FA(implemen)o(tation.)249 1292 y Fs(Example)f(2.23)21
b FA(An)14 b(illustration)e(of)i(bu\013ering)g(for)f(non)o(blo)q(c)o
(king)g(messages.)249 1346 y Fr(CALL)21 b(MPI_COMM_RANK\(comm)o(,)e
(rank,)i(ierr\))249 1400 y(IF)g(\(rank.EQ.0\))f(THEN)336
1454 y(CALL)h(MPI_ISEND\(sendbuf,)d(count,)j(MPI_REAL,)f(1,)h(tag,)g
(comm,)g(req,)g(ierr\))336 1508 y(CALL)g(MPI_RECV\(recvbuf,)d(count,)j
(MPI_REAL,)f(1,)h(tag,)g(comm,)g(status,)f(ierr\))336
1562 y(CALL)h(MPI_WAIT\(req,)e(status,)i(ierr\))249 1616
y(ELSE)86 b(!)22 b(rank.EQ.1)336 1670 y(CALL)f(MPI_ISEND\(sendbuf,)d
(count,)j(MPI_REAL,)f(0,)h(tag,)g(comm,)g(req,)g(ierr\))336
1724 y(CALL)g(MPI_RECV\(recvbuf,)d(count,)j(MPI_REAL,)f(0,)h(tag,)g
(comm,)g(status,)f(ierr\))336 1778 y(CALL)h(MPI_WAIT\(req,)e(status,)i
(ierr\))249 1831 y(END)g(IF)249 1939 y FA(This)15 b(program)f(is)h
(similar)e(to)i(the)h(program)d(sho)o(wn)j(in)e(Example)g(2.9,)g(page)i
(34:)k(t)o(w)o(o)15 b(pro-)249 1993 y(cesses)f(exc)o(hange)e(messages,)
g(b)o(y)f(\014rst)h(executing)g(a)f(send,)i(next)f(a)f(receiv)o(e.)18
b(Ho)o(w)o(ev)o(er,)12 b(unlik)o(e)249 2047 y(Example)h(2.9,)f(a)i(non)
o(blo)q(c)o(king)f(send)h(is)g(used.)20 b(This)13 b(program)g(is)h
(safe,)f(since)i(it)f(is)g(not)g(nec-)249 2101 y(essary)h(to)f
(bu\013er)h(an)o(y)e(of)g(the)i(messages)f(data.)249
2184 y Fs(Example)h(2.24)21 b FA(Out)14 b(of)f(order)i(comm)o
(unication)10 b(with)k(non)o(blo)q(c)o(king)f(messages.)249
2238 y Fr(CALL)21 b(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))249
2292 y(IF)g(\(rank.EQ.0\))f(THEN)336 2346 y(CALL)h(MPI_SEND\(sendbuf1,)
d(count,)j(MPI_REAL,)f(1,)h(1,)h(comm,)e(ierr\))336 2400
y(CALL)h(MPI_SEND\(sendbuf2,)d(count,)j(MPI_REAL,)f(1,)h(2,)h(comm,)e
(ierr\))249 2454 y(ELSE)86 b(!)22 b(rank.EQ.1)336 2508
y(CALL)f(MPI_IRECV\(recvbuf2)o(,)e(count,)i(MPI_REAL,)f(0,)h(2,)g
(comm,)g(req1,)g(ierr\))p eop
%%Page: 64 78
64 77 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(64)1275 b(Chapter)13 b(2)336 507
y Fr(CALL)21 b(MPI_IRECV\(recvbuf1)o(,)e(count,)i(MPI_REAL,)f(0,)h(1,)g
(comm,)g(req2,)g(ierr\))336 561 y(CALL)g(MPI_WAIT\(req1,)e(status,)h
(ierr\))336 615 y(CALL)h(MPI_WAIT\(req2,)e(status,)h(ierr\))249
669 y(END)h(IF)249 777 y FA(In)14 b(this)g(program)e(pro)q(cess)k(zero)
e(sends)h(t)o(w)o(o)f(messages)f(to)h(pro)q(cess)i(one,)d(while)h(pro)q
(cess)h(one)249 831 y(receiv)o(es)f(these)h(t)o(w)o(o)d(messages)h(in)f
(the)h(rev)o(erse)i(order.)k(If)12 b(blo)q(c)o(king)g(send)h(and)g
(receiv)o(e)h(op)q(er-)249 885 y(ations)f(w)o(ere)i(used,)f(the)g
(program)e(w)o(ould)h(b)q(e)h(unsafe:)19 b(the)14 b(\014rst)g(message)g
(has)f(to)h(b)q(e)g(copied)249 939 y(and)k(bu\013ered)i(b)q(efore)f
(the)g(second)h(send)f(can)g(pro)q(ceed;)j(the)d(\014rst)g(receiv)o(e)g
(can)g(complete)249 993 y(only)d(after)g(the)i(second)f(send)g
(executes.)28 b(Ho)o(w)o(ev)o(er,)18 b(since)f(w)o(e)g(used)g(non)o
(blo)q(c)o(king)e(receiv)o(e)249 1047 y(op)q(erations,)g(the)g(program)
e(is)i(safe.)20 b(The)15 b Fw(MPI)f FA(implemen)o(tation)e(will)h
(store)i(a)g(small,)d(\014xed)249 1101 y(amoun)o(t)g(of)i(information)d
(ab)q(out)k(the)f(\014rst)h(receiv)o(e)h(call)d(b)q(efore)i(it)f(pro)q
(ceeds)i(to)e(the)h(second)249 1155 y(receiv)o(e)f(call.)j(Once)d(the)f
(second)h(p)q(ost-receiv)o(e)g(call)e(o)q(ccurred)j(at)d(pro)q(cess)j
(one)e(and)f(the)i(\014rst)249 1209 y(\(blo)q(c)o(king\))j(send)i(o)q
(ccurred)h(at)d(pro)q(cess)j(zero)f(then)f(the)h(transfer)f(of)g
(bu\013er)g Fr(sendbuf1)f FA(is)249 1263 y(enabled)e(and)g(is)f(guaran)
o(teed)h(to)g(complete.)20 b(A)o(t)15 b(that)f(p)q(oin)o(t,)g(the)i
(second)f(send)h(at)f(pro)q(cess)249 1317 y(zero)g(is)f(started,)g(and)
g(is)g(also)f(guaran)o(teed)h(to)g(complete.)291 1412
y(The)k(approac)o(h)g(illustrated)g(in)f(the)i(last)f(t)o(w)o(o)f
(examples)g(can)h(b)q(e)h(used,)g(in)f(general,)h(to)249
1466 y(transform)e(unsafe)h(programs)e(in)o(to)h(safe)h(ones.)30
b(Assume)18 b(that)g(the)g(program)e(consists)j(of)249
1520 y(successiv)o(e)14 b(comm)o(unicatio)o(n)9 b(phases,)k(where)g
(pro)q(cesses)h(exc)o(hange)e(data,)f(follo)o(w)o(ed)f(b)o(y)i(com-)249
1574 y(putation)g(phases.)18 b(The)13 b(comm)o(unicatio)o(n)d(phase)i
(should)g(b)q(e)h(rewritten)h(as)e(t)o(w)o(o)g(sub-phases,)249
1628 y(the)i(\014rst)g(where)g(eac)o(h)g(pro)q(cess)h(p)q(osts)f(all)e
(its)h(comm)o(unication,)c(and)k(the)h(second)g(where)h(the)249
1682 y(pro)q(cess)20 b(w)o(aits)e(for)g(the)h(completion)e(of)h(all)f
(its)h(comm)o(unications.)29 b(The)18 b(order)i(in)e(whic)o(h)249
1736 y(the)g(comm)o(unicatio)o(ns)d(are)j(p)q(osted)g(is)f(not)g(imp)q
(ortan)o(t,)f(as)h(long)g(as)g(the)h(total)e(n)o(um)o(b)q(er)h(of)249
1790 y(messages)h(sen)o(t)h(or)e(receiv)o(ed)j(at)d(an)o(y)h(no)q(de)g
(is)g(mo)q(derate.)29 b(This)18 b(is)g(further)g(discussed)i(in)249
1844 y(Section)14 b(9.2.)249 1927 y Fs(2.8.7)48 b(Commen)o(ts)14
b(on)i(Seman)o(tics)d(of)i(Non)o(blo)q(c)o(king)e(Comm)o(unications)249
2010 y FB(A)n(dvic)n(e)f(to)h(users.)35 b FA(T)o(ypically)m(,)9
b(a)i(p)q(osted)i(send)f(will)e(consume)h(storage)h(b)q(oth)f(at)g(the)
h(sending)249 2064 y(and)j(at)f(the)h(receiving)g(pro)q(cess.)23
b(The)15 b(sending)g(pro)q(cess)h(has)f(to)g(k)o(eep)g(trac)o(k)g(of)f
(the)h(p)q(osted)249 2118 y(send,)c(and)e(the)h(receiving)f(pro)q(cess)
j(needs)e(the)g(message)f(en)o(v)o(elop)q(e,)h(so)g(as)f(to)g(b)q(e)h
(able)f(to)h(matc)o(h)249 2172 y(it)k(to)f(p)q(osted)i(receiv)o(es.)20
b(Th)o(us,)13 b(storage)i(for)e(p)q(ending)h(comm)o(unicatio)o(ns)e
(can)i(b)q(e)g(exhausted)249 2226 y(not)h(only)f(when)i(an)o(y)f(one)g
(no)q(de)h(executes)h(a)e(large)f(n)o(um)o(b)q(er)h(of)f(p)q(ost-send)j
(or)e(p)q(ost-receiv)o(e)249 2280 y(calls,)d(but)h(also)f(when)i(an)o
(y)e(one)h(no)q(de)g(is)g(the)h(destination)e(of)g(a)h(large)f(n)o(um)o
(b)q(er)h(of)f(messages.)249 2334 y(In)i(a)f(large)g(system,)g(suc)o(h)
h(a)f(\\hot-sp)q(ot")h(ma)o(y)d(o)q(ccur)k(ev)o(en)f(if)e(eac)o(h)i
(individual)e(pro)q(cess)j(has)249 2388 y(only)j(a)g(small)f(n)o(um)o
(b)q(er)h(of)g(p)q(ending)h(p)q(osted)h(sends)g(or)e(receiv)o(es,)k(if)
c(the)h(comm)o(unicatio)o(n)249 2442 y(pattern)c(is)f(v)o(ery)g(un)o
(balanced.)36 b(\()p FB(End)16 b(of)f(advic)n(e)g(to)g(users.)p
FA(\))p eop
%%Page: 65 79
65 78 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(65)249 507 y FB(A)n(dvic)n(e)18 b(to)g(implementors.)57
b FA(In)18 b(most)e Fw(MPI)g FA(implemen)o(tations,)f(sends)k(and)e
(receiv)o(es)i(are)249 561 y(matc)o(hed)c(at)g(the)h(receiving)g(pro)q
(cess)h(no)q(de.)24 b(This)15 b(is)g(b)q(ecause)i(the)f(receiv)o(e)h
(ma)o(y)d(sp)q(ecify)i(a)249 615 y(wildcard)i(source)h(parameter.)29
b(When)19 b(a)e(p)q(ost-send)i(returns,)h(the)f Fw(MPI)e
FA(implemen)o(tatio)o(n)249 669 y(m)o(ust)11 b(guaran)o(tee)i(not)g
(only)e(that)i(it)f(has)g(stored)h(the)g(parameters)g(of)f(the)h(call,)
e(but)i(also)e(that)249 723 y(it)k(can)h(forw)o(ard)g(the)g(en)o(v)o
(elop)q(e)g(of)f(the)i(p)q(osted)g(message)e(to)h(the)g(destination.)23
b(Otherwise,)249 777 y(no)15 b(progress)i(migh)o(t)d(o)q(ccur)i(on)g
(the)g(p)q(osted)g(send,)h(ev)o(en)f(though)g(a)f(matc)o(hing)f(receiv)
o(e)j(w)o(as)249 831 y(p)q(osted.)i(This)14 b(imp)q(oses)f
(restrictions)i(on)f(implemen)o(tati)o(ons)d(strategies)16
b(for)d Fw(MPI)p FA(.)249 902 y(Assume,)d(for)f(example,)g(that)h(eac)o
(h)g(pair)f(of)g(comm)o(unicating)d(pro)q(cesses)13 b(is)c(connected)j
(b)o(y)d(one)249 956 y(ordered,)19 b(\015o)o(w-con)o(trolled)d(c)o
(hannel.)28 b(A)17 b(na)961 946 y(\177)966 956 y(iv)o(e)f
Fw(MPI)h FA(implemen)o(tati)o(on)d(ma)o(y)h(eagerly)j(send)249
1010 y(do)o(wn)11 b(the)h(c)o(hannel)g(an)o(y)f(p)q(osted)i(send)f
(message;)g(the)g(bac)o(k)f(pressure)j(from)c(the)i(\015o)o(w-con)o
(trol)249 1064 y(mec)o(hanism)d(will)g(prev)o(en)o(t)j(loss)f(of)g
(data)f(and)h(will)f(throttle)h(the)h(sender)g(if)e(the)i(receiv)o(er)h
(is)e(not)249 1117 y(ready)j(to)g(receiv)o(e)h(the)g(incoming)c(data.)
18 b(Unfortunately)m(,)13 b(with)g(this)h FB(short)h(pr)n(oto)n(c)n(ol)
p FA(,)e(a)g(long)249 1171 y(message)k(sen)o(t)i(b)o(y)e(a)g(non)o(blo)
q(c)o(king)g(send)h(op)q(eration)f(ma)o(y)f(\014ll)h(the)h(c)o(hannel,)
g(and)f(prev)o(en)o(t)249 1225 y(mo)o(ving)12 b(to)i(the)h(receiv)o(er)
h(an)o(y)e(information)e(on)i(subsequen)o(tly)i(p)q(osted)f(sends.)21
b(This)15 b(migh)o(t)249 1279 y(o)q(ccur,)g(for)e(example,)g(with)g
(the)i(program)d(in)i(Example)e(2.24,)h(page)h(63.)k(The)c(data)g(sen)o
(t)h(b)o(y)249 1333 y(the)f(\014rst)g(send)h(call)d(migh)o(t)f(clog)i
(the)h(c)o(hannel,)f(and)h(prev)o(en)o(t)g(pro)q(cess)h(zero)g(from)c
(informing)249 1387 y(pro)q(cess)16 b(one)e(that)g(the)g(second)h(send)
g(w)o(as)f(p)q(osted.)249 1458 y(The)i(problem)e(can)i(b)q(e)g
(remedied)f(b)o(y)h(using)f(a)g FB(long)i(pr)n(oto)n(c)n(ol)p
FA(:)j(when)c(a)g(send)g(is)f(p)q(osted,)i(it)249 1512
y(is)g(only)e(the)j(message)e(en)o(v)o(elop)q(e)h(that)g(is)f(sen)o(t)h
(to)g(the)g(receiving)g(pro)q(cess.)28 b(The)17 b(receiving)249
1566 y(pro)q(cess)d(bu\013ers)g(the)f(\014xed-size)g(en)o(v)o(elop)q
(e.)18 b(When)12 b(a)g(matc)o(hing)f(receiv)o(e)i(is)f(p)q(osted,)h(it)
f(sends)249 1620 y(bac)o(k)h(a)g(\\ready-to-receiv)o(e")g(message)g(to)
g(the)g(sender.)20 b(The)13 b(sender)h(can)g(no)o(w)e(transmit)g(the)
249 1674 y(message)g(data,)g(without)g(clogging)f(the)i(comm)o
(unication)c(c)o(hannel.)18 b(The)12 b(t)o(w)o(o)g(proto)q(cols)h(are)
249 1728 y(illustrated)h(in)f(Figure)h(2.5.)249 1798
y(While)20 b(safer,)h(this)g(proto)q(col)f(requires)h(t)o(w)o(o)f
(additional)f(transactions,)j(as)e(compared)g(to)249
1852 y(the)f(simpler,)e(eager)h(proto)q(col.)30 b(A)18
b(p)q(ossible)h(compromise)c(is)j(to)g(use)h(the)f(short)h(proto)q(col)
249 1906 y(for)g(short)h(messages,)h(and)e(the)h(long)e(proto)q(col)i
(for)f(long)f(messages.)35 b(An)20 b(early-arriving)249
1960 y(short)g(message)f(is)g(bu\013ered)h(at)f(the)h(destination.)34
b(The)19 b(amoun)o(t)f(of)g(storage)i(consumed)249 2014
y(p)q(er)c(p)q(ending)e(comm)o(unication)d(is)k(still)e(b)q(ounded)j(b)
o(y)e(a)g(\(reasonably)h(small\))d(constan)o(t)k(and)249
2068 y(the)d(hand-shaking)f(o)o(v)o(erhead)i(can)f(b)q(e)g(amortized)f
(o)o(v)o(er)h(the)g(transfer)h(of)e(larger)h(amoun)o(ts)e(of)249
2122 y(data.)249 2193 y(\()p FB(End)16 b(of)f(advic)n(e)g(to)g
(implementors.)p FA(\))249 2284 y FB(R)n(ationale.)39
b FA(When)14 b(a)g(pro)q(cess)i(runs)f(out)f(of)g(space)h(and)f(cannot)
h(handle)f(a)g(new)g(p)q(ost-send)249 2338 y(op)q(eration,)d(w)o(ould)g
(it)f(not)i(b)q(e)f(b)q(etter)i(to)e(blo)q(c)o(k)g(the)h(sender,)h
(rather)f(than)f(declare)h(failure?)17 b(If)249 2392
y(one)c(merely)f(blo)q(c)o(ks)h(the)g(p)q(ost-send,)h(then)f(it)f(is)h
(p)q(ossible)g(that)g(the)g(messages)g(that)g(clog)f(the)249
2446 y(comm)o(unication)d(subsystem)k(will)e(b)q(e)i(consumed,)g(allo)o
(wing)d(the)j(computation)e(to)h(pro)q(ceed.)249 2500
y(Th)o(us,)i(blo)q(c)o(king)f(w)o(ould)g(allo)o(w)f(more)h(programs)g
(to)g(run)h(successfully)m(.)p eop
%%Page: 66 80
66 79 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(66)1275 b(Chapter)13 b(2)249 466
y
 23681433 13498413 0 0 37166694 21444853 startTexFig
 249 466 a
%%BeginDocument: ../figures/pt2pt-protocol.ps
/$F2psDict 6400 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
	/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
	/$F2psEnd {$F2psEnteredState restore end} def
	%%EndProlog

$F2psBegin
0 setlinecap 0 setlinejoin
-36 20 translate
0.0 326.0 translate 0.900 -0.900 scale
2.000 setlinewidth
% Polyline
n 99 79 m 99 294 l gs col-1 s gr
% Polyline
n 229 99 m 229 279 l gs col-1 s gr
% Polyline
n 419 59 m 419 384 l gs col-1 s gr
% Polyline
n 559 69 m 559 369 l gs col-1 s gr
1.000 setlinewidth
% Polyline
n 99 119 m 224 179 l gs col-1 s gr
n 211.307 168.470 m 224.000 179.000 l 207.845 175.682 l gs 2 setlinejoin col-1 s gr
% Polyline
n 224 209 m 109 254 l gs col-1 s gr
n 125.357 251.895 m 109.000 254.000 l 122.442 244.445 l gs 2 setlinejoin col-1 s gr
% Polyline
n 424 99 m 554 144 l gs col-1 s gr
n 540.189 134.986 m 554.000 144.000 l 537.572 142.546 l gs 2 setlinejoin col-1 s gr
% Polyline
n 554 159 m 424 204 l gs col-1 s gr
n 440.428 202.546 m 424.000 204.000 l 437.811 194.986 l gs 2 setlinejoin col-1 s gr
% Polyline
n 424 209 m 554 269 l gs col-1 s gr
n 541.149 258.663 m 554.000 269.000 l 537.796 265.927 l gs 2 setlinejoin col-1 s gr
% Polyline
n 554 279 m 424 359 l gs col-1 s gr
n 439.723 354.021 m 424.000 359.000 l 435.530 347.208 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
119 39 m 
gs 1 -1 scale (Short Protocol) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
39 119 m 
gs 1 -1 scale (SEND) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
339 79 m 
gs 1 -1 scale (SEND) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
249 259 m 
gs 1 -1 scale (RECV) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
434 39 m 
gs 1 -1 scale (Long Protocol) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
619 159 m 
gs 1 -1 scale (RECV) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
139 224 m 
gs 1 -1 scale (ack) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
134 124 m 
gs 1 -1 scale (message) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
439 94 m 
gs 1 -1 scale (req-to-send) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
469 224 m 
gs 1 -1 scale (data) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
474 304 m 
gs 1 -1 scale (ack) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
469 169 m 
gs 1 -1 scale (ready) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1383 a Fo(Figure)g(2.5)249 1420 y Fz(Message)e(passing)f(proto)q
(cols.)249 1543 y FA(The)k(coun)o(terargumen)o(t)g(is)f(that,)g(in)g(a)
h(w)o(ell-designed)f(system,)g(the)h(large)f(ma)r(jorit)o(y)f(of)h
(pro-)249 1597 y(grams)h(that)i(exceed)h(the)f(system)g(b)q(ounds)g(on)
f(the)h(n)o(um)o(b)q(er)f(of)g(p)q(ending)h(comm)o(uni)o(cations)249
1651 y(do)g(so)h(b)q(ecause)h(of)e(program)f(errors.)28
b(Rather)17 b(then)g(arti\014cially)e(prolonging)g(the)i(life)f(of)g(a)
249 1705 y(program)c(that)h(is)g(do)q(omed)e(to)i(fail,)e(and)i(then)h
(ha)o(v)o(e)f(it)g(fail)e(in)i(an)g(obscure)h(deadlo)q(c)o(k)f(mo)q
(de,)249 1759 y(it)19 b(ma)o(y)e(b)q(e)j(b)q(etter)h(to)e(cleanly)g
(terminate)f(it,)i(and)f(ha)o(v)o(e)g(the)h(programmer)d(correct)k(the)
249 1813 y(program.)g(Also,)15 b(when)h(programs)e(run)i(close)g(to)f
(the)h(system)f(limits,)e(they)j(\\thrash")g(and)249
1867 y(w)o(aste)e(resources,)h(as)e(pro)q(cesses)j(rep)q(eatedly)f(blo)
q(c)o(k.)i(Finally)m(,)11 b(the)j(claim)d(of)h(a)h(more)f(lenien)o(t)
249 1921 y(b)q(eha)o(vior)e(should)h(not)f(b)q(e)i(used)f(as)g(an)f
(excuse)i(for)f(a)f(de\014cien)o(t)i(implem)o(en)o(tation)c(that)i
(cannot)249 1975 y(supp)q(ort)15 b(a)e(large)h(n)o(um)o(b)q(er)f(of)g
(p)q(ending)h(comm)o(unications.)249 2045 y(A)e(di\013eren)o(t)h(line)f
(of)g(argumen)o(t)f(against)g(the)i(curren)o(t)h(design)e(is)g(that)g
Fw(MPI)g FA(should)g(not)g(force)249 2099 y(implemen)o(tors)i(to)h(use)
i(more)e(complex)f(comm)o(unication)f(proto)q(cols,)j(in)f(order)i(to)f
(supp)q(ort)249 2153 y(out-of-order)k(receiv)o(es)h(with)f(a)g(large)f
(n)o(um)o(b)q(er)g(of)h(p)q(ending)g(comm)o(unicati)o(ons.)34
b(Rather,)249 2207 y(users)19 b(should)e(b)q(e)g(encouraged)h(to)f
(order)h(their)g(comm)o(unicatio)o(ns)d(so)i(that,)g(for)g(eac)o(h)h
(pair)249 2261 y(of)12 b(comm)o(unicating)e(pro)q(cesses,)15
b(receiv)o(es)g(are)f(p)q(osted)f(in)g(the)h(same)e(order)i(as)f(the)g
(matc)o(hing)249 2315 y(sends.)249 2386 y(This)j(argumen)o(t)e(is)i
(made)f(b)o(y)g(implemen)o(tors,)f(not)h(users.)26 b(Man)o(y)15
b(users)i(p)q(erceiv)o(e)h(this)e(or-)249 2440 y(dering)d(restriction)h
(as)f(to)q(o)g(constraining.)k(The)d(design)f(of)f Fw(MPI)h
FA(encourages)h(virtualization)249 2494 y(of)e(comm)o(unication,)d(as)k
(one)g(pro)q(cess)i(can)e(comm)o(unicate)d(through)j(sev)o(eral,)g
(separate)h(com-)p eop
%%Page: 67 81
67 80 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(67)249 507 y FA(m)o(unication)13 b(spaces.)24 b(One)17
b(can)e(exp)q(ect)i(that)f(users)h(will)d(increasingly)h(tak)o(e)g(adv)
n(an)o(tage)g(of)249 561 y(this)d(feature,)h(esp)q(ecially)f(on)g(m)o
(ulti-threaded)e(systems.)18 b(A)12 b(pro)q(cess)i(ma)o(y)c(supp)q(ort)
j(m)o(ultiple)249 615 y(threads,)k(eac)o(h)g(with)f(its)g(o)o(wn)f
(separate)j(comm)o(uni)o(cation)13 b(domain.)22 b(The)17
b(comm)o(unicatio)o(n)249 669 y(subsystem)e(should)g(pro)o(vide)g
(robust)h(m)o(ultiplexing)c(of)i(these)j(comm)o(unicatio)o(ns,)c(and)h
(min-)249 723 y(imize)g(the)i(c)o(hances)g(that)g(one)f(thread)h(is)f
(blo)q(c)o(k)o(ed)g(b)q(ecause)i(of)e(comm)o(unications)d(initiated)249
777 y(b)o(y)i(another)g(thread,)g(in)g(another)g(comm)o(unicatio)o(n)d
(domain.)249 848 y(Users)17 b(should)e(b)q(e)g(a)o(w)o(are)g(that)h
(di\013eren)o(t)g Fw(MPI)e FA(implemen)o(tations)e(di\013er)k(not)f
(only)f(in)h(their)249 902 y(bandwidth)h(or)f(latency)m(,)h(but)g(also)
f(in)h(their)g(abilit)o(y)e(to)i(supp)q(ort)h(out-of-order)e(deliv)o
(ery)h(of)249 956 y(messages.)i(\()p FB(End)e(of)f(r)n(ationale.)p
FA(\))249 1076 y FD(2.9)52 b(Multiple)19 b(Completions)249
1184 y FA(It)h(is)g(con)o(v)o(enien)o(t)g(and)g(e\016cien)o(t)g(to)g
(complete)f(in)g(one)h(call)g(a)f(list)h(of)f(m)o(ultiple)e(p)q(ending)
249 1238 y(comm)o(unication)e(op)q(erations,)20 b(rather)g(than)e
(completing)f(only)h(one.)33 b Fw(MPI)p 1491 1238 13
2 v 14 w(W)m(AIT)m(ANY)17 b FA(or)249 1292 y Fw(MPI)p
326 1292 V 14 w(TEST)m(ANY)d FA(are)g(used)h(to)f(complete)g(one)g(out)
g(of)f(sev)o(eral)i(op)q(erations.)k Fw(MPI)p 1559 1292
V 14 w(W)m(AIT)m(ALL)249 1346 y FA(or)13 b Fw(MPI)p 376
1346 V 14 w(TEST)m(ALL)h FA(are)f(used)h(to)f(complete)g(all)e(op)q
(erations)j(in)e(a)h(list.)k Fw(MPI)p 1463 1346 V 15
w(W)m(AITSOME)11 b FA(or)249 1400 y Fw(MPI)p 326 1400
V 14 w(TESTSOME)g FA(are)g(used)g(to)f(complete)g(all)f(enabled)i(op)q
(erations)f(in)g(a)g(list.)17 b(The)11 b(b)q(eha)o(vior)249
1454 y(of)i(these)j(functions)e(is)f(describ)q(ed)j(in)d(this)h
(section)h(and)f(in)f(Section)h(2.12.)249 1579 y Fw(MPI)p
326 1579 V 14 w(W)m(AIT)m(ANY)f(\(count,)h(a)o(rra)o(y)p
762 1579 V 15 w(of)p 811 1579 V 15 w(requests,)h(index,)g(status\))332
1653 y Fv(IN)158 b Fw(count)450 b Fv(list)14 b(length)332
1703 y(INOUT)71 b Fw(a)o(rra)o(y)p 620 1703 V 15 w(of)p
669 1703 V 14 w(requests)259 b Fv(arra)o(y)14 b(of)e(request)i(handles)
332 1753 y(OUT)114 b Fw(index)457 b Fv(index)15 b(of)d(request)i
(handle)h(that)e(completed)332 1803 y(OUT)114 b Fw(status)443
b Fv(status)14 b(ob)r(ject)249 1913 y Fr(int)21 b(MPI)p
405 1913 14 2 v 15 w(Waitany\(int)f(count,)g(MPI)p 900
1913 V 15 w(Request)h(*array)p 1222 1913 V 14 w(of)p
1280 1913 V 16 w(requests,)540 1967 y(int)g(*index,)f(MPI)p
870 1967 V 15 w(Status)h(*status\))249 2051 y(MPI)p 318
2051 V 15 w(WAITANY\(COUNT,)e(ARRAY)p 770 2051 V 15 w(OF)p
829 2051 V 15 w(REQUESTS,)h(INDEX,)g(STATUS,)h(IERROR\))336
2105 y(INTEGER)g(COUNT,)f(ARRAY)p 776 2105 V 15 w(OF)p
835 2105 V 15 w(REQUESTS\(*\),)f(INDEX,)336 2159 y(STATUS\(MPI)p
559 2159 V 14 w(STATUS)p 705 2159 V 14 w(SIZE\),)i(IERROR)291
2243 y Fw(MPI)p 368 2243 13 2 v 14 w(W)m(AIT)m(ANY)10
b FA(blo)q(c)o(ks)h(un)o(til)f(one)i(of)e(the)i(comm)o(unication)c(op)q
(erations)k(asso)q(ciated)g(with)249 2297 y(requests)j(in)d(the)h(arra)
o(y)g(has)g(completed.)k(If)12 b(more)g(then)h(one)g(op)q(eration)g
(can)g(b)q(e)g(completed,)249 2351 y Fw(MPI)p 326 2351
V 14 w(W)m(AIT)m(ANY)j FA(arbitrarily)f(pic)o(ks)i(one)g(and)g
(completes)f(it.)26 b Fw(MPI)p 1349 2351 V 14 w(W)m(AIT)m(ANY)16
b FA(returns)i(in)249 2405 y Fw(index)13 b FA(the)g(arra)o(y)f(lo)q
(cation)f(of)g(the)i(completed)e(request)j(and)d(returns)j(in)e
Fw(status)g FA(the)g(status)h(of)249 2459 y(the)j(completed)f(comm)o
(unication.)20 b(The)c(request)i(ob)r(ject)e(is)f(deallo)q(cated)h(and)
g(the)g(request)p eop
%%Page: 68 82
68 81 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(68)1275 b(Chapter)13 b(2)249 507
y FA(handle)i(is)g(set)h(to)f Fq(MPI)p 617 507 12 2 v
13 w(REQUEST)p 802 507 V 15 w(NULL)p FA(.)g Fw(MPI)p
1014 507 13 2 v 14 w(W)m(AIT)m(ANY)f FA(has)h(non-lo)q(cal)f
(completion)g(se-)249 561 y(man)o(tics.)249 686 y Fw(MPI)p
326 686 V 14 w(TEST)m(ANY\(count,)h(a)o(rra)o(y)p 750
686 V 15 w(of)p 799 686 V 14 w(requests,)g(index,)g(\015ag,)e(status\))
332 761 y Fv(IN)158 b Fw(count)450 b Fv(list)14 b(length)332
811 y(INOUT)71 b Fw(a)o(rra)o(y)p 620 811 V 15 w(of)p
669 811 V 14 w(requests)259 b Fv(arra)o(y)14 b(of)e(request)i(handles)
332 860 y(OUT)114 b Fw(index)457 b Fv(index)15 b(of)d(request)i(handle)
h(that)e(completed)332 910 y(OUT)114 b Fw(\015ag)483
b Fq(true)13 b Fv(if)g(one)h(has)f(completed)332 960
y(OUT)114 b Fw(status)443 b Fv(status)14 b(ob)r(ject)249
1070 y Fr(int)21 b(MPI)p 405 1070 14 2 v 15 w(Testany\(int)f(count,)g
(MPI)p 900 1070 V 15 w(Request)h(*array)p 1222 1070 V
14 w(of)p 1280 1070 V 16 w(requests,)540 1124 y(int)g(*index,)f(int)h
(*flag,)g(MPI)p 1110 1124 V 15 w(Status)g(*status\))249
1208 y(MPI)p 318 1208 V 15 w(TESTANY\(COUNT,)e(ARRAY)p
770 1208 V 15 w(OF)p 829 1208 V 15 w(REQUESTS,)h(INDEX,)g(FLAG,)h
(STATUS,)g(IERROR\))336 1262 y(LOGICAL)g(FLAG)336 1316
y(INTEGER)g(COUNT,)f(ARRAY)p 776 1316 V 15 w(OF)p 835
1316 V 15 w(REQUESTS\(*\),)f(INDEX,)336 1370 y(STATUS\(MPI)p
559 1370 V 14 w(STATUS)p 705 1370 V 14 w(SIZE\),)i(IERROR)291
1454 y Fw(MPI)p 368 1454 13 2 v 14 w(TEST)m(ANY)13 b
FA(tests)i(for)e(completion)f(of)h(the)h(comm)o(unicatio)o(n)d(op)q
(erations)j(asso)q(ciated)249 1508 y(with)g(requests)h(in)f(the)g(arra)
o(y)m(.)k Fw(MPI)p 823 1508 V 14 w(TEST)m(ANY)c FA(has)g(lo)q(cal)f
(completion)f(seman)o(tics.)291 1562 y(If)17 b(an)h(op)q(eration)h(has)
f(completed,)g(it)g(returns)i Fw(\015ag)e(=)h(true)p
FA(,)h(returns)f(in)f Fw(index)i FA(the)f(ar-)249 1616
y(ra)o(y)i(lo)q(cation)g(of)g(the)h(completed)g(request,)i(and)e
(returns)h(in)e Fw(status)h FA(the)g(status)h(of)e(the)249
1670 y(completed)e(comm)o(unicatio)o(n.)32 b(The)20 b(request)h(is)e
(deallo)q(cated)h(and)f(the)h(handle)f(is)g(set)i(to)249
1724 y Fq(MPI)p 321 1724 12 2 v 13 w(REQUEST)p 506 1724
V 15 w(NULL)p FA(.)291 1778 y(If)12 b(no)g(op)q(eration)g(has)h
(completed,)f(it)g(returns)i Fw(\015ag)f(=)f(false)p
FA(,)h(returns)h Fq(MPI)p 1471 1778 V 12 w(UNDEFINED)f
FA(in)249 1832 y Fw(index)i FA(and)f Fw(status)g FA(is)g(unde\014ned.)
291 1886 y(The)19 b(execution)g(of)g Fw(MPI)p 701 1886
13 2 v 14 w(T)m(estany\(count,)i(a)o(rra)o(y)p 1079 1886
V 15 w(of)p 1128 1886 V 15 w(requests,)g(&index,)h(&\015ag,)e
(&status\))249 1940 y FA(has)13 b(the)h(same)e(e\013ect)j(as)e(the)g
(execution)h(of)e Fw(MPI)p 1033 1940 V 15 w(T)m(est\()h(&a)o(rra)o(y)p
1267 1940 V 15 w(of)p 1316 1940 V 15 w(requests[i],)h(&\015ag,)f(&sta-)
249 1994 y(tus\))p FA(,)j(for)g Fw(i=0,)g(1)g(,...,)e(count-1)p
FA(,)i(in)g(some)f(arbitrary)h(order,)g(un)o(til)f(one)i(call)e
(returns)i Fw(\015ag)f(=)249 2048 y(true)p FA(,)i(or)f(all)e(fail.)25
b(In)17 b(the)g(former)f(case,)i Fw(index)g FA(is)e(set)i(to)e(the)i
(last)e(v)n(alue)g(of)g Fw(i)p FA(,)h(and)g(in)f(the)249
2102 y(latter)e(case,)h(it)e(is)h(set)h(to)e Fq(MPI)p
732 2102 12 2 v 13 w(UNDEFINED)p FA(.)p eop
%%Page: 69 83
69 82 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(69)249 507 y Fs(Example)15 b(2.25)21 b FA(Pro)q(ducer-consumer)15
b(co)q(de)g(using)f(w)o(aitan)o(y)m(.)249 561 y Fr(...)249
615 y(typedef)20 b(struct)h({)293 669 y(char)g(data[MAXSIZE];)293
723 y(int)g(datasize;)249 777 y(})h(Buffer;)249 831 y(Buffer)f
(buffer[];)249 885 y(MPI_Request)f(req[];)249 939 y(MPI_Status)g
(status;)249 993 y(...)249 1101 y(MPI_Comm_rank\(comm)o(,)f(&rank\);)
249 1155 y(MPI_Comm_size\(comm)o(,)g(&size\);)249 1209
y(if\(rank)h(!=)i(size-1\))42 b({)h(/*)22 b(producer)e(code)43
b(*/)314 1263 y(buffer)21 b(=)h(\(Buffer)e(*\)malloc\(sizeof\(B)o
(uffer)o(\)\);)314 1317 y(while\(1\))h({)43 b(/*)21 b(main)g(loop)g(*/)
380 1371 y(produce\()f(buffer->data,)f(&buffer->datasize\))o(;)380
1425 y(MPI_Send\(buffer->)o(data)o(,)g(buffer->datasize,)f(MPI_CHAR,)
1077 1479 y(size-1,)j(tag,)g(comm\);)380 1533 y(})314
1587 y(})249 1641 y(else)g({)h(/*)f(rank)g(==)g(size-1;)g(consumer)f
(code)h(*/)314 1694 y(buffer)g(=)h(\(Buffer)e(*\)malloc\(sizeof\(B)o
(uffer)o(\)*\(si)o(ze-1\))o(\);)314 1748 y(req)i(=)f(\(MPI_Request)f
(*\)malloc\(sizeof)o(\(MPI_)o(Reque)o(st\)*\()o(size)o(-1\)\);)314
1802 y(for\(i=0;)42 b(i<)22 b(size-1;)e(i++\))380 1856
y(MPI_Irecv\(buffer[)o(i].d)o(ata,)e(MAXSIZE,)j(MPI_CHAR,)f(i,)h(tag,)
1208 1910 y(comm,)g(&req[i]\);)314 1964 y(while\(1\))g({)g(/*)h(main)f
(loop)f(*/)380 2018 y(MPI_Waitany\(size-)o(1,)f(req,)i(&i,)g
(&status\);)380 2072 y(MPI_Get_count\(&st)o(atus)o(,)e(MPI_CHAR,)h
(&buffer[i].datasi)o(ze\);)380 2126 y(consume\(buffer[i])o(.dat)o(a,)f
(buffer[i].datasiz)o(e\);)380 2180 y(MPI_Irecv\(buffer[)o(i].d)o(ata,)f
(MAXSIZE,)j(MPI_CHAR,)f(i,)h(tag,)1208 2234 y(comm,)g(&req[i]\);)380
2288 y(})293 2342 y(})249 2396 y FA(This)d(program)f(implemen)o(ts)f
(the)j(same)f(pro)q(ducer-consumer)h(proto)q(col)g(as)f(the)h(program)
249 2450 y(in)g(Example)f(2.18,)h(page)h(57.)34 b(The)20
b(use)g(of)f Fw(MPI)p 1076 2450 13 2 v 14 w(W)m(AIT)p
1194 2450 V 14 w(ANY)g FA(a)o(v)o(oids)g(the)h(execution)g(of)249
2504 y(m)o(ultiple)12 b(tests)j(to)f(\014nd)g(a)g(comm)o(unicatio)o(n)d
(that)k(completed,)e(resulting)h(in)f(more)g(compact)p
eop
%%Page: 70 84
70 83 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(70)1275 b(Chapter)13 b(2)249 507
y FA(and)g(more)f(e\016cien)o(t)h(co)q(de.)19 b(Ho)o(w)o(ev)o(er,)13
b(this)g(co)q(de,)g(unlik)o(e)f(the)i(co)q(de)f(in)g(Example)e(2.18,)h
(do)q(es)249 561 y(not)i(prev)o(en)o(t)h(starv)n(ation)f(of)g(pro)q
(ducers.)60 b(It)14 b(is)g(p)q(ossible)h(that)f(the)h(consumer)f(rep)q
(eatedly)249 615 y(consumes)19 b(messages)g(sen)o(t)h(from)d(pro)q
(cess)k(zero,)f(while)f(ignoring)e(messages)i(sen)o(t)h(b)o(y)f(the)249
669 y(other)d(pro)q(cesses.)24 b(Example)13 b(2.27)h(b)q(elo)o(w)h(sho)
o(ws)g(ho)o(w)f(to)h(implemen)o(t)e(a)h(fair)g(serv)o(er,)j(using)249
723 y Fw(MPI)p 326 723 13 2 v 14 w(W)m(AITSOME)p FA(.)249
887 y Fw(MPI)p 326 887 V 14 w(W)m(AIT)m(ALL\()d(count,)g(a)o(rra)o(y)p
750 887 V 15 w(of)p 799 887 V 15 w(requests,)h(a)o(rra)o(y)p
1065 887 V 15 w(of)p 1114 887 V 14 w(statuses\))332 961
y Fv(IN)158 b Fw(count)450 b Fv(list)14 b(length)332
1011 y(INOUT)71 b Fw(a)o(rra)o(y)p 620 1011 V 15 w(of)p
669 1011 V 14 w(requests)259 b Fv(arra)o(y)14 b(of)e(request)i(handles)
332 1060 y(OUT)114 b Fw(a)o(rra)o(y)p 620 1060 V 15 w(of)p
669 1060 V 14 w(statuses)261 b Fv(arra)o(y)14 b(of)e(status)i(ob)r
(jects)249 1170 y Fr(int)21 b(MPI)p 405 1170 14 2 v 15
w(Waitall\(int)f(count,)g(MPI)p 900 1170 V 15 w(Request)h(*array)p
1222 1170 V 14 w(of)p 1280 1170 V 16 w(requests,)540
1224 y(MPI)p 609 1224 V 15 w(Status)f(*array)p 908 1224
V 15 w(of)p 967 1224 V 15 w(statuses\))249 1308 y(MPI)p
318 1308 V 15 w(WAITALL\(COUNT,)f(ARRAY)p 770 1308 V
15 w(OF)p 829 1308 V 15 w(REQUESTS,)h(ARRAY)p 1172 1308
V 15 w(OF)p 1231 1308 V 15 w(STATUSES,)g(IERROR\))336
1362 y(INTEGER)h(COUNT,)f(ARRAY)p 776 1362 V 15 w(OF)p
835 1362 V 15 w(REQUESTS\(*\))336 1416 y(INTEGER)h(ARRAY)p
624 1416 V 14 w(OF)p 682 1416 V 16 w(STATUSES\(MPI)p
962 1416 V 13 w(STATUS)p 1107 1416 V 14 w(SIZE,*\),)f(IERROR)291
1500 y Fw(MPI)p 368 1500 13 2 v 14 w(W)m(AIT)m(ALL)15
b FA(blo)q(c)o(ks)h(un)o(til)f(all)g(comm)o(unications,)e(asso)q
(ciated)k(with)e(requests)j(in)e(the)249 1554 y(arra)o(y)m(,)c
(complete.)17 b(The)c Fw(i)p FA(-th)f(en)o(try)i(in)e
Fw(a)o(rra)o(y)p 957 1554 V 15 w(of)p 1006 1554 V 14
w(statuses)i FA(is)e(set)i(to)e(the)h(return)h(status)g(of)e(the)249
1608 y Fw(i)p FA(-th)f(op)q(eration.)17 b(All)10 b(request)j(ob)r
(jects)f(are)f(deallo)q(cated)g(and)g(the)h(corresp)q(onding)g(handles)
f(in)249 1662 y(the)16 b(arra)o(y)f(are)h(set)g(to)f
Fq(MPI)p 693 1662 12 2 v 12 w(REQUEST)p 877 1662 V 16
w(NULL)p FA(.)g Fw(MPI)p 1090 1662 13 2 v 14 w(W)m(AIT)m(ALL)g
FA(has)g(non-lo)q(cal)f(completion)249 1716 y(seman)o(tics.)291
1770 y(The)j(execution)g(of)g Fw(MPI)p 695 1770 V 14
w(W)o(aitall\(count,)h(a)o(rra)o(y)p 1059 1770 V 15 w(of)p
1108 1770 V 14 w(requests,)h(a)o(rra)o(y)p 1377 1770
V 15 w(of)p 1426 1770 V 14 w(statuses\))f FA(has)f(the)249
1824 y(same)12 b(e\013ect)i(as)f(the)g(execution)g(of)f
Fw(MPI)p 887 1824 V 14 w(W)o(ait\(&a)o(rra)o(y)p 1116
1824 V 16 w(of)p 1166 1824 V 14 w(requests[i],&a)o(rra)o(y)p
1481 1824 V 17 w(of)p 1532 1824 V 14 w(statuses[i]\))p
FA(,)249 1878 y(for)i Fw(i=0)f(,...,)f(count-1)p FA(,)i(in)f(some)g
(arbitrary)h(order.)291 1932 y(When)f(one)h(or)g(more)f(of)g(the)h
(comm)o(unicatio)o(ns)d(completed)j(b)o(y)f(a)g(call)g(to)h
Fw(MPI)p 1559 1932 V 14 w(W)m(AIT)m(ALL)249 1986 y FA(fail,)f
Fw(MPI)p 409 1986 V 14 w(W)m(AIT)m(ALL)h FA(will)e(return)k(the)f
(error)g(co)q(de)g Fq(MPI)p 1156 1986 12 2 v 13 w(ERR)p
1242 1986 V 14 w(IN)p 1294 1986 V 13 w(ST)m(A)m(TUS)g
FA(and)g(will)e(set)i(the)249 2040 y(error)h(\014eld)f(of)f(eac)o(h)h
(status)g(to)g(a)g(sp)q(eci\014c)h(error)f(co)q(de.)22
b(This)15 b(co)q(de)g(will)e(b)q(e)j Fq(MPI)p 1559 2040
V 12 w(SUCCESS)p FA(,)249 2094 y(if)j(the)i(sp)q(eci\014c)h(comm)o
(unication)17 b(completed;)22 b(it)e(will)f(b)q(e)i(another)f(sp)q
(eci\014c)i(error)f(co)q(de,)249 2148 y(if)e(it)g(failed;)j(or)d(it)h
(will)e(b)q(e)i Fq(MPI)p 795 2148 V 13 w(PENDING)f FA(if)g(it)g(has)h
(not)f(failed)g(nor)h(completed.)35 b(The)249 2201 y(function)10
b Fw(MPI)p 485 2201 13 2 v 15 w(W)m(AIT)m(ALL)g FA(will)f(return)j
Fq(MPI)p 952 2201 12 2 v 12 w(SUCCESS)g FA(if)d(it)i(completed)f
(successfully)m(,)h(or)g(will)249 2255 y(return)k(another)f(error)h(co)
q(de)f(if)f(it)g(failed)g(for)h(other)g(reasons)h(\(suc)o(h)f(as)g(in)o
(v)n(alid)d(argumen)o(ts\).)249 2309 y Fw(MPI)p 326 2309
13 2 v 14 w(W)m(AIT)m(ALL)16 b FA(up)q(dates)h(the)g(error)h(\014elds)e
(of)g(the)h(status)g(ob)r(jects)h(only)d(when)i(it)f(returns)249
2363 y Fq(MPI)p 321 2363 12 2 v 13 w(ERR)p 407 2363 V
13 w(IN)p 458 2363 V 14 w(ST)m(A)m(TUS)p FA(.)249 2454
y FB(R)n(ationale.)45 b FA(This)15 b(design)g(streamlines)g(error)h
(handling)e(in)h(the)h(application.)k(The)c(appli-)249
2508 y(cation)e(co)q(de)h(need)g(only)f(test)h(the)g(\(single\))f
(function)g(result)h(to)f(determine)h(if)e(an)h(error)h(has)p
eop
%%Page: 71 85
71 84 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(71)249 507 y FA(o)q(ccurred.)20 b(It)14 b(needs)i(to)e(c)o(hec)o
(k)g(individual)e(statuses)k(only)d(when)i(an)e(error)i(o)q(ccurred.)21
b(\()p FB(End)249 561 y(of)15 b(r)n(ationale.)p FA(\))249
723 y Fw(MPI)p 326 723 13 2 v 14 w(TEST)m(ALL\(count,)h(a)o(rra)o(y)p
738 723 V 15 w(of)p 787 723 V 14 w(requests,)f(\015ag,)e(a)o(rra)o(y)p
1140 723 V 15 w(of)p 1189 723 V 15 w(statuses\))332 798
y Fv(IN)158 b Fw(count)450 b Fv(list)14 b(length)332
848 y(INOUT)71 b Fw(a)o(rra)o(y)p 620 848 V 15 w(of)p
669 848 V 14 w(requests)259 b Fv(arra)o(y)14 b(of)e(request)i(handles)
332 898 y(OUT)114 b Fw(\015ag)483 b Fq(true)13 b Fv(if)g(all)h(ha)o(v)o
(e)g(completed)332 947 y(OUT)114 b Fw(a)o(rra)o(y)p 620
947 V 15 w(of)p 669 947 V 14 w(statuses)261 b Fv(arra)o(y)14
b(of)e(status)i(ob)r(jects)249 1058 y Fr(int)21 b(MPI)p
405 1058 14 2 v 15 w(Testall\(int)f(count,)g(MPI)p 900
1058 V 15 w(Request)h(*array)p 1222 1058 V 14 w(of)p
1280 1058 V 16 w(requests,)e(int)j(*flag,)540 1112 y(MPI)p
609 1112 V 15 w(Status)e(*array)p 908 1112 V 15 w(of)p
967 1112 V 15 w(statuses\))249 1196 y(MPI)p 318 1196
V 15 w(TESTALL\(COUNT,)f(ARRAY)p 770 1196 V 15 w(OF)p
829 1196 V 15 w(REQUESTS,)h(FLAG,)h(ARRAY)p 1303 1196
V 14 w(OF)p 1361 1196 V 16 w(STATUSES,)540 1250 y(IERROR\))336
1303 y(LOGICAL)g(FLAG)336 1357 y(INTEGER)g(COUNT,)f(ARRAY)p
776 1357 V 15 w(OF)p 835 1357 V 15 w(REQUESTS\(*\),)336
1411 y(ARRAY)p 449 1411 V 15 w(OF)p 508 1411 V 15 w(STATUSES\(MPI)p
787 1411 V 13 w(STATUS)p 932 1411 V 15 w(SIZE,*\),)g(IERROR)291
1495 y Fw(MPI)p 368 1495 13 2 v 14 w(TEST)m(ALL)g FA(tests)h(for)e
(completion)f(of)h(all)g(comm)o(unicati)o(ons)e(asso)q(ciated)k(with)e
(re-)249 1549 y(quests)c(in)f(the)g(arra)o(y)m(.)j Fw(MPI)p
693 1549 V 15 w(TEST)m(ALL)d FA(has)g(lo)q(cal)f(completion)f(seman)o
(tics.)291 1603 y(If)k(all)g(op)q(erations)h(ha)o(v)o(e)g(completed,)f
(it)h(returns)h Fw(\015ag)f(=)g(true)p FA(,)i(sets)f(the)f(corresp)q
(onding)249 1657 y(en)o(tries)i(in)e Fw(status)p FA(,)h(deallo)q(cates)
g(all)f(requests)i(and)f(sets)h(all)d(request)k(handles)e(to)f
Fq(MPI)p 1672 1657 12 2 v 13 w(RE-)249 1711 y(QUEST)p
375 1711 V 15 w(NULL)p FA(.)291 1765 y(If)c(all)g(op)q(erations)h(ha)o
(v)o(e)f(not)h(completed,)f Fw(\015ag)h(=)g(false)g FA(is)f(returned,)i
(no)f(request)h(is)f(mo)q(d-)249 1819 y(i\014ed)g(and)g(the)g(v)n
(alues)g(of)f(the)i(status)f(en)o(tries)h(are)g(unde\014ned.)291
1873 y(Errors)g(that)f(o)q(ccurred)i(during)e(the)g(execution)h(of)e
Fw(MPI)p 1192 1873 13 2 v 15 w(TEST)p 1311 1873 V 15
w(ALL)i FA(are)f(handled)g(in)g(the)249 1927 y(same)f(w)o(a)o(y)g(as)h
(errors)h(in)f Fw(MPI)p 732 1927 V 14 w(W)m(AIT)p 850
1927 V 14 w(ALL)p FA(.)249 2022 y Fs(Example)h(2.26)21
b FA(Main)13 b(lo)q(op)g(of)g(Jacobi)h(computation)e(using)i(w)o
(aitall.)249 2076 y Fr(...)249 2130 y(!)22 b(Main)f(loop)249
2184 y(DO)g(WHILE\(.NOT.)f(converged\))314 2238 y(!)i(Compute)e
(boundary)h(columns)314 2292 y(DO)h(i=1,n)380 2346 y(B\(i,1\))e(=)i
(0.25*\(A\(i-1,1\)+A\()o(i+1,1)o(\)+A\(i)o(,0\)+A)o(\(i,2\))o(\))380
2400 y(B\(i,m\))e(=)i(0.25*\(A\(i-1,m\)+A\()o(i+1,m)o(\)+A\(i)o(,m-1\))
o(+A\(i,)o(m+1\))o(\))314 2454 y(END)g(DO)p eop
%%Page: 72 86
72 85 bop 2 223 2 150 v 2 76 150 2 v 1928 76 V 2076 225
2 150 v 249 251 a Fv(72)1275 b(Chapter)13 b(2)314 507
y Fr(!)22 b(Start)f(communication)314 561 y(CALL)g
(MPI_ISEND\(B\(1,1\),)e(n,)i(MPI_REAL,)f(left,)h(tag,)g(comm,)f
(req\(1\),)h(ierr\))314 615 y(CALL)g(MPI_ISEND\(B\(1,m\),)e(n,)i
(MPI_REAL,)f(right,)h(tag,)g(comm,)f(req\(2\),)h(ierr\))314
669 y(CALL)g(MPI_IRECV\(A\(1,0\),)e(n,)i(MPI_REAL,)f(left,)h(tag,)g
(comm,)f(req\(3\),)h(ierr\))314 723 y(CALL)g(MPI_IRECV\(A\(1,m+1\),)d
(n,)k(MPI_REAL,)e(right,)g(tag,)h(comm,)g(req\(4\),)f(ierr\))314
831 y(!)i(Compute)e(interior)314 885 y(DO)i(j=2,m-1)380
939 y(DO)f(i=1,n)445 993 y(B\(i,j\))g(=)g(0.25*\(A\(i-1,j\)+A\(i+)o
(1,j\)+)o(A\(i,j)o(-1\)+A)o(\(i,j)o(+1\)\))380 1047 y(END)g(DO)314
1101 y(END)h(DO)314 1155 y(DO)g(j=1,m)380 1209 y(DO)f(i=1,n)445
1263 y(A\(i,j\))g(=)g(B\(i,j\))380 1317 y(END)g(DO)314
1371 y(END)h(DO)314 1479 y(!)g(Complete)e(communication)314
1533 y(CALL)h(MPI_WAITALL\(4,)e(req,)i(status,)g(ierr\))249
1587 y(...)249 1641 y FA(This)e(co)q(de)h(solv)o(es)f(the)h(same)e
(problem)g(as)h(the)h(co)q(de)g(in)e(Example)g(2.16,)h(page)g(54.)33
b(W)m(e)249 1694 y(replaced)15 b(four)e(calls)g(to)h
Fw(MPI)p 719 1694 13 2 v 14 w(W)m(AIT)f FA(b)o(y)h(one)g(call)e(to)i
Fw(MPI)p 1185 1694 V 14 w(W)m(AIT)m(ALL)p FA(.)f(This)h(sa)o(v)o(es)g
(function)249 1748 y(calls)g(and)f(con)o(text)i(switc)o(hes.)249
1911 y Fw(MPI)p 326 1911 V 14 w(W)m(AITSOME\(incount,)c(a)o(rra)o(y)p
810 1911 V 15 w(of)p 859 1911 V 14 w(requests,)g(outcount,)g(a)o(rra)o
(y)p 1296 1911 V 15 w(of)p 1345 1911 V 15 w(indices,)g(a)o(rra)o(y)p
1582 1911 V 15 w(of)p 1631 1911 V 15 w(statuses\))332
2040 y Fv(IN)158 b Fw(incount)419 b Fv(length)15 b(of)d(arra)o(y)p
1329 2040 12 2 v 15 w(of)p 1375 2040 V 14 w(requests)332
2089 y(INOUT)71 b Fw(a)o(rra)o(y)p 620 2089 13 2 v 15
w(of)p 669 2089 V 14 w(requests)259 b Fv(arra)o(y)14
b(of)e(request)i(handles)332 2138 y(OUT)114 b Fw(outcount)393
b Fv(n)o(um)o(b)q(er)14 b(of)f(completed)h(requests)332
2187 y(OUT)114 b Fw(a)o(rra)o(y)p 620 2187 V 15 w(of)p
669 2187 V 14 w(indices)284 b Fv(arra)o(y)12 b(of)f(indices)j(of)d
(completed)i(op)q(erations)332 2236 y(OUT)114 b Fw(a)o(rra)o(y)p
620 2236 V 15 w(of)p 669 2236 V 14 w(statuses)261 b Fv(arra)o(y)10
b(of)g(status)g(ob)r(jects)g(for)f(completed)i(op-)1079
2290 y(erations)249 2400 y Fr(int)21 b(MPI)p 405 2400
14 2 v 15 w(Waitsome\(int)f(incount,)g(MPI)p 966 2400
V 15 w(Request)g(*array)p 1287 2400 V 15 w(of)p 1346
2400 V 15 w(requests,)540 2454 y(int)h(*outcount,)f(int)h(*array)p
1089 2454 V 14 w(of)p 1147 2454 V 15 w(indices,)540 2508
y(MPI)p 609 2508 V 15 w(Status)f(*array)p 908 2508 V
15 w(of)p 967 2508 V 15 w(statuses\))p eop
%%Page: 73 87
73 86 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(73)249 507 y Fr(MPI)p 318 507 14 2 v 15 w(WAITSOME\(INCOUNT,)18
b(ARRAY)p 835 507 V 15 w(OF)p 894 507 V 15 w(REQUESTS,)i(OUTCOUNT,)g
(ARRAY)p 1455 507 V 15 w(OF)p 1514 507 V 15 w(INDICES,)540
561 y(ARRAY)p 653 561 V 14 w(OF)p 711 561 V 16 w(STATUSES,)g(IERROR\))
336 615 y(INTEGER)h(INCOUNT,)f(ARRAY)p 820 615 V 14 w(OF)p
878 615 V 16 w(REQUESTS\(*\),)f(OUTCOUNT,)336 669 y(ARRAY)p
449 669 V 15 w(OF)p 508 669 V 15 w(INDICES\(*\),)h(ARRAY)p
895 669 V 14 w(OF)p 953 669 V 16 w(STATUSES\(MPI)p 1233
669 V 13 w(STATUS)p 1378 669 V 14 w(SIZE,*\),)g(IERROR)291
753 y Fw(MPI)p 368 753 13 2 v 14 w(W)m(AITSOME)11 b FA(w)o(aits)i(un)o
(til)e(at)i(least)g(one)g(of)f(the)h(comm)o(unications,)c(asso)q
(ciated)14 b(with)249 807 y(requests)19 b(in)e(the)h(arra)o(y)m(,)g
(completes.)28 b Fw(MPI)p 957 807 V 14 w(W)m(AITSOME)16
b FA(returns)j(in)e Fw(outcount)i FA(the)f(n)o(um-)249
861 y(b)q(er)23 b(of)f(completed)g(requests.)46 b(The)22
b(\014rst)i Fw(outcount)f FA(lo)q(cations)f(of)g(the)h(arra)o(y)f
Fw(a)o(rra)o(y)p 1683 861 V 15 w(of-)p 249 915 V 262
915 a(indices)f FA(are)g(set)g(to)f(the)h(indices)f(of)g(these)i(op)q
(erations.)37 b(The)21 b(\014rst)g Fw(outcount)g FA(lo)q(cations)249
969 y(of)15 b(the)h(arra)o(y)f Fw(a)o(rra)o(y)p 568 969
V 16 w(of)p 618 969 V 14 w(statuses)h FA(are)g(set)g(to)g(the)g(status)
g(for)g(these)h(completed)e(op)q(erations.)249 1023 y(Eac)o(h)k
(request)i(that)d(completed)h(is)f(deallo)q(cated,)i(and)f(the)g(asso)q
(ciated)h(handle)e(is)h(set)h(to)249 1077 y Fq(MPI)p
321 1077 12 2 v 13 w(REQUEST)p 506 1077 V 15 w(NULL)p
FA(.)14 b Fw(MPI)p 717 1077 13 2 v 14 w(W)m(AITSOME)f
FA(has)h(non-lo)q(cal)f(completion)f(seman)o(tics.)291
1131 y(If)k(one)g(or)h(more)e(of)h(the)h(comm)o(unicatio)o(ns)d
(completed)i(b)o(y)g Fw(MPI)p 1343 1131 V 15 w(W)m(AITSOME)f
FA(fail)g(then)249 1185 y(the)e(argumen)o(ts)e Fw(outcount)p
FA(,)i Fw(a)o(rra)o(y)p 784 1185 V 15 w(of)p 833 1185
V 14 w(indices)h FA(and)e Fw(a)o(rra)o(y)p 1139 1185
V 15 w(of)p 1188 1185 V 14 w(statuses)h FA(will)d(b)q(e)j(adjusted)f
(to)g(in-)249 1239 y(dicate)f(completion)f(of)g(all)g(comm)o(unicatio)o
(ns)f(that)i(ha)o(v)o(e)g(succeeded)i(or)e(failed.)16
b(The)c(call)e(will)249 1293 y(return)i(the)f(error)h(co)q(de)f
Fq(MPI)p 704 1293 12 2 v 13 w(ERR)p 790 1293 V 13 w(IN)p
841 1293 V 14 w(ST)m(A)m(TUS)g FA(and)g(the)g(error)h(\014eld)e(of)g
(eac)o(h)h(status)h(returned)249 1347 y(will)i(b)q(e)i(set)g(to)f
(indicate)g(success)j(or)d(to)g(indicate)h(the)g(sp)q(eci\014c)g(error)
h(that)e(o)q(ccurred.)24 b(The)249 1401 y(call)11 b(will)f(return)j
Fq(MPI)p 596 1401 V 13 w(SUCCESS)f FA(if)f(it)g(succeeded,)j(and)e
(will)e(return)j(another)f(error)g(co)q(de)h(if)e(it)249
1455 y(failed)j(for)g(for)g(other)i(reasons)f(\(suc)o(h)h(as)e(in)o(v)n
(alid)f(argumen)o(ts\).)20 b Fw(MPI)p 1357 1455 13 2
v 14 w(W)m(AITSOME)13 b FA(up)q(dates)249 1509 y(the)i(status)f
(\014elds)h(of)e(the)h(request)i(ob)r(jects)f(only)e(when)h(it)g
(returns)h Fq(MPI)p 1411 1509 12 2 v 13 w(ERR)p 1497
1509 V 14 w(IN)p 1549 1509 V 13 w(ST)m(A)m(TUS)p FA(.)249
1633 y Fw(MPI)p 326 1633 13 2 v 14 w(TESTSOME\(incount,)d(a)o(rra)o(y)p
811 1633 V 15 w(of)p 860 1633 V 14 w(requests,)g(outcount,)f(a)o(rra)o
(y)p 1298 1633 V 15 w(of)p 1347 1633 V 14 w(indices,)g(a)o(rra)o(y)p
1583 1633 V 15 w(of)p 1632 1633 V 15 w(statuses\))332
1762 y Fv(IN)158 b Fw(incount)419 b Fv(length)15 b(of)d(arra)o(y)p
1329 1762 12 2 v 15 w(of)p 1375 1762 V 14 w(requests)332
1812 y(INOUT)71 b Fw(a)o(rra)o(y)p 620 1812 13 2 v 15
w(of)p 669 1812 V 14 w(requests)259 b Fv(arra)o(y)14
b(of)e(request)i(handles)332 1862 y(OUT)114 b Fw(outcount)393
b Fv(n)o(um)o(b)q(er)14 b(of)f(completed)h(requests)332
1912 y(OUT)114 b Fw(a)o(rra)o(y)p 620 1912 V 15 w(of)p
669 1912 V 14 w(indices)284 b Fv(arra)o(y)12 b(of)f(indices)j(of)d
(completed)i(op)q(erations)332 1961 y(OUT)114 b Fw(a)o(rra)o(y)p
620 1961 V 15 w(of)p 669 1961 V 14 w(statuses)261 b Fv(arra)o(y)10
b(of)g(status)g(ob)r(jects)g(for)f(completed)i(op-)1079
2015 y(erations)249 2126 y Fr(int)21 b(MPI)p 405 2126
14 2 v 15 w(Testsome\(int)f(incount,)g(MPI)p 966 2126
V 15 w(Request)g(*array)p 1287 2126 V 15 w(of)p 1346
2126 V 15 w(requests,)540 2179 y(int)h(*outcount,)f(int)h(*array)p
1089 2179 V 14 w(of)p 1147 2179 V 15 w(indices,)540 2233
y(MPI)p 609 2233 V 15 w(Status)f(*array)p 908 2233 V
15 w(of)p 967 2233 V 15 w(statuses\))249 2317 y(MPI)p
318 2317 V 15 w(TESTSOME\(INCOUNT,)e(ARRAY)p 835 2317
V 15 w(OF)p 894 2317 V 15 w(REQUESTS,)i(OUTCOUNT,)g(ARRAY)p
1455 2317 V 15 w(OF)p 1514 2317 V 15 w(INDICES,)540 2371
y(ARRAY)p 653 2371 V 14 w(OF)p 711 2371 V 16 w(STATUSES,)g(IERROR\))336
2425 y(INTEGER)h(INCOUNT,)f(ARRAY)p 820 2425 V 14 w(OF)p
878 2425 V 16 w(REQUESTS\(*\),)f(OUTCOUNT,)336 2479 y(ARRAY)p
449 2479 V 15 w(OF)p 508 2479 V 15 w(INDICES\(*\),)h(ARRAY)p
895 2479 V 14 w(OF)p 953 2479 V 16 w(STATUSES\(MPI)p
1233 2479 V 13 w(STATUS)p 1378 2479 V 14 w(SIZE,*\),)g(IERROR)p
eop
%%Page: 74 88
74 87 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(74)1275 b(Chapter)13 b(2)291 507
y Fw(MPI)p 368 507 13 2 v 14 w(TESTSOME)j FA(b)q(eha)o(v)o(es)g(lik)o
(e)f Fw(MPI)p 926 507 V 14 w(W)m(AITSOME)p FA(,)f(except)k(that)d(it)h
(returns)h(immedi-)249 561 y(ately)m(.)g(If)c(no)f(op)q(eration)h(has)g
(completed)f(it)h(returns)h Fw(outcount)g(=)g(0)p FA(.)j
Fw(MPI)p 1439 561 V 14 w(TESTSOME)c FA(has)249 615 y(lo)q(cal)g
(completion)f(seman)o(tics.)291 669 y(Errors)18 b(that)f(o)q(ccur)i
(during)e(the)h(execution)g(of)f Fw(MPI)p 1158 669 V
14 w(TESTSOME)g FA(are)h(handled)f(as)h(for)249 723 y
Fw(MPI)p 326 723 V 14 w(W)m(AIT)p 444 723 V 15 w(SOME)p
FA(.)291 777 y(Both)10 b Fw(MPI)p 467 777 V 15 w(W)m(AITSOME)f
FA(and)h Fw(MPI)p 862 777 V 14 w(TESTSOME)h FA(ful\014ll)d(a)i
(fairness)h(requiremen)o(t:)16 b(if)10 b(a)g(re-)249
831 y(quest)g(for)g(a)f(receiv)o(e)i(rep)q(eatedly)f(app)q(ears)h(in)e
(a)g(list)g(of)g(requests)i(passed)g(to)e Fw(MPI)p 1513
831 V 15 w(W)m(AITSOME)249 885 y FA(or)17 b Fw(MPI)p
380 885 V 14 w(TESTSOME)p FA(,)f(and)h(a)g(matc)o(hing)d(send)k(has)f
(b)q(een)h(p)q(osted,)g(then)f(the)h(receiv)o(e)g(will)249
939 y(ev)o(en)o(tually)13 b(complete,)g(unless)i(the)f(send)h(is)f
(satis\014ed)h(b)o(y)e(another)i(receiv)o(e.)k(A)14 b(similar)d(fair-)
249 993 y(ness)k(requiremen)o(t)f(holds)g(for)f(send)i(requests.)249
1088 y Fs(Example)g(2.27)21 b FA(A)14 b(clien)o(t-serv)o(er)h(co)q(de)g
(where)g(starv)n(ation)e(is)h(prev)o(en)o(ted.)249 1142
y Fr(...)249 1196 y(typedef)20 b(struct)h({)293 1250
y(char)g(data[MAXSIZE];)293 1304 y(int)g(datasize;)249
1358 y(})h(Buffer;)249 1412 y(Buffer)f(buffer[];)249
1466 y(MPI_Request)f(req[];)249 1520 y(MPI_Status)g(status[];)249
1574 y(int)h(index[];)249 1628 y(...)249 1736 y(MPI_Comm_rank\(comm)o
(,)e(&rank\);)249 1790 y(MPI_Comm_size\(comm)o(,)g(&size\);)249
1844 y(if\(rank)h(!=)i(size-1\))42 b({)h(/*)22 b(producer)e(code)43
b(*/)314 1898 y(buffer)21 b(=)h(\(Buffer)e(*\)malloc\(sizeof\(B)o
(uffer)o(\)\);)314 1952 y(while\(1\))h({)43 b(/*)21 b(main)g(loop)g(*/)
380 2006 y(produce\()f(buffer->data,)f(&buffer->datasize\))o(;)380
2060 y(MPI_Send\(buffer->)o(data)o(,)g(buffer->datasize,)f(MPI_CHAR,)
1077 2114 y(size-1,)j(tag,)g(comm\);)380 2168 y(})314
2222 y(})249 2276 y(else)g({)h(/*)f(rank)g(==)g(size-1;)g(consumer)f
(code)h(*/)314 2330 y(buffer)g(=)h(\(Buffer)e(*\)malloc\(sizeof\(B)o
(uffer)o(\)*\(si)o(ze-1\))o(\);)314 2384 y(req)i(=)f(\(MPI_Request)f
(*\)malloc\(sizeof)o(\(MPI_)o(Reque)o(st\)*\()o(size)o(-1\)\);)314
2438 y(status)h(=)h(\(MPI_Status)d(*\)malloc\(sizeof\(MP)o(I_Sta)o
(tus\)*)o(\(siz)o(e-1\)\))o(;)314 2492 y(index)i(=)h(\(int)f
(*\)malloc\(sizeof\()o(int\)*)o(\(size)o(-1\)\);)p eop
%%Page: 75 89
75 88 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(75)314 507 y Fr(for\(i=0;)42 b(i<)22 b(size-1;)e(i++\))380
561 y(MPI_Irecv\(buffer[)o(i].d)o(ata,)e(MAXSIZE,)j(MPI_CHAR,)f(i,)h
(tag,)1230 615 y(comm,)g(&req[i]\);)314 669 y(while\(1\))g({)g(/*)h
(main)f(loop)f(*/)380 723 y(MPI_Waitsome\(size)o(-1,)e(req,)j(&count,)g
(index,)f(status\);)380 777 y(for\(i=0;)g(i)i(<)f(count;)g(i++\))g({)
445 831 y(j)h(=)f(index[i];)445 885 y(MPI_Get_count\(&sta)o(tus[i)o(],)
e(MPI_CHAR,)h(&\(buffer[j].data)o(size\))o(\);)445 939
y(consume\(buffer[j].)o(data,)e(buffer[j].datasize\))o(;)445
993 y(MPI_Irecv\(buffer[j)o(].dat)o(a,)h(MAXSIZE,)h(MPI_CHAR,)g(j,)h
(tag,)1295 1047 y(comm,)g(&req[j]\);)445 1101 y(})380
1155 y(})314 1209 y(})249 1263 y FA(This)14 b(co)q(de)g(solv)o(es)g
(the)g(starv)n(ation)f(problem)g(of)g(the)h(co)q(de)g(in)g(Example)e
(2.25,)g(page)h(69.)18 b(W)m(e)249 1317 y(replaced)f(the)g(consumer)g
(call)e(to)h Fw(MPI)p 885 1317 13 2 v 15 w(W)m(AIT)m(ANY)f
FA(b)o(y)h(a)g(call)f(to)h Fw(MPI)p 1404 1317 V 15 w(W)m(AITSOME)p
FA(.)f(This)249 1371 y(ac)o(hiev)o(es)h(t)o(w)o(o)f(goals.)22
b(The)16 b(n)o(um)o(b)q(er)e(of)h(comm)o(unication)d(calls)j(is)g
(reduced,)i(since)g(one)e(call)249 1425 y(no)o(w)c(can)g(complete)f(m)o
(ultiple)e(comm)o(unications.)14 b(Secondly)m(,)d(the)h(consumer)f
(will)e(not)i(starv)o(e)249 1479 y(an)o(y)i(of)h(the)g(consumers,)g
(since)h(it)e(will)g(receiv)o(e)i(an)o(y)e(p)q(osted)i(send.)249
1611 y FB(A)n(dvic)n(e)g(to)g(implementors.)37 b Fw(MPI)p
803 1611 V 14 w(W)m(AITSOME)13 b FA(and)h Fw(MPI)p 1205
1611 V 14 w(TESTSOME)g FA(should)g(complete)249 1665
y(as)c(man)o(y)e(p)q(ending)i(comm)o(unications)d(as)j(p)q(ossible.)17
b(It)10 b(is)g(exp)q(ected)i(that)e(b)q(oth)h(will)d(complete)249
1719 y(all)18 b(receiv)o(e)j(op)q(erations)e(for)g(whic)o(h)g
(information)d(on)j(matc)o(hing)f(sends)i(has)f(reac)o(hed)i(the)249
1773 y(receiv)o(er)c(no)q(de.)24 b(This)15 b(will)f(ensure)k(that)d
(they)h(satisfy)g(their)g(fairness)g(requiremen)o(t.)23
b(\()p FB(End)249 1827 y(of)15 b(advic)n(e)g(to)g(implementors.)p
FA(\))249 1948 y FD(2.10)52 b(Prob)q(e)18 b(and)f(Cancel)249
2056 y Fw(MPI)p 326 2056 V 14 w(PROBE)10 b FA(and)i Fw(MPI)p
642 2056 V 14 w(IPROBE)d FA(allo)o(w)h(p)q(olling)g(of)h(incoming)e
(messages)j(without)f(actually)249 2110 y(receiving)18
b(them.)28 b(The)17 b(application)f(can)i(then)g(decide)h(ho)o(w)e(to)g
(receiv)o(e)i(them,)e(based)h(on)249 2164 y(the)i(information)c
(returned)k(b)o(y)f(the)h(prob)q(e)g(\(in)e(a)h Fw(status)g
FA(v)n(ariable\).)33 b(F)m(or)18 b(example,)h(the)249
2218 y(application)12 b(migh)o(t)e(allo)q(cate)j(memory)d(for)j(the)g
(receiv)o(e)h(bu\013er)g(according)f(to)g(the)g(length)g(of)249
2271 y(the)i(prob)q(ed)f(message.)291 2325 y Fw(MPI)p
368 2325 V 14 w(CANCEL)c FA(allo)o(ws)f(p)q(ending)h(comm)o(unicatio)o
(ns)e(to)i(b)q(e)h(canceled.)18 b(This)10 b(is)h(required)g(for)249
2379 y(clean)o(up)k(in)g(some)f(situations.)22 b(Supp)q(ose)16
b(an)f(application)f(has)h(p)q(osted)h(non)o(blo)q(c)o(king)e(sends)249
2433 y(or)i(receiv)o(es)i(and)e(then)g(determines)h(that)f(these)h(op)q
(erations)f(will)f(not)h(complete.)24 b(P)o(osting)249
2487 y(a)17 b(send)i(or)e(a)g(receiv)o(e)i(ties)f(up)g(application)e
(resources)k(\(send)f(or)e(receiv)o(e)i(bu\013ers\),)g(and)f(a)p
eop
%%Page: 76 90
76 89 bop 2 223 2 150 v 2 76 150 2 v 1928 76 V 2076 225
2 150 v 249 251 a Fv(76)1275 b(Chapter)13 b(2)249 507
y FA(cancel)i(allo)o(ws)d(these)k(resources)g(to)e(b)q(e)g(freed.)249
632 y Fw(MPI)p 326 632 13 2 v 14 w(IPROBE\(source,)f(tag,)g(comm,)f
(\015ag,)h(status\))332 707 y Fv(IN)158 b Fw(source)438
b Fv(rank)14 b(of)f(source)332 757 y(IN)158 b Fw(tag)490
b Fv(message)14 b(tag)332 806 y(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)332 856 y(OUT)114 b Fw(\015ag)483
b Fq(true)13 b Fv(if)g(there)g(is)h(a)f(message)332 906
y(OUT)114 b Fw(status)443 b Fv(status)14 b(ob)r(ject)249
1016 y Fr(int)21 b(MPI)p 405 1016 14 2 v 15 w(Iprobe\(int)f(source,)g
(int)i(tag,)f(MPI)p 1097 1016 V 15 w(Comm)g(comm,)f(int)h(*flag,)540
1070 y(MPI)p 609 1070 V 15 w(Status)f(*status\))249 1154
y(MPI)p 318 1154 V 15 w(IPROBE\(SOURCE,)f(TAG,)i(COMM,)g(FLAG,)g
(STATUS,)f(IERROR\))336 1208 y(LOGICAL)h(FLAG)336 1262
y(INTEGER)g(SOURCE,)f(TAG,)h(COMM,)g(STATUS\(MPI)p 1148
1262 V 13 w(STATUS)p 1293 1262 V 15 w(SIZE\),)f(IERROR)291
1346 y Fw(MPI)p 368 1346 13 2 v 14 w(IPROBE)c FA(is)j(a)g(non)o(blo)q
(c)o(king)e(op)q(eration)i(that)f(returns)j Fw(\015ag)d(=)h(true)h
FA(if)e(there)i(is)f(a)249 1400 y(message)c(that)f(can)h(b)q(e)h
(receiv)o(ed)g(and)f(that)g(matc)o(hes)f(the)h(message)g(en)o(v)o(elop)
q(e)g(sp)q(eci\014ed)i(b)o(y)249 1454 y Fw(source)p FA(,)f
Fw(tag)p FA(,)e(and)h Fw(comm)p FA(.)k(The)c(call)f(matc)o(hes)h(the)g
(same)f(message)h(that)g(w)o(ould)f(ha)o(v)o(e)g(b)q(een)249
1508 y(receiv)o(ed)g(b)o(y)e(a)g(call)f(to)h Fw(MPI)p
696 1508 V 15 w(RECV)f FA(\(with)h(these)i(argumen)o(ts\))d(executed)j
(at)f(the)f(same)g(p)q(oin)o(t)249 1562 y(in)d(the)i(program,)d(and)i
(returns)h(in)e Fw(status)h FA(the)h(same)d(v)n(alue.)16
b(Otherwise,)c(the)e(call)f(returns)j Fw(\015ag)249 1616
y(=)i(false)p FA(,)f(and)h(lea)o(v)o(es)g Fw(status)g
FA(unde\014ned.)19 b Fw(MPI)p 996 1616 V 15 w(IPROBE)12
b FA(has)i(lo)q(cal)f(completion)f(seman)o(tics.)291
1670 y(If)f Fw(MPI)p 407 1670 V 15 w(IPROBE\(source,)g(tag,)g(comm,)f
(\015ag,)i(status\))h FA(returns)g Fw(\015ag)f(=)h(true)p
FA(,)g(then)f(the)h(\014rst,)249 1724 y(subsequen)o(t)20
b(receiv)o(e)g(executed)g(with)e(the)h(comm)o(unicator)d
Fw(comm)p FA(,)h(and)h(with)g(the)h(source)249 1778 y(and)12
b(tag)f(returned)i(in)f Fw(status)p FA(,)g(will)e(receiv)o(e)j(the)f
(message)g(that)g(w)o(as)f(matc)o(hed)g(b)o(y)h(the)g(prob)q(e.)291
1832 y(The)g(argumen)o(t)g Fw(source)h FA(can)g(b)q(e)g
Fq(MPI)p 882 1832 12 2 v 13 w(ANY)p 974 1832 V 13 w(SOURCE)p
FA(,)f(and)h Fw(tag)f FA(can)g(b)q(e)h Fq(MPI)p 1506
1832 V 13 w(ANY)p 1598 1832 V 13 w(T)m(A)o(G)p FA(,)e(so)249
1886 y(that)i(one)f(can)h(prob)q(e)h(for)e(messages)g(from)f(an)h
(arbitrary)h(source)h(and/or)e(with)g(an)h(arbitrary)249
1940 y(tag.)18 b(Ho)o(w)o(ev)o(er,)c(a)f(sp)q(eci\014c)j(comm)o(uni)o
(cator)c(m)o(ust)g(b)q(e)j(pro)o(vided)f(in)f Fw(comm)p
FA(.)291 1994 y(It)f(is)g(not)g(necessary)j(to)d(receiv)o(e)i(a)e
(message)g(imm)o(ediately)e(after)i(it)g(has)h(b)q(een)g(prob)q(ed)g
(for,)249 2048 y(and)h(the)g(same)f(message)h(ma)o(y)e(b)q(e)i(prob)q
(ed)h(for)e(sev)o(eral)i(times)e(b)q(efore)h(it)g(is)g(receiv)o(ed.)249
2172 y Fw(MPI)p 326 2172 13 2 v 14 w(PROBE\(source,)f(tag,)h(comm,)d
(status\))332 2247 y Fv(IN)158 b Fw(source)438 b Fv(rank)14
b(of)f(source)332 2297 y(IN)158 b Fw(tag)490 b Fv(message)14
b(tag)332 2347 y(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)332
2397 y(OUT)114 b Fw(status)443 b Fv(status)14 b(ob)r(ject)249
2507 y Fr(int)21 b(MPI)p 405 2507 14 2 v 15 w(Probe\(int)f(source,)h
(int)g(tag,)g(MPI)p 1075 2507 V 15 w(Comm)g(comm,)g(MPI)p
1396 2507 V 15 w(Status)f(*status\))p eop
%%Page: 77 91
77 90 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(77)249 507 y Fr(MPI)p 318 507 14 2 v 15 w(PROBE\(SOURCE,)19
b(TAG,)i(COMM,)g(STATUS,)f(IERROR\))336 561 y(INTEGER)h(SOURCE,)f(TAG,)
h(COMM,)g(STATUS\(MPI)p 1148 561 V 13 w(STATUS)p 1293
561 V 15 w(SIZE\),)f(IERROR)291 645 y Fw(MPI)p 368 645
13 2 v 14 w(PROBE)c FA(b)q(eha)o(v)o(es)j(lik)o(e)f Fw(MPI)p
851 645 V 14 w(IPROBE)e FA(except)j(that)g(it)e(blo)q(c)o(ks)i(and)f
(returns)h(only)249 699 y(after)d(a)g(matc)o(hing)e(message)i(has)g(b)q
(een)h(found.)24 b Fw(MPI)p 1123 699 V 15 w(PROBE)14
b FA(has)i(non-lo)q(cal)f(completion)249 753 y(seman)o(tics.)291
807 y(The)e(seman)o(tics)f(of)f Fw(MPI)p 684 807 V 15
w(PROBE)g FA(and)h Fw(MPI)p 1002 807 V 14 w(IPROBE)f
FA(guaran)o(tee)i(progress,)g(in)f(the)h(same)249 861
y(w)o(a)o(y)e(as)i(a)e(corresp)q(onding)j(receiv)o(e)f(executed)h(at)e
(the)h(same)e(p)q(oin)o(t)g(in)h(the)h(program.)j(If)11
b(a)h(call)249 915 y(to)f Fw(MPI)p 374 915 V 14 w(PROBE)e
FA(has)i(b)q(een)g(issued)h(b)o(y)e(a)h(pro)q(cess,)h(and)f(a)f(send)i
(that)e(matc)o(hes)h(the)g(prob)q(e)g(has)249 969 y(b)q(een)j
(initiated)d(b)o(y)i(some)e(pro)q(cess,)j(then)g(the)f(call)e(to)i
Fw(MPI)p 1189 969 V 14 w(PROBE)e FA(will)g(return,)i(unless)h(the)249
1023 y(message)h(is)f(receiv)o(ed)i(b)o(y)f(another,)g(concurren)o(t)h
(receiv)o(e)h(op)q(eration,)d(irresp)q(ectiv)o(e)j(of)d(other)249
1077 y(activities)h(in)g(the)i(system.)23 b(Similarl)o(y)m(,)12
b(if)j(a)g(pro)q(cess)j(busy)e(w)o(aits)f(with)g Fw(MPI)p
1501 1077 V 14 w(IPROBE)f FA(and)249 1131 y(a)g(matc)o(hing)f(message)h
(has)g(b)q(een)i(issued,)f(then)g(the)g(call)e(to)i Fw(MPI)p
1306 1131 V 14 w(IPROBE)d FA(will)h(ev)o(en)o(tually)249
1185 y(return)21 b Fw(\015ag)e(=)h(true)h FA(unless)f(the)g(message)f
(is)h(receiv)o(ed)h(b)o(y)e(another)h(concurren)o(t)h(receiv)o(e)249
1239 y(op)q(eration,)13 b(irresp)q(ectiv)o(e)j(of)d(other)i(activities)
e(in)h(the)g(system.)249 1334 y Fs(Example)h(2.28)21
b FA(Use)15 b(a)e(blo)q(c)o(king)g(prob)q(e)i(to)e(w)o(ait)g(for)h(an)g
(incoming)d(message.)402 1388 y Fr(CALL)21 b(MPI_COMM_RANK\(c)o(omm,)d
(rank,)j(ierr\))402 1442 y(IF)g(\(rank.EQ.0\))f(THEN)511
1496 y(CALL)h(MPI_SEND\(i,)e(1,)i(MPI_INTEGER,)f(2,)h(0,)h(comm,)e
(ierr\))402 1550 y(ELSE)h(IF)g(\(rank.EQ.1\))e(THEN)511
1604 y(CALL)i(MPI_SEND\(x,)e(1,)i(MPI_REAL,)f(2,)i(0,)f(comm,)g(ierr\))
402 1658 y(ELSE)g(IF)g(\(rank.EQ.2\))e(THEN)489 1712
y(DO)i(i=1,)g(2)554 1766 y(CALL)g(MPI_PROBE\(MPI_ANY_)o(SOURC)o(E,)e
(0,)903 1820 y(comm,)i(status,)f(ierr\))554 1874 y(IF)i
(\(status\(MPI_SOU)o(RCE\))c(=)k(0\))f(THEN)249 1928
y(100)348 b(CALL)21 b(MPI_RECV\(i,)f(1,)h(MPI_INTEGER,)e(0,)j(0,)f
(comm,)358 1982 y($)349 b(status,)20 b(ierr\))554 2036
y(ELSE)249 2090 y(200)348 b(CALL)21 b(MPI_RECV\(x,)f(1,)h(MPI_REAL,)f
(1,)h(0,)h(comm,)358 2144 y($)349 b(status,)20 b(ierr\))554
2198 y(END)h(IF)489 2252 y(END)g(DO)402 2306 y(END)g(IF)249
2414 y FA(Eac)o(h)14 b(message)g(is)g(receiv)o(ed)h(with)e(the)i(righ)o
(t)e(t)o(yp)q(e.)p eop
%%Page: 78 92
78 91 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(78)1275 b(Chapter)13 b(2)249 507
y Fs(Example)i(2.29)21 b FA(A)14 b(similar)d(program)h(to)i(the)h
(previous)f(example,)e(but)i(with)g(a)f(problem.)402
561 y Fr(CALL)21 b(MPI_COMM_RANK\(c)o(omm,)d(rank,)j(ierr\))402
615 y(IF)g(\(rank.EQ.0\))f(THEN)511 669 y(CALL)h(MPI_SEND\(i,)e(1,)i
(MPI_INTEGER,)f(2,)h(0,)h(comm,)e(ierr\))402 723 y(ELSE)h(IF)g
(\(rank.EQ.1\))e(THEN)511 777 y(CALL)i(MPI_SEND\(x,)e(1,)i(MPI_REAL,)f
(2,)i(0,)f(comm,)g(ierr\))402 831 y(ELSE)g(IF)g(\(rank.EQ.2\))e(THEN)
489 885 y(DO)i(i=1,)g(2)554 939 y(CALL)g(MPI_PROBE\(MPI_ANY_)o(SOURC)o
(E,)e(0,)903 993 y(comm,)i(status,)f(ierr\))554 1047
y(IF)i(\(status\(MPI_SOU)o(RCE\))c(=)k(0\))f(THEN)249
1101 y(100)348 b(CALL)21 b(MPI_RECV\(i,)f(1,)h(MPI_INTEGER,)e
(MPI_ANY_SOURCE,)968 1155 y(0,)j(comm,)e(status,)h(ierr\))554
1209 y(ELSE)249 1263 y(200)348 b(CALL)21 b(MPI_RECV\(x,)f(1,)h
(MPI_REAL,)f(MPI_ANY_SOURCE,)968 1317 y(0,)i(comm,)e(status,)h(ierr\))
554 1371 y(END)g(IF)489 1425 y(END)g(DO)402 1479 y(END)g(IF)249
1587 y FA(W)m(e)12 b(sligh)o(tly)f(mo)q(di\014ed)f(example)h(2.28,)g
(using)h Fq(MPI)p 1068 1587 12 2 v 12 w(ANY)p 1159 1587
V 14 w(SOURCE)g FA(as)h(the)f Fw(source)i FA(argumen)o(t)249
1641 y(in)h(the)h(t)o(w)o(o)e(receiv)o(e)j(calls)e(in)f(statemen)o(ts)i
(lab)q(eled)f(100)f(and)h(200.)21 b(The)16 b(program)d(no)o(w)i(has)249
1694 y(di\013eren)o(t)d(b)q(eha)o(vior:)k(the)c(receiv)o(e)g(op)q
(eration)e(ma)o(y)f(receiv)o(e)j(a)f(message)g(that)f(is)h(distinct)g
(from)249 1748 y(the)k(message)e(prob)q(ed.)249 1844
y FB(A)n(dvic)n(e)18 b(to)h(implementors.)59 b FA(A)18
b(call)f(to)h Fw(MPI)p 1016 1844 13 2 v 14 w(PROBE\(source,)g(tag,)g
(comm,)f(status\))h FA(will)249 1898 y(matc)o(h)10 b(the)h(message)g
(that)g(w)o(ould)f(ha)o(v)o(e)h(b)q(een)h(receiv)o(ed)g(b)o(y)f(a)g
(call)f(to)h Fw(MPI)p 1431 1898 V 14 w(RECV\(...,)e(source,)249
1952 y(tag,)19 b(comm,)f(status\))i FA(executed)g(at)f(the)h(same)e(p)q
(oin)o(t.)33 b(Supp)q(ose)20 b(that)f(this)g(message)f(has)249
2006 y(source)c Fw(s)p FA(,)e(tag)f Fw(t)i FA(and)f(comm)o(unicator)d
Fw(c)p FA(.)18 b(If)12 b(the)h(tag)f(argumen)o(t)f(in)g(the)i(prob)q(e)
g(call)f(has)g(v)n(alue)249 2060 y Fq(MPI)p 321 2060
12 2 v 13 w(ANY)p 413 2060 V 13 w(T)m(A)o(G)i FA(then)i(the)g(message)f
(prob)q(ed)h(will)e(b)q(e)i(the)g(earliest)g(p)q(ending)f(message)g
(from)249 2114 y(source)j Fw(s)e FA(with)g(comm)o(unicator)d
Fw(c)k FA(and)f(an)o(y)g(tag;)h(in)f(an)o(y)f(case,)j(the)f(message)f
(prob)q(ed)h(will)249 2168 y(b)q(e)d(the)f(earliest)h(p)q(ending)f
(message)g(from)e(source)j Fw(s)f FA(with)g(tag)g Fw(t)g
FA(and)g(comm)o(uni)o(cator)e Fw(c)i FA(\(this)249 2222
y(is)18 b(the)g(message)f(that)h(w)o(ould)f(ha)o(v)o(e)g(b)q(een)i
(receiv)o(ed,)g(so)f(as)g(to)f(preserv)o(e)j(message)d(order\).)249
2276 y(This)g(message)f(con)o(tin)o(ues)i(as)f(the)g(earliest)g(p)q
(ending)g(message)g(from)e(source)j Fw(s)f FA(with)f(tag)g
Fw(t)249 2330 y FA(and)i(comm)o(uni)o(cator)d Fw(c)p
FA(,)k(un)o(til)e(it)g(is)h(receiv)o(ed.)31 b(The)18
b(\014rst)g(receiv)o(e)h(op)q(eration)f(subsequen)o(t)249
2384 y(to)d(the)g(prob)q(e)h(that)e(uses)i(the)g(same)e(comm)o(uni)o
(cator)f(as)h(the)i(prob)q(e)f(and)g(uses)h(the)f(tag)g(and)249
2438 y(source)h(v)n(alues)e(returned)i(b)o(y)f(the)g(prob)q(e,)g(m)o
(ust)e(receiv)o(e)j(this)e(message.)20 b(\()p FB(End)c(of)g(advic)n(e)f
(to)249 2492 y(implementors.)p FA(\))p eop
%%Page: 79 93
79 92 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(79)249 507 y Fw(MPI)p 326 507 13 2 v 14 w(CANCEL\(request\))332
582 y Fv(IN)158 b Fw(request)423 b Fv(request)14 b(handle)249
692 y Fr(int)21 b(MPI)p 405 692 14 2 v 15 w(Cancel\(MPI)p
640 692 V 14 w(Request)f(*request\))249 776 y(MPI)p 318
776 V 15 w(CANCEL\(REQUEST,)f(IERROR\))336 830 y(INTEGER)i(REQUEST,)f
(IERROR)291 914 y Fw(MPI)p 368 914 13 2 v 14 w(CANCEL)14
b FA(marks)f(for)i(cancelation)f(a)h(p)q(ending,)f(non)o(blo)q(c)o
(king)g(comm)o(uni)o(cation)e(op-)249 968 y(eration)i(\(send)h(or)e
(receiv)o(e\).)20 b Fw(MPI)p 797 968 V 14 w(CANCEL)13
b FA(has)h(lo)q(cal)f(completion)f(seman)o(tics.)18 b(It)c(returns)249
1022 y(immediately)l(,)g(p)q(ossibly)j(b)q(efore)h(the)g(comm)o
(unicatio)o(n)c(is)j(actually)f(canceled.)29 b(After)18
b(this,)249 1076 y(it)c(is)h(still)f(necessary)i(to)f(complete)f(a)g
(comm)o(unication)d(that)k(has)g(b)q(een)h(mark)o(ed)d(for)h(cance-)249
1130 y(lation,)h(using)g(a)h(call)f(to)g Fw(MPI)p 735
1130 V 15 w(REQUEST)p 938 1130 V 13 w(FREE)p FA(,)g Fw(MPI)p
1154 1130 V 14 w(W)m(AIT)p FA(,)f Fw(MPI)p 1373 1130
V 15 w(TEST)i FA(or)g(one)g(of)f(the)249 1184 y(functions)i(in)g
(Section)h(2.9.)26 b(If)17 b(the)h(comm)o(unication)c(w)o(as)j(not)g
(cancelled)h(\(that)f(is,)g(if)g(the)249 1238 y(comm)o(unication)7
b(happ)q(ened)12 b(to)e(start)h(b)q(efore)h(the)f(cancelation)f(could)g
(tak)o(e)h(e\013ect\),)i(then)e(the)249 1292 y(completion)j(call)g
(will)g(complete)g(the)i(comm)o(unicatio)o(n,)c(as)k(usual.)21
b(If)15 b(the)h(comm)o(unicatio)o(n)249 1346 y(w)o(as)e(successfully)h
(cancelled,)g(then)f(the)h(completion)d(call)i(will)e(deallo)q(cate)i
(the)h(request)h(ob-)249 1400 y(ject)c(and)g(will)e(return)j(in)e
Fw(status)g FA(the)i(information)8 b(that)k(the)g(comm)o(unication)c(w)
o(as)k(canceled.)249 1454 y(The)h(application)e(should)i(then)g(call)f
Fw(MPI)p 922 1454 V 14 w(TEST)p 1040 1454 V 16 w(CANCELLED)p
FA(,)f(using)i Fw(status)g FA(as)f(input,)h(to)249 1508
y(test)i(whether)g(the)g(comm)o(unicatio)o(n)c(w)o(as)j(actually)f
(canceled.)291 1562 y(Either)j(the)h(cancelation)f(succeeds,)j(and)e
(no)f(comm)o(unicati)o(on)d(o)q(ccurs,)18 b(or)e(the)h(comm)o(u-)249
1616 y(nication)e(completes,)g(and)g(the)h(cancelation)f(fails.)22
b(If)15 b(a)g(send)h(is)g(mark)o(ed)e(for)h(cancelation,)249
1670 y(then)f(it)f(m)o(ust)g(b)q(e)h(the)g(case)g(that)g(either)g(the)g
(send)g(completes)f(normally)m(,)d(and)k(the)g(message)249
1724 y(sen)o(t)f(is)f(receiv)o(ed)i(at)e(the)h(destination)f(pro)q
(cess,)i(or)e(that)g(the)h(send)g(is)f(successfully)i(canceled,)249
1777 y(and)f(no)f(part)h(of)f(the)h(message)g(is)f(receiv)o(ed)j(at)d
(the)h(destination.)18 b(If)12 b(a)h(receiv)o(e)h(is)e(mark)o(ed)g(for)
249 1831 y(cancelation,)g(then)i(it)e(m)o(ust)g(b)q(e)h(the)g(case)h
(that)f(either)g(the)h(receiv)o(e)g(completes)e(normally)m(,)d(or)249
1885 y(that)j(the)h(receiv)o(e)g(is)f(successfully)i(canceled,)f(and)f
(no)f(part)i(of)e(the)i(receiv)o(e)g(bu\013er)g(is)f(altered.)291
1939 y(If)17 b(a)h(comm)o(unicati)o(on)d(is)j(mark)o(ed)f(for)g
(cancelation,)h(then)h(a)f(completion)e(call)h(for)g(that)249
1993 y(comm)o(unication)12 b(is)j(guaran)o(teed)h(to)f(return,)h
(irresp)q(ectiv)o(e)h(of)d(the)i(activities)f(of)g(other)h(pro-)249
2047 y(cesses.)k(In)13 b(this)g(case,)g Fw(MPI)p 689
2047 V 14 w(W)m(AIT)f FA(b)q(eha)o(v)o(es)i(as)f(a)f(lo)q(cal)g
(function.)17 b(Similarly)l(,)10 b(if)i Fw(MPI)p 1627
2047 V 14 w(TEST)249 2101 y FA(is)j(rep)q(eatedly)i(called)e(in)g(a)g
(busy)h(w)o(ait)f(lo)q(op)f(for)h(a)h(canceled)g(comm)o(unication,)c
(then)k Fw(MPI-)p 249 2155 V 262 2155 a(TEST)e FA(will)e(ev)o(en)o
(tually)h(succeed.)p eop
%%Page: 80 94
80 93 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(80)1275 b(Chapter)13 b(2)249 507
y Fw(MPI)p 326 507 13 2 v 14 w(TEST)p 444 507 V 16 w
(CANCELLED\(status,)g(\015ag\))332 582 y Fv(IN)158 b
Fw(status)443 b Fv(status)14 b(ob)r(ject)332 632 y(OUT)114
b Fw(\015ag)483 b Fq(true)13 b Fv(if)g(canceled)249 742
y Fr(int)21 b(MPI)p 405 742 14 2 v 15 w(Test)p 508 742
V 15 w(cancelled\(MPI)p 809 742 V 13 w(Status)g(*status,)f(int)h
(*flag\))249 826 y(MPI)p 318 826 V 15 w(TEST)p 421 826
V 15 w(CANCELLED\(STATUS,)d(FLAG,)j(IERROR\))336 880
y(LOGICAL)g(FLAG)336 934 y(INTEGER)g(STATUS\(MPI)p 734
934 V 13 w(STATUS)p 879 934 V 15 w(SIZE\),)f(IERROR)291
1018 y Fw(MPI)p 368 1018 13 2 v 14 w(TEST)p 486 1018
V 15 w(CANCELLED)e FA(is)g(used)i(to)e(test)h(whether)h(the)f(comm)o
(unicati)o(on)d(op)q(eration)249 1072 y(w)o(as)c(actually)g(canceled)h
(b)o(y)f Fw(MPI)p 781 1072 V 15 w(CANCEL)p FA(.)f(It)h(returns)i
Fw(\015ag)e(=)h(true)g FA(if)f(the)h(comm)o(unicatio)o(n)249
1126 y(asso)q(ciated)j(with)f(the)g(status)h(ob)r(ject)g(w)o(as)f
(canceled)h(successfully)m(.)23 b(In)15 b(this)g(case,)h(all)e(other)
249 1180 y(\014elds)g(of)g Fw(status)g FA(are)g(unde\014ned.)19
b(It)14 b(returns)i Fw(\015ag)d(=)i(false)p FA(,)e(otherwise.)249
1275 y Fs(Example)i(2.30)21 b FA(Co)q(de)14 b(using)g
Fw(MPI)p 845 1275 V 14 w(CANCEL)249 1329 y Fr(MPI_Comm_rank\(comm)o(,)
19 b(&rank\);)249 1383 y(if)i(\(rank)g(==)h(0\))314 1437
y(MPI_Send\(a,)e(1,)h(MPI_CHAR,)f(1,)i(tag,)f(comm\);)249
1491 y(else)g(if)g(\(rank==1\))f({)314 1545 y(MPI_Irecv\(a,)g(1,)h
(MPI_CHAR,)f(0,)h(tag,)g(comm,)g(&req\);)314 1599 y
(MPI_Cancel\(&req\);)314 1653 y(MPI_Wait\(&req,)e(&status\);)314
1707 y(MPI_Test_cancelled\(&)o(stat)o(us,)g(&flag\);)314
1761 y(if)j(\(flag\))e(/*)i(cancel)e(succeeded)g(--)i(need)f(to)g(post)
g(new)g(receive)f(*/)380 1815 y(MPI_Recv\(a,)f(1,)j(MPI_CHAR,)e(0,)h
(tag,)g(comm,)g(&req\);)314 1869 y(})249 1964 y FB(A)n(dvic)n(e)14
b(to)f(users.)36 b Fw(MPI)p 648 1964 V 14 w(CANCEL)13
b FA(can)g(b)q(e)g(an)f(exp)q(ensiv)o(e)i(op)q(eration)f(that)g(should)
f(b)q(e)i(used)249 2018 y(only)f(exceptionally)m(.)k(\()p
FB(End)f(of)f(advic)n(e)g(to)g(users.)p FA(\))249 2110
y FB(A)n(dvic)n(e)d(to)h(implementors.)34 b FA(A)12 b(comm)o(unicatio)o
(n)d(op)q(eration)i(cannot)h(b)q(e)g(cancelled)g(once)g(the)249
2164 y(receiv)o(e)19 b(bu\013er)f(has)g(b)q(een)g(partly)f(o)o(v)o
(erwritten.)29 b(In)17 b(this)h(situation,)f(the)h(comm)o(unicatio)o(n)
249 2217 y(should)g(b)q(e)g(allo)o(w)o(ed)e(to)i(complete.)29
b(In)18 b(general,)g(a)g(comm)o(unicati)o(on)d(ma)o(y)h(b)q(e)i(allo)o
(w)o(ed)f(to)249 2271 y(complete,)j(if)e(send)i(and)f(receiv)o(e)i(ha)o
(v)o(e)e(already)g(b)q(een)i(matc)o(hed.)33 b(The)20
b(implemen)o(tatio)o(n)249 2325 y(should)14 b(tak)o(e)g(care)g(of)g
(the)g(p)q(ossible)g(race)h(b)q(et)o(w)o(een)g(cancelation)f(and)g
(matc)o(hing.)249 2396 y(The)f(cancelation)f(of)g(a)g(send)h(op)q
(eration)f(will)f(in)o(ternally)h(require)h(comm)o(unicatio)o(n)d(with)
i(the)249 2450 y(in)o(tended)i(receiv)o(er,)g(if)e(information)e(on)j
(the)g(send)h(op)q(eration)f(has)g(already)f(b)q(een)i(forw)o(arded)249
2504 y(to)h(the)h(destination.)21 b(Note)16 b(that,)f(while)f(comm)o
(unication)e(ma)o(y)h(b)q(e)j(needed)g(to)f(implemen)o(t)p
eop
%%Page: 81 95
81 94 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(81)249 507 y Fw(MPI)p 326 507 13 2 v 14 w(CANCEL)p
FA(,)10 b(this)h(is)g(still)f(a)g(lo)q(cal)g(op)q(eration,)h(since)h
(its)f(completion)e(do)q(es)j(not)f(dep)q(end)h(on)249
561 y(the)g(application)f(co)q(de)i(executed)g(b)o(y)f(other)g(pro)q
(cesses.)20 b(\()p FB(End)14 b(of)f(advic)n(e)g(to)g(implementors.)p
FA(\))249 682 y FD(2.11)52 b(P)o(ersisten)o(t)16 b(Comm)o(unication)j
(Requests)249 790 y FA(Often)14 b(a)g(comm)o(uni)o(cation)d(with)i(the)
h(same)f(argumen)o(t)f(list)h(is)h(rep)q(eatedly)h(executed)g(within)
249 844 y(the)i(inner)g(lo)q(op)f(of)g(a)g(parallel)f(computation.)24
b(In)17 b(suc)o(h)g(a)f(situation,)g(it)g(ma)o(y)f(b)q(e)i(p)q(ossible)
249 897 y(to)c(optimize)e(the)j(comm)o(unicatio)o(n)d(b)o(y)h(binding)g
(the)i(list)e(of)h(comm)o(unicatio)o(n)d(argumen)o(ts)j(to)249
951 y(a)h Fs(p)q(ersisten)o(t)d FA(comm)o(unicatio)o(n)h(request)k
(once)f(and)f(then,)g(rep)q(eatedly)m(,)h(using)f(the)h(request)249
1005 y(to)j(initiate)g(and)g(complete)f(messages.)32
b(A)18 b(p)q(ersisten)o(t)i(request)g(can)f(b)q(e)g(though)o(t)f(of)f
(as)i(a)249 1059 y(comm)o(unication)7 b(p)q(ort)j(or)g(a)g(\\half-c)o
(hannel.")15 b(It)10 b(do)q(es)h(not)f(pro)o(vide)g(the)h(full)e
(functionalit)o(y)f(of)249 1113 y(a)i(con)o(v)o(en)o(tional)f(c)o
(hannel,)i(since)g(there)h(is)e(no)h(binding)e(of)h(the)h(send)g(p)q
(ort)g(to)f(the)h(receiv)o(e)h(p)q(ort.)249 1167 y(This)18
b(construct)i(allo)o(ws)d(reduction)j(of)d(the)i(o)o(v)o(erhead)g(for)f
(comm)o(unication)d(b)q(et)o(w)o(een)20 b(the)249 1221
y(pro)q(cess)c(and)e(comm)o(uni)o(cation)d(con)o(troller,)i(but)h(not)g
(of)g(the)g(o)o(v)o(erhead)g(for)g(comm)o(unicatio)o(n)249
1275 y(b)q(et)o(w)o(een)h(one)f(comm)o(unication)d(con)o(troller)j(and)
f(another.)291 1329 y(It)g(is)h(not)g(necessary)i(that)d(messages)h
(sen)o(t)h(with)e(a)h(p)q(ersisten)o(t)h(request)h(b)q(e)e(receiv)o(ed)
h(b)o(y)f(a)249 1383 y(receiv)o(e)j(op)q(eration)e(using)g(a)g(p)q
(ersisten)o(t)i(request,)f(or)g(vice-v)o(ersa.)23 b(P)o(ersisten)o(t)17
b(comm)o(uni)o(ca-)249 1437 y(tion)c(requests)j(are)f(asso)q(ciated)f
(with)g(non)o(blo)q(c)o(king)e(send)j(and)f(receiv)o(e)h(op)q
(erations.)291 1491 y(A)21 b(p)q(ersisten)o(t)i(comm)o(unicati)o(on)18
b(request)23 b(is)e(created)i(using)e(the)g(follo)o(wing)e(functions.)
249 1545 y(They)14 b(in)o(v)o(olv)o(e)f(no)g(comm)o(unication)e(and)j
(th)o(us)g(ha)o(v)o(e)g(lo)q(cal)f(completion)f(seman)o(tics.)249
1670 y Fw(MPI)p 326 1670 V 14 w(SEND)p 447 1670 V 16
w(INIT\(buf,)h(count,)i(datat)o(yp)q(e,)g(dest,)f(tag,)f(comm,)e
(request\))332 1745 y Fv(IN)158 b Fw(buf)491 b Fv(initial)16
b(address)e(of)f(send)h(bu\013er)332 1794 y(IN)158 b
Fw(count)450 b Fv(n)o(um)o(b)q(er)14 b(of)f(en)o(tries)h(to)f(send)332
1844 y(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14
b(of)f(eac)o(h)g(en)o(try)332 1894 y(IN)158 b Fw(dest)476
b Fv(rank)14 b(of)f(destination)332 1944 y(IN)158 b Fw(tag)490
b Fv(message)14 b(tag)332 1994 y(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)332 2043 y(OUT)114 b Fw(request)423
b Fv(request)14 b(handle)249 2154 y Fr(int)21 b(MPI)p
405 2154 14 2 v 15 w(Send)p 508 2154 V 15 w(init\(void*)f(buf,)h(int)g
(count,)g(MPI)p 1178 2154 V 15 w(Datatype)f(datatype,)540
2208 y(int)h(dest,)g(int)g(tag,)g(MPI)p 1023 2208 V 15
w(Comm)g(comm,)g(MPI)p 1344 2208 V 15 w(Request)f(*request\))249
2292 y(MPI)p 318 2292 V 15 w(SEND)p 421 2292 V 15 w(INIT\(BUF,)g
(COUNT,)g(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(REQUEST,)f(IERROR\))336
2346 y(<type>)h(BUF\(*\))336 2399 y(INTEGER)g(REQUEST,)f(COUNT,)g
(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(REQUEST,)336 2453
y(IERROR)p eop
%%Page: 82 96
82 95 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(82)1275 b(Chapter)13 b(2)291 507
y Fw(MPI)p 368 507 13 2 v 14 w(SEND)p 489 507 V 15 w(INIT)d
FA(creates)i(a)d(p)q(ersisten)o(t)j(comm)o(unication)7
b(request)k(for)f(a)g(standard-mo)q(de,)249 561 y(non)o(blo)q(c)o(king)
i(send)j(op)q(eration,)e(and)g(binds)h(to)g(it)f(all)f(the)i(argumen)o
(ts)f(of)g(a)h(send)g(op)q(eration.)249 686 y Fw(MPI)p
326 686 V 14 w(RECV)p 447 686 V 14 w(INIT\(buf,)g(count,)g(datat)o(yp)q
(e,)h(source,)g(tag,)e(comm,)e(request\))332 761 y Fv(OUT)114
b Fw(buf)491 b Fv(initial)16 b(address)e(of)f(receiv)o(e)h(bu\013er)332
811 y(IN)158 b Fw(count)450 b Fv(max)14 b(n)o(um)o(b)q(er)f(of)g(en)o
(tries)h(to)f(receiv)o(e)332 860 y(IN)158 b Fw(datat)o(yp)q(e)397
b Fv(datat)o(yp)q(e)14 b(of)f(eac)o(h)g(en)o(try)332
910 y(IN)158 b Fw(source)438 b Fv(rank)14 b(of)f(source)332
960 y(IN)158 b Fw(tag)490 b Fv(message)14 b(tag)332 1010
y(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)332 1060
y(OUT)114 b Fw(request)423 b Fv(request)14 b(handle)249
1170 y Fr(int)21 b(MPI)p 405 1170 14 2 v 15 w(Recv)p
508 1170 V 15 w(init\(void*)f(buf,)h(int)g(count,)g(MPI)p
1178 1170 V 15 w(Datatype)f(datatype,)540 1224 y(int)h(source,)f(int)h
(tag,)g(MPI)p 1066 1224 V 15 w(Comm)g(comm,)540 1278
y(MPI)p 609 1278 V 15 w(Request)f(*request\))249 1362
y(MPI)p 318 1362 V 15 w(RECV)p 421 1362 V 15 w(INIT\(BUF,)g(COUNT,)g
(DATATYPE,)g(SOURCE,)h(TAG,)g(COMM,)f(REQUEST,)540 1416
y(IERROR\))336 1470 y(<type>)h(BUF\(*\))336 1524 y(INTEGER)g(COUNT,)f
(DATATYPE,)g(SOURCE,)g(TAG,)h(COMM,)g(REQUEST,)f(IERROR)291
1608 y Fw(MPI)p 368 1608 13 2 v 14 w(RECV)p 489 1608
V 14 w(INIT)e FA(creates)i(a)e(p)q(ersisten)o(t)i(comm)o(unication)15
b(request)20 b(for)f(a)f(non)o(blo)q(c)o(king)249 1662
y(receiv)o(e)h(op)q(eration.)29 b(The)18 b(argumen)o(t)f
Fw(buf)h FA(is)f(mark)o(ed)g(as)g Fw(OUT)g FA(b)q(ecause)j(the)e
(application)249 1716 y(giv)o(es)c(p)q(ermission)f(to)g(write)i(on)e
(the)i(receiv)o(e)g(bu\013er.)291 1769 y(P)o(ersisten)o(t)j(comm)o
(unication)13 b(requests)19 b(are)e(created)h(b)o(y)f(the)g(preceding)h
(functions,)f(but)249 1823 y(they)g(are,)f(so)h(far,)f(inactiv)o(e.)24
b(They)17 b(are)f(activ)n(ated,)g(and)g(the)h(asso)q(ciated)g(comm)o
(unicatio)o(n)249 1877 y(op)q(erations)d(started,)h(b)o(y)e
Fw(MPI)p 738 1877 V 15 w(ST)m(ART)g FA(or)h Fw(MPI)p
1023 1877 V 14 w(ST)m(ART)m(ALL)p FA(.)249 2002 y Fw(MPI)p
326 2002 V 14 w(ST)m(ART\(request\))332 2077 y Fv(INOUT)71
b Fw(request)423 b Fv(request)14 b(handle)249 2187 y
Fr(int)21 b(MPI)p 405 2187 14 2 v 15 w(Start\(MPI)p 618
2187 V 14 w(Request)f(*request\))249 2271 y(MPI)p 318
2271 V 15 w(START\(REQUEST,)f(IERROR\))336 2325 y(INTEGER)i(REQUEST,)f
(IERROR)291 2409 y Fw(MPI)p 368 2409 13 2 v 14 w(ST)m(ART)13
b FA(activ)n(ates)h Fw(request)i FA(and)d(initiates)h(the)g(asso)q
(ciated)g(comm)o(unication.)h(Since)249 2463 y(all)8
b(p)q(ersisten)o(t)j(requests)g(are)f(asso)q(ciated)g(with)f(non)o(blo)
q(c)o(king)f(comm)o(unications,)f Fw(MPI)p 1608 2463
V 14 w(ST)m(ART)p eop
%%Page: 83 97
83 96 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(83)249 507 y FA(has)15 b(lo)q(cal)f(completion)f(seman)o(tics.)21
b(The)15 b(seman)o(tics)g(of)f(comm)o(unications)e(done)j(with)g(p)q
(er-)249 561 y(sisten)o(t)20 b(requests)h(are)e(iden)o(tical)f(to)h
(the)g(corresp)q(onding)h(op)q(erations)f(without)g(p)q(ersisten)o(t)
249 615 y(requests.)h(That)13 b(is,)g(a)h(call)e(to)i
Fw(MPI)p 820 615 13 2 v 14 w(ST)m(ART)f FA(with)g(a)h(request)h
(created)g(b)o(y)e Fw(MPI)p 1528 615 V 15 w(SEND)p 1650
615 V 15 w(INIT)249 669 y FA(starts)21 b(a)f(comm)o(unication)d(in)i
(the)i(same)e(manner)g(as)i(a)e(call)h(to)g Fw(MPI)p
1421 669 V 14 w(ISEND)p FA(;)f(a)h(call)g(to)249 723
y Fw(MPI)p 326 723 V 14 w(ST)m(ART)14 b FA(with)g(a)g(request)i
(created)g(b)o(y)e Fw(MPI)p 1039 723 V 15 w(RECV)p 1161
723 V 13 w(INIT)h FA(starts)g(a)f(comm)o(unicatio)o(n)e(in)249
777 y(the)j(same)e(manner)g(as)h(a)f(call)g(to)h Fw(MPI)p
864 777 V 14 w(IRECV)p FA(.)291 831 y(A)d(send)h(op)q(eration)f
(initiated)f(with)h Fw(MPI)p 940 831 V 14 w(ST)m(ART)g
FA(can)g(b)q(e)h(matc)o(hed)e(with)h(an)o(y)f(receiv)o(e)j(op-)249
885 y(eration)f(\(including)f Fw(MPI)p 659 885 V 15 w(PROBE)p
FA(\))f(and)i(a)g(receiv)o(e)h(op)q(eration)f(initiated)g(with)g
Fw(MPI)p 1601 885 V 14 w(ST)m(ART)249 939 y FA(can)i(receiv)o(e)h
(messages)f(generated)i(b)o(y)d(an)o(y)h(send)g(op)q(eration.)249
1064 y Fw(MPI)p 326 1064 V 14 w(ST)m(ART)m(ALL\(count,)h(a)o(rra)o(y)p
764 1064 V 15 w(of)p 813 1064 V 14 w(requests\))332 1139
y Fv(IN)158 b Fw(count)450 b Fv(list)14 b(length)332
1188 y(INOUT)71 b Fw(a)o(rra)o(y)p 620 1188 V 15 w(of)p
669 1188 V 14 w(requests)259 b Fv(arra)o(y)14 b(of)e(request)i(handles)
249 1299 y Fr(int)21 b(MPI)p 405 1299 14 2 v 15 w(Startall\(int)f
(count,)g(MPI)p 922 1299 V 15 w(Request)h(*array)p 1244
1299 V 14 w(of)p 1302 1299 V 15 w(requests\))249 1382
y(MPI)p 318 1382 V 15 w(STARTALL\(COUNT,)e(ARRAY)p 792
1382 V 14 w(OF)p 850 1382 V 16 w(REQUESTS,)h(IERROR\))336
1436 y(INTEGER)h(COUNT,)f(ARRAY)p 776 1436 V 15 w(OF)p
835 1436 V 15 w(REQUESTS\(*\),)f(IERROR)291 1520 y Fw(MPI)p
368 1520 13 2 v 14 w(ST)m(ART)m(ALL)13 b FA(starts)h(all)e(comm)o(uni)o
(cations)e(asso)q(ciated)k(with)f(p)q(ersisten)o(t)i(requests)g(in)249
1574 y Fw(a)o(rra)o(y)p 336 1574 V 15 w(of)p 385 1574
V 14 w(requests)p FA(.)26 b(A)16 b(call)f(to)h Fw(MPI)p
829 1574 V 15 w(ST)m(ART)m(ALL\(count,)g(a)o(rra)o(y)p
1269 1574 V 16 w(of)p 1319 1574 V 14 w(requests\))i FA(has)e(the)g
(same)249 1628 y(e\013ect)h(as)e(calls)g(to)g Fw(MPI)p
635 1628 V 15 w(ST)m(ART\(a)o(rra)o(y)p 882 1628 V 14
w(of)p 930 1628 V 15 w(requests[i]\))p FA(,)i(executed)g(for)e
Fw(i=0)g(,...,)e(count-1)p FA(,)j(in)249 1682 y(some)d(arbitrary)h
(order.)291 1736 y(A)g(comm)o(unicatio)o(n)e(started)j(with)f(a)g(call)
g(to)g Fw(MPI)p 1102 1736 V 14 w(ST)m(ART)g FA(or)g Fw(MPI)p
1387 1736 V 15 w(ST)m(ART)m(ALL)g FA(is)g(com-)249 1790
y(pleted)f(b)o(y)g(a)f(call)g(to)g Fw(MPI)p 663 1790
V 14 w(W)m(AIT)p FA(,)f Fw(MPI)p 879 1790 V 15 w(TEST)p
FA(,)h(or)h(one)f(of)g(the)h(other)h(completion)c(functions)249
1844 y(describ)q(ed)k(in)e(Section)h(2.9.)k(The)12 b(p)q(ersisten)o(t)j
(request)f(b)q(ecomes)e(inactiv)o(e)g(after)h(the)g(comple-)249
1898 y(tion)h(of)h(suc)o(h)g(a)g(call,)f(but)h(it)g(is)f(not)h(deallo)q
(cated)g(and)g(it)f(can)h(b)q(e)h(re-activ)n(ated)f(b)o(y)g(another)249
1952 y Fw(MPI)p 326 1952 V 14 w(ST)m(ART)f FA(or)g Fw(MPI)p
611 1952 V 14 w(ST)m(ART)m(ALL)p FA(.)291 2006 y(P)o(ersisten)o(t)k
(requests)g(are)f(explicitly)e(deallo)q(cated)h(b)o(y)h(a)f(call)f(to)h
Fw(MPI)p 1429 2006 V 15 w(REQUEST)p 1632 2006 V 13 w(FREE)249
2060 y FA(\(Section)i(2.8.5\).)28 b(The)18 b(call)f(to)g
Fw(MPI)p 857 2060 V 15 w(REQUEST)p 1060 2060 V 14 w(FREE)f
FA(can)i(o)q(ccur)h(at)e(an)o(y)g(p)q(oin)o(t)h(in)f(the)249
2114 y(program)g(after)j(the)f(p)q(ersisten)o(t)i(request)f(w)o(as)f
(created.)35 b(Ho)o(w)o(ev)o(er,)20 b(the)g(request)g(will)e(b)q(e)249
2168 y(deallo)q(cated)f(only)e(after)i(it)f(b)q(ecomes)h(inactiv)o(e.)
26 b(Activ)o(e)17 b(receiv)o(e)h(requests)g(should)e(not)h(b)q(e)249
2222 y(freed.)h(Otherwise,)c(it)e(will)f(not)h(b)q(e)h(p)q(ossible)g
(to)f(c)o(hec)o(k)i(that)e(the)h(receiv)o(e)h(has)e(completed.)17
b(It)249 2276 y(is)e(preferable)i(to)e(free)i(requests)g(when)f(they)g
(are)g(inactiv)o(e.)23 b(If)15 b(this)h(rule)f(is)h(follo)o(w)o(ed,)e
(then)249 2330 y(the)h(functions)f(describ)q(ed)h(in)f(this)g(section)g
(will)f(b)q(e)h(in)o(v)o(ok)o(ed)f(in)h(a)f(sequence)j(of)d(the)i
(form,)291 2407 y Fs(Create)g FA(\()p Fs(Start)g(Complete)p
FA(\))803 2392 y Fm(\003)836 2407 y Fs(F)l(ree)g Fp(;)249
2485 y FA(where)i Ft(\003)e FA(indicates)h(zero)g(or)f(more)g(rep)q
(etitions.)24 b(If)15 b(the)h(same)e(comm)o(unication)e(request)18
b(is)p eop
%%Page: 84 98
84 97 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(84)1275 b(Chapter)13 b(2)249 507
y FA(used)h(in)e(sev)o(eral)i(concurren)o(t)h(threads,)e(it)g(is)g(the)
g(user's)h(resp)q(onsibilit)o(y)f(to)g(co)q(ordinate)g(calls)249
561 y(so)h(that)g(the)g(correct)i(sequence)g(is)e(ob)q(ey)o(ed.)291
615 y Fw(MPI)p 368 615 13 2 v 14 w(CANCEL)g FA(can)i(b)q(e)f(used)h(to)
f(cancel)h(a)f(comm)o(unication)d(that)j(uses)h(a)f(p)q(ersisten)o(t)i
(re-)249 669 y(quest,)11 b(in)f(the)h(same)e(w)o(a)o(y)g(it)h(is)g
(used)g(for)g(nonp)q(ersisten)o(t)i(requests.)19 b(A)10
b(successful)i(cancelation)249 723 y(cancels)17 b(the)f(activ)o(e)g
(comm)o(unicatio)o(n,)d(but)j(do)q(es)h(not)e(deallo)q(cate)h(the)g
(request.)25 b(After)17 b(the)249 777 y(call)12 b(to)h
Fw(MPI)p 451 777 V 14 w(CANCEL)g FA(and)f(the)i(subsequen)o(t)h(call)d
(to)h Fw(MPI)p 1198 777 V 14 w(W)m(AIT)f FA(or)h Fw(MPI)p
1453 777 V 14 w(TEST)h FA(\(or)f(other)249 831 y(completion)f
(function\),)h(the)h(request)h(b)q(ecomes)e(inactiv)o(e)g(and)h(can)f
(b)q(e)h(activ)n(ated)g(for)f(a)g(new)249 885 y(comm)o(unication.)249
981 y Fs(Example)i(2.31)21 b FA(Jacobi)14 b(computation,)d(using)j(p)q
(ersisten)o(t)i(requests.)249 1034 y Fr(...)249 1088
y(REAL,)21 b(ALLOCATABLE)e(A\(:,:\),)i(B\(:,:\))249 1142
y(INTEGER)f(req\(4\))249 1196 y(INTEGER)g(status\(MPI_STATUS_S)o(IZE,4)
o(\))249 1250 y(...)249 1304 y(!)i(Compute)e(number)h(of)g(processes)f
(and)h(myrank)249 1358 y(CALL)g(MPI_COMM_SIZE\(comm)o(,)e(p,)i(ierr\))
249 1412 y(CALL)g(MPI_COMM_RANK\(comm)o(,)e(myrank,)h(ierr\))249
1520 y(!)i(Compute)e(size)h(of)g(local)g(block)249 1574
y(m)h(=)f(n/p)249 1628 y(IF)g(\(myrank.LT.\(n-p*m\)\))d(THEN)314
1682 y(m)k(=)g(m+1)249 1736 y(END)f(IF)249 1844 y(!)h(Compute)e
(neighbors)249 1898 y(IF)h(\(myrank.EQ.0\))f(THEN)314
1952 y(left)h(=)h(MPI_PROC_NULL)249 2006 y(ELSE)314 2060
y(left)f(=)h(myrank)f(-1)249 2114 y(END)g(IF)249 2168
y(IF)g(\(myrank.EQ.p-1\))e(THEN)314 2222 y(right)i(=)h(MPI_PROC_NULL)
249 2276 y(ELSE)314 2330 y(right)f(=)h(myrank+1)249 2384
y(ENDIF)249 2492 y(!)g(Allocate)e(local)h(arrays)p eop
%%Page: 85 99
85 98 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15 b(Comm)o(unication)
940 b(85)249 507 y Fr(ALLOCATE)20 b(\(A\(n,0:m+1\),)g(B\(n,m\)\))249
561 y(...)249 615 y(!)i(Create)e(persistent)g(requests)249
669 y(CALL)h(MPI_SEND_INIT\(B\(1,)o(1\),)d(n,)k(MPI_REAL,)e(left,)h
(tag,)g(comm,)f(req\(1\),)h(ierr\))249 723 y(CALL)g
(MPI_SEND_INIT\(B\(1,)o(m\),)d(n,)k(MPI_REAL,)e(right,)g(tag,)h(comm,)g
(req\(2\),)f(ierr\))249 777 y(CALL)h(MPI_RECV_INIT\(A\(1,)o(0\),)d(n,)k
(MPI_REAL,)e(left,)h(tag,)g(comm,)f(req\(3\),)h(ierr\))249
831 y(CALL)g(MPI_RECV_INIT\(A\(1,)o(m+1\))o(,)e(n,)i(MPI_REAL,)f
(right,)h(tag,)g(comm,)g(req\(4\),)f(ierr\))249 885 y(....)249
993 y(!)i(Main)f(loop)249 1047 y(DO)g(WHILE\(.NOT.converged)o(\))314
1155 y(!)h(Compute)e(boundary)h(columns)314 1209 y(DO)h(i=1,n)380
1263 y(B\(i,1\))e(=)i(0.25*\(A\(i-1,1\)+A\()o(i+1,1)o(\)+A\(i)o(,0\)+A)
o(\(i,2\))o(\))380 1317 y(B\(i,m\))e(=)i(0.25*\(A\(i-1,m\)+A\()o(i+1,m)
o(\)+A\(i)o(,m-1\))o(+A\(i,)o(m+1\))o(\))314 1371 y(END)g(DO)314
1479 y(!)g(Start)f(communication)314 1533 y(CALL)g(MPI_STARTALL\(4,)e
(req,)i(ierr\))314 1641 y(!)h(Compute)e(interior)314
1694 y(DO)i(j=2,m-1)380 1748 y(DO)f(i=1,n)445 1802 y(B\(i,j\))g(=)g
(0.25*\(A\(i-1,j\)+A\(i+)o(1,j\)+)o(A\(i,j)o(-1\)+A)o(\(i,j)o(+1\)\))
380 1856 y(END)g(DO)314 1910 y(END)h(DO)314 1964 y(DO)g(j=1,m)380
2018 y(DO)f(i=1,n)445 2072 y(A\(i,j\))g(=)g(B\(i,j\))380
2126 y(END)g(DO)314 2180 y(END)h(DO)314 2288 y(!)g(Complete)e
(communication)380 2342 y(CALL)h(MPI_WAITALL\(4,)e(req,)i(status,)f
(ierr\))314 2396 y(...)249 2450 y(END)h(DO)249 2504 y
FA(W)m(e)15 b(come)g(bac)o(k)h(\(for)f(a)h(last)f(time!\))23
b(to)15 b(our)h(Jacobi)f(example)g(\(Example)f(2.12,)h(page)g(41\).)p
eop
%%Page: 86 100
86 99 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988 225
2 150 v 249 251 a Fv(86)1275 b(Chapter)13 b(2)249 507
y FA(The)g(comm)o(unication)d(calls)i(in)h(the)h(main)c(lo)q(op)j(are)g
(reduced)i(to)d(t)o(w)o(o:)17 b(one)d(to)e(start)i(all)e(four)249
561 y(comm)o(unications)f(and)j(one)g(to)f(complete)h(all)e(four)i
(comm)o(unicatio)o(ns.)249 682 y FD(2.12)52 b(Comm)o
(unication-Complete)16 b(Calls)f(with)f(Null)h(Request)f(Handles)249
790 y FA(Normally)m(,)9 b(an)j(in)o(v)n(alid)e(handle)h(to)h(an)g
Fw(MPI)f FA(ob)r(ject)i(is)f(not)g(a)g(v)n(alid)e(argumen)o(t)h(for)g
(a)h(call)f(that)249 844 y(exp)q(ects)19 b(an)e(ob)r(ject.)28
b(There)19 b(is)e(one)g(exception)h(to)f(this)g(rule:)25
b(comm)o(uni)o(cation-com)o(pl)o(ete)249 897 y(calls)12
b(can)h(b)q(e)g(passed)h(request)g(handles)f(with)f(v)n(alue)g
Fq(MPI)p 1164 897 12 2 v 13 w(REQUEST)p 1349 897 V 15
w(NULL)p FA(.)h(A)g(comm)o(uni)o(ca-)249 951 y(tion)d(complete)h(call)f
(with)g(suc)o(h)i(an)e(argumen)o(t)g(is)h(a)f(\\no-op":)16
b(the)11 b(n)o(ull)f(handles)h(are)g(ignored.)249 1005
y(The)k(same)e(rule)h(applies)g(to)g(p)q(ersisten)o(t)i(handles)f(that)
f(are)h(not)f(asso)q(ciated)h(with)e(an)h(activ)o(e)249
1059 y(comm)o(unication)c(op)q(eration.)291 1113 y(W)m(e)k(shall)g(use)
i(the)g(follo)o(wing)c(terminology)m(.)19 b(A)c Fs(n)o(ull)e
FA(request)j(handle)f(is)g(a)g(handle)g(with)249 1167
y(v)n(alue)g Fq(MPI)p 430 1167 V 13 w(REQUEST)p 615 1167
V 15 w(NULL)p FA(.)h(A)g(handle)f(to)h(a)f(p)q(ersisten)o(t)j(request)f
(is)f Fs(inactiv)o(e)e FA(if)h(the)h(re-)249 1221 y(quest)21
b(is)e(not)h(curren)o(tly)g(asso)q(ciated)h(with)e(an)g(ongoing)g(comm)
o(uni)o(cation.)32 b(A)20 b(handle)g(is)249 1275 y Fs(activ)o(e)p
FA(,)12 b(if)g(it)h(is)h(neither)g(n)o(ull)e(nor)h(inactiv)o(e.)18
b(An)13 b Fs(empt)o(y)f FA(status)i(is)g(a)f(status)h(that)f(is)g(set)i
(to)249 1329 y Fq(tag)h(=)g(MPI)p 434 1329 V 12 w(ANY)p
525 1329 V 14 w(T)m(A)o(G)p FA(,)f Fq(source)h(=)f(MPI)p
872 1329 V 13 w(ANY)p 964 1329 V 13 w(SOURCE)p FA(,)i(and)g(is)f(also)h
(in)o(ternally)f(con\014gured)249 1383 y(so)e(that)h(calls)e(to)29
b Fw(MPI)p 626 1383 13 2 v 14 w(GET)p 721 1383 V 15 w(COUNT)13
b FA(and)h Fw(MPI)p 1049 1383 V 15 w(GET)p 1145 1383
V 14 w(ELEMENT)h FA(return)h Fq(count)d(=)g(0)p FA(.)19
b(W)m(e)249 1437 y(set)d(a)f(status)h(v)n(ariable)f(to)g(empt)o(y)f(in)
h(cases)i(when)e(the)h(v)n(alue)f(returned)i(is)e(not)g(signi\014can)o
(t.)249 1491 y(Status)f(is)g(set)h(this)f(w)o(a)o(y)f(to)h(prev)o(en)o
(t)h(errors)g(due)f(to)g(access)i(of)d(stale)h(information.)291
1545 y(A)d(call)f(to)h Fw(MPI)p 531 1545 V 15 w(W)m(AIT)f
FA(with)h(a)g(n)o(ull)f(or)h(inactiv)o(e)g Fw(request)i
FA(argumen)o(t)d(returns)j(immedia)o(tely)249 1599 y(with)h(an)f(empt)o
(y)g(status.)291 1653 y(A)e(call)f(to)h Fw(MPI)p 531
1653 V 14 w(TEST)h FA(with)f(a)f(n)o(ull)g(or)i(inactiv)o(e)e
Fw(request)j FA(argumen)o(t)d(returns)j(immedia)o(tely)249
1707 y(with)h Fq(\015ag)f(=)f(true)i FA(and)g(an)f(empt)o(y)g(status.)
291 1761 y(The)18 b(list)f(of)g(requests)j(passed)f(to)f
Fw(MPI)p 937 1761 V 14 w(W)m(AIT)m(ANY)e FA(ma)o(y)g(con)o(tain)i(n)o
(ull)f(or)g(inactiv)o(e)h(re-)249 1815 y(quests.)32 b(If)18
b(some)f(of)g(the)i(requests)h(are)f(activ)o(e,)f(then)h(the)g(call)e
(returns)j(when)f(an)e(activ)o(e)249 1869 y(request)g(has)f(completed.)
23 b(If)16 b(all)e(the)j(requests)g(in)f(the)g(list)f(are)i(n)o(ull)d
(or)i(inactiv)o(e)f(then)i(the)249 1923 y(call)c(returns)j(imm)o
(ediately)m(,)10 b(with)k Fw(index)h(=)f(MPI)p 1035 1923
V 14 w(UNDEFINED)f FA(and)h(an)g(empt)o(y)e Fw(status)p
FA(.)291 1977 y(The)18 b(list)f(of)g(requests)j(passed)f(to)e
Fw(MPI)p 936 1977 V 15 w(TEST)m(ANY)g FA(ma)o(y)f(con)o(tain)h(n)o(ull)
g(or)h(inactiv)o(e)f(re-)249 2031 y(quests.)i(The)12
b(call)g(returns)h Fw(\015ag)f(=)g(false)g FA(if)g(there)h(are)f(activ)
o(e)g(requests)i(in)e(the)h(list,)e(and)h(none)249 2085
y(ha)o(v)o(e)j(completed.)k(It)c(returns)h Fw(\015ag)f(=)g(true)g
FA(if)f(an)h(activ)o(e)f(request)j(has)d(completed,)g(or)h(if)f(all)249
2139 y(the)k(requests)h(in)e(the)g(list)g(are)g(n)o(ull)f(or)i(inactiv)
o(e.)27 b(In)17 b(the)h(later)f(case,)h(it)f(returns)i
Fw(index)f(=)249 2193 y(MPI)p 326 2193 V 14 w(UNDEFINED)13
b FA(and)h(an)g(empt)o(y)e Fw(status)p FA(.)291 2247
y(The)e(list)f(of)g(requests)j(passed)e(to)g Fw(MPI)p
888 2247 V 14 w(W)m(AIT)m(ALL)f FA(ma)o(y)f(con)o(tain)h(n)o(ull)g(or)h
(inactiv)o(e)f(requests.)249 2301 y(The)h(call)f(returns)i(as)e(so)q
(on)h(as)f(all)g(activ)o(e)g(requests)i(ha)o(v)o(e)f(completed.)16
b(The)10 b(call)e(sets)j(to)e(empt)o(y)249 2355 y(eac)o(h)14
b(status)h(asso)q(ciated)g(with)e(a)h(n)o(ull)f(or)h(inactiv)o(e)f
(request.)291 2408 y(The)d(list)f(of)g(requests)i(passed)g(to)e
Fw(MPI)p 887 2408 V 15 w(TEST)m(ALL)h FA(ma)o(y)d(con)o(tain)j(n)o(ull)
e(or)i(inactiv)o(e)f(requests.)249 2462 y(The)15 b(call)e(returns)j
Fw(\015ag)e(=)h(true)g FA(if)f(all)f(activ)o(e)h(requests)i(ha)o(v)o(e)
f(completed.)j(In)d(this)f(case,)h(the)p eop
%%Page: 87 101
87 100 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15
b(Comm)o(unication)940 b(87)249 507 y FA(call)11 b(sets)i(to)f(empt)o
(y)f(eac)o(h)h(status)h(asso)q(ciated)f(with)g(a)f(n)o(ull)g(or)h
(inactiv)o(e)f(request.)19 b(Otherwise,)249 561 y(the)c(call)e(returns)
i Fq(\015ag)e(=)g(false)p FA(.)291 615 y(The)i(list)g(of)f(requests)j
(passed)f(to)f Fw(MPI)p 920 615 13 2 v 14 w(W)m(AITSOME)f
FA(ma)o(y)g(con)o(tain)g(n)o(ull)g(or)h(inactiv)o(e)g(re-)249
669 y(quests.)22 b(If)14 b(the)h(list)f(con)o(tains)h(activ)o(e)f
(requests,)j(then)e(the)g(call)f(returns)i(when)f(some)f(of)g(the)249
723 y(activ)o(e)h(requests)j(ha)o(v)o(e)d(completed.)21
b(If)15 b(all)f(requests)j(w)o(ere)f(n)o(ull)f(or)g(inactiv)o(e,)f
(then)i(the)g(call)249 777 y(returns)g(imm)o(ediately)m(,)10
b(with)k Fq(outcount)e(=)h(MPI)p 1002 777 12 2 v 12 w(UNDEFINED)p
FA(.)291 831 y(The)21 b(list)f(of)g(requests)j(passed)f(to)e
Fw(MPI)p 954 831 13 2 v 15 w(TESTSOME)g FA(ma)o(y)f(con)o(tain)h(n)o
(ull)g(or)h(inactiv)o(e)249 885 y(requests.)e(If)12 b(the)g(list)f(con)
o(tains)h(activ)o(e)f(requests)j(and)d(some)g(ha)o(v)o(e)h(completed,)f
(then)h(the)g(call)249 939 y(returns)i(in)e Fw(outcount)h
FA(the)g(n)o(um)o(b)q(er)e(of)h(completed)g(request.)19
b(If)12 b(it)f(con)o(tains)i(activ)o(e)f(requests,)249
993 y(and)18 b(none)h(ha)o(v)o(e)g(completed,)f(then)h(it)g(returns)h
Fw(outcount)f(=)g(0)p FA(.)32 b(If)18 b(the)h(list)f(con)o(tains)h(no)
249 1047 y(activ)o(e)14 b(requests,)h(then)g(it)e(returns)j
Fw(outcount)f(=)f(MPI)p 1112 1047 V 14 w(UNDEFINED)p
FA(.)291 1101 y(In)f(all)g(these)i(cases,)g(n)o(ull)e(or)h(inactiv)o(e)
f(request)j(handles)e(are)g(not)g(mo)q(di\014ed)f(b)o(y)g(the)i(call.)
249 1196 y Fs(Example)g(2.32)21 b FA(Starv)n(ation-free)13
b(pro)q(ducer-consumer)j(co)q(de)249 1250 y Fr(...)249
1304 y(typedef)k(struct)h({)293 1358 y(char)g(data[MAXSIZE];)293
1412 y(int)g(datasize;)249 1466 y(})h(Buffer;)249 1520
y(Buffer)f(buffer[];)249 1574 y(MPI_Request)f(req[];)249
1628 y(MPI_Status)g(status;)249 1682 y(...)249 1790 y
(MPI_Comm_rank\(comm)o(,)f(&rank\);)249 1844 y(MPI_Comm_size\(comm)o(,)
g(&size\);)249 1898 y(if\(rank)h(!=)i(size-1\))42 b({)h(/*)22
b(producer)e(code)43 b(*/)314 1952 y(buffer)21 b(=)h(\(Buffer)e
(*\)malloc\(sizeof\(B)o(uffer)o(\)\);)314 2006 y(while\(1\))h({)43
b(/*)21 b(main)g(loop)g(*/)380 2060 y(produce\()f(buffer->data,)f
(&buffer->datasize\))o(;)380 2114 y(MPI_Send\(buffer->)o(data)o(,)g
(buffer->datasize,)f(MPI_CHAR,)598 2168 y(size-1,)i(tag,)h(comm,)g
(&status\);)380 2222 y(})314 2276 y(})249 2330 y(else)g({)h(/*)f(rank)g
(==)g(size-1;)g(consumer)f(code)h(*/)314 2384 y(buffer)g(=)h(\(Buffer)e
(*\)malloc\(sizeof\(B)o(uffer)o(\)*\(si)o(ze-1\))o(\);)314
2438 y(req)i(=)f(\(MPI_Request)f(*\)malloc\(sizeof)o(\(MPI_)o(Reque)o
(st\)*\()o(size)o(-1\)\);)314 2492 y(for)i(\(i=0;)e(i<size-1;)g(i++\))p
eop
%%Page: 88 102
88 101 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(88)1275 b(Chapter)13 b(2)380
507 y Fr(req[i])20 b(=)i(MPI_REQUEST_NULL;)314 561 y(while)f(\(1\))g({)
h(/*)f(main)g(loop)g(*/)380 615 y(MPI_Waitany\(size-)o(1,)e(req,)i(&i,)
g(&status\);)380 669 y(if)g(\(i)h(==)f(MPI_UNDEFINED\))e({)i(/*)h(no)f
(pending)g(receive)f(left)h(*/)445 723 y(for\(j=0;)42
b(j<)22 b(size-1;)e(j++\))532 777 y(MPI_Irecv\(buffer[j])o(.data)o(,)f
(MAXSIZE,)h(MPI_CHAR,)g(j,)h(tag,)750 831 y(comm,)g(&req[j]\);)380
885 y(else)g({)445 939 y(MPI_Get_count\(&sta)o(tus,)d(MPI_CHAR,)i
(&buffer[i].datasize)o(\);)445 993 y(consume\(buffer[i].)o(data,)e
(buffer[i].datasize\))o(;)445 1047 y(})358 1101 y(})293
1155 y(})249 1209 y FA(This)11 b(is)h(our)f(last)g(remak)o(e)g(of)g
(the)h(pro)q(ducer-consumer)h(co)q(de)f(from)e(Example)g(2.17,)g(page)h
(56.)249 1263 y(As)20 b(in)f(Example)f(2.17,)i(the)g(computation)e(pro)
q(ceeds)k(in)d(phases,)i(where)g(at)f(eac)o(h)g(phase)249
1317 y(the)f(consumer)e(consumes)h(one)g(message)g(from)e(eac)o(h)i
(pro)q(ducer.)32 b(Unlik)o(e)17 b(Example)f(2.17,)249
1371 y(messages)j(need)g(not)f(b)q(e)h(consumed)g(in)f(order)h(within)f
(eac)o(h)h(phase)g(but,)g(rather,)h(can)f(b)q(e)249 1425
y(consumed)14 b(as)g(so)q(on)g(as)g(arriv)o(ed.)249 1511
y FB(R)n(ationale.)36 b FA(The)12 b(acceptance)i(of)e(n)o(ull)f(or)g
(inactiv)o(e)h(requests)i(in)e(comm)o(uni)o(cation-com)o(pl)o(ete)249
1565 y(calls)g(facilitate)f(the)i(use)h(of)d(m)o(ultiple)g(completion)f
(calls)i(\(Section)h(2.9\).)k(As)c(in)f(the)h(example)249
1619 y(ab)q(o)o(v)o(e,)d(the)g(user)g(need)g(not)g(delete)g(eac)o(h)g
(request)h(from)d(the)i(list)f(as)g(so)q(on)g(as)h(it)f(has)g
(completed,)249 1673 y(but)h(can)h(reuse)g(the)g(same)e(list)h(un)o
(til)f(all)g(requests)j(in)d(the)i(list)f(ha)o(v)o(e)g(completed.)16
b(Chec)o(king)10 b(for)249 1726 y(n)o(ull)h(or)i(inactiv)o(e)f
(requests)i(is)f(not)f(exp)q(ected)i(to)f(add)f(a)g(signi\014can)o(t)g
(o)o(v)o(erhead,)h(since)g(qualit)o(y)249 1780 y(implemen)o(tations)g
(will)h(c)o(hec)o(k)j(parameters,)f(an)o(yho)o(w.)23
b(Ho)o(w)o(ev)o(er,)16 b(most)f(implem)o(en)o(tations)249
1834 y(will)e(su\013er)i(some)e(p)q(erformance)h(loss)g(if)f(they)h
(often)g(tra)o(v)o(erse)h(mostly)e(empt)o(y)f(request)k(lists,)249
1888 y(lo)q(oking)c(for)i(activ)o(e)g(requests.)249 1957
y(The)f(b)q(eha)o(vior)g(of)f(the)h(m)o(ultiple)d(completion)h(calls)h
(w)o(as)h(de\014ned)h(with)e(the)h(follo)o(wing)d(struc-)249
2011 y(ture.)249 2080 y Ft(\017)21 b FA(T)m(est)11 b(returns)i(with)e
Fw(\015ag)g(=)h(true)g FA(whenev)o(er)h(W)m(ait)c(w)o(ould)i(return;)i
(b)q(oth)e(calls)g(return)h(same)291 2134 y(information)f(in)i(this)h
(case.)249 2200 y Ft(\017)21 b FA(A)16 b(call)g(to)g(W)m(ait,)g(W)m
(aitan)o(y)m(,)e(W)m(aitsome)g(or)j(W)m(aitall)d(will)h(return)i(if)f
(all)f(requests)k(in)d(the)291 2254 y(list)d(are)h(n)o(ull)f(or)h
(inactiv)o(e,)f(th)o(us)h(a)o(v)o(oiding)e(deadlo)q(c)o(k.)249
2321 y Ft(\017)21 b FA(The)e(information)d(returned)k(b)o(y)f(a)f(T)m
(est,)i(T)m(estan)o(y)m(,)f(T)m(estsome)f(or)h(T)m(estall)f(call)g
(distin-)291 2375 y(guishes)h(b)q(et)o(w)o(een)g(the)g(case)h(\\no)e
(op)q(eration)g(completed")f(and)i(the)g(case)g(\\there)g(is)g(no)291
2429 y(op)q(eration)13 b(to)h(complete.")249 2498 y(\()p
FB(End)i(of)f(r)n(ationale.)p FA(\))p eop
%%Page: 89 103
89 102 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15
b(Comm)o(unication)940 b(89)249 507 y FD(2.13)52 b(Comm)o(unication)19
b(Mo)q(des)249 615 y FA(The)14 b(send)h(call)e(describ)q(ed)j(in)d
(Section)h(2.2.1)f(used)h(the)h Fs(standard)d FA(comm)o(uni)o(cation)f
(mo)q(de.)249 669 y(In)i(this)f(mo)q(de,)f(it)i(is)f(up)g(to)h
Fw(MPI)f FA(to)g(decide)i(whether)f(outgoing)f(messages)g(will)f(b)q(e)
i(bu\013ered.)249 723 y Fw(MPI)k FA(ma)o(y)f(bu\013er)j(outgoing)e
(messages.)30 b(In)18 b(suc)o(h)h(a)e(case,)j(the)e(send)h(call)e(ma)o
(y)f(complete)249 777 y(b)q(efore)k(a)f(matc)o(hing)e(receiv)o(e)k(is)e
(in)o(v)o(ok)o(ed.)34 b(On)19 b(the)h(other)g(hand,)g(bu\013er)g(space)
g(ma)o(y)e(b)q(e)249 831 y(una)o(v)n(ailable,)13 b(or)i
Fw(MPI)g FA(ma)o(y)e(c)o(ho)q(ose)k(not)e(to)g(bu\013er)h(outgoing)e
(messages,)i(for)f(p)q(erformance)249 885 y(reasons.)38
b(In)20 b(this)g(case,)i(the)f(send)g(call)e(will)f(not)i(complete)g
(un)o(til)f(a)h(matc)o(hing)e(receiv)o(e)249 939 y(has)e(b)q(een)h(p)q
(osted,)g(and)e(the)i(data)e(has)h(b)q(een)h(mo)o(v)o(ed)d(to)i(the)g
(receiv)o(er.)26 b(\(A)16 b(blo)q(c)o(king)f(send)249
993 y(completes)e(when)h(the)g(call)e(returns;)j(a)e(non)o(blo)q(c)o
(king)f(send)i(completes)f(when)g(the)h(matc)o(hing)249
1047 y(W)m(ait)f(or)g(T)m(est)i(call)e(returns)i(successfully)m(.\))291
1101 y(Th)o(us,)j(a)f(send)h(in)f(standard)h(mo)q(de)f(can)h(b)q(e)g
(started)g(whether)h(or)f(not)f(a)g(matc)o(hing)f(re-)249
1155 y(ceiv)o(e)g(has)f(b)q(een)i(p)q(osted.)23 b(It)15
b(ma)o(y)e(complete)i(b)q(efore)h(a)f(matc)o(hing)e(receiv)o(e)k(is)e
(p)q(osted.)23 b(The)249 1209 y(standard-mo)q(de)15 b(send)j(has)e
(non-lo)q(cal)f(completion)f(seman)o(tics,)i(since)h(successful)h
(comple-)249 1263 y(tion)13 b(of)h(the)g(send)h(op)q(eration)f(ma)o(y)e
(dep)q(end)j(on)e(the)i(o)q(ccurrence)i(of)c(a)g(matc)o(hing)f(receiv)o
(e.)291 1317 y(A)20 b Fs(bu\013ered)p FA(-m)o(o)q(de)e(send)j(op)q
(eration)g(can)f(b)q(e)h(started)h(whether)g(or)e(not)g(a)g(matc)o
(hing)249 1371 y(receiv)o(e)h(has)e(b)q(een)i(p)q(osted.)36
b(It)19 b(ma)o(y)f(complete)h(b)q(efore)h(a)f(matc)o(hing)f(receiv)o(e)
j(is)e(p)q(osted.)249 1425 y(Bu\013ered-mo)q(de)11 b(send)g(has)f(lo)q
(cal)g(completion)e(seman)o(tics:)16 b(its)10 b(completion)e(do)q(es)j
(not)f(dep)q(end)249 1479 y(on)h(the)i(o)q(ccurrence)h(of)d(a)g(matc)o
(hing)f(receiv)o(e.)19 b(In)11 b(order)i(to)e(complete)g(the)i(op)q
(eration,)e(it)g(ma)o(y)249 1533 y(b)q(e)j(necessary)h(to)e(bu\013er)h
(the)f(outgoing)f(message)h(lo)q(cally)m(.)j(F)m(or)c(that)h(purp)q
(ose,)h(bu\013er)g(space)249 1587 y(is)i(pro)o(vided)g(b)o(y)g(the)g
(application)f(\(Section)h(2.13.4\).)23 b(An)16 b(error)h(will)d(o)q
(ccur)j(if)e(a)h(bu\013ered-)249 1641 y(mo)q(de)11 b(send)h(is)g
(called)f(and)g(there)i(is)f(insu\016cien)o(t)f(bu\013er)i(space.)18
b(The)12 b(bu\013er)h(space)f(o)q(ccupied)249 1694 y(b)o(y)i(the)g
(message)g(is)f(freed)i(when)g(the)f(message)g(is)f(transferred)j(to)e
(its)f(destination)h(or)g(when)249 1748 y(the)h(bu\013ered)g(send)g(is)
e(cancelled.)291 1802 y(A)k Fs(sync)o(hronous)p FA(-m)n(o)q(de)e(send)j
(can)f(b)q(e)h(started)g(whether)h(or)e(not)g(a)g(matc)o(hing)e(receiv)
o(e)249 1856 y(w)o(as)d(p)q(osted.)18 b(Ho)o(w)o(ev)o(er,)12
b(the)h(send)g(will)d(complete)h(successfully)i(only)e(if)h(a)f(matc)o
(hing)f(receiv)o(e)249 1910 y(is)k(p)q(osted,)g(and)g(the)g(receiv)o(e)
h(op)q(eration)f(has)g(started)h(to)f(receiv)o(e)h(the)f(message)g(sen)
o(t)g(b)o(y)g(the)249 1964 y(sync)o(hronous)i(send.)21
b(Th)o(us,)15 b(the)g(completion)e(of)h(a)g(sync)o(hronous)i(send)g
(not)e(only)g(indicates)249 2018 y(that)f(the)h(send)g(bu\013er)g(can)f
(b)q(e)h(reused,)g(but)f(also)f(indicates)i(that)f(the)g(receiv)o(er)i
(has)e(reac)o(hed)249 2072 y(a)j(certain)i(p)q(oin)o(t)e(in)g(its)g
(execution,)i(namely)d(that)i(it)f(has)g(started)i(executing)g(the)f
(matc)o(h-)249 2126 y(ing)d(receiv)o(e.)20 b(Sync)o(hronous)15
b(mo)q(de)e(pro)o(vides)h(sync)o(hronous)i(comm)o(unicati)o(on)11
b(seman)o(tics:)19 b(a)249 2180 y(comm)o(unication)7
b(do)q(es)12 b(not)e(complete)g(at)g(either)i(end)f(b)q(efore)g(b)q
(oth)g(pro)q(cesses)i(rendezv)o(ous)g(at)249 2234 y(the)f(comm)o
(unicati)o(on.)i(A)d(sync)o(hronous-mo)q(de)g(send)h(has)f(non-lo)q
(cal)f(completion)f(seman)o(tics.)291 2288 y(A)19 b Fs(ready)p
FA(-mo)q(de)e(send)j(ma)o(y)d(b)q(e)i(started)h FB(only)g
FA(if)e(the)h(matc)o(hing)e(receiv)o(e)k(has)e(already)249
2342 y(b)q(een)e(p)q(osted.)23 b(Otherwise,)17 b(the)f(op)q(eration)f
(is)g(erroneous)i(and)e(its)h(outcome)e(is)i(unde\014ned.)249
2396 y(On)e(some)e(systems,)h(this)h(allo)o(ws)e(the)i(remo)o(v)n(al)d
(of)i(a)g(hand-shak)o(e)g(op)q(eration)g(and)g(results)i(in)249
2450 y(impro)o(v)o(ed)d(p)q(erformance.)18 b(A)13 b(ready-mo)q(de)g
(send)i(has)e(the)h(same)f(seman)o(tics)g(as)h(a)f(standard-)249
2504 y(mo)q(de)h(send.)21 b(In)14 b(a)h(correct)h(program,)d
(therefore,)i(a)g(ready-mo)q(de)e(send)j(could)e(b)q(e)h(replaced)p
eop
%%Page: 90 104
90 103 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(90)1275 b(Chapter)13 b(2)249
507 y FA(b)o(y)g(a)f(standard-mo)q(de)g(send)i(with)e(no)h(e\013ect)i
(on)d(the)i(b)q(eha)o(vior)e(of)g(the)i(program)d(other)i(than)249
561 y(p)q(erformance.)291 615 y(Three)i(additional)e(send)j(functions)e
(are)h(pro)o(vided)g(for)f(the)h(three)h(additional)d(comm)o(uni-)249
669 y(cation)h(mo)q(des.)21 b(The)15 b(comm)o(unicati)o(on)d(mo)q(de)i
(is)g(indicated)h(b)o(y)g(a)f(one)h(letter)h(pre\014x:)k
Fw(B)15 b FA(for)249 723 y(bu\013ered,)h Fw(S)f FA(for)g(sync)o
(hronous,)h(and)f Fw(R)g FA(for)f(ready)m(.)22 b(There)16
b(is)f(only)f(one)h(receiv)o(e)i(mo)q(de)d(and)249 777
y(it)g(matc)o(hes)f(an)o(y)g(of)h(the)g(send)h(mo)q(des.)291
831 y(All)h(send)j(and)f(receiv)o(e)h(op)q(erations)f(use)g(the)g
Fw(buf)p FA(,)h Fw(count)p FA(,)g Fw(datat)o(yp)q(e)p
FA(,)h Fw(source)p FA(,)f Fw(dest)p FA(,)g Fw(tag)p FA(,)249
885 y Fw(comm)p FA(,)c Fw(status)h FA(and)g Fw(request)i
FA(argumen)o(ts)d(in)h(the)h(same)e(w)o(a)o(y)h(as)g(the)h(standard-mo)
q(de)f(send)249 939 y(and)e(receiv)o(e)h(op)q(erations.)249
1022 y Fs(2.13.1)48 b(Blo)q(c)o(king)14 b(Calls)208 1176
y Fw(MPI)p 285 1176 13 2 v 14 w(BSEND)g(\(buf,)g(count,)g(datat)o(yp)q
(e,)h(dest,)f(tag,)f(comm\))332 1251 y Fv(IN)158 b Fw(buf)491
b Fv(initial)16 b(address)e(of)f(send)h(bu\013er)332
1300 y(IN)158 b Fw(count)450 b Fv(n)o(um)o(b)q(er)14
b(of)f(en)o(tries)h(in)g(send)f(bu\013er)332 1350 y(IN)158
b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14 b(of)f(eac)o(h)g(send)h
(bu\013er)g(en)o(try)332 1400 y(IN)158 b Fw(dest)476
b Fv(rank)14 b(of)f(destination)332 1450 y(IN)158 b Fw(tag)490
b Fv(message)14 b(tag)332 1500 y(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)249 1610 y Fr(int)21 b(MPI)p 405
1610 14 2 v 15 w(Bsend\(void*)f(buf,)h(int)g(count,)g(MPI)p
1097 1610 V 15 w(Datatype)f(datatype,)g(int)h(dest,)540
1664 y(int)g(tag,)g(MPI)p 805 1664 V 15 w(Comm)g(comm\))249
1748 y(MPI)p 318 1748 V 15 w(BSEND\(BUF,)f(COUNT,)g(DATATYPE,)g(DEST,)h
(TAG,)g(COMM,)g(IERROR\))336 1802 y(<type>)g(BUF\(*\))336
1856 y(INTEGER)g(COUNT,)f(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(IERROR)291
1940 y Fw(MPI)p 368 1940 13 2 v 14 w(BSEND)14 b FA(p)q(erforms)f(a)h
(bu\013ered-mo)q(de,)f(blo)q(c)o(king)g(send.)249 2064
y Fw(MPI)p 326 2064 V 14 w(SSEND)i(\(buf,)f(count,)g(datat)o(yp)q(e,)h
(dest,)f(tag,)f(comm\))332 2139 y Fv(IN)158 b Fw(buf)491
b Fv(initial)16 b(address)e(of)f(send)h(bu\013er)332
2189 y(IN)158 b Fw(count)450 b Fv(n)o(um)o(b)q(er)14
b(of)f(en)o(tries)h(in)g(send)f(bu\013er)332 2239 y(IN)158
b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14 b(of)f(eac)o(h)g(send)h
(bu\013er)g(en)o(try)332 2289 y(IN)158 b Fw(dest)476
b Fv(rank)14 b(of)f(destination)332 2338 y(IN)158 b Fw(tag)490
b Fv(message)14 b(tag)332 2388 y(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)249 2498 y Fr(int)21 b(MPI)p 405
2498 14 2 v 15 w(Ssend\(void*)f(buf,)h(int)g(count,)g(MPI)p
1097 2498 V 15 w(Datatype)f(datatype,)g(int)h(dest,)p
eop
%%Page: 91 105
91 104 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15
b(Comm)o(unication)940 b(91)540 507 y Fr(int)21 b(tag,)g(MPI)p
805 507 14 2 v 15 w(Comm)g(comm\))249 591 y(MPI)p 318
591 V 15 w(SSEND\(BUF,)f(COUNT,)g(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g
(IERROR\))336 645 y(<type>)g(BUF\(*\))336 699 y(INTEGER)g(COUNT,)f
(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(IERROR)291 783 y
Fw(MPI)p 368 783 13 2 v 14 w(SSEND)14 b FA(p)q(erforms)f(a)h(sync)o
(hronous-mo)q(de,)f(blo)q(c)o(king)g(send.)249 908 y
Fw(MPI)p 326 908 V 14 w(RSEND)h(\(buf,)g(count,)h(datat)o(yp)q(e,)g
(dest,)f(tag,)f(comm\))332 983 y Fv(IN)158 b Fw(buf)491
b Fv(initial)16 b(address)e(of)f(send)h(bu\013er)332
1032 y(IN)158 b Fw(count)450 b Fv(n)o(um)o(b)q(er)14
b(of)f(en)o(tries)h(in)g(send)f(bu\013er)332 1082 y(IN)158
b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14 b(of)f(eac)o(h)g(send)h
(bu\013er)g(en)o(try)332 1132 y(IN)158 b Fw(dest)476
b Fv(rank)14 b(of)f(destination)332 1182 y(IN)158 b Fw(tag)490
b Fv(message)14 b(tag)332 1232 y(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)249 1342 y Fr(int)21 b(MPI)p 405
1342 14 2 v 15 w(Rsend\(void*)f(buf,)h(int)g(count,)g(MPI)p
1097 1342 V 15 w(Datatype)f(datatype,)g(int)h(dest,)540
1396 y(int)g(tag,)g(MPI)p 805 1396 V 15 w(Comm)g(comm\))249
1480 y(MPI)p 318 1480 V 15 w(RSEND\(BUF,)f(COUNT,)g(DATATYPE,)g(DEST,)h
(TAG,)g(COMM,)g(IERROR\))336 1534 y(<type>)g(BUF\(*\))336
1588 y(INTEGER)g(COUNT,)f(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(IERROR)291
1672 y Fw(MPI)p 368 1672 13 2 v 14 w(RSEND)14 b FA(p)q(erforms)f(a)h
(ready-mo)q(de,)e(blo)q(c)o(king)h(send.)249 1755 y Fs(2.13.2)48
b(Non)o(blo)q(c)o(king)13 b(Calls)249 1838 y FA(W)m(e)f(use)h(the)g
(same)f(naming)e(con)o(v)o(en)o(tions)i(as)h(for)f(blo)q(c)o(king)f
(comm)o(unication:)j(a)e(pre\014x)h(of)f Fw(B)p FA(,)249
1892 y Fw(S)p FA(,)e(or)f Fw(R)h FA(is)g(used)h(for)e(bu\013ered,)j
(sync)o(hronous)f(or)f(ready)g(mo)q(de.)16 b(In)10 b(addition,)f(a)g
(pre\014x)i(of)e Fw(I)h FA(\(for)249 1946 y(immediate\))j(indicates)k
(that)f(the)h(call)f(is)g(non)o(blo)q(c)o(king.)23 b(There)18
b(is)e(only)f(one)i(non)o(blo)q(c)o(king)249 2000 y(receiv)o(e)c(call,)
e Fw(MPI)p 546 2000 V 14 w(IRECV)p FA(.)f(Non)o(blo)q(c)o(king)g(send)j
(op)q(erations)f(are)g(completed)g(with)f(the)h(same)249
2054 y(W)m(ait)h(and)g(T)m(est)i(calls)e(as)h(for)g(standard-mo)q(de)f
(send.)p eop
%%Page: 92 106
92 105 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(92)1275 b(Chapter)13 b(2)249
507 y Fw(MPI)p 326 507 13 2 v 14 w(IBSEND\(buf,)h(count,)g(datat)o(yp)q
(e,)h(dest,)f(tag,)f(comm,)f(request\))332 582 y Fv(IN)158
b Fw(buf)491 b Fv(initial)16 b(address)e(of)f(send)h(bu\013er)332
632 y(IN)158 b Fw(count)450 b Fv(n)o(um)o(b)q(er)14 b(of)f(elemen)o(ts)
h(in)g(send)f(bu\013er)332 682 y(IN)158 b Fw(datat)o(yp)q(e)397
b Fv(datat)o(yp)q(e)14 b(of)f(eac)o(h)g(send)h(bu\013er)g(elemen)o(t)
332 731 y(IN)158 b Fw(dest)476 b Fv(rank)14 b(of)f(destination)332
781 y(IN)158 b Fw(tag)490 b Fv(message)14 b(tag)332 831
y(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)332 881 y(OUT)114
b Fw(request)423 b Fv(request)14 b(handle)249 991 y Fr(int)21
b(MPI)p 405 991 14 2 v 15 w(Ibsend\(void*)f(buf,)h(int)g(count,)f(MPI)p
1118 991 V 15 w(Datatype)h(datatype,)e(int)j(dest,)540
1045 y(int)f(tag,)g(MPI)p 805 1045 V 15 w(Comm)g(comm,)g(MPI)p
1126 1045 V 15 w(Request)f(*request\))249 1129 y(MPI)p
318 1129 V 15 w(IBSEND\(BUF,)g(COUNT,)g(DATATYPE,)g(DEST,)h(TAG,)g
(COMM,)g(REQUEST,)f(IERROR\))336 1183 y(<type>)h(BUF\(*\))336
1237 y(INTEGER)g(COUNT,)f(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(REQUEST,)f
(IERROR)291 1321 y Fw(MPI)p 368 1321 13 2 v 14 w(IBSEND)13
b FA(p)q(osts)i(a)e(bu\013ered-mo)q(de,)h(non)o(blo)q(c)o(king)f(send.)
249 1446 y Fw(MPI)p 326 1446 V 14 w(ISSEND\(buf,)h(count,)h(datat)o(yp)
q(e,)f(dest,)h(tag,)e(comm,)e(request\))332 1520 y Fv(IN)158
b Fw(buf)491 b Fv(initial)16 b(address)e(of)f(send)h(bu\013er)332
1570 y(IN)158 b Fw(count)450 b Fv(n)o(um)o(b)q(er)14
b(of)f(elemen)o(ts)h(in)g(send)f(bu\013er)332 1620 y(IN)158
b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14 b(of)f(eac)o(h)g(send)h
(bu\013er)g(elemen)o(t)332 1670 y(IN)158 b Fw(dest)476
b Fv(rank)14 b(of)f(destination)332 1720 y(IN)158 b Fw(tag)490
b Fv(message)14 b(tag)332 1769 y(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)332 1819 y(OUT)114 b Fw(request)423
b Fv(request)14 b(handle)249 1929 y Fr(int)21 b(MPI)p
405 1929 14 2 v 15 w(Issend\(void*)f(buf,)h(int)g(count,)f(MPI)p
1118 1929 V 15 w(Datatype)h(datatype,)e(int)j(dest,)540
1983 y(int)f(tag,)g(MPI)p 805 1983 V 15 w(Comm)g(comm,)g(MPI)p
1126 1983 V 15 w(Request)f(*request\))249 2067 y(MPI)p
318 2067 V 15 w(ISSEND\(BUF,)g(COUNT,)g(DATATYPE,)g(DEST,)h(TAG,)g
(COMM,)g(REQUEST,)f(IERROR\))336 2121 y(<type>)h(BUF\(*\))336
2175 y(INTEGER)g(COUNT,)f(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(REQUEST,)f
(IERROR)291 2259 y Fw(MPI)p 368 2259 13 2 v 14 w(ISSEND)14
b FA(p)q(osts)g(a)g(sync)o(hronous-mo)q(de,)f(non)o(blo)q(c)o(king)g
(send.)p eop
%%Page: 93 107
93 106 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15
b(Comm)o(unication)940 b(93)249 507 y Fw(MPI)p 326 507
13 2 v 14 w(IRSEND\(buf,)14 b(count,)h(datat)o(yp)q(e,)f(dest,)g(tag,)f
(comm,)f(request\))332 582 y Fv(IN)158 b Fw(buf)491 b
Fv(initial)16 b(address)e(of)f(send)h(bu\013er)332 630
y(IN)158 b Fw(count)450 b Fv(n)o(um)o(b)q(er)14 b(of)f(elemen)o(ts)h
(in)g(send)f(bu\013er)332 677 y(IN)158 b Fw(datat)o(yp)q(e)397
b Fv(datat)o(yp)q(e)14 b(of)f(eac)o(h)g(send)h(bu\013er)g(elemen)o(t)
332 725 y(IN)158 b Fw(dest)476 b Fv(rank)14 b(of)f(destination)332
773 y(IN)158 b Fw(tag)490 b Fv(message)14 b(tag)332 821
y(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)332 868 y(OUT)114
b Fw(request)423 b Fv(request)14 b(handle)249 978 y Fr(int)21
b(MPI)p 405 978 14 2 v 15 w(Irsend\(void*)f(buf,)h(int)g(count,)f(MPI)p
1118 978 V 15 w(Datatype)h(datatype,)e(int)j(dest,)540
1032 y(int)f(tag,)g(MPI)p 805 1032 V 15 w(Comm)g(comm,)g(MPI)p
1126 1032 V 15 w(Request)f(*request\))249 1116 y(MPI)p
318 1116 V 15 w(IRSEND\(BUF,)g(COUNT,)g(DATATYPE,)g(DEST,)h(TAG,)g
(COMM,)g(REQUEST,)f(IERROR\))336 1170 y(<type>)h(BUF\(*\))336
1224 y(INTEGER)g(COUNT,)f(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(REQUEST,)f
(IERROR)291 1308 y Fw(MPI)p 368 1308 13 2 v 14 w(IRSEND)13
b FA(p)q(osts)i(a)f(ready-mo)q(de,)e(non)o(blo)q(c)o(king)h(send.)249
1391 y Fs(2.13.3)48 b(P)o(ersisten)n(t)13 b(Requests)208
1545 y Fw(MPI)p 285 1545 V 14 w(BSEND)p 434 1545 V 15
w(INIT\(buf,)h(count,)g(datat)o(yp)q(e,)h(dest,)f(tag,)f(comm,)e
(request\))332 1620 y Fv(IN)158 b Fw(buf)491 b Fv(initial)16
b(address)e(of)f(send)h(bu\013er)332 1668 y(IN)158 b
Fw(count)450 b Fv(n)o(um)o(b)q(er)14 b(of)f(en)o(tries)h(to)f(send)332
1715 y(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14
b(of)f(eac)o(h)g(en)o(try)332 1763 y(IN)158 b Fw(dest)476
b Fv(rank)14 b(of)f(destination)332 1811 y(IN)158 b Fw(tag)490
b Fv(message)14 b(tag)332 1859 y(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)332 1906 y(OUT)114 b Fw(request)423
b Fv(request)14 b(handle)249 2016 y Fr(int)21 b(MPI)p
405 2016 14 2 v 15 w(Bsend)p 530 2016 V 15 w(init\(void*)f(buf,)h(int)g
(count,)f(MPI)p 1199 2016 V 15 w(Datatype)h(datatype,)540
2070 y(int)g(dest,)g(int)g(tag,)g(MPI)p 1023 2070 V 15
w(Comm)g(comm,)g(MPI)p 1344 2070 V 15 w(Request)f(*request\))249
2154 y(MPI)p 318 2154 V 15 w(BSEND)p 443 2154 V 15 w(INIT\(BUF,)g
(COUNT,)g(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(REQUEST,)540
2208 y(IERROR\))336 2262 y(<type>)g(BUF\(*\))336 2316
y(INTEGER)g(REQUEST,)f(COUNT,)g(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g
(REQUEST,)336 2370 y(IERROR)291 2454 y Fw(MPI)p 368 2454
13 2 v 14 w(BSEND)p 517 2454 V 15 w(INIT)g FA(creates)j(a)e(p)q
(ersisten)o(t)h(comm)o(unication)c(request)k(for)f(a)f(bu\013ered-)249
2508 y(mo)q(de,)12 b(non)o(blo)q(c)o(king)h(send,)h(and)g(binds)g(to)g
(it)f(all)g(the)h(argumen)o(ts)g(of)f(a)g(send)i(op)q(eration.)p
eop
%%Page: 94 108
94 107 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(94)1275 b(Chapter)13 b(2)249
507 y Fw(MPI)p 326 507 13 2 v 14 w(SSEND)p 470 507 V
16 w(INIT\(buf,)g(count,)i(datat)o(yp)q(e,)g(dest,)f(tag,)f(comm,)e
(request\))332 582 y Fv(IN)158 b Fw(buf)491 b Fv(initial)16
b(address)e(of)f(send)h(bu\013er)332 632 y(IN)158 b Fw(count)450
b Fv(n)o(um)o(b)q(er)14 b(of)f(en)o(tries)h(to)f(send)332
682 y(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14
b(of)f(eac)o(h)g(en)o(try)332 731 y(IN)158 b Fw(dest)476
b Fv(rank)14 b(of)f(destination)332 781 y(IN)158 b Fw(tag)490
b Fv(message)14 b(tag)332 831 y(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)332 881 y(OUT)114 b Fw(request)423
b Fv(request)14 b(handle)249 991 y Fr(int)21 b(MPI)p
405 991 14 2 v 15 w(Ssend)p 530 991 V 15 w(init\(void*)f(buf,)h(int)g
(count,)f(MPI)p 1199 991 V 15 w(Datatype)h(datatype,)540
1045 y(int)g(dest,)g(int)g(tag,)g(MPI)p 1023 1045 V 15
w(Comm)g(comm,)g(MPI)p 1344 1045 V 15 w(Request)f(*request\))249
1129 y(MPI)p 318 1129 V 15 w(SSEND)p 443 1129 V 15 w(INIT\(BUF,)g
(COUNT,)g(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(REQUEST,)540
1183 y(IERROR\))336 1237 y(<type>)g(BUF\(*\))336 1291
y(INTEGER)g(COUNT,)f(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(REQUEST,)f
(IERROR)291 1375 y Fw(MPI)p 368 1375 13 2 v 14 w(SSEND)p
512 1375 V 15 w(INIT)15 b FA(creates)i(a)e(p)q(ersisten)o(t)j(comm)o
(uni)o(cation)12 b(ob)r(ject)17 b(for)e(a)g(sync)o(hronous-)249
1429 y(mo)q(de,)d(non)o(blo)q(c)o(king)h(send,)h(and)g(binds)g(to)g(it)
f(all)g(the)h(argumen)o(ts)g(of)f(a)g(send)i(op)q(eration.)249
1554 y Fw(MPI)p 326 1554 V 14 w(RSEND)p 474 1554 V 15
w(INIT\(buf,)f(count,)h(datat)o(yp)q(e,)f(dest,)h(tag,)e(comm,)e
(request\))332 1628 y Fv(IN)158 b Fw(buf)491 b Fv(initial)16
b(address)e(of)f(send)h(bu\013er)332 1678 y(IN)158 b
Fw(count)450 b Fv(n)o(um)o(b)q(er)14 b(of)f(en)o(tries)h(to)f(send)332
1728 y(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14
b(of)f(eac)o(h)g(en)o(try)332 1778 y(IN)158 b Fw(dest)476
b Fv(rank)14 b(of)f(destination)332 1828 y(IN)158 b Fw(tag)490
b Fv(message)14 b(tag)332 1877 y(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)332 1927 y(OUT)114 b Fw(request)423
b Fv(request)14 b(handle)249 2037 y Fr(int)21 b(MPI)p
405 2037 14 2 v 15 w(Rsend)p 530 2037 V 15 w(init\(void*)f(buf,)h(int)g
(count,)f(MPI)p 1199 2037 V 15 w(Datatype)h(datatype,)540
2091 y(int)g(dest,)g(int)g(tag,)g(MPI)p 1023 2091 V 15
w(Comm)g(comm,)g(MPI)p 1344 2091 V 15 w(Request)f(*request\))249
2175 y(MPI)p 318 2175 V 15 w(RSEND)p 443 2175 V 15 w(INIT\(BUF,)g
(COUNT,)g(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(REQUEST,)540
2229 y(IERROR\))336 2283 y(<type>)g(BUF\(*\))336 2337
y(INTEGER)g(COUNT,)f(DATATYPE,)g(DEST,)h(TAG,)g(COMM,)g(REQUEST,)f
(IERROR)291 2421 y Fw(MPI)p 368 2421 13 2 v 14 w(RSEND)p
516 2421 V 15 w(INIT)c FA(creates)i(a)e(p)q(ersisten)o(t)i(comm)o
(unication)13 b(ob)r(ject)18 b(for)e(a)g(ready-mo)q(de,)249
2475 y(non)o(blo)q(c)o(king)d(send,)h(and)g(binds)g(to)f(it)h(all)f
(the)h(argumen)o(ts)f(of)g(a)h(send)h(op)q(eration.)p
eop
%%Page: 95 109
95 108 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15
b(Comm)o(unication)940 b(95)249 507 y Fs(Example)15 b(2.33)21
b FA(Use)15 b(of)e(ready-mo)q(de)g(and)h(sync)o(hronous-mo)q(de)249
561 y Fr(INTEGER)20 b(req\(2\),)h(status\(MPI_STATU)o(S_SIZ)o(E,2\),)d
(comm,)j(ierr)249 615 y(REAL)g(buff\(1000,2\))249 669
y(...)249 723 y(CALL)g(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))249
777 y(IF)g(\(rank.EQ.0\))f(THEN)314 831 y(CALL)h
(MPI_IRECV\(buff\(1,1\))o(,)e(1000,)i(MPI_REAL,)f(1,)h(1,)925
885 y(comm,)f(req\(1\),)h(ierr\))314 939 y(CALL)g
(MPI_IRECV\(buff\(1,2\))o(,)e(1000,)i(MPI_REAL,)f(1,)h(2,)925
993 y(comm,)f(req\(2\),)h(ierr\))314 1047 y(CALL)g(MPI_WAITALL\(2,)e
(req,)i(status,)g(ierr\))249 1101 y(ELSE)g(IF)g(\(rank.EQ.1\))f(THEN)
314 1155 y(CALL)h(MPI_SSEND\(buff\(1,2\))o(,)e(1000,)i(MPI_REAL,)f(0,)h
(2,)816 1209 y(comm,)f(status\(1,1\),)g(ierr\))314 1263
y(CALL)h(MPI_RSEND\(buff\(1,1\))o(,)e(1000,)i(MPI_REAL,)f(0,)h(1,)816
1317 y(comm,)f(status\(1,2\),)g(ierr\))249 1371 y(END)h(IF)249
1425 y FA(The)f(\014rst,)i(sync)o(hronous-mo)q(de)d(send)i(of)e(pro)q
(cess)j(one)d(matc)o(hes)h(the)g(second)h(receiv)o(e)g(of)249
1479 y(pro)q(cess)f(zero.)30 b(This)17 b(send)i(op)q(eration)e(will)f
(complete)h(only)g(after)h(the)g(second)h(receiv)o(e)g(of)249
1533 y(pro)q(cess)13 b(zero)f(has)f(started,)h(and)f(after)g(the)h
(completion)d(of)h(the)i(\014rst)g(p)q(ost-receiv)o(e)g(of)f(pro)q
(cess)249 1587 y(zero.)19 b(Therefore,)14 b(the)g(second,)g(ready-mo)q
(de)e(send)i(of)e(pro)q(cess)j(one)f(starts,)g(correctly)m(,)f(after)
249 1641 y(a)h(matc)o(hing)e(receiv)o(e)j(is)f(p)q(osted.)249
1736 y Fs(2.13.4)48 b(Bu\013er)15 b(Allo)q(cation)e(and)i(Usage)249
1819 y FA(An)20 b(application)f(m)o(ust)g(sp)q(ecify)i(a)f(bu\013er)h
(to)f(b)q(e)g(used)h(for)f(bu\013ering)h(messages)f(sen)o(t)h(in)249
1873 y(bu\013ered)15 b(mo)q(de.)i(Bu\013ering)e(is)f(done)g(b)o(y)g
(the)g(sender.)249 1998 y Fw(MPI)p 326 1998 13 2 v 14
w(BUFFER)p 497 1998 V 13 w(A)m(TT)m(A)o(CH\()f(bu\013er,)i(size\))332
2073 y Fv(IN)158 b Fw(bu\013er)448 b Fv(initial)16 b(bu\013er)e
(address)332 2122 y(IN)158 b Fw(size)484 b Fv(bu\013er)14
b(size,)g(in)f(b)o(ytes)249 2233 y Fr(int)21 b(MPI)p
405 2233 14 2 v 15 w(Buffer)p 552 2233 V 15 w(attach\()f(void*)h
(buffer,)f(int)h(size\))249 2316 y(MPI)p 318 2316 V 15
w(BUFFER)p 465 2316 V 15 w(ATTACH\()f(BUFFER,)g(SIZE,)h(IERROR\))336
2370 y(<type>)g(BUFFER\(*\))336 2424 y(INTEGER)g(SIZE,)f(IERROR)p
eop
%%Page: 96 110
96 109 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(96)1275 b(Chapter)13 b(2)291
507 y Fw(MPI)p 368 507 13 2 v 14 w(BUFFER)p 539 507 V
13 w(A)m(TT)m(A)o(CH)g FA(pro)o(vides)h(to)g Fw(MPI)g
FA(a)g(bu\013er)h(in)f(the)h(application's)e(memory)f(to)249
561 y(b)q(e)j(used)g(for)f(bu\013ering)g(outgoing)f(messages.)19
b(The)c(bu\013er)g(is)f(used)h(only)e(b)o(y)h(messages)h(sen)o(t)249
615 y(in)e(bu\013ered)j(mo)q(de.)h(Only)d(one)g(bu\013er)g(can)h(b)q(e)
f(attac)o(hed)h(at)e(a)h(time)e(\(p)q(er)j(pro)q(cess\).)249
740 y Fw(MPI)p 326 740 V 14 w(BUFFER)p 497 740 V 13 w(DET)m(A)o(CH\()e
(bu\013er,)j(size\))332 815 y Fv(OUT)114 b Fw(bu\013er)448
b Fv(initial)16 b(bu\013er)e(address)332 865 y(OUT)114
b Fw(size)484 b Fv(bu\013er)14 b(size,)g(in)f(b)o(ytes)249
975 y Fr(int)21 b(MPI)p 405 975 14 2 v 15 w(Buffer)p
552 975 V 15 w(detach\()f(void*)h(buffer,)f(int*)h(size\))249
1059 y(MPI)p 318 1059 V 15 w(BUFFER)p 465 1059 V 15 w(DETACH\()f
(BUFFER,)g(SIZE,)h(IERROR\))336 1113 y(<type>)g(BUFFER\(*\))336
1167 y(INTEGER)g(SIZE,)f(IERROR)291 1251 y Fw(MPI)p 368
1251 13 2 v 14 w(BUFFER)p 539 1251 V 13 w(DET)m(A)o(CH)15
b FA(detac)o(hes)j(the)f(bu\013er)g(curren)o(tly)g(asso)q(ciated)g
(with)f Fw(MPI)p FA(.)f(The)249 1305 y(call)i(returns)h(the)g(address)h
(and)e(the)h(size)g(of)f(the)h(detac)o(hed)g(bu\013er.)30
b(This)17 b(op)q(eration)g(will)249 1359 y(blo)q(c)o(k)11
b(un)o(til)g(all)f(messages)i(curren)o(tly)h(in)e(the)h(bu\013er)h(ha)o
(v)o(e)e(b)q(een)i(transmitted.)k(Up)q(on)11 b(return)249
1412 y(of)i(this)h(function,)f(the)i(user)g(ma)o(y)d(reuse)j(or)f
(deallo)q(cate)g(the)g(space)h(tak)o(en)f(b)o(y)g(the)h(bu\013er.)249
1508 y Fs(Example)g(2.34)21 b FA(Calls)13 b(to)h(attac)o(h)g(and)f
(detac)o(h)i(bu\013ers.)249 1562 y Fr(#define)20 b(BUFFSIZE)h(10000)249
1616 y(int)g(size)249 1670 y(char)g(*buff;)249 1724 y(buff)g(=)h
(\(char)e(*\)malloc\(BUFFSIZE\);)249 1778 y(MPI_Buffer_attach\()o
(buff,)e(BUFFSIZE\);)249 1832 y(/*)j(a)h(buffer)f(of)g(10000)g(bytes)f
(can)i(now)f(be)g(used)g(by)h(MPI_Bsend)d(*/)249 1886
y(MPI_Buffer_detach\()f(&buff,)j(&size\);)249 1940 y(/*)g(Buffer)g
(size)g(reduced)f(to)i(zero)f(*/)249 1994 y(MPI_Buffer_attach\()d
(buff,)j(size\);)249 2048 y(/*)g(Buffer)g(of)g(10000)g(bytes)g
(available)f(again)h(*/)249 2197 y FB(A)n(dvic)n(e)15
b(to)g(users.)39 b FA(Ev)o(en)15 b(though)f(the)h(C)g(functions)f
Fw(MPI)p 1196 2197 V 14 w(Bu\013er)p 1315 2197 V 16 w(attach)h
FA(and)f Fw(MPI)p 1611 2197 V 15 w(Bu\013er-)p 249 2251
V 262 2251 a(detach)20 b FA(b)q(oth)f(ha)o(v)o(e)g(a)g(\014rst)h
(argumen)o(t)e(of)g(t)o(yp)q(e)i Fq(void*)p FA(,)f(these)i(argumen)o
(ts)d(are)h(used)h(dif-)249 2305 y(feren)o(tly:)f(A)14
b(p)q(oin)o(ter)g(to)g(the)h(bu\013er)g(is)f(passed)h(to)f
Fw(MPI)p 1149 2305 V 15 w(Bu\013er)p 1269 2305 V 16 w(attach)p
FA(;)g(the)h(address)g(of)f(the)249 2359 y(p)q(oin)o(ter)d(is)f(passed)
h(to)g Fw(MPI)p 680 2359 V 14 w(Bu\013er)p 799 2359 V
16 w(detach)p FA(,)h(so)f(that)f(this)h(call)f(can)g(return)i(the)f(p)q
(oin)o(ter)g(v)n(alue.)249 2413 y(\()p FB(End)16 b(of)f(advic)n(e)g(to)
g(users.)p FA(\))p eop
%%Page: 97 111
97 110 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15
b(Comm)o(unication)940 b(97)249 507 y FB(R)n(ationale.)39
b FA(Both)14 b(argumen)o(ts)g(are)g(de\014ned)i(to)e(b)q(e)g(of)g(t)o
(yp)q(e)h Fq(void*)e FA(\(rather)i(than)f Fq(void*)g
FA(and)249 561 y Fq(void**)p FA(,)g(resp)q(ectiv)o(ely\),)j(so)e(as)g
(to)g(a)o(v)o(oid)e(complex)h(t)o(yp)q(e)i(casts.)22
b(E.g.,)14 b(in)h(the)g(last)g(example,)249 615 y Fw(&bu\013)p
FA(,)g(whic)o(h)f(is)g(of)g(t)o(yp)q(e)h Fq(cha)o(r**)p
FA(,)f(can)g(b)q(e)h(passed)g(as)g(an)e(argumen)o(t)h(to)f
Fw(MPI)p 1495 615 13 2 v 15 w(Bu\013er)p 1615 615 V 16
w(detach)249 669 y FA(without)f(t)o(yp)q(e)h(casting.)k(If)12
b(the)h(formal)d(parameter)i(had)g(t)o(yp)q(e)h Fq(void**)e
FA(then)i(one)g(w)o(ould)e(need)249 723 y(a)j(t)o(yp)q(e)g(cast)h(b)q
(efore)f(and)g(after)g(the)h(call.)i(\()p FB(End)f(of)e(r)n(ationale.)p
FA(\))291 814 y(No)o(w)h(the)h(question)f(arises:)22
b(ho)o(w)15 b(is)h(the)g(attac)o(hed)g(bu\013er)g(to)g(b)q(e)g(used?)24
b(The)15 b(answ)o(er)i(is)249 868 y(that)f Fw(MPI)f FA(m)o(ust)g(b)q
(eha)o(v)o(e)i FB(as)g(if)24 b FA(outgoing)15 b(message)h(data)f(w)o
(ere)i(bu\013ered)h(b)o(y)e(the)g(sending)249 922 y(pro)q(cess,)h(in)d
(the)h(sp)q(eci\014ed)i(bu\013er)f(space,)f(using)g(a)g(circular,)f
(con)o(tiguous-space)i(allo)q(cation)249 976 y(p)q(olicy)m(.)29
b(W)m(e)18 b(outline)f(b)q(elo)o(w)h(a)g(mo)q(del)e(implemen)o(tation)f
(that)j(de\014nes)h(this)f(p)q(olicy)m(.)29 b Fw(MPI)249
1030 y FA(ma)o(y)11 b(pro)o(vide)h(more)g(bu\013ering,)h(and)f(ma)o(y)f
(use)i(a)g(b)q(etter)h(bu\013er)f(allo)q(cation)e(algorithm)f(than)249
1084 y(describ)q(ed)15 b(b)q(elo)o(w.)i(On)c(the)h(other)f(hand,)g
Fw(MPI)f FA(ma)o(y)f(signal)h(an)g(error)i(whenev)o(er)g(the)g(simple)
249 1138 y(bu\013ering)g(allo)q(cator)f(describ)q(ed)j(b)q(elo)o(w)e(w)
o(ould)f(run)h(out)g(of)f(space.)249 1221 y Fs(2.13.5)48
b(Mo)q(del)15 b(Implemen)o(tati)o(on)d(of)k(Bu\013ered)e(Mo)q(de)249
1304 y FA(The)h(mo)q(del)d(implemen)o(tatio)o(n)f(uses)16
b(the)e(pac)o(king)g(and)g(unpac)o(king)f(functions)h(describ)q(ed)i
(in)249 1358 y(Section)d(3.8)f(and)h(the)g(non)o(blo)q(c)o(king)f(comm)
o(uni)o(cation)e(functions)j(describ)q(ed)h(in)f(Section)g(2.8.)291
1412 y(W)m(e)c(assume)g(that)h(a)g(circular)g(queue)g(of)g(p)q(ending)g
(message)f(en)o(tries)i(\(PME\))f(is)g(main)o(tained.)249
1466 y(Eac)o(h)i(en)o(try)g(con)o(tains)g(a)f(comm)o(unication)d
(request)14 b(that)d(iden)o(ti\014es)i(a)e(p)q(ending)h(non)o(blo)q(c)o
(king)249 1520 y(send,)18 b(a)f(p)q(oin)o(ter)h(to)f(the)g(next)h(en)o
(try)g(and)f(the)g(pac)o(k)o(ed)h(message)f(data.)27
b(The)18 b(en)o(tries)g(are)249 1574 y(stored)i(in)e(successiv)o(e)j
(lo)q(cations)d(in)g(the)i(bu\013er.)33 b(F)m(ree)20
b(space)g(is)e(a)o(v)n(ailable)f(b)q(et)o(w)o(een)j(the)249
1628 y(queue)15 b(tail)e(and)g(the)i(queue)g(head.)291
1682 y(A)f(bu\013ered)h(send)g(call)e(results)i(in)e(the)i(execution)f
(of)g(the)g(follo)o(wing)d(algorithm.)249 1765 y Ft(\017)29
b FA(T)m(ra)o(v)o(erse)18 b(sequen)o(tially)f(the)i(PME)f(queue)g(from)
e(head)i(to)o(w)o(ards)g(the)g(tail,)f(deleting)h(all)249
1819 y(en)o(tries)k(for)e(comm)o(unicatio)o(ns)e(that)j(ha)o(v)o(e)f
(completed,)i(up)e(to)h(the)g(\014rst)g(en)o(try)g(with)g(an)249
1873 y(uncompleted)14 b(request;)h(up)q(date)f(queue)h(head)f(to)g(p)q
(oin)o(t)f(to)h(that)g(en)o(try)m(.)249 1927 y Ft(\017)29
b FA(Compute)20 b(the)i(n)o(um)o(b)q(er,)g Fw(n)p FA(,)h(of)e(b)o(ytes)
h(needed)h(to)e(store)h(en)o(tries)h(for)e(the)g(new)h(mes-)249
1981 y(sage.)29 b(An)17 b(upp)q(er)h(b)q(ound)g(on)f
Fw(n)g FA(can)h(b)q(e)g(computed)e(as)i(follo)o(ws:)23
b(A)17 b(call)g(to)g(the)h(function)249 2035 y Fw(MPI)p
326 2035 V 14 w(P)m(A)o(CK)p 447 2035 V 13 w(SIZE\(count,)12
b(datat)o(yp)q(e,)g(comm,)d(size\))p FA(,)j(with)e(the)h
Fr(count,)21 b(datatype)9 b FA(and)h Fr(comm)249 2089
y FA(argumen)o(ts)16 b(used)i(in)f(the)g Fw(MPI)p 755
2089 V 14 w(BSEND)g FA(call,)g(returns)h(an)f(upp)q(er)h(b)q(ound)f(on)
g(the)g(amoun)o(t)249 2143 y(of)f(space)i(needed)g(to)e(bu\013er)i(the)
f(message)f(data)h(\(see)h(Section)f(3.8\).)25 b(The)17
b(MPI)g(constan)o(t)249 2197 y Fq(MPI)p 321 2197 12 2
v 13 w(BSEND)p 459 2197 V 13 w(O)o(VERHEAD)11 b FA(pro)o(vides)g(an)f
(upp)q(er)i(b)q(ound)f(on)g(the)g(additional)e(space)j(consumed)249
2251 y(b)o(y)i(the)g(en)o(try)h(\(e.g.,)d(for)i(p)q(oin)o(ters)h(or)e
(en)o(v)o(elop)q(e)i(information\).)249 2305 y Ft(\017)29
b FA(Find)10 b(the)i(next)f(con)o(tiguous,)f(empt)o(y)g(space)i(of)e
Fw(n)h FA(b)o(ytes)h(in)e(bu\013er)i(\(space)f(follo)o(wing)e(queue)249
2359 y(tail,)14 b(or)h(space)g(at)g(start)h(of)e(bu\013er)i(if)e(queue)
i(tail)d(is)i(to)q(o)g(close)g(to)g(end)g(of)g(bu\013er\).)22
b(If)14 b(space)249 2413 y(is)g(not)g(found)f(then)i(raise)f(bu\013er)h
(o)o(v)o(er\015o)o(w)e(error.)249 2467 y Ft(\017)29 b
FA(Cop)o(y)9 b(request,)i(next)f(p)q(oin)o(ter)f(and)g(pac)o(k)o(ed)h
(message)f(data)g(in)o(to)f(empt)o(y)h(space;)i Fw(MPI)p
1634 2467 13 2 v 14 w(P)m(A)o(CK)p eop
%%Page: 98 112
98 111 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(98)1275 b(Chapter)13 b(2)249
507 y FA(is)h(used)h(to)e(pac)o(k)h(data.)k(Set)c(p)q(oin)o(ters)h(so)f
(that)g(this)g(en)o(try)g(is)g(at)g(tail)e(of)i(PME)g(queue.)249
561 y Ft(\017)29 b FA(P)o(ost)14 b(non)o(blo)q(c)o(king)f(send)h
(\(standard)h(mo)q(de\))e(for)g(pac)o(k)o(ed)i(data.)249
615 y Ft(\017)29 b FA(Return)249 698 y Fs(2.13.6)48 b(Commen)o(ts)14
b(on)h(Comm)o(unication)e(Mo)q(des)249 781 y FB(A)n(dvic)n(e)i(to)g
(users.)36 b FA(When)14 b(should)g(one)g(use)h(eac)o(h)f(mo)q(de?)249
852 y(Most)f(of)f(the)i(time,)d(it)i(is)g(preferable)g(to)g(use)h(the)f
(standard-mo)q(de)f(send:)19 b(implemen)o(ters)11 b(are)249
906 y(lik)o(ely)i(to)g(pro)o(vide)h(the)h(b)q(est)g(and)e(most)g
(robust)h(p)q(erformance)g(for)g(this)g(mo)q(de.)249
976 y(Users)f(that)e(do)g(not)g(trust)h(the)g(bu\013ering)f(p)q(olicy)g
(of)g(standard-mo)q(de)f(ma)o(y)f(use)j(the)g(bu\013ered-)249
1030 y(mo)q(de,)g(and)g(con)o(trol)h(bu\013er)h(allo)q(cation)d
(themselv)o(es.)18 b(With)13 b(this)g(authorit)o(y)f(comes)h(resp)q
(on-)249 1084 y(sibilit)o(y:)k(it)c(is)h(the)g(user)h(resp)q(onsibilit)
o(y)f(to)f(ensure)j(that)e(bu\013ers)h(nev)o(er)g(o)o(v)o(er\015o)o(w.)
249 1155 y(The)g(sync)o(hronous)h(mo)q(de)e(is)g(con)o(v)o(enien)o(t)h
(in)f(cases)i(where)g(an)f(ac)o(kno)o(wledgmen)o(t)e(w)o(ould)h(b)q(e)
249 1209 y(otherwise)e(required,)g(e.g.,)e(when)h(comm)o(unication)d
(with)i(rendezv)o(ous)j(seman)o(tics)d(is)h(desired.)249
1263 y(Also,)i(use)h(of)e(the)i(sync)o(hronous-mo)q(de)f(is)g(a)g(hin)o
(t)f(to)h(the)h(system)f(that)g(bu\013ering)h(should)f(b)q(e)249
1317 y(a)o(v)o(oided,)g(since)h(the)h(sender)g(cannot)f(progress)i(an)o
(yho)o(w,)c(ev)o(en)j(if)e(the)h(data)g(is)f(bu\013ered.)249
1387 y(The)18 b(ready-mo)q(de)e(is)h(error)h(prone)f(and)g(should)g(b)q
(e)g(used)h(with)f(care.)28 b(\()p FB(End)19 b(of)e(advic)n(e)h(to)249
1441 y(users.)p FA(\))249 1533 y FB(A)n(dvic)n(e)e(to)f(implementors.)
41 b FA(Since)15 b(a)g(sync)o(hronous-mo)q(de)f(send)i(cannot)f
(complete)f(b)q(efore)249 1587 y(a)e(matc)o(hing)e(receiv)o(e)k(is)e(p)
q(osted,)h(one)g(will)d(not)i(normally)e(bu\013er)j(messages)g(sen)o(t)
g(b)o(y)f(suc)o(h)h(an)249 1641 y(op)q(eration.)249 1711
y(It)i(is)g(usually)f(preferable)i(to)f(c)o(ho)q(ose)g(bu\013ering)h(o)
o(v)o(er)f(blo)q(c)o(king)f(the)h(sender,)i(for)d(standard-)249
1765 y(mo)q(de)k(sends.)36 b(The)20 b(programmer)d(can)j(get)g(the)g
(non-bu\013ered)h(proto)q(col)e(b)o(y)g(using)g(syn-)249
1819 y(c)o(hronous)c(mo)q(de.)249 1890 y(A)c(p)q(ossible)h(c)o(hoice)f
(of)g(comm)o(unication)d(proto)q(cols)j(for)g(the)h(v)n(arious)e(comm)o
(unication)e(mo)q(des)249 1944 y(is)14 b(outlined)f(b)q(elo)o(w.)249
2014 y Fw(standa)o(rd-mo)q(de)g(send:)19 b FA(Short)13
b(proto)q(col)f(is)h(used)g(for)f(short)i(messages,)e(and)g(long)g
(proto)q(col)h(is)249 2068 y(used)i(for)e(long)g(messages)h(\(see)i
(Figure)e(2.5,)e(page)i(66\).)249 2139 y Fw(ready-mo)q(de)g(send)p
FA(:)19 b(The)13 b(message)g(is)g(sen)o(t)h(with)f(the)h(short)f(proto)
q(col)g(\(that)h(is,)e(ready-mo)q(de)249 2193 y(messages)i(are)g(alw)o
(a)o(ys)f(\\short"\).)249 2263 y Fw(synchronous-mo)q(de)h(send:)19
b FA(The)13 b(long)f(proto)q(col)g(is)h(used)g(\(that)g(is,)g(sync)o
(hronous-mo)q(de)f(mes-)249 2317 y(sages)j(are)f(alw)o(a)o(ys)f
(\\long"\).)249 2388 y Fw(bu\013ered-mo)q(de)23 b(send:)32
b FA(The)20 b(send)i(copies)f(the)f(message)h(in)o(to)e(the)i
(application-pro)o(vided)249 2442 y(bu\013er)15 b(and)f(then)g(sends)h
(it)f(with)f(a)h(standard-mo)q(de,)f(non)o(blo)q(c)o(king)f(send.)p
eop
%%Page: 99 113
99 112 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(P)o(oin)o(t-to-P)o(oin)o(t)15
b(Comm)o(unication)940 b(99)249 507 y FA(Ready-mo)q(de)11
b(send)j(can)f(b)q(e)g(implemen)o(ted)d(as)j(a)g(standard-mo)q(de)f
(send.)18 b(In)13 b(this)f(case)i(there)249 561 y(will)c(b)q(e)h(no)g
(p)q(erformance)g(adv)n(an)o(tage)f(\(or)h(disadv)n(an)o(tage\))f(for)h
(the)h(use)f(of)g(ready-mo)q(de)f(send.)249 632 y(A)j(standard-mo)q(de)
f(send)i(could)f(b)q(e)h(implem)o(en)o(ted)d(as)i(a)g(sync)o
(hronous-mo)q(de)g(send,)g(so)g(that)249 686 y(no)e(data)g(bu\013ering)
g(is)g(needed.)19 b(This)11 b(is)g(consisten)o(t)h(with)f(the)g
Fw(MPI)g FA(sp)q(eci\014cation.)17 b(Ho)o(w)o(ev)o(er,)249
740 y(man)o(y)c(users)k(w)o(ould)d(b)q(e)i(surprised)h(b)o(y)e(this)g
(c)o(hoice,)h(since)g(standard-mo)q(de)e(is)h(the)h(natural)249
794 y(place)e(for)g(system-pro)o(vided)f(bu\013ering.)19
b(\()p FB(End)c(of)g(advic)n(e)g(to)g(implementors.)p
FA(\))p eop
%%Page: 100 114
100 113 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(100)1256 b(Chapter)13 b(2)p
eop
%%Page: 101 115
101 114 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 325 a Fu(3)25 b FD(User-De\014ned)17
b(Datat)o(yp)q(es)h(and)g(P)o(ac)o(king)249 628 y(3.1)52
b(In)o(tro)q(duction)249 736 y FA(The)12 b Fw(MPI)e FA(comm)o
(unication)e(mec)o(hanisms)i(in)o(tro)q(duced)i(in)e(the)i(previous)g
(c)o(hapter)g(allo)o(ws)e(one)249 790 y(to)g(send)h(or)g(receiv)o(e)g
(a)f(sequence)j(of)d(iden)o(tical)f(elemen)o(ts)h(that)h(are)g(con)o
(tiguous)f(in)f(memory)m(.)14 b(It)249 844 y(is)e(often)f(desirable)h
(to)g(send)h(data)e(that)h(is)f(not)h(homogeneous,)e(suc)o(h)j(as)f(a)f
(structure,)j(or)d(that)249 897 y(is)i(not)g(con)o(tiguous)f(in)h
(memory)m(,)d(suc)o(h)j(as)g(an)g(arra)o(y)g(section.)18
b(This)13 b(allo)o(ws)f(one)h(to)g(amortize)249 951 y(the)g(\014xed)f
(o)o(v)o(erhead)h(of)f(sending)g(and)g(receiving)h(a)e(message)h(o)o(v)
o(er)h(the)f(transmittal)f(of)g(man)o(y)249 1005 y(elemen)o(ts,)h(ev)o
(en)i(in)e(these)i(more)d(general)i(circumstances.)19
b Fw(MPI)11 b FA(pro)o(vides)i(t)o(w)o(o)f(mec)o(hanisms)249
1059 y(to)i(ac)o(hiev)o(e)g(this.)208 1150 y Ft(\017)20
b FA(The)h(user)g(can)g(de\014ne)g FB(derive)n(d)f FA(datat)o(yp)q(es,)
i(that)f(sp)q(ecify)g(more)e(general)i(data)f(la)o(y)o(outs.)249
1204 y(User-de\014ned)f(datat)o(yp)q(es)e(can)g(b)q(e)h(used)g(in)e
Fw(MPI)g FA(comm)o(unication)d(functions,)18 b(in)e(place)h(of)249
1258 y(the)e(basic,)e(prede\014ned)j(datat)o(yp)q(es.)208
1326 y Ft(\017)k FA(A)13 b(sending)h(pro)q(cess)h(can)e(explicitly)f
(pac)o(k)h(noncon)o(tiguous)g(data)g(in)o(to)f(a)h(con)o(tiguous)g
(bu\013er,)249 1380 y(and)h(next)h(send)g(it;)f(a)g(receiving)h(pro)q
(cess)h(can)f(explicitly)e(unpac)o(k)i(data)f(receiv)o(ed)h(in)f(a)g
(con-)249 1434 y(tiguous)g(bu\013er)g(and)g(store)h(in)e(noncon)o
(tiguous)h(lo)q(cations.)291 1524 y(The)c(construction)h(and)e(use)i
(of)e(deriv)o(ed)h(datat)o(yp)q(es)h(is)e(describ)q(ed)j(in)d(Section)h
(3.2-3.7.)15 b(The)249 1578 y(use)e(of)f(P)o(ac)o(k)g(and)g(Unpac)o(k)h
(functions)f(is)g(describ)q(ed)i(in)e(Section)h(3.8.)j(It)d(is)f(often)
g(p)q(ossible)h(to)249 1632 y(ac)o(hiev)o(e)i(the)h(same)e(data)g
(transfer)i(using)f(either)h(mec)o(hanisms.)j(W)m(e)c(discuss)h(the)f
(pros)h(and)249 1686 y(cons)f(of)e(eac)o(h)h(approac)o(h)g(at)g(the)g
(end)h(of)e(this)h(c)o(hapter.)249 1807 y FD(3.2)52 b(In)o(tro)q
(duction)19 b(to)f(User-De\014ned)f(Datat)o(yp)q(es)249
1914 y FA(All)d Fw(MPI)g FA(comm)o(unicatio)o(n)e(functions)j(tak)o(e)f
(a)h(datat)o(yp)q(e)g(argumen)o(t.)k(In)c(the)g(simplest)e(case)249
1968 y(this)i(will)f(b)q(e)h(a)g(primitiv)o(e)e(t)o(yp)q(e,)i(suc)o(h)g
(as)h(an)e(in)o(teger)i(or)f(\015oating-p)q(oin)o(t)e(n)o(um)o(b)q(er.)
20 b(An)c(im-)249 2022 y(p)q(ortan)o(t)d(and)g(p)q(o)o(w)o(erful)f
(generalization)g(results)i(b)o(y)f(allo)o(wing)d(user-de\014ned)15
b(\(or)e(\\deriv)o(ed"\))249 2076 y(t)o(yp)q(es)i(wherev)o(er)h(the)f
(primitiv)o(e)e(t)o(yp)q(es)i(can)g(o)q(ccur.)20 b(These)c(are)f(not)f
(\\t)o(yp)q(es")h(as)f(far)g(as)h(the)249 2130 y(programming)d
(language)j(is)h(concerned.)27 b(They)16 b(are)g(only)f(\\t)o(yp)q(es")
i(in)e(that)h Fw(MPI)g FA(is)g(made)249 2184 y(a)o(w)o(are)i(of)g(them)
g(through)g(the)h(use)h(of)e(t)o(yp)q(e-constructor)i(functions,)f(and)
g(they)g(describ)q(e)249 2238 y(the)14 b(la)o(y)o(out,)d(in)i(memory)m
(,)d(of)j(sets)h(of)f(primitiv)o(e)d(t)o(yp)q(es.)19
b(Through)13 b(user-de\014ned)i(t)o(yp)q(es,)f Fw(MPI)249
2292 y FA(supp)q(orts)g(the)g(comm)o(unicati)o(on)c(of)j(complex)e
(data)i(structures)i(suc)o(h)f(as)f(arra)o(y)g(sections)h(and)249
2346 y(structures)g(con)o(taining)d(com)o(binations)f(of)h(primitiv)o
(e)f(datat)o(yp)q(es.)18 b(Example)10 b(3.1)h(sho)o(ws)h(ho)o(w)249
2400 y(a)i(user-de\014ned)i(datat)o(yp)q(e)e(is)g(used)h(to)f(send)h
(the)g(upp)q(er-triangular)f(part)g(of)g(a)g(matrix,)e(and)249
2454 y(Figure)j(3.1)f(diagrams)e(the)k(memory)c(la)o(y)o(out)h
(represen)o(ted)18 b(b)o(y)d(the)g(user-de\014ned)i(datat)o(yp)q(e.)965
2613 y(101)p eop
%%Page: 102 116
102 115 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(102)1256 b(Chapter)13 b(3)249
507 y Fs(Example)i(3.1)21 b Fw(MPI)13 b FA(co)q(de)i(that)f(sends)h(an)
f(upp)q(er)g(triangular)f(matrix.)249 561 y Fr(double)21
b(a[100][100])249 615 y(disp[100],blocklen)o([100])o(,i;)249
669 y(MPI_Datatype)e(upper;)249 723 y(...)271 777 y(/*)i(compute)g
(start)f(and)i(size)e(of)i(each)f(row)g(*/)249 831 y(for)g(\(i=0;)g
(i<100;)g(++i\))g({)314 885 y(disp[i])g(=)g(100)h(*)f(i)h(+)f(i;)314
939 y(blocklen[i])f(=)i(100)f(-)g(i;)249 993 y(})271
1047 y(/*)g(create)g(datatype)f(for)h(upper)g(triangular)f(part)h(*/)
249 1101 y(MPI_Type_indexed\(1)o(00,)e(blocklen,)g(disp,)i(MPI_DOUBLE,)
f(&upper\);)249 1155 y(MPI_Type_commit\(&u)o(pper\))o(;)271
1209 y(/*)h(..)h(and)f(send)g(it)g(*/)249 1263 y(MPI_Send\(a,)f(1,)h
(upper,)g(dest,)f(tag,)h(MPI_COMM_WORLD\);)553 1363 y
 14208860 9662020 0 0 26049576 17826856 startTexFig

553 1363 a
%%BeginDocument: ../figures/derived-upper.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
 /DrawEllipse {
	/endangle exch def
	/startangle exch def
	/yrad exch def
	/xrad exch def
	/y exch def
	/x exch def
	/savematrix mtrx currentmatrix def
	x y translate xrad yrad scale 0 0 1 startangle endangle arc
	savematrix setmatrix
	} def

	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-90.0 342.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Ellipse
n 291 316 4 4 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 316 341 4 4 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 539 379 m 539 99 l  99 99 l  99 379 l  clp gs col-1 s gr
% Polyline
n 539 139 m 539 99 l  99 99 l  99 139 l  clp gs 0.75 setgray fill gr
gs col-1 s gr
% Polyline
n 539 179 m 539 139 l  139 139 l  139 179 l  clp gs 0.75 setgray fill gr
gs col-1 s gr
% Polyline
n 539 219 m 539 179 l  179 179 l  179 219 l  clp gs 0.75 setgray fill gr
gs col-1 s gr
% Polyline
n 539 259 m 539 219 l  219 219 l  219 259 l  clp gs 0.75 setgray fill gr
gs col-1 s gr
% Ellipse
n 266 291 4 4 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 299 84 m 399 84 l gs 0.00 setgray fill gr
gs col-1 s gr
n 391.000 82.000 m 399.000 84.000 l 391.000 86.000 l gs 2 setlinejoin col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
164 89 m 
gs 1 -1 scale (consecutive address) col-1 show gr
/Times-Roman findfont 14.00 scalefont setfont
104 124 m 
gs 1 -1 scale ([0][0]) col-1 show gr
/Times-Roman findfont 14.00 scalefont setfont
144 124 m 
gs 1 -1 scale ([0][1]) col-1 show gr
/Times-Roman findfont 14.00 scalefont setfont
184 124 m 
gs 1 -1 scale ([0][2]) col-1 show gr
/Times-Roman findfont 14.00 scalefont setfont
144 164 m 
gs 1 -1 scale ([1][1]) col-1 show gr
/Times-Roman findfont 14.00 scalefont setfont
184 164 m 
gs 1 -1 scale ([1][2]) col-1 show gr
/Times-Roman findfont 14.00 scalefont setfont
184 204 m 
gs 1 -1 scale ([2][2]) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 2038 a Fo(Figure)13 b(3.1)249 2075 y Fz(A)f(diagram)d(of)h(the)h
(memory)e(cells)h(represen)o(ted)e(b)o(y)j(the)f(user-de\014ned)e
(datat)o(yp)q(e)g Fl(upper)p Fz(.)14 b(The)d(shaded)f(cells)249
2112 y(are)h(the)g(lo)q(cations)e(of)i(the)g(arra)o(y)f(that)g(will)i
(b)q(e)f(sen)o(t.)291 2213 y FA(Deriv)o(ed)16 b(datat)o(yp)q(es)h(are)f
(constructed)i(from)d(basic)h(datat)o(yp)q(es)h(using)f(the)g
(constructors)249 2267 y(describ)q(ed)g(in)d(Section)h(3.3.)j(The)e
(constructors)h(can)e(b)q(e)g(applied)g(recursiv)o(ely)m(.)291
2321 y(A)g Fs(deriv)o(ed)f(datat)o(yp)q(e)g FA(is)g(an)h(opaque)g(ob)r
(ject)g(that)g(sp)q(eci\014es)i(t)o(w)o(o)e(things:)249
2404 y Ft(\017)29 b FA(A)14 b(sequence)i(of)d(primitiv)o(e)f(datat)o
(yp)q(es)i(and,)249 2458 y Ft(\017)29 b FA(A)14 b(sequence)i(of)d(in)o
(teger)h(\(b)o(yte\))h(displacemen)o(ts.)p eop
%%Page: 103 117
103 116 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(103)291 507 y FA(The)11 b(displacemen)o(ts)f(are)h
(not)g(required)h(to)e(b)q(e)i(p)q(ositiv)o(e,)e(distinct,)h(or)g(in)f
(increasing)h(order.)249 561 y(Therefore,)j(the)f(order)g(of)f(items)g
(need)i(not)e(coincide)h(with)f(their)h(order)h(in)e(memory)m(,)d(and)k
(an)249 615 y(item)f(ma)o(y)f(app)q(ear)j(more)e(than)i(once.)k(W)m(e)
13 b(call)g(suc)o(h)h(a)f(pair)g(of)f(sequences)k(\(or)e(sequence)h(of)
249 669 y(pairs\))g(a)f Fs(t)o(yp)q(e)i(map)p FA(.)21
b(The)15 b(sequence)i(of)d(primitiv)o(e)f(datat)o(yp)q(es)i
(\(displacemen)o(ts)f(ignored\))249 723 y(is)g(the)g
Fs(t)o(yp)q(e)h(signature)d FA(of)h(the)h(datat)o(yp)q(e.)291
777 y(Let)291 831 y Fp(T)6 b(y)q(pemap)12 b FA(=)g Ft(f)p
FA(\()p Fp(ty)q(pe)630 837 y Fk(0)650 831 y Fp(;)7 b(disp)745
837 y Fk(0)763 831 y FA(\))p Fp(;)g(:)g(:)g(:)e(;)i FA(\()p
Fp(ty)q(pe)964 837 y Fj(n)p Fm(\000)p Fk(1)1030 831 y
Fp(;)g(disp)1125 837 y Fj(n)p Fm(\000)p Fk(1)1190 831
y FA(\))p Ft(g)p Fp(;)249 885 y FA(b)q(e)15 b(suc)o(h)g(a)f(t)o(yp)q(e)
g(map,)e(where)k Fp(ty)q(pe)829 891 y Fj(i)857 885 y
FA(are)f(primitiv)o(e)d(t)o(yp)q(es,)j(and)f Fp(disp)1384
891 y Fj(i)1412 885 y FA(are)g(displacemen)o(ts.)249
939 y(Let)291 993 y Fp(T)6 b(y)q(pesig)14 b FA(=)e Ft(f)p
Fp(ty)q(pe)590 999 y Fk(0)609 993 y Fp(;)7 b(:)g(:)g(:)e(;)i(ty)q(pe)
778 999 y Fj(n)p Fm(\000)p Fk(1)844 993 y Ft(g)249 1047
y FA(b)q(e)19 b(the)g(asso)q(ciated)h(t)o(yp)q(e)f(signature.)32
b(This)19 b(t)o(yp)q(e)g(map,)f(together)h(with)g(a)f(base)h(address)
249 1101 y FB(buf)p FA(,)f(sp)q(eci\014es)h(a)e(comm)o(unication)d
(bu\013er:)26 b(the)18 b(comm)o(unication)c(bu\013er)k(that)g(consists)
g(of)249 1155 y Fp(n)g FA(en)o(tries,)h(where)g(the)f
Fp(i)p FA(-th)g(en)o(try)h(is)e(at)h(address)h Fp(buf)d
FA(+)c Fp(disp)1288 1161 y Fj(i)1320 1155 y FA(and)18
b(has)g(t)o(yp)q(e)g Fp(ty)q(pe)1656 1161 y Fj(i)1671
1155 y FA(.)29 b(A)249 1209 y(message)17 b(assem)o(bled)f(from)f(a)i
(single)f(t)o(yp)q(e)h(of)g(this)g(sort)g(will)e(consist)j(of)e
Fp(n)h FA(v)n(alues,)g(of)f(the)249 1263 y(t)o(yp)q(es)f(de\014ned)g(b)
o(y)e Fp(T)6 b(y)q(pesig)q FA(.)291 1317 y(A)14 b(handle)h(to)f(a)g
(deriv)o(ed)i(datat)o(yp)q(e)e(can)h(app)q(ear)g(as)g(an)f(argumen)o(t)
g(in)g(a)g(send)i(or)e(receiv)o(e)249 1371 y(op)q(eration,)c(instead)g
(of)g(a)f(primitiv)o(e)f(datat)o(yp)q(e)i(argumen)o(t.)16
b(The)10 b(op)q(eration)g Fw(MPI)p 1541 1371 13 2 v 14
w(SEND\(buf,)249 1425 y(1,)17 b(datat)o(yp)q(e,)p Fp(:)7
b(:)g(:)f Fw(\))18 b FA(will)d(use)j(the)g(send)g(bu\013er)g(de\014ned)
g(b)o(y)f(the)g(base)h(address)g Fw(buf)g FA(and)f(the)249
1479 y(deriv)o(ed)12 b(datat)o(yp)q(e)g(asso)q(ciated)g(with)f
Fw(datat)o(yp)q(e)p FA(.)19 b(It)11 b(will)f(generate)j(a)e(message)h
(with)f(the)h(t)o(yp)q(e)249 1533 y(signature)17 b(determined)g(b)o(y)g
(the)g Fw(datat)o(yp)q(e)h FA(argumen)o(t.)26 b Fw(MPI)p
1242 1533 V 14 w(RECV\(buf,)16 b(1,)h(datat)o(yp)q(e,)p
Fp(:)7 b(:)g(:)f Fw(\))249 1587 y FA(will)11 b(use)i(the)g(receiv)o(e)g
(bu\013er)h(de\014ned)f(b)o(y)f(the)h(base)g(address)h
Fw(buf)e FA(and)g(the)h(deriv)o(ed)g(datat)o(yp)q(e)249
1641 y(asso)q(ciated)i(with)e Fw(datat)o(yp)q(e)p FA(.)291
1694 y(Deriv)o(ed)i(datat)o(yp)q(es)h(can)f(b)q(e)h(used)g(in)f(all)f
(send)i(and)g(receiv)o(e)g(op)q(erations)g(including)e(col-)249
1748 y(lectiv)o(e.)k(W)m(e)12 b(discuss,)h(in)f(Section)h(3.4.3,)d(the)
j(case)g(where)h(the)e(second)i(argumen)o(t)d Fw(count)i
FA(has)249 1802 y(v)n(alue)g Fp(>)f FA(1.)291 1856 y(The)i(primitiv)o
(e)d(datat)o(yp)q(es)k(presen)o(ted)h(in)d(Section)h(2.2.2)e(are)i(sp)q
(ecial)g(cases)h(of)e(a)h(deriv)o(ed)249 1910 y(datat)o(yp)q(e,)g(and)h
(are)g(prede\014ned.)21 b(Th)o(us,)14 b Fq(MPI)p 994
1910 12 2 v 13 w(INT)h FA(is)f(a)g(prede\014ned)i(handle)f(to)f(a)g
(datat)o(yp)q(e)249 1964 y(with)j(t)o(yp)q(e)g(map)e
Ft(f)p FA(\()p Fw(int)p Fp(;)7 b FA(0\))p Ft(g)p FA(,)17
b(with)f(one)h(en)o(try)h(of)e(t)o(yp)q(e)h Fw(int)g
FA(and)g(displacemen)o(t)f(zero.)28 b(The)249 2018 y(other)15
b(primitiv)o(e)c(datat)o(yp)q(es)k(are)f(similar.)291
2072 y(The)j Fs(exten)o(t)e FA(of)i(a)f(datat)o(yp)q(e)i(is)e
(de\014ned)j(to)d(b)q(e)i(the)g(span)f(from)e(the)j(\014rst)g(b)o(yte)f
(to)g(the)249 2126 y(last)i(b)o(yte)h(o)q(ccupied)g(b)o(y)f(en)o(tries)
h(in)f(this)g(datat)o(yp)q(e,)h(rounded)g(up)g(to)f(satisfy)g(alignmen)
o(t)249 2180 y(requiremen)o(ts.)37 b(That)14 b(is,)f(if)291
2234 y Fp(T)6 b(y)q(pemap)12 b FA(=)g Ft(f)p FA(\()p
Fp(ty)q(pe)630 2240 y Fk(0)650 2234 y Fp(;)7 b(disp)745
2240 y Fk(0)763 2234 y FA(\))p Fp(;)g(:)g(:)g(:)e(;)i
FA(\()p Fp(ty)q(pe)964 2240 y Fj(n)p Fm(\000)p Fk(1)1030
2234 y Fp(;)g(disp)1125 2240 y Fj(n)p Fm(\000)p Fk(1)1190
2234 y FA(\))p Ft(g)p Fp(;)249 2288 y FA(then)335 2375
y Fp(l)q(b)p FA(\()p Fp(T)f(y)q(pemap)p FA(\))43 b(=)f(min)712
2401 y Fj(j)761 2375 y Fp(disp)837 2381 y Fj(j)855 2375
y Fp(;)325 2459 y(ub)p FA(\()p Fp(T)6 b(y)q(pemap)p FA(\))42
b(=)g(max)716 2485 y Fj(j)763 2459 y FA(\()p Fp(disp)855
2465 y Fj(j)882 2459 y FA(+)9 b Fp(siz)r(eof)t FA(\()p
Fp(ty)q(pe)1132 2465 y Fj(j)1153 2459 y FA(\)\))g(+)h
Fp(\017;)20 b FA(and)p eop
%%Page: 104 118
104 117 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(104)1256 b(Chapter)13 b(3)249
507 y Fp(extent)p FA(\()p Fp(T)6 b(y)q(pemap)p FA(\))43
b(=)f Fp(ub)p FA(\()p Fp(T)6 b(y)q(pemap)p FA(\))11 b
Ft(\000)e Fp(l)q(b)p FA(\()p Fp(T)d(y)q(pemap)p FA(\))p
Fp(:)249 588 y FA(where)15 b Fp(j)f FA(=)e(0)p Fp(;)7
b(:)g(:)g(:)t(;)g(n)h Ft(\000)h FA(1.)17 b Fp(l)q(b)d
FA(is)f(the)h Fs(lo)o(w)o(er)g(b)q(ound)e FA(and)h Fp(ub)g
FA(is)g(the)h Fs(upp)q(er)g(b)q(ound)e FA(of)h(the)249
642 y(datat)o(yp)q(e.)65 b(If)14 b Fp(ty)q(pe)604 648
y Fj(i)634 642 y FA(requires)i(alignmen)o(t)d(to)i(a)f(b)o(yte)i
(address)g(that)f(is)g(a)g(m)o(ultiple)d(of)j Fp(k)1719
648 y Fj(i)1732 642 y FA(,)249 696 y(then)e Fp(\017)g
FA(is)f(the)h(least)g(nonnegativ)o(e)f(incremen)o(t)g(needed)i(to)e
(round)h Fp(extent)p FA(\()p Fp(T)6 b(y)q(pemap)p FA(\))14
b(to)f(the)249 750 y(next)h(m)o(ultiple)e(of)h(max)630
756 y Fj(i)650 750 y Fp(k)672 756 y Fj(i)686 750 y FA(.)18
b(\(The)c(de\014nition)g(of)f(exten)o(t)i(is)f(expanded)g(in)g(Section)
g(3.6.\))249 837 y Fs(Example)h(3.2)21 b FA(Assume)c(that)h
Fp(T)6 b(y)q(pe)19 b FA(=)f Ft(f)p FA(\()p Fw(double)q
Fp(;)7 b FA(0\))p Fp(;)g FA(\()p Fw(cha)o(r)q Fp(;)g
FA(8\))p Ft(g)16 b FA(\(a)i Fw(double)h FA(at)e(displace-)249
891 y(men)o(t)e(zero,)j(follo)o(w)o(ed)d(b)o(y)h(a)g
Fw(cha)o(r)h FA(at)f(displacemen)o(t)g(eigh)o(t\).)25
b(Assume,)17 b(furthermore,)f(that)249 945 y(doubles)f(ha)o(v)o(e)g(to)
f(b)q(e)h(strictly)g(aligned)f(at)h(addresses)h(that)f(are)g(m)o
(ultiples)e(of)h(eigh)o(t.)20 b(Then,)249 999 y(the)14
b(exten)o(t)g(of)e(this)h(datat)o(yp)q(e)g(is)g(16)g(\(9)g(rounded)g
(to)g(the)h(next)f(m)o(ultiple)e(of)h(8\).)18 b(A)13
b(datat)o(yp)q(e)249 1053 y(that)19 b(consists)h(of)e(a)h(c)o(haracter)
h(immedia)o(tely)c(follo)o(w)o(ed)h(b)o(y)i(a)g(double)f(will)g(also)g
(ha)o(v)o(e)h(an)249 1107 y(exten)o(t)c(of)e(16.)249
1194 y FB(R)n(ationale.)37 b FA(The)13 b(rounding)g(term)g(that)g(app)q
(ears)h(in)f(the)h(de\014nition)f(of)g(upp)q(er)h(b)q(ound)f(is)h(to)
249 1248 y(facilitate)h(the)h(de\014nition)f(of)g(datat)o(yp)q(es)h
(that)g(corresp)q(ond)h(to)f(arra)o(ys)f(of)g(structures.)26
b(The)249 1302 y(exten)o(t)14 b(of)e(a)g(datat)o(yp)q(e)h(de\014ned)h
(to)f(describ)q(e)h(a)f(structure)i(will)c(b)q(e)i(the)h(exten)o(t)f
(of)f(memory)f(a)249 1356 y(compiler)i(will)f(normally)f(allo)q(cate)j
(for)f(this)h(structure)i(en)o(try)f(in)e(an)h(arra)o(y)m(.)249
1425 y(More)f(explicit)f(con)o(trol)g(of)f(the)i(exten)o(t)h(is)e
(describ)q(ed)i(in)e(Section)h(3.6.)j(Suc)o(h)d(explicit)f(con)o(trol)
249 1479 y(is)18 b(needed)h(in)f(cases)h(where)g(this)f(assumption)f
(do)q(es)h(not)g(hold,)g(for)g(example,)f(where)i(the)249
1533 y(compiler)13 b(o\013ers)h(di\013eren)o(t)h(alignmen)o(t)d
(options)h(for)h(structures.)20 b(\()p FB(End)c(of)f(r)n(ationale.)p
FA(\))249 1623 y FB(A)n(dvic)n(e)j(to)g(implementors.)57
b FA(Implemen)o(tors)15 b(should)j(pro)o(vide)f(information)d(on)j(the)
h(\\de-)249 1677 y(fault")12 b(alignmen)o(t)e(option)i(used)h(b)o(y)g
(the)g Fw(MPI)f FA(library)g(to)g(de\014ne)i(upp)q(er)g(b)q(ound)e(and)
h(exten)o(t.)249 1731 y(This)h(should)g(matc)o(h,)e(whenev)o(er)j(p)q
(ossible,)f(the)g(\\default")f(alignmen)o(t)f(option)h(of)g(the)i(com-)
249 1785 y(piler.)j(\()p FB(End)e(of)e(advic)n(e)i(to)e(implementors.)p
FA(\))291 1874 y(The)g(follo)o(wing)d(functions)j(return)h(information)
c(on)j(datat)o(yp)q(es.)249 1999 y Fw(MPI)p 326 1999
13 2 v 14 w(TYPE)p 448 1999 V 15 w(EXTENT\(datat)o(yp)q(e,)h(extent\))
332 2074 y Fv(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)332
2122 y(OUT)114 b Fw(extent)440 b Fv(datat)o(yp)q(e)14
b(exten)o(t)249 2232 y Fr(int)21 b(MPI)p 405 2232 14
2 v 15 w(Type)p 508 2232 V 15 w(extent\(MPI)p 743 2232
V 14 w(Datatype)f(datatype,)g(MPI)p 1237 2232 V 15 w(Aint)h(*extent\))
249 2316 y(MPI)p 318 2316 V 15 w(TYPE)p 421 2316 V 15
w(EXTENT\(DATATYPE,)d(EXTENT,)j(IERROR\))336 2370 y(INTEGER)g
(DATATYPE,)f(EXTENT,)g(IERROR)291 2454 y Fw(MPI)p 368
2454 13 2 v 14 w(TYPE)p 490 2454 V 14 w(EXTENT)12 b FA(returns)h(the)f
(exten)o(t)h(of)e(a)g(datat)o(yp)q(e.)17 b(In)12 b(addition)e(to)i(its)
f(use)i(with)249 2508 y(deriv)o(ed)e(datat)o(yp)q(es,)h(it)e(can)g(b)q
(e)i(used)f(to)g(inquire)f(ab)q(out)g(the)h(exten)o(t)h(of)e(primitiv)o
(e)e(datat)o(yp)q(es.)p eop
%%Page: 105 119
105 118 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(105)249 507 y FA(F)m(or)15 b(example,)e
Fw(MPI)p 577 507 13 2 v 15 w(TYPE)p 700 507 V 14 w(EXTENT\(MPI)p
968 507 V 14 w(INT,)i(extent\))i FA(will)c(return)j(in)f
Fw(extent)h FA(the)g(size,)249 561 y(in)11 b(b)o(ytes,)h(of)e(an)h
Fr(int)f FA({)h(the)h(same)e(v)n(alue)h(that)g(w)o(ould)f(b)q(e)i
(returned)h(b)o(y)d(the)i(C)f(call)g Fw(sizeof\(int\))p
FA(.)249 653 y FB(A)n(dvic)n(e)i(to)g(users.)35 b FA(Since)12
b(datat)o(yp)q(es)h(in)e Fw(MPI)g FA(are)i(opaque)f(handles,)g(it)f(is)
h(imp)q(ortan)o(t)e(to)i(use)249 707 y(the)e(function)g
Fw(MPI)p 552 707 V 14 w(TYPE)p 674 707 V 14 w(EXTENT)g
FA(to)g(determine)g(the)g(\\size")g(of)f(the)i(datat)o(yp)q(e.)16
b(As)11 b(an)e(ex-)249 760 y(ample,)h(it)i(ma)o(y)f(b)q(e)h(tempting)f
(\(in)h(C\))g(to)g(use)h Fw(sizeof\(datat)o(yp)q(e\))p
FA(,)h(e.g.,)d Fw(sizeof\()p Fq(MPI)p 1553 760 12 2 v
13 w(DOUBLE)p Fw(\))p FA(.)249 814 y(Ho)o(w)o(ev)o(er,)18
b(this)f(will)e(return)j(the)g(size)f(of)g(the)g(opaque)g(handle,)g
(whic)o(h)g(is)g(most)e(lik)o(ely)h(the)249 868 y(size)g(of)f(a)f(p)q
(oin)o(ter,)i(and)f(usually)f(a)h(di\013eren)o(t)h(v)n(alue)f(than)g
Fw(sizeof\(double\))p FA(.)23 b(\()p FB(End)17 b(of)f(advic)n(e)249
922 y(to)f(users.)p FA(\))249 1085 y Fw(MPI)p 326 1085
13 2 v 14 w(TYPE)p 448 1085 V 15 w(SIZE\(datat)o(yp)q(e,)f(size\))332
1159 y Fv(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)332
1209 y(OUT)114 b Fw(size)484 b Fv(datat)o(yp)q(e)14 b(size)249
1319 y Fr(int)21 b(MPI)p 405 1319 14 2 v 15 w(Type)p
508 1319 V 15 w(size\(MPI)p 699 1319 V 14 w(Datatype)f(datatype,)g(int)
h(*size\))249 1403 y(MPI)p 318 1403 V 15 w(TYPE)p 421
1403 V 15 w(SIZE\(DATATYPE,)e(SIZE,)i(IERROR\))336 1457
y(INTEGER)g(DATATYPE,)f(SIZE,)g(IERROR)291 1541 y Fw(MPI)p
368 1541 13 2 v 14 w(TYPE)p 490 1541 V 14 w(SIZE)d FA(returns)h(the)g
(total)e(size,)i(in)f(b)o(ytes,)h(of)e(the)i(en)o(tries)g(in)f(the)g(t)
o(yp)q(e)h(sig-)249 1595 y(nature)h(asso)q(ciated)f(with)g
Fw(datat)o(yp)q(e)p FA(;)j(that)d(is,)g(the)h(total)e(size)i(of)e(the)i
(data)f(in)f(a)h(message)249 1649 y(that)13 b(w)o(ould)g(b)q(e)h
(created)g(with)f(this)g(datat)o(yp)q(e.)18 b(En)o(tries)c(that)g(o)q
(ccur)g(m)o(ultiple)d(times)h(in)h(the)249 1703 y(datat)o(yp)q(e)f(are)
h(coun)o(ted)f(with)g(their)g(m)o(ultiplicit)o(y)m(.)i(F)m(or)d
(primitiv)o(e)f(datat)o(yp)q(es,)j(this)f(function)249
1757 y(returns)k(the)e(same)f(information)e(as)j Fw(MPI)p
921 1757 V 14 w(TYPE)p 1043 1757 V 14 w(EXTENT)p FA(.)249
1852 y Fs(Example)h(3.3)21 b FA(Let)11 b Fw(datat)o(yp)q(e)i
FA(ha)o(v)o(e)e(the)g(T)o(yp)q(e)h(map)d FB(T)m(yp)n(e)i
FA(de\014ned)h(in)e(Example)g(3.2.)16 b(Then)249 1906
y(a)c(call)f(to)g Fw(MPI)p 481 1906 V 15 w(TYPE)p 604
1906 V 14 w(EXTENT\(datat)o(yp)q(e,)i(i\))f FA(will)e(return)j
Fr(i)22 b(=)f(16)p FA(;)12 b(a)f(call)g(to)h Fw(MPI)p
1595 1906 V 14 w(TYPE)p 1717 1906 V 15 w(-)249 1960 y(SIZE\(datat)o(yp)
q(e,)j(i\))f FA(will)e(return)j Fr(i)22 b(=)f(9)p FA(.)249
2081 y FD(3.3)52 b(Datat)o(yp)q(e)19 b(Constructors)249
2189 y FA(This)e(section)h(presen)o(ts)g(the)g Fw(MPI)e
FA(functions)h(for)g(constructing)h(deriv)o(ed)f(datat)o(yp)q(es.)28
b(The)249 2243 y(functions)14 b(are)g(presen)o(ted)i(in)e(an)f(order)i
(from)d(simplest)h(to)h(most)e(complex.)p eop
%%Page: 106 120
106 119 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(106)1256 b(Chapter)13 b(3)249
507 y Fs(3.3.1)48 b(Con)o(tiguous)208 661 y Fw(MPI)p
285 661 13 2 v 14 w(TYPE)p 407 661 V 14 w(CONTIGUOUS\(count,)12
b(oldt)o(yp)q(e,)j(newt)o(yp)q(e\))332 736 y Fv(IN)158
b Fw(count)450 b Fv(replication)16 b(coun)o(t)332 786
y(IN)158 b Fw(oldt)o(yp)q(e)421 b Fv(old)14 b(datat)o(yp)q(e)332
836 y(OUT)114 b Fw(newt)o(yp)q(e)406 b Fv(new)13 b(datat)o(yp)q(e)249
946 y Fr(int)21 b(MPI)p 405 946 14 2 v 15 w(Type)p 508
946 V 15 w(contiguous\(int)e(count,)i(MPI)p 1069 946
V 15 w(Datatype)f(oldtype,)540 1000 y(MPI)p 609 1000
V 15 w(Datatype)g(*newtype\))249 1084 y(MPI)p 318 1084
V 15 w(TYPE)p 421 1084 V 15 w(CONTIGUOUS\(COUNT,)e(OLDTYPE,)i(NEWTYPE,)
h(IERROR\))336 1138 y(INTEGER)g(COUNT,)f(OLDTYPE,)g(NEWTYPE,)g(IERROR)
291 1222 y Fw(MPI)p 368 1222 13 2 v 14 w(TYPE)p 490 1222
V 14 w(CONTIGUOUS)13 b FA(is)i(the)h(simplest)e(datat)o(yp)q(e)h
(constructor.)24 b(It)15 b(constructs)j(a)249 1275 y(t)o(yp)q(emap)13
b(consisting)g(of)g(the)i(replication)e(of)g(a)g(datat)o(yp)q(e)h(in)o
(to)f(con)o(tiguous)h(lo)q(cations.)j(The)249 1329 y(argumen)o(t)9
b Fw(newt)o(yp)q(e)i FA(is)f(the)g(datat)o(yp)q(e)g(obtained)f(b)o(y)h
(concatenating)g Fw(count)h FA(copies)f(of)f Fw(oldt)o(yp)q(e)p
FA(.)249 1383 y(Concatenation)g(is)h(de\014ned)g(using)g
FB(extent\(oldtyp)n(e\))f FA(as)h(the)g(size)g(of)f(the)h(concatenated)
h(copies.)249 1437 y(The)g(action)g(of)f(the)h(Con)o(tiguous)f
(constructor)j(is)d(represen)o(ted)k(sc)o(hematically)9
b(in)h(Figure)h(3.2.)628 1495 y
 11840716 5920355 0 0 18945146 9472573 startTexFig
 628 1495 a
%%BeginDocument: ../figures/advpt2pt-contig.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-90.0 288.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 219 199 m 219 159 l  199 159 l  199 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 199 m 239 159 l  219 159 l  219 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 239 199 m 239 159 l  179 159 l  179 199 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 199 319 m 199 279 l  179 279 l  179 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 219 319 m 219 279 l  199 279 l  199 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 319 m 239 279 l  219 279 l  219 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 239 319 m 239 279 l  179 279 l  179 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 259 319 m 259 279 l  239 279 l  239 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 279 319 m 279 279 l  259 279 l  259 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 299 319 m 299 279 l  279 279 l  279 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 199 199 m 199 159 l  179 159 l  179 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 299 319 m 299 279 l  239 279 l  239 319 l  clp gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
99 299 m 
gs 1 -1 scale (newtype) col-1 show gr
0.500 setlinewidth
% Polyline
n 319 319 m 319 279 l  299 279 l  299 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 339 319 m 339 279 l  319 279 l  319 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 359 319 m 359 279 l  339 279 l  339 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 359 319 m 359 279 l  299 279 l  299 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 379 319 m 379 279 l  359 279 l  359 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 399 319 m 399 279 l  379 279 l  379 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 419 319 m 419 279 l  399 279 l  399 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 419 319 m 419 279 l  359 279 l  359 319 l  clp gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
99 179 m 
gs 1 -1 scale (oldtype) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
99 239 m 
gs 1 -1 scale (count = 4) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1933 a Fo(Figure)i(3.2)249 1970 y Fz(E\013ect)d(of)i(datat)o(yp)q
(e)d(constructor)f Fw(MPI)p 802 1970 13 2 v 14 w(TYPE)p
924 1970 V 15 w(CONTIGUOUS)p Fz(.)249 2114 y Fs(Example)15
b(3.4)21 b FA(Let)d Fw(oldt)o(yp)q(e)h FA(ha)o(v)o(e)e(t)o(yp)q(e)h
(map)e Ft(f)p FA(\()p Fw(double)r Fp(;)7 b FA(0\))p Fp(;)g
FA(\()p Fw(cha)o(r)p Fp(;)g FA(8\))p Ft(g)p Fp(;)16 b
FA(with)i(exten)o(t)g(16,)249 2168 y(and)c(let)g Fw(count)e
FA(=)g(3.)18 b(The)c(t)o(yp)q(e)h(map)d(of)h(the)i(datat)o(yp)q(e)f
(returned)h(b)o(y)f Fw(newt)o(yp)q(e)i FA(is)249 2255
y Ft(f)p FA(\()p Fw(double)q Fp(;)7 b FA(0\))p Fp(;)g
FA(\()p Fw(cha)o(r)q Fp(;)g FA(8\))p Fp(;)g FA(\()p Fw(double)p
Fp(;)g FA(16\))p Fp(;)g FA(\()p Fw(cha)o(r)p Fp(;)g FA(24\))p
Fp(;)g FA(\()p Fw(double)q Fp(;)g FA(32\))p Fp(;)g FA(\()p
Fw(cha)o(r)p Fp(;)g FA(40\))p Ft(g)p Fp(;)249 2342 y
FA(that)13 b(is,)g(alternating)f Fw(double)j FA(and)d
Fw(cha)o(r)i FA(elemen)o(ts,)f(with)f(displacemen)o(ts)h(0)p
Fp(;)7 b FA(8)p Fp(;)g FA(16)p Fp(;)g FA(24)p Fp(;)f
FA(32)p Fp(;)g FA(40.)p eop
%%Page: 107 121
107 120 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(107)291 507 y FA(In)13 b(general,)h(assume)g(that)f
(the)i(t)o(yp)q(e)f(map)f(of)g Fw(oldt)o(yp)q(e)i FA(is)249
594 y Ft(f)p FA(\()p Fp(ty)q(pe)362 600 y Fk(0)382 594
y Fp(;)7 b(disp)477 600 y Fk(0)495 594 y FA(\))p Fp(;)g(:)g(:)g(:)e(;)i
FA(\()p Fp(ty)q(pe)696 600 y Fj(n)p Fm(\000)p Fk(1)762
594 y Fp(;)g(disp)857 600 y Fj(n)p Fm(\000)p Fk(1)921
594 y FA(\))p Ft(g)p Fp(;)249 680 y FA(with)14 b(exten)o(t)g
Fp(ex)p FA(.)k(Then)d Fw(newt)o(yp)q(e)h FA(has)e(a)g(t)o(yp)q(e)g(map)
e(with)i Fw(count)c Ft(\001)f Fp(n)14 b FA(en)o(tries)h(de\014ned)g(b)o
(y:)249 767 y Ft(f)p FA(\()p Fp(ty)q(pe)362 773 y Fk(0)382
767 y Fp(;)7 b(disp)477 773 y Fk(0)495 767 y FA(\))p
Fp(;)g(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)696 773 y Fj(n)p
Fm(\000)p Fk(1)762 767 y Fp(;)g(disp)857 773 y Fj(n)p
Fm(\000)p Fk(1)921 767 y FA(\))p Fp(;)249 869 y FA(\()p
Fp(ty)q(pe)341 875 y Fk(0)361 869 y Fp(;)g(disp)456 875
y Fk(0)483 869 y FA(+)j Fp(ex)p FA(\))p Fp(;)d(:)g(:)g(:)e(;)i
FA(\()p Fp(ty)q(pe)769 875 y Fj(n)p Fm(\000)p Fk(1)835
869 y Fp(;)g(disp)930 875 y Fj(n)p Fm(\000)p Fk(1)1004
869 y FA(+)i Fp(ex)p FA(\))p Fp(;)249 971 y(:)e(:)g(:)e(;)i
FA(\()p Fp(ty)q(pe)415 977 y Fk(0)435 971 y Fp(;)g(disp)530
977 y Fk(0)557 971 y FA(+)j Fp(ex)f Ft(\001)g FA(\()p
Fw(count)h Ft(\000)g FA(1\)\))p Fp(;)d(:)g(:)g(:)e(;)i
FA(\()p Fp(ty)q(pe)1074 977 y Fj(n)p Fm(\000)p Fk(1)1139
971 y Fp(;)g(disp)1234 977 y Fj(n)p Fm(\000)p Fk(1)1308
971 y FA(+)j Fp(ex)f Ft(\001)g FA(\()p Fw(count)h Ft(\000)g
FA(1\)\))p Ft(g)p Fp(:)249 1223 y Fs(3.3.2)48 b(V)l(ector)208
1377 y Fw(MPI)p 285 1377 13 2 v 14 w(TYPE)p 407 1377
V 14 w(VECTOR\(count,)13 b(blo)q(cklength,)j(stride,)e(oldt)o(yp)q(e,)g
(newt)o(yp)q(e\))332 1451 y Fv(IN)158 b Fw(count)450
b Fv(n)o(um)o(b)q(er)14 b(of)f(blo)q(c)o(ks)332 1501
y(IN)158 b Fw(blo)q(cklength)349 b Fv(n)o(um)o(b)q(er)14
b(of)f(elemen)o(ts)h(in)g(eac)o(h)f(blo)q(c)o(k)332 1551
y(IN)158 b Fw(stride)452 b Fv(spacing)11 b(b)q(et)o(w)o(een)e(start)g
(of)f(eac)o(h)h(blo)q(c)o(k,)i(mea-)1079 1605 y(sured)j(as)f(n)o(um)o
(b)q(er)h(of)f(elemen)o(ts)332 1654 y(IN)158 b Fw(oldt)o(yp)q(e)421
b Fv(old)14 b(datat)o(yp)q(e)332 1704 y(OUT)114 b Fw(newt)o(yp)q(e)406
b Fv(new)13 b(datat)o(yp)q(e)249 1814 y Fr(int)21 b(MPI)p
405 1814 14 2 v 15 w(Type)p 508 1814 V 15 w(vector\(int)f(count,)g(int)
i(blocklength,)d(int)i(stride,)540 1868 y(MPI)p 609 1868
V 15 w(Datatype)f(oldtype,)g(MPI)p 1082 1868 V 15 w(Datatype)g
(*newtype\))249 1952 y(MPI)p 318 1952 V 15 w(TYPE)p 421
1952 V 15 w(VECTOR\(COUNT,)f(BLOCKLENGTH,)g(STRIDE,)i(OLDTYPE,)f
(NEWTYPE,)g(IERROR\))336 2006 y(INTEGER)h(COUNT,)f(BLOCKLENGTH,)f
(STRIDE,)i(OLDTYPE,)f(NEWTYPE,)g(IERROR)291 2090 y Fw(MPI)p
368 2090 13 2 v 14 w(TYPE)p 490 2090 V 14 w(VECTOR)15
b FA(is)h(a)f(constructor)j(that)e(allo)o(ws)f(replication)h(of)f(a)h
(datat)o(yp)q(e)g(in)o(to)249 2144 y(lo)q(cations)d(that)g(consist)h
(of)f(equally)g(spaced)h(blo)q(c)o(ks.)k(Eac)o(h)c(blo)q(c)o(k)f(is)g
(obtained)g(b)o(y)h(concate-)249 2198 y(nating)e(the)h(same)f(n)o(um)o
(b)q(er)g(of)g(copies)h(of)f(the)i(old)e(datat)o(yp)q(e.)18
b(The)13 b(spacing)f(b)q(et)o(w)o(een)i(blo)q(c)o(ks)249
2252 y(is)d(a)h(m)o(ultiple)d(of)i(the)h(exten)o(t)g(of)f(the)h(old)f
(datat)o(yp)q(e.)18 b(The)11 b(action)h(of)e(the)j(V)m(ector)f
(constructor)249 2306 y(is)i(represen)o(ted)j(sc)o(hematically)12
b(in)h(Figure)h(3.3.)249 2400 y Fs(Example)h(3.5)21 b
FA(As)12 b(b)q(efore,)h(assume)e(that)h Fw(oldt)o(yp)q(e)h
FA(has)f(t)o(yp)q(e)g(map)e Ft(f)p FA(\()p Fw(double)q
Fp(;)d FA(0\))p Fp(;)g FA(\()p Fw(cha)o(r)q Fp(;)g FA(8\))p
Ft(g)p Fp(;)249 2454 y FA(with)k(exten)o(t)i(16.)k(A)12
b(call)e(to)i Fw(MPI)p 779 2454 V 14 w(TYPE)p 901 2454
V 14 w(VECTOR\()f(2,)g(3,)h(4,)f(oldt)o(yp)q(e,)i(newt)o(yp)q(e\))h
FA(will)c(create)249 2508 y(the)15 b(datat)o(yp)q(e)f(with)f(t)o(yp)q
(e)i(map)p eop
%%Page: 108 122
108 121 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(108)1256 b(Chapter)13 b(3)403
466 y
 18945146 5304636 0 0 33154007 9472573 startTexFig
 403 466 a
%%BeginDocument: ../figures/advpt2pt-vector.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-90.0 288.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 219 199 m 219 159 l  199 159 l  199 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 199 m 239 159 l  219 159 l  219 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 239 199 m 239 159 l  179 159 l  179 199 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 199 319 m 199 279 l  179 279 l  179 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 219 319 m 219 279 l  199 279 l  199 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 319 m 239 279 l  219 279 l  219 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 239 319 m 239 279 l  179 279 l  179 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 259 319 m 259 279 l  239 279 l  239 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 279 319 m 279 279 l  259 279 l  259 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 299 319 m 299 279 l  279 279 l  279 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 299 319 m 299 279 l  239 279 l  239 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 379 319 m 379 279 l  359 279 l  359 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 399 319 m 399 279 l  379 279 l  379 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 419 319 m 419 279 l  399 279 l  399 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 419 319 m 419 279 l  359 279 l  359 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 439 319 m 439 279 l  419 279 l  419 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 459 319 m 459 279 l  439 279 l  439 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 199 199 m 199 159 l  179 159 l  179 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 479 319 m 479 279 l  459 279 l  459 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
99 299 m 
gs 1 -1 scale (newtype) col-1 show gr
2.000 setlinewidth
% Polyline
n 479 319 m 479 279 l  419 279 l  419 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 559 319 m 559 279 l  539 279 l  539 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 579 319 m 579 279 l  559 279 l  559 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 599 319 m 599 279 l  579 279 l  579 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 599 319 m 599 279 l  539 279 l  539 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 619 319 m 619 279 l  599 279 l  599 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 639 319 m 639 279 l  619 279 l  619 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 659 319 m 659 279 l  639 279 l  639 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 659 319 m 659 279 l  599 279 l  599 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 319 319 m 319 279 l  299 279 l  299 319 l  clp gs col-1 s gr
% Polyline
n 339 319 m 339 279 l  319 279 l  319 319 l  clp gs col-1 s gr
% Polyline
n 359 319 m 359 279 l  339 279 l  339 319 l  clp gs col-1 s gr
% Polyline
n 499 319 m 499 279 l  479 279 l  479 319 l  clp gs col-1 s gr
% Polyline
n 519 319 m 519 279 l  499 279 l  499 319 l  clp gs col-1 s gr
% Polyline
n 539 319 m 539 279 l  519 279 l  519 319 l  clp gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
99 179 m 
gs 1 -1 scale (oldtype) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
99 239 m 
gs 1 -1 scale (count = 3, blocklength = 2, stride = 3) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 864 a Fo(Figure)g(3.3)249 901 y Fz(Datat)o(yp)q(e)c(constructor)g
Fw(MPI)p 668 901 13 2 v 14 w(TYPE)p 790 901 V 14 w(VECTOR)p
Fz(.)249 1022 y Ft(f)p FA(\()p Fw(double)q Fp(;)e FA(0\))p
Fp(;)g FA(\()p Fw(cha)o(r)q Fp(;)g FA(8\))p Fp(;)g FA(\()p
Fw(double)p Fp(;)g FA(16\))p Fp(;)g FA(\()p Fw(cha)o(r)p
Fp(;)g FA(24\))p Fp(;)g FA(\()p Fw(double)q Fp(;)g FA(32\))p
Fp(;)g FA(\()p Fw(cha)o(r)p Fp(;)g FA(40\))p Fp(;)249
1120 y FA(\()p Fw(double)r Fp(;)g FA(64\))p Fp(;)g FA(\()p
Fw(cha)o(r)p Fp(;)g FA(72\))p Fp(;)g FA(\()p Fw(double)p
Fp(;)g FA(80\))p Fp(;)g FA(\()p Fw(cha)o(r)p Fp(;)g FA(88\))p
Fp(;)g FA(\()p Fw(double)p Fp(;)g FA(96\))p Fp(;)g FA(\()p
Fw(cha)o(r)p Fp(;)g FA(104\))p Ft(g)p Fp(:)249 1204 y
FA(That)j(is,)h(t)o(w)o(o)f(blo)q(c)o(ks)g(with)g(three)i(copies)e(eac)
o(h)h(of)f(the)h(old)f(t)o(yp)q(e,)h(with)f(a)g(stride)h(of)f(4)g
(elemen)o(ts)249 1258 y(\(4)f Ft(\002)h FA(16)j(b)o(ytes\))i(b)q(et)o
(w)o(een)g(the)g(blo)q(c)o(ks.)249 1351 y Fs(Example)g(3.6)21
b FA(A)13 b(call)e(to)i Fw(MPI)p 773 1351 V 14 w(TYPE)p
895 1351 V 14 w(VECTOR\(3,)e(1,)h(-2,)g(oldt)o(yp)q(e,)h(newt)o(yp)q
(e\))i FA(will)c(create)249 1405 y(the)k(datat)o(yp)q(e)f(with)f(t)o
(yp)q(e)i(map)249 1489 y Ft(f)p FA(\()p Fw(double)q Fp(;)7
b FA(0\))p Fp(;)g FA(\()p Fw(cha)o(r)q Fp(;)g FA(8\))p
Fp(;)g FA(\()p Fw(double)p Fp(;)g Ft(\000)p FA(32\))p
Fp(;)g FA(\()p Fw(cha)o(r)q Fp(;)g Ft(\000)p FA(24\))p
Fp(;)g FA(\()p Fw(double)p Fp(;)g Ft(\000)p FA(64\))p
Fp(;)g FA(\()p Fw(cha)o(r)q Fp(;)g Ft(\000)p FA(56\))p
Ft(g)p Fp(:)291 1695 y FA(In)13 b(general,)h(assume)g(that)f
Fw(oldt)o(yp)q(e)i FA(has)f(t)o(yp)q(e)h(map)249 1779
y Ft(f)p FA(\()p Fp(ty)q(pe)362 1785 y Fk(0)382 1779
y Fp(;)7 b(disp)477 1785 y Fk(0)495 1779 y FA(\))p Fp(;)g(:)g(:)g(:)e
(;)i FA(\()p Fp(ty)q(pe)696 1785 y Fj(n)p Fm(\000)p Fk(1)762
1779 y Fp(;)g(disp)857 1785 y Fj(n)p Fm(\000)p Fk(1)921
1779 y FA(\))p Ft(g)p Fp(;)249 1864 y FA(with)14 b(exten)o(t)h
Fp(ex)p FA(.)j(Let)d Fw(bl)f FA(b)q(e)h(the)g Fw(blo)q(cklength)p
FA(.)20 b(The)15 b(new)f(datat)o(yp)q(e)h(has)f(a)g(t)o(yp)q(e)g(map)f
(with)249 1918 y Fw(count)d Ft(\001)f Fw(bl)h Ft(\001)e
Fp(n)14 b FA(en)o(tries:)249 2003 y Ft(f)p FA(\()p Fp(ty)q(pe)362
2009 y Fk(0)382 2003 y Fp(;)7 b(disp)477 2009 y Fk(0)495
2003 y FA(\))p Fp(;)g(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)696
2009 y Fj(n)p Fm(\000)p Fk(1)762 2003 y Fp(;)g(disp)857
2009 y Fj(n)p Fm(\000)p Fk(1)921 2003 y FA(\))p Fp(;)249
2101 y FA(\()p Fp(ty)q(pe)341 2107 y Fk(0)361 2101 y
Fp(;)g(disp)456 2107 y Fk(0)483 2101 y FA(+)j Fp(ex)p
FA(\))p Fp(;)d(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)769
2107 y Fj(n)p Fm(\000)p Fk(1)835 2101 y Fp(;)g(disp)930
2107 y Fj(n)p Fm(\000)p Fk(1)1004 2101 y FA(+)i Fp(ex)p
FA(\))p Fp(;)e(:)g(:)g(:)e(;)249 2199 y FA(\()p Fp(ty)q(pe)341
2205 y Fk(0)361 2199 y Fp(;)i(disp)456 2205 y Fk(0)483
2199 y FA(+)j(\()p Fw(bl)g Ft(\000)f FA(1\))g Ft(\001)g
Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)934
2205 y Fj(n)p Fm(\000)p Fk(1)1000 2199 y Fp(;)g(disp)1095
2205 y Fj(n)p Fm(\000)p Fk(1)1169 2199 y FA(+)i(\()p
Fw(bl)h Ft(\000)g FA(1\))f Ft(\001)f Fp(ex)p FA(\))p
Fp(;)249 2298 y FA(\()p Fp(ty)q(pe)341 2304 y Fk(0)361
2298 y Fp(;)f(disp)456 2304 y Fk(0)483 2298 y FA(+)j
Fw(stride)g Ft(\001)f Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)i
FA(\()p Fp(ty)q(pe)894 2304 y Fj(n)p Fm(\000)p Fk(1)960
2298 y Fp(;)g(disp)1055 2304 y Fj(n)p Fm(\000)p Fk(1)1129
2298 y FA(+)i Fw(stride)h Ft(\001)f Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e
(;)249 2396 y FA(\()p Fp(ty)q(pe)341 2402 y Fk(0)361
2396 y Fp(;)i(disp)456 2402 y Fk(0)483 2396 y FA(+)j(\()p
Fw(stride)g FA(+)g Fw(bl)f Ft(\000)h FA(1\))f Ft(\001)g
Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)1080
2402 y Fj(n)p Fm(\000)p Fk(1)1145 2396 y Fp(;)g(disp)1240
2402 y Fj(n)p Fm(\000)p Fk(1)1314 2396 y FA(+)j(\()p
Fw(stride)g FA(+)g Fw(bl)f Ft(\000)h FA(1\))f Ft(\001)g
Fp(ex)p FA(\))p Fp(;)249 2494 y(:)e(:)g(:)e(:;)i FA(\()p
Fp(ty)q(pe)427 2500 y Fk(0)446 2494 y Fp(;)g(disp)541
2500 y Fk(0)569 2494 y FA(+)i Fw(stride)h Ft(\001)f FA(\()p
Fw(count)i Ft(\000)e FA(1\))g Ft(\001)g Fp(ex)p FA(\))p
Fp(;)e(:)g(:)g(:)e(;)p eop
%%Page: 109 123
109 122 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(109)249 507 y FA(\()p Fp(ty)q(pe)341
513 y Fj(n)p Fm(\000)p Fk(1)407 507 y Fp(;)7 b(disp)502
513 y Fj(n)p Fm(\000)p Fk(1)576 507 y FA(+)j Fw(stride)g
Ft(\001)f FA(\()p Fw(count)h Ft(\000)g FA(1\))f Ft(\001)g
Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)249 611 y FA(\()p
Fp(ty)q(pe)341 617 y Fk(0)361 611 y Fp(;)i(disp)456 617
y Fk(0)483 611 y FA(+)j(\()p Fw(stride)g Ft(\001)f FA(\()p
Fw(count)h Ft(\000)g FA(1\))f(+)h Fw(bl)f Ft(\000)h FA(1\))f
Ft(\001)g Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)249 714
y FA(\()p Fp(ty)q(pe)341 720 y Fj(n)p Fm(\000)p Fk(1)407
714 y Fp(;)i(disp)502 720 y Fj(n)p Fm(\000)p Fk(1)576
714 y FA(+)j(\()p Fw(stride)g Ft(\001)f FA(\()p Fw(count)h
Ft(\000)g FA(1\))f(+)g Fw(bl)h Ft(\000)g FA(1\))f Ft(\001)f
Fp(ex)p FA(\))p Ft(g)p Fp(:)291 938 y FA(A)17 b(call)f(to)i
Fw(MPI)p 550 938 13 2 v 14 w(TYPE)p 672 938 V 14 w(CONTIGUOUS\(count,)e
(oldt)o(yp)q(e,)j(newt)o(yp)q(e\))h FA(is)d(equiv)n(alen)o(t)g(to)g(a)
249 992 y(call)i(to)g Fw(MPI)p 464 992 V 14 w(TYPE)p
586 992 V 15 w(VECTOR\(count,)h(1,)g(1,)g(oldt)o(yp)q(e,)h(newt)o(yp)q
(e\))p FA(,)i(or)d(to)f(a)g(call)g(to)g Fw(MPI-)p 249
1046 V 262 1046 a(TYPE)p 372 1046 V 14 w(VECTOR\(1,)12
b(count,)i(num,)f(oldt)o(yp)q(e,)i(newt)o(yp)q(e\))p
FA(,)h(with)d Fw(num)h FA(arbitrary)m(.)249 1129 y Fs(3.3.3)48
b(Hv)o(ector)249 1212 y FA(The)21 b(V)m(ector)g(t)o(yp)q(e)f
(constructor)i(assumes)e(that)h(the)f(stride)h(b)q(et)o(w)o(een)h
(successiv)o(e)g(blo)q(c)o(ks)249 1266 y(is)c(a)g(m)o(ultiple)e(of)i
(the)h Fw(oldt)o(yp)q(e)g FA(exten)o(t.)32 b(This)18
b(a)o(v)o(oids,)g(most)f(of)h(the)h(time,)f(the)h(need)g(for)249
1320 y(computing)e(stride)j(in)e(b)o(ytes.)34 b(Sometimes)17
b(it)h(is)h(useful)g(to)f(relax)h(this)g(assumption)f(and)249
1374 y(allo)o(w)d(a)h(stride)h(whic)o(h)g(consists)g(of)f(an)h
(arbitrary)f(n)o(um)o(b)q(er)g(of)g(b)o(ytes.)27 b(The)16
b(Hv)o(ector)i(t)o(yp)q(e)249 1428 y(constructor)e(b)q(elo)o(w)e(ac)o
(hiev)o(es)h(this)f(purp)q(ose.)20 b(The)14 b(usage)h(of)e(b)q(oth)i(V)
m(ector)g(and)f(Hv)o(ector)h(is)249 1482 y(illustrated)f(in)f(Examples)
g(3.7{3.10.)249 1607 y Fw(MPI)p 326 1607 V 14 w(TYPE)p
448 1607 V 15 w(HVECTOR\(count,)g(blo)q(cklength,)j(stride,)e(oldt)o
(yp)q(e,)g(newt)o(yp)q(e\))332 1681 y Fv(IN)158 b Fw(count)450
b Fv(n)o(um)o(b)q(er)14 b(of)f(blo)q(c)o(ks)332 1731
y(IN)158 b Fw(blo)q(cklength)349 b Fv(n)o(um)o(b)q(er)14
b(of)f(elemen)o(ts)h(in)g(eac)o(h)f(blo)q(c)o(k)332 1781
y(IN)158 b Fw(stride)452 b Fv(spacing)11 b(b)q(et)o(w)o(een)e(start)g
(of)f(eac)o(h)h(blo)q(c)o(k,)i(mea-)1079 1835 y(sured)j(as)f(b)o(ytes)
332 1885 y(IN)158 b Fw(oldt)o(yp)q(e)421 b Fv(old)14
b(datat)o(yp)q(e)332 1935 y(OUT)114 b Fw(newt)o(yp)q(e)406
b Fv(new)13 b(datat)o(yp)q(e)249 2045 y Fr(int)21 b(MPI)p
405 2045 14 2 v 15 w(Type)p 508 2045 V 15 w(hvector\(int)f(count,)g
(int)h(blocklength,)f(MPI)p 1374 2045 V 15 w(Aint)h(stride,)540
2099 y(MPI)p 609 2099 V 15 w(Datatype)f(oldtype,)g(MPI)p
1082 2099 V 15 w(Datatype)g(*newtype\))249 2183 y(MPI)p
318 2183 V 15 w(TYPE)p 421 2183 V 15 w(HVECTOR\(COUNT,)f(BLOCKLENGTH,)g
(STRIDE,)i(OLDTYPE,)f(NEWTYPE,)540 2237 y(IERROR\))336
2291 y(INTEGER)h(COUNT,)f(BLOCKLENGTH,)f(STRIDE,)i(OLDTYPE,)f(NEWTYPE,)
g(IERROR)291 2375 y Fw(MPI)p 368 2375 13 2 v 14 w(TYPE)p
490 2375 V 14 w(HVECTOR)15 b FA(is)h(iden)o(tical)f(to)g
Fw(MPI)p 1054 2375 V 15 w(TYPE)p 1177 2375 V 14 w(VECTOR)p
FA(,)f(except)j(that)f Fw(stride)h FA(is)249 2429 y(giv)o(en)11
b(in)f(b)o(ytes,)i(rather)g(than)f(in)g(elemen)o(ts.)17
b(\()p Fw(H)12 b FA(stands)g(for)e(\\heterogeneous"\).)19
b(The)12 b(action)249 2483 y(of)h(the)i(Hv)o(ector)g(constructor)g(is)f
(represen)o(ted)j(sc)o(hematically)12 b(in)h(Figure)h(3.4.)p
eop
%%Page: 110 124
110 123 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(110)1256 b(Chapter)13 b(3)403
466 y
 18945146 6251895 0 0 28417720 9472573 startTexFig
 403 466 a
%%BeginDocument: ../figures/advpt2pt-hvector.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-90.0 288.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 219 199 m 219 159 l  199 159 l  199 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 199 m 239 159 l  219 159 l  219 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 239 199 m 239 159 l  179 159 l  179 199 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 199 319 m 199 279 l  179 279 l  179 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 219 319 m 219 279 l  199 279 l  199 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 319 m 239 279 l  219 279 l  219 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 239 319 m 239 279 l  179 279 l  179 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 259 319 m 259 279 l  239 279 l  239 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 279 319 m 279 279 l  259 279 l  259 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 299 319 m 299 279 l  279 279 l  279 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 299 319 m 299 279 l  239 279 l  239 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 339 319 m 339 279 l  319 279 l  319 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 359 319 m 359 279 l  339 279 l  339 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 379 319 m 379 279 l  359 279 l  359 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 379 319 m 379 279 l  319 279 l  319 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 199 199 m 199 159 l  179 159 l  179 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 399 319 m 399 279 l  379 279 l  379 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
99 299 m 
gs 1 -1 scale (newtype) col-1 show gr
% Polyline
n 419 319 m 419 279 l  399 279 l  399 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 439 319 m 439 279 l  419 279 l  419 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 439 319 m 439 279 l  379 279 l  379 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 479 319 m 479 279 l  459 279 l  459 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 499 319 m 499 279 l  479 279 l  479 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 519 319 m 519 279 l  499 279 l  499 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 519 319 m 519 279 l  459 279 l  459 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 539 319 m 539 279 l  519 279 l  519 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 559 319 m 559 279 l  539 279 l  539 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 579 319 m 579 279 l  559 279 l  559 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 579 319 m 579 279 l  519 279 l  519 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 319 319 m 319 279 l  299 279 l  299 319 l  clp gs col-1 s gr
% Polyline
n 459 319 m 459 279 l  439 279 l  439 319 l  clp gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
99 179 m 
gs 1 -1 scale (oldtype) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
99 239 m 
gs 1 -1 scale (count = 3, blocklength = 2, stride = 7) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 924 a Fo(Figure)g(3.4)249 961 y Fz(Datat)o(yp)q(e)c(constructor)g
Fw(MPI)p 668 961 13 2 v 14 w(TYPE)p 790 961 V 14 w(HVECTOR)p
Fz(.)249 1082 y Fs(Example)15 b(3.7)21 b FA(Consider)11
b(a)g(call)g(to)f Fw(MPI)p 928 1082 V 15 w(TYPE)p 1051
1082 V 14 w(HVECTOR)p FA(,)f(using)i(the)h(same)e(argumen)o(ts)249
1136 y(as)g(in)f(the)h(call)e(to)h Fw(MPI)p 601 1136
V 15 w(TYPE)p 724 1136 V 14 w(VECTOR)f FA(in)h(Example)f(3.5.)15
b(As)10 b(b)q(efore,)h(assume)e(that)g Fw(oldt)o(yp)q(e)249
1190 y FA(has)14 b(t)o(yp)q(e)g(map)f Ft(f)p FA(\()p
Fw(double)q Fp(;)7 b FA(0\))p Fp(;)g FA(\()p Fw(cha)o(r)p
Fp(;)g FA(8\))p Ft(g)p Fp(;)13 b FA(with)h(exten)o(t)g(16.)291
1244 y(A)9 b(call)g(to)g Fw(MPI)p 526 1244 V 15 w(TYPE)p
649 1244 V 14 w(HVECTOR\()f(2,)i(3,)g(4,)f(oldt)o(yp)q(e,)i(newt)o(yp)q
(e\))h FA(will)c(create)j(the)f(datat)o(yp)q(e)249 1298
y(with)k(t)o(yp)q(e)g(map)249 1382 y Ft(f)p FA(\()p Fw(double)q
Fp(;)7 b FA(0\))p Fp(;)g FA(\()p Fw(cha)o(r)q Fp(;)g
FA(8\))p Fp(;)g FA(\()p Fw(double)p Fp(;)g FA(16\))p
Fp(;)g FA(\()p Fw(cha)o(r)p Fp(;)g FA(24\))p Fp(;)g FA(\()p
Fw(double)q Fp(;)g FA(32\))p Fp(;)g FA(\()p Fw(cha)o(r)p
Fp(;)g FA(40\))p Fp(;)249 1481 y FA(\()p Fw(double)r
Fp(;)g FA(4\))p Fp(;)g FA(\()p Fw(cha)o(r)p Fp(;)g FA(12\))p
Fp(;)g FA(\()p Fw(double)p Fp(;)g FA(20\))p Fp(;)g FA(\()p
Fw(cha)o(r)p Fp(;)g FA(28\))p Fp(;)g FA(\()p Fw(double)q
Fp(;)g FA(36\))p Fp(;)g FA(\()p Fw(cha)o(r)p Fp(;)g FA(44\))p
Ft(g)p Fp(:)291 1566 y FA(This)k(deriv)o(ed)g(datat)o(yp)q(e)h(sp)q
(eci\014es)h(o)o(v)o(erlapping)d(en)o(tries.)18 b(Since)12
b(a)f Fq(DOUBLE)g FA(cannot)h(start)249 1620 y(b)q(oth)j(at)g
(displacemen)o(t)g(zero)h(and)e(at)h(displacemen)o(t)g(four,)f(the)i
(use)g(of)f(this)g(datat)o(yp)q(e)g(in)g(a)249 1674 y(send)e(op)q
(eration)f(will)f(cause)i(a)f(t)o(yp)q(e)g(matc)o(h)f(error.)18
b(In)13 b(order)f(to)g(de\014ne)i(the)e(same)f(t)o(yp)q(e)i(map)249
1728 y(as)h(in)f(Example)g(3.5,)f(one)i(w)o(ould)f(use)i(here)g
Fw(stride)g(=)f(64)f(\()p FA(4)d Ft(\002)f FA(16)p Fw(\))p
FA(.)291 1903 y(In)k(general,)h(assume)g(that)f Fw(oldt)o(yp)q(e)i
FA(has)f(t)o(yp)q(e)h(map)249 1988 y Ft(f)p FA(\()p Fp(ty)q(pe)362
1994 y Fk(0)382 1988 y Fp(;)7 b(disp)477 1994 y Fk(0)495
1988 y FA(\))p Fp(;)g(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)696
1994 y Fj(n)p Fm(\000)p Fk(1)762 1988 y Fp(;)g(disp)857
1994 y Fj(n)p Fm(\000)p Fk(1)921 1988 y FA(\))p Ft(g)p
Fp(;)249 2073 y FA(with)14 b(exten)o(t)h Fp(ex)p FA(.)j(Let)d
Fw(bl)f FA(b)q(e)h(the)g Fw(blo)q(cklength)p FA(.)20
b(The)15 b(new)f(datat)o(yp)q(e)h(has)f(a)g(t)o(yp)q(e)g(map)f(with)249
2127 y Fw(count)d Ft(\001)f Fw(bl)h Ft(\001)e Fp(n)14
b FA(en)o(tries:)249 2212 y Ft(f)p FA(\()p Fp(ty)q(pe)362
2218 y Fk(0)382 2212 y Fp(;)7 b(disp)477 2218 y Fk(0)495
2212 y FA(\))p Fp(;)g(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)696
2218 y Fj(n)p Fm(\000)p Fk(1)762 2212 y Fp(;)g(disp)857
2218 y Fj(n)p Fm(\000)p Fk(1)921 2212 y FA(\))p Fp(;)249
2310 y FA(\()p Fp(ty)q(pe)341 2316 y Fk(0)361 2310 y
Fp(;)g(disp)456 2316 y Fk(0)483 2310 y FA(+)j Fp(ex)p
FA(\))p Fp(;)d(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)769
2316 y Fj(n)p Fm(\000)p Fk(1)835 2310 y Fp(;)g(disp)930
2316 y Fj(n)p Fm(\000)p Fk(1)1004 2310 y FA(+)i Fp(ex)p
FA(\))p Fp(;)e(:)g(:)g(:)e(;)249 2409 y FA(\()p Fp(ty)q(pe)341
2415 y Fk(0)361 2409 y Fp(;)i(disp)456 2415 y Fk(0)483
2409 y FA(+)j(\()p Fw(bl)g Ft(\000)f FA(1\))g Ft(\001)g
Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)934
2415 y Fj(n)p Fm(\000)p Fk(1)1000 2409 y Fp(;)g(disp)1095
2415 y Fj(n)p Fm(\000)p Fk(1)1169 2409 y FA(+)i(\()p
Fw(bl)h Ft(\000)g FA(1\))f Ft(\001)f Fp(ex)p FA(\))p
Fp(;)249 2508 y FA(\()p Fp(ty)q(pe)341 2514 y Fk(0)361
2508 y Fp(;)f(disp)456 2514 y Fk(0)483 2508 y FA(+)j
Fw(stride)q FA(\))p Fp(;)d(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)821
2514 y Fj(n)p Fm(\000)p Fk(1)886 2508 y Fp(;)g(disp)981
2514 y Fj(n)p Fm(\000)p Fk(1)1056 2508 y FA(+)i Fw(stride)q
FA(\))p Fp(;)e(:)g(:)g(:)e(;)p eop
%%Page: 111 125
111 124 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(111)249 524 y FA(\()p Fp(ty)q(pe)341
530 y Fk(0)361 524 y Fp(;)7 b(disp)456 530 y Fk(0)483
524 y FA(+)j Fw(stride)g FA(+)g(\()p Fw(bl)f Ft(\000)h
FA(1\))f Ft(\001)g Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)249
627 y FA(\()p Fp(ty)q(pe)341 633 y Fj(n)p Fm(\000)p Fk(1)407
627 y Fp(;)i(disp)502 633 y Fj(n)p Fm(\000)p Fk(1)576
627 y FA(+)j Fw(stride)g FA(+)f(\()p Fw(bl)h Ft(\000)g
FA(1\))f Ft(\001)g Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(:;)249
731 y FA(\()p Fp(ty)q(pe)341 737 y Fk(0)361 731 y Fp(;)i(disp)456
737 y Fk(0)483 731 y FA(+)j Fw(stride)g Ft(\001)f FA(\()p
Fw(count)h Ft(\000)g FA(1\)\))p Fp(;)d(:)g(:)g(:)e(;)i
FA(\()p Fp(ty)q(pe)1052 737 y Fj(n)p Fm(\000)p Fk(1)1117
731 y Fp(;)g(disp)1212 737 y Fj(n)p Fm(\000)p Fk(1)1286
731 y FA(+)j Fw(stride)g Ft(\001)f FA(\()p Fw(count)h
Ft(\000)g FA(1\)\))p Fp(;)d(:)g(:)g(:)e(;)249 834 y FA(\()p
Fp(ty)q(pe)341 840 y Fk(0)361 834 y Fp(;)i(disp)456 840
y Fk(0)483 834 y FA(+)j Fw(stride)g Ft(\001)f FA(\()p
Fw(count)h Ft(\000)g FA(1\))f(+)g(\()p Fw(bl)h Ft(\000)g
FA(1\))f Ft(\001)g Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)249
937 y FA(\()p Fp(ty)q(pe)341 943 y Fj(n)p Fm(\000)p Fk(1)407
937 y Fp(;)i(disp)502 943 y Fj(n)p Fm(\000)p Fk(1)576
937 y FA(+)j Fw(stride)g Ft(\001)f FA(\()p Fw(count)h
Ft(\000)g FA(1\))f(+)g(\()p Fw(bl)h Ft(\000)g FA(1\))f
Ft(\001)f Fp(ex)p FA(\))p Ft(g)p Fp(:)249 1203 y Fs(Example)15
b(3.8)21 b FA(Send)12 b(and)f(receiv)o(e)h(a)f(section)h(of)e(a)h(2D)g
(arra)o(y)m(.)16 b(The)c(la)o(y)o(out)e(of)g(the)i(2D)f(arra)o(y)249
1257 y(section)h(is)f(sho)o(wn)g(in)f(Fig)h(3.5.)16 b(The)11
b(\014rst)h(call)e(to)h Fw(MPI)p 1108 1257 13 2 v 14
w(TYPE)p 1230 1257 V 14 w(VECTOR)f FA(de\014nes)i(a)f(datat)o(yp)q(e)
249 1311 y(that)20 b(describ)q(es)i(one)e(column)e(of)h(the)h(section:)
31 b(the)20 b(1D)f(arra)o(y)h(section)g Fr(\(1:6:2\))f
FA(whic)o(h)249 1365 y(consists)11 b(of)e(three)i Fr(REAL)p
FA('s,)e(spaced)h(t)o(w)o(o)f(apart.)17 b(The)10 b(second)h(call)e(to)g
Fw(MPI)p 1415 1365 V 14 w(TYPE)p 1537 1365 V 14 w(HVECTOR)249
1419 y FA(de\014nes)22 b(a)e(datat)o(yp)q(e)g(that)g(describ)q(es)j
(the)e(2D)e(arra)o(y)h(section)h Fr(\(1:6:2,)g(1:5:2\))p
FA(:)29 b(three)249 1473 y(copies)14 b(of)e(the)i(previous)f(1D)f(arra)
o(y)h(section,)g(with)g(a)g(stride)h(of)e Fr(12*sizeofreal)p
FA(;)e(the)k(stride)249 1527 y(is)d(not)h(a)f(m)o(ultiple)e(of)h(the)i
(exten)o(t)h(of)d(the)i(1D)f(section,)h(whic)o(h)f(is)h
Fr(5*sizeofreal)p FA(.)i(The)e(usage)249 1581 y(of)h
Fw(MPI)p 373 1581 V 15 w(TYPE)p 496 1581 V 14 w(COMMIT)g
FA(is)h(explained)g(later,)f(in)h(Section)g(3.4.)380
1635 y Fr(REAL)21 b(a\(6,5\),)f(e\(3,3\))380 1689 y(INTEGER)g
(oneslice,)g(twoslice,)g(sizeofreal,)g(myrank,)g(ierr)380
1742 y(INTEGER)g(status\(MPI_STATUS_)o(SIZE\))249 1850
y(C)131 b(extract)20 b(the)h(section)f(a\(1:6:2,1:5:2\))249
1904 y(C)131 b(and)21 b(store)g(it)g(in)g(e\(:,:\).)380
2012 y(CALL)g(MPI_COMM_RANK\(MP)o(I_COM)o(M_WOR)o(LD,)e(myrank,)h
(ierr\))380 2120 y(CALL)h(MPI_TYPE_EXTENT\()o(MPI_R)o(EAL,)d
(sizeofreal,)i(ierr\))249 2228 y(C)109 b(create)20 b(datatype)h(for)g
(a)g(1D)h(section)380 2282 y(CALL)f(MPI_TYPE_VECTOR\()o(3,)e(1,)i(2,)h
(MPI_REAL,)e(oneslice,)f(ierr\))249 2390 y(C)109 b(create)20
b(datatype)h(for)g(a)g(2D)h(section)380 2444 y(CALL)f(MPI_TYPE_HVECTOR)
o(\(3,)e(1,)i(12*sizeofreal,)e(oneslice,)h(twoslice,)g(ierr\))p
eop
%%Page: 112 126
112 125 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(112)1256 b(Chapter)13 b(3)380
507 y Fr(CALL)21 b(MPI_TYPE_COMMIT\()d(twoslice,)i(ierr\))249
615 y(C)109 b(send)21 b(and)g(recv)g(on)g(same)g(process)380
669 y(CALL)g(MPI_SENDRECV\(a\(1)o(,1,1\))o(,)e(1,)i(twoslice,)f
(myrank,)h(0,)g(e,)g(9,)772 723 y(MPI_REAL,)f(myrank,)g(0,)i
(MPI_COMM_WORLD,)c(status,)j(ierr\))703 868 y
 9472573 11367087 0 0 17761075 21313290 startTexFig
 703 868
a
%%BeginDocument: ../figures/advpt2pt-section.ps
/$F2psDict 6400 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
	/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
	/$F2psEnd {$F2psEnteredState restore end} def
	%%EndProlog

$F2psBegin
0 setlinecap 0 setlinejoin
-144 72 translate
0.0 324.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 219 139 m 219 79 l  159 79 l  159 139 l 
 clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 279 139 m 279 79 l  219 79 l  219 139 l 
 clp gs col-1 s gr
% Polyline
n 339 139 m 339 79 l  279 79 l  279 139 l 
 clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 219 199 m 219 139 l  159 139 l  159 199 l 
 clp gs col-1 s gr
% Polyline
n 339 199 m 339 139 l  279 139 l  279 199 l 
 clp gs col-1 s gr
% Polyline
n 399 139 m 399 79 l  339 79 l  339 139 l 
 clp gs col-1 s gr
% Polyline
n 459 139 m 459 79 l  399 79 l  399 139 l 
 clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 459 259 m 459 199 l  399 199 l  399 259 l 
 clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 339 259 m 339 199 l  279 199 l  279 259 l 
 clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 219 259 m 219 199 l  159 199 l  159 259 l 
 clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 219 319 m 219 259 l  159 259 l  159 319 l 
 clp gs col-1 s gr
% Polyline
n 339 319 m 339 259 l  279 259 l  279 319 l 
 clp gs col-1 s gr
% Polyline
n 459 199 m 459 139 l  399 139 l  399 199 l 
 clp gs col-1 s gr
% Polyline
n 459 319 m 459 259 l  399 259 l  399 319 l 
 clp gs col-1 s gr
% Polyline
n 219 379 m 219 319 l  159 319 l  159 379 l 
 clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 339 379 m 339 319 l  279 319 l  279 379 l 
 clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 459 379 m 459 319 l  399 319 l  399 379 l 
 clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 279 199 m 279 139 l  219 139 l  219 199 l 
 clp gs col-1 s gr
% Polyline
n 279 259 m 279 199 l  219 199 l  219 259 l 
 clp gs col-1 s gr
% Polyline
n 279 319 m 279 259 l  219 259 l  219 319 l 
 clp gs col-1 s gr
% Polyline
n 279 379 m 279 319 l  219 319 l  219 379 l 
 clp gs col-1 s gr
% Polyline
n 279 439 m 279 379 l  219 379 l  219 439 l 
 clp gs col-1 s gr
% Polyline
n 219 439 m 219 379 l  159 379 l  159 439 l 
 clp gs col-1 s gr
% Polyline
n 339 439 m 339 379 l  279 379 l  279 439 l 
 clp gs col-1 s gr
% Polyline
n 399 439 m 399 379 l  339 379 l  339 439 l 
 clp gs col-1 s gr
% Polyline
n 459 439 m 459 379 l  399 379 l  399 439 l 
 clp gs col-1 s gr
% Polyline
n 399 319 m 399 259 l  339 259 l  339 319 l 
 clp gs col-1 s gr
% Polyline
n 399 199 m 399 139 l  339 139 l  339 199 l 
 clp gs col-1 s gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1651 a Fo(Figure)13 b(3.5)249 1688 y Fz(Memory)d(la)o(y)o(out)g
(of)h(2D)h(arra)o(y)e(section)g(for)h(Example)e(3.8.)15
b(The)c(shaded)f(blo)q(c)o(ks)g(are)h(sen)o(t.)249 1840
y Fs(Example)k(3.9)21 b FA(T)m(ransp)q(ose)15 b(a)f(matrix.)k(T)m(o)13
b(do)i(so,)f(w)o(e)g(create)i(a)e(datat)o(yp)q(e)h(that)f(describ)q(es)
249 1894 y(the)i(matrix)d(la)o(y)o(out)g(in)i(ro)o(w-ma)r(jor)e(order;)
i(w)o(e)h(send)f(the)h(matrix)d(with)h(this)h(datat)o(yp)q(e)h(and)249
1948 y(receiv)o(e)f(the)g(matrix)d(in)h(natural,)g(column-ma)r(jor)e
(order.)380 2002 y Fr(REAL)21 b(a\(100,100\),)e(b\(100,100\))380
2056 y(INTEGER)h(row,)h(xpose,)g(sizeofreal,)e(myrank,)i(ierr)380
2110 y(INTEGER)f(status\(MPI_STATUS_)o(SIZE\))249 2218
y(C)109 b(transpose)20 b(matrix)g(a)i(into)f(b)380 2325
y(CALL)g(MPI_COMM_RANK\(MP)o(I_COM)o(M_WOR)o(LD,)e(myrank,)h(ierr\))380
2433 y(CALL)h(MPI_TYPE_EXTENT\()o(MPI_R)o(EAL,)d(sizeofreal,)i(ierr\))p
eop
%%Page: 113 127
113 126 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(113)249 507 y Fr(C)109 b(create)20
b(datatype)h(for)g(one)g(row)249 561 y(C)109 b(\(vector)20
b(with)h(100)g(real)g(entries)g(and)g(stride)f(100\))380
615 y(CALL)h(MPI_TYPE_VECTOR\()o(100,)d(1,)k(100,)f(MPI_REAL,)f(row,)h
(ierr\))249 723 y(C)109 b(create)20 b(datatype)h(for)g(matrix)f(in)i
(row-major)e(order)249 777 y(C)109 b(\(one)21 b(hundred)f(copies)h(of)g
(the)g(row)g(datatype,)f(strided)h(one)g(word)249 831
y(C)109 b(apart;)20 b(the)i(successive)d(row)i(datatypes)f(are)i
(interleaved\))380 885 y(CALL)f(MPI_TYPE_HVECTOR)o(\(100,)d(1,)k
(sizeofreal,)d(row,)i(xpose,)g(ierr\))380 993 y(CALL)g
(MPI_TYPE_COMMIT\()o(xpose)o(,)e(ierr\))249 1101 y(C)109
b(send)21 b(matrix)f(in)i(row-major)e(order)g(and)i(receive)e(in)h
(column)g(major)g(order)380 1155 y(CALL)g(MPI_SENDRECV\(a,)d(1,)k
(xpose,)e(myrank,)h(0,)g(b,)h(100*100,)598 1209 y(MPI_REAL,)e(myrank,)g
(0,)h(MPI_COMM_WORLD,)e(status,)h(ierr\))249 1304 y Fs(Example)15
b(3.10)21 b FA(Eac)o(h)10 b(en)o(try)g(in)f(the)h(arra)o(y)g
Fw(pa)o(rticle)g FA(is)g(a)f(structure)j(whic)o(h)d(con)o(tains)h(sev)o
(eral)249 1358 y(\014elds.)28 b(One)18 b(of)e(this)i(\014elds)f
(consists)h(of)f(six)f(co)q(ordinates)i(\(lo)q(cation)f(and)f(v)o(elo)q
(cit)o(y\).)28 b(One)249 1412 y(needs)13 b(to)f(extract)h(the)g
(\014rst)g(three)g(\(lo)q(cation\))e(co)q(ordinates)i(of)e(all)g
(particles)i(and)e(send)i(them)249 1466 y(in)d(one)g(message.)16
b(The)11 b(relativ)o(e)e(displacemen)o(t)g(b)q(et)o(w)o(een)j
(successiv)o(e)g(triplets)e(of)g(co)q(ordinates)249 1520
y(ma)o(y)f(not)i(b)q(e)h(a)e(m)o(ultiple)f(of)h Fw(sizeof\(double\))p
FA(;)j(therefore,)g(the)f(Hv)o(ector)g(datat)o(yp)q(e)f(constructor)249
1574 y(is)j(used.)249 1628 y Fr(struct)21 b(Partstruct)314
1682 y({)314 1736 y(char)65 b(class;)42 b(/*)22 b(particle)e(class)h
(*/)314 1790 y(double)g(d[6];)64 b(/*)22 b(particle)e(coordinates)f(*/)
314 1844 y(char)65 b(b[7];)f(/*)22 b(some)f(additional)e(information)h
(*/)314 1898 y(};)249 1952 y(struct)h(Partstruct)85 b(particle[1000];)
249 2006 y(int)392 b(i,)21 b(dest,)g(rank;)249 2060 y(MPI_Comm)107
b(comm;)249 2114 y(MPI_Datatype)19 b(Locationtype;)41
b(/*)22 b(datatype)e(for)h(locations)f(*/)249 2222 y
(MPI_Type_hvector\(1)o(000,)e(3,)k(sizeof\(Partstruc)o(t\),)641
2276 y(MPI_DOUBLE,)e(&Locationtype\);)249 2330 y(MPI_Type_commit\(&L)o
(ocati)o(onty)o(pe\);)249 2438 y(MPI_Send\(particle[)o(0].d,)e(1,)j
(Locationtype,)f(dest,)g(tag,)h(comm\);)p eop
%%Page: 114 128
114 127 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(114)1256 b(Chapter)13 b(3)249
507 y Fs(3.3.4)48 b(Indexed)249 590 y FA(The)15 b(Indexed)h
(constructor)h(allo)o(ws)c(one)i(to)g(sp)q(ecify)g(a)g(noncon)o
(tiguous)f(data)h(la)o(y)o(out)e(where)249 644 y(displacemen)o(ts)19
b(b)q(et)o(w)o(een)h(successiv)o(e)i(blo)q(c)o(ks)d(need)h(not)f(b)q(e)
g(equal.)34 b(This)18 b(allo)o(ws)g(one)i(to)249 698
y(gather)d(arbitrary)g(en)o(tries)h(from)d(an)i(arra)o(y)g(and)g(send)g
(them)g(in)f(one)h(message,)g(or)g(receiv)o(e)249 752
y(one)d(message)g(and)f(scatter)j(the)e(receiv)o(ed)i(en)o(tries)f(in)o
(to)e(arbitrary)h(lo)q(cations)f(in)g(an)h(arra)o(y)m(.)249
877 y Fw(MPI)p 326 877 13 2 v 14 w(TYPE)p 448 877 V 15
w(INDEXED\(count,)22 b(a)o(rra)o(y)p 873 877 V 15 w(of)p
922 877 V 15 w(blo)q(cklengths,)i(a)o(rra)o(y)p 1271
877 V 15 w(of)p 1320 877 V 14 w(displacements,)g(oldt)o(yp)q(e,)249
931 y(newt)o(yp)q(e\))332 1006 y Fv(IN)158 b Fw(count)450
b Fv(n)o(um)o(b)q(er)14 b(of)f(blo)q(c)o(ks)332 1056
y(IN)158 b Fw(a)o(rra)o(y)p 620 1056 V 15 w(of)p 669
1056 V 14 w(blo)q(cklengths)185 b Fv(n)o(um)o(b)q(er)14
b(of)f(elemen)o(ts)h(p)q(er)f(blo)q(c)o(k)332 1105 y(IN)158
b Fw(a)o(rra)o(y)p 620 1105 V 15 w(of)p 669 1105 V 14
w(displacements)i Fv(displacemen)o(t)20 b(for)e(eac)o(h)g(blo)q(c)o(k,)
h(measured)1079 1159 y(as)13 b(n)o(um)o(b)q(er)h(of)f(elemen)o(ts)332
1209 y(IN)158 b Fw(oldt)o(yp)q(e)421 b Fv(old)14 b(datat)o(yp)q(e)332
1259 y(OUT)114 b Fw(newt)o(yp)q(e)406 b Fv(new)13 b(datat)o(yp)q(e)249
1369 y Fr(int)21 b(MPI)p 405 1369 14 2 v 15 w(Type)p
508 1369 V 15 w(indexed\(int)f(count,)g(int)h(*array)p
1156 1369 V 15 w(of)p 1215 1369 V 15 w(blocklengths,)540
1423 y(int)g(*array)p 762 1423 V 14 w(of)p 820 1423 V
16 w(displacements,)d(MPI)p 1228 1423 V 16 w(Datatype)i(oldtype,)540
1477 y(MPI)p 609 1477 V 15 w(Datatype)g(*newtype\))249
1561 y(MPI)p 318 1561 V 15 w(TYPE)p 421 1561 V 15 w(INDEXED\(COUNT,)f
(ARRAY)p 873 1561 V 15 w(OF)p 932 1561 V 15 w(BLOCKLENGTHS,)g(ARRAY)p
1362 1561 V 15 w(OF)p 1421 1561 V 15 w(DISPLACEMENTS,)540
1615 y(OLDTYPE,)h(NEWTYPE,)g(IERROR\))336 1669 y(INTEGER)h(COUNT,)f
(ARRAY)p 776 1669 V 15 w(OF)p 835 1669 V 15 w(BLOCKLENGTHS\(*\),)336
1723 y(ARRAY)p 449 1723 V 15 w(OF)p 508 1723 V 15 w
(DISPLACEMENTS\(*\),)e(OLDTYPE,)j(NEWTYPE,)f(IERROR)291
1807 y Fw(MPI)p 368 1807 13 2 v 14 w(TYPE)p 490 1807
V 14 w(INDEXED)e FA(allo)o(ws)f(replication)h(of)g(an)h(old)f(datat)o
(yp)q(e)h(in)o(to)f(a)g(sequence)j(of)249 1861 y(blo)q(c)o(ks)16
b(\(eac)o(h)h(blo)q(c)o(k)g(is)f(a)g(concatenation)g(of)g(the)h(old)f
(datat)o(yp)q(e\),)h(where)g(eac)o(h)g(blo)q(c)o(k)f(can)249
1915 y(con)o(tain)f(a)h(di\013eren)o(t)g(n)o(um)o(b)q(er)f(of)g(copies)
h(of)f Fw(oldt)o(yp)q(e)i FA(and)e(ha)o(v)o(e)h(a)f(di\013eren)o(t)i
(displacemen)o(t.)249 1969 y(All)c(blo)q(c)o(k)h(displacemen)o(ts)f
(are)i(measured)f(in)f(units)h(of)f(the)i Fw(oldt)o(yp)q(e)g
FA(exten)o(t.)k(The)14 b(action)g(of)249 2023 y(the)h(Indexed)f
(constructor)i(is)e(represen)o(ted)i(sc)o(hematically)d(in)g(Figure)h
(3.6.)249 2118 y Fs(Example)h(3.11)21 b FA(Let)14 b Fw(oldt)o(yp)q(e)h
FA(ha)o(v)o(e)f(t)o(yp)q(e)g(map)291 2172 y Ft(f)p FA(\()p
Fw(double)q Fp(;)7 b FA(0\))p Fp(;)g FA(\()p Fw(cha)o(r)p
Fp(;)g FA(8\))p Ft(g)p Fp(;)249 2226 y FA(with)k(exten)o(t)h(16.)k(Let)
c Fw(B)f(=)g(\(3,)g(1\))g FA(and)g(let)g Fw(D)g(=)g(\(4,)g(0\))p
FA(.)17 b(A)11 b(call)f(to)h Fw(MPI)p 1382 2226 V 15
w(TYPE)p 1505 2226 V 14 w(INDEXED\(2,)249 2280 y(B,)i(D,)g(oldt)o(yp)q
(e,)i(newt)o(yp)q(e\))h FA(returns)g(a)d(datat)o(yp)q(e)h(with)g(t)o
(yp)q(e)g(map)249 2367 y Ft(f)p FA(\()p Fw(double)q Fp(;)7
b FA(64\))p Fp(;)g FA(\()p Fw(cha)o(r)q Fp(;)g FA(72\))p
Fp(;)g FA(\()p Fw(double)p Fp(;)g FA(80\))p Fp(;)g FA(\()p
Fw(cha)o(r)p Fp(;)g FA(88\))p Fp(;)g FA(\()p Fw(double)p
Fp(;)g FA(96\))p Fp(;)g FA(\()p Fw(cha)o(r)p Fp(;)g FA(104\))p
Fp(;)249 2471 y FA(\()p Fw(double)r Fp(;)g FA(0\))p Fp(;)g
FA(\()p Fw(cha)o(r)p Fp(;)g FA(8\))p Ft(g)p Fp(:)p eop
%%Page: 115 129
115 128 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(115)403 466 y
 18945146 4736283 0 0 36706222 9472573 startTexFig
 403 466 a
%%BeginDocument: ../figures/advpt2pt-indexed.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-90.0 288.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 219 199 m 219 159 l  199 159 l  199 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 199 m 239 159 l  219 159 l  219 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 239 199 m 239 159 l  179 159 l  179 199 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 199 319 m 199 279 l  179 279 l  179 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 219 319 m 219 279 l  199 279 l  199 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 319 m 239 279 l  219 279 l  219 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 239 319 m 239 279 l  179 279 l  179 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 259 319 m 259 279 l  239 279 l  239 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 279 319 m 279 279 l  259 279 l  259 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 299 319 m 299 279 l  279 279 l  279 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 299 319 m 299 279 l  239 279 l  239 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 379 319 m 379 279 l  359 279 l  359 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 399 319 m 399 279 l  379 279 l  379 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 419 319 m 419 279 l  399 279 l  399 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 419 319 m 419 279 l  359 279 l  359 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 439 319 m 439 279 l  419 279 l  419 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 459 319 m 459 279 l  439 279 l  439 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 479 319 m 479 279 l  459 279 l  459 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 479 319 m 479 279 l  419 279 l  419 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 199 199 m 199 159 l  179 159 l  179 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 499 319 m 499 279 l  479 279 l  479 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
99 299 m 
gs 1 -1 scale (newtype) col-1 show gr
% Polyline
n 519 319 m 519 279 l  499 279 l  499 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 539 319 m 539 279 l  519 279 l  519 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 539 319 m 539 279 l  479 279 l  479 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 679 319 m 679 279 l  659 279 l  659 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 699 319 m 699 279 l  679 279 l  679 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 719 319 m 719 279 l  699 279 l  699 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 719 319 m 719 279 l  659 279 l  659 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 319 319 m 319 279 l  299 279 l  299 319 l  clp gs col-1 s gr
% Polyline
n 339 319 m 339 279 l  319 279 l  319 319 l  clp gs col-1 s gr
% Polyline
n 359 319 m 359 279 l  339 279 l  339 319 l  clp gs col-1 s gr
% Polyline
n 559 319 m 559 279 l  539 279 l  539 319 l  clp gs col-1 s gr
% Polyline
n 579 319 m 579 279 l  559 279 l  559 319 l  clp gs col-1 s gr
% Polyline
n 599 319 m 599 279 l  579 279 l  579 319 l  clp gs col-1 s gr
% Polyline
n 619 319 m 619 279 l  599 279 l  599 319 l  clp gs col-1 s gr
% Polyline
n 639 319 m 639 279 l  619 279 l  619 319 l  clp gs col-1 s gr
% Polyline
n 659 319 m 659 279 l  639 279 l  639 319 l  clp gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
99 179 m 
gs 1 -1 scale (oldtype) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
99 239 m 
gs 1 -1 scale (count = 3, blocklength = \(2,3,1\), displacement = \(0,3,8\)) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 828 a Fo(Figure)13 b(3.6)249 865 y Fz(Datat)o(yp)q(e)c
(constructor)g Fw(MPI)p 668 865 13 2 v 14 w(TYPE)p 790
865 V 14 w(INDEXED)p Fz(.)249 988 y FA(That)14 b(is,)f(three)i(copies)f
(of)f(the)h(old)f(t)o(yp)q(e)h(starting)g(at)f(displacemen)o(t)g(4)8
b Ft(\002)h FA(16)i(=)h(64,)h(and)g(one)249 1042 y(cop)o(y)h(starting)g
(at)g(displacemen)o(t)f(0.)291 1220 y(In)g(general,)h(assume)g(that)f
Fw(oldt)o(yp)q(e)i FA(has)f(t)o(yp)q(e)h(map)249 1307
y Ft(f)p FA(\()p Fp(ty)q(pe)362 1313 y Fk(0)382 1307
y Fp(;)7 b(disp)477 1313 y Fk(0)495 1307 y FA(\))p Fp(;)g(:)g(:)g(:)e
(;)i FA(\()p Fp(ty)q(pe)696 1313 y Fj(n)p Fm(\000)p Fk(1)762
1307 y Fp(;)g(disp)857 1313 y Fj(n)p Fm(\000)p Fk(1)921
1307 y FA(\))p Ft(g)p Fp(;)249 1395 y FA(with)13 b(exten)o(t)i
FB(ex)p FA(.)j(Let)d Fw(B)e FA(b)q(e)h(the)h Fw(a)o(rra)o(y)p
869 1395 V 15 w(of)p 918 1395 V 14 w(blo)q(cklengths)h
FA(argumen)o(t)c(and)i Fw(D)f FA(b)q(e)i(the)f Fw(a)o(rra)o(y)p
1683 1395 V 15 w(of-)p 249 1449 V 262 1449 a(displacements)g
FA(argumen)o(t.)i(The)d(new)h(datat)o(yp)q(e)f(has)f(a)h(t)o(yp)q(e)g
(map)e(with)i Fp(n)7 b Ft(\001)1490 1417 y Fi(P)1534
1428 y Fw(count)q Fm(\000)p Fk(1)1534 1461 y Fj(i)p Fk(=0)1683
1449 y Fw(B)p FA([)p Fw(i)p FA(])249 1502 y(en)o(tries:)249
1590 y Ft(f)p FA(\()p Fp(ty)q(pe)362 1596 y Fk(0)382
1590 y Fp(;)g(disp)477 1596 y Fk(0)504 1590 y FA(+)j
Fw(D)p FA([)p Fw(0)p FA(])e Ft(\001)g Fp(ex)p FA(\))p
Fp(;)f(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)893 1596 y
Fj(n)p Fm(\000)p Fk(1)959 1590 y Fp(;)g(disp)1054 1596
y Fj(n)p Fm(\000)p Fk(1)1128 1590 y FA(+)j Fw(D)p FA([)p
Fw(0)p FA(])e Ft(\001)g Fp(ex)p FA(\))p Fp(;)f(:)g(:)g(:)e(;)249
1693 y FA(\()p Fp(ty)q(pe)341 1699 y Fk(0)361 1693 y
Fp(;)i(disp)456 1699 y Fk(0)483 1693 y FA(+)j(\()p Fw(D)p
FA([)p Fw(0)p FA(])e(+)i Fw(B)p FA([)p Fw(0)p FA(])d
Ft(\000)j FA(1\))f Ft(\001)g Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)249
1797 y FA(\()p Fp(ty)q(pe)341 1803 y Fj(n)p Fm(\000)p
Fk(1)407 1797 y Fp(;)i(disp)502 1803 y Fj(n)p Fm(\000)p
Fk(1)576 1797 y FA(+)j(\()p Fw(D)p FA([)p Fw(0)p FA(])e(+)i
Fw(B)p FA([)p Fw(0)p FA(])d Ft(\000)j FA(1\))f Ft(\001)g
Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)249 1900 y FA(\()p
Fp(ty)q(pe)341 1906 y Fk(0)361 1900 y Fp(;)i(disp)456
1906 y Fk(0)483 1900 y FA(+)j Fw(D)p FA([)p Fw(count)g
Ft(\000)f Fw(1)p FA(])g Ft(\001)g Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)
i FA(\()p Fp(ty)q(pe)1021 1906 y Fj(n)p Fm(\000)p Fk(1)1086
1900 y Fp(;)g(disp)1181 1906 y Fj(n)p Fm(\000)p Fk(1)1255
1900 y FA(+)j Fw(D)p FA([)p Fw(count)g Ft(\000)f Fw(1)p
FA(])g Ft(\001)f Fp(ex)p FA(\))p Fp(;)f(:)g(:)g(:)e(;)249
2004 y FA(\()p Fp(ty)q(pe)341 2010 y Fk(0)361 2004 y
Fp(;)i(disp)456 2010 y Fk(0)483 2004 y FA(+)j(\()p Fw(D)p
FA([)p Fw(count)g Ft(\000)f Fw(1)p FA(])g(+)g Fw(B)p
FA([)p Fw(count)h Ft(\000)f Fw(1)p FA(])g Ft(\000)g FA(1\))h
Ft(\001)e Fp(ex)p FA(\))p Fp(;)f(:)g(:)g(:)e(;)249 2107
y FA(\()p Fp(ty)q(pe)341 2113 y Fj(n)p Fm(\000)p Fk(1)407
2107 y Fp(;)i(disp)502 2113 y Fj(n)p Fm(\000)p Fk(1)576
2107 y FA(+)j(\()p Fw(D)p FA([)p Fw(count)g Ft(\000)f
Fw(1)p FA(])g(+)g Fw(B)p FA([)p Fw(count)h Ft(\000)f
Fw(1)p FA(])g Ft(\000)g FA(1\))h Ft(\001)e Fp(ex)p FA(\))p
Ft(g)p Fp(:)291 2331 y FA(A)21 b(call)g(to)h Fw(MPI)p
563 2331 V 14 w(TYPE)p 685 2331 V 14 w(VECTOR\(count,)h(blo)q
(cklength,)i(stride,)f(oldt)o(yp)q(e,)h(newt)o(yp)q(e\))f
FA(is)249 2385 y(equiv)n(alen)o(t)13 b(to)h(a)g(call)f(to)g
Fw(MPI)p 735 2385 V 15 w(TYPE)p 858 2385 V 14 w(INDEXED\(count,)h(B,)f
(D,)g(oldt)o(yp)q(e,)i(newt)o(yp)q(e\))h FA(where)249
2472 y Fw(D)p FA([)p Fw(j)p FA(])11 b(=)h Fp(j)f Ft(\001)e
Fw(stride)q Fp(;)20 b(j)14 b FA(=)e(0)p Fp(;)7 b(:)g(:)g(:)e(;)i
Fw(count)i Ft(\000)h FA(1)p Fp(;)p eop
%%Page: 116 130
116 129 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(116)1256 b(Chapter)13 b(3)249
507 y FA(and)249 594 y Fw(B)p FA([)p Fw(j)p FA(])d(=)i
Fw(blo)q(cklength)r Fp(;)21 b(j)14 b FA(=)d(0)p Fp(;)c(:)g(:)g(:)e(;)i
Fw(count)j Ft(\000)f FA(1)p Fp(:)291 682 y FA(The)k(use)h(of)e(the)h
Fw(MPI)p 639 682 13 2 v 15 w(TYPE)p 762 682 V 14 w(INDEXED)f
FA(function)h(w)o(as)f(illustrated)h(in)g(Example)e(3.1,)h(on)249
736 y(page)k(102;)f(the)h(function)f(w)o(as)g(used)i(to)e(transfer)i
(the)f(upp)q(er)g(triangular)f(part)h(of)e(a)i(square)249
790 y(matrix.)249 873 y Fs(3.3.5)48 b(Hindexed)249 956
y FA(As)16 b(with)g(the)g(V)m(ector)g(and)g(Hv)o(ector)g(constructors,)
i(it)d(is)h(usually)f(con)o(v)o(enien)o(t)h(to)g(measure)249
1010 y(displacemen)o(ts)g(in)g(m)o(ultiples)f(of)h(the)h(exten)o(t)h
(of)e(the)h(oldt)o(yp)q(e,)g(but)g(sometimes)d(necessary)249
1064 y(to)h(allo)o(w)f(for)h(arbitrary)h(displacemen)o(ts.)22
b(The)16 b(Hindexed)g(constructor)h(satis\014es)f(the)g(later)249
1117 y(need.)249 1242 y Fw(MPI)p 326 1242 V 14 w(TYPE)p
448 1242 V 15 w(HINDEXED\()8 b(count,)j(a)o(rra)o(y)p
899 1242 V 15 w(of)p 948 1242 V 15 w(blo)q(cklengths,)g(a)o(rra)o(y)p
1284 1242 V 15 w(of)p 1333 1242 V 15 w(displacements,)g(oldt)o(yp)q(e,)
249 1296 y(newt)o(yp)q(e\))332 1371 y Fv(IN)158 b Fw(count)450
b Fv(n)o(um)o(b)q(er)14 b(of)f(blo)q(c)o(ks)332 1421
y(IN)158 b Fw(a)o(rra)o(y)p 620 1421 V 15 w(of)p 669
1421 V 14 w(blo)q(cklengths)185 b Fv(n)o(um)o(b)q(er)14
b(of)f(elemen)o(ts)h(p)q(er)f(blo)q(c)o(k)332 1471 y(IN)158
b Fw(a)o(rra)o(y)p 620 1471 V 15 w(of)p 669 1471 V 14
w(displacements)i Fv(b)o(yte)14 b(displacemen)o(t)h(for)e(eac)o(h)g
(blo)q(c)o(k)332 1520 y(IN)158 b Fw(oldt)o(yp)q(e)421
b Fv(old)14 b(datat)o(yp)q(e)332 1570 y(OUT)114 b Fw(newt)o(yp)q(e)406
b Fv(new)13 b(datat)o(yp)q(e)249 1680 y Fr(int)21 b(MPI)p
405 1680 14 2 v 15 w(Type)p 508 1680 V 15 w(hindexed\(int)e(count,)i
(int)g(*array)p 1178 1680 V 15 w(of)p 1237 1680 V 15
w(blocklengths,)540 1734 y(MPI)p 609 1734 V 15 w(Aint)g(*array)p
865 1734 V 14 w(of)p 923 1734 V 15 w(displacements,)e(MPI)p
1331 1734 V 15 w(Datatype)i(oldtype,)540 1788 y(MPI)p
609 1788 V 15 w(Datatype)f(*newtype\))249 1872 y(MPI)p
318 1872 V 15 w(TYPE)p 421 1872 V 15 w(HINDEXED\(COUNT,)f(ARRAY)p
895 1872 V 14 w(OF)p 953 1872 V 16 w(BLOCKLENGTHS,)540
1926 y(ARRAY)p 653 1926 V 14 w(OF)p 711 1926 V 16 w(DISPLACEMENTS,)f
(OLDTYPE,)j(NEWTYPE,)f(IERROR\))336 1980 y(INTEGER)h(COUNT,)f(ARRAY)p
776 1980 V 15 w(OF)p 835 1980 V 15 w(BLOCKLENGTHS\(*\),)336
2034 y(ARRAY)p 449 2034 V 15 w(OF)p 508 2034 V 15 w
(DISPLACEMENTS\(*\),)e(OLDTYPE,)j(NEWTYPE,)f(IERROR)291
2118 y Fw(MPI)p 368 2118 13 2 v 14 w(TYPE)p 490 2118
V 14 w(HINDEXED)e FA(is)g(iden)o(tical)f(to)h Fw(MPI)p
1077 2118 V 14 w(TYPE)p 1199 2118 V 14 w(INDEXED)p FA(,)f(except)j
(that)e(blo)q(c)o(k)249 2172 y(displacemen)o(ts)13 b(in)g
Fw(a)o(rra)o(y)p 648 2172 V 15 w(of)p 697 2172 V 14 w(displacements)i
FA(are)f(sp)q(eci\014ed)h(in)e(b)o(ytes,)g(rather)i(than)e(in)g(m)o
(ulti-)249 2226 y(ples)j(of)g(the)g Fw(oldt)o(yp)q(e)h
FA(exten)o(t.)25 b(The)16 b(action)g(of)f(the)i(Hindexed)f(constructor)
i(is)e(represen)o(ted)249 2280 y(sc)o(hematically)c(in)i(Figure)g(3.7.)
p eop
%%Page: 117 131
117 130 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(117)403 466 y
 18945146 5872993 0 0 29601792 9472573 startTexFig
 403 466 a
%%BeginDocument: ../figures/advpt2pt-hindexed.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-90.0 288.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 219 199 m 219 159 l  199 159 l  199 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 199 m 239 159 l  219 159 l  219 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 239 199 m 239 159 l  179 159 l  179 199 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 199 319 m 199 279 l  179 279 l  179 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 219 319 m 219 279 l  199 279 l  199 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 319 m 239 279 l  219 279 l  219 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 239 319 m 239 279 l  179 279 l  179 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 259 319 m 259 279 l  239 279 l  239 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 279 319 m 279 279 l  259 279 l  259 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 299 319 m 299 279 l  279 279 l  279 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 299 319 m 299 279 l  239 279 l  239 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 339 319 m 339 279 l  319 279 l  319 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 359 319 m 359 279 l  339 279 l  339 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 379 319 m 379 279 l  359 279 l  359 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 379 319 m 379 279 l  319 279 l  319 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 399 319 m 399 279 l  379 279 l  379 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 199 199 m 199 159 l  179 159 l  179 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 419 319 m 419 279 l  399 279 l  399 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
99 299 m 
gs 1 -1 scale (newtype) col-1 show gr
% Polyline
n 439 319 m 439 279 l  419 279 l  419 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 439 319 m 439 279 l  379 279 l  379 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 459 319 m 459 279 l  439 279 l  439 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 479 319 m 479 279 l  459 279 l  459 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 499 319 m 499 279 l  479 279 l  479 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 499 319 m 499 279 l  439 279 l  439 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 559 319 m 559 279 l  539 279 l  539 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 579 319 m 579 279 l  559 279 l  559 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 599 319 m 599 279 l  579 279 l  579 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 599 319 m 599 279 l  539 279 l  539 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 319 319 m 319 279 l  299 279 l  299 319 l  clp gs col-1 s gr
% Polyline
n 519 319 m 519 279 l  499 279 l  499 319 l  clp gs col-1 s gr
% Polyline
n 539 319 m 539 279 l  519 279 l  519 319 l  clp gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
99 179 m 
gs 1 -1 scale (oldtype) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
99 239 m 
gs 1 -1 scale (count = 3, blocklength = \(2,3,1\), displacement = \(0,7,18\)) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 900 a Fo(Figure)13 b(3.7)249 937 y Fz(Datat)o(yp)q(e)c
(constructor)g Fw(MPI)p 668 937 13 2 v 14 w(TYPE)p 790
937 V 14 w(HINDEXED)p Fz(.)249 1060 y Fs(Example)15 b(3.12)21
b FA(W)m(e)10 b(use)i(the)g(same)e(argumen)o(ts)g(as)h(for)g
Fw(MPI)p 1244 1060 V 14 w(TYPE)p 1366 1060 V 14 w(INDEXED)p
FA(,)f(in)g(Exam-)249 1114 y(ple)15 b(3.11.)21 b(Th)o(us,)15
b Fw(oldt)o(yp)q(e)h FA(has)f(t)o(yp)q(e)h(map,)d Ft(f)p
FA(\()p Fw(double)r Fp(;)7 b FA(0\))p Fp(;)g FA(\()p
Fw(cha)o(r)p Fp(;)g FA(8\))p Ft(g)p Fp(;)14 b FA(with)h(exten)o(t)h
(16;)e Fw(B)h(=)249 1168 y(\(3,)e(1\))p FA(,)g(and)h
Fw(D)g(=)g(\(4,)f(0\))p FA(.)18 b(A)c(call)f(to)g Fw(MPI)p
921 1168 V 15 w(TYPE)p 1044 1168 V 14 w(HINDEXED\(2,)f(B,)h(D,)h(oldt)o
(yp)q(e,)g(newt)o(yp)q(e\))249 1222 y FA(returns)i(a)d(datat)o(yp)q(e)h
(with)g(t)o(yp)q(e)g(map)249 1309 y Ft(f)p FA(\()p Fw(double)q
Fp(;)7 b FA(4\))p Fp(;)g FA(\()p Fw(cha)o(r)q Fp(;)g
FA(12\))p Fp(;)g FA(\()p Fw(double)p Fp(;)g FA(20\))p
Fp(;)g FA(\()p Fw(cha)o(r)p Fp(;)g FA(28\))p Fp(;)g FA(\()p
Fw(double)p Fp(;)g FA(36\))p Fp(;)g FA(\()p Fw(cha)o(r)p
Fp(;)g FA(44\))p Fp(;)249 1413 y FA(\()p Fw(double)r
Fp(;)g FA(0\))p Fp(;)g FA(\()p Fw(cha)o(r)p Fp(;)g FA(8\))p
Ft(g)p Fp(:)291 1500 y FA(The)20 b(partial)f(o)o(v)o(erlap)g(b)q(et)o
(w)o(een)j(the)e(en)o(tries)h(of)f(t)o(yp)q(e)g Fq(DOUBLE)g
FA(implies)e(that)i(a)g(t)o(yp)q(e)249 1554 y(matc)o(hing)14
b(error)i(will)e(o)q(ccur)i(if)e(this)i(datat)o(yp)q(e)f(is)g(used)i
(in)d(a)h(send)i(op)q(eration.)22 b(T)m(o)14 b(get)i(the)249
1608 y(same)d(datat)o(yp)q(e)h(as)g(in)g(Example)e(3.11,)g(the)j(call)e
(w)o(ould)g(ha)o(v)o(e)h Fw(D)f(=)h(\(64,)f(0\))p FA(.)291
1786 y(In)g(general,)h(assume)g(that)f Fw(oldt)o(yp)q(e)i
FA(has)f(t)o(yp)q(e)h(map)249 1873 y Ft(f)p FA(\()p Fp(ty)q(pe)362
1879 y Fk(0)382 1873 y Fp(;)7 b(disp)477 1879 y Fk(0)495
1873 y FA(\))p Fp(;)g(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)696
1879 y Fj(n)p Fm(\000)p Fk(1)762 1873 y Fp(;)g(disp)857
1879 y Fj(n)p Fm(\000)p Fk(1)921 1873 y FA(\))p Ft(g)p
Fp(;)249 1960 y FA(with)14 b(exten)o(t)i Fp(ex)p FA(.)k(Let)15
b Fw(B)f FA(b)q(e)h(the)g Fw(a)o(rra)o(y)p 880 1960 V
15 w(of)p 929 1960 V 14 w(blo)q(cklength)i FA(argumen)o(t)c(and)h
Fw(D)h FA(b)q(e)g(the)g Fw(a)o(rra)o(y)p 1683 1960 V
15 w(of-)p 249 2014 V 262 2014 a(displacements)f FA(argumen)o(t.)i(The)
d(new)h(datat)o(yp)q(e)f(has)f(a)h(t)o(yp)q(e)g(map)e(with)i
Fp(n)7 b Ft(\001)1490 1983 y Fi(P)1534 1993 y Fw(count)q
Fm(\000)p Fk(1)1534 2027 y Fj(i)p Fk(=0)1683 2014 y Fw(B)p
FA([)p Fw(i)p FA(])249 2068 y(en)o(tries:)249 2155 y
Ft(f)p FA(\()p Fp(ty)q(pe)362 2161 y Fk(0)382 2155 y
Fp(;)g(disp)477 2161 y Fk(0)504 2155 y FA(+)j Fw(D)p
FA([)p Fw(0)p FA(])n(\))p Fp(;)d(:)g(:)g(:)e(;)i FA(\()p
Fp(ty)q(pe)820 2161 y Fj(n)p Fm(\000)p Fk(1)886 2155
y Fp(;)g(disp)981 2161 y Fj(n)p Fm(\000)p Fk(1)1055 2155
y FA(+)j Fw(D)p FA([)p Fw(0)p FA(])n(\))p Fp(;)d(:)g(:)g(:)e(;)249
2259 y FA(\()p Fp(ty)q(pe)341 2265 y Fk(0)361 2259 y
Fp(;)i(disp)456 2265 y Fk(0)483 2259 y FA(+)j Fw(D)p
FA([)p Fw(0)p FA(])e(+)h(\()p Fw(B)p FA([)p Fw(0)p FA(])f
Ft(\000)i FA(1\))f Ft(\001)g Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)249
2362 y FA(\()p Fp(ty)q(pe)341 2368 y Fj(n)p Fm(\000)p
Fk(1)407 2362 y Fp(;)i(disp)502 2368 y Fj(n)p Fm(\000)p
Fk(1)576 2362 y FA(+)j Fw(D)p FA([)p Fw(0)p FA(])e(+)h(\()p
Fw(B)p FA([)p Fw(0)p FA(])f Ft(\000)i FA(1\))f Ft(\001)g
Fp(ex)p FA(\))p Fp(;)e(:)g(:)g(:)e(;)249 2466 y FA(\()p
Fp(ty)q(pe)341 2472 y Fk(0)361 2466 y Fp(;)i(disp)456
2472 y Fk(0)483 2466 y FA(+)j Fw(D)p FA([)p Fw(count)g
Ft(\000)f Fw(1)p FA(]\))p Fp(;)e(:)g(:)g(:)t(;)g FA(\()p
Fp(ty)q(pe)947 2472 y Fj(n)p Fm(\000)p Fk(1)1013 2466
y Fp(;)g(disp)1108 2472 y Fj(n)p Fm(\000)p Fk(1)1182
2466 y FA(+)j Fw(D)p FA([)p Fw(count)g Ft(\000)f Fw(1)p
FA(])o(\))p Fp(;)e(:)g(:)g(:)e(;)p eop
%%Page: 118 132
118 131 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(118)1256 b(Chapter)13 b(3)249
507 y FA(\()p Fp(ty)q(pe)341 513 y Fk(0)361 507 y Fp(;)7
b(disp)456 513 y Fk(0)483 507 y FA(+)j Fw(D)p FA([)p
Fw(count)g Ft(\000)f Fw(1)p FA(])g(+)g(\()p Fw(B)p FA([)p
Fw(count)h Ft(\000)f Fw(1)p FA(])g Ft(\000)g FA(1\))h
Ft(\001)e Fp(ex)p FA(\))p Fp(;)f(:)g(:)g(:)e(;)249 611
y FA(\()p Fp(ty)q(pe)341 617 y Fj(n)p Fm(\000)p Fk(1)407
611 y Fp(;)i(disp)502 617 y Fj(n)p Fm(\000)p Fk(1)576
611 y FA(+)j Fw(D)p FA([)p Fw(count)g Ft(\000)f Fw(1)p
FA(])g(+)g(\()p Fw(B)p FA([)p Fw(count)h Ft(\000)f Fw(1)p
FA(])g Ft(\000)g FA(1\))h Ft(\001)e Fp(ex)p FA(\))p Ft(g)p
Fp(:)249 864 y Fs(3.3.6)48 b(Struct)208 1018 y Fw(MPI)p
285 1018 13 2 v 14 w(TYPE)p 407 1018 V 14 w(STRUCT\(count,)10
b(a)o(rra)o(y)p 802 1018 V 15 w(of)p 851 1018 V 15 w(blo)q(cklengths,)h
(a)o(rra)o(y)p 1187 1018 V 15 w(of)p 1236 1018 V 15 w(displacements,)g
(a)o(rra)o(y)p 1597 1018 V 15 w(of)p 1646 1018 V 14 w(t)o(yp)q(es,)249
1071 y(newt)o(yp)q(e\))332 1146 y Fv(IN)158 b Fw(count)450
b Fv(n)o(um)o(b)q(er)14 b(of)f(blo)q(c)o(ks)332 1196
y(IN)158 b Fw(a)o(rra)o(y)p 620 1196 V 15 w(of)p 669
1196 V 14 w(blo)q(cklengths)185 b Fv(n)o(um)o(b)q(er)14
b(of)f(elemen)o(ts)h(p)q(er)f(blo)q(c)o(k)332 1246 y(IN)158
b Fw(a)o(rra)o(y)p 620 1246 V 15 w(of)p 669 1246 V 14
w(displacements)i Fv(b)o(yte)14 b(displacemen)o(t)h(for)e(eac)o(h)g
(blo)q(c)o(k)332 1296 y(IN)158 b Fw(a)o(rra)o(y)p 620
1296 V 15 w(of)p 669 1296 V 14 w(t)o(yp)q(es)309 b Fv(t)o(yp)q(e)14
b(of)e(elemen)o(ts)i(in)g(eac)o(h)g(blo)q(c)o(k)332 1345
y(OUT)114 b Fw(newt)o(yp)q(e)406 b Fv(new)13 b(datat)o(yp)q(e)249
1456 y Fr(int)21 b(MPI)p 405 1456 14 2 v 15 w(Type)p
508 1456 V 15 w(struct\(int)f(count,)g(int)i(*array)p
1135 1456 V 14 w(of)p 1193 1456 V 15 w(blocklengths,)540
1510 y(MPI)p 609 1510 V 15 w(Aint)f(*array)p 865 1510
V 14 w(of)p 923 1510 V 15 w(displacements,)540 1564 y(MPI)p
609 1564 V 15 w(Datatype)f(*array)p 952 1564 V 14 w(of)p
1010 1564 V 16 w(types,)g(MPI)p 1244 1564 V 15 w(Datatype)g(*newtype\))
249 1647 y(MPI)p 318 1647 V 15 w(TYPE)p 421 1647 V 15
w(STRUCT\(COUNT,)f(ARRAY)p 851 1647 V 15 w(OF)p 910 1647
V 15 w(BLOCKLENGTHS,)g(ARRAY)p 1340 1647 V 15 w(OF)p
1399 1647 V 15 w(DISPLACEMENTS,)540 1701 y(ARRAY)p 653
1701 V 14 w(OF)p 711 1701 V 16 w(TYPES,)h(NEWTYPE,)g(IERROR\))336
1755 y(INTEGER)h(COUNT,)f(ARRAY)p 776 1755 V 15 w(OF)p
835 1755 V 15 w(BLOCKLENGTHS\(*\),)336 1809 y(ARRAY)p
449 1809 V 15 w(OF)p 508 1809 V 15 w(DISPLACEMENTS\(*\),)e(ARRAY)p
1025 1809 V 15 w(OF)p 1084 1809 V 15 w(TYPES\(*\),)i(NEWTYPE,)g(IERROR)
291 1893 y Fw(MPI)p 368 1893 13 2 v 14 w(TYPE)p 490 1893
V 14 w(STRUCT)13 b FA(is)h(the)h(most)d(general)i(t)o(yp)q(e)h
(constructor.)20 b(It)14 b(further)g(generalizes)249
1947 y Fw(MPI)p 326 1947 V 14 w(TYPE)p 448 1947 V 15
w(HINDEXED)19 b FA(in)g(that)h(it)g(allo)o(ws)e(eac)o(h)i(blo)q(c)o(k)g
(to)g(consist)g(of)f(replications)h(of)249 2001 y(di\013eren)o(t)14
b(datat)o(yp)q(es.)19 b(The)14 b(in)o(ten)o(t)f(is)g(to)g(allo)o(w)f
(descriptions)i(of)f(arra)o(ys)g(of)g(structures,)i(as)f(a)249
2055 y(single)g(datat)o(yp)q(e.)21 b(The)15 b(action)f(of)g(the)h
(Struct)h(constructor)g(is)f(represen)o(ted)i(sc)o(hematically)249
2109 y(in)c(Figure)h(3.8.)p eop
%%Page: 119 133
119 132 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(119)403 466 y
 18945146 6251895 0 0 28417720 9472573 startTexFig
 403 466 a
%%BeginDocument: ../figures/advpt2pt-struct.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-90.0 288.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 219 199 m 219 159 l  199 159 l  199 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 199 m 239 159 l  219 159 l  219 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 239 199 m 239 159 l  179 159 l  179 199 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 199 319 m 199 279 l  179 279 l  179 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 219 319 m 219 279 l  199 279 l  199 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 319 m 239 279 l  219 279 l  219 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 239 319 m 239 279 l  179 279 l  179 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 259 319 m 259 279 l  239 279 l  239 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 279 319 m 279 279 l  259 279 l  259 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 299 319 m 299 279 l  279 279 l  279 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
2.000 setlinewidth
% Polyline
n 299 319 m 299 279 l  239 279 l  239 319 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 319 199 m 319 159 l  299 159 l  299 199 l  clp gs 0.90 setgray fill gr
gs col-1 s gr
% Polyline
n 299 199 m 299 159 l  279 159 l  279 199 l  clp gs 0.90 setgray fill gr
gs col-1 s gr
% Polyline
n 299 199 m 299 159 l  279 159 l  279 199 l  clp gs 0.90 setgray fill gr
gs col-1 s gr
% Polyline
n 359 319 m 359 279 l  339 279 l  339 319 l  clp gs 0.90 setgray fill gr
gs col-1 s gr
% Polyline
n 339 319 m 339 279 l  319 279 l  319 319 l  clp gs 0.90 setgray fill gr
gs col-1 s gr
% Polyline
n 339 319 m 339 279 l  319 279 l  319 319 l  clp gs 0.90 setgray fill gr
gs col-1 s gr
% Polyline
n 399 319 m 399 279 l  379 279 l  379 319 l  clp gs 0.90 setgray fill gr
gs col-1 s gr
% Polyline
n 379 319 m 379 279 l  359 279 l  359 319 l  clp gs 0.90 setgray fill gr
gs col-1 s gr
% Polyline
n 199 199 m 199 159 l  179 159 l  179 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 379 319 m 379 279 l  359 279 l  359 319 l  clp gs 0.90 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
99 299 m 
gs 1 -1 scale (newtype) col-1 show gr
% Polyline
n 439 319 m 439 279 l  419 279 l  419 319 l  clp gs 0.90 setgray fill gr
gs col-1 s gr
% Polyline
n 419 319 m 419 279 l  399 279 l  399 319 l  clp gs 0.90 setgray fill gr
gs col-1 s gr
% Polyline
n 419 319 m 419 279 l  399 279 l  399 319 l  clp gs 0.90 setgray fill gr
gs col-1 s gr
% Polyline
n 319 319 m 319 279 l  299 279 l  299 319 l  clp gs col-1 s gr
% Polyline
n 459 319 m 459 279 l  439 279 l  439 319 l  clp gs col-1 s gr
% Polyline
n 479 319 m 479 279 l  459 279 l  459 319 l  clp gs col-1 s gr
% Polyline
n 499 319 m 499 279 l  479 279 l  479 319 l  clp gs col-1 s gr
2.000 setlinewidth
% Polyline
n 379 199 m 359 199 l  359 159 l  379 159 l  clp gs 0.20 setgray fill gr
gs col-1 s gr
% Polyline
n 579 319 m 579 279 l  559 279 l  559 319 l  clp gs 0.20 setgray fill gr
gs col-1 s gr
% Polyline
n 559 319 m 559 279 l  539 279 l  539 319 l  clp gs 0.20 setgray fill gr
gs col-1 s gr
% Polyline
n 539 319 m 539 279 l  519 279 l  519 319 l  clp gs 0.20 setgray fill gr
gs col-1 s gr
% Polyline
n 519 319 m 519 279 l  499 279 l  499 319 l  clp gs 0.20 setgray fill gr
gs col-1 s gr
% Polyline
n 319 199 m 319 159 l  279 159 l  279 199 l  clp gs col-1 s gr
% Polyline
n 359 319 m 359 279 l  319 279 l  319 319 l  clp gs col-1 s gr
% Polyline
n 399 319 m 399 279 l  359 279 l  359 319 l  clp gs col-1 s gr
% Polyline
n 439 319 m 439 279 l  399 279 l  399 319 l  clp gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
99 179 m 
gs 1 -1 scale (oldtypes) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
99 239 m 
gs 1 -1 scale (count = 3, blocklength = \(2,3,4\), displacement = \(0,7,16\)) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 924 a Fo(Figure)13 b(3.8)249 961 y Fz(Datat)o(yp)q(e)c
(constructor)g Fw(MPI)p 668 961 13 2 v 14 w(TYPE)p 790
961 V 14 w(STRUCT)p Fz(.)249 1084 y Fs(Example)15 b(3.13)21
b FA(Let)14 b Fw(t)o(yp)q(e1)h FA(ha)o(v)o(e)f(t)o(yp)q(e)g(map)291
1138 y Ft(f)p FA(\()p Fw(double)q Fp(;)7 b FA(0\))p Fp(;)g
FA(\()p Fw(cha)o(r)p Fp(;)g FA(8\))p Ft(g)p Fp(;)249
1192 y FA(with)15 b(exten)o(t)h(16.)23 b(Let)15 b Fw(B)g(=)h(\(2,)f(1,)
g(3\))p FA(,)g Fw(D)h(=)f(\(0,)h(16,)e(26\))p FA(,)h(and)h
Fw(T)f(=)h(\(MPI)p 1470 1192 V 14 w(FLO)o(A)m(T,)e(t)o(yp)q(e1,)249
1246 y(MPI)p 326 1246 V 14 w(CHAR\))p FA(.)k(Then)h(a)f(call)f(to)h
Fw(MPI)p 859 1246 V 15 w(TYPE)p 982 1246 V 14 w(STRUCT\(3,)g(B,)f(D,)h
(T,)g(newt)o(yp)q(e\))j FA(returns)f(a)249 1300 y(datat)o(yp)q(e)14
b(with)g(t)o(yp)q(e)g(map)249 1387 y Ft(f)p FA(\()p Fw(\015oat)p
Fp(;)7 b FA(0\))p Fp(;)g FA(\()p Fw(\015oat)o Fp(;)g
FA(4\))p Fp(;)g FA(\()p Fw(double)p Fp(;)g FA(16\))p
Fp(;)g FA(\()p Fw(cha)o(r)p Fp(;)g FA(24\))p Fp(;)g FA(\()p
Fw(cha)o(r)q Fp(;)g FA(26\))p Fp(;)g FA(\()p Fw(cha)o(r)p
Fp(;)g FA(27\))p Fp(;)g FA(\()p Fw(cha)o(r)p Fp(;)g FA(28\))p
Ft(g)p Fp(:)249 1474 y FA(That)20 b(is,)h(t)o(w)o(o)f(copies)g(of)g
Fq(MPI)p 759 1474 12 2 v 12 w(FLO)o(A)m(T)g FA(starting)g(at)g(0,)h
(follo)o(w)o(ed)d(b)o(y)i(one)g(cop)o(y)g(of)g Fw(t)o(yp)q(e1)249
1528 y FA(starting)15 b(at)h(16,)f(follo)o(w)o(ed)e(b)o(y)j(three)g
(copies)g(of)f Fq(MPI)p 1100 1528 V 13 w(CHAR)p FA(,)f(starting)h(at)h
(26.)22 b(\(W)m(e)15 b(assume)249 1582 y(that)f(a)g(\015oat)f(o)q
(ccupies)i(four)f(b)o(ytes.\))291 1678 y(In)f(general,)h(let)g
Fw(T)g FA(b)q(e)h(the)f Fw(a)o(rra)o(y)p 814 1678 13
2 v 15 w(of)p 863 1678 V 15 w(t)o(yp)q(es)g FA(argumen)o(t,)f(where)i
Fw(T[i])f FA(is)f(a)h(handle)g(to,)249 1765 y Fp(ty)q(pemap)404
1771 y Fj(i)431 1765 y FA(=)e Ft(f)p FA(\()p Fp(ty)q(pe)588
1748 y Fj(i)588 1775 y Fk(0)607 1765 y Fp(;)7 b(disp)702
1748 y Fj(i)702 1775 y Fk(0)720 1765 y FA(\))p Fp(;)g(:)g(:)g(:)e(;)i
FA(\()p Fp(ty)q(pe)921 1748 y Fj(i)921 1775 y(n)942 1779
y Fh(i)956 1775 y Fm(\000)p Fk(1)1000 1765 y Fp(;)g(disp)1095
1748 y Fj(i)1095 1775 y(n)1116 1779 y Fh(i)1129 1775
y Fm(\000)p Fk(1)1173 1765 y FA(\))p Ft(g)p Fp(;)249
1852 y FA(with)20 b(exten)o(t)h Fp(ex)526 1858 y Fj(i)540
1852 y FA(.)37 b(Let)21 b Fw(B)f FA(b)q(e)h(the)g Fw(a)o(rra)o(y)p
946 1852 V 15 w(of)p 995 1852 V 14 w(blo)q(cklength)h
FA(argumen)o(t)e(and)g Fw(D)g FA(b)q(e)h(the)g Fw(a)o(r-)249
1906 y(ra)o(y)p 303 1906 V 15 w(of)p 352 1906 V 15 w(displacements)10
b FA(argumen)o(t.)15 b(Let)10 b Fw(c)g FA(b)q(e)g(the)g
Fw(count)g FA(argumen)o(t.)15 b(Then)10 b(the)g(new)g(datat)o(yp)q(e)
249 1960 y(has)k(a)g(t)o(yp)q(e)g(map)e(with)638 1929
y Fi(P)682 1939 y Fw(c)p Fm(\000)p Fk(1)682 1972 y Fj(i)p
Fk(=0)752 1960 y Fw(B)p FA([)p Fw(i)p FA(])c Ft(\001)g
Fp(n)867 1966 y Fj(i)895 1960 y FA(en)o(tries:)249 2047
y Ft(f)p FA(\()p Fp(ty)q(pe)362 2030 y Fk(0)362 2057
y(0)382 2047 y Fp(;)f(disp)477 2030 y Fk(0)477 2057 y(0)504
2047 y FA(+)j Fw(D)p FA([)p Fw(0)p FA(])n(\))p Fp(;)d(:)g(:)g(:)e(;)i
FA(\()p Fp(ty)q(pe)820 2030 y Fk(0)820 2057 y Fj(n)841
2061 y Fg(0)860 2047 y Fp(;)g(disp)955 2030 y Fk(0)955
2057 y Fj(n)976 2061 y Fg(0)1003 2047 y FA(+)i Fw(D)p
FA([)p Fw(0)p FA(])o(\))p Fp(;)e(:)g(:)g(:)e(;)249 2151
y FA(\()p Fp(ty)q(pe)341 2133 y Fk(0)341 2161 y(0)361
2151 y Fp(;)i(disp)456 2133 y Fk(0)456 2161 y(0)483 2151
y FA(+)j Fw(D)p FA([)p Fw(0)p FA(])e(+)h(\()p Fw(B)p
FA([)p Fw(0)p FA(])f Ft(\000)i FA(1\))f Ft(\001)g Fp(ex)898
2157 y Fk(0)916 2151 y FA(\))p Fp(;)e(:)g(:)g(:)e(;)249
2254 y FA(\()p Fp(ty)q(pe)341 2237 y Fk(0)341 2264 y
Fj(n)362 2268 y Fg(0)381 2254 y Fp(;)i(disp)476 2237
y Fk(0)476 2264 y Fj(n)497 2268 y Fg(0)524 2254 y FA(+)i
Fw(D)p FA([)p Fw(0)p FA(])f(+)i(\()p Fw(B)p FA([)p Fw(0)p
FA(])e Ft(\000)h Fw(1)p FA(\))g Ft(\001)g Fp(ex)938 2260
y Fk(0)957 2254 y FA(\))p Fp(;)e(:)g(:)g(:)e(;)249 2358
y FA(\()p Fp(ty)q(pe)341 2340 y Fw(c)p Fm(\000)p Fk(1)341
2369 y(0)405 2358 y Fp(;)i(disp)500 2340 y Fw(c)p Fm(\000)p
Fk(1)500 2369 y(0)572 2358 y FA(+)j Fw(D)p FA([)p Fw(c)f
Ft(\000)g Fw(1)p FA(]\))p Fp(;)e(:)g(:)g(:)e(;)i FA(\()p
Fp(ty)q(pe)958 2340 y Fw(c)p Fm(\000)p Fk(1)958 2369
y Fj(n)979 2377 y Fw(c)p Ff(\000)p Fg(1)1036 2369 y Fm(\000)p
Fk(1)1081 2358 y Fp(;)g(disp)1176 2340 y Fw(c)p Fm(\000)p
Fk(1)1176 2369 y Fj(n)1197 2377 y Fw(c)p Ff(\000)p Fg(1)1253
2369 y Fm(\000)p Fk(1)1307 2358 y FA(+)i Fw(D)p FA([)p
Fw(c)g Ft(\000)h Fw(1)p FA(])o(\))p Fp(;)d(:)g(:)g(:)e(;)249
2461 y FA(\()p Fp(ty)q(pe)341 2443 y Fw(c)p Fm(\000)p
Fk(1)341 2472 y(0)405 2461 y Fp(;)i(disp)500 2443 y Fw(c)p
Fm(\000)p Fk(1)500 2472 y(0)572 2461 y FA(+)j Fw(D)p
FA([)p Fw(c)f Ft(\000)g Fw(1)p FA(])g(+)g(\()p Fw(B)p
FA([)p Fw(c)g Ft(\000)h Fw(1)p FA(])e Ft(\000)i FA(1\))f
Ft(\001)g Fp(ex)1125 2467 y Fw(c)p Fm(\000)p Fk(1)1188
2461 y FA(\))p Fp(;)e(:)g(:)g(:)e(;)p eop
%%Page: 120 134
120 133 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(120)1256 b(Chapter)13 b(3)249
507 y FA(\()p Fp(ty)q(pe)341 490 y Fw(c)p Fm(\000)p Fk(1)341
518 y Fj(n)362 527 y Fw(c)p Ff(\000)p Fg(1)420 518 y
Fm(\000)p Fk(1)464 507 y Fp(;)7 b(disp)559 490 y Fw(c)p
Fm(\000)p Fk(1)559 518 y Fj(n)580 527 y Fw(c)p Ff(\000)p
Fg(1)637 518 y Fm(\000)p Fk(1)691 507 y FA(+)i Fw(D)p
FA([)p Fw(c)g Ft(\000)h Fw(1)p FA(])e(+)i(\()p Fw(B)p
FA([)p Fw(c)f Ft(\000)g Fw(1)p FA(])g Ft(\000)g Fw(1)p
FA(\))h Ft(\001)e Fp(ex)1243 513 y Fw(c)p Fm(\000)p Fk(1)1306
507 y FA(\))p Ft(g)p Fp(:)291 731 y FA(A)15 b(call)g(to)g
Fw(MPI)p 544 731 13 2 v 14 w(TYPE)p 666 731 V 14 w(HINDEXED\(count,)h
(B,)f(D,)g(oldt)o(yp)q(e,)h(newt)o(yp)q(e\))i FA(is)d(equiv)n(alen)o(t)
g(to)249 785 y(a)h(call)g(to)h Fw(MPI)p 496 785 V 14
w(TYPE)p 618 785 V 14 w(STRUCT\(count,)g(B,)f(D,)g(T,)h(newt)o(yp)q
(e\))p FA(,)i(where)f(eac)o(h)f(en)o(try)g(of)f Fw(T)h
FA(is)249 839 y(equal)d(to)f Fw(oldt)o(yp)q(e)p FA(.)249
934 y Fs(Example)i(3.14)21 b FA(Sending)14 b(an)f(arra)o(y)h(of)f
(structures.)249 988 y Fr(struct)21 b(Partstruct)314
1042 y({)314 1096 y(char)65 b(class;)42 b(/*)22 b(particle)e(class)h
(*/)314 1150 y(double)g(d[6];)64 b(/*)22 b(particle)e(coordinates)f(*/)
314 1204 y(char)65 b(b[7];)f(/*)22 b(some)f(additional)e(information)h
(*/)314 1258 y(};)249 1366 y(struct)h(Partstruct)85 b(particle[1000];)
249 1420 y(int)392 b(i,)21 b(dest,)g(rank;)249 1474 y(MPI_Comm)107
b(comm;)249 1582 y(/*)21 b(build)g(datatype)f(describing)g(structure)g
(*/)249 1690 y(MPI_Datatype)f(Particletype;)249 1744
y(MPI_Datatype)g(type[3])i(=)g({MPI_CHAR,)f(MPI_DOUBLE,)g(MPI_CHAR};)
249 1798 y(int)217 b(blocklen[3])20 b(=)h({1,)h(6,)f(7};)249
1852 y(MPI_Aint)107 b(disp[3])21 b(=)g({0,)g(sizeof\(double},)e
(7*sizeof\(double\)};)249 1960 y(MPI_Type_struct\(3,)f(blocklen,)i
(disp,)h(type,)g(&Particletype\);)249 2014 y(MPI_Type_commit\(&P)o
(artic)o(lety)o(pe\);)249 2122 y(/*)g(send)g(the)h(array)e(*/)249
2230 y(MPI_Send\(particle,)e(1000,)j(Particletype,)e(dest,)i(tag,)g
(comm\);)249 2284 y FA(The)12 b(arra)o(y)g Fw(disp)g
FA(w)o(as)f(initialized)g(assuming)f(that)h(a)h Fq(double)e
FA(is)i(double-w)o(ord)f(aligned.)17 b(If)11 b Fq(dou-)249
2338 y(ble)p FA('s)j(are)h(single-w)o(ord)f(aligned,)f(then)j
Fw(disp)f FA(should)g(b)q(e)g(initialized)e(to)i Fr(\(0,)21
b(sizeof\(int\),)249 2392 y(sizeof\(int\)+6*size)o(of\(do)o(uble)o
(\)\))p FA(.)14 b(W)m(e)e(sho)o(w)g(in)g(Example)f(3.21)g(on)g(page)i
(129,)e(ho)o(w)h(to)249 2445 y(a)o(v)o(oid)h(this)h(mac)o(hine)e(dep)q
(endence.)p eop
%%Page: 121 135
121 134 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(121)249 507 y Fs(Example)15 b(3.15)21
b FA(A)12 b(more)g(complex)f(example,)g(using)i(the)g(same)f(arra)o(y)g
(of)g(structures)j(as)e(in)249 561 y(Example)i(3.14:)22
b(pro)q(cess)c(zero)f(sends)h(a)e(message)g(that)h(consists)g(of)f(all)
f(particles)i(of)f(class)249 615 y(zero.)j(Pro)q(cess)d(one)e(receiv)o
(es)i(these)f(particles)f(in)g(con)o(tiguous)f(lo)q(cations.)249
669 y Fr(struct)21 b(Partstruct)314 723 y({)314 777 y(char)65
b(class;)42 b(/*)22 b(particle)e(class)h(*/)314 831 y(double)g(d[6];)64
b(/*)22 b(particle)e(coordinates)f(*/)314 885 y(char)65
b(b[7];)f(/*)22 b(some)f(additional)e(information)h(*/)314
939 y(};)249 993 y(struct)h(Partstruct)85 b(particle[1000];)249
1047 y(int)392 b(i,)21 b(j,)g(myrank;)249 1101 y(MPI_Status)238
b(status;)249 1155 y(MPI_Datatype)19 b(Particletype;)249
1209 y(MPI_Datatype)g(type[3])i(=)g({MPI_CHAR,)f(MPI_DOUBLE,)g
(MPI_CHAR};)249 1263 y(int)217 b(blocklen[3])20 b(=)h({1,)h(6,)f(7};)
249 1317 y(MPI_Aint)107 b(disp[3])21 b(=)g({0,)g(sizeof\(double\),)e
(7*sizeof\(double\)},)f(sizeaint;)249 1371 y(int)217
b(base;)249 1425 y(MPI_Datatype)19 b(Zparticles;)63 b(/*)22
b(datatype)e(describing)g(all)h(particles)903 1479 y(with)g(class)g
(zero)g(\(needs)f(to)h(be)h(recomputed)903 1533 y(if)f(classes)g
(change\))f(*/)249 1587 y(MPI_Aint)107 b(*zdisp;)249
1641 y(int)217 b(*zblocklen;)249 1748 y(MPI_Type_struct\(3,)18
b(blocklen,)i(disp,)h(type,)g(&Particletype\);)249 1802
y(MPI_Comm_rank\(comm)o(,)e(&myrank\);)249 1910 y(if\(myrank)h(==)h
(0\))h({)249 2018 y(/*)f(send)g(message)g(consisting)e(of)j(all)f
(class)g(zero)g(particles)f(*/)314 2126 y(/*)i(allocate)e(data)h
(structures)f(for)h(datatype)f(creation)g(*/)314 2234
y(MPI_Type_extent\(MPI_)o(Aint)o(,)f(&sizeaint\))314
2288 y(zdisp)i(=)h(\(MPI_Aint*\)mallo)o(c\(100)o(0*siz)o(eaint)o(\);)
314 2342 y(zblocklen)e(=)i(\(int*\)malloc\(1000)o(*size)o(of\(in)o
(t\)\);)293 2450 y(/*)f(compute)f(displacements)f(of)j(class)f(zero)g
(particles)f(*/)p eop
%%Page: 122 136
122 135 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(122)1256 b(Chapter)13 b(3)314
507 y Fr(j)22 b(=)g(0;)314 561 y(for\(i=0;)f(i)g(<)h(1000;)f(i++\))380
615 y(if)g(\(particle[i].class)o(==0\))d({)445 669 y(zdisp[j])i(=)i(i;)
445 723 y(zblocklen[j])e(=)h(1;)445 777 y(j++;)445 831
y(})314 939 y(/*)h(create)e(datatype)h(for)g(class)f(zero)h(particles)
42 b(*/)314 1047 y(MPI_Type_indexed\(j,)18 b(zblocklen,)i(zdisp,)h
(Particletype,)e(&Zparticles\);)314 1101 y(MPI_Type_commit\(&Zpa)o
(rtic)o(les\);)314 1209 y(/*)j(send)f(*/)314 1317 y
(MPI_Send\(particle,)e(1,)i(Zparticles,)e(1,)j(0,)f(comm\);)271
1371 y(})249 1479 y(else)g(if)g(\(myrank)g(==)g(1\))249
1587 y(/*)g(receive)g(class)g(zero)g(particles)e(in)j(contiguous)e
(locations)f(*/)314 1694 y(MPI_recv\(particle,)g(1000,)h(Particletype,)
f(0,)j(0,)968 1748 y(comm,)f(&status\);)249 1844 y Fs(Example)15
b(3.16)21 b FA(An)16 b(optimization)c(for)k(the)g(last)f(example:)20
b(rather)d(than)f(handling)e(eac)o(h)249 1898 y(class)c(zero)h
(particle)f(as)f(a)h(separate)h(blo)q(c)o(k,)f(it)f(is)g(more)g
(e\016cien)o(t)h(to)g(compute)f(largest)h(consecu-)249
1952 y(tiv)o(e)f(blo)q(c)o(ks)g(of)g(class)h(zero)g(particles)g(and)f
(use)h(these)h(blo)q(c)o(ks)e(in)g(the)h(call)e(to)h
Fw(MPI)p 1498 1952 13 2 v 15 w(T)m(yp)q(e)p 1597 1952
V 16 w(indexed)p FA(.)249 2006 y(The)14 b(mo)q(di\014ed)f(lo)q(op)g
(that)h(computes)g Fw(zblo)q(ck)h FA(and)e Fw(zdisp)i
FA(is)f(sho)o(wn)g(b)q(elo)o(w.)249 2060 y Fr(...)249
2168 y(j=0;)249 2222 y(for)21 b(\(i=0;)g(i)h(<)f(1000;)g(i++\))293
2276 y(if)g(\(particle[i].class)o(==0\))d({)336 2330
y(for)j(\(k=i+1;)g(\(k)g(<)h(1000\)&&\(particle)o([k].c)o(lass)c(==)k
(0\);)f(k++\);)336 2384 y(zdisp[j])f(=)i(i;)336 2438
y(zblocklen[j])e(=)h(k-i;)336 2492 y(j++;)p eop
%%Page: 123 137
123 136 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(123)336 507 y Fr(i)22 b(=)f(k;)336
561 y(})249 615 y(MPI_Type_indexed\(j)o(,)e(zblocklen,)h(zdisp,)g
(Particletype,)f(&Zparticles\);)249 669 y(...)249 790
y FD(3.4)52 b(Use)17 b(of)h(Deriv)o(ed)f(Datat)o(yp)q(es)249
897 y Fs(3.4.1)48 b(Commit)249 981 y FA(A)12 b(deriv)o(ed)g(datat)o(yp)
q(e)g(m)o(ust)e(b)q(e)i Fs(committed)d FA(b)q(efore)j(it)g(can)f(b)q(e)
i(used)f(in)f(a)g(comm)o(unication.)249 1034 y(A)k(committed)d(datat)o
(yp)q(e)j(can)g(con)o(tin)o(ue)g(to)f(b)q(e)h(used)h(as)f(an)f(input)g
(argumen)o(t)g(in)g(datat)o(yp)q(e)249 1088 y(constructors)e(\(so)f
(that)f(other)h(datat)o(yp)q(es)g(can)f(b)q(e)h(deriv)o(ed)f(from)f
(the)i(committed)d(datat)o(yp)q(e\).)249 1142 y(There)15
b(is)f(no)f(need)i(to)f(commit)d(primitiv)o(e)h(datat)o(yp)q(es.)249
1267 y Fw(MPI)p 326 1267 13 2 v 14 w(TYPE)p 448 1267
V 15 w(COMMIT\(datat)o(yp)q(e\))332 1342 y Fv(INOUT)71
b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14 b(that)g(is)f(to)g(b)q
(e)g(committed)249 1452 y Fr(int)21 b(MPI)p 405 1452
14 2 v 15 w(Type)p 508 1452 V 15 w(commit\(MPI)p 743
1452 V 14 w(Datatype)f(*datatype\))249 1536 y(MPI)p 318
1536 V 15 w(TYPE)p 421 1536 V 15 w(COMMIT\(DATATYPE,)e(IERROR\))336
1590 y(INTEGER)j(DATATYPE,)f(IERROR)291 1674 y Fw(MPI)p
368 1674 13 2 v 14 w(TYPE)p 490 1674 V 14 w(COMMIT)14
b FA(commits)e(the)j(datat)o(yp)q(e.)k(Commit)11 b(should)j(b)q(e)h
(though)o(t)g(of)e(as)i(a)249 1728 y(p)q(ossible)f(\\\015attening")e
(or)h(\\compilation")d(of)j(the)h(formal)c(description)k(of)f(a)g(t)o
(yp)q(e)h(map)d(in)o(to)249 1782 y(an)j(e\016cien)o(t)h(represen)o
(tation.)22 b(Commi)o(t)12 b(do)q(es)j(not)f(imply)e(that)j(the)g
(datat)o(yp)q(e)g(is)f(b)q(ound)h(to)249 1836 y(the)e(curren)o(t)h(con)
o(ten)o(t)g(of)e(a)g(comm)o(unication)d(bu\013er.)19
b(After)13 b(a)f(datat)o(yp)q(e)h(has)g(b)q(een)h(commi)o(t-)249
1890 y(ted,)g(it)g(can)g(b)q(e)g(rep)q(eatedly)h(reused)h(to)d(comm)o
(unicate)f(di\013eren)o(t)j(data.)249 1981 y FB(A)n(dvic)n(e)h(to)g
(implementors.)43 b FA(The)16 b(system)f(ma)o(y)e(\\compile")g(at)i
(commit)d(time)i(an)h(in)o(ternal)249 2035 y(represen)o(tation)i(for)e
(the)h(datat)o(yp)q(e)g(that)f(facilitates)g(comm)o(unicati)o(on.)20
b(\()p FB(End)d(of)f(advic)n(e)g(to)249 2089 y(implementors.)p
FA(\))249 2180 y Fs(3.4.2)48 b(Deallo)q(cation)249 2263
y FA(A)14 b(datat)o(yp)q(e)g(ob)r(ject)h(is)f(deallo)q(cated)g(b)o(y)f
(a)h(call)f(to)h Fw(MPI)p 1150 2263 V 14 w(TYPE)p 1272
2263 V 14 w(FREE)p FA(.)p eop
%%Page: 124 138
124 137 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(124)1256 b(Chapter)13 b(3)249
507 y Fw(MPI)p 326 507 13 2 v 14 w(TYPE)p 448 507 V 15
w(FREE\(datat)o(yp)q(e\))332 582 y Fv(INOUT)71 b Fw(datat)o(yp)q(e)397
b Fv(datat)o(yp)q(e)14 b(to)f(b)q(e)h(freed)249 692 y
Fr(int)21 b(MPI)p 405 692 14 2 v 15 w(Type)p 508 692
V 15 w(free\(MPI)p 699 692 V 14 w(Datatype)f(*datatype\))249
776 y(MPI)p 318 776 V 15 w(TYPE)p 421 776 V 15 w(FREE\(DATATYPE,)f
(IERROR\))336 830 y(INTEGER)i(DATATYPE,)f(IERROR)291
914 y Fw(MPI)p 368 914 13 2 v 14 w(TYPE)p 490 914 V 14
w(FREE)c FA(marks)f(the)i(datat)o(yp)q(e)g(ob)r(ject)h(asso)q(ciated)f
(with)g Fw(datat)o(yp)q(e)h FA(for)e(deal-)249 968 y(lo)q(cation)j(and)
g(sets)i Fw(datat)o(yp)q(e)g FA(to)f Fq(MPI)p 885 968
12 2 v 12 w(D)o(A)m(T)m(A)m(TYPE)p 1093 968 V 12 w(NULL)p
FA(.)g(An)o(y)g(comm)o(unicati)o(on)d(that)j(is)249 1022
y(curren)o(tly)14 b(using)g(this)f(datat)o(yp)q(e)h(will)e(complete)h
(normally)l(.)i(Deriv)o(ed)f(datat)o(yp)q(es)g(that)f(w)o(ere)249
1076 y(de\014ned)i(from)d(the)j(freed)f(datat)o(yp)q(e)h(are)f(not)g
(a\013ected.)249 1167 y FB(A)n(dvic)n(e)g(to)g(implementors.)36
b FA(An)14 b(implem)o(en)o(tation)c(ma)o(y)i(k)o(eep)i(a)e(reference)k
(coun)o(t)e(of)e(activ)o(e)249 1221 y(comm)o(unications)i(that)j(use)h
(the)f(datat)o(yp)q(e,)h(in)f(order)g(to)g(decide)h(when)g(to)e(free)i
(it.)27 b(Also,)249 1275 y(one)17 b(ma)o(y)e(implem)o(en)o(t)g
(constructors)j(of)e(deriv)o(ed)i(datat)o(yp)q(es)f(so)g(that)f(they)h
(k)o(eep)h(p)q(oin)o(ters)249 1329 y(to)c(their)h(datat)o(yp)q(e)f
(argumen)o(ts,)f(rather)i(then)g(cop)o(ying)e(them.)19
b(In)14 b(this)g(case,)h(one)f(needs)i(to)249 1383 y(k)o(eep)11
b(trac)o(k)g(of)f(activ)o(e)h(datat)o(yp)q(e)g(de\014nition)f
(references)k(in)c(order)h(to)g(kno)o(w)f(when)h(a)f(datat)o(yp)q(e)249
1437 y(ob)r(ject)15 b(can)f(b)q(e)g(freed.)19 b(\()p
FB(End)d(of)f(advic)n(e)g(to)g(implementors.)p FA(\))249
1533 y Fs(Example)g(3.17)21 b FA(The)16 b(follo)o(wing)d(co)q(de)j
(fragmen)o(t)e(giv)o(es)h(examples)g(of)g(using)g Fw(MPI)p
1610 1533 13 2 v 14 w(TYPE-)p 249 1587 V 262 1587 a(COMMIT)e
FA(and)h Fw(MPI)p 603 1587 V 14 w(TYPE)p 725 1587 V 14
w(FREE)p FA(.)249 1640 y Fr(INTEGER)20 b(type1,)h(type2)249
1694 y(CALL)g(MPI_TYPE_CONTIGUOU)o(S\(5,)d(MPI_REAL,)i(type1,)h(ierr\))
554 1748 y(!)h(new)f(type)g(object)f(created)249 1802
y(CALL)h(MPI_TYPE_COMMIT\(ty)o(pe1,)d(ierr\))554 1856
y(!)k(now)f(type1)g(can)g(be)g(used)g(for)g(communication)249
1910 y(type2)g(=)g(type1)554 1964 y(!)h(type2)f(can)g(be)g(used)g(for)g
(communication)554 2018 y(!)h(\(it)f(is)g(a)h(handle)e(to)i(same)f
(object)f(as)i(type1\))249 2072 y(CALL)f(MPI_TYPE_VECTOR\(3,)d(5,)j(4,)
h(MPI_REAL,)e(type1,)g(ierr\))554 2126 y(!)i(new)f(uncommitted)e(type)i
(object)g(created)249 2180 y(CALL)g(MPI_TYPE_COMMIT\(ty)o(pe1,)d
(ierr\))554 2234 y(!)k(now)f(type1)g(can)g(be)g(used)g(anew)g(for)g
(communication)249 2288 y(CALL)g(MPI_TYPE_FREE\(type)o(2,)e(ierr\))554
2342 y(!)j(free)f(before)f(overwrite)g(handle)249 2396
y(type2)h(=)g(type1)554 2450 y(!)h(type2)f(can)g(be)g(used)g(for)g
(communication)249 2504 y(CALL)g(MPI_TYPE_FREE\(type)o(2,)e(ierr\))p
eop
%%Page: 125 139
125 138 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(125)554 507 y Fr(!)22 b(both)f(type1)f(and)i(type2)e
(are)i(unavailable;)d(type2)554 561 y(!)j(has)f(value)g
(MPI_DATATYPE_NUL)o(L)e(and)i(type1)g(is)554 615 y(!)h(undefined)249
706 y Fs(3.4.3)48 b(Relation)13 b(to)j Fw(count)249 789
y FA(A)21 b(call)e(of)h(the)h(form)d Fw(MPI)p 696 789
13 2 v 15 w(SEND\(buf,)k(count,)h(datat)o(yp)q(e)e(,)h
Fp(:)7 b(:)g(:)e Fw(\))p FA(,)22 b(where)f Fw(count)j
Fp(>)e Fw(1)p FA(,)g(is)249 843 y(in)o(terpreted)16 b(as)f(if)e(the)i
(call)f(w)o(as)g(passed)i(a)e(new)h(datat)o(yp)q(e)g(whic)o(h)f(is)g
(the)h(concatenation)g(of)249 897 y Fw(count)i FA(copies)f(of)g
Fw(datat)o(yp)q(e)p FA(.)25 b(Th)o(us,)16 b Fw(MPI)p
918 897 V 14 w(SEND\(buf,)h(count,)g(datat)o(yp)q(e,)g(dest,)g(tag,)e
(comm\))249 951 y FA(is)f(equiv)n(alen)o(t)f(to,)249
1034 y Fr(MPI_TYPE_CONTIGUOU)o(S\(cou)o(nt,)18 b(datatype,)i(newtype\))
249 1088 y(MPI_TYPE_COMMIT\(ne)o(wtype)o(\))249 1142
y(MPI_SEND\(buf,)f(1,)j(newtype,)e(dest,)g(tag,)h(comm\).)291
1226 y FA(Similar)9 b(statemen)o(ts)k(apply)f(to)g(all)f(other)i(comm)o
(unication)c(functions)k(that)f(ha)o(v)o(e)g(a)g Fw(count)249
1280 y FA(and)i Fw(datat)o(yp)q(e)h FA(argumen)o(t.)249
1363 y Fs(3.4.4)48 b(T)o(yp)q(e)16 b(Matc)o(hing)249
1446 y FA(Supp)q(ose)e(that)g(a)f(send)h(op)q(eration)f
Fw(MPI)p 891 1446 V 14 w(SEND\(buf,)h(count,)g(datat)o(yp)q(e,)h(dest,)
e(tag,)g(comm\))f FA(is)249 1500 y(executed,)j(where)g
Fw(datat)o(yp)q(e)h FA(has)e(t)o(yp)q(e)g(map)291 1554
y Ft(f)p FA(\()p Fp(ty)q(pe)404 1560 y Fk(0)423 1554
y Fp(;)7 b(disp)518 1560 y Fk(0)536 1554 y FA(\))p Fp(;)g(:)g(:)g(:)e
(;)i FA(\()p Fp(ty)q(pe)737 1560 y Fj(n)p Fm(\000)p Fk(1)803
1554 y Fp(;)g(disp)898 1560 y Fj(n)p Fm(\000)p Fk(1)963
1554 y FA(\))p Ft(g)p Fp(;)249 1608 y FA(and)i(exten)o(t)i
Fp(extent)p FA(.)34 b(The)10 b(send)g(op)q(eration)g(sends)g
Fp(n)q Ft(\001)q Fw(count)f FA(en)o(tries,)i(where)g(en)o(try)f(\()p
Fp(i;)d(j)r FA(\))j(is)g(at)249 1662 y(lo)q(cation)h
Fp(addr)490 1668 y Fj(i;j)539 1662 y FA(=)h Fw(buf)c
FA(+)d Fp(extent)g Ft(\001)g Fp(i)g FA(+)g Fp(disp)954
1668 y Fj(j)981 1662 y FA(and)12 b(has)f(t)o(yp)q(e)h
Fp(ty)q(pe)1298 1668 y Fj(j)1317 1662 y FA(,)f(for)h
Fp(i)f FA(=)h(0)p Fp(;)7 b(:)g(:)g(:)e(;)i Fw(count)e
Ft(\000)g FA(1)249 1716 y(and)13 b Fp(j)h FA(=)e(0)p
Fp(;)7 b(:)g(:)g(:)e(;)i(n)g Ft(\000)i FA(1.)18 b(The)c(v)n(ariable)e
(stored)i(at)g(address)h Fp(addr)1290 1722 y Fj(i;j)1341
1716 y FA(in)e(the)h(calling)e(program)249 1770 y(should)20
b(b)q(e)i(of)e(a)g(t)o(yp)q(e)h(that)g(matc)o(hes)f Fp(ty)q(pe)986
1776 y Fj(j)1005 1770 y FA(,)h(where)h(t)o(yp)q(e)f(matc)o(hing)e(is)h
(de\014ned)i(as)f(in)249 1824 y(Section)14 b(2.3.1.)291
1878 y(Similarl)o(y)m(,)6 b(supp)q(ose)11 b(that)e(a)g(receiv)o(e)i(op)
q(eration)e Fw(MPI)p 1128 1878 V 14 w(RECV\(buf,)h(count,)g(datat)o(yp)
q(e,)h(source,)249 1932 y(tag,)g(comm,)e(status\))i FA(is)f(executed.)
19 b(The)11 b(receiv)o(e)h(op)q(eration)f(receiv)o(es)h(up)f(to)g
Fp(n)s Ft(\001)s Fw(count)g FA(en)o(tries,)249 1986 y(where)16
b(en)o(try)g(\()p Fp(i;)7 b(j)r FA(\))16 b(is)f(at)g(lo)q(cation)f
Fw(buf)g FA(+)c Fp(extent)g Ft(\001)g Fp(i)g FA(+)h Fp(disp)1237
1992 y Fj(j)1270 1986 y FA(and)k(has)g(t)o(yp)q(e)h Fp(ty)q(pe)1598
1992 y Fj(j)1616 1986 y FA(.)22 b(T)o(yp)q(e)249 2039
y(matc)o(hing)10 b(is)h(de\014ned)h(according)g(to)f(the)h(t)o(yp)q(e)g
(signature)f(of)g(the)h(corresp)q(onding)g(datat)o(yp)q(es,)249
2093 y(that)k(is,)h(the)f(sequence)j(of)c(primitiv)o(e)f(t)o(yp)q(e)j
(comp)q(onen)o(ts.)25 b(T)o(yp)q(e)17 b(matc)o(hing)d(do)q(es)j(not)f
(de-)249 2147 y(p)q(end)d(on)g(other)g(asp)q(ects)h(of)e(the)h(datat)o
(yp)q(e)g(de\014nition,)e(suc)o(h)j(as)e(the)h(displacemen)o(ts)f(\(la)
o(y)o(out)249 2201 y(in)h(memory\))f(or)i(the)g(in)o(termediate)f(t)o
(yp)q(es)i(used)g(to)f(de\014ne)h(the)f(datat)o(yp)q(es.)291
2255 y(F)m(or)i(sends,)h(a)f(datat)o(yp)q(e)h(ma)o(y)d(sp)q(ecify)j(o)o
(v)o(erlapping)e(en)o(tries.)27 b(This)16 b(is)g(not)h(true)g(for)f
(re-)249 2309 y(ceiv)o(es.)i(If)12 b(the)g(datat)o(yp)q(e)g(used)h(in)e
(a)h(receiv)o(e)h(op)q(eration)f(sp)q(eci\014es)h(o)o(v)o(erlapping)e
(en)o(tries)i(then)249 2363 y(the)i(call)e(is)g(erroneous.)249
2454 y Fs(Example)i(3.18)21 b FA(This)16 b(example)f(sho)o(ws)i(that)f
(t)o(yp)q(e)h(matc)o(hing)e(is)h(de\014ned)h(only)f(in)g(terms)249
2508 y(of)d(the)i(primitiv)o(e)d(t)o(yp)q(es)i(that)g(constitute)h(a)f
(deriv)o(ed)g(t)o(yp)q(e.)p eop
%%Page: 126 140
126 139 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(126)1256 b(Chapter)13 b(3)249
507 y Fr(...)249 561 y(CALL)21 b(MPI_TYPE_CONTIGUOU)o(S\()e(2,)i
(MPI_REAL,)f(type2,)h(...\))249 615 y(CALL)g(MPI_TYPE_CONTIGUOU)o(S\()e
(4,)i(MPI_REAL,)f(type4,)h(...\))249 669 y(CALL)g(MPI_TYPE_CONTIGUOU)o
(S\()e(2,)i(type2,)g(type22,)f(...\))249 723 y(...)249
777 y(CALL)h(MPI_SEND\()f(a,)h(4,)h(MPI_REAL,)e(...\))249
831 y(CALL)h(MPI_SEND\()f(a,)h(2,)h(type2,)e(...\))249
885 y(CALL)h(MPI_SEND\()f(a,)h(1,)h(type22,)e(...\))249
939 y(CALL)h(MPI_SEND\()f(a,)h(1,)h(type4,)e(...\))249
993 y(...)249 1047 y(CALL)h(MPI_RECV\()f(a,)h(4,)h(MPI_REAL,)e(...\))
249 1101 y(CALL)h(MPI_RECV\()f(a,)h(2,)h(type2,)e(...\))249
1155 y(CALL)h(MPI_RECV\()f(a,)h(1,)h(type22,)e(...\))249
1209 y(CALL)h(MPI_RECV\()f(a,)h(1,)h(type4,)e(...\))291
1317 y FA(Eac)o(h)14 b(of)f(the)i(sends)g(matc)o(hes)e
FB(any)i FA(of)e(the)i(receiv)o(es.)249 1412 y Fs(3.4.5)48
b(Message)16 b(Length)249 1495 y FA(If)f(a)f(message)h(w)o(as)g(receiv)
o(ed)h(using)f(a)g(user-de\014ned)i Fw(datat)o(yp)q(e)p
FA(,)f(then)g(a)f(subsequen)o(t)h(call)f(to)249 1549
y Fw(MPI)p 326 1549 13 2 v 14 w(GET)p 421 1549 V 15 w(COUNT\(status,)i
(datat)o(yp)q(e,)i(count\))f FA(\(Section)g(2.2.8\))d(will)h(return)i
(the)g(n)o(um)o(b)q(er)249 1603 y(of)i(\\copies")h(of)f
Fw(datat)o(yp)q(e)i FA(receiv)o(ed)f(\(coun)o(t\).)39
b(That)21 b(is,)g(if)f(the)h(receiv)o(e)h(op)q(eration)f(w)o(as)249
1657 y Fw(MPI)p 326 1657 V 14 w(RECV\(bu\013,)11 b(count,datat)o(yp)q
(e,)p Fp(:)c(:)g(:)g Fw(\))k FA(then)h Fw(MPI)p 1072
1657 V 14 w(GET)p 1167 1657 V 15 w(COUNT)e FA(ma)o(y)f(return)j(an)o(y)
e(in)o(teger)249 1711 y(v)n(alue)k Fp(k)q FA(,)g(where)h(0)e
Ft(\024)f Fp(k)i Ft(\024)f Fw(count)q FA(.)19 b(If)14
b Fw(MPI)p 932 1711 V 15 w(GET)p 1028 1711 V 14 w(COUNT)g
FA(returns)i Fp(k)q FA(,)e(then)h(the)g(n)o(um)o(b)q(er)f(of)249
1765 y(primitiv)o(e)d(elemen)o(ts)i(receiv)o(ed)i(is)e
Fp(n)8 b Ft(\001)g Fp(k)q FA(,)13 b(where)h Fp(n)f FA(is)g(the)h(n)o
(um)o(b)q(er)f(of)g(primitiv)o(e)e(elemen)o(ts)i(in)249
1819 y(the)g(t)o(yp)q(e)g(map)e(of)h Fw(datat)o(yp)q(e)p
FA(.)19 b(The)13 b(receiv)o(ed)h(message)e(need)h(not)g(\014ll)e(an)h
(in)o(tegral)g(n)o(um)o(b)q(er)g(of)249 1873 y(\\copies")h(of)f
Fw(datat)o(yp)q(e)p FA(.)19 b(If)12 b(the)i(n)o(um)o(b)q(er)e(of)g
(primitiv)o(e)e(elemen)o(ts)j(receiv)o(ed)h(is)f(not)f(a)h(m)o(ultiple)
249 1927 y(of)d Fp(n)p FA(,)h(that)g(is,)g(if)f(the)i(receiv)o(e)g(op)q
(eration)f(has)g(not)g(receiv)o(ed)h(an)f(in)o(tegral)f(n)o(um)o(b)q
(er)h(of)f Fw(datat)o(yp)q(e)249 1981 y FA(\\copies,")k(then)g
Fw(MPI)p 596 1981 V 14 w(GET)p 691 1981 V 15 w(COUNT)f
FA(returns)j(the)e(v)n(alue)f Fq(MPI)p 1255 1981 12 2
v 13 w(UNDEFINED)p FA(.)291 2035 y(The)g(function)g Fw(MPI)p
614 2035 13 2 v 15 w(GET)p 710 2035 V 14 w(ELEMENTS)h
FA(b)q(elo)o(w)f(can)h(b)q(e)g(used)g(to)f(determine)g(the)h(n)o(um)o
(b)q(er)249 2089 y(of)f(primitiv)o(e)f(elemen)o(ts)i(receiv)o(ed.)249
2214 y Fw(MPI)p 326 2214 V 14 w(GET)p 421 2214 V 15 w(ELEMENTS\()h
(status,)e(datat)o(yp)q(e,)i(count\))332 2288 y Fv(IN)158
b Fw(status)443 b Fv(status)14 b(of)f(receiv)o(e)332
2338 y(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14
b(used)g(b)o(y)f(receiv)o(e)h(op)q(eration)332 2388 y(OUT)114
b Fw(count)450 b Fv(n)o(um)o(b)q(er)14 b(of)f(primitiv)o(e)i(elemen)o
(ts)f(receiv)o(ed)249 2498 y Fr(int)21 b(MPI)p 405 2498
14 2 v 15 w(Get)p 486 2498 V 15 w(elements\(MPI)p 765
2498 V 14 w(Status)f(*status,)g(MPI)p 1193 2498 V 15
w(Datatype)g(datatype,)p eop
%%Page: 127 141
127 140 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(127)540 507 y Fr(int)21 b(*count\))249
591 y(MPI)p 318 591 14 2 v 15 w(GET)p 399 591 V 15 w(ELEMENTS\(STATUS,)
e(DATATYPE,)h(COUNT,)g(IERROR\))336 645 y(INTEGER)h(STATUS\(MPI)p
734 645 V 13 w(STATUS)p 879 645 V 15 w(SIZE\),)f(DATATYPE,)g(COUNT,)h
(IERROR)249 771 y Fs(Example)15 b(3.19)21 b FA(Usage)14
b(of)f Fw(MPI)p 797 771 13 2 v 15 w(GET)p 893 771 V 14
w(COUNT)g FA(and)h Fw(MPI)p 1220 771 V 15 w(GET)p 1316
771 V 14 w(ELEMENT)p FA(.)249 825 y Fr(...)249 879 y(CALL)21
b(MPI_TYPE_CONTIGUOU)o(S\(2,)d(MPI_REAL,)i(Type2,)h(ierr\))249
933 y(CALL)g(MPI_TYPE_COMMIT\(Ty)o(pe2,)d(ierr\))249
987 y(...)249 1041 y(CALL)j(MPI_COMM_RANK\(comm)o(,)e(rank,)i(ierr\))
249 1094 y(IF\(rank.EQ.0\))e(THEN)380 1148 y(CALL)i(MPI_SEND\(a,)e(2,)j
(MPI_REAL,)e(1,)h(0,)g(comm,)g(ierr\))380 1202 y(CALL)g(MPI_SEND\(a,)e
(3,)j(MPI_REAL,)e(1,)h(1,)g(comm,)g(ierr\))249 1256 y(ELSE)380
1310 y(CALL)g(MPI_RECV\(a,)e(2,)j(Type2,)e(0,)i(0,)f(comm,)g(stat,)g
(ierr\))380 1364 y(CALL)g(MPI_GET_COUNT\(st)o(at,)e(Type2,)h(i,)i
(ierr\))108 b(!)21 b(returns)f(i=1)380 1418 y(CALL)h(MPI_GET_ELEMENTS)o
(\(stat)o(,)e(Type2,)i(i,)g(ierr\))43 b(!)21 b(returns)f(i=2)380
1472 y(CALL)h(MPI_RECV\(a,)e(2,)j(Type2,)e(0,)i(1,)f(comm,)g(stat,)g
(ierr\))380 1526 y(CALL)g(MPI_GET_COUNT\(st)o(at,)e(Type2,)h(i,)i
(ierr\))1099 1580 y(!)g(returns)e(i=MPI_UNDEFINED)380
1634 y(CALL)h(MPI_GET_ELEMENTS)o(\(stat)o(,)e(Type2,)i(i,)g(ierr\))43
b(!)21 b(returns)f(i=3)249 1688 y(END)h(IF)291 1784 y
FA(The)c(function)g Fw(MPI)p 622 1784 V 15 w(GET)p 718
1784 V 14 w(ELEMENTS)h FA(can)g(also)f(b)q(e)h(used)g(after)f(a)g(prob)
q(e)h(to)f(\014nd)h(the)249 1838 y(n)o(um)o(b)q(er)i(of)h(primitiv)o(e)
d(datat)o(yp)q(e)j(elemen)o(ts)g(in)g(the)g(prob)q(ed)h(message.)39
b(Note)21 b(that)g(the)249 1891 y(t)o(w)o(o)d(functions)g
Fw(MPI)p 592 1891 V 14 w(GET)p 687 1891 V 15 w(COUNT)f
FA(and)h Fw(MPI)p 1023 1891 V 14 w(GET)p 1118 1891 V
15 w(ELEMENTS)h FA(return)g(the)g(same)e(v)n(al-)249
1945 y(ues)e(when)f(they)h(are)f(used)h(with)e(primitiv)o(e)f(datat)o
(yp)q(es.)249 2037 y FB(R)n(ationale.)51 b FA(The)16
b(de\014nition)g(of)g Fw(MPI)p 885 2037 V 14 w(GET)p
980 2037 V 15 w(COUNT)f FA(is)h(consisten)o(t)i(with)d(the)i(use)g(of)f
(the)249 2091 y Fw(count)21 b FA(argumen)o(t)d(in)h(the)h(receiv)o(e)g
(call:)29 b(the)20 b(function)f(returns)i(the)f(v)n(alue)f(of)f(the)i
Fw(count)249 2145 y FA(argumen)o(t,)13 b(when)j(the)f(receiv)o(e)h
(bu\013er)f(is)g(\014lled.)20 b(Sometimes)13 b Fw(datat)o(yp)q(e)j
FA(represen)o(ts)h(a)d(basic)249 2199 y(unit)19 b(of)g(data)g(one)h(w)o
(an)o(ts)f(to)g(transfer.)36 b(One)20 b(should)f(b)q(e)h(able)f(to)g
(\014nd)h(out)f(ho)o(w)g(man)o(y)249 2253 y(comp)q(onen)o(ts)c(w)o(ere)
g(receiv)o(ed)i(without)d(b)q(othering)h(to)g(divide)f(b)o(y)h(the)g(n)
o(um)o(b)q(er)f(of)h(elemen)o(ts)249 2307 y(in)j(eac)o(h)i(comp)q(onen)
o(t.)32 b(The)19 b Fw(MPI)p 811 2307 V 14 w(GET)p 906
2307 V 15 w(COUNT)f FA(is)h(used)h(in)e(suc)o(h)h(cases.)35
b(Ho)o(w)o(ev)o(er,)20 b(on)249 2361 y(other)14 b(o)q(ccasions,)g
Fw(datat)o(yp)q(e)h FA(is)f(used)h(to)e(de\014ne)i(a)f(complex)e(la)o
(y)o(out)h(of)g(data)g(in)g(the)i(receiv)o(er)249 2415
y(memory)m(,)e(and)j(do)q(es)h(not)e(represen)o(t)k(a)c(basic)h(unit)g
(of)f(data)h(for)f(transfers.)26 b(In)16 b(suc)o(h)h(cases,)249
2468 y(one)d(m)o(ust)f(use)i Fw(MPI)p 577 2468 V 14 w(GET)p
672 2468 V 15 w(ELEMENTS)p FA(.)f(\()p FB(End)i(of)e(r)n(ationale.)p
FA(\))p eop
%%Page: 128 142
128 141 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(128)1256 b(Chapter)13 b(3)249
507 y FB(A)n(dvic)n(e)19 b(to)f(implementors.)62 b FA(Structures)20
b(often)f(con)o(tain)e(padding)h(space)h(used)g(to)f(align)249
561 y(en)o(tries)i(correctly)m(.)33 b(Assume)18 b(that)h(data)f(is)h
(mo)o(v)o(ed)e(from)g(a)h(send)i(bu\013er)g(that)e(describ)q(es)249
615 y(a)f(structure)j(in)o(to)c(a)h(receiv)o(e)i(bu\013er)g(that)e
(describ)q(es)i(an)f(iden)o(tical)e(structure)k(on)d(another)249
669 y(pro)q(cess.)i(In)13 b(suc)o(h)g(a)f(case,)h(it)f(is)g(probably)g
(adv)n(an)o(tageous)g(to)g(cop)o(y)g(the)h(structure,)h(together)249
723 y(with)f(the)i(padding,)d(as)i(one)g(con)o(tiguous)f(blo)q(c)o(k.)
18 b(The)c(user)h(can)f(\\force")f(this)h(optimization)249
777 y(b)o(y)f(explicitly)f(including)h(padding)f(as)i(part)f(of)g(the)h
(message.)j(The)d(implemen)o(tati)o(on)c(is)k(free)249
831 y(to)h(do)f(this)h(optimization)d(when)j(it)g(do)q(es)g(not)g
(impact)e(the)i(outcome)f(of)g(the)i(computation.)249
885 y(Ho)o(w)o(ev)o(er,)e(it)g(ma)o(y)e(b)q(e)j(hard)g(to)f(detect)i
(when)e(this)h(optimization)c(applies,)j(since)h(data)f(sen)o(t)249
939 y(from)d(a)h(structure)j(ma)o(y)10 b(b)q(e)j(receiv)o(ed)h(in)o(to)
e(a)g(set)i(of)e(disjoin)o(t)f(v)n(ariables.)17 b(Also,)12
b(padding)g(will)249 993 y(di\013er)j(when)g(data)f(is)g(comm)o
(unicated)e(in)h(a)h(heterogeneous)j(en)o(vironmen)o(t,)c(or)h(ev)o(en)
h(on)f(the)249 1047 y(same)f(arc)o(hitecture,)j(when)f(di\013eren)o(t)g
(compiling)d(options)h(are)i(used.)20 b(The)15 b Fw(MPI)p
FA(-2)e(forum)g(is)249 1101 y(considering)h(options)f(to)g(alleviate)f
(this)i(problem)e(and)h(supp)q(ort)h(more)f(e\016cien)o(t)h(transfer)g
(of)249 1155 y(structures.)21 b(\()p FB(End)15 b(of)g(advic)n(e)g(to)g
(implementors.)p FA(\))249 1313 y FD(3.5)52 b(Address)16
b(F)l(unction)249 1421 y FA(As)g(sho)o(wn)g(in)f(Example)f(3.14,)g
(page)i(120,)e(one)i(sometimes)e(needs)j(to)e(b)q(e)h(able)g(to)f
(\014nd)h(the)249 1474 y(displacemen)o(t,)i(in)g(b)o(ytes,)h(of)f(a)g
(structure)i(comp)q(onen)o(t)d(relativ)o(e)h(to)g(the)h(structure)h
(start.)249 1528 y(In)e(C,)g(one)g(can)g(use)h(the)f
Fq(sizeof)f FA(op)q(erator)h(to)g(\014nd)g(the)h(size)g(of)e(C)h(ob)r
(jects;)j(and)d(one)g(will)249 1582 y(b)q(e)f(tempted)f(to)h(use)g(the)
g Fq(&)f FA(op)q(erator)h(to)g(compute)e(addresses)k(and)d(then)h
(displacemen)o(ts.)249 1636 y(Ho)o(w)o(ev)o(er,)d(the)g(C)g(standard)g
(do)q(es)h(not)e(require)i(that)f Fq(\(int\)&v)e FA(b)q(e)j(the)f(b)o
(yte)g(address)h(of)e(v)n(ari-)249 1690 y(able)18 b Fq(v)p
FA(:)25 b(the)18 b(mapping)e(of)h(p)q(oin)o(ters)h(to)g(in)o(tegers)g
(is)g(implemen)o(tatio)o(n)d(dep)q(enden)o(t.)32 b(Some)249
1744 y(systems)14 b(ma)o(y)d(ha)o(v)o(e)j(\\w)o(ord")f(p)q(oin)o(ters)h
(and)f(\\b)o(yte")h(p)q(oin)o(ters;)g(other)g(systems)g(ma)o(y)d(ha)o
(v)o(e)j(a)249 1798 y(segmen)o(ted,)h(noncon)o(tiguous)f(address)i
(space.)21 b(Therefore,)15 b(a)g(p)q(ortable)g(mec)o(hanism)d(has)j(to)
249 1852 y(b)q(e)g(pro)o(vided)g(b)o(y)f Fw(MPI)g FA(to)g(compute)g
(the)i(\\address")f(of)f(a)g(v)n(ariable.)19 b(Suc)o(h)c(a)f(mec)o
(hanism)f(is)249 1906 y(certainly)h(needed)h(in)f(F)m(ortran,)f(whic)o
(h)h(has)g(no)f(dereferencing)j(op)q(erator.)249 2031
y Fw(MPI)p 326 2031 13 2 v 14 w(ADDRESS\(lo)q(cation,)e(address\))332
2106 y Fv(IN)158 b Fw(lo)q(cation)409 b Fv(v)n(ariable)13
b(represen)o(ting)f(a)e(memory)h(lo)q(cation)332 2156
y(OUT)114 b Fw(address)420 b Fv(address)14 b(of)f(lo)q(cation)249
2266 y Fr(int)21 b(MPI)p 405 2266 14 2 v 15 w(Address\(void*)e
(location,)h(MPI)p 1009 2266 V 15 w(Aint)h(*address\))249
2350 y(MPI)p 318 2350 V 15 w(ADDRESS\(LOCATION,)d(ADDRESS,)j(IERROR\))
336 2404 y(<type>)g(LOCATION\(*\))336 2458 y(INTEGER)g(ADDRESS,)f
(IERROR)p eop
%%Page: 129 143
129 142 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(129)291 507 y Fw(MPI)p 368 507 13 2
v 14 w(ADDRESS)16 b FA(is)g(used)h(to)g(\014nd)f(the)h(address)h(of)e
(a)g(lo)q(cation)g(in)g(memory)m(.)22 b(It)17 b(returns)249
561 y(the)e(b)o(yte)f(address)h(of)e Fw(lo)q(cation)p
FA(.)249 644 y Fs(Example)i(3.20)21 b FA(Using)d Fw(MPI)p
750 644 V 14 w(ADDRESS)g FA(for)g(an)h(arra)o(y)m(.)31
b(The)19 b(v)n(alue)e(of)h Fr(DIFF)g FA(is)g(set)i(to)249
698 y Fr(909*sizeofreal)p FA(,)11 b(while)i(the)h(v)n(alues)g(of)f
Fr(I1)h FA(and)f Fr(I2)h FA(are)g(implemen)o(tation)d(dep)q(enden)o(t.)
314 752 y Fr(REAL)21 b(A\(100,100\))314 806 y(INTEGER)g(I1,)g(I2,)g
(DIFF)314 860 y(CALL)g(MPI_ADDRESS\(A\(1,1\),)d(I1,)j(IERROR\))314
914 y(CALL)g(MPI_ADDRESS\(A\(10,10)o(\),)e(I2,)i(IERROR\))314
968 y(DIFF)g(=)h(I2)f(-)h(I1)249 1105 y Fs(Example)15
b(3.21)21 b FA(W)m(e)d(mo)q(dify)f(the)i(co)q(de)g(in)g(Example)e
(3.14,)h(page)h(120,)g(so)f(as)h(to)g(a)o(v)o(oid)249
1159 y(arc)o(hitectural)d(dep)q(endencies.)26 b(Calls)15
b(to)h Fw(MPI)p 1002 1159 V 14 w(ADDRESS)f FA(are)h(used)h(to)e
(compute)g(the)i(dis-)249 1213 y(placemen)o(ts)d(of)f(the)h(structure)i
(comp)q(onen)o(ts.)249 1267 y Fr(struct)21 b(Partstruct)314
1321 y({)314 1375 y(char)65 b(class;)42 b(/*)22 b(particle)e(class)h
(*/)314 1429 y(double)g(d[6];)64 b(/*)22 b(particle)e(coordinates)f(*/)
314 1483 y(char)65 b(b[7];)f(/*)22 b(some)f(additional)e(information)h
(*/)314 1537 y(};)249 1591 y(struct)h(Partstruct)85 b(particle[1000];)
249 1645 y(int)392 b(i,)21 b(dest,)g(rank;)249 1699 y(MPI_Comm)107
b(comm;)249 1753 y(MPI_Datatype)19 b(Particletype;)249
1807 y(MPI_Datatype)g(type[3])i(=)g({MPI_CHAR,)f(MPI_DOUBLE,)g
(MPI_CHAR};)249 1861 y(int)217 b(blocklen[3])20 b(=)h({1,)h(6,)f(7};)
249 1914 y(MPI_Aint)107 b(disp[3];)249 2022 y(/*)21 b(compute)g
(displacements)e(*/)249 2130 y(MPI_Address\(partic)o(le,)g(&disp[0]\);)
249 2184 y(MPI_Address\(partic)o(le[0])o(.d,)f(&disp[1]\);)249
2238 y(MPI_Address\(partic)o(le[0])o(.b,)g(&disp[2]\);)249
2346 y(for)j(\(i=2;)g(i)h(>=)f(0;)g(i--\))314 2400 y(disp[i])g(-=)g
(disp[0];)249 2508 y(/*)g(build)g(datatype)f(*/)p eop
%%Page: 130 144
130 143 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(130)1256 b(Chapter)13 b(3)249
507 y Fr(MPI_Type_struct\(3,)18 b(blocklen,)i(disp,)h(type,)g
(&Particletype\);)249 561 y(MPI_Type_commit\(&P)o(artic)o(lety)o(pe\);)
249 669 y(...)249 723 y(/*)43 b(send)21 b(the)g(entire)g(array)g(*/)249
831 y(MPI_Send\(particle,)d(1000,)j(Particletype,)e(dest,)i(tag,)g
(comm\);)249 885 y(...)249 981 y FB(A)n(dvic)n(e)12 b(to)g
(implementors.)34 b FA(The)12 b(absolute)f(v)n(alue)f(returned)j(b)o(y)
e Fw(MPI)p 1363 981 13 2 v 14 w(ADDRESS)f FA(is)h(not)g(sig-)249
1034 y(ni\014can)o(t;)h(only)g(relativ)o(e)h(displacemen)o(ts,)f(that)g
(is)h(di\013erences)i(b)q(et)o(w)o(een)e(addresses)i(of)d(di\013er-)249
1088 y(en)o(t)h(v)n(ariables,)f(are)i(signi\014can)o(t.)j(Therefore,)d
(the)g(implem)o(en)o(tation)c(ma)o(y)h(pic)o(k)i(an)g(arbitrary)249
1142 y(\\starting)h(p)q(oin)o(t")f(as)h(lo)q(cation)f(zero)i(in)e
(memory)m(.)i(\()p FB(End)h(of)f(advic)n(e)g(to)g(implementors.)p
FA(\))249 1263 y FD(3.6)52 b(Lo)o(w)o(er-b)q(ound)18
b(and)g(Upp)q(er-b)q(ound)g(Mark)o(ers)249 1371 y FA(Sometimes)11
b(it)j(is)f(necessary)j(to)d(o)o(v)o(erride)h(the)g(de\014nition)f(of)g
(exten)o(t)i(giv)o(en)e(in)g(Section)h(3.2.)249 1425
y(Consider,)h(for)g(example,)f(the)h(co)q(de)h(in)f(Example)e(3.21)h
(in)g(the)i(previous)f(section.)22 b(Assume)249 1479
y(that)16 b(a)g Fq(double)e FA(o)q(ccupies)j(8)f(b)o(ytes)g(and)g(m)o
(ust)f(b)q(e)h(double-w)o(ord)g(aligned.)23 b(There)17
b(will)d(b)q(e)j(7)249 1533 y(b)o(ytes)h(of)f(padding)g(after)h(the)g
(\014rst)g(\014eld)g(and)f(one)h(b)o(yte)g(of)e(padding)h(after)h(the)g
(last)f(\014eld)249 1587 y(of)j(the)h(structure)i Fw(P)o(a)o(rtstruct)p
FA(,)f(and)e(the)h(structure)i(will)c(o)q(ccup)o(y)i(64)f(b)o(ytes.)38
b(If,)22 b(on)e(the)249 1641 y(other)d(hand,)f(a)g Fq(double)f
FA(can)h(b)q(e)h(w)o(ord)f(aligned)f(only)m(,)g(then)h(there)i(will)c
(b)q(e)j(only)e(3)h(b)o(ytes)h(of)249 1694 y(padding)d(after)i(the)f
(\014rst)h(\014eld,)f(and)g Fw(P)o(a)o(rtstruct)g FA(will)f(o)q(ccup)o
(y)i(60)e(b)o(ytes.)22 b(The)16 b Fw(MPI)e FA(library)249
1748 y(will)j(follo)o(w)f(the)j(alignmen)o(t)c(rules)k(used)g(on)f(the)
h(target)f(systems)h(so)f(that)g(the)h(exten)o(t)g(of)249
1802 y(datat)o(yp)q(e)g Fw(P)o(a)o(rticlet)o(yp)q(e)h
FA(equals)f(the)g(amoun)o(t)e(of)h(storage)i(o)q(ccupied)f(b)o(y)g
Fw(P)o(a)o(rtstruct)p FA(.)33 b(The)249 1856 y(catc)o(h)14
b(is)g(that)f(di\013eren)o(t)h(alignmen)o(t)e(rules)i(ma)o(y)d(b)q(e)j
(sp)q(eci\014ed,)h(on)e(the)h(same)f(system,)g(using)249
1910 y(di\013eren)o(t)j(compiler)d(options.)21 b(An)15
b(ev)o(en)h(more)e(di\016cult)g(problem)g(is)g(that)h(some)f(compilers)
249 1964 y(allo)o(w)g(the)h(use)h(of)f(pragmas)e(in)i(order)h(to)f(sp)q
(ecify)g(di\013eren)o(t)h(alignmen)o(t)d(rules)j(for)e(di\013eren)o(t)
249 2018 y(structures)22 b(within)e(the)g(same)f(program.)35
b(\(Man)o(y)19 b(arc)o(hitectures)j(can)e(correctly)i(handle)249
2072 y(misaligned)7 b(v)n(alues,)j(but)g(with)f(lo)o(w)o(er)h(p)q
(erformance;)g(di\013eren)o(t)h(alignmen)o(t)c(rules)k(trade)f(sp)q
(eed)249 2126 y(of)15 b(access)j(for)d(storage)h(densit)o(y)m(.\))24
b(The)16 b Fw(MPI)f FA(library)g(will)f(assume)h(the)h(default)g
(alignmen)o(t)249 2180 y(rules.)26 b(Ho)o(w)o(ev)o(er,)17
b(the)h(user)f(should)f(b)q(e)h(able)g(to)f(o)o(v)o(errule)h(this)f
(assumption)f(if)h(structures)249 2234 y(are)e(pac)o(k)o(ed)h
(otherwise.)291 2288 y(T)m(o)j(allo)o(w)f(this)i(capabilit)o(y)m(,)f
(MPI)i(has)f(t)o(w)o(o)f(additional)g(\\pseudo-datat)o(yp)q(es,")i
Fq(MPI)p 1686 2288 12 2 v 13 w(LB)249 2342 y FA(and)13
b Fq(MPI)p 401 2342 V 12 w(UB)p FA(,)25 b(that)13 b(can)g(b)q(e)g
(used,)h(resp)q(ectiv)o(ely)m(,)f(to)g(mark)e(the)i(lo)o(w)o(er)g(b)q
(ound)f(or)h(the)g(upp)q(er)249 2396 y(b)q(ound)g(of)f(a)g(datat)o(yp)q
(e.)18 b(These)c(pseudo-datat)o(yp)q(es)f(o)q(ccup)o(y)h(no)e(space)i
(\()p Fp(extent)p FA(\()p Fw(MPI)p 1622 2396 V 13 w(LB)q
FA(\))d(=)249 2450 y Fp(extent)p FA(\()p Fw(MPI)p 459
2450 V 14 w(UB)o FA(\))19 b(=)g(0\).)31 b(They)19 b(do)f(not)g
(a\013ect)i(the)f(size)g(or)f(coun)o(t)h(of)e(a)h(datat)o(yp)q(e,)i
(and)249 2504 y(do)d(not)f(a\013ect)i(the)f(the)h(con)o(ten)o(t)f(of)f
(a)h(message)f(created)i(with)f(this)g(datat)o(yp)q(e.)26
b(Ho)o(w)o(ev)o(er,)p eop
%%Page: 131 145
131 144 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(131)249 507 y FA(they)18 b(do)g(c)o(hange)g(the)g
(exten)o(t)h(of)e(a)h(datat)o(yp)q(e)g(and,)g(therefore,)i(a\013ect)e
(the)h(outcome)e(of)g(a)249 561 y(replication)c(of)h(this)g(datat)o(yp)
q(e)g(b)o(y)f(a)h(datat)o(yp)q(e)g(constructor.)249 655
y Fs(Example)h(3.22)21 b FA(Let)d Fw(D)f(=)g(\(-3,)h(0,)f(6\))p
FA(;)i Fw(T)e(=)h(\(MPI)p 1113 655 13 2 v 14 w(LB,)f(MPI)p
1281 655 V 15 w(INT,)g(MPI)p 1469 655 V 14 w(UB\))p FA(,)f(and)h
Fw(B)g(=)249 709 y(\(1,)i(1,)h(1\))p FA(.)32 b(Then)20
b(a)e(call)g(to)h Fw(MPI)p 818 709 V 14 w(TYPE)p 940
709 V 14 w(STRUCT\(3,)g(B,)f(D,)h(T,)f(t)o(yp)q(e1\))i
FA(creates)g(a)f(new)249 763 y(datat)o(yp)q(e)13 b(that)f(has)h(an)f
(exten)o(t)h(of)f(9)g(\(from)f(-3)h(to)g(5,)g(5)h(included\),)f(and)g
(con)o(tains)h(an)f(in)o(teger)249 817 y(at)17 b(displacemen)o(t)f(0.)
27 b(This)17 b(datat)o(yp)q(e)h(has)f(t)o(yp)q(e)g(map:)23
b Ft(f)p Fw(\(lb,)17 b(-3\),)g(\(int,)h(0\),)f(\(ub,)i(6\))p
Ft(g)d FA(.)28 b(If)249 871 y(this)13 b(t)o(yp)q(e)h(is)f(replicated)g
(t)o(wice)h(b)o(y)e(a)h(call)f(to)h Fw(MPI)p 1052 871
V 15 w(TYPE)p 1175 871 V 14 w(CONTIGUOUS\(2,)d(t)o(yp)q(e1,)k(t)o(yp)q
(e2\))249 925 y FA(then)g Fw(t)o(yp)q(e2)g FA(has)f(t)o(yp)q(e)g(map:)j
Ft(f)p Fw(\(lb,)d(-3\),)g(\(int,)g(0\),)g(\(int,9\),)f(\(ub,)i(15\))p
Ft(g)e FA(.)18 b(\(An)13 b(en)o(try)h(of)f(t)o(yp)q(e)g
Fw(lb)249 979 y FA(can)h(b)q(e)h(deleted)g(if)e(there)i(is)e(another)i
(en)o(try)f(of)g(t)o(yp)q(e)g Fw(lb)g FA(at)g(a)f(lo)o(w)o(er)h
(address;)g(and)g(an)g(en)o(try)249 1033 y(of)f(t)o(yp)q(e)i
Fw(ub)f FA(can)h(b)q(e)f(deleted)h(if)e(there)i(is)f(another)g(en)o
(try)h(of)e(t)o(yp)q(e)i Fw(ub)f FA(at)g(a)g(higher)g(address.\))291
1127 y(In)f(general,)h(if)249 1213 y Fp(T)6 b(y)q(pemap)13
b FA(=)f Ft(f)p FA(\()p Fp(ty)q(pe)589 1219 y Fk(0)608
1213 y Fp(;)7 b(disp)703 1219 y Fk(0)722 1213 y FA(\))p
Fp(;)g(:)g(:)g(:)e(;)i FA(\()p Fp(ty)q(pe)923 1219 y
Fj(n)p Fm(\000)p Fk(1)988 1213 y Fp(;)g(disp)1083 1219
y Fj(n)p Fm(\000)p Fk(1)1148 1213 y FA(\))p Ft(g)p Fp(;)249
1299 y FA(then)15 b(the)f Fs(lo)o(w)o(er)h(b)q(ound)d
FA(of)h Fp(T)6 b(y)q(pemap)15 b FA(is)f(de\014ned)h(to)f(b)q(e)291
1375 y Fp(l)q(b)p FA(\()p Fp(T)6 b(y)q(pemap)p FA(\))13
b(=)581 1317 y Fi(\032)632 1349 y FA(min)702 1355 y Fj(j)726
1349 y Fp(disp)802 1355 y Fj(j)1275 1349 y FA(if)g(no)g(en)o(try)i(has)
f(basic)g(t)o(yp)q(e)g Fw(lb)632 1402 y FA(min)702 1408
y Fj(j)719 1402 y Ft(f)p Fp(disp)816 1408 y Fj(j)847
1402 y FA(suc)o(h)h(that)f Fp(ty)q(pe)1107 1408 y Fj(j)1137
1402 y FA(=)e Fw(lb)p Ft(g)42 b FA(otherwise)249 1452
y(Similarly)l(,)11 b(the)j Fs(upp)q(er)h(b)q(ound)d FA(of)h
Fp(T)6 b(y)q(pemap)15 b FA(is)f(de\014ned)h(to)f(b)q(e)291
1528 y Fp(ub)p FA(\()p Fp(T)6 b(y)q(pemap)p FA(\))12
b(=)591 1470 y Fi(\032)643 1502 y FA(max)720 1508 y Fj(j)745
1502 y Fp(disp)821 1508 y Fj(j)848 1502 y FA(+)d Fp(siz)r(eof)t
FA(\()p Fp(ty)q(pe)1098 1508 y Fj(j)1119 1502 y FA(\))g(+)h
Fp(\017)102 b FA(if)13 b(no)g(en)o(try)i(has)f(basic)g(t)o(yp)q(e)g
Fw(ub)643 1556 y FA(max)720 1562 y Fj(j)738 1556 y Ft(f)p
Fp(disp)835 1562 y Fj(j)866 1556 y FA(suc)o(h)h(that)f
Fp(ty)q(pe)1126 1562 y Fj(j)1156 1556 y FA(=)e Fw(ub)p
Ft(g)42 b FA(otherwise)249 1605 y(And)291 1659 y Fp(extent)p
FA(\()p Fp(T)6 b(y)q(pemap)p FA(\))13 b(=)f Fp(ub)p FA(\()p
Fp(T)6 b(y)q(pemap)p FA(\))k Ft(\000)g Fp(l)q(b)p FA(\()p
Fp(T)c(y)q(pemap)p FA(\))249 1713 y(If)14 b Fp(ty)q(pe)367
1719 y Fj(i)397 1713 y FA(requires)i(alignmen)o(t)c(to)i(a)h(b)o(yte)f
(address)i(that)f(is)f(a)h(m)o(ultiple)d(of)i Fp(k)1477
1719 y Fj(i)1490 1713 y FA(,)h(then)g Fp(\017)f FA(is)h(the)249
1767 y(least)c(nonnegativ)o(e)f(incremen)o(t)g(needed)i(to)e(round)h
Fp(extent)p FA(\()p Fp(T)6 b(y)q(pemap)p FA(\))12 b(to)f(the)g(next)g
(m)o(ultiple)249 1821 y(of)i(max)373 1827 y Fj(i)394
1821 y Fp(k)416 1827 y Fj(i)429 1821 y FA(.)18 b(The)c(formal)d
(de\014nitions)i(giv)o(en)g(for)g(the)h(v)n(arious)f(datat)o(yp)q(e)h
(constructors)h(con-)249 1875 y(tin)o(ue)f(to)g(apply)m(,)f(with)g(the)
i(amended)e(de\014nition)h(of)g Fs(exten)o(t)p FA(.)i(Also,)e
Fw(MPI)p 1446 1875 V 14 w(TYPE)p 1568 1875 V 14 w(EXTENT)249
1929 y FA(returns)i(the)e(ab)q(o)o(v)o(e)g(as)g(its)f(v)n(alue)h(for)f
(exten)o(t.)249 2022 y Fs(Example)i(3.23)21 b FA(W)m(e)9
b(mo)q(dify)f(Example)g(3.21,)h(so)h(that)f(the)i(co)q(de)f(explicitly)
f(sets)i(the)f(exten)o(t)249 2076 y(of)g Fw(P)o(a)o(rticlet)o(yp)q(e)i
FA(to)e(the)i(righ)o(t)e(v)n(alue,)g(rather)i(than)e(trusting)h
Fw(MPI)f FA(to)h(compute)f(\014lls)g(correctly)m(.)249
2130 y Fr(struct)21 b(Partstruct)314 2184 y({)314 2238
y(char)65 b(class;)42 b(/*)22 b(particle)e(class)h(*/)314
2292 y(double)g(d[6];)64 b(/*)22 b(particle)e(coordinates)f(*/)314
2346 y(char)65 b(b[7];)f(/*)22 b(some)f(additional)e(information)h(*/)
314 2400 y(};)249 2454 y(struct)h(Partstruct)85 b(particle[1000];)249
2508 y(int)392 b(i,)21 b(dest,)g(rank;)p eop
%%Page: 132 146
132 145 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(132)1256 b(Chapter)13 b(3)249
507 y Fr(MPI_Comm)107 b(comm;)249 561 y(MPI_Datatype)19
b(Particletype;)249 615 y(MPI_Datatype)g(type[4])i(=)g({MPI_CHAR,)f
(MPI_DOUBLE,)g(MPI_CHAR,)f(MPI_UB};)249 669 y(int)217
b(blocklen[4])20 b(=)h({1,)h(6,)f(7,)g(1};)249 723 y(MPI_Aint)107
b(disp[4];)249 831 y(/*)21 b(compute)g(displacements)e(of)i(structure)f
(components)g(*/)249 939 y(MPI_Address\(partic)o(le,)f(&disp[0]\);)249
993 y(MPI_Address\(partic)o(le[0])o(.d,)f(&disp[1]\);)249
1047 y(MPI_Address\(partic)o(le[0])o(.b,)g(&disp[2]\);)249
1101 y(MPI_Address\(partic)o(le[1])o(,)h(&disp[3]\);)249
1209 y(for)i(\(i=3;)g(i)h(>=)f(0;)g(i--\))g(disp[i])g(-=)g(disp[0];)249
1317 y(/*)g(build)g(datatype)f(for)i(structure)d(*/)249
1425 y(MPI_Type_struct\(4,)f(blocklen,)i(disp,)h(type,)g
(&Particletype\);)249 1479 y(MPI_Type_commit\(&P)o(artic)o(lety)o
(pe\);)249 1587 y(/*)43 b(send)21 b(the)g(entire)g(array)g(*/)249
1694 y(MPI_Send\(particle,)d(1000,)j(Particletype,)e(dest,)i(tag,)g
(comm\);)291 1790 y FA(The)14 b(t)o(w)o(o)f(functions)h(b)q(elo)o(w)f
(can)h(b)q(e)h(used)f(for)g(\014nding)f(the)h(lo)o(w)o(er)g(b)q(ound)f
(and)h(the)g(upp)q(er)249 1844 y(b)q(ound)g(of)f(a)h(datat)o(yp)q(e.)
249 1969 y Fw(MPI)p 326 1969 13 2 v 14 w(TYPE)p 448 1969
V 15 w(LB\(datat)o(yp)q(e,)h(displacement\))332 2043
y Fv(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)332
2093 y(OUT)114 b Fw(displacement)324 b Fv(displacemen)o(t)16
b(of)d(lo)o(w)o(er)g(b)q(ound)249 2203 y Fr(int)21 b(MPI)p
405 2203 14 2 v 15 w(Type)p 508 2203 V 15 w(lb\(MPI)p
655 2203 V 15 w(Datatype)f(datatype,)g(MPI)p 1150 2203
V 15 w(Aint*)h(displacement\))249 2287 y(MPI)p 318 2287
V 15 w(TYPE)p 421 2287 V 15 w(LB\(DATATYPE,)e(DISPLACEMENT,)g(IERROR\))
336 2341 y(INTEGER)i(DATATYPE,)f(DISPLACEMENT,)f(IERROR)291
2425 y Fw(MPI)p 368 2425 13 2 v 14 w(TYPE)p 490 2425
V 14 w(LB)e FA(returns)h(the)f(lo)o(w)o(er)f(b)q(ound)h(of)f(a)g(datat)
o(yp)q(e,)h(in)f(b)o(ytes,)i(relativ)o(e)e(to)h(the)249
2479 y(datat)o(yp)q(e)d(origin.)p eop
%%Page: 133 147
133 146 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(133)249 507 y Fw(MPI)p 326 507 13 2
v 14 w(TYPE)p 448 507 V 15 w(UB\(datat)o(yp)q(e,)14 b(displacement\))
332 582 y Fv(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)332
632 y(OUT)114 b Fw(displacement)324 b Fv(displacemen)o(t)16
b(of)d(upp)q(er)h(b)q(ound)249 742 y Fr(int)21 b(MPI)p
405 742 14 2 v 15 w(Type)p 508 742 V 15 w(ub\(MPI)p 655
742 V 15 w(Datatype)f(datatype,)g(MPI)p 1150 742 V 15
w(Aint*)h(displacement\))249 826 y(MPI)p 318 826 V 15
w(TYPE)p 421 826 V 15 w(UB\(DATATYPE,)e(DISPLACEMENT,)g(IERROR\))336
880 y(INTEGER)i(DATATYPE,)f(DISPLACEMENT,)f(IERROR)291
964 y Fw(MPI)p 368 964 13 2 v 14 w(TYPE)p 490 964 V 14
w(UB)c FA(returns)h(the)g(upp)q(er)g(b)q(ound)g(of)f(a)g(datat)o(yp)q
(e,)g(in)g(b)o(ytes,)h(relativ)o(e)f(to)g(the)249 1018
y(datat)o(yp)q(e)f(origin.)249 1138 y FD(3.7)52 b(Absolute)18
b(Addresses)249 1246 y FA(Consider)d(Example)e(3.21)h(on)g(page)h(129.)
20 b(One)15 b(computes)g(the)g(\\absolute)g(address")h(of)e(the)249
1300 y(structure)20 b(comp)q(onen)o(ts,)e(using)g(calls)f(to)h
Fw(MPI)p 1017 1300 V 14 w(ADDRESS)p FA(,)f(then)i(subtracts)g(the)f
(starting)249 1354 y(address)e(of)e(the)i(arra)o(y)e(to)h(compute)f
(relativ)o(e)h(displacemen)o(ts.)20 b(When)15 b(the)h(send)g(op)q
(eration)249 1408 y(is)11 b(executed,)i(the)f(starting)f(address)i(of)e
(the)g(arra)o(y)g(is)g(added)h(bac)o(k,)f(in)g(order)h(to)f(compute)g
(the)249 1462 y(send)k(bu\013er)g(lo)q(cation.)j(These)d(sup)q
(er\015uous)h(arithmetics)e(could)f(b)q(e)i(a)o(v)o(oided)f(if)f
(\\absolute")249 1516 y(addresses)i(w)o(ere)g(used)f(in)e(the)i(deriv)o
(ed)g(datat)o(yp)q(e,)f(and)g(\\address)h(zero")g(w)o(as)f(passed)i(as)
e(the)249 1570 y Fw(bu\013er)j FA(argumen)o(t)c(in)i(the)g(send)h
(call.)291 1624 y Fw(MPI)10 b FA(supp)q(orts)j(the)f(use)g(of)f(suc)o
(h)h(\\absolute")f(addresses)i(in)e(deriv)o(ed)h(datat)o(yp)q(es.)18
b(The)12 b(dis-)249 1678 y(placemen)o(t)k(argumen)o(ts)g(used)h(in)f
(datat)o(yp)q(e)h(constructors)h(can)f(b)q(e)g(\\absolute)f
(addresses",)249 1732 y(i.e.,)j(addresses)i(returned)g(b)o(y)e(calls)g
(to)g Fw(MPI)p 990 1732 V 14 w(ADDRESS)p FA(.)f(Address)j(zero)f(is)e
(indicated)i(to)249 1786 y(comm)o(unication)9 b(functions)j(b)o(y)g
(passing)g(the)h(constan)o(t)f Fq(MPI)p 1221 1786 12
2 v 13 w(BOTTOM)h FA(as)f(the)h(bu\013er)g(argu-)249
1840 y(men)o(t.)19 b(Unlik)o(e)14 b(deriv)o(ed)h(datat)o(yp)q(es)g
(with)f(relativ)o(e)g(displacemen)o(ts,)g(the)h(use)g(of)f(\\absolute")
249 1894 y(addresses)i(restricts)g(the)e(use)h(to)f(the)g(sp)q
(eci\014c)i(structure)g(for)d(whic)o(h)h(it)g(w)o(as)f(created.)249
1989 y Fs(Example)i(3.24)21 b FA(The)13 b(co)q(de)h(in)e(Example)g
(3.21)f(on)i(page)g(129)f(is)g(mo)q(di\014ed)g(to)h(use)g(absolute)249
2043 y(addresses,)j(rather)e(than)g(relativ)o(e)g(displacemen)o(ts.)249
2097 y Fr(struct)21 b(Partstruct)314 2151 y({)314 2205
y(char)65 b(class;)42 b(/*)22 b(particle)e(class)h(*/)314
2259 y(double)g(d[6];)64 b(/*)22 b(particle)e(coordinates)f(*/)314
2313 y(char)65 b(b[7];)f(/*)22 b(some)f(additional)e(information)h(*/)
314 2367 y(};)249 2421 y(struct)h(Partstruct)85 b(particle[1000];)249
2475 y(int)392 b(i,)21 b(dest,)g(rank;)p eop
%%Page: 134 148
134 147 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(134)1256 b(Chapter)13 b(3)249
507 y Fr(MPI_Comm)107 b(comm;)249 615 y(/*)21 b(build)g(datatype)f
(describing)g(structure)g(*/)249 723 y(MPI_Datatype)f(Particletype;)249
777 y(MPI_Datatype)g(type[3])i(=)g({MPI_CHAR,)f(MPI_DOUBLE,)g
(MPI_CHAR};)249 831 y(int)217 b(blocklen[3])20 b(=)h({1,)h(6,)f(7};)249
885 y(MPI_Aint)107 b(disp[3];)249 993 y(/*)21 b(compute)g(addresses)f
(of)h(components)f(in)h(1st)g(structure*/)249 1101 y
(MPI_Address\(partic)o(le,)e(disp\);)249 1155 y(MPI_Address\(partic)o
(le[0])o(.d,)f(disp+1\);)249 1209 y(MPI_Address\(partic)o(le[0])o(.b,)g
(disp+2\);)249 1317 y(/*)j(build)g(datatype)f(for)i(1st)f(structure)f
(*/)249 1425 y(MPI_Type_struct\(3,)e(blocklen,)i(disp,)h(type,)g
(&Particletype\);)249 1479 y(MPI_Type_commit\(&P)o(artic)o(lety)o
(pe\);)249 1587 y(/*)43 b(send)21 b(the)g(entire)g(array)g(*/)249
1694 y(MPI_Send\(MPI_BOTTO)o(M,)e(1000,)h(Particletype,)g(dest,)g(tag,)
h(comm\);)249 1773 y FB(A)n(dvic)n(e)d(to)h(implementors.)59
b FA(On)18 b(systems)f(with)h(a)f(\015at)h(address)h(space,)g(the)f
(implemen-)249 1827 y(tation)f(ma)o(y)f(pic)o(k)h(an)h(arbitrary)f
(address)i(as)f(the)g(v)n(alue)f(of)g Fq(MPI)p 1318 1827
12 2 v 13 w(BOTTOM)h FA(in)f(C)h(\(or)g(the)249 1881
y(address)f(of)e(the)h(v)n(ariable)f Fq(MPI)p 751 1881
V 13 w(BOTTOM)h FA(in)f(F)m(ortran\).)23 b(All)15 b(that)h(is)f(needed)
j(is)d(that)h(calls)249 1935 y(to)d Fw(MPI)p 376 1935
13 2 v 14 w(ADDRESS\(lo)q(cation,)g(address\))h FA(return)g(the)f
(displacemen)o(t)g(of)f Fw(lo)q(cation)p FA(,)h(relativ)o(e)g(to)249
1989 y Fq(MPI)p 321 1989 12 2 v 13 w(BOTTOM)p FA(.)g(\()p
FB(End)j(of)f(advic)n(e)g(to)g(implementors.)p FA(\))291
2076 y(The)e(use)g(of)f(addresses)i(and)f(displacemen)o(ts)f(in)g
Fw(MPI)g FA(is)g(b)q(est)i(understo)q(o)q(d)g(in)e(the)h(con)o(text)249
2130 y(of)g(a)h(\015at)g(address)h(space.)20 b(Then,)14
b(the)g(\\address")h(of)e(a)h(lo)q(cation,)f(as)h(computed)f(b)o(y)h
(calls)g(to)249 2184 y Fw(MPI)p 326 2184 13 2 v 14 w(ADDRESS)i
FA(can)h(b)q(e)g(the)h(regular)e(address)i(of)e(that)h(lo)q(cation)f
(\(or)g(a)h(shift)f(of)g(it\),)h(and)249 2238 y(in)o(teger)c
(arithmetic)e(on)h Fw(MPI)g FA(\\addresses")i(yields)e(the)h(exp)q
(ected)i(result.)j(Ho)o(w)o(ev)o(er,)13 b(the)g(use)249
2292 y(of)g(a)h(\015at)g(address)h(space)g(is)f(not)f(mandated)g(b)o(y)
h(C)f(or)h(F)m(ortran.)k(Another)d(p)q(oten)o(tial)e(source)249
2346 y(of)g(problems)g(is)h(that)g(F)m(ortran)g Fr(INTEGER)p
FA('s)e(ma)o(y)g(b)q(e)i(to)q(o)g(short)g(to)g(store)h(full)e
(addresses.)291 2400 y(V)m(ariables)k(b)q(elong)h(to)f(the)i(same)e
Fs(sequen)o(tial)h(storage)e FA(if)i(they)g(b)q(elong)g(to)g(the)g
(same)249 2454 y(arra)o(y)m(,)g(to)g(the)h(same)f Fw(COMMON)g
FA(blo)q(c)o(k)g(in)g(F)m(ortran,)g(or)h(to)f(the)h(same)e(structure)k
(in)d(C.)249 2508 y(Implemen)o(tations)12 b(ma)o(y)g(restrict)j(the)g
(use)g(of)f(addresses)i(so)e(that)g(arithmetic)f(on)h(addresses)p
eop
%%Page: 135 149
135 148 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(135)249 507 y FA(is)14 b(con\014ned)h(within)e
(sequen)o(tial)h(storage.)k(Namely)m(,)11 b(in)j(a)f(comm)o(unication)e
(call,)h(either)208 590 y Ft(\017)20 b FA(The)13 b(comm)o(unicati)o(on)
c(bu\013er)k(sp)q(eci\014ed)h(b)o(y)e(the)h Fw(bu\013,)g(count)g
FA(and)f Fq(datat)o(yp)q(e)g FA(argumen)o(ts)g(is)g(all)249
644 y(within)h(the)i(same)e(sequen)o(tial)h(storage.)208
715 y Ft(\017)20 b FA(The)13 b(initial)e(bu\013er)j(address)h(argumen)o
(t)c Fw(bu\013)j FA(is)f(equal)g(to)f Fq(MPI)p 1253 715
12 2 v 13 w(BOTTOM)p FA(,)h Fw(count=1)h FA(and)f(all)249
769 y(addresses)h(in)d(the)h(t)o(yp)q(e)g(map)e(of)h
Fw(datat)o(yp)q(e)i FA(are)f(absolute)g(addresses)h(of)e(the)i(form)c
Fw(v+i)p FA(,)j(where)249 823 y Fw(v)h FA(is)f(an)h(absolute)g(address)
h(computed)e(b)o(y)g Fw(MPI)p 1011 823 13 2 v 15 w(ADDR)p
FA(,)f Fw(i)i FA(is)f(an)h(in)o(teger)g(displacemen)o(t,)f(and)249
877 y Fw(v+i)i FA(is)g(in)f(the)i(same)e(sequen)o(tial)h(storage)g(as)g
Fw(v)p FA(.)249 968 y FB(A)n(dvic)n(e)e(to)g(users.)35
b FA(Curren)o(t)12 b Fw(MPI)e FA(implem)o(en)o(tations)e(imp)q(ose)i
(no)h(restrictions)h(on)f(the)g(use)h(of)249 1022 y(addresses.)20
b(If)11 b(F)m(ortran)h Fr(INTEGER)p FA('s)e(ha)o(v)o(e)i(32)f(bits,)h
(then)g(the)h(the)f(use)h(of)e(absolute)h(addresses)249
1076 y(in)i(F)m(ortran)g(programs)f(ma)o(y)f(b)q(e)j(restricted)h(to)e
(4)g(GB)g(memory)m(.)i(This)e(ma)o(y)e(require,)j(in)f(the)249
1130 y(future,)j(to)f(mo)o(v)o(e)f(from)f Fr(INTEGER)h
FA(addresses)j(to)f Fr(INTEGER*8)d FA(addresses.)27 b(\()p
FB(End)18 b(of)f(advic)n(e)249 1184 y(to)e(users.)p FA(\))249
1304 y FD(3.8)52 b(P)o(ac)o(k)17 b(and)h(Unpac)o(k)249
1412 y FA(Some)d(existing)h(comm)o(unicati)o(on)d(libraries,)j(suc)o(h)
h(as)f(PVM)g(and)g(P)o(armacs,)g(pro)o(vide)f(pac)o(k)249
1466 y(and)i(unpac)o(k)g(functions)f(for)h(sending)g(noncon)o(tiguous)f
(data.)27 b(In)33 b(these,)18 b(the)g(application)249
1520 y(explicitly)11 b(pac)o(ks)g(data)g(in)o(to)g(a)g(con)o(tiguous)g
(bu\013er)i(b)q(efore)f(sending)g(it,)f(and)g(unpac)o(ks)h(it)f(from)
249 1574 y(a)i(con)o(tiguous)g(bu\013er)h(after)g(receiving)f(it.)18
b(Deriv)o(ed)13 b(datat)o(yp)q(es,)g(describ)q(ed)i(in)e(the)h
(previous)249 1628 y(sections)20 b(of)e(this)g(c)o(hapter,)j(allo)o(w)
16 b(one,)k(in)e(most)f(cases,)k(to)d(a)o(v)o(oid)g(explicit)g(pac)o
(king)g(and)249 1682 y(unpac)o(king.)h(The)c(application)e(sp)q
(eci\014es)j(the)f(la)o(y)o(out)e(of)h(the)h(data)f(to)g(b)q(e)h(sen)o
(t)g(or)g(receiv)o(ed,)249 1736 y(and)d Fw(MPI)g FA(directly)h
(accesses)i(a)d(noncon)o(tiguous)g(bu\013er)h(when)g(deriv)o(ed)g
(datat)o(yp)q(es)g(are)g(used.)249 1790 y(The)18 b(pac)o(k/unpac)o(k)e
(routines)i(are)g(pro)o(vided)f(for)f(compatibilit)o(y)e(with)j
(previous)g(libraries.)249 1844 y(Also,)f(they)h(pro)o(vide)g(some)e
(functionalit)o(y)g(that)h(is)h(not)f(otherwise)h(a)o(v)n(ailable)e(in)
h Fw(MPI)p FA(.)f(F)m(or)249 1898 y(instance,)j(a)e(message)g(can)h(b)q
(e)g(receiv)o(ed)h(in)e(sev)o(eral)h(parts,)g(where)h(the)f(receiv)o(e)
h(op)q(eration)249 1952 y(done)d(on)g(a)g(later)g(part)h(ma)o(y)d(dep)q
(end)j(on)f(the)h(con)o(ten)o(t)f(of)g(a)g(former)f(part.)22
b(Another)16 b(use)g(is)249 2006 y(that)g(the)g(a)o(v)n(ailabil)o(it)o
(y)c(of)j(pac)o(k)g(and)h(unpac)o(k)f(op)q(erations)h(facilitates)e
(the)j(dev)o(elopmen)o(t)d(of)249 2060 y(additional)e(comm)o(unication)
f(libraries)i(la)o(y)o(ered)h(on)g(top)f(of)h Fw(MPI)p
FA(.)p eop
%%Page: 136 150
136 149 bop 2 223 2 150 v 2 76 150 2 v 1928 76 V 2076
225 2 150 v 249 251 a Fv(136)1256 b(Chapter)13 b(3)249
507 y Fw(MPI)p 326 507 13 2 v 14 w(P)m(A)o(CK\(inbuf,)g(incount,)i
(datat)o(yp)q(e,)f(outbuf,)g(outsize,)g(p)q(osition,)g(comm\))332
582 y Fv(IN)158 b Fw(inbuf)460 b Fv(input)15 b(bu\013er)332
632 y(IN)158 b Fw(incount)419 b Fv(n)o(um)o(b)q(er)14
b(of)f(input)h(comp)q(onen)o(ts)332 682 y(IN)158 b Fw(datat)o(yp)q(e)
397 b Fv(datat)o(yp)q(e)14 b(of)f(eac)o(h)g(input)i(comp)q(onen)o(t)332
731 y(OUT)114 b Fw(outbuf)434 b Fv(output)14 b(bu\013er)332
781 y(IN)158 b Fw(outsize)427 b Fv(output)14 b(bu\013er)g(size,)g(in)f
(b)o(ytes)332 831 y(INOUT)71 b Fw(p)q(osition)410 b Fv(curren)o(t)14
b(p)q(osition)h(in)f(bu\013er,)g(in)f(b)o(ytes)332 881
y(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)15 b(for)e(pac)o(k)o(ed)h
(message)249 991 y Fr(int)21 b(MPI)p 405 991 14 2 v 15
w(Pack\(void*)f(inbuf,)h(int)g(incount,)f(MPI)p 1162
991 V 15 w(Datatype)g(datatype,)540 1045 y(void)h(*outbuf,)f(int)h
(outsize,)f(int)h(*position,)540 1099 y(MPI)p 609 1099
V 15 w(Comm)g(comm\))249 1183 y(MPI)p 318 1183 V 15 w(PACK\(INBUF,)f
(INCOUNT,)g(DATATYPE,)g(OUTBUF,)g(OUTSIZE,)g(POSITION,)g(COMM,)540
1237 y(IERROR\))336 1291 y(<type>)h(INBUF\(*\),)f(OUTBUF\(*\))336
1345 y(INTEGER)h(INCOUNT,)f(DATATYPE,)g(OUTSIZE,)g(POSITION,)g(COMM,)g
(IERROR)291 1429 y Fw(MPI)p 368 1429 13 2 v 14 w(P)m(A)o(CK)12
b FA(pac)o(ks)k(a)e(message)g(sp)q(eci\014ed)j(b)o(y)d
Fw(inbuf,)h(incount,)h(datat)o(yp)q(e,)g(comm)d FA(in)o(to)h(the)249
1483 y(bu\013er)f(space)g(sp)q(eci\014ed)h(b)o(y)e Fw(outbuf)h
FA(and)f Fw(outsize)p FA(.)17 b(The)c(input)f(bu\013er)h(can)f(b)q(e)h
(an)o(y)f(comm)o(uni-)249 1537 y(cation)h(bu\013er)h(allo)o(w)o(ed)e
(in)g Fw(MPI)p 762 1537 V 15 w(SEND)p FA(.)g(The)i(output)f(bu\013er)h
(is)f(a)g(con)o(tiguous)g(storage)g(area)249 1591 y(con)o(taining)g
Fw(outsize)h FA(b)o(ytes,)g(starting)g(at)g(the)g(address)i
Fw(outbuf)p FA(.)291 1645 y(The)c(input)g(v)n(alue)f(of)g
Fw(p)q(osition)h FA(is)g(the)h(\014rst)f(p)q(osition)g(in)f(the)i
(output)f(bu\013er)h(to)e(b)q(e)i(used)g(for)249 1699
y(pac)o(king.)k(The)11 b(argumen)o(t)g Fw(p)q(osition)g
FA(is)g(incremen)o(ted)h(b)o(y)f(the)h(size)g(of)f(the)h(pac)o(k)o(ed)f
(message)g(so)249 1753 y(that)g(it)f(can)h(b)q(e)h(used)f(as)g(input)g
(to)f(a)h(subsequen)o(t)h(call)e(to)h Fw(MPI)p 1234 1753
V 14 w(P)m(A)o(CK)p FA(.)d(The)k Fw(comm)d FA(argumen)o(t)249
1807 y(is)i(the)g(comm)o(unicator)e(that)i(will)e(b)q(e)j(subsequen)o
(tly)g(used)g(for)e(sending)h(the)h(pac)o(k)o(ed)f(message.)249
1931 y Fw(MPI)p 326 1931 V 14 w(UNP)m(A)o(CK\(inbuf,)i(insize,)h(p)q
(osition,)f(outbuf,)i(outcount,)f(datat)o(yp)q(e,)h(comm\))332
2006 y Fv(IN)158 b Fw(inbuf)460 b Fv(input)15 b(bu\013er)332
2056 y(IN)158 b Fw(insize)453 b Fv(size)14 b(of)f(input)h(bu\013er,)g
(in)g(b)o(ytes)332 2106 y(INOUT)71 b Fw(p)q(osition)410
b Fv(curren)o(t)14 b(p)q(osition)h(in)f(b)o(ytes)332
2156 y(OUT)114 b Fw(outbuf)434 b Fv(output)14 b(bu\013er)332
2205 y(IN)158 b Fw(outcount)393 b Fv(n)o(um)o(b)q(er)14
b(of)f(comp)q(onen)o(ts)h(to)f(b)q(e)g(unpac)o(k)o(ed)332
2255 y(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14
b(of)f(eac)o(h)g(output)h(comp)q(onen)o(t)332 2305 y(IN)158
b Fw(comm)439 b Fv(comm)o(unicator)15 b(for)e(pac)o(k)o(ed)h(message)
249 2415 y Fr(int)21 b(MPI)p 405 2415 14 2 v 15 w(Unpack\(void*)f
(inbuf,)g(int)h(insize,)g(int)g(*position,)f(void)h(*outbuf,)540
2469 y(int)g(outcount,)f(MPI)p 914 2469 V 15 w(Datatype)g(datatype,)g
(MPI)p 1409 2469 V 15 w(Comm)h(comm\))p eop
%%Page: 137 151
137 150 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(137)249 507 y Fr(MPI)p 318 507 14 2
v 15 w(UNPACK\(INBUF,)19 b(INSIZE,)i(POSITION,)f(OUTBUF,)g(OUTCOUNT,)g
(DATATYPE,)540 561 y(COMM,)g(IERROR\))336 615 y(<type>)h(INBUF\(*\),)f
(OUTBUF\(*\))336 669 y(INTEGER)h(INSIZE,)f(POSITION,)g(OUTCOUNT,)g
(DATATYPE,)g(COMM,)g(IERROR)291 753 y Fw(MPI)p 368 753
13 2 v 14 w(UNP)m(A)o(CK)11 b FA(unpac)o(ks)i(a)f(message)h(in)o(to)f
(the)h(receiv)o(e)h(bu\013er)g(sp)q(eci\014ed)h(b)o(y)d
Fw(outbuf,)h(out-)249 807 y(count,)e(datat)o(yp)q(e)h
FA(from)c(the)i(bu\013er)h(space)g(sp)q(eci\014ed)g(b)o(y)f
Fw(inbuf)h FA(and)f Fw(insize)p FA(.)17 b(The)10 b(output)g(bu\013er)
249 861 y(can)j(b)q(e)h(an)o(y)f(comm)o(unication)d(bu\013er)k(allo)o
(w)o(ed)e(in)h Fw(MPI)p 1137 861 V 14 w(RECV)p FA(.)e(The)j(input)f
(bu\013er)h(is)f(a)g(con-)249 915 y(tiguous)j(storage)h(area)f(con)o
(taining)g Fw(insize)h FA(b)o(ytes,)g(starting)f(at)h(address)g
Fw(inbuf)p FA(.)27 b(The)17 b(input)249 969 y(v)n(alue)12
b(of)h Fw(p)q(osition)g FA(is)g(the)g(p)q(osition)g(in)f(the)i(input)e
(bu\013er)i(where)h(one)e(wishes)g(the)h(unpac)o(king)249
1023 y(to)k(b)q(egin.)30 b(The)18 b(output)g(v)n(alue)f(of)h
Fw(p)q(osition)g FA(is)f(incremen)o(ted)i(b)o(y)e(the)i(size)f(of)g
(the)g(pac)o(k)o(ed)249 1077 y(message,)12 b(so)g(that)h(it)f(can)h(b)q
(e)g(used)g(as)f(input)h(to)f(a)g(subsequen)o(t)i(call)e(to)g
Fw(MPI)p 1473 1077 V 14 w(UNP)m(A)o(CK)p FA(.)e(The)249
1131 y(argumen)o(t)j Fw(comm)f FA(w)o(as)i(the)g(comm)o(unicator)d
(used)k(to)f(receiv)o(e)h(the)f(pac)o(k)o(ed)h(message.)249
1222 y FB(R)n(ationale.)49 b FA(The)17 b(P)o(ac)o(k)f(and)f(Unpac)o(k)h
(calls)g(ha)o(v)o(e)g(a)f(comm)o(unicator)e(argumen)o(t)i(in)h(order)
249 1276 y(to)h(facilitate)e(data)i(con)o(v)o(ersion)f(at)h(the)g
(source)h(in)e(a)h(heterogeneous)i(en)o(vironmen)o(t.)25
b(E.g.,)249 1330 y(this)17 b(will)e(allo)o(w)g(for)i(an)f(implemen)o
(tation)d(that)k(uses)h(the)f(XDR)f(format)f(for)i(pac)o(k)o(ed)g(data)
249 1384 y(in)j(a)f(heterogeneous)j(comm)o(unication)17
b(domain,)h(and)i(p)q(erforms)g(no)f(data)h(con)o(v)o(ersion)g(if)249
1438 y(the)13 b(comm)o(unicatio)o(n)c(domain)h(is)i(homogeneous.)17
b(If)12 b(no)g(comm)o(uni)o(cator)e(w)o(as)i(pro)o(vided,)g(the)249
1492 y(implemen)o(tation)7 b(w)o(ould)j(alw)o(a)o(ys)g(use)h(XDR.)f(If)
g(the)h(destination)g(w)o(as)g(pro)o(vided,)f(in)h(addition)249
1546 y(to)i(the)g(comm)o(unicator,)d(then)j(one)g(w)o(ould)f(b)q(e)h
(able)f(to)h(format)e(the)i(pac)o(k)g(bu\013er)g(sp)q(eci\014cally)249
1600 y(for)f(that)g(destination.)18 b(But,)13 b(then,)f(one)h(loses)g
(the)g(abilit)o(y)d(to)j(pac)o(k)f(a)g(bu\013er)h(once)g(and)g(send)249
1654 y(it)h(to)f(m)o(ultiple)f(destinations.)18 b(\()p
FB(End)e(of)f(r)n(ationale.)p FA(\))249 1745 y FB(A)n(dvic)n(e)j(to)g
(users.)56 b FA(Note)18 b(the)g(di\013erence)h(b)q(et)o(w)o(een)g
Fw(MPI)p 1209 1745 V 14 w(RECV)d FA(and)h Fw(MPI)p 1505
1745 V 14 w(UNP)m(A)o(CK)p FA(:)e(in)249 1799 y Fw(MPI)p
326 1799 V 14 w(RECV)p FA(,)10 b(the)i Fw(count)h FA(argumen)o(t)d(sp)q
(eci\014es)k(the)e(maxim)n(um)7 b(n)o(um)o(b)q(er)k(of)g(comp)q(onen)o
(ts)g(that)249 1853 y(can)j(b)q(e)g(receiv)o(ed.)19 b(In)13
b Fw(MPI)p 684 1853 V 15 w(UNP)m(A)o(CK)p FA(,)d(the)k
Fw(count)h FA(argumen)o(t)d(sp)q(eci\014es)j(the)f(actual)f(n)o(um)o(b)
q(er)249 1907 y(of)g(comp)q(onen)o(ts)f(that)i(are)f(unpac)o(k)o(ed;)h
(The)f(reason)h(for)f(that)g(c)o(hange)h(is)f(that,)g(for)g(a)f
(regular)249 1961 y(receiv)o(e,)i(the)h(incoming)c(message)i(size)h
(determines)g(the)g(n)o(um)o(b)q(er)f(of)g(comp)q(onen)o(ts)g(that)h
(will)249 2015 y(b)q(e)h(receiv)o(ed.)20 b(With)13 b
Fw(MPI)p 666 2015 V 15 w(UNP)m(A)o(CK)p FA(,)e(it)j(is)g(up)g(to)g(the)
h(user)g(to)f(sp)q(ecify)h(ho)o(w)f(man)o(y)e(comp)q(o-)249
2069 y(nen)o(ts)17 b(he)f(or)g(she)h(w)o(an)o(ts)f(to)g(unpac)o(k,)g
(since)h(one)f(ma)o(y)e(w)o(an)o(t)i(to)g(unpac)o(k)g(only)f(part)h(of)
g(the)249 2123 y(message.)i(\()p FB(End)e(of)e(advic)n(e)h(to)g(users.)
p FA(\))291 2214 y(The)10 b Fw(MPI)p 449 2214 V 14 w(P)m(A)o(CK/MPI)p
666 2214 V 12 w(UNP)m(A)o(CK)e FA(calls)i(relate)h(to)e(message)h
(passing)g(as)g(the)h Fw(sp)o(rintf/sscanf)249 2268 y
FA(calls)j(in)g(C)g(relate)h(to)f(\014le)g(I/O,)g(or)g(in)o(ternal)g(F)
m(ortran)g(\014les)h(relate)f(to)h(external)f(units.)20
b(Basi-)249 2322 y(cally)m(,)10 b(the)i Fw(MPI)p 499
2322 V 15 w(P)m(A)o(CK)d FA(function)i(allo)o(ws)f(one)i(to)g(\\send")f
(a)h(message)f(in)o(to)g(a)g(memory)e(bu\013er;)249 2376
y(the)i Fw(MPI)p 394 2376 V 15 w(UNP)m(A)o(CK)d FA(function)j(allo)o
(ws)e(one)i(to)g(\\receiv)o(e")g(a)g(message)f(from)f(a)i(memory)d
(bu\013er.)291 2430 y(Sev)o(eral)i(comm)o(uni)o(cation)d(bu\013ers)k
(can)f(b)q(e)h(successiv)o(ely)g(pac)o(k)o(ed)f(in)o(to)f(one)h
Fs(pac)o(king)g(unit)p FA(.)249 2484 y(This)16 b(is)g(e\013ected)i(b)o
(y)d(sev)o(eral,)i(successiv)o(e)h Fs(related)13 b FA(calls)j(to)g
Fw(MPI)p 1332 2484 V 14 w(P)m(A)o(CK)p FA(,)d(where)k(the)g(\014rst)p
eop
%%Page: 138 152
138 151 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(138)1256 b(Chapter)13 b(3)249
507 y FA(call)f(pro)o(vides)i Fw(p)q(osition)f(=)h(0)p
FA(,)e(and)h(eac)o(h)h(successiv)o(e)h(call)e(inputs)g(the)h(v)n(alue)e
(of)h Fw(p)q(osition)g FA(that)249 561 y(w)o(as)d(output)g(b)o(y)g(the)
h(previous)g(call,)e(and)h(the)h(same)e(v)n(alues)h(for)g
Fw(outbuf,)h(outcount)h FA(and)e Fw(comm)p FA(.)249 615
y(This)16 b(pac)o(king)g(unit)g(no)o(w)g(con)o(tains)g(the)h(equiv)n
(alen)o(t)e(information)e(that)k(w)o(ould)e(ha)o(v)o(e)h(b)q(een)249
669 y(stored)e(in)e(a)h(message)f(b)o(y)h(one)g(send)g(call)f(with)h(a)
f(send)i(bu\013er)g(that)f(is)f(the)i(\\concatenation")249
723 y(of)f(the)i(individual)d(send)i(bu\013ers.)291 777
y(A)20 b(pac)o(king)g(unit)g(m)o(ust)f(b)q(e)i(sen)o(t)g(using)f(t)o
(yp)q(e)h Fq(MPI)p 1147 777 12 2 v 12 w(P)m(A)o(CKED)p
FA(.)d(An)o(y)j(p)q(oin)o(t-to-p)q(oin)o(t)d(or)249 831
y(collectiv)o(e)f(comm)o(unication)d(function)j(can)g(b)q(e)h(used.)28
b(The)18 b(message)e(sen)o(t)i(is)f(iden)o(tical)g(to)249
885 y(the)j(message)f(that)g(w)o(ould)g(b)q(e)h(sen)o(t)g(b)o(y)f(a)g
(send)i(op)q(eration)e(with)g(a)g Fw(datat)o(yp)q(e)i
FA(argumen)o(t)249 939 y(describing)f(the)h(concatenation)f(of)g(the)g
(send)h(bu\013er\(s\))g(used)g(in)f(the)g(P)o(ac)o(k)g(calls.)36
b(The)249 993 y(message)14 b(can)g(b)q(e)g(receiv)o(ed)h(with)f(an)o(y)
f(datat)o(yp)q(e)i(that)f(matc)o(hes)f(this)h(send)h(datat)o(yp)q(e.)
249 1088 y Fs(Example)g(3.25)21 b FA(The)14 b(follo)o(wing)d(t)o(w)o(o)
j(programs)e(generate)k(iden)o(tical)d(messages.)291
1142 y(Deriv)o(ed)h(datat)o(yp)q(e)g(is)f(used:)249 1196
y Fr(int)21 b(i;)249 1250 y(char)g(c[100];)249 1358 y(int)g(disp[2];)
249 1412 y(int)g(blocklen[2])f(=)h({1,)h(100})249 1466
y(MPI_Datatype)d(type[2])i(=)g({MPI_INT,)f(MPI_CHAR};)249
1520 y(MPI_Datatype)f(Type;)249 1628 y(/*)i(create)g(datatype)f(*/)249
1682 y(MPI_Address\(&i,)f(&disp[0]\);)249 1736 y(MPI_Address\(c,)g
(&disp[1]\);)249 1790 y(MPI_Type_struct\(2,)f(blocklen,)i(disp,)h
(type,)g(&Type\);)249 1844 y(MPI_Type_commit\(&T)o(ype\);)249
1952 y(/*)g(send)g(*/)249 2006 y(MPI_Send\(MPI_BOTTO)o(M,)e(1,)i(Type,)
g(1,)g(0,)h(MPI_COMM_WORLD\);)291 2060 y FA(P)o(ac)o(king)13
b(is)h(used:)249 2114 y Fr(int)21 b(i;)249 2168 y(char)g(c[100];)249
2276 y(char)g(buffer[110];)249 2330 y(int)g(position)f(=)i(0;)249
2438 y(/*)f(pack)g(*/)249 2492 y(MPI_Pack\(&i,)e(1,)j(MPI_INT,)e
(buffer,)g(110,&position,)f(MPI_COMM_WORLD\);)p eop
%%Page: 139 153
139 152 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(139)249 507 y Fr(MPI_Pack\(c,)20 b(100,)h(MPI_CHAR,)e
(buffer,)i(110,)g(&position,)f(MPI_COMM_WORLD\))o(;)249
615 y(/*)h(send)g(*/)249 669 y(MPI_Send\(buffer,)e(position,)g
(MPI_PACKED,)h(1,)h(0,)h(MPI_COMM_WORLD\);)291 860 y
FA(An)o(y)d(message)g(can)h(b)q(e)g(receiv)o(ed)h(in)e(a)g(p)q(oin)o
(t-to-p)q(oin)o(t)f(or)h(collectiv)o(e)h(comm)o(unicatio)o(n)249
914 y(using)f(the)h(t)o(yp)q(e)g Fq(MPI)p 611 914 12
2 v 13 w(P)m(A)o(CKED)p FA(.)d(Suc)o(h)j(a)f(message)g(can)h(then)g(b)q
(e)g(unpac)o(k)o(ed)g(b)o(y)f(calls)h(to)249 968 y Fw(MPI)p
326 968 13 2 v 14 w(UNP)m(A)o(CK)p FA(.)14 b(The)j(message)f(can)g(b)q
(e)h(unpac)o(k)o(ed)g(b)o(y)f(sev)o(eral,)h(successiv)o(e)h(calls)e(to)
g Fw(MPI-)p 249 1022 V 262 1022 a(UNP)m(A)o(CK)p FA(,)9
b(where)k(the)g(\014rst)g(call)f(pro)o(vides)g Fw(p)q(osition)g(=)h(0)p
FA(,)f(and)g(eac)o(h)g(successiv)o(e)j(call)c(inputs)249
1076 y(the)k(v)n(alue)e(of)g Fw(p)q(osition)h FA(that)g(w)o(as)g
(output)g(b)o(y)g(the)h(previous)f(call,)f(and)g(the)i(same)e(v)n
(alues)h(for)249 1130 y Fw(inbuf,)g(insize)h FA(and)f
Fw(comm)p FA(.)249 1213 y Fs(Example)h(3.26)21 b FA(An)o(y)f(of)h(the)g
(follo)o(wing)d(t)o(w)o(o)j(programs)e(can)i(b)q(e)g(used)h(to)f
(receiv)o(e)h(the)249 1267 y(message)14 b(sen)o(t)g(in)g(Example)e
(3.25.)17 b(The)d(outcome)f(will)g(b)q(e)h(iden)o(tical.)291
1321 y(Deriv)o(ed)g(datat)o(yp)q(e)g(is)f(used:)249 1375
y Fr(int)21 b(i;)249 1429 y(char)g(c[100];)249 1537 y(MPI_status)f
(status;)249 1645 y(int)h(disp[2];)249 1699 y(int)g(blocklen[2])f(=)h
({1,)h(100})249 1753 y(MPI_Datatype)d(type[2])i(=)g({MPI_INT,)f
(MPI_CHAR};)249 1807 y(MPI_Datatype)f(Type;)249 1914
y(/*)i(create)g(datatype)f(*/)249 1968 y(MPI_Address\(&i,)f
(&disp[0]\);)249 2022 y(MPI_Address\(c,)g(&disp[1]\);)249
2076 y(MPI_Type_struct\(2,)f(blocklen,)i(disp,)h(type,)g(&Type\);)249
2130 y(MPI_Type_commit\(&T)o(ype\);)249 2238 y(/*)g(receive)g(*/)249
2292 y(MPI_Recv\(MPI_BOTTO)o(M,)e(1,)i(Type,)g(0,)g(0,)h
(MPI_COMM_WORLD,)c(&status\);)291 2346 y FA(Unpac)o(king)13
b(is)h(used:)249 2400 y Fr(int)21 b(i;)249 2454 y(char)g(c[100];)p
eop
%%Page: 140 154
140 153 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(140)1256 b(Chapter)13 b(3)249
507 y Fr(MPI_Status)20 b(status;)249 615 y(char)h(buffer[110];)249
669 y(int)g(position)f(=)i(0;)249 777 y(/*)f(receive)g(*/)249
831 y(MPI_Recv\(buffer,)e(110,)i(MPI_PACKED,)e(1,)i(0,)h
(MPI_COMM_WORLD,)c(&status\);)249 939 y(/*)j(unpack)g(*/)249
993 y(MPI_Unpack\(buffer,)d(110,)j(&position,)f(&i,)h(1,)g(MPI_INT,)g
(MPI_COMM_WORLD\))o(;)249 1047 y(MPI_Unpack\(buffer,)d(110,)j
(&position,)f(c,)h(100,)g(MPI_CHAR,)f(MPI_COMM_WORLD\);)249
1142 y FB(A)n(dvic)n(e)15 b(to)g(users.)39 b FA(A)14
b(pac)o(king)f(unit)h(ma)o(y)f(con)o(tain,)g(in)h(addition)f(to)h
(data,)f(metadata.)18 b(F)m(or)249 1196 y(example,)11
b(it)g(ma)o(y)f(con)o(tain)h(in)h(a)g(header,)g(information)d(on)j(the)
g(enco)q(ding)h(used)f(to)g(represen)o(t)249 1250 y(data;)k(or)g
(information)d(on)j(the)h(size)g(of)e(the)i(unit)e(for)h(error)h(c)o
(hec)o(king.)25 b(Therefore,)17 b(suc)o(h)g(a)249 1304
y(pac)o(king)11 b(unit)g(has)h(to)f(treated)i(as)e(an)h(\\atomic")d(en)
o(tit)o(y)i(whic)o(h)h(can)f(only)g(b)q(e)h(sen)o(t)h(using)e(t)o(yp)q
(e)249 1358 y Fq(MPI)p 321 1358 12 2 v 13 w(P)m(A)o(CKED)p
FA(.)h(One)j(cannot)g(concatenate)i(t)o(w)o(o)d(suc)o(h)h(pac)o(king)f
(units)h(and)g(send)g(the)h(result)249 1412 y(in)d(one)h(send)h(op)q
(eration)f(\(ho)o(w)o(ev)o(er,)g(a)f(collectiv)o(e)h(comm)o(unication)c
(op)q(eration)k(can)g(b)q(e)h(used)249 1466 y(to)e(send)g(m)o(ultiple)e
(pac)o(king)h(units)h(in)f(one)h(op)q(erations,)g(to)g(the)g(same)f
(exten)o(t)i(it)e(can)h(b)q(e)h(used)249 1520 y(to)f(send)h(m)o
(ultiple)d(regular)i(messages\).)18 b(Also,)13 b(one)g(cannot)h(split)e
(a)h(pac)o(king)g(unit)g(and)g(then)249 1574 y(unpac)o(k)j(the)g(t)o(w)
o(o)f(halv)o(es)h(separately)g(\(ho)o(w)o(ev)o(er,)g(a)g(collectiv)o(e)
f(comm)o(unication)e(op)q(eration)249 1628 y(can)h(b)q(e)g(used)g(to)f
(receiv)o(e)h(m)o(ultiple)d(pac)o(king)i(units,)g(to)g(the)h(same)f
(exten)o(t)h(it)f(can)g(b)q(e)h(used)h(to)249 1682 y(receiv)o(e)g(m)o
(ultiple)d(regular)i(messages\).)k(\()p FB(End)e(of)e(advic)n(e)i(to)f
(users.)p FA(\))249 1844 y Fw(MPI)p 326 1844 13 2 v 14
w(P)m(A)o(CK)p 447 1844 V 13 w(SIZE\(incount,)g(datat)o(yp)q(e,)g
(comm,)c(size\))332 1919 y Fv(IN)158 b Fw(incount)419
b Fv(coun)o(t)14 b(argumen)o(t)g(to)f(pac)o(king)h(call)332
1969 y(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(datat)o(yp)q(e)14
b(argumen)o(t)g(to)f(pac)o(king)i(call)332 2019 y(IN)158
b Fw(comm)439 b Fv(comm)o(unicator)14 b(argumen)o(t)f(to)f(pac)o(king)i
(call)332 2068 y(OUT)114 b Fw(size)484 b Fv(upp)q(er)13
b(b)q(ound)g(on)g(size)f(of)g(pac)o(k)o(ed)h(message,)1079
2122 y(in)h(b)o(ytes)249 2233 y Fr(int)21 b(MPI)p 405
2233 14 2 v 15 w(Pack)p 508 2233 V 15 w(size\(int)f(incount,)g(MPI)p
981 2233 V 16 w(Datatype)g(datatype,)g(MPI)p 1477 2233
V 15 w(Comm)h(comm,)540 2286 y(int)g(*size\))249 2370
y(MPI)p 318 2370 V 15 w(PACK)p 421 2370 V 15 w(SIZE\(INCOUNT,)e
(DATATYPE,)h(COMM,)h(SIZE,)g(IERROR\))336 2424 y(INTEGER)g(INCOUNT,)f
(DATATYPE,)g(COMM,)g(SIZE,)h(IERROR)p eop
%%Page: 141 155
141 154 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(141)291 507 y Fw(MPI)p 368 507 13 2
v 14 w(P)m(A)o(CK)p 489 507 V 13 w(SIZE)18 b FA(allo)o(ws)g(the)h
(application)e(to)i(\014nd)g(out)g(ho)o(w)f(m)o(uc)o(h)g(space)h(is)g
(needed)249 561 y(to)f(pac)o(k)f(a)h(message)f(and,)h(th)o(us,)h
(manage)d(space)i(allo)q(cation)e(for)i(bu\013ers.)31
b(The)18 b(function)249 615 y(returns,)c(in)f Fw(size)p
FA(,)g(an)f(upp)q(er)i(b)q(ound)f(on)g(the)h(incremen)o(t)e(in)h
Fw(p)q(osition)g FA(that)g(w)o(ould)f(o)q(ccur)i(in)f(a)249
669 y(call)g(to)h Fw(MPI)p 453 669 V 14 w(P)m(A)o(CK)e
FA(with)i(the)g(same)f(v)n(alues)h(for)f Fw(incount,)i(datat)o(yp)q(e)p
FA(,)g(and)e Fw(comm)p FA(.)249 757 y FB(R)n(ationale.)35
b FA(The)12 b Fw(MPI)p 628 757 V 14 w(P)m(A)o(CK)p 749
757 V 13 w(SIZE)e FA(call)h(returns)h(an)f(upp)q(er)h(b)q(ound,)f
(rather)h(than)f(an)g(exact)249 811 y(b)q(ound,)h(since)g(the)g(exact)g
(amoun)o(t)e(of)h(space)i(needed)g(to)e(pac)o(k)h(the)g(message)f(ma)o
(y)f(dep)q(end)j(on)249 865 y(the)h(comm)o(unication)c(domain)i(\(see)j
(Chapter)f(5\))f(\(for)g(example,)f(the)i(\014rst)h(message)e(pac)o(k)o
(ed)249 919 y(in)g(a)h(pac)o(king)f(unit)h(ma)o(y)e(con)o(tain)h
(additional)f(metadata\).)17 b(\()p FB(End)f(of)f(r)n(ationale.)p
FA(\))249 997 y Fs(Example)g(3.27)21 b FA(W)m(e)15 b(return)h(to)g(the)
g(problem)e(of)g(Example)g(3.15)g(on)h(page)h(120.)21
b(Pro)q(cess)249 1051 y(zero)f(sends)f(to)g(pro)q(cess)h(one)f(a)g
(message)f(con)o(taining)g(all)f(class)i(zero)h(particles.)32
b(Pro)q(cess)249 1105 y(one)15 b(receiv)o(es)h(and)e(stores)i(these)g
(structures)h(in)d(con)o(tiguous)h(lo)q(cations.)k(Pro)q(cess)e(zero)e
(uses)249 1159 y(calls)c(to)h Fw(MPI)p 465 1159 V 14
w(P)m(A)o(CK)e FA(to)h(gather)i(class)f(zero)g(particles,)h(whereas)g
(pro)q(cess)g(one)f(uses)h(a)e(regular)249 1213 y(receiv)o(e.)249
1267 y Fr(struct)21 b(Partstruct)314 1321 y({)314 1375
y(char)65 b(class;)42 b(/*)22 b(particle)e(class)h(*/)314
1429 y(double)g(d[6];)64 b(/*)22 b(particle)e(coordinates)f(*/)314
1483 y(char)65 b(b[7];)f(/*)22 b(some)f(additional)e(information)h(*/)
314 1537 y(};)249 1591 y(struct)h(Partstruct)85 b(particle[1000];)249
1645 y(int)217 b(i,)22 b(size,)f(position,)e(myrank;)249
1699 y(int)217 b(count;)21 b(/*)g(number)g(of)g(class)g(zero)g
(particles)f(*/)249 1753 y(char)195 b(*buffer;)21 b(/*)g(pack)g(buffer)
f(*/)249 1807 y(MPI_Status)63 b(status;)249 1914 y(/*)21
b(variables)f(used)h(to)h(create)e(datatype)g(for)i(particle)e(*/)249
2022 y(MPI_Datatype)f(Particletype;)249 2076 y(MPI_Datatype)g(type[3])i
(=)g({MPI_CHAR,)f(MPI_DOUBLE,)g(MPI_CHAR};)249 2130 y(int)217
b(blocklen[3])20 b(=)h({1,)h(6,)f(7};)249 2184 y(MPI_Aint)107
b(disp[3])21 b(=)g({0,)g(sizeof\(double\),)e(7*sizeof\(double\)};)249
2292 y(/*)i(define)g(datatype)f(for)h(one)g(particle)g(*/)249
2400 y(MPI_Type_struct\()e(3,)i(blocklen,)f(disp,)h(type,)f
(&Particletype\);)249 2454 y(MPI_Type_commit\()f(&Particletype\);)249
2508 y(MPI_Comm_rank\(comm)o(,)g(&myrank\);)p eop
%%Page: 142 156
142 155 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(142)1256 b(Chapter)13 b(3)249
561 y Fr(if)21 b(\(myrank)g(==)g(0\))h({)249 669 y(/*)f(send)g(message)
g(that)g(consists)f(of)h(class)g(zero)g(particles)f(*/)314
777 y(/*)i(allocate)e(pack)h(buffer)f(*/)314 885 y
(MPI_Pack_size\(1000,)e(Particletype,)h(comm,)i(&size\);)314
939 y(buffer)g(=)h(\(char*\)malloc\(s)o(ize\);)314 1047
y(/*)g(pack)f(class)g(zero)g(particles)e(*/)314 1155
y(position)42 b(=)22 b(0;)314 1209 y(for\(i=0;)f(i)g(<)h(1000;)f(i++\))
380 1263 y(if)g(\(particle[i].class)d(==)k(0\))445 1317
y(MPI_Pack\(&particle)o([i],)c(1,)k(Particletype,)d(buffer,)772
1371 y(size,)i(&position,)f(comm\);)314 1479 y(/*)i(send)f(*/)314
1533 y(MPI_Send\(buffer,)e(position,)h(MPI_PACKED,)f(1,)j(0,)f(comm\);)
314 1587 y(})249 1694 y(else)g(if)g(\(myrank)g(==)g(1\))h({)249
1802 y(/*)f(receive)g(class)g(zero)g(particles)e(in)j(contiguous)e
(locations)f(in)314 1856 y(array)i(particle)f(*/)314
1964 y(MPI_Recv\(particle,)f(1000,)h(Particletype,)f(0,)j(0,)f(comm,)g
(&status\);)314 2018 y(})249 2114 y Fs(Example)15 b(3.28)21
b FA(This)d(is)g(a)g(v)n(arian)o(t)f(on)h(the)h(previous)f(example,)g
(where)h(the)g(class)g(zero)249 2168 y(particles)c(ha)o(v)o(e)f(to)g(b)
q(e)g(receiv)o(ed)i(b)o(y)e(pro)q(cess)i(one)e(in)g(arra)o(y)g
Fw(pa)o(rticle)h FA(at)f(the)h(same)e(lo)q(cations)249
2222 y(where)g(they)e(are)h(in)f(the)h(arra)o(y)f(of)g(pro)q(cess)i
(zero.)18 b(Pro)q(cess)c(zero)e(pac)o(ks)f(the)h(en)o(try)g(index)g
(with)249 2276 y(eac)o(h)g(en)o(try)g(it)f(sends.)18
b(Pro)q(cess)13 b(one)f(uses)g(this)g(information)c(to)j(mo)o(v)o(e)f
(incoming)f(data)i(to)g(the)249 2330 y(righ)o(t)i(lo)q(cations.)k(As)c
(a)g(further)h(optimization,)c(w)o(e)j(a)o(v)o(oid)f(the)h(transfer)h
(of)e(the)i Fr(class)e FA(\014eld,)249 2384 y(whic)o(h)h(is)g(kno)o(wn)
f(to)h(b)q(e)h(zero.)k(\(W)m(e)13 b(ha)o(v)o(e)g(ignored)f(in)h(this)g
(example)f(the)h(computation)e(of)i(a)249 2438 y(tigh)o(t)d(b)q(ound)h
(on)f(the)h(size)h(of)e(the)h(pac)o(k/unpac)o(k)g(bu\013er.)18
b(One)11 b(could)f(b)q(e)i(rigorous)e(and)g(de\014ne)249
2492 y(an)j(additional)f(deriv)o(ed)i(datat)o(yp)q(e)g(for)f(the)h
(purp)q(ose)g(of)f(computing)f(suc)o(h)i(an)g(estimate.)j(Or)p
eop
%%Page: 143 157
143 156 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(143)249 507 y FA(one)14 b(can)g(use)h(an)f(appro)o
(ximate)e(estimate.\))249 561 y Fr(struct)21 b(Partstruct)314
615 y({)314 669 y(char)65 b(class;)42 b(/*)22 b(particle)e(class)h(*/)
314 723 y(double)g(d[6];)64 b(/*)22 b(particle)e(coordinates)f(*/)314
777 y(char)65 b(b[7];)f(/*)22 b(some)f(additional)e(information)h(*/)
314 831 y(};)249 885 y(struct)h(Partstruct)85 b(particle[1000];)249
939 y(int)217 b(i,)22 b(size,)f(myrank;)249 993 y(int)217
b(position)21 b(=)g(0;)249 1047 y(MPI_Status)63 b(status;)249
1101 y(char)195 b(buffer[BUFSIZE];)19 b(/*)i(pack-unpack)f(buffer)g(*/)
249 1209 y(/*)h(variables)f(used)h(to)h(create)e(datatype)g(for)i
(particle,)314 1263 y(not)g(including)e(class)g(field)h(*/)249
1371 y(MPI_Datatype)e(Particletype;)249 1425 y(MPI_Datatype)g(type[2])i
(=)g({MPI_DOUBLE,)f(MPI_CHAR};)249 1479 y(int)217 b(blocklen[2])20
b(=)h({6,)h(7};)249 1533 y(MPI_Aint)107 b(disp[2])21
b(=)g({0,)g(6*sizeof\(double\)};)249 1641 y(/*)g(define)g(datatype)f
(*/)249 1748 y(MPI_Type_struct\(2,)e(blocklen,)i(disp,)h(type,)g
(&Particletype\);)249 1802 y(MPI_Type_commit\(&P)o(artic)o(lety)o
(pe\);)249 1910 y(MPI_Comm_rank\(MPI_)o(COMM_)o(WORL)o(D,)e(&myrank\);)
249 2018 y(if)i(\(myrank)g(==)g(0\))h({)249 2126 y(/*)f(send)g(message)
g(that)g(consists)f(of)h(class)g(zero)g(particles)f(*/)314
2234 y(/*)i(pack)f(class)g(zero)g(particles)e(and)j(their)e(index)h(*/)
314 2342 y(for\(i=0;)g(i)g(<)h(1000;)f(i++\))380 2396
y(if)g(\(particle[i].class)d(==)k(0\))f({)445 2450 y(MPI_Pack\(&i,)f
(1,)h(MPI_INT,)f(buffer,)g(BUFSIZE,)641 2504 y(&position,)g
(MPI_COMM_WORLD\);)f(/*)i(pack)g(index)g(*/)p eop
%%Page: 144 158
144 157 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(144)1256 b(Chapter)13 b(3)445
507 y Fr(MPI_Pack\(particle[)o(i].d,)18 b(1,)k(Particletype,)d(buffer,)
641 561 y(BUFSIZE,)h(&position,)g(MPI_COMM_WORLD\);)f(/*)i(pack)g
(struct)g(*/)445 615 y(})336 669 y(/*)h(pack)f(negative)f(index)g(as)i
(end)f(of)g(list)g(marker)g(*/)336 777 y(i)h(=)f(-1;)336
831 y(MPI_Pack\(&i,)f(1,)h(MPI_INT,)f(buffer,)g(BUFSIZE,)532
885 y(&position,)g(MPI_COMM_WORLD\);)314 993 y(/*)i(send)f(*/)314
1047 y(MPI_Send\(buffer,)e(position,)h(MPI_PACKED,)f(1,)j(0,)f
(MPI_COMM_WORLD\);)314 1101 y(})249 1209 y(else)g(if)g(\(myrank)g(==)g
(1\))h({)249 1317 y(/*)f(receive)g(class)g(zero)g(particles)e(at)j
(original)e(locations)g(*/)314 1425 y(/*)i(receive)e(*/)314
1479 y(MPI_Recv\(buffer,)f(BUFSIZE,)h(MPI_PACKED,)g(0,)h(0,)g
(MPI_COMM_WORLD,)e(&status\);)314 1587 y(/*)j(unpack)e(*/)314
1641 y(while)h(\(\(MPI_Unpack\(buffe)o(r,)e(BUFSIZE,)h(&position,)g
(&i,)h(1,)554 1694 y(MPI_INT,)f(MPI_COMM_WORLD\);)f(i\))i(>=)h(0\))f({)
43 b(/*)22 b(unpack)e(index)h(*/)380 1748 y(MPI_Unpack\(buffer)o(,)e
(BUFSIZE,)h(&position,)g(particle[i].d,)554 1802 y(1,)i(Particletype,)d
(MPI_COMM_WORLD\);)105 b(/*)22 b(unpack)e(struct)h(*/)380
1856 y(particle[i].class)d(=)k(0;)380 1910 y(})314 1964
y(})249 2047 y Fs(3.8.1)48 b(Deriv)o(ed)14 b(Datat)o(yp)q(es)g(vs)i(P)o
(ac)o(k/Unpac)o(k)249 2130 y FA(A)11 b(comparison)f(b)q(et)o(w)o(een)j
(Example)d(3.15)g(on)h(page)h(120)e(and)h(Example)f(3.27)g(in)h(the)h
(previous)249 2184 y(section)j(is)e(instructiv)o(e.)291
2238 y(First,)k(programmi)o(ng)d(con)o(v)o(enience.)28
b(It)17 b(is)f(somewhat)g(less)h(tedious)g(to)g(pac)o(k)g(the)g(class)
249 2292 y(zero)g(particles)f(in)g(the)h(lo)q(op)e(that)h(lo)q(cates)g
(them,)g(rather)g(then)h(de\014ning)f(in)g(this)g(lo)q(op)f(the)249
2346 y(datat)o(yp)q(e)f(that)g(will)e(later)i(collect)g(them.)k(On)c
(the)g(other)h(hand,)e(it)g(w)o(ould)g(b)q(e)i(v)o(ery)f(tedious)249
2400 y(\(and)h(ine\016cien)o(t\))h(to)f(pac)o(k)g(separately)g(the)h
(comp)q(onen)o(ts)f(of)f(eac)o(h)i(structure)h(en)o(try)f(in)f(the)249
2454 y(arra)o(y)m(.)26 b(De\014ning)16 b(a)g(datat)o(yp)q(e)h(is)g
(more)f(con)o(v)o(enien)o(t)h(when)g(this)g(de\014nition)f(dep)q(ends)i
(only)249 2508 y(on)d(declarations;)g(pac)o(king)f(ma)o(y)g(b)q(e)h
(more)f(con)o(v)o(enien)o(t)i(when)f(the)h(comm)o(unicatio)o(n)c
(bu\013er)p eop
%%Page: 145 159
145 158 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(User-De\014ned)14 b(Datat)o(yp)q(es)g(and)g(P)
o(ac)o(king)819 b(145)249 507 y FA(la)o(y)o(out)13 b(is)g(data)h(dep)q
(enden)o(t.)291 561 y(Second,)j(storage)h(use.)27 b(The)18
b(pac)o(king)e(co)q(de)h(uses)h(at)f(least)g(56,000)e(b)o(ytes)j(for)e
(the)h(pac)o(k)249 615 y(bu\013er,)23 b(e.g.,)e(up)g(to)f(1000)f
(copies)j(of)e(the)h(structure)i(\(1)d(c)o(har,)i(6)e(doubles,)i(and)f
(7)f(c)o(har)249 669 y(is)e(1)13 b(+)f(8)g Ft(\002)h
FA(6)f(+)g(7)20 b(=)f(56)f(b)o(ytes\).)33 b(The)19 b(deriv)o(ed)g
(datat)o(yp)q(e)g(co)q(de)g(uses)h(12,000)d(b)o(ytes)i(for)249
723 y(the)f(three,)g(1,000)d(long,)i(in)o(teger)g(arra)o(ys)g(used)h
(to)e(de\014ne)i(the)g(deriv)o(ed)f(datat)o(yp)q(e.)27
b(It)17 b(also)249 777 y(probably)12 b(uses)i(a)f(similar)d(amoun)o(t)h
(of)h(storage)h(for)g(the)g(in)o(ternal)f(datat)o(yp)q(e)h(represen)o
(tation.)249 831 y(The)i(di\013erence)i(is)e(lik)o(ely)f(to)g(b)q(e)i
(larger)f(in)f(realistic)h(co)q(des.)22 b(The)16 b(use)g(of)e(pac)o
(king)g(requires)249 885 y(additional)j(storage)j(for)f(a)f
FB(c)n(opy)i FA(of)e(the)i(data,)g(whereas)g(the)g(use)g(of)e(deriv)o
(ed)i(datat)o(yp)q(es)249 939 y(requires)15 b(additional)d(storage)j
(for)e(a)h FB(description)f FA(of)h(the)g(data)g(la)o(y)o(out.)291
993 y(Finally)m(,)9 b(compute)i(time.)16 b(The)c(pac)o(king)e(co)q(de)j
(executes)g(a)e(function)g(call)g(for)g(eac)o(h)h(pac)o(k)o(ed)249
1047 y(item)i(whereas)j(the)f(deriv)o(ed)g(datat)o(yp)q(e)f(co)q(de)h
(executes)i(only)c(a)i(\014xed)f(n)o(um)o(b)q(er)g(of)g(function)249
1101 y(calls.)i(The)c(pac)o(king)f(co)q(de)i(is)e(lik)o(ely)f(to)i
(require)g(one)g(additional)e(memory)f(to)i(memory)e(cop)o(y)249
1155 y(of)k(the)h(data,)f(as)h(compared)e(to)i(the)g(deriv)o(ed-datat)o
(yp)q(e)g(co)q(de.)21 b(One)15 b(ma)o(y)e(exp)q(ect,)i(on)g(most)249
1209 y(implemen)o(tations,)10 b(to)k(ac)o(hiev)o(e)g(b)q(etter)i(p)q
(erformance)d(with)h(the)g(deriv)o(ed)h(datat)o(yp)q(e)f(co)q(de.)291
1263 y(Both)j(co)q(des)i(send)f(the)g(same)e(size)j(message,)e(so)g
(that)h(there)g(is)g(no)f(di\013erence)i(in)e(com-)249
1317 y(m)o(unication)d(time.)22 b(Ho)o(w)o(ev)o(er,)16
b(if)f(the)h(bu\013er)h(describ)q(ed)h(b)o(y)d(the)i(deriv)o(ed)f
(datat)o(yp)q(e)g(is)g(not)249 1371 y(con)o(tiguous)e(in)f(memory)m(,)e
(it)i(ma)o(y)f(tak)o(e)i(longer)g(to)f(access.)291 1425
y(Example)i(3.28)g(ab)q(o)o(v)o(e)i(illustrates)g(another)g(adv)n(an)o
(tage)f(of)g(pac)o(k/unpac)o(k;)i(namely)d(the)249 1479
y(receiving)g(pro)q(cess)i(ma)o(y)c(use)j(information)c(in)j(part)g(of)
f(an)h(incoming)e(message)h(in)h(order)h(to)249 1533
y(decide)d(ho)o(w)f(to)g(handle)g(subsequen)o(t)i(data)e(in)f(the)i
(message.)k(In)12 b(order)h(to)f(ac)o(hiev)o(e)h(the)f(same)249
1587 y(outcome)e(without)h(pac)o(k/unpac)o(k,)g(one)h(w)o(ould)e(ha)o
(v)o(e)h(to)g(send)h(t)o(w)o(o)e(messages:)17 b(the)12
b(\014rst)g(with)249 1641 y(the)j(list)f(of)g(indices,)h(to)f(b)q(e)i
(used)f(to)f(construct)j(a)d(deriv)o(ed)h(datat)o(yp)q(e)g(that)f(is)h
(then)g(used)h(to)249 1694 y(receiv)o(e)f(the)g(particle)f(en)o(tries)h
(sen)o(t)f(in)g(a)f(second)i(message.)291 1748 y(The)20
b(use)h(of)f(deriv)o(ed)g(datat)o(yp)q(es)h(will)e(often)h(lead)g(to)g
(impro)o(v)o(ed)e(p)q(erformance:)31 b(data)249 1802
y(cop)o(ying)15 b(can)h(b)q(e)g(a)o(v)o(oided,)f(and)g(information)e
(on)j(data)f(la)o(y)o(out)f(can)i(b)q(e)g(reused,)i(when)e(the)249
1856 y(same)d(comm)o(unicati)o(on)e(bu\013er)j(is)f(reused.)20
b(On)14 b(the)g(other)g(hand,)f(the)h(de\014nition)f(of)g(deriv)o(ed)
249 1910 y(datat)o(yp)q(es)i(for)f(complex)f(la)o(y)o(outs)g(can)h(b)q
(e)h(more)e(tedious)i(than)f(explicit)g(pac)o(king.)k(Deriv)o(ed)249
1964 y(datat)o(yp)q(es)c(should)f(b)q(e)h(used)g(whenev)o(er)g(data)f
(la)o(y)o(out)f(is)h(de\014ned)i(b)o(y)e(program)e(declarations)249
2018 y(\(e.g.,)j(structures\),)k(or)c(is)h(regular)g(\(e.g.,)f(arra)o
(y)h(sections\).)22 b(P)o(ac)o(king)15 b(migh)o(t)d(b)q(e)k(considered)
249 2072 y(for)10 b(complex,)g(dynamic,)f(data-dep)q(enden)o(t)j(la)o
(y)o(outs.)k(P)o(ac)o(king)10 b(ma)o(y)f(result)i(in)f(more)g
(e\016cien)o(t)249 2126 y(co)q(de)j(in)e(situations)h(where)h(the)g
(sender)g(has)f(to)g(comm)o(unicate)e(to)h(the)i(receiv)o(er)g
(information)249 2180 y(that)h(a\013ects)h(the)g(la)o(y)o(out)d(of)i
(the)g(receiv)o(e)h(bu\013er.)p eop
%%Page: 146 160
146 159 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(146)1256 b(Chapter)13 b(3)p
eop
%%Page: 147 161
147 160 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 325 a Fu(4)25 b FD(Collectiv)o(e)18 b(Comm)o
(unications)249 628 y(4.1)52 b(In)o(tro)q(duction)19
b(and)f(Ov)o(erview)249 736 y FA(Collectiv)o(e)c(comm)o(unications)e
(transmit)i(data)g(among)f(all)g(pro)q(cesses)18 b(in)c(a)g(group)h(sp)
q(eci\014ed)249 790 y(b)o(y)g(an)g(in)o(tracomm)o(unicator)d(ob)r
(ject.)23 b(One)16 b(function,)f(the)h(barrier,)f(serv)o(es)i(to)e
(sync)o(hronize)249 844 y(pro)q(cesses)i(without)d(passing)h(data.)k
Fw(MPI)14 b FA(pro)o(vides)h(the)g(follo)o(wing)d(collectiv)o(e)j(comm)
o(uni)o(ca-)249 897 y(tion)e(functions.)249 981 y Ft(\017)29
b FA(Barrier)15 b(sync)o(hronization)e(across)i(all)e(group)h(mem)o(b)q
(ers)e(\(Section)j(4.4\).)249 1034 y Ft(\017)29 b FA(Global)14
b(comm)o(unication)f(functions,)j(whic)o(h)g(are)g(illustrated)g(in)f
(Figure)h(4.1.)24 b(They)16 b(in-)249 1088 y(clude.)267
1142 y Fs({)p FA(Broadcast)e(from)e(one)j(mem)o(b)q(er)d(to)i(all)e
(mem)o(b)q(ers)h(of)g(a)h(group)f(\(Section)i(4.5\).)267
1212 y Fs({)p FA(Gather)f(data)f(from)f(all)h(group)h(mem)o(b)q(ers)e
(to)i(one)g(mem)o(b)q(er)e(\(Section)j(4.6\).)267 1282
y Fs({)p FA(Scatter)g(data)e(from)f(one)i(mem)o(b)q(er)f(to)g(all)g
(mem)o(b)q(ers)g(of)g(a)h(group)f(\(Section)i(4.7\).)267
1352 y Fs({)p FA(A)h(v)n(ariation)f(on)h(Gather)g(where)i(all)d(mem)o
(b)q(ers)g(of)h(the)h(group)f(receiv)o(e)h(the)g(result)h(\(Sec-)291
1406 y(tion)13 b(4.8\).)k(This)d(is)g(sho)o(wn)g(as)f(\\allgather")g
(in)g(Figure)h(4.1.)267 1476 y Fs({)p FA(Scatter/Gather)19
b(data)e(from)g(all)f(mem)o(b)q(ers)h(to)h(all)f(mem)o(b)q(ers)f(of)i
(a)f(group)h(\(also)g(called)291 1530 y(complete)h(exc)o(hange)i(or)e
(all-to-all\))f(\(Section)i(4.9\).)35 b(This)20 b(is)g(sho)o(wn)g(as)g
(\\alltoall")d(in)291 1584 y(Figure)d(4.1.)249 1638 y
Ft(\017)29 b FA(Global)14 b(reduction)j(op)q(erations)f(suc)o(h)h(as)g
(sum,)e(max,)f(min,)h(or)h(user-de\014ned)i(functions.)249
1692 y(This)c(includes)267 1746 y Fs({)p FA(Reduction)k(where)i(the)g
(result)f(is)g(returned)i(to)d(all)g(group)g(mem)o(b)q(ers)g(and)h(a)f
(v)n(ariation)291 1800 y(where)d(the)f(result)h(is)f(returned)h(to)f
(only)f(one)h(mem)o(b)q(er)e(\(Section)j(4.10\).)267
1870 y Fs({)p FA(A)f(com)o(bined)e(reduction)j(and)f(scatter)h(op)q
(eration)f(\(Section)g(4.10.5\).)267 1939 y Fs({)p FA(Scan)g(across)h
(all)d(mem)o(b)q(ers)h(of)g(a)h(group)f(\(also)h(called)f(pre\014x\))i
(\(Section)g(4.11\).)291 2022 y(Figure)c(4.1)g(giv)o(es)g(a)g
(pictorial)g(represen)o(tation)i(of)e(the)h(global)e(comm)o(unicatio)o
(n)f(functions.)249 2076 y(All)k(these)j(functions)e(\(broadcast)h
(excepted\))h(come)d(in)h(t)o(w)o(o)f(v)n(arian)o(ts:)18
b(the)c(simple)f(v)n(arian)o(t,)249 2130 y(where)21 b(all)d(comm)o
(unicated)f(items)h(are)i(messages)g(of)e(the)i(same)f(size,)i(and)e
(the)h(\\v)o(ector")249 2184 y(v)n(arian)o(t,)g(where)h(eac)o(h)f(item)
f(can)h(b)q(e)g(of)f(a)h(di\013eren)o(t)h(size.)37 b(In)19
b(addition,)h(in)f(the)i(simple)249 2238 y(v)n(arian)o(t,)14
b(m)o(ultiple)f(items)i(originating)e(from)h(the)i(same)e(pro)q(cess)j
(or)e(receiv)o(ed)i(at)e(the)h(same)249 2292 y(pro)q(cess,)j(are)e(con)
o(tiguous)f(in)g(memory;)f(the)j(v)o(ector)f(v)n(arian)o(t)f(allo)o(ws)
f(to)i(pic)o(k)f(the)h(distinct)249 2346 y(items)c(from)f(non-con)o
(tiguous)h(lo)q(cations.)291 2400 y(Some)i(of)h(these)i(functions,)e
(suc)o(h)h(as)g(broadcast)g(or)f(gather,)h(ha)o(v)o(e)g(a)f(single)g
(origin)f(or)i(a)249 2454 y(single)d(receiving)h(pro)q(cess.)21
b(Suc)o(h)15 b(a)f(pro)q(cess)i(is)e(called)g(the)h Fs(ro)q(ot)p
FA(.)j(Global)13 b(comm)o(unicatio)o(n)249 2508 y(functions)h
(basically)f(comes)g(in)h(three)h(patterns:)965 2613
y(147)p eop
%%Page: 148 162
148 161 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(148)1256 b(Chapter)13 b(4)249
2566 y @beginspecial @setspecial
%%BeginDocument: ../figures/coll-fig1.ps
% Cookbook Example Program from First Printing, Revised 7 Jan 1985
% Program: Drawing Arrows     Number: 8
%-----------------------------------------------------------------------------
%
/arrowdict 13 dict def                      % Local storage for the procedure
					    % ``arrow.''
							
/arrow                                      % The procedure ``arrow'' adds an
  { arrowdict begin                         % arrow shape to the current path.
      /headlength exch def                  % It takes seven arguments: the x
      /halfheadthickness exch 2 div def     % and y coordinates of the tail
      /halfthickness exch 2 div def         % (imagine that a line has been
      /tipy exch def /tipx exch def         % drawn down the center of the
      /taily exch def /tailx exch def       % arrow from the tip to the tail,
					    % then x and y lie on this line),
					    % the x and y coordinates of the
					    % tip of the arrow, the thickness
					    % of the arrow in the tail
					    % portion, the thickness of the
					    % arrow at the widest part of the
					    % arrowhead and the length of the
					    % arrowhead.
							
      /dx tipx tailx sub def                % Compute the differences in x and
      /dy tipy taily sub def                % y for the tip and tail. These
      /arrowlength dx dx mul dy dy mul add  % will be used to compute the
	sqrt def                            % length of the arrow and to
      /angle dy dx atan def                 % compute the angle of direction
					    % that the arrow is facing with
					    % respect to the current user
					    % coordinate system origin.
      /base arrowlength headlength sub def  % Compute where the base of the
					    % arrowhead will be.
								
      /savematrix matrix currentmatrix def  % Save the current user coordinate
					    % system. We are using the same
					    % strategy to localize the effect
					    % of transformations as was used
					    % in the program to draw an
					    % ellipse.
      tailx taily translate                 % Translate to the starting point
					    % of the tail.
      angle rotate                          % Rotate the x-axis to correspond
					    % with the center line of the
					    % arrow.
      0 halfthickness neg moveto            % Add the arrow shape to the
					    % current path.
      base halfthickness neg lineto
      base halfheadthickness neg lineto
      arrowlength 0 lineto
      base halfheadthickness lineto
      base halfthickness lineto
      0 halfthickness lineto
      closepath
	       
      savematrix setmatrix                  % Restore the current user
					    % coordinate system.
    end
  } def
/Box
{ /height exch def
  /length exch def

   length 0 rlineto
   0 height rlineto
   length neg 0 rlineto
   closepath
} def

/Gdict 200 dict def
/Grid
{ 
  Gdict begin
  /ny exch def
  /nx exch def
  /dely exch def
  /delx exch def
  /leny { ny dely mul} def
  /lenx { nx delx mul} def
  currentpoint
  /ypos exch def
  /xpos exch def

  /y ypos def
  /x xpos def

  0 1 ny { pop x y moveto lenx 0 rlineto stroke /y y dely add def} for
  /y ypos def
  /x xpos def
  0 1 nx { pop x y moveto 0 leny rlineto stroke /x x delx add def} for
  end
} def

/GLdict 300 dict def
/GridLabels
{ 
  GLdict begin

  /shift exch def
  /raise exch def
  /yoff exch def
  /xoff exch def
  /p1 exch def
  /p2 exch def
  /ny exch def
  /nx exch def
  /dely exch def
  /delx exch def

  /Darray exch def
  /leny { ny dely mul} def
  /lenx { nx delx mul} def
  currentpoint
  /ypos exch def
  /xpos exch def

  /y ypos def
  /x xpos def

  /dx3 delx 3 div def
  /dy3 dely 3 div def

  /ix -1 def
  /iy ny 1 sub def
  Darray{
     aload pop 
    /Subc  exch def
    /Text exch def
    /ix ix 1 add def
    ix nx ge { /ix 0 def /iy iy 1 sub def} if
    /x xpos delx ix 0.5 add mul add 
    /Helvetica findfont p1 scalefont setfont Text stringwidth pop 
    /Helvetica findfont p2 scalefont setfont Subc stringwidth pop 
    add xoff add 2 div sub shift add def
    /y ypos dely iy 0.5 add mul add raise add def
    x y moveto 
    /Helvetica findfont p1 scalefont Text show
    xoff yoff rmoveto
    /Helvetica findfont p2 scalefont Subc show
  } forall
  end
  clear
} def

2 setlinecap
6.5 72 mul 320 sub 2 div 0 translate 
-30 30 translate
.8 .8 scale

0 300 moveto 
20 20 6 6 Grid 

0 300 moveto 
[
[(A)(0)]
[(A)(1)]
[(A)(2)]
[(A)(3)]
[(A)(4)]
[(A)(5)]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
 ] 20 20 6 6 9 12 1 -5 -2 2 GridLabels

140 380 200 380 12 24 18 arrow stroke
200 330 140 330 12 24 18 arrow stroke

/Helvetica findfont 12 scalefont setfont
(scatter) dup stringwidth pop 170 exch 2 div sub 400 moveto show
(gather) dup stringwidth pop 170 exch 2 div sub 350 moveto show

220 300 moveto 
20 20 6 6 Grid 

220 300 moveto 
[
[(A)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(A)(1)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(A)(2)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(A)(3)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(A)(4)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(A)(5)]
[()()]
[()()]
[()()]
[()()]
[()()]
 ] 20 20 6 6 9 12 1 -5 -2 2 GridLabels

0 0 moveto 
20 20 6 6 Grid 

0 0 moveto 
[
[(A)(0)]
[(A)(1)]
[(A)(2)]
[(A)(3)]
[(A)(4)]
[(A)(5)]
[(B)(0)]
[(B)(1)]
[(B)(2)]
[(B)(3)]
[(B)(4)]
[(B)(5)]
[(C)(0)]
[(C)(1)]
[(C)(2)]
[(C)(3)]
[(C)(4)]
[(C)(5)]
[(D)(0)]
[(D)(1)]
[(D)(2)]
[(D)(3)]
[(D)(4)]
[(D)(5)]
[(E)(0)]
[(E)(1)]
[(E)(2)]
[(E)(3)]
[(E)(4)]
[(E)(5)]
[(F)(0)]
[(F)(1)]
[(F)(2)]
[(F)(3)]
[(F)(4)]
[(F)(5)]
 ] 20 20 6 6 9 12 1 -5 -2 2 GridLabels

220 0 moveto 
20 20 6 6 Grid 

220 0 moveto 
[
[(A)(0)]
[(B)(0)]
[(C)(0)]
[(D)(0)]
[(E)(0)]
[(F)(0)]
[(A)(1)]
[(B)(1)]
[(C)(1)]
[(D)(1)]
[(E)(1)]
[(F)(1)]
[(A)(2)]
[(B)(2)]
[(C)(2)]
[(D)(2)]
[(E)(2)]
[(F)(2)]
[(A)(3)]
[(B)(3)]
[(C)(3)]
[(D)(3)]
[(E)(3)]
[(F)(3)]
[(A)(4)]
[(B)(4)]
[(C)(4)]
[(D)(4)]
[(E)(4)]
[(F)(4)]
[(A)(5)]
[(B)(5)]
[(C)(5)]
[(D)(5)]
[(E)(5)]
[(F)(5)]
 ] 20 20 6 6 9 12 1 -5 -2 2 GridLabels

140 60 200 60 12 24 18 arrow stroke

/Helvetica findfont 12 scalefont setfont
(alltoall) dup stringwidth pop 170 exch 2 div sub 77 moveto show

0 150 moveto 
20 20 6 6 Grid 

0 150 moveto 
[
[(A)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(B)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(C)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(D)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(E)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(F)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
 ] 20 20 6 6 9 12 1 -5 -2 2 GridLabels

140 200 200 200 12 24 18 arrow stroke

/Helvetica findfont 12 scalefont setfont
(allgather) dup stringwidth pop 170 exch 2 div sub 220 moveto show

220 150 moveto 
20 20 6 6 Grid 

220 150 moveto 
[
[(A)(0)]
[(B)(0)]
[(C)(0)]
[(D)(0)]
[(E)(0)]
[(F)(0)]
[(A)(0)]
[(B)(0)]
[(C)(0)]
[(D)(0)]
[(E)(0)]
[(F)(0)]
[(A)(0)]
[(B)(0)]
[(C)(0)]
[(D)(0)]
[(E)(0)]
[(F)(0)]
[(A)(0)]
[(B)(0)]
[(C)(0)]
[(D)(0)]
[(E)(0)]
[(F)(0)]
[(A)(0)]
[(B)(0)]
[(C)(0)]
[(D)(0)]
[(E)(0)]
[(F)(0)]
[(A)(0)]
[(B)(0)]
[(C)(0)]
[(D)(0)]
[(E)(0)]
[(F)(0)]
 ] 20 20 6 6 9 12 1 -5 -2 2 GridLabels

0 450 moveto 
20 20 6 6 Grid 

0 450 moveto 
[
[(A)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
[()()]
 ] 20 20 6 6 9 12 1 -5 -2 2 GridLabels

140 510 200 510 12 24 18 arrow stroke

/Helvetica findfont 12 scalefont setfont
0 575 moveto
(data) show
(data) stringwidth pop 4 add 575 4 add (data) stringwidth pop 33 add 575 4 add
1 4 5 arrow fill
(broadcast) dup stringwidth pop 170 exch 2 div sub 527 moveto show
gsave
0 570 (processes) stringwidth pop sub translate
90 rotate
0 5 moveto
(processes) show
-4 8 -33 8 1 4 5 arrow fill
grestore

220 450 moveto 
20 20 6 6 Grid 

220 450 moveto 
[
[(A)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(A)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(A)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(A)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(A)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
[(A)(0)]
[()()]
[()()]
[()()]
[()()]
[()()]
 ] 20 20 6 6 9 12 1 -5 -2 2 GridLabels

showpage


%%EndDocument
 @endspecial 62 x Fo(Figure)g(4.1)249 2665 y Fz(Collectiv)o(e)c(mo)o(v)
o(e)h(functions)f(illustrated)g(for)h(a)h(group)f(of)h(six)g(pro)q
(cesses.)i(In)d(eac)o(h)h(case,)f(eac)o(h)g(ro)o(w)h(of)g(b)q(o)o(xes)
249 2703 y(represen)o(ts)e(data)i(lo)q(cations)e(in)i(one)g(pro)q
(cess.)i(Th)o(us,)e(in)h(the)e(broadcast,)f(initially)g(just)i(the)g
(\014rst)g(pro)q(cess)249 2740 y(con)o(tains)e(the)i(item)g
Fe(A)555 2745 y Fd(0)572 2740 y Fz(,)h(but)f(after)f(the)h(broadcast)e
(all)i(pro)q(cesses)e(con)o(tain)h(it.)p eop
%%Page: 149 163
149 162 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(149)208 507 y Ft(\017)20 b FA(Ro)q(ot)13 b(sends)i(data)f(to)g(all)e
(pro)q(cesses)17 b(\(itself)d(included\):)k(broadcast)c(and)g(scatter.)
208 578 y Ft(\017)20 b FA(Ro)q(ot)13 b(receiv)o(es)j(data)d(from)g(all)
f(pro)q(cesses)17 b(\(itself)c(included\):)19 b(gather.)208
648 y Ft(\017)h FA(Eac)o(h)c(pro)q(cess)h(comm)o(unicates)d(with)h(eac)
o(h)h(pro)q(cess)i(\(itself)d(included\):)22 b(allgather)14
b(and)i(all-)249 702 y(toall.)291 785 y(The)j(syn)o(tax)f(and)h(seman)o
(tics)f(of)g(the)i Fw(MPI)e FA(collectiv)o(e)g(functions)h(w)o(as)g
(designed)g(to)g(b)q(e)249 839 y(consisten)o(t)f(with)f(p)q(oin)o
(t-to-p)q(oin)o(t)f(comm)o(unications.)25 b(Ho)o(w)o(ev)o(er,)18
b(to)f(k)o(eep)h(the)g(n)o(um)o(b)q(er)e(of)249 893 y(functions)11
b(and)h(their)f(argumen)o(t)f(lists)i(to)f(a)g(reasonable)h(lev)o(el)f
(of)f(complexit)o(y)m(,)f(the)j Fw(MPI)f FA(com-)249
947 y(mittee)h(made)f(collectiv)o(e)h(functions)g(more)f(restrictiv)o
(e)j(than)e(the)h(p)q(oin)o(t-to-p)q(oin)o(t)e(functions,)249
1001 y(in)k(sev)o(eral)h(w)o(a)o(ys.)21 b(One)16 b(restriction)h(is)e
(that,)g(in)g(con)o(trast)h(to)f(p)q(oin)o(t-to-p)q(oin)o(t)f(comm)o
(uni)o(ca-)249 1055 y(tion,)f(the)h(amoun)o(t)e(of)i(data)f(sen)o(t)i
(m)o(ust)e(exactly)g(matc)o(h)g(the)i(amoun)o(t)d(of)h(data)g(sp)q
(eci\014ed)j(b)o(y)249 1109 y(the)f(receiv)o(er.)291
1163 y(A)d(ma)r(jor)e(simpli\014cation)f(is)j(that)g(collectiv)o(e)f
(functions)h(come)f(in)h(blo)q(c)o(king)f(v)o(ersions)h(only)m(.)249
1217 y(Though)j(a)h(standing)f(jok)o(e)g(at)h(committee)e(meetings)h
(concerned)i(the)f(\\non-blo)q(c)o(king)f(bar-)249 1271
y(rier,")g(suc)o(h)g(functions)g(can)g(b)q(e)g(quite)g(useful)978
1256 y Fk(1)1011 1271 y FA(and)g(ma)o(y)d(b)q(e)k(included)e(in)h(a)f
(future)h(v)o(ersion)249 1325 y(of)e Fw(MPI)p FA(.)291
1379 y(Collectiv)o(e)j(functions)i(do)e(not)i(use)g(a)e
Fw(tag)h FA(argumen)o(t.)27 b(Th)o(us,)18 b(within)e(eac)o(h)i(in)o
(tragroup)249 1433 y(comm)o(unication)10 b(domain,)g(collectiv)o(e)j
(calls)f(are)i(matc)o(hed)e(strictly)h(according)g(to)g(the)h(order)249
1487 y(of)f(execution.)291 1541 y(A)d(\014nal)g(simpli\014cation)e(of)i
(collectiv)o(e)h(functions)g(concerns)h(mo)q(des.)17
b(Collectiv)o(e)j(functions)249 1595 y(come)9 b(in)g(only)f(one)i(mo)q
(de,)f(and)g(this)h(mo)q(de)e(ma)o(y)f(b)q(e)k(regarded)f(as)f
(analogous)g(to)g(the)h(standard)249 1649 y(mo)q(de)19
b(of)g(p)q(oin)o(t-to-p)q(oin)o(t.)34 b(Sp)q(eci\014cally)m(,)20
b(the)g(seman)o(tics)g(are)g(as)g(follo)o(ws.)34 b(A)19
b(collectiv)o(e)249 1703 y(function)14 b(\(on)h(a)f(giv)o(en)g(pro)q
(cess\))j(can)d(return)i(as)f(so)q(on)g(as)f(its)h(participation)e(in)h
(the)i(o)o(v)o(erall)249 1757 y(comm)o(unication)d(is)j(complete.)25
b(As)17 b(usual,)f(the)h(completion)e(indicates)i(that)f(the)h(caller)g
(is)249 1811 y(no)o(w)g(free)g(to)g(access)i(and)e(mo)q(dify)d(lo)q
(cations)i(in)h(the)g(comm)o(unication)d(bu\013er\(s\).)29
b(It)17 b(do)q(es)249 1865 y(not)f(indicate)g(that)h(other)g(pro)q
(cesses)i(ha)o(v)o(e)d(completed,)f(or)i(ev)o(en)g(started,)g(the)g(op)
q(eration.)249 1919 y(Th)o(us,)12 b(a)g(collectiv)o(e)g(comm)o
(unicatio)o(n)e(ma)o(y)m(,)f(or)j(ma)o(y)e(not,)i(ha)o(v)o(e)g(the)g
(e\013ect)i(of)d(sync)o(hronizing)249 1973 y(all)i(calling)f(pro)q
(cesses.)21 b(The)14 b(barrier,)g(of)f(course,)i(is)f(the)g(exception)h
(to)f(this)g(statemen)o(t.)291 2027 y(This)f(c)o(hoice)i(of)e(seman)o
(tics)g(w)o(as)h(made)f(so)h(as)g(to)g(allo)o(w)e(a)h(v)n(ariet)o(y)h
(of)f(implemen)o(tatio)o(ns.)291 2081 y(The)k(user)h(of)e
Fw(MPI)g FA(m)o(ust)g(k)o(eep)i(these)g(issues)g(in)f(mind.)25
b(F)m(or)17 b(example,)e(ev)o(en)j(though)f(a)249 2135
y(particular)e(implemen)o(tation)d(of)j Fw(MPI)g FA(ma)o(y)e(pro)o
(vide)i(a)h(broadcast)g(with)f(the)h(side-e\013ect)h(of)249
2188 y(sync)o(hronization)d(\(the)g(standard)g(allo)o(ws)e(this\),)i
(the)g(standard)g(do)q(es)g(not)g FB(r)n(e)n(quir)n(e)e
FA(this,)i(and)249 2242 y(hence,)19 b(an)o(y)e(program)f(that)i(relies)
g(on)f(the)h(sync)o(hronization)f(will)f(b)q(e)j(non-p)q(ortable.)28
b(On)249 2296 y(the)14 b(other)f(hand,)g(a)g(correct)i(and)e(p)q
(ortable)g(program)e(m)o(ust)h(allo)o(w)g(a)h(collectiv)o(e)g(function)
g(to)249 2350 y(b)q(e)i(sync)o(hronizing.)k(Though)14
b(one)g(should)g(not)h(rely)f(on)g(sync)o(hronization)g
(side-e\013ects,)i(one)249 2404 y(m)o(ust)d(program)f(so)i(as)g(to)g
(allo)o(w)e(for)i(it.)p 249 2451 598 2 v 295 2478 a Fd(1)313
2490 y Fz(Of)e(course)e(the)g(non-blo)q(c)o(king)e(barrier)i(w)o(ould)h
(blo)q(c)o(k)f(at)h(the)g(test-for-com)o(ple)o(tion)d(call.)p
eop
%%Page: 150 164
150 163 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(150)1256 b(Chapter)13 b(4)291
507 y FA(Though)d(these)h(issues)h(and)e(statemen)o(ts)h(ma)o(y)d(seem)
i(un)o(usually)g(obscure,)i(they)f(are)f(merely)249 561
y(a)k(consequence)i(of)d(the)i(desire)g(of)e Fw(MPI)g
FA(to:)208 644 y Ft(\017)20 b FA(allo)o(w)12 b(e\016cien)o(t)j(implem)o
(en)o(tations)c(on)j(a)g(v)n(ariet)o(y)f(of)g(arc)o(hitectures;)j(and,)
208 715 y Ft(\017)k FA(b)q(e)15 b(clear)f(ab)q(out)g(exactly)g(what)f
(is,)h(and)f(what)h(is)g(not,)f(guaran)o(teed)i(b)o(y)e(the)i
(standard.)249 835 y FD(4.2)52 b(Op)q(erational)20 b(Details)249
943 y FA(A)f(collectiv)o(e)h(op)q(eration)f(is)g(executed)i(b)o(y)e(ha)
o(ving)f(all)h(pro)q(cesses)i(in)e(the)h(group)f(call)g(the)249
997 y(comm)o(unication)14 b(routine,)j(with)g(matc)o(hing)e(argumen)o
(ts.)27 b(The)18 b(syn)o(tax)f(and)f(seman)o(tics)h(of)249
1051 y(the)12 b(collectiv)o(e)g(op)q(erations)g(are)g(de\014ned)h(to)f
(b)q(e)g(consisten)o(t)h(with)e(the)i(syn)o(tax)e(and)h(seman)o(tics)
249 1105 y(of)e(the)g(p)q(oin)o(t-to-p)q(oin)o(t)f(op)q(erations.)17
b(Th)o(us,)11 b(user-de\014ned)h(datat)o(yp)q(es)e(are)h(allo)o(w)o(ed)
e(and)g(m)o(ust)249 1159 y(matc)o(h)14 b(b)q(et)o(w)o(een)j(sending)f
(and)g(receiving)g(pro)q(cesses)i(as)d(sp)q(eci\014ed)j(in)d(Chapter)h
(3.)23 b(One)16 b(of)249 1213 y(the)e(k)o(ey)f(argumen)o(ts)g(is)g(an)g
(in)o(tracomm)o(uni)o(cator)e(that)i(de\014nes)i(the)f(group)f(of)f
(participating)249 1267 y(pro)q(cesses)j(and)c(pro)o(vides)h(a)g(comm)o
(unicati)o(on)d(domain)g(for)j(the)g(op)q(eration.)18
b(In)11 b(calls)h(where)h(a)249 1321 y(ro)q(ot)h(pro)q(cess)i(is)e
(de\014ned,)h(some)e(argumen)o(ts)h(are)g(sp)q(eci\014ed)i(as)e
(\\signi\014can)o(t)g(only)f(at)h(ro)q(ot,")249 1375
y(and)20 b(are)h(ignored)f(for)f(all)g(participan)o(ts)h(except)i(the)f
(ro)q(ot.)37 b(The)20 b(reader)i(is)e(referred)i(to)249
1429 y(Chapter)d(2)e(for)h(information)d(concerning)j(comm)o(unication)
d(bu\013ers)k(and)f(t)o(yp)q(e)g(matc)o(hing)249 1483
y(rules,)13 b(to)f(Chapter)h(3)f(for)g(user-de\014ned)i(datat)o(yp)q
(es,)f(and)f(to)g(Chapter)h(5)f(for)g(information)e(on)249
1537 y(ho)o(w)k(to)f(de\014ne)i(groups)f(and)g(create)h(comm)o
(unicators.)291 1591 y(The)g(t)o(yp)q(e-matc)o(hing)f(conditions)h(for)
f(the)i(collectiv)o(e)f(op)q(erations)h(are)f(more)f(strict)i(than)249
1645 y(the)10 b(corresp)q(onding)g(conditions)f(b)q(et)o(w)o(een)i
(sender)g(and)e(receiv)o(er)i(in)d(p)q(oin)o(t-to-p)q(oin)o(t.)16
b(Namely)m(,)249 1699 y(for)e(collectiv)o(e)g(op)q(erations,)h(the)g
(amoun)o(t)d(of)i(data)g(sen)o(t)h(m)o(ust)f(exactly)g(matc)o(h)f(the)i
(amoun)o(t)249 1753 y(of)h(data)h(sp)q(eci\014ed)h(b)o(y)e(the)i
(receiv)o(er.)28 b(Distinct)16 b(t)o(yp)q(e)i(maps)d(\(the)i(la)o(y)o
(out)f(in)g(memory)m(,)e(see)249 1807 y(Section)g(3.2\))f(b)q(et)o(w)o
(een)j(sender)f(and)f(receiv)o(er)h(are)g(still)e(allo)o(w)o(ed.)291
1861 y(Collectiv)o(e)18 b(comm)o(unicatio)o(n)e(calls)j(ma)o(y)e(use)i
(the)h(same)e(comm)o(unicators)e(as)j(p)q(oin)o(t-to-)249
1914 y(p)q(oin)o(t)13 b(comm)o(unicati)o(on;)d Fw(MPI)j
FA(guaran)o(tees)h(that)f(messages)g(generated)h(on)f(b)q(ehalf)g(of)f
(collec-)249 1968 y(tiv)o(e)k(comm)o(unication)d(calls)j(will)f(not)h
(b)q(e)h(confused)h(with)e(messages)g(generated)i(b)o(y)e(p)q(oin)o(t-)
249 2022 y(to-p)q(oin)o(t)i(comm)o(unication.)29 b(A)19
b(more)f(detailed)h(discussion)g(of)f(correct)j(use)e(of)f(collectiv)o
(e)249 2076 y(routines)d(is)e(found)h(in)f(Section)h(4.13.)249
2168 y FB(R)n(ationale.)71 b FA(The)20 b(equal-data)f(restriction)i
(\(on)e(t)o(yp)q(e)h(matc)o(hing\))e(w)o(as)i(made)e(so)i(as)g(to)249
2222 y(a)o(v)o(oid)c(the)i(complexit)o(y)e(of)h(pro)o(viding)f(a)h
(facilit)o(y)f(analogous)g(to)h(the)h(status)h(argumen)o(t)d(of)249
2276 y Fw(MPI)p 326 2276 13 2 v 14 w(RECV)c FA(for)g(disco)o(v)o(ering)
h(the)g(amoun)o(t)e(of)h(data)g(sen)o(t.)18 b(Some)12
b(of)g(the)h(collectiv)o(e)g(routines)249 2330 y(w)o(ould)h(require)i
(an)e(arra)o(y)h(of)f(status)h(v)n(alues.)21 b(This)14
b(restriction)i(also)e(simpli\014es)f(implemen-)249 2384
y(tation.)k(\()p FB(End)f(of)f(r)n(ationale.)p FA(\))249
2475 y FB(A)n(dvic)n(e)d(to)g(users.)34 b FA(As)11 b(describ)q(ed)h(in)
e(Section)h(4.1,)f(it)g(is)h(dangerous)g(to)f(rely)h(on)f(sync)o
(hroniza-)p eop
%%Page: 151 165
151 164 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(151)249 507 y FA(tion)15 b(side-e\013ects)j(of)c(the)i(collectiv)o(e)
g(op)q(erations)f(for)g(program)f(correctness.)26 b(These)16
b(issues)249 561 y(are)e(discussed)i(further)f(in)e(Section)h(4.13.)j
(\()p FB(End)f(of)f(advic)n(e)g(to)g(users.)p FA(\))249
653 y FB(A)n(dvic)n(e)i(to)g(implementors.)50 b FA(While)15
b(v)o(endors)i(ma)o(y)d(write)j(optimized)e(collectiv)o(e)h(routines)
249 707 y(matc)o(hed)d(to)h(their)g(arc)o(hitectures,)i(a)e(complete)f
(library)g(of)g(the)i(collectiv)o(e)f(comm)o(unicatio)o(n)249
760 y(routines)g(can)f(b)q(e)g(written)h(en)o(tirely)f(using)g(the)g
Fw(MPI)f FA(p)q(oin)o(t-to-p)q(oin)o(t)g(comm)o(unicatio)o(n)e(func-)
249 814 y(tions)18 b(and)f(a)h(few)f(auxiliary)f(functions.)30
b(If)17 b(implemen)o(ting)e(on)i(top)h(of)f(p)q(oin)o(t-to-p)q(oin)o
(t,)g(a)249 868 y(hidden,)c(sp)q(ecial)h(comm)o(unicator)d(m)o(ust)i(b)
q(e)h(created)h(for)e(the)h(collectiv)o(e)g(op)q(eration)f(so)h(as)g
(to)249 922 y(a)o(v)o(oid)g(in)o(terference)j(with)e(an)o(y)f(on-going)
g(p)q(oin)o(t-to-p)q(oin)o(t)g(comm)o(unicatio)o(n)f(at)h(the)i(time)e
(of)249 976 y(the)h(collectiv)o(e)e(call.)18 b(This)13
b(is)h(discussed)i(further)f(in)e(Section)h(4.13.)249
1047 y(Although)c(collectiv)o(e)f(comm)o(unications)e(are)k(describ)q
(ed)h(in)d(terms)h(of)f(messages)h(sen)o(t)h(directly)249
1101 y(from)k(sender\(s\))j(to)e(receiv)o(er\(s\),)j(implemen)o(tatio)o
(ns)14 b(ma)o(y)h(use)i(a)f(comm)o(unicatio)o(n)e(pattern)249
1155 y(where)i(data)f(is)g(forw)o(arded)g(through)g(in)o(termediate)f
(no)q(des.)22 b(Th)o(us,)15 b(one)g(could)g(use)h(a)f(loga-)249
1209 y(rithmic)d(depth)i(tree)g(to)f(implemen)o(t)e(broadcast,)i
(rather)h(then)g(sending)g(data)f(directly)g(from)249
1263 y(the)j(ro)q(ot)f(to)g(eac)o(h)h(other)g(pro)q(cess.)24
b(Messages)17 b(can)f(b)q(e)g(forw)o(arded)f(to)g(in)o(termediate)g(no)
q(des)249 1317 y(and)i(split)g(\(for)h(scatter\))h(or)e(concatenated)i
(\(for)e(gather\).)30 b(An)17 b(optimal)e(implemen)o(tatio)o(n)249
1371 y(of)g(collectiv)o(e)h(comm)o(unication)d(will)h(tak)o(e)i(adv)n
(an)o(tage)f(of)h(the)g(sp)q(eci\014cs)i(of)d(the)i(underlying)249
1425 y(comm)o(unication)10 b(net)o(w)o(ork)j(\(suc)o(h)h(as)g(supp)q
(ort)g(for)f(m)o(ulticast,)e(whic)o(h)i(can)g(b)q(e)h(used)g(for)f
Fw(MPI)249 1479 y FA(broadcast\),)18 b(and)f(will)f(use)i(di\013eren)o
(t)g(algorithms,)d(according)j(to)f(the)g(n)o(um)o(b)q(er)g(of)f
(partic-)249 1533 y(ipating)g(pro)q(cesses)j(and)e(the)g(amoun)o(ts)f
(of)g(data)h(comm)o(uni)o(cated.)25 b(See,)18 b(e.g.)e([4].)26
b(\()p FB(End)19 b(of)249 1587 y(advic)n(e)c(to)g(implementors.)p
FA(\))249 1707 y FD(4.3)52 b(Comm)o(unicator)17 b(Argumen)o(t)249
1815 y FA(The)e(k)o(ey)g(concept)h(of)f(the)g(collectiv)o(e)g
(functions)g(is)g(to)f(ha)o(v)o(e)h(a)f(\\group")44 b(of)14
b(participating)249 1869 y(pro)q(cesses.)34 b(The)19
b(routines)g(do)f(not)g(ha)o(v)o(e)g(a)g(group)g(iden)o(ti\014er)h(as)f
(an)g(explicit)g(argumen)o(t.)249 1923 y(Instead,)h(there)g(is)e(a)g
(comm)o(unicator)e(argumen)o(t.)28 b(F)m(or)17 b(the)h(purp)q(oses)h
(of)e(this)h(c)o(hapter,)h(a)249 1977 y(comm)o(unicator)10
b(can)i(b)q(e)i(though)o(t)e(of)g(as)g(a)h(group)f(iden)o(ti\014er)h
(link)o(ed)f(with)g(a)g(comm)o(unicatio)o(n)249 2031
y(domain.)k(An)d(in)o(tercomm)o(unicator,)d(that)j(is,)g(a)f(comm)o
(unicator)e(that)k(spans)f(t)o(w)o(o)g(groups,)g(is)249
2085 y FB(not)h FA(allo)o(w)o(ed)f(as)h(an)f(argumen)o(t)g(to)h(a)g
(collectiv)o(e)f(function.)p eop
%%Page: 152 166
152 165 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(152)1256 b(Chapter)13 b(4)249
507 y FD(4.4)52 b(Barrier)17 b(Sync)o(hronization)208
686 y Fw(MPI)p 285 686 13 2 v 14 w(BARRIER\()12 b(comm)g(\))332
761 y Fv(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)249
871 y Fr(int)21 b(MPI)p 405 871 14 2 v 15 w(Barrier\(MPI)p
662 871 V 14 w(Comm)g(comm\))249 955 y(MPI)p 318 955
V 15 w(BARRIER\(COMM,)e(IERROR\))336 1009 y(INTEGER)i(COMM,)f(IERROR)
291 1093 y Fw(MPI)p 368 1093 13 2 v 14 w(BARRIER)12 b
FA(blo)q(c)o(ks)i(the)h(caller)f(un)o(til)f(all)g(group)g(mem)o(b)q
(ers)g(ha)o(v)o(e)h(called)g(it.)k(The)c(call)249 1147
y(returns)i(at)d(an)o(y)h(pro)q(cess)h(only)e(after)i(all)d(group)i
(mem)o(b)q(ers)f(ha)o(v)o(e)g(en)o(tered)j(the)e(call.)249
1267 y FD(4.5)52 b(Broadcast)208 1446 y Fw(MPI)p 285
1446 V 14 w(BCAST\()13 b(bu\013er,)i(count,)g(datat)o(yp)q(e,)f(ro)q
(ot,)g(comm)e(\))332 1521 y Fv(INOUT)85 b Fw(bu\013er)434
b Fv(starting)15 b(address)f(of)e(bu\013er)332 1571 y(IN)172
b Fw(count)436 b Fv(n)o(um)o(b)q(er)14 b(of)f(en)o(tries)h(in)g
(bu\013er)332 1620 y(IN)172 b Fw(datat)o(yp)q(e)383 b
Fv(data)14 b(t)o(yp)q(e)f(of)g(bu\013er)332 1670 y(IN)172
b Fw(ro)q(ot)460 b Fv(rank)14 b(of)f(broadcast)h(ro)q(ot)332
1720 y(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)249
1830 y Fr(int)21 b(MPI)p 405 1830 14 2 v 15 w(Bcast\(void*)f(buffer,)g
(int)h(count,)g(MPI)p 1162 1830 V 15 w(Datatype)f(datatype,)540
1884 y(int)h(root,)g(MPI)p 827 1884 V 15 w(Comm)g(comm)g(\))249
1968 y(MPI)p 318 1968 V 15 w(BCAST\(BUFFER,)e(COUNT,)i(DATATYPE,)f
(ROOT,)g(COMM,)h(IERROR\))336 2022 y(<type>)g(BUFFER\(*\))336
2076 y(INTEGER)g(COUNT,)f(DATATYPE,)g(ROOT,)h(COMM,)g(IERROR)291
2160 y Fw(MPI)p 368 2160 13 2 v 14 w(BCAST)9 b FA(broadcasts)i(a)e
(message)h(from)e(the)j(pro)q(cess)g(with)f(rank)g Fw(ro)q(ot)f
FA(to)h(all)f(pro)q(cesses)249 2214 y(of)15 b(the)h(group.)22
b(The)16 b(argumen)o(t)e Fw(ro)q(ot)h FA(m)o(ust)g(ha)o(v)o(e)g(iden)o
(tical)f(v)n(alues)h(on)h(all)e(pro)q(cesses,)k(and)249
2268 y Fw(comm)12 b FA(m)o(ust)g(represen)o(t)j(the)f(same)f(in)o
(tragroup)g(comm)o(uni)o(cation)d(domain.)16 b(On)e(return,)g(the)249
2322 y(con)o(ten)o(ts)h(of)e Fw(ro)q(ot)p FA('s)h(comm)o(unicatio)o(n)d
(bu\013er)k(has)f(b)q(een)h(copied)f(to)g(all)f(pro)q(cesses.)291
2376 y(General,)f(deriv)o(ed)h(datat)o(yp)q(es)g(are)g(allo)o(w)o(ed)e
(for)i Fw(datat)o(yp)q(e)p FA(.)18 b(The)13 b(t)o(yp)q(e)h(signature)e
(of)g Fw(count)249 2430 y FA(and)19 b Fw(datat)o(yp)q(e)i
FA(on)f(an)o(y)f(pro)q(cess)i(m)o(ust)d(b)q(e)j(equal)e(to)g(the)h(t)o
(yp)q(e)g(signature)g(of)f Fw(count)i FA(and)249 2484
y Fw(datat)o(yp)q(e)16 b FA(at)f(the)h(ro)q(ot.)22 b(This)15
b(implies)e(that)i(the)h(amoun)o(t)d(of)h(data)h(sen)o(t)h(m)o(ust)e(b)
q(e)i(equal)f(to)p eop
%%Page: 153 167
153 166 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(153)249 507 y FA(the)13 b(amoun)o(t)d(receiv)o(ed,)j(pairwise)f(b)q
(et)o(w)o(een)h(eac)o(h)g(pro)q(cess)g(and)f(the)h(ro)q(ot.)k
Fw(MPI)p 1519 507 13 2 v 14 w(BCAST)12 b FA(and)249 561
y(all)18 b(other)h(data-mo)o(v)o(em)o(en)o(t)e(collectiv)o(e)h
(routines)i(mak)o(e)d(this)i(restriction.)33 b(Distinct)19
b(t)o(yp)q(e)249 615 y(maps)13 b(b)q(et)o(w)o(een)i(sender)g(and)f
(receiv)o(er)i(are)e(still)f(allo)o(w)o(ed.)249 698 y
Fs(4.5.1)48 b(Example)15 b(Using)f Fw(MPI)p 804 698 V
14 w(BCAST)249 781 y Fs(Example)h(4.1)21 b FA(Broadcast)15
b(100)e(in)o(ts)h(from)e(pro)q(cess)j Fr(0)f FA(to)g(ev)o(ery)g(pro)q
(cess)i(in)e(the)g(group.)336 835 y Fr(MPI_Comm)20 b(comm;)336
889 y(int)h(array[100];)336 943 y(int)g(root=0;)336 997
y(...)336 1051 y(MPI_Bcast\()f(array,)h(100,)f(MPI_INT,)h(root,)f
(comm\);)249 1201 y FB(R)n(ationale.)36 b Fw(MPI)11 b
FA(do)q(es)h(not)g(supp)q(ort)g(a)g FB(multic)n(ast)f
FA(function,)g(where)i(a)e(broadcast)h(executed)249 1254
y(b)o(y)18 b(a)g(ro)q(ot)g(can)g(b)q(e)h(matc)o(hed)f(b)o(y)g(regular)g
(receiv)o(es)i(at)e(the)g(remaining)e(pro)q(cesses.)34
b(Suc)o(h)249 1308 y(a)17 b(function)g(is)h(easy)f(to)h(implem)o(en)o
(t)d(if)i(the)h(ro)q(ot)f(directly)h(sends)h(data)e(to)g(eac)o(h)h
(receiving)249 1362 y(pro)q(cess.)k(But,)15 b(then,)g(there)h(is)e
(little)g(to)g(b)q(e)i(gained,)d(as)i(compared)f(to)g(executing)i(m)o
(ultiple)249 1416 y(send)22 b(op)q(erations.)38 b(An)21
b(implemen)o(tation)c(where)22 b(pro)q(cesses)i(are)d(used)g(as)g(in)o
(termediate)249 1470 y(no)q(des)14 b(in)f(a)g(broadcast)h(tree)h(is)e
(hard,)g(since)h(only)f(the)h(ro)q(ot)f(executes)j(a)d(call)g(that)g
(iden)o(ti\014es)249 1524 y(the)18 b(op)q(eration)f(as)h(a)f
(broadcast.)28 b(In)18 b(con)o(trast,)g(in)f(a)g(collectiv)o(e)g(call)g
(to)g Fw(MPI)p 1537 1524 V 14 w(BCAST)g FA(all)249 1578
y(pro)q(cesses)g(are)d(a)o(w)o(are)g(that)g(they)g(participate)g(in)f
(a)h(broadcast.)19 b(\()p FB(End)c(of)g(r)n(ationale.)p
FA(\))p eop
%%Page: 154 168
154 167 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(154)1256 b(Chapter)13 b(4)249
507 y FD(4.6)52 b(Gather)208 686 y Fw(MPI)p 285 686 13
2 v 14 w(GA)m(THER\()11 b(sendbuf,)j(sendcount,)h(sendt)o(yp)q(e,)f
(recvbuf,)g(recvcount,)g(recvt)o(yp)q(e,)g(ro)q(ot,)e(comm\))332
815 y Fv(IN)172 b Fw(sendbuf)401 b Fv(starting)15 b(address)f(of)e
(send)i(bu\013er)332 863 y(IN)172 b Fw(sendcount)360
b Fv(n)o(um)o(b)q(er)14 b(of)f(elemen)o(ts)h(in)g(send)f(bu\013er)332
911 y(IN)172 b Fw(sendt)o(yp)q(e)383 b Fv(data)14 b(t)o(yp)q(e)f(of)g
(send)h(bu\013er)g(elemen)o(ts)332 959 y(OUT)128 b Fw(recvbuf)408
b Fv(address)14 b(of)f(receiv)o(e)h(bu\013er)332 1007
y(IN)172 b Fw(recvcount)367 b Fv(n)o(um)o(b)q(er)21 b(of)e(elemen)o(ts)
i(for)f(an)o(y)g(single)i(re-)1079 1061 y(ceiv)o(e)332
1109 y(IN)172 b Fw(recvt)o(yp)q(e)390 b Fv(data)14 b(t)o(yp)q(e)f(of)g
(recv)g(bu\013er)h(elemen)o(ts)332 1157 y(IN)172 b Fw(ro)q(ot)460
b Fv(rank)14 b(of)f(receiving)i(pro)q(cess)332 1205 y(IN)172
b Fw(comm)425 b Fv(comm)o(unicator)249 1315 y Fr(int)21
b(MPI)p 405 1315 14 2 v 15 w(Gather\(void*)f(sendbuf,)g(int)h
(sendcount,)f(MPI)p 1293 1315 V 15 w(Datatype)g(sendtype,)540
1369 y(void*)g(recvbuf,)h(int)g(recvcount,)e(MPI)p 1262
1369 V 16 w(Datatype)h(recvtype,)540 1423 y(int)h(root,)g(MPI)p
827 1423 V 15 w(Comm)g(comm\))249 1507 y(MPI)p 318 1507
V 15 w(GATHER\(SENDBUF,)e(SENDCOUNT,)h(SENDTYPE,)f(RECVBUF,)i
(RECVCOUNT,)540 1561 y(RECVTYPE,)f(ROOT,)g(COMM,)h(IERROR\))336
1615 y(<type>)g(SENDBUF\(*\),)e(RECVBUF\(*\))336 1669
y(INTEGER)i(SENDCOUNT,)e(SENDTYPE,)h(RECVCOUNT,)g(RECVTYPE,)g(ROOT,)h
(COMM,)336 1723 y(IERROR)291 1807 y FA(Eac)o(h)f(pro)q(cess)h(\(ro)q
(ot)f(pro)q(cess)i(included\))e(sends)h(the)f(con)o(ten)o(ts)h(of)e
(its)h(send)h(bu\013er)g(to)249 1861 y(the)16 b(ro)q(ot)f(pro)q(cess.)
24 b(The)15 b(ro)q(ot)g(pro)q(cess)i(receiv)o(es)g(the)f(messages)f
(and)g(stores)h(them)f(in)f(rank)249 1914 y(order.)k(The)13
b(outcome)f(is)g FB(as)h(if)f FA(eac)o(h)h(of)f(the)h
Fr(n)f FA(pro)q(cesses)j(in)d(the)h(group)f(\(including)f(the)i(ro)q
(ot)249 1968 y(pro)q(cess\))19 b(had)e(executed)i(a)e(call)f(to)h
Fw(MPI)p 920 1968 13 2 v 15 w(Send\(sendbuf,)j(sendcount,)g(sendt)o(yp)
q(e,)g(ro)q(ot,)d(...\),)249 2022 y FA(and)11 b(the)h(ro)q(ot)g(had)f
(executed)i Fw(n)f FA(calls)f(to)g Fw(MPI)p 978 2022
V 15 w(Recv\(recvbuf+i)p Ft(\001)p Fw(recvc)q(ount)p
Ft(\001)p Fw(ex)q(tent\()q(rec)q(vt)o(yp)q(e)q(\),)249
2076 y(recvcount,)17 b(recvt)o(yp)q(e,)g(i)e(,...\),)f
FA(where)i Fw(extent\(recvt)o(yp)q(e)q(\))i FA(is)d(the)h(t)o(yp)q(e)f
(exten)o(t)h(obtained)f(from)249 2130 y(a)f(call)f(to)g
Fw(MPI)p 487 2130 V 15 w(T)m(yp)q(e)p 586 2130 V 16 w(extent\(\))p
FA(.)291 2184 y(An)k(alternativ)o(e)h(description)g(is)f(that)h(the)g
Fr(n)g FA(messages)f(sen)o(t)i(b)o(y)e(the)h(pro)q(cesses)j(in)c(the)
249 2238 y(group)c(are)h(concatenated)h(in)e(rank)g(order,)g(and)h(the)
g(resulting)f(message)g(is)g(receiv)o(ed)i(b)o(y)e(the)249
2292 y(ro)q(ot)h(as)g(if)f(b)o(y)h(a)f(call)g(to)h Fw(MPI)p
723 2292 V 14 w(RECV\(recvbuf,)g(recvcount)p Ft(\001)p
Fw(n,)i(recvt)o(yp)q(e,)g(...\))p FA(.)291 2346 y(The)e(receiv)o(e)h
(bu\013er)g(is)f(ignored)f(for)h(all)f(non-ro)q(ot)g(pro)q(cesses.)291
2400 y(General,)f(deriv)o(ed)h(datat)o(yp)q(es)g(are)g(allo)o(w)o(ed)f
(for)g(b)q(oth)h Fw(sendt)o(yp)q(e)i FA(and)d Fw(recvt)o(yp)q(e)p
FA(.)20 b(The)13 b(t)o(yp)q(e)249 2454 y(signature)d(of)g
Fw(sendcount)i FA(and)d Fw(sendt)o(yp)q(e)k FA(on)c(pro)q(cess)j
Fr(i)e FA(m)o(ust)e(b)q(e)j(equal)e(to)h(the)h(t)o(yp)q(e)f(signature)
249 2508 y(of)16 b Fw(recvcount)i FA(and)e Fw(recvt)o(yp)q(e)j
FA(at)d(the)g(ro)q(ot.)25 b(This)16 b(implies)f(that)h(the)h(amoun)o(t)
d(of)i(data)g(sen)o(t)p eop
%%Page: 155 169
155 168 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(155)249 507 y FA(m)o(ust)14 b(b)q(e)h(equal)g(to)f(the)i(amoun)o(t)d
(of)h(data)h(receiv)o(ed,)h(pairwise)e(b)q(et)o(w)o(een)j(eac)o(h)e
(pro)q(cess)i(and)249 561 y(the)e(ro)q(ot.)j(Distinct)13
b(t)o(yp)q(e)i(maps)d(b)q(et)o(w)o(een)k(sender)f(and)f(receiv)o(er)h
(are)g(still)e(allo)o(w)o(ed.)291 615 y(All)18 b(argumen)o(ts)h(to)h
(the)g(function)g(are)g(signi\014can)o(t)f(on)g(pro)q(cess)j
Fw(ro)q(ot)p FA(,)e(while)f(on)h(other)249 669 y(pro)q(cesses,)c(only)d
(argumen)o(ts)g Fw(sendbuf,)i(sendcount,)h(sendt)o(yp)q(e,)g(ro)q(ot)p
FA(,)d(and)g Fw(comm)f FA(are)j(signif-)249 723 y(ican)o(t.)28
b(The)18 b(argumen)o(t)e Fw(ro)q(ot)i FA(m)o(ust)e(ha)o(v)o(e)h(iden)o
(tical)g(v)n(alues)g(on)g(all)f(pro)q(cesses)k(and)d
Fw(comm)249 777 y FA(m)o(ust)c(represen)o(t)j(the)f(same)e(in)o
(tragroup)g(comm)o(unicatio)o(n)e(domain.)291 831 y(The)j(sp)q
(eci\014cation)h(of)f(coun)o(ts)h(and)f(t)o(yp)q(es)h(should)g(not)f
(cause)h(an)o(y)f(lo)q(cation)f(on)h(the)h(ro)q(ot)249
885 y(to)f(b)q(e)g(written)h(more)e(than)g(once.)19 b(Suc)o(h)14
b(a)g(call)f(is)h(erroneous.)291 939 y(Note)i(that)h(the)g
Fw(recvcount)h FA(argumen)o(t)d(at)h(the)h(ro)q(ot)g(indicates)f(the)h
(n)o(um)o(b)q(er)f(of)f(items)h(it)249 993 y(receiv)o(es)g(from)c
FB(e)n(ach)i FA(pro)q(cess,)h(not)f(the)h(total)e(n)o(um)o(b)q(er)g(of)
g(items)g(it)h(receiv)o(es.)249 1076 y Fs(4.6.1)48 b(Examples)15
b(Using)f Fw(MPI)p 823 1076 13 2 v 14 w(GA)m(THER)249
1159 y Fs(Example)h(4.2)21 b FA(Gather)12 b(100)f(in)o(ts)g(from)f(ev)o
(ery)j(pro)q(cess)g(in)e(group)h(to)f(ro)q(ot.)18 b(See)12
b(Figure)g(4.2.)336 1213 y Fr(MPI_Comm)20 b(comm;)336
1267 y(int)h(gsize,sendarray[100)o(];)336 1321 y(int)g(root,)g(*rbuf;)
336 1375 y(...)336 1429 y(MPI_Comm_size\()e(comm,)i(&gsize\);)336
1483 y(rbuf)g(=)h(\(int)f(*\)malloc\(gsize*1)o(00*si)o(zeof\()o
(int\)\))o(;)336 1537 y(MPI_Gather\()f(sendarray,)f(100,)i(MPI_INT,)g
(rbuf,)f(100,)h(MPI_INT,)f(root,)h(comm\);)249 1686 y
Fs(Example)15 b(4.3)21 b FA(Previous)12 b(example)e(mo)q(di\014ed)g({)h
(only)g(the)h(ro)q(ot)f(allo)q(cates)h(memory)d(for)i(the)249
1740 y(receiv)o(e)k(bu\013er.)336 1794 y Fr(MPI_Comm)20
b(comm;)336 1848 y(int)h(gsize,sendarray[100)o(];)336
1902 y(int)g(root,)g(myrank,)g(*rbuf;)336 1956 y(...)336
2010 y(MPI_Comm_rank\()e(comm,)i(myrank\);)336 2064 y(if)h(\()f(myrank)
g(==)g(root\))g({)402 2118 y(MPI_Comm_size\()e(comm,)h(&gsize\);)402
2172 y(rbuf)h(=)g(\(int)g(*\)malloc\(gsize*100)o(*size)o(of\(in)o
(t\)\);)402 2226 y(})336 2280 y(MPI_Gather\()f(sendarray,)f(100,)i
(MPI_INT,)g(rbuf,)f(100,)h(MPI_INT,)f(root,)h(comm\);)p
eop
%%Page: 156 170
156 169 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(156)1256 b(Chapter)13 b(4)478
466 y
 16577003 6465030 0 0 33943388 13419479 startTexFig
 478 466 a
%%BeginDocument: ../figures/mycoll-fig2.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-54.0 369.0 translate 0.900 -0.900 scale
/Times-Italic findfont 16.00 scalefont setfont
74 194 m 
gs 1 -1 scale (100) col-1 show gr
0.500 setlinewidth
% Polyline
n 219 239 m 219 199 l  159 199 l  159 239 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
174 194 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 319 239 m 319 199 l  259 199 l  259 239 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
274 194 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 159 359 m 159 319 l  99 319 l  99 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
114 314 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 219 359 m 219 319 l  159 319 l  159 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
174 314 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 119 239 m 119 199 l  59 199 l  59 239 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 279 359 m 279 319 l  219 319 l  219 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 18.00 scalefont setfont
519 229 m 
gs 1 -1 scale (all processes) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
234 314 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 479 359 m 479 319 l  99 319 l  99 359 l  clp gs col-1 s gr
% Polyline
n 89 244 m 119 294 l gs 0.50 setgray fill gr
gs col-1 s gr
n 116.599 286.111 m 119.000 294.000 l 113.169 288.169 l gs 2 setlinejoin col-1 s gr
% Polyline
n 189 244 m 189 294 l gs 0.50 setgray fill gr
gs col-1 s gr
n 191.000 286.000 m 189.000 294.000 l 187.000 286.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 289 244 m 259 294 l gs 0.50 setgray fill gr
gs col-1 s gr
n 264.831 288.169 m 259.000 294.000 l 261.401 286.111 l gs 2 setlinejoin col-1 s gr
% Polyline
n 99 394 m 99 359 l gs 0.50 setgray fill gr
gs col-1 s gr
n 97.000 367.000 m 99.000 359.000 l 101.000 367.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
99 409 m 
gs 1 -1 scale (rbuf) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
524 344 m 
gs 1 -1 scale (at root) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 938 a Fo(Figure)g(4.2)249 975 y Fz(The)f(ro)q(ot)e(pro)q(cess)g
(gathers)g(100)g Fl(int)p Fz(s)h(from)f(eac)o(h)h(pro)q(cess)f(in)h
(the)g(group.)249 1098 y Fs(Example)k(4.4)21 b FA(Do)14
b(the)i(same)e(as)h(the)h(previous)f(example,)e(but)j(use)f(a)g(deriv)o
(ed)h(datat)o(yp)q(e.)249 1152 y(Note)c(that)g(the)g(t)o(yp)q(e)g
(cannot)g(b)q(e)g(the)h(en)o(tire)f(set)g(of)f Fr(gsize*100)20
b(int)p FA(s)12 b(since)g(t)o(yp)q(e)g(matc)o(hing)249
1206 y(is)i(de\014ned)h(pairwise)f(b)q(et)o(w)o(een)h(the)f(ro)q(ot)g
(and)g(eac)o(h)g(pro)q(cess)i(in)d(the)i(gather.)336
1259 y Fr(MPI_Comm)20 b(comm;)336 1313 y(int)h(gsize,sendarray[100)o
(];)336 1367 y(int)g(root,)g(*rbuf;)336 1421 y(MPI_Datatype)f(rtype;)
336 1475 y(...)336 1529 y(MPI_Comm_size\()f(comm,)i(&gsize\);)336
1583 y(MPI_Type_contiguous)o(\()e(100,)i(MPI_INT,)f(&rtype)h(\);)336
1637 y(MPI_Type_commit\()e(&rtype)h(\);)336 1691 y(rbuf)h(=)h(\(int)f
(*\)malloc\(gsize*1)o(00*si)o(zeof\()o(int\)\))o(;)336
1745 y(MPI_Gather\()f(sendarray,)f(100,)i(MPI_INT,)g(rbuf,)f(1,)i
(rtype,)e(root,)h(comm\);)p eop
%%Page: 157 171
157 170 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(157)249 507 y Fs(4.6.2)48 b(Gather,)14 b(V)l(ector)i(V)l(arian)o(t)
208 661 y Fw(MPI)p 285 661 13 2 v 14 w(GA)m(THERV\()j(sendbuf,)24
b(sendcount,)g(sendt)o(yp)q(e,)h(recvbuf,)e(recvcounts,)h(displs,)f
(recvt)o(yp)q(e,)249 715 y(ro)q(ot,)13 b(comm\))332 790
y Fv(IN)172 b Fw(sendbuf)401 b Fv(starting)15 b(address)f(of)e(send)i
(bu\013er)332 840 y(IN)172 b Fw(sendcount)360 b Fv(n)o(um)o(b)q(er)14
b(of)f(elemen)o(ts)h(in)g(send)f(bu\013er)332 889 y(IN)172
b Fw(sendt)o(yp)q(e)383 b Fv(data)14 b(t)o(yp)q(e)f(of)g(send)h
(bu\013er)g(elemen)o(ts)332 939 y(OUT)128 b Fw(recvbuf)408
b Fv(address)14 b(of)f(receiv)o(e)h(bu\013er)332 989
y(IN)172 b Fw(recvcounts)351 b Fv(in)o(teger)14 b(arra)o(y)332
1039 y(IN)172 b Fw(displs)438 b Fv(in)o(teger)14 b(arra)o(y)g(of)e
(displacemen)o(ts)332 1089 y(IN)172 b Fw(recvt)o(yp)q(e)390
b Fv(data)14 b(t)o(yp)q(e)f(of)g(recv)g(bu\013er)h(elemen)o(ts)332
1139 y(IN)172 b Fw(ro)q(ot)460 b Fv(rank)14 b(of)f(receiving)i(pro)q
(cess)332 1188 y(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)249
1299 y Fr(int)21 b(MPI)p 405 1299 14 2 v 15 w(Gatherv\(void*)e
(sendbuf,)i(int)g(sendcount,)e(MPI)p 1314 1299 V 16 w(Datatype)h
(sendtype,)540 1352 y(void*)g(recvbuf,)h(int)g(*recvcounts,)e(int)i
(*displs,)540 1406 y(MPI)p 609 1406 V 15 w(Datatype)f(recvtype,)g(int)h
(root,)g(MPI)p 1322 1406 V 15 w(Comm)g(comm\))249 1490
y(MPI)p 318 1490 V 15 w(GATHERV\(SENDBUF,)e(SENDCOUNT,)g(SENDTYPE,)h
(RECVBUF,)g(RECVCOUNTS,)540 1544 y(DISPLS,)g(RECVTYPE,)g(ROOT,)h(COMM,)
f(IERROR\))336 1598 y(<type>)h(SENDBUF\(*\),)e(RECVBUF\(*\))336
1652 y(INTEGER)i(SENDCOUNT,)e(SENDTYPE,)h(RECVCOUNTS\(*\),)f
(DISPLS\(*\),)h(RECVTYPE,)336 1706 y(ROOT,)h(COMM,)g(IERROR)291
1790 y Fw(MPI)p 368 1790 13 2 v 14 w(GA)m(THERV)12 b
FA(extends)j(the)f(functionalit)o(y)d(of)i Fw(MPI)p 1170
1790 V 14 w(GA)m(THER)g FA(b)o(y)g(allo)o(wing)e(a)i(v)n(arying)249
1844 y(coun)o(t)k(of)f(data)h(from)e(eac)o(h)i(pro)q(cess,)i(since)e
Fw(recvcounts)i FA(is)e(no)o(w)f(an)h(arra)o(y)m(.)26
b(It)17 b(also)f(allo)o(ws)249 1898 y(more)f(\015exibilit)o(y)g(as)h
(to)g(where)h(the)g(data)f(is)f(placed)i(on)f(the)g(ro)q(ot,)h(b)o(y)e
(pro)o(viding)g(the)i(new)249 1952 y(argumen)o(t,)12
b Fw(displs)p FA(.)291 2006 y(The)g(outcome)g(is)g FB(as)i(if)d
FA(eac)o(h)i(pro)q(cess,)h(including)e(the)h(ro)q(ot)f(pro)q(cess,)i
(sends)f(a)g(message)f(to)249 2060 y(the)j(ro)q(ot,)f
Fw(MPI)p 499 2060 V 14 w(Send\(sendbu)q(f,)i(sendcount,)g(sendt)o(yp)q
(e,)g(ro)q(ot,)e(...\))k FA(and)c(the)g(ro)q(ot)h(executes)h
Fw(n)249 2114 y FA(receiv)o(es,)f Fw(MPI)p 490 2114 V
14 w(Recv\(recvbu)q(f+displs[i])p Ft(\001)p Fw(exte)q(nt\(re)q(cvt)o
(yp)r(e\))q(,)h(recvcounts[i],)f(recvt)o(yp)q(e,)h(i,)d(...\).)291
2168 y FA(The)j(data)g(sen)o(t)h(from)e(pro)q(cess)j
Fr(j)e FA(is)g(placed)h(in)e(the)i Fr(j)p FA(th)f(p)q(ortion)g(of)g
(the)h(receiv)o(e)g(bu\013er)249 2222 y Fw(recvbuf)c
FA(on)e(pro)q(cess)i Fw(ro)q(ot)p FA(.)k(The)12 b Fr(j)p
FA(th)g(p)q(ortion)f(of)f Fw(recvbuf)j FA(b)q(egins)f(at)f(o\013set)i
Fw(displs[j])f FA(elemen)o(ts)249 2276 y(\(in)i(terms)f(of)h
Fw(recvt)o(yp)q(e)p FA(\))i(in)o(to)d Fw(recvbuf)p FA(.)291
2330 y(The)h(receiv)o(e)h(bu\013er)g(is)f(ignored)f(for)h(all)f(non-ro)
q(ot)g(pro)q(cesses.)291 2384 y(The)e(t)o(yp)q(e)g(signature)h(implied)
c(b)o(y)j Fw(sendcount)i FA(and)e Fw(sendt)o(yp)q(e)i
FA(on)e(pro)q(cess)i Fr(i)d FA(m)o(ust)g(b)q(e)i(equal)249
2438 y(to)g(the)g(t)o(yp)q(e)g(signature)h(implied)c(b)o(y)j
Fw(recvcounts[i])i FA(and)d Fw(recvt)o(yp)q(e)j FA(at)e(the)g(ro)q(ot.)
18 b(This)11 b(implies)249 2492 y(that)g(the)g(amoun)o(t)e(of)g(data)i
(sen)o(t)g(m)o(ust)f(b)q(e)h(equal)f(to)g(the)i(amoun)o(t)c(of)i(data)g
(receiv)o(ed,)j(pairwise)p eop
%%Page: 158 172
158 171 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(158)1256 b(Chapter)13 b(4)249
507 y FA(b)q(et)o(w)o(een)g(eac)o(h)e(pro)q(cess)i(and)e(the)h(ro)q
(ot.)17 b(Distinct)11 b(t)o(yp)q(e)h(maps)e(b)q(et)o(w)o(een)i(sender)h
(and)e(receiv)o(er)249 561 y(are)j(still)f(allo)o(w)o(ed,)f(as)i
(illustrated)g(in)g(Example)e(4.6.)291 615 y(All)18 b(argumen)o(ts)h
(to)h(the)g(function)g(are)g(signi\014can)o(t)f(on)g(pro)q(cess)j
Fw(ro)q(ot)p FA(,)e(while)f(on)h(other)249 669 y(pro)q(cesses,)c(only)d
(argumen)o(ts)g Fw(sendbuf,)i(sendcount,)h(sendt)o(yp)q(e,)g(ro)q(ot)p
FA(,)d(and)g Fw(comm)f FA(are)j(signif-)249 723 y(ican)o(t.)26
b(The)17 b(argumen)o(t)e Fw(ro)q(ot)h FA(m)o(ust)g(ha)o(v)o(e)g(iden)o
(tical)g(v)n(alues)g(on)g(all)g(pro)q(cesses,)j(and)d
Fw(comm)249 777 y FA(m)o(ust)d(represen)o(t)j(the)f(same)e(in)o
(tragroup)g(comm)o(unicatio)o(n)e(domain.)291 831 y(The)i(sp)q
(eci\014cation)h(of)f(coun)o(ts,)h(t)o(yp)q(es,)f(and)h(displacemen)o
(ts)f(should)g(not)g(cause)h(an)o(y)f(lo)q(ca-)249 885
y(tion)j(on)f(the)i(ro)q(ot)f(to)g(b)q(e)h(written)f(more)g(than)g
(once.)25 b(Suc)o(h)16 b(a)g(call)f(is)h(erroneous.)26
b(On)17 b(the)249 939 y(other)11 b(hand,)g(the)f(successiv)o(e)j
(displacemen)o(ts)d(in)g(the)h(arra)o(y)f Fw(displs)h
FA(need)g(not)f(b)q(e)h(a)f(monotonic)249 993 y(sequence.)249
1076 y Fs(4.6.3)48 b(Examples)15 b(Using)f Fw(MPI)p 823
1076 13 2 v 14 w(GA)m(THERV)249 1159 y Fs(Example)h(4.5)21
b FA(Ha)o(v)o(e)13 b(eac)o(h)g(pro)q(cess)i(send)f(100)f(in)o(ts)g(to)g
(ro)q(ot,)f(but)i(place)f(eac)o(h)g(set)h(\(of)f(100\))249
1213 y FB(stride)h FA(in)o(ts)h(apart)g(at)g(receiving)g(end.)21
b(Use)16 b Fw(MPI)p 1040 1213 V 15 w(GA)m(THERV)d FA(and)i(the)g
Fw(displs)h FA(argumen)o(t)e(to)249 1267 y(ac)o(hiev)o(e)g(this)g
(e\013ect.)20 b(Assume)14 b Fp(str)q(ide)e Ft(\025)g
FA(100.)17 b(See)e(Figure)f(4.3.)336 1321 y Fr(MPI_Comm)20
b(comm;)336 1375 y(int)h(gsize,sendarray[100)o(];)336
1429 y(int)g(root,)g(*rbuf,)g(stride;)336 1483 y(int)g
(*displs,i,*rcounts;)336 1591 y(...)336 1699 y(MPI_Comm_size\()e(comm,)
i(&gsize\);)336 1753 y(rbuf)g(=)h(\(int)f(*\)malloc\(gsize*s)o(tride)o
(*size)o(of\(in)o(t\)\);)336 1807 y(displs)g(=)g(\(int)g
(*\)malloc\(gsize*size)o(of\(in)o(t\)\);)336 1861 y(rcounts)g(=)g
(\(int)g(*\)malloc\(gsize*siz)o(eof\(i)o(nt\)\);)336
1914 y(for)g(\(i=0;)g(i<gsize;)f(++i\))h({)423 1968 y(displs[i])f(=)i
(i*stride;)423 2022 y(rcounts[i])e(=)i(100;)336 2076
y(})336 2130 y(MPI_Gatherv\()e(sendarray,)f(100,)i(MPI_INT,)f(rbuf,)h
(rcounts,)f(displs,)h(MPI_INT,)1622 2184 y(root,)g(comm\);)291
2292 y FA(Note)14 b(that)g(the)g(program)f(is)g(erroneous)j(if)d
Ft(\000)p FA(100)e Fp(<)h(str)q(ide)g(<)f FA(100.)p eop
%%Page: 159 173
159 172 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(159)478 466 y
 16577003 6465030 0 0 33943388 13419479 startTexFig
 478 466 a
%%BeginDocument: ../figures/mycoll-fig3.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-54.0 369.0 translate 0.900 -0.900 scale
/Times-Italic findfont 16.00 scalefont setfont
74 194 m 
gs 1 -1 scale (100) col-1 show gr
0.500 setlinewidth
% Polyline
n 219 239 m 219 199 l  159 199 l  159 239 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
174 194 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 319 239 m 319 199 l  259 199 l  259 239 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
274 194 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 159 359 m 159 319 l  99 319 l  99 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
114 314 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 239 359 m 239 319 l  179 319 l  179 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
194 314 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 319 359 m 319 319 l  259 319 l  259 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 119 239 m 119 199 l  59 199 l  59 239 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
274 314 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
199 394 m 
gs 1 -1 scale (stride) col-1 show gr
% Polyline
n 479 359 m 479 319 l  99 319 l  99 359 l  clp gs col-1 s gr
% Polyline
n 89 244 m 119 294 l gs 0.50 setgray fill gr
gs col-1 s gr
n 116.599 286.111 m 119.000 294.000 l 113.169 288.169 l gs 2 setlinejoin col-1 s gr
% Polyline
n 99 394 m 99 359 l gs 0.50 setgray fill gr
gs col-1 s gr
n 97.000 367.000 m 99.000 359.000 l 101.000 367.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 189 244 m 204 294 l gs col-1 s gr
n 203.617 285.763 m 204.000 294.000 l 199.786 286.912 l gs 2 setlinejoin col-1 s gr
% Polyline
n 289 244 m 289 294 l gs col-1 s gr
n 291.000 286.000 m 289.000 294.000 l 287.000 286.000 l gs 2 setlinejoin col-1 s gr
n 187.000 371.000 m 179.000 369.000 l 187.000 367.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 179 369 m 259 369 l gs col-1 s gr
n 251.000 367.000 m 259.000 369.000 l 251.000 371.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
99 409 m 
gs 1 -1 scale (rbuf) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
524 344 m 
gs 1 -1 scale (at root) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
519 229 m 
gs 1 -1 scale (all processes) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 938 a Fo(Figure)13 b(4.3)249 975 y Fz(The)f(ro)q(ot)e(pro)q(cess)g
(gathers)g(100)g Fl(int)p Fz(s)h(from)f(eac)o(h)h(pro)q(cess)f(in)h
(the)g(group,)e(eac)o(h)i(set)g(is)g(placed)f Fl(stride)g
Fz(in)o(ts)249 1012 y(apart.)249 1135 y Fs(Example)15
b(4.6)21 b FA(Same)15 b(as)i(Example)e(4.5)g(on)i(the)g(receiving)g
(side,)g(but)f(send)i(the)f(100)f(in)o(ts)249 1189 y(from)c(the)j(0th)e
(column)g(of)g(a)h(100)p Ft(\002)p FA(150)e(in)o(t)i(arra)o(y)m(,)e(in)
i(C.)f(See)i(Figure)f(4.4.)336 1243 y Fr(MPI_Comm)20
b(comm;)336 1297 y(int)h(gsize,sendarray[100)o(][150)o(];)336
1351 y(int)g(root,)g(*rbuf,)g(stride;)336 1405 y(MPI_Datatype)f(stype;)
336 1459 y(int)h(*displs,i,*rcounts;)336 1567 y(...)336
1675 y(MPI_Comm_size\()e(comm,)i(&gsize\);)336 1729 y(rbuf)g(=)h(\(int)
f(*\)malloc\(gsize*s)o(tride)o(*size)o(of\(in)o(t\)\);)336
1783 y(displs)g(=)g(\(int)g(*\)malloc\(gsize*size)o(of\(in)o(t\)\);)336
1836 y(rcounts)g(=)g(\(int)g(*\)malloc\(gsize*siz)o(eof\(i)o(nt\)\);)
336 1890 y(for)g(\(i=0;)g(i<gsize;)f(++i\))h({)423 1944
y(displs[i])f(=)i(i*stride;)423 1998 y(rcounts[i])e(=)i(100;)336
2052 y(})336 2106 y(/*)g(Create)e(datatype)g(for)h(1)h(column)f(of)g
(array)358 2160 y(*/)336 2214 y(MPI_Type_vector\()e(100,)i(1,)g(150,)g
(MPI_INT,)f(&stype\);)336 2268 y(MPI_Type_commit\()f(&stype)h(\);)336
2322 y(MPI_Gatherv\()g(sendarray,)f(1,)j(stype,)e(rbuf,)h(rcounts,)f
(displs,)g(MPI_INT,)1578 2376 y(root,)h(comm\);)p eop
%%Page: 160 174
160 173 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(160)1256 b(Chapter)13 b(4)403
466 y
 18945146 7388601 0 0 42560798 16971694 startTexFig
 403 466 a
%%BeginDocument: ../figures/mycoll-fig4.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-22.0 369.0 translate 0.900 -0.900 scale
/Times-Italic findfont 16.00 scalefont setfont
114 314 m 
gs 1 -1 scale (100) col-1 show gr
0.500 setlinewidth
% Polyline
n 239 359 m 239 319 l  179 319 l  179 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
194 314 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 319 359 m 319 319 l  259 319 l  259 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
274 314 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 69 209 m 69 199 l  59 199 l  59 209 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 219 m 69 209 l  59 209 l  59 219 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 264 209 m 264 199 l  254 199 l  254 209 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 264 219 m 264 209 l  254 209 l  254 219 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 464 209 m 464 199 l  454 199 l  454 209 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 464 219 m 464 209 l  454 209 l  454 219 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 479 359 m 479 319 l  99 319 l  99 359 l  clp gs col-1 s gr
% Polyline
n 99 394 m 99 359 l gs 0.50 setgray fill gr
gs col-1 s gr
n 97.000 367.000 m 99.000 359.000 l 101.000 367.000 l gs 2 setlinejoin col-1 s gr
n 187.000 371.000 m 179.000 369.000 l 187.000 367.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 179 369 m 259 369 l gs col-1 s gr
n 251.000 367.000 m 259.000 369.000 l 251.000 371.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 224 m 124 299 l gs 0.50 setgray fill gr
gs col-1 s gr
n 125.463 290.885 m 124.000 299.000 l 121.472 291.151 l gs 2 setlinejoin col-1 s gr
% Polyline
n 319 224 m 219 299 l gs 0.50 setgray fill gr
gs col-1 s gr
n 226.600 295.800 m 219.000 299.000 l 224.200 292.600 l gs 2 setlinejoin col-1 s gr
% Polyline
n 519 224 m 304 299 l gs 0.50 setgray fill gr
gs col-1 s gr
n 312.212 298.253 m 304.000 299.000 l 310.895 294.477 l gs 2 setlinejoin col-1 s gr
% Polyline
n 59 159 m 59 159 l  59 159 l  59 159 l  clp gs col-1 s gr
% Polyline
n 179 219 m 179 139 l  59 139 l  59 219 l  clp gs col-1 s gr
% Polyline
n 69 149 m 69 139 l  59 139 l  59 149 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 159 m 69 149 l  59 149 l  59 159 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 169 m 69 159 l  59 159 l  59 169 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 179 m 69 169 l  59 169 l  59 179 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 189 m 69 179 l  59 179 l  59 189 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 199 m 69 189 l  59 189 l  59 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 159 359 m 159 319 l  99 319 l  99 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 254 159 m 254 159 l  254 159 l  254 159 l  clp gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
509 134 m 
gs 1 -1 scale (150) col-1 show gr
% Polyline
n 374 219 m 374 139 l  254 139 l  254 219 l  clp gs col-1 s gr
% Polyline
n 264 149 m 264 139 l  254 139 l  254 149 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 264 159 m 264 149 l  254 149 l  254 159 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 264 169 m 264 159 l  254 159 l  254 169 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 264 179 m 264 169 l  254 169 l  254 179 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 264 189 m 264 179 l  254 179 l  254 189 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 264 199 m 264 189 l  254 189 l  254 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 454 159 m 454 159 l  454 159 l  454 159 l  clp gs col-1 s gr
% Polyline
n 574 219 m 574 139 l  454 139 l  454 219 l  clp gs col-1 s gr
% Polyline
n 464 149 m 464 139 l  454 139 l  454 149 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 464 159 m 464 149 l  454 149 l  454 159 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 464 169 m 464 159 l  454 159 l  454 169 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 464 179 m 464 169 l  454 169 l  454 179 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 464 189 m 464 179 l  454 179 l  454 189 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 464 199 m 464 189 l  454 189 l  454 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
99 409 m 
gs 1 -1 scale (rbuf) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
524 344 m 
gs 1 -1 scale (at root) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
199 394 m 
gs 1 -1 scale (stride) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
629 179 m 
gs 1 -1 scale (all processes) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
24 179 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
114 134 m 
gs 1 -1 scale (150) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
219 179 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
309 134 m 
gs 1 -1 scale (150) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
419 179 m 
gs 1 -1 scale (100) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 996 a Fo(Figure)g(4.4)249 1033 y Fz(The)f(ro)q(ot)e(pro)q(cess)g
(gathers)g(column)f Fl(0)j Fz(of)f(a)g(100)p Fy(\002)p
Fz(150)f(C)j(arra)o(y)m(,)d(and)g(eac)o(h)h(set)g(is)g(placed)f
Fl(stride)g Fz(in)o(ts)249 1071 y(apart.)249 1193 y Fs(Example)15
b(4.7)21 b FA(Pro)q(cess)16 b(i)e(sends)i(\(100-i\))d(in)o(ts)h(from)f
(the)i(ith)f(column)e(of)i(a)g(100)g Ft(\002)g FA(150)g(in)o(t)249
1247 y(arra)o(y)m(,)e(in)g(C.)f(It)i(is)f(receiv)o(ed)i(in)o(to)e(a)g
(bu\013er)h(with)f(stride,)i(as)e(in)g(the)h(previous)g(t)o(w)o(o)f
(examples.)249 1301 y(See)j(Figure)f(4.5.)336 1355 y
Fr(MPI_Comm)20 b(comm;)336 1409 y(int)h(gsize,sendarray[100)o(][150)o
(],*sp)o(tr;)336 1463 y(int)g(root,)g(*rbuf,)g(stride,)f(myrank;)336
1517 y(MPI_Datatype)g(stype;)336 1571 y(int)h(*displs,i,*rcounts;)336
1679 y(...)336 1787 y(MPI_Comm_size\()e(comm,)i(&gsize\);)336
1841 y(MPI_Comm_rank\()e(comm,)i(&myrank)f(\);)336 1895
y(rbuf)h(=)h(\(int)f(*\)malloc\(gsize*s)o(tride)o(*size)o(of\(in)o
(t\)\);)336 1949 y(displs)g(=)g(\(int)g(*\)malloc\(gsize*size)o(of\(in)
o(t\)\);)336 2003 y(rcounts)g(=)g(\(int)g(*\)malloc\(gsize*siz)o
(eof\(i)o(nt\)\);)336 2057 y(for)g(\(i=0;)g(i<gsize;)f(++i\))h({)423
2111 y(displs[i])f(=)i(i*stride;)423 2165 y(rcounts[i])e(=)i(100-i;)107
b(/*)22 b(note)f(change)f(from)h(previous)f(example)h(*/)336
2219 y(})336 2273 y(/*)h(Create)e(datatype)g(for)h(the)h(column)e(we)i
(are)f(sending)358 2327 y(*/)336 2381 y(MPI_Type_vector\()e
(100-myrank,)g(1,)j(150,)f(MPI_INT,)f(&stype\);)336 2435
y(MPI_Type_commit\()f(&stype)h(\);)336 2489 y(/*)i(sptr)f(is)g(the)g
(address)f(of)i(start)f(of)g("myrank")f(column)p eop
%%Page: 161 175
161 174 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(161)403 466 y
 18945146 7388601 0 0 42560798 16971694 startTexFig
 403 466 a
%%BeginDocument: ../figures/mycoll-fig5.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-22.0 369.0 translate 0.900 -0.900 scale
/Times-Italic findfont 16.00 scalefont setfont
114 314 m 
gs 1 -1 scale (100) col-1 show gr
0.500 setlinewidth
% Polyline
n 69 209 m 69 199 l  59 199 l  59 209 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 219 m 69 209 l  59 209 l  59 219 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 199 m 274 189 l  264 189 l  264 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 209 m 274 199 l  264 199 l  264 209 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 189 m 484 179 l  474 179 l  474 189 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 199 m 484 189 l  474 189 l  474 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 479 359 m 479 319 l  99 319 l  99 359 l  clp gs col-1 s gr
% Polyline
n 99 394 m 99 359 l gs 0.50 setgray fill gr
gs col-1 s gr
n 97.000 367.000 m 99.000 359.000 l 101.000 367.000 l gs 2 setlinejoin col-1 s gr
n 187.000 371.000 m 179.000 369.000 l 187.000 367.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 179 369 m 259 369 l gs col-1 s gr
n 251.000 367.000 m 259.000 369.000 l 251.000 371.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 224 m 124 299 l gs 0.50 setgray fill gr
gs col-1 s gr
n 125.463 290.885 m 124.000 299.000 l 121.472 291.151 l gs 2 setlinejoin col-1 s gr
% Polyline
n 319 224 m 219 299 l gs 0.50 setgray fill gr
gs col-1 s gr
n 226.600 295.800 m 219.000 299.000 l 224.200 292.600 l gs 2 setlinejoin col-1 s gr
% Polyline
n 519 224 m 304 299 l gs 0.50 setgray fill gr
gs col-1 s gr
n 312.212 298.253 m 304.000 299.000 l 310.895 294.477 l gs 2 setlinejoin col-1 s gr
% Polyline
n 59 159 m 59 159 l  59 159 l  59 159 l  clp gs col-1 s gr
% Polyline
n 179 219 m 179 139 l  59 139 l  59 219 l  clp gs col-1 s gr
% Polyline
n 69 149 m 69 139 l  59 139 l  59 149 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 159 m 69 149 l  59 149 l  59 159 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 169 m 69 159 l  59 159 l  59 169 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 179 m 69 169 l  59 169 l  59 179 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 189 m 69 179 l  59 179 l  59 189 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 199 m 69 189 l  59 189 l  59 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 254 159 m 254 159 l  254 159 l  254 159 l  clp gs col-1 s gr
% Polyline
n 374 219 m 374 139 l  254 139 l  254 219 l  clp gs col-1 s gr
% Polyline
n 159 359 m 159 319 l  99 319 l  99 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 454 159 m 454 159 l  454 159 l  454 159 l  clp gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
204 314 m 
gs 1 -1 scale (99) col-1 show gr
% Polyline
n 574 219 m 574 139 l  454 139 l  454 219 l  clp gs col-1 s gr
% Polyline
n 274 189 m 274 179 l  264 179 l  264 189 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 179 m 274 169 l  264 169 l  264 179 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 169 m 274 159 l  264 159 l  264 169 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 159 m 274 149 l  264 149 l  264 159 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 149 m 274 139 l  264 139 l  264 149 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 179 m 484 169 l  474 169 l  474 179 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 169 m 484 159 l  474 159 l  474 169 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 159 m 484 149 l  474 149 l  474 159 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 149 m 484 139 l  474 139 l  474 149 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 239 359 m 239 319 l  179 319 l  179 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 319 359 m 319 319 l  259 319 l  259 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
99 409 m 
gs 1 -1 scale (rbuf) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
524 344 m 
gs 1 -1 scale (at root) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
199 394 m 
gs 1 -1 scale (stride) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
629 179 m 
gs 1 -1 scale (all processes) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
24 179 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
114 134 m 
gs 1 -1 scale (150) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
219 179 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
309 134 m 
gs 1 -1 scale (150) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
419 179 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
509 134 m 
gs 1 -1 scale (150) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
284 314 m 
gs 1 -1 scale (98) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 996 a Fo(Figure)13 b(4.5)249 1033 y Fz(The)f(ro)q(ot)e(pro)q(cess)
g(gathers)g(100-i)g(in)o(ts)h(from)f(column)g Fl(i)h
Fz(of)g(a)h(100)p Fy(\002)p Fz(150)e(C)i(arra)o(y)m(,)e(and)h(eac)o(h)f
(set)h(is)h(placed)249 1071 y Fl(stride)e Fz(in)o(ts)h(apart.)358
1191 y Fr(*/)336 1245 y(sptr)21 b(=)h(&sendarray[0][my)o(rank])o(;)336
1299 y(MPI_Gatherv\()e(sptr,)g(1,)i(stype,)e(rbuf,)h(rcounts,)f
(displs,)g(MPI_INT,)1469 1353 y(root,)h(comm\);)291 1461
y FA(Note)14 b(that)g(a)f(di\013eren)o(t)i(amoun)o(t)d(of)i(data)f(is)h
(receiv)o(ed)h(from)d(eac)o(h)j(pro)q(cess.)249 1591
y Fs(Example)g(4.8)21 b FA(Same)16 b(as)h(Example)e(4.7,)i(but)g(done)g
(in)g(a)f(di\013eren)o(t)i(w)o(a)o(y)f(at)g(the)g(sending)249
1645 y(end.)24 b(W)m(e)15 b(create)j(a)d(datat)o(yp)q(e)h(that)g
(causes)h(the)f(correct)i(striding)d(at)h(the)g(sending)g(end)g(so)249
1699 y(that)e(that)g(w)o(e)g(read)g(a)g(column)e(of)i(a)f(C)h(arra)o(y)
m(.)336 1753 y Fr(MPI_Comm)20 b(comm;)336 1807 y(int)h
(gsize,sendarray[100)o(][150)o(],*sp)o(tr;)336 1861 y(int)g(root,)g
(*rbuf,)g(stride,)f(myrank,)g(disp[2],)h(blocklen[2];)336
1914 y(MPI_Datatype)f(stype,type[2];)336 1968 y(int)h
(*displs,i,*rcounts;)336 2076 y(...)336 2184 y(MPI_Comm_size\()e(comm,)
i(&gsize\);)336 2238 y(MPI_Comm_rank\()e(comm,)i(&myrank)f(\);)336
2292 y(rbuf)h(=)h(\(int)f(*\)malloc\(gsize*s)o(tride)o(*size)o(of\(in)o
(t\)\);)336 2346 y(displs)g(=)g(\(int)g(*\)malloc\(gsize*size)o(of\(in)
o(t\)\);)336 2400 y(rcounts)g(=)g(\(int)g(*\)malloc\(gsize*siz)o
(eof\(i)o(nt\)\);)336 2454 y(for)g(\(i=0;)g(i<gsize;)f(++i\))h({)423
2508 y(displs[i])f(=)i(i*stride;)p eop
%%Page: 162 176
162 175 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(162)1256 b(Chapter)13 b(4)423
507 y Fr(rcounts[i])20 b(=)i(100-i;)336 561 y(})336 615
y(/*)g(Create)e(datatype)g(for)h(one)h(int,)f(with)g(extent)f(of)i
(entire)e(row)358 669 y(*/)336 723 y(disp[0])h(=)g(0;)152
b(disp[1])21 b(=)g(150*sizeof\(int\);)336 777 y(type[0])g(=)g(MPI_INT;)
f(type[1])h(=)g(MPI_UB;)336 831 y(blocklen[0])f(=)h(1;)65
b(blocklen[1])20 b(=)h(1;)336 885 y(MPI_Type_struct\()e(2,)i(blocklen,)
f(disp,)h(type,)g(&stype)f(\);)336 939 y(MPI_Type_commit\()f(&stype)h
(\);)336 993 y(sptr)h(=)h(&sendarray[0][my)o(rank])o(;)336
1047 y(MPI_Gatherv\()e(sptr,)g(100-myrank,)g(stype,)g(rbuf,)h(rcounts,)
f(displs,)h(MPI_INT,)1622 1101 y(root,)g(comm\);)249
1250 y Fs(Example)15 b(4.9)21 b FA(Same)11 b(as)h(Example)f(4.7)g(at)h
(sending)g(side,)g(but)h(at)f(receiving)g(side)h(w)o(e)f(mak)o(e)249
1304 y(the)j(stride)f(b)q(et)o(w)o(een)h(receiv)o(ed)h(blo)q(c)o(ks)e
(v)n(ary)f(from)f(blo)q(c)o(k)i(to)f(blo)q(c)o(k.)18
b(See)d(Figure)f(4.6.)336 1358 y Fr(MPI_Comm)20 b(comm;)336
1412 y(int)h(gsize,sendarray[100)o(][150)o(],*sp)o(tr;)336
1466 y(int)g(root,)g(*rbuf,)g(*stride,)f(myrank,)g(bufsize;)336
1520 y(MPI_Datatype)g(stype;)336 1574 y(int)h(*displs,i,*rcounts,)o
(offse)o(t;)336 1682 y(...)336 1790 y(MPI_Comm_size\()e(comm,)i
(&gsize\);)336 1844 y(MPI_Comm_rank\()e(comm,)i(&myrank)f(\);)336
1952 y(stride)h(=)g(\(int)g(*\)malloc\(gsize*size)o(of\(in)o(t\)\);)336
2006 y(...)336 2060 y(/*)h(stride[i])e(for)h(i)g(=)h(0)f(to)h(gsize-1)e
(is)i(set)f(somehow)358 2114 y(*/)336 2222 y(/*)h(set)f(up)g(displs)g
(and)g(rcounts)f(vectors)h(first)358 2276 y(*/)336 2330
y(displs)g(=)g(\(int)g(*\)malloc\(gsize*size)o(of\(in)o(t\)\);)336
2384 y(rcounts)g(=)g(\(int)g(*\)malloc\(gsize*siz)o(eof\(i)o(nt\)\);)
336 2438 y(offset)g(=)g(0;)336 2492 y(for)g(\(i=0;)g(i<gsize;)f(++i\))h
({)p eop
%%Page: 163 177
163 176 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(163)403 466 y
 18945146 7388601 0 0 42560798 16971694 startTexFig
 403 466 a
%%BeginDocument: ../figures/mycoll-fig6.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-22.0 369.0 translate 0.900 -0.900 scale
/Times-Italic findfont 16.00 scalefont setfont
114 314 m 
gs 1 -1 scale (100) col-1 show gr
0.500 setlinewidth
% Polyline
n 69 209 m 69 199 l  59 199 l  59 209 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 219 m 69 209 l  59 209 l  59 219 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 199 m 274 189 l  264 189 l  264 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 209 m 274 199 l  264 199 l  264 209 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 189 m 484 179 l  474 179 l  474 189 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 199 m 484 189 l  474 189 l  474 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 479 359 m 479 319 l  99 319 l  99 359 l  clp gs col-1 s gr
% Polyline
n 99 394 m 99 359 l gs 0.50 setgray fill gr
gs col-1 s gr
n 97.000 367.000 m 99.000 359.000 l 101.000 367.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 224 m 124 299 l gs 0.50 setgray fill gr
gs col-1 s gr
n 125.463 290.885 m 124.000 299.000 l 121.472 291.151 l gs 2 setlinejoin col-1 s gr
% Polyline
n 59 159 m 59 159 l  59 159 l  59 159 l  clp gs col-1 s gr
% Polyline
n 179 219 m 179 139 l  59 139 l  59 219 l  clp gs col-1 s gr
% Polyline
n 69 149 m 69 139 l  59 139 l  59 149 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 159 m 69 149 l  59 149 l  59 159 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 169 m 69 159 l  59 159 l  59 169 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 179 m 69 169 l  59 169 l  59 179 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 189 m 69 179 l  59 179 l  59 189 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 199 m 69 189 l  59 189 l  59 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 254 159 m 254 159 l  254 159 l  254 159 l  clp gs col-1 s gr
% Polyline
n 374 219 m 374 139 l  254 139 l  254 219 l  clp gs col-1 s gr
% Polyline
n 454 159 m 454 159 l  454 159 l  454 159 l  clp gs col-1 s gr
% Polyline
n 574 219 m 574 139 l  454 139 l  454 219 l  clp gs col-1 s gr
% Polyline
n 274 189 m 274 179 l  264 179 l  264 189 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 159 359 m 159 319 l  99 319 l  99 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 179 m 274 169 l  264 169 l  264 179 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
249 394 m 
gs 1 -1 scale (stride[1]) col-1 show gr
% Polyline
n 274 169 m 274 159 l  264 159 l  264 169 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 159 m 274 149 l  264 149 l  264 159 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 149 m 274 139 l  264 139 l  264 149 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 179 m 484 169 l  474 169 l  474 179 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 169 m 484 159 l  474 159 l  474 169 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 159 m 484 149 l  474 149 l  474 159 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 149 m 484 139 l  474 139 l  474 149 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 269 359 m 269 319 l  209 319 l  209 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 404 359 m 404 319 l  344 319 l  344 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 314 224 m 244 299 l gs col-1 s gr
n 250.921 294.516 m 244.000 299.000 l 247.996 291.787 l gs 2 setlinejoin col-1 s gr
% Polyline
n 514 224 m 384 299 l gs col-1 s gr
n 391.929 296.735 m 384.000 299.000 l 389.930 293.270 l gs 2 setlinejoin col-1 s gr
n 217.000 371.000 m 209.000 369.000 l 217.000 367.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 209 369 m 344 369 l gs col-1 s gr
n 336.000 367.000 m 344.000 369.000 l 336.000 371.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
99 409 m 
gs 1 -1 scale (rbuf) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
524 344 m 
gs 1 -1 scale (at root) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
629 179 m 
gs 1 -1 scale (all processes) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
24 179 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
114 134 m 
gs 1 -1 scale (150) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
219 179 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
309 134 m 
gs 1 -1 scale (150) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
419 179 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
509 134 m 
gs 1 -1 scale (150) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
229 314 m 
gs 1 -1 scale (99) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
364 314 m 
gs 1 -1 scale (98) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 996 a Fo(Figure)13 b(4.6)249 1033 y Fz(The)f(ro)q(ot)e(pro)q(cess)
g(gathers)g(100-i)g(in)o(ts)h(from)f(column)g Fl(i)h
Fz(of)g(a)h(100)p Fy(\002)p Fz(150)e(C)i(arra)o(y)m(,)e(and)h(eac)o(h)f
(set)h(is)h(placed)249 1071 y Fl(stride[i])d Fz(in)o(ts)h(apart)h(\(a)g
(v)n(arying)e(stride\).)423 1192 y Fr(displs[i])20 b(=)i(offset;)423
1246 y(offset)f(+=)g(stride[i];)423 1300 y(rcounts[i])f(=)i(100-i;)336
1354 y(})336 1408 y(/*)g(the)f(required)f(buffer)g(size)h(for)h(rbuf)f
(is)g(now)g(easily)g(obtained)358 1462 y(*/)336 1516
y(bufsize)g(=)g(displs[gsize-1]+rc)o(ounts)o([gsiz)o(e-1];)336
1570 y(rbuf)g(=)h(\(int)f(*\)malloc\(bufsize)o(*size)o(of\(in)o(t\)\);)
336 1624 y(/*)h(Create)e(datatype)g(for)h(the)h(column)e(we)i(are)f
(sending)358 1678 y(*/)336 1732 y(MPI_Type_vector\()e(100-myrank,)g(1,)
j(150,)f(MPI_INT,)f(&stype\);)336 1786 y(MPI_Type_commit\()f(&stype)h
(\);)336 1840 y(sptr)h(=)h(&sendarray[0][my)o(rank])o(;)336
1894 y(MPI_Gatherv\()e(sptr,)g(1,)i(stype,)e(rbuf,)h(rcounts,)f
(displs,)g(MPI_INT,)1469 1948 y(root,)h(comm\);)249 2130
y Fs(Example)15 b(4.10)21 b FA(Pro)q(cess)d(i)e(sends)i
Fr(num)e FA(in)o(ts)g(from)f(the)i(ith)g(column)d(of)i(a)h(100)e
Ft(\002)i FA(150)f(in)o(t)249 2184 y(arra)o(y)m(,)11
b(in)g(C.)h(The)g(complicating)d(factor)j(is)g(that)g(the)g(v)n(arious)
f(v)n(alues)h(of)f Fr(num)g FA(are)h(not)g(kno)o(wn)249
2238 y(to)g Fr(root)p FA(,)e(so)i(a)f(separate)i(gather)f(m)o(ust)f
(\014rst)h(b)q(e)h(run)f(to)f(\014nd)h(these)h(out.)k(The)12
b(data)g(is)f(placed)249 2292 y(con)o(tiguously)i(at)h(the)g(receiving)
h(end.)336 2346 y Fr(MPI_Comm)20 b(comm;)336 2400 y(int)h
(gsize,sendarray[100)o(][150)o(],*sp)o(tr;)336 2454 y(int)g(root,)g
(*rbuf,)g(stride,)f(myrank,)g(disp[2],)h(blocklen[2];)336
2508 y(MPI_Datatype)f(stype,types[2];)p eop
%%Page: 164 178
164 177 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(164)1256 b(Chapter)13 b(4)336
507 y Fr(int)21 b(*displs,i,*rcounts,)o(num;)336 615
y(...)336 723 y(MPI_Comm_size\()e(comm,)i(&gsize\);)336
777 y(MPI_Comm_rank\()e(comm,)i(&myrank)f(\);)336 885
y(/*)i(First,)e(gather)h(nums)g(to)g(root)358 939 y(*/)336
993 y(rcounts)g(=)g(\(int)g(*\)malloc\(gsize*siz)o(eof\(i)o(nt\)\);)336
1047 y(MPI_Gather\()f(&num,)h(1,)g(MPI_INT,)f(rcounts,)g(1,)i(MPI_INT,)
e(root,)g(comm\);)336 1101 y(/*)i(root)f(now)g(has)g(correct)f
(rcounts,)g(using)h(these)g(we)g(set)g(displs[])g(so)358
1155 y(*)h(that)f(data)g(is)g(placed)f(contiguously)g(\(or)h
(concatenated\))e(at)i(receive)g(end)358 1209 y(*/)336
1263 y(displs)g(=)g(\(int)g(*\)malloc\(gsize*size)o(of\(in)o(t\)\);)336
1317 y(displs[0])f(=)i(0;)336 1371 y(for)f(\(i=1;)g(i<gsize;)f(++i\))h
({)423 1425 y(displs[i])f(=)i(displs[i-1]+rcoun)o(ts[i-)o(1];)336
1479 y(})336 1533 y(/*)g(And,)f(create)f(receive)g(buffer)358
1587 y(*/)336 1641 y(rbuf)h(=)h(\(int)f(*\)malloc\(gsize*\()o(displ)o
(s[gsi)o(ze-1])o(+rcou)o(nts[)o(gsize)o(-1]\))1578 1694
y(*sizeof\(int\)\);)336 1748 y(/*)h(Create)e(datatype)g(for)h(one)h
(int,)f(with)g(extent)f(of)i(entire)e(row)358 1802 y(*/)336
1856 y(disp[0])h(=)g(0;)152 b(disp[1])21 b(=)g(150*sizeof\(int\);)336
1910 y(type[0])g(=)g(MPI_INT;)f(type[1])h(=)g(MPI_UB;)336
1964 y(blocklen[0])f(=)h(1;)65 b(blocklen[1])20 b(=)h(1;)336
2018 y(MPI_Type_struct\()e(2,)i(blocklen,)f(disp,)h(type,)g(&stype)f
(\);)336 2072 y(MPI_Type_commit\()f(&stype)h(\);)336
2126 y(sptr)h(=)h(&sendarray[0][my)o(rank])o(;)336 2180
y(MPI_Gatherv\()e(sptr,)g(num,)h(stype,)g(rbuf,)g(rcounts,)f(displs,)g
(MPI_INT,)1622 2234 y(root,)h(comm\);)p eop
%%Page: 165 179
165 178 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(165)249 507 y FD(4.7)52 b(Scatter)208 686 y Fw(MPI)p
285 686 13 2 v 14 w(SCA)m(TTER\()8 b(sendbuf,)k(sendcount,)g(sendt)o
(yp)q(e,)g(recvbuf,)f(recvcount,)h(recvt)o(yp)q(e,)g(ro)q(ot,)e(comm\))
332 815 y Fv(IN)172 b Fw(sendbuf)401 b Fv(address)14
b(of)f(send)h(bu\013er)332 863 y(IN)172 b Fw(sendcount)360
b Fv(n)o(um)o(b)q(er)12 b(of)f(elemen)o(ts)h(sen)o(t)g(to)f(eac)o(h)g
(pro)q(cess)332 911 y(IN)172 b Fw(sendt)o(yp)q(e)383
b Fv(data)14 b(t)o(yp)q(e)f(of)g(send)h(bu\013er)g(elemen)o(ts)332
959 y(OUT)128 b Fw(recvbuf)408 b Fv(address)14 b(of)f(receiv)o(e)h
(bu\013er)332 1007 y(IN)172 b Fw(recvcount)367 b Fv(n)o(um)o(b)q(er)14
b(of)f(elemen)o(ts)h(in)g(receiv)o(e)g(bu\013er)332 1055
y(IN)172 b Fw(recvt)o(yp)q(e)390 b Fv(data)14 b(t)o(yp)q(e)f(of)g
(receiv)o(e)h(bu\013er)g(elemen)o(ts)332 1103 y(IN)172
b Fw(ro)q(ot)460 b Fv(rank)14 b(of)f(sending)i(pro)q(cess)332
1151 y(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)249
1261 y Fr(int)21 b(MPI)p 405 1261 14 2 v 15 w(Scatter\(void*)e
(sendbuf,)i(int)g(sendcount,)e(MPI)p 1314 1261 V 16 w(Datatype)h
(sendtype,)540 1315 y(void*)g(recvbuf,)h(int)g(recvcount,)e(MPI)p
1262 1315 V 16 w(Datatype)h(recvtype,)540 1369 y(int)h(root,)g(MPI)p
827 1369 V 15 w(Comm)g(comm\))249 1453 y(MPI)p 318 1453
V 15 w(SCATTER\(SENDBUF,)e(SENDCOUNT,)g(SENDTYPE,)h(RECVBUF,)g
(RECVCOUNT,)540 1507 y(RECVTYPE,)g(ROOT,)g(COMM,)h(IERROR\))336
1561 y(<type>)g(SENDBUF\(*\),)e(RECVBUF\(*\))336 1615
y(INTEGER)i(SENDCOUNT,)e(SENDTYPE,)h(RECVCOUNT,)g(RECVTYPE,)g(ROOT,)h
(COMM,)336 1669 y(IERROR)291 1753 y Fw(MPI)p 368 1753
13 2 v 14 w(SCA)m(TTER)13 b FA(is)g(the)i(in)o(v)o(erse)f(op)q(eration)
g(to)g Fw(MPI)p 1140 1753 V 14 w(GA)m(THER)p FA(.)291
1807 y(The)h(outcome)g(is)g FB(as)h(if)f FA(the)g(ro)q(ot)h(executed)h
Fr(n)e FA(send)h(op)q(erations,)f Fw(MPI)p 1444 1807
V 14 w(Send\(sendb)q(uf+i)p Ft(\001)249 1861 y Fw(sendcount)p
Ft(\001)p Fw(extent\()q(send)q(t)o(yp)q(e)q(\),)24 b(sendcount,)f
(sendt)o(yp)q(e,)g(i,...\),)c(i)h(=)g(0)f FA(to)h Fw(n)g(-)g(1.)35
b FA(and)20 b(eac)o(h)249 1914 y(pro)q(cess)c(executed)g(a)d(receiv)o
(e,)i Fw(MPI)p 825 1914 V 14 w(Recv\(recvbuf,)h(recvcount,)g(recvt)o
(yp)q(e,)g(ro)q(ot,...\).)291 1968 y FA(An)9 b(alternativ)o(e)g
(description)h(is)f(that)g(the)h(ro)q(ot)g(sends)g(a)f(message)g(with)g
Fw(MPI)p 1497 1968 V 14 w(Send\(sendb)q(uf,)249 2022
y(sendcount)p Ft(\001)p Fw(n,)15 b(sendt)o(yp)q(e,)g(...\))p
FA(.)h(This)d(message)g(is)g(split)g(in)o(to)f Fr(n)h
FA(equal)f(segmen)o(ts,)h(the)h Fp(i)p FA(th)f(seg-)249
2076 y(men)o(t)f(is)g(sen)o(t)h(to)g(the)g Fp(i)p FA(th)g(pro)q(cess)h
(in)e(the)h(group,)f(and)h(eac)o(h)g(pro)q(cess)h(receiv)o(es)g(this)f
(message)249 2130 y(as)h(ab)q(o)o(v)o(e.)291 2184 y(The)h(t)o(yp)q(e)g
(signature)g(asso)q(ciated)h(with)e Fw(sendcount)j FA(and)e
Fw(sendt)o(yp)q(e)i FA(at)e(the)g(ro)q(ot)g(m)o(ust)f(b)q(e)249
2238 y(equal)f(to)g(the)h(t)o(yp)q(e)f(signature)h(asso)q(ciated)g
(with)f Fw(recvcount)i FA(and)e Fw(recvt)o(yp)q(e)i FA(at)e(all)f(pro)q
(cesses.)249 2292 y(This)17 b(implies)e(that)i(the)h(amoun)o(t)d(of)i
(data)f(sen)o(t)i(m)o(ust)e(b)q(e)i(equal)f(to)f(the)i(amoun)o(t)d(of)i
(data)249 2346 y(receiv)o(ed,)e(pairwise)e(b)q(et)o(w)o(een)j(eac)o(h)e
(pro)q(cess)i(and)d(the)i(ro)q(ot.)j(Distinct)13 b(t)o(yp)q(e)i(maps)d
(b)q(et)o(w)o(een)249 2400 y(sender)k(and)d(receiv)o(er)j(are)e(still)f
(allo)o(w)o(ed.)291 2454 y(All)18 b(argumen)o(ts)h(to)h(the)g(function)
g(are)g(signi\014can)o(t)f(on)g(pro)q(cess)j Fw(ro)q(ot)p
FA(,)e(while)f(on)h(other)249 2508 y(pro)q(cesses,)e(only)d(argumen)o
(ts)f Fw(recvbuf,)k(recvcount,)f(recvt)o(yp)q(e,)h(ro)q(ot,)d(comm)e
FA(are)j(signi\014can)o(t.)p eop
%%Page: 166 180
166 179 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(166)1256 b(Chapter)13 b(4)478
466 y
 16577003 6630800 0 0 33943388 13682606 startTexFig
 478 466 a
%%BeginDocument: ../figures/mycoll-fig7.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-54.0 373.0 translate 0.900 -0.900 scale
/Times-Italic findfont 16.00 scalefont setfont
74 194 m 
gs 1 -1 scale (100) col-1 show gr
0.500 setlinewidth
% Polyline
n 219 239 m 219 199 l  159 199 l  159 239 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
174 194 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 319 239 m 319 199 l  259 199 l  259 239 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
274 194 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 159 359 m 159 319 l  99 319 l  99 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
114 314 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 219 359 m 219 319 l  159 319 l  159 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
174 314 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 119 239 m 119 199 l  59 199 l  59 239 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 279 359 m 279 319 l  219 319 l  219 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
99 414 m 
gs 1 -1 scale (sendbuf) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
234 314 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 479 359 m 479 319 l  99 319 l  99 359 l  clp gs col-1 s gr
% Polyline
n 99 394 m 99 359 l gs 0.50 setgray fill gr
gs col-1 s gr
n 97.000 367.000 m 99.000 359.000 l 101.000 367.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 299 m 89 244 l gs col-1 s gr
n 91.075 251.981 m 89.000 244.000 l 94.587 250.065 l gs 2 setlinejoin col-1 s gr
% Polyline
n 189 299 m 189 244 l gs col-1 s gr
n 187.000 252.000 m 189.000 244.000 l 191.000 252.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 249 299 m 289 244 l gs col-1 s gr
n 282.677 249.294 m 289.000 244.000 l 285.912 251.646 l gs 2 setlinejoin col-1 s gr
/Times-Italic findfont 18.00 scalefont setfont
524 344 m 
gs 1 -1 scale (at root) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
519 229 m 
gs 1 -1 scale (all processes) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 948 a Fo(Figure)g(4.7)249 985 y Fz(The)f(ro)q(ot)e(pro)q(cess)g
(scatters)g(sets)h(of)g(100)g Fl(int)p Fz(s)f(to)h(eac)o(h)g(pro)q
(cess)f(in)h(the)g(group.)249 1108 y FA(The)20 b(argumen)o(t)e
Fw(ro)q(ot)h FA(m)o(ust)f(ha)o(v)o(e)h(iden)o(tical)g(v)n(alues)g(on)g
(all)f(pro)q(cesses)k(and)d Fw(comm)e FA(m)o(ust)249
1162 y(represen)o(t)g(the)e(same)f(in)o(tragroup)g(comm)o(unicati)o(on)
e(domain.)17 b(The)e(send)h(bu\013er)f(is)g(ignored)249
1216 y(for)f(all)e(non-ro)q(ot)i(pro)q(cesses.)291 1270
y(The)g(sp)q(eci\014cation)h(of)f(coun)o(ts)h(and)f(t)o(yp)q(es)h
(should)g(not)f(cause)h(an)o(y)f(lo)q(cation)f(on)h(the)h(ro)q(ot)249
1324 y(to)f(b)q(e)g(read)h(more)e(than)g(once.)249 1415
y FB(R)n(ationale.)48 b FA(Though)15 b(not)h(essen)o(tial,)g(the)h
(last)e(restriction)i(is)e(imp)q(osed)g(so)h(as)g(to)f(ac)o(hiev)o(e)
249 1469 y(symmetry)8 b(with)h Fw(MPI)p 606 1469 13 2
v 15 w(GA)m(THER)p FA(,)f(where)j(the)f(corresp)q(onding)h(restriction)
g(\(a)f(m)o(ultiple-write)249 1523 y(restriction\))15
b(is)f(necessary)m(.)19 b(\()p FB(End)d(of)f(r)n(ationale.)p
FA(\))249 1615 y Fs(4.7.1)48 b(An)15 b(Example)h(Using)e
Fw(MPI)p 883 1615 V 14 w(SCA)m(TTER)249 1698 y Fs(Example)h(4.11)21
b FA(The)11 b(rev)o(erse)i(of)e(Example)e(4.2,)h(page)i(155.)k(Scatter)
c(sets)g(of)f(100)f(in)o(ts)h(from)249 1751 y(the)k(ro)q(ot)e(to)h(eac)
o(h)h(pro)q(cess)g(in)f(the)g(group.)k(See)d(Figure)f(4.7.)336
1805 y Fr(MPI_Comm)20 b(comm;)336 1859 y(int)h(gsize,*sendbuf;)336
1913 y(int)g(root,)g(rbuf[100];)336 1967 y(...)336 2021
y(MPI_Comm_size\()e(comm,)i(&gsize\);)336 2075 y(sendbuf)g(=)g(\(int)g
(*\)malloc\(gsize*100)o(*size)o(of\(in)o(t\)\);)336 2129
y(...)336 2183 y(MPI_Scatter\()f(sendbuf,)g(100,)h(MPI_INT,)f(rbuf,)h
(100,)g(MPI_INT,)f(root,)g(comm\);)p eop
%%Page: 167 181
167 180 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(167)249 507 y Fs(4.7.2)48 b(Scatter:)20 b(V)l(ector)15
b(V)l(arian)o(t)208 661 y Fw(MPI)p 285 661 13 2 v 14
w(SCA)m(TTERV\()i(sendbuf,)j(sendcounts,)h(displs,)f(sendt)o(yp)q(e,)h
(recvbuf,)g(recvcount,)g(recvt)o(yp)q(e,)249 715 y(ro)q(ot,)13
b(comm\))332 790 y Fv(IN)172 b Fw(sendbuf)401 b Fv(address)14
b(of)f(send)h(bu\013er)332 840 y(IN)172 b Fw(sendcounts)344
b Fv(in)o(teger)14 b(arra)o(y)332 889 y(IN)172 b Fw(displs)438
b Fv(in)o(teger)14 b(arra)o(y)g(of)e(displacemen)o(ts)332
939 y(IN)172 b Fw(sendt)o(yp)q(e)383 b Fv(data)14 b(t)o(yp)q(e)f(of)g
(send)h(bu\013er)g(elemen)o(ts)332 989 y(OUT)128 b Fw(recvbuf)408
b Fv(address)14 b(of)f(receiv)o(e)h(bu\013er)332 1039
y(IN)172 b Fw(recvcount)367 b Fv(n)o(um)o(b)q(er)14 b(of)f(elemen)o(ts)
h(in)g(receiv)o(e)g(bu\013er)332 1089 y(IN)172 b Fw(recvt)o(yp)q(e)390
b Fv(data)14 b(t)o(yp)q(e)f(of)g(receiv)o(e)h(bu\013er)g(elemen)o(ts)
332 1139 y(IN)172 b Fw(ro)q(ot)460 b Fv(rank)14 b(of)f(sending)i(pro)q
(cess)332 1188 y(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)249
1299 y Fr(int)21 b(MPI)p 405 1299 14 2 v 15 w(Scatterv\(void*)e
(sendbuf,)h(int)i(*sendcounts,)d(int)i(*displs,)540 1352
y(MPI)p 609 1352 V 15 w(Datatype)f(sendtype,)g(void*)h(recvbuf,)f(int)h
(recvcount,)540 1406 y(MPI)p 609 1406 V 15 w(Datatype)f(recvtype,)g
(int)h(root,)g(MPI)p 1322 1406 V 15 w(Comm)g(comm\))249
1490 y(MPI)p 318 1490 V 15 w(SCATTERV\(SENDBUF,)d(SENDCOUNTS,)i
(DISPLS,)g(SENDTYPE,)g(RECVBUF,)540 1544 y(RECVCOUNT,)f(RECVTYPE,)h
(ROOT,)h(COMM,)g(IERROR\))336 1598 y(<type>)g(SENDBUF\(*\),)e
(RECVBUF\(*\))336 1652 y(INTEGER)i(SENDCOUNTS\(*\),)d(DISPLS\(*\),)i
(SENDTYPE,)g(RECVCOUNT,)g(RECVTYPE,)336 1706 y(ROOT,)h(COMM,)g(IERROR)
291 1790 y Fw(MPI)p 368 1790 13 2 v 14 w(SCA)m(TTERV)12
b FA(is)i(the)h(in)o(v)o(erse)f(op)q(eration)g(to)g Fw(MPI)p
1168 1790 V 14 w(GA)m(THERV)p FA(.)291 1844 y Fw(MPI)p
368 1844 V 14 w(SCA)m(TTERV)e FA(extends)i(the)g(functionalit)o(y)e(of)
h Fw(MPI)p 1191 1844 V 14 w(SCA)m(TTER)f FA(b)o(y)h(allo)o(wing)e(a)i
(v)n(ary-)249 1898 y(ing)d(coun)o(t)h(of)f(data)g(to)h(b)q(e)g(sen)o(t)
g(to)g(eac)o(h)g(pro)q(cess,)i(since)e Fw(sendcounts)i
FA(is)d(no)o(w)h(an)f(arra)o(y)m(.)16 b(It)11 b(also)249
1952 y(allo)o(ws)h(more)g(\015exibilit)o(y)f(as)i(to)g(where)h(the)f
(data)g(is)f(tak)o(en)h(from)e(on)i(the)g(ro)q(ot,)g(b)o(y)g(pro)o
(viding)249 2006 y(the)i(new)f(argumen)o(t,)e Fw(displs)p
FA(.)291 2060 y(The)d(outcome)g(is)g(as)g(if)g(the)h(ro)q(ot)f
(executed)i Fr(n)e FA(send)h(op)q(erations,)g Fw(MPI)p
1376 2060 V 14 w(Send\(sendb)q(uf+d)q(ispls)249 2114
y([i])p Ft(\001)p Fw(extent\(sendt)o(yp)q(e\))q(,)18
b(sendcounts[i],)g(sendt)o(yp)q(e,)f(i,...\),)d(i)h(=)h(0)f
FA(to)h Fw(n)g(-)f(1,)31 b FA(and)16 b(eac)o(h)g(pro)q(cess)249
2168 y(executed)g(a)d(receiv)o(e,)i Fw(MPI)p 680 2168
V 14 w(Recv\(recvbu)q(f,)h(recvcount,)f(recvt)o(yp)q(e,)h(ro)q
(ot,...\).)291 2222 y FA(The)j(t)o(yp)q(e)h(signature)g(implied)c(b)o
(y)j Fw(sendcount[i])j FA(and)d Fw(sendt)o(yp)q(e)i FA(at)f(the)f(ro)q
(ot)h(m)o(ust)e(b)q(e)249 2276 y(equal)e(to)g(the)h(t)o(yp)q(e)g
(signature)f(implied)e(b)o(y)i Fw(recvcount)j FA(and)d
Fw(recvt)o(yp)q(e)i FA(at)f(pro)q(cess)h Fr(i)p FA(.)25
b(This)249 2330 y(implies)10 b(that)i(the)h(amoun)o(t)d(of)h(data)h
(sen)o(t)h(m)o(ust)e(b)q(e)h(equal)g(to)g(the)g(amoun)o(t)e(of)i(data)g
(receiv)o(ed,)249 2384 y(pairwise)17 b(b)q(et)o(w)o(een)h(eac)o(h)g
(pro)q(cess)h(and)d(the)i(ro)q(ot.)27 b(Distinct)17 b(t)o(yp)q(e)h
(maps)d(b)q(et)o(w)o(een)k(sender)249 2438 y(and)14 b(receiv)o(er)h
(are)g(still)d(allo)o(w)o(ed.)p eop
%%Page: 168 182
168 181 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(168)1256 b(Chapter)13 b(4)291
507 y FA(All)18 b(argumen)o(ts)h(to)h(the)g(function)g(are)g
(signi\014can)o(t)f(on)g(pro)q(cess)j Fw(ro)q(ot)p FA(,)e(while)f(on)h
(other)249 561 y(pro)q(cesses,)e(only)d(argumen)o(ts)f
Fw(recvbuf,)k(recvcount,)f(recvt)o(yp)q(e,)h(ro)q(ot,)d(comm)e
FA(are)j(signi\014can)o(t.)249 615 y(The)h(argumen)o(ts)g
Fw(ro)q(ot)f FA(m)o(ust)g(ha)o(v)o(e)h(iden)o(tical)f(v)n(alues)h(on)f
(all)g(pro)q(cesses,)k(and)c Fw(comm)f FA(m)o(ust)249
669 y(represen)o(t)i(the)e(same)f(in)o(tragroup)g(comm)o(unicati)o(on)e
(domain.)17 b(The)e(send)h(bu\013er)f(is)g(ignored)249
723 y(for)f(all)e(non-ro)q(ot)i(pro)q(cesses.)291 777
y(The)f(sp)q(eci\014cation)h(of)f(coun)o(ts,)h(t)o(yp)q(es,)f(and)h
(displacemen)o(ts)f(should)g(not)g(cause)h(an)o(y)f(lo)q(ca-)249
831 y(tion)g(on)h(the)h(ro)q(ot)e(to)h(b)q(e)h(read)f(more)f(than)h
(once.)249 914 y Fs(4.7.3)48 b(Examples)15 b(Using)f
Fw(MPI)p 823 914 13 2 v 14 w(SCA)m(TTERV)249 997 y Fs(Example)h(4.12)21
b FA(The)16 b(rev)o(erse)i(of)d(Example)f(4.5,)h(page)g(158.)23
b(The)16 b(ro)q(ot)g(pro)q(cess)i(scatters)249 1051 y(sets)f(of)e(100)f
(in)o(ts)i(to)f(the)h(other)g(pro)q(cesses,)i(but)e(the)g(sets)g(of)f
(100)g(are)h FB(stride)e FA(in)o(ts)i(apart)f(in)249
1105 y(the)g(sending)g(bu\013er,)g(where)h Fp(str)q(ide)d
Ft(\025)g FA(100.)20 b(This)14 b(requires)i(use)g(of)e
Fw(MPI)p 1436 1105 V 14 w(SCA)m(TTERV)p FA(.)f(See)249
1159 y(Figure)h(4.8.)336 1213 y Fr(MPI_Comm)20 b(comm;)336
1267 y(int)h(gsize,*sendbuf;)336 1321 y(int)g(root,)g(rbuf[100],)f(i,)h
(*displs,)f(*scounts;)336 1429 y(...)336 1537 y(MPI_Comm_size\()f
(comm,)i(&gsize\);)336 1591 y(sendbuf)g(=)g(\(int)g
(*\)malloc\(gsize*str)o(ide*s)o(izeof)o(\(int\))o(\);)336
1645 y(...)336 1699 y(displs)g(=)g(\(int)g(*\)malloc\(gsize*size)o
(of\(in)o(t\)\);)336 1753 y(scounts)g(=)g(\(int)g(*\)malloc\(gsize*siz)
o(eof\(i)o(nt\)\);)336 1807 y(for)g(\(i=0;)g(i<gsize;)f(++i\))h({)423
1861 y(displs[i])f(=)i(i*stride;)423 1914 y(scounts[i])e(=)i(100;)336
1968 y(})336 2022 y(MPI_Scatterv\()d(sendbuf,)h(scounts,)h(displs,)f
(MPI_INT,)g(rbuf,)h(100,)g(MPI_INT,)1600 2076 y(root,)g(comm\);)249
2267 y Fs(Example)15 b(4.13)21 b FA(The)e(rev)o(erse)h(of)e(Example)e
(4.9.)31 b(W)m(e)18 b(ha)o(v)o(e)g(a)g(v)n(arying)f(stride)i(b)q(et)o
(w)o(een)249 2321 y(blo)q(c)o(ks)14 b(at)f(sending)h(\(ro)q(ot\))f
(side,)h(at)f(the)h(receiving)g(side)g(w)o(e)g(receiv)o(e)h(100)7
b Ft(\000)i Fp(i)14 b FA(elemen)o(ts)f(in)o(to)249 2375
y(the)i(ith)e(column)f(of)i(a)f(100)p Ft(\002)p FA(150)g(C)h(arra)o(y)f
(at)h(pro)q(cess)i Fp(i)p FA(.)i(See)d(Figure)f(4.9.)336
2429 y Fr(MPI_Comm)20 b(comm;)336 2483 y(int)h(gsize,recvarray[100)o
(][150)o(],*rp)o(tr;)p eop
%%Page: 169 183
169 182 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(169)478 466 y
 16577003 6796570 0 0 33943388 14011514 startTexFig
 478 466 a
%%BeginDocument: ../figures/mycoll-fig8.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-54.0 378.0 translate 0.900 -0.900 scale
/Times-Italic findfont 16.00 scalefont setfont
74 194 m 
gs 1 -1 scale (100) col-1 show gr
0.500 setlinewidth
% Polyline
n 219 239 m 219 199 l  159 199 l  159 239 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
174 194 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 319 239 m 319 199 l  259 199 l  259 239 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
274 194 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 159 359 m 159 319 l  99 319 l  99 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
114 314 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 239 359 m 239 319 l  179 319 l  179 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
194 314 m 
gs 1 -1 scale (100) col-1 show gr
% Polyline
n 319 359 m 319 319 l  259 319 l  259 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 119 239 m 119 199 l  59 199 l  59 239 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Italic findfont 16.00 scalefont setfont
274 314 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
99 419 m 
gs 1 -1 scale (sendbuf) col-1 show gr
% Polyline
n 479 359 m 479 319 l  99 319 l  99 359 l  clp gs col-1 s gr
% Polyline
n 99 394 m 99 359 l gs 0.50 setgray fill gr
gs col-1 s gr
n 97.000 367.000 m 99.000 359.000 l 101.000 367.000 l gs 2 setlinejoin col-1 s gr
n 187.000 371.000 m 179.000 369.000 l 187.000 367.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 179 369 m 259 369 l gs col-1 s gr
n 251.000 367.000 m 259.000 369.000 l 251.000 371.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 299 m 84 244 l gs col-1 s gr
n 86.608 251.823 m 84.000 244.000 l 89.982 249.676 l gs 2 setlinejoin col-1 s gr
% Polyline
n 204 304 m 189 244 l gs col-1 s gr
n 189.000 252.246 m 189.000 244.000 l 192.881 251.276 l gs 2 setlinejoin col-1 s gr
% Polyline
n 284 304 m 289 244 l gs col-1 s gr
n 286.343 251.806 m 289.000 244.000 l 290.329 252.138 l gs 2 setlinejoin col-1 s gr
/Times-Italic findfont 18.00 scalefont setfont
524 344 m 
gs 1 -1 scale (at root) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
519 229 m 
gs 1 -1 scale (all processes) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
199 394 m 
gs 1 -1 scale (stride) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 959 a Fo(Figure)13 b(4.8)249 996 y Fz(The)f(ro)q(ot)e(pro)q(cess)g
(scatters)g(sets)h(of)g(100)g Fl(int)p Fz(s,)f(mo)o(ving)g(b)o(y)h
Fl(stride)e Fz(in)o(ts)i(from)f(send)h(to)g(send)g(in)g(the)249
1033 y(scatter.)336 1149 y Fr(int)21 b(root,)g(*sendbuf,)f(myrank,)g
(bufsize,)h(*stride;)336 1203 y(MPI_Datatype)f(rtype;)336
1257 y(int)h(i,)h(*displs,)e(*scounts,)g(offset;)336
1311 y(...)336 1365 y(MPI_Comm_size\()f(comm,)i(&gsize\);)336
1419 y(MPI_Comm_rank\()e(comm,)i(&myrank)f(\);)336 1527
y(stride)h(=)g(\(int)g(*\)malloc\(gsize*size)o(of\(in)o(t\)\);)336
1581 y(...)336 1635 y(/*)h(stride[i])e(for)h(i)g(=)h(0)f(to)h(gsize-1)e
(is)i(set)f(somehow)358 1689 y(*)h(sendbuf)e(comes)h(from)g(elsewhere)f
(*/)336 1743 y(...)336 1797 y(displs)h(=)g(\(int)g
(*\)malloc\(gsize*size)o(of\(in)o(t\)\);)336 1851 y(scounts)g(=)g
(\(int)g(*\)malloc\(gsize*siz)o(eof\(i)o(nt\)\);)336
1905 y(offset)g(=)g(0;)336 1959 y(for)g(\(i=0;)g(i<gsize;)f(++i\))h({)
423 2013 y(displs[i])f(=)i(offset;)423 2067 y(offset)f(+=)g(stride[i];)
423 2121 y(scounts[i])f(=)i(100)f(-)g(i;)336 2175 y(})336
2229 y(/*)h(Create)e(datatype)g(for)h(the)h(column)e(we)i(are)f
(receiving)f(*/)336 2283 y(MPI_Type_vector\()f(100-myrank,)g(1,)j(150,)
f(MPI_INT,)f(&rtype\);)336 2337 y(MPI_Type_commit\()f(&rtype)h(\);)336
2391 y(rptr)h(=)h(&recvarray[0][my)o(rank])o(;)336 2445
y(MPI_Scatterv\()d(sendbuf,)h(scounts,)h(displs,)f(MPI_INT,)g(rptr,)h
(1,)g(rtype,)1557 2499 y(root,)f(comm\);)p eop
%%Page: 170 184
170 183 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(170)1256 b(Chapter)13 b(4)403
466 y
 18945146 7578056 0 0 42560798 17234821 startTexFig
 403 466 a
%%BeginDocument: ../figures/mycoll-fig9.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-22.0 373.0 translate 0.900 -0.900 scale
/Times-Italic findfont 16.00 scalefont setfont
114 314 m 
gs 1 -1 scale (100) col-1 show gr
0.500 setlinewidth
% Polyline
n 69 209 m 69 199 l  59 199 l  59 209 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 219 m 69 209 l  59 209 l  59 219 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 199 m 274 189 l  264 189 l  264 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 209 m 274 199 l  264 199 l  264 209 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 189 m 484 179 l  474 179 l  474 189 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 199 m 484 189 l  474 189 l  474 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 479 359 m 479 319 l  99 319 l  99 359 l  clp gs col-1 s gr
% Polyline
n 99 394 m 99 359 l gs 0.50 setgray fill gr
gs col-1 s gr
n 97.000 367.000 m 99.000 359.000 l 101.000 367.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 59 159 m 59 159 l  59 159 l  59 159 l  clp gs col-1 s gr
% Polyline
n 179 219 m 179 139 l  59 139 l  59 219 l  clp gs col-1 s gr
% Polyline
n 69 149 m 69 139 l  59 139 l  59 149 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 159 m 69 149 l  59 149 l  59 159 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 169 m 69 159 l  59 159 l  59 169 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 179 m 69 169 l  59 169 l  59 179 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 189 m 69 179 l  59 179 l  59 189 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 69 199 m 69 189 l  59 189 l  59 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 254 159 m 254 159 l  254 159 l  254 159 l  clp gs col-1 s gr
% Polyline
n 374 219 m 374 139 l  254 139 l  254 219 l  clp gs col-1 s gr
% Polyline
n 454 159 m 454 159 l  454 159 l  454 159 l  clp gs col-1 s gr
% Polyline
n 574 219 m 574 139 l  454 139 l  454 219 l  clp gs col-1 s gr
% Polyline
n 274 189 m 274 179 l  264 179 l  264 189 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 179 m 274 169 l  264 169 l  264 179 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 159 359 m 159 319 l  99 319 l  99 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 169 m 274 159 l  264 159 l  264 169 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
99 414 m 
gs 1 -1 scale (sendbuf) col-1 show gr
% Polyline
n 274 159 m 274 149 l  264 149 l  264 159 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 274 149 m 274 139 l  264 139 l  264 149 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 179 m 484 169 l  474 169 l  474 179 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 169 m 484 159 l  474 159 l  474 169 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 159 m 484 149 l  474 149 l  474 159 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 484 149 m 484 139 l  474 139 l  474 149 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 269 359 m 269 319 l  209 319 l  209 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 404 359 m 404 319 l  344 319 l  344 359 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
n 217.000 371.000 m 209.000 369.000 l 217.000 367.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 209 369 m 344 369 l gs col-1 s gr
n 336.000 367.000 m 344.000 369.000 l 336.000 371.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 129 304 m 119 224 l gs col-1 s gr
n 118.008 232.186 m 119.000 224.000 l 121.977 231.690 l gs 2 setlinejoin col-1 s gr
% Polyline
n 244 304 m 319 224 l gs col-1 s gr
n 312.069 228.468 m 319.000 224.000 l 314.988 231.204 l gs 2 setlinejoin col-1 s gr
% Polyline
n 379 304 m 519 224 l gs col-1 s gr
n 511.062 226.233 m 519.000 224.000 l 513.046 229.706 l gs 2 setlinejoin col-1 s gr
/Times-Italic findfont 18.00 scalefont setfont
524 344 m 
gs 1 -1 scale (at root) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
629 179 m 
gs 1 -1 scale (all processes) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
24 179 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
114 134 m 
gs 1 -1 scale (150) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
219 179 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
309 134 m 
gs 1 -1 scale (150) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
419 179 m 
gs 1 -1 scale (100) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
509 134 m 
gs 1 -1 scale (150) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
229 314 m 
gs 1 -1 scale (99) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
364 314 m 
gs 1 -1 scale (98) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
249 394 m 
gs 1 -1 scale (stride[1]) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1008 a Fo(Figure)g(4.9)249 1045 y Fz(The)f(ro)q(ot)e(scatters)g
(blo)q(c)o(ks)g(of)h(100-i)f(in)o(ts)h(in)o(to)g(column)e
Fl(i)j Fz(of)f(a)g(100)p Fy(\002)p Fz(150)f(C)j(arra)o(y)m(.)h(A)o(t)d
(the)g(sending)f(side,)249 1083 y(the)h(blo)q(c)o(ks)f(are)h
Fl(stride[i])d Fz(in)o(ts)j(apart.)249 1367 y FD(4.8)52
b(Gather)18 b(to)g(All)208 1546 y Fw(MPI)p 285 1546 13
2 v 14 w(ALLGA)m(THER\()d(sendbuf,)i(sendcount,)h(sendt)o(yp)q(e,)g
(recvbuf,)f(recvcount,)h(recvt)o(yp)q(e,)f(comm\))332
1675 y Fv(IN)172 b Fw(sendbuf)401 b Fv(starting)15 b(address)f(of)e
(send)i(bu\013er)332 1725 y(IN)172 b Fw(sendcount)360
b Fv(n)o(um)o(b)q(er)14 b(of)f(elemen)o(ts)h(in)g(send)f(bu\013er)332
1774 y(IN)172 b Fw(sendt)o(yp)q(e)383 b Fv(data)14 b(t)o(yp)q(e)f(of)g
(send)h(bu\013er)g(elemen)o(ts)332 1824 y(OUT)128 b Fw(recvbuf)408
b Fv(address)14 b(of)f(receiv)o(e)h(bu\013er)332 1874
y(IN)172 b Fw(recvcount)367 b Fv(n)o(um)o(b)q(er)19 b(of)f(elemen)o(ts)
h(receiv)o(ed)h(from)e(an)o(y)1079 1928 y(pro)q(cess)332
1978 y(IN)172 b Fw(recvt)o(yp)q(e)390 b Fv(data)14 b(t)o(yp)q(e)f(of)g
(receiv)o(e)h(bu\013er)g(elemen)o(ts)332 2028 y(IN)172
b Fw(comm)425 b Fv(comm)o(unicator)249 2138 y Fr(int)21
b(MPI)p 405 2138 14 2 v 15 w(Allgather\(void*)e(sendbuf,)h(int)h
(sendcount,)540 2192 y(MPI)p 609 2192 V 15 w(Datatype)f(sendtype,)g
(void*)h(recvbuf,)f(int)h(recvcount,)540 2246 y(MPI)p
609 2246 V 15 w(Datatype)f(recvtype,)g(MPI)p 1104 2246
V 15 w(Comm)h(comm\))249 2330 y(MPI)p 318 2330 V 15 w
(ALLGATHER\(SENDBUF,)d(SENDCOUNT,)i(SENDTYPE,)g(RECVBUF,)g(RECVCOUNT,)
540 2384 y(RECVTYPE,)g(COMM,)g(IERROR\))336 2438 y(<type>)h
(SENDBUF\(*\),)e(RECVBUF\(*\))336 2492 y(INTEGER)i(SENDCOUNT,)e
(SENDTYPE,)h(RECVCOUNT,)g(RECVTYPE,)g(COMM,)h(IERROR)p
eop
%%Page: 171 185
171 184 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(171)291 507 y Fw(MPI)p 368 507 13 2 v 14 w(ALLGA)m(THER)10
b FA(can)g(b)q(e)h(though)o(t)f(of)g(as)g Fw(MPI)p 1069
507 V 15 w(GA)m(THER)p FA(,)f(except)i(all)e(pro)q(cesses)k(receiv)o(e)
249 561 y(the)h(result,)f(instead)g(of)f(just)h(the)h(ro)q(ot.)j(The)d
Fr(j)p FA(th)f(blo)q(c)o(k)f(of)g(data)h(sen)o(t)g(from)f(eac)o(h)h
(pro)q(cess)i(is)249 615 y(receiv)o(ed)g(b)o(y)f(ev)o(ery)h(pro)q(cess)
g(and)f(placed)g(in)g(the)g Fr(j)p FA(th)g(blo)q(c)o(k)f(of)h(the)g
(bu\013er)h Fw(recvbuf)p FA(.)291 669 y(The)j(t)o(yp)q(e)h(signature)g
(asso)q(ciated)g(with)f Fw(sendcount)i FA(and)f Fw(sendt)o(yp)q(e)h
FA(at)e(a)g(pro)q(cess)i(m)o(ust)249 723 y(b)q(e)14 b(equal)g(to)f(the)
h(t)o(yp)q(e)g(signature)g(asso)q(ciated)h(with)e Fw(recvcount)j
FA(and)d Fw(recvt)o(yp)q(e)j FA(at)e(an)o(y)f(other)249
777 y(pro)q(cess.)291 831 y(The)18 b(outcome)f(of)h(a)g(call)f(to)h
Fw(MPI)p 853 831 V 14 w(ALLGA)m(THER\(...\))30 b FA(is)18
b(as)g(if)f(all)g(pro)q(cesses)j(executed)249 885 y Fr(n)15
b FA(calls)g(to)h Fw(MPI)p 510 885 V 14 w(GA)m(THER\(sendbuf,)g
(sendcount,)i(sendt)o(yp)q(e,)g(recvbuf,)f(recvcount,)h(recvt)o(yp)q
(e,)249 939 y(ro)q(ot,)12 b(comm\))p FA(,)e(for)i Fw(ro)q(ot)g(=)h(0)f
(,)g(...,)f(n-1)p FA(.)17 b(The)c(rules)g(for)f(correct)i(usage)f(of)e
Fw(MPI)p 1497 939 V 15 w(ALLGA)m(THER)249 993 y FA(are)j(easily)g
(found)f(from)f(the)j(corresp)q(onding)g(rules)f(for)g
Fw(MPI)p 1226 993 V 14 w(GA)m(THER)p FA(.)249 1076 y
Fs(4.8.1)48 b(An)15 b(Example)h(Using)e Fw(MPI)p 883
1076 V 14 w(ALLGA)m(THER)249 1159 y Fs(Example)h(4.14)21
b FA(The)14 b(all-gather)f(v)o(ersion)h(of)f(Example)f(4.2,)g(page)i
(155.)j(Using)d Fw(MPI)p 1645 1159 V 14 w(ALL-)249 1213
y(GATHER)p FA(,)e(w)o(e)h(will)f(gather)h(100)f(in)o(ts)h(from)e(ev)o
(ery)j(pro)q(cess)h(in)d(the)i(group)f(to)f(ev)o(ery)i(pro)q(cess.)336
1267 y Fr(MPI_Comm)20 b(comm;)336 1321 y(int)h(gsize,sendarray[100)o
(];)336 1375 y(int)g(*rbuf;)336 1429 y(...)336 1483 y(MPI_Comm_size\()e
(comm,)i(&gsize\);)336 1537 y(rbuf)g(=)h(\(int)f(*\)malloc\(gsize*1)o
(00*si)o(zeof\()o(int\)\))o(;)336 1591 y(MPI_Allgather\()e(sendarray,)h
(100,)h(MPI_INT,)f(rbuf,)h(100,)g(MPI_INT,)f(comm\);)291
1699 y FA(After)11 b(the)h(call,)f(ev)o(ery)h(pro)q(cess)h(has)e(the)h
(group-wide)f(concatenation)h(of)e(the)i(sets)h(of)d(data.)p
eop
%%Page: 172 186
172 185 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(172)1256 b(Chapter)13 b(4)249
507 y Fs(4.8.2)48 b(Gather)14 b(to)i(All:)k(V)l(ector)15
b(V)l(arian)o(t)208 661 y Fw(MPI)p 285 661 13 2 v 14
w(ALLGA)m(THERV\()c(sendbuf,)i(sendcount,)h(sendt)o(yp)q(e,)f(recvbuf,)
g(recvcounts,)h(displs,)e(recvt)o(yp)q(e,)249 715 y(comm\))332
790 y Fv(IN)172 b Fw(sendbuf)401 b Fv(starting)15 b(address)f(of)e
(send)i(bu\013er)332 840 y(IN)172 b Fw(sendcount)360
b Fv(n)o(um)o(b)q(er)14 b(of)f(elemen)o(ts)h(in)g(send)f(bu\013er)332
889 y(IN)172 b Fw(sendt)o(yp)q(e)383 b Fv(data)14 b(t)o(yp)q(e)f(of)g
(send)h(bu\013er)g(elemen)o(ts)332 939 y(OUT)128 b Fw(recvbuf)408
b Fv(address)14 b(of)f(receiv)o(e)h(bu\013er)332 989
y(IN)172 b Fw(recvcounts)351 b Fv(in)o(teger)14 b(arra)o(y)332
1039 y(IN)172 b Fw(displs)438 b Fv(in)o(teger)14 b(arra)o(y)g(of)e
(displacemen)o(ts)332 1089 y(IN)172 b Fw(recvt)o(yp)q(e)390
b Fv(data)14 b(t)o(yp)q(e)f(of)g(receiv)o(e)h(bu\013er)g(elemen)o(ts)
332 1139 y(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)249
1249 y Fr(int)21 b(MPI)p 405 1249 14 2 v 15 w(Allgatherv\(void*)e
(sendbuf,)h(int)h(sendcount,)540 1303 y(MPI)p 609 1303
V 15 w(Datatype)f(sendtype,)g(void*)h(recvbuf,)f(int)h(*recvcounts,)540
1357 y(int)g(*displs,)f(MPI)p 892 1357 V 15 w(Datatype)g(recvtype,)g
(MPI)p 1387 1357 V 15 w(Comm)h(comm\))249 1441 y(MPI)p
318 1441 V 15 w(ALLGATHERV\(SENDBUF)o(,)e(SENDCOUNT,)h(SENDTYPE,)g
(RECVBUF,)g(RECVCOUNTS,)540 1495 y(DISPLS,)g(RECVTYPE,)g(COMM,)h
(IERROR\))336 1549 y(<type>)g(SENDBUF\(*\),)e(RECVBUF\(*\))336
1602 y(INTEGER)i(SENDCOUNT,)e(SENDTYPE,)h(RECVCOUNTS\(*\),)f
(DISPLS\(*\),)h(RECVTYPE,)336 1656 y(COMM,)h(IERROR)291
1740 y Fw(MPI)p 368 1740 13 2 v 14 w(ALLGA)m(THERV)d
FA(can)h(b)q(e)h(though)o(t)e(of)h(as)f Fw(MPI)p 1148
1740 V 15 w(GA)m(THERV)p FA(,)f(except)j(all)e(pro)q(cesses)249
1794 y(receiv)o(e)f(the)g(result,)f(instead)h(of)e(just)h(the)g(ro)q
(ot.)25 b(The)16 b Fr(j)p FA(th)g(blo)q(c)o(k)f(of)h(data)f(sen)o(t)i
(from)d(eac)o(h)249 1848 y(pro)q(cess)e(is)f(receiv)o(ed)g(b)o(y)f(ev)o
(ery)i(pro)q(cess)g(and)e(placed)h(in)f(the)h Fr(j)p
FA(th)f(blo)q(c)o(k)g(of)g(the)h(bu\013er)g Fw(recvbuf)p
FA(.)249 1902 y(These)k(blo)q(c)o(ks)f(need)h(not)f(all)e(b)q(e)j(the)f
(same)f(size.)291 1956 y(The)g(t)o(yp)q(e)h(signature)f(asso)q(ciated)h
(with)f Fw(sendcount)i FA(and)e Fw(sendt)o(yp)q(e)j FA(at)d(pro)q(cess)
i Fr(j)e FA(m)o(ust)f(b)q(e)249 2010 y(equal)i(to)g(the)g(t)o(yp)q(e)h
(signature)f(asso)q(ciated)h(with)f Fw(recvcounts[j])i
FA(and)e Fw(recvt)o(yp)q(e)i FA(at)e(an)o(y)g(other)249
2064 y(pro)q(cess.)291 2118 y(The)20 b(outcome)f(is)h(as)g(if)f(all)f
(pro)q(cesses)23 b(executed)f(calls)d(to)h Fw(MPI)p 1362
2118 V 14 w(GA)m(THERV\()f(sendbuf,)249 2172 y(sendcount,)c(sendt)o(yp)
q(e,recvbu)q(f,recvc)q(ounts,disp)q(ls,)g(recvt)o(yp)q(e,ro)q
(ot,comm\))p FA(,)d(for)g Fw(ro)q(ot)h(=)g(0)g(,)f(...,)249
2226 y(n-1)p FA(.)26 b(The)17 b(rules)g(for)f(correct)j(usage)d(of)g
Fw(MPI)p 983 2226 V 15 w(ALLGATHERV)g FA(are)h(easily)f(found)g(from)f
(the)249 2280 y(corresp)q(onding)g(rules)f(for)g Fw(MPI)p
756 2280 V 14 w(GA)m(THERV)p FA(.)p eop
%%Page: 173 187
173 186 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(173)249 507 y FD(4.9)52 b(All)18 b(to)g(All)g(Scatter/Gather)208
686 y Fw(MPI)p 285 686 13 2 v 14 w(ALL)m(TO)o(ALL\(sendbuf,)c
(sendcount,)g(sendt)o(yp)q(e,)g(recvbuf,)g(recvcount,)g(recvt)o(yp)q
(e,)g(comm\))332 761 y Fv(IN)172 b Fw(sendbuf)401 b Fv(starting)15
b(address)f(of)e(send)i(bu\013er)332 811 y(IN)172 b Fw(sendcount)360
b Fv(n)o(um)o(b)q(er)12 b(of)f(elemen)o(ts)h(sen)o(t)g(to)f(eac)o(h)g
(pro)q(cess)332 860 y(IN)172 b Fw(sendt)o(yp)q(e)383
b Fv(data)14 b(t)o(yp)q(e)f(of)g(send)h(bu\013er)g(elemen)o(ts)332
910 y(OUT)128 b Fw(recvbuf)408 b Fv(address)14 b(of)f(receiv)o(e)h
(bu\013er)332 960 y(IN)172 b Fw(recvcount)367 b Fv(n)o(um)o(b)q(er)19
b(of)f(elemen)o(ts)h(receiv)o(ed)h(from)e(an)o(y)1079
1014 y(pro)q(cess)332 1064 y(IN)172 b Fw(recvt)o(yp)q(e)390
b Fv(data)14 b(t)o(yp)q(e)f(of)g(receiv)o(e)h(bu\013er)g(elemen)o(ts)
332 1113 y(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)249
1224 y Fr(int)21 b(MPI)p 405 1224 14 2 v 15 w(Alltoall\(void*)e
(sendbuf,)h(int)i(sendcount,)d(MPI)p 1336 1224 V 15 w(Datatype)h
(sendtype,)540 1278 y(void*)g(recvbuf,)h(int)g(recvcount,)e(MPI)p
1262 1278 V 16 w(Datatype)h(recvtype,)540 1331 y(MPI)p
609 1331 V 15 w(Comm)h(comm\))249 1415 y(MPI)p 318 1415
V 15 w(ALLTOALL\(SENDBUF,)d(SENDCOUNT,)i(SENDTYPE,)g(RECVBUF,)g
(RECVCOUNT,)540 1469 y(RECVTYPE,)g(COMM,)g(IERROR\))336
1523 y(<type>)h(SENDBUF\(*\),)e(RECVBUF\(*\))336 1577
y(INTEGER)i(SENDCOUNT,)e(SENDTYPE,)h(RECVCOUNT,)g(RECVTYPE,)g(COMM,)h
(IERROR)291 1661 y Fw(MPI)p 368 1661 13 2 v 14 w(ALL)m(TO)o(ALL)13
b FA(is)f(an)h(extension)g(of)f Fw(MPI)p 994 1661 V 14
w(ALLGA)m(THER)h FA(to)f(the)h(case)h(where)f(eac)o(h)h(pro-)249
1715 y(cess)h(sends)f(distinct)f(data)g(to)f(eac)o(h)i(of)e(the)i
(receiv)o(ers.)19 b(The)14 b Fr(j)p FA(th)e(blo)q(c)o(k)h(sen)o(t)h
(from)d(pro)q(cess)k Fr(i)249 1769 y FA(is)f(receiv)o(ed)h(b)o(y)f(pro)
q(cess)h Fr(j)f FA(and)g(is)g(placed)g(in)f(the)i Fr(i)p
FA(th)e(blo)q(c)o(k)h(of)f Fw(recvbuf)p FA(.)291 1823
y(The)18 b(t)o(yp)q(e)h(signature)g(asso)q(ciated)g(with)f
Fw(sendcount)i FA(and)f Fw(sendt)o(yp)q(e)h FA(at)e(a)g(pro)q(cess)i(m)
o(ust)249 1877 y(b)q(e)14 b(equal)g(to)f(the)h(t)o(yp)q(e)g(signature)g
(asso)q(ciated)h(with)e Fw(recvcount)j FA(and)d Fw(recvt)o(yp)q(e)j
FA(at)e(an)o(y)f(other)249 1931 y(pro)q(cess.)25 b(This)16
b(implies)e(that)h(the)i(amoun)o(t)c(of)i(data)h(sen)o(t)g(m)o(ust)f(b)
q(e)h(equal)f(to)h(the)g(amoun)o(t)249 1985 y(of)e(data)g(receiv)o(ed,)
i(pairwise)f(b)q(et)o(w)o(een)h(ev)o(ery)f(pair)g(of)f(pro)q(cesses.)23
b(As)15 b(usual,)f(ho)o(w)o(ev)o(er,)h(the)249 2039 y(t)o(yp)q(e)f
(maps)f(ma)o(y)f(b)q(e)j(di\013eren)o(t.)291 2093 y(The)c(outcome)f(is)
h(as)g(if)f(eac)o(h)h(pro)q(cess)i(executed)f(a)f(send)h(to)e(eac)o(h)i
(pro)q(cess)g(\(itself)f(included\))249 2147 y(with)g(a)g(call)f(to,)h
Fw(MPI)p 583 2147 V 15 w(Send\(sendbuf+i)p Ft(\001)p
Fw(sen)q(dc)q(ount)p Ft(\001)p Fw(exte)q(nt\(se)q(nd)q(t)o(yp)q(e)q
(\),)j(sendcount,)g(sendt)o(yp)q(e,)249 2201 y(i,)j(...\))p
FA(,)e(and)h(a)g(receiv)o(e)i(from)d(ev)o(ery)i(other)g(pro)q(cess)h
(with)e(a)g(call)g(to,)h Fw(MPI)p 1453 2201 V 14 w(Recv\(recvbuf+i)p
Ft(\001)249 2255 y Fw(recvcount)p Ft(\001)p Fw(extent\()q(rec)q(vt)o
(yp)q(e)q(\),)f(recvcount,)g(i,...\))p FA(,)c(where)j
Fw(i)e(=)h(0,)g Ft(\001)7 b(\001)g(\001)n Fw(,)13 b(n)i(-)e(1)p
FA(.)291 2309 y(All)g(argumen)o(ts)h(on)g(all)f(pro)q(cesses)k(are)e
(signi\014can)o(t.)j(The)d(argumen)o(t)e Fw(comm)g FA(m)o(ust)g(repre-)
249 2363 y(sen)o(t)i(the)f(same)f(in)o(tragroup)h(comm)o(uni)o(cation)d
(domain)h(on)h(all)g(pro)q(cesses.)249 2454 y FB(R)n(ationale.)75
b FA(The)20 b(de\014nition)g(of)f Fw(MPI)p 920 2454 V
15 w(ALL)m(TO)o(ALL)h FA(giv)o(es)g(as)g(m)o(uc)o(h)f(\015exibilit)o(y)
g(as)h(one)249 2508 y(w)o(ould)13 b(ac)o(hiev)o(e)g(b)o(y)h(sp)q
(ecifying)f(at)g(eac)o(h)h(pro)q(cess)i Fr(n)d FA(indep)q(enden)o(t,)h
(p)q(oin)o(t-to-p)q(oin)o(t)e(comm)o(u-)p eop
%%Page: 174 188
174 187 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(174)1256 b(Chapter)13 b(4)249
507 y FA(nications,)h(with)g(t)o(w)o(o)g(exceptions:)20
b(all)13 b(messages)i(use)g(the)g(same)f(datat)o(yp)q(e,)g(and)g
(messages)249 561 y(are)g(scattered)i(from)c(\(or)i(gathered)h(to\))f
(sequen)o(tial)g(storage.)k(\()p FB(End)e(of)f(r)n(ationale.)p
FA(\))249 650 y Fs(4.9.1)48 b(All)14 b(to)i(All:)k(V)l(ector)15
b(V)l(arian)o(t)208 804 y Fw(MPI)p 285 804 13 2 v 14
w(ALL)m(TO)o(ALL)-5 b(V\(sendbuf,)23 b(sendcounts,)f(sdispls,)f(sendt)o
(yp)q(e,)i(recvbuf,)f(recvcounts,)g(rdispls,)249 858
y(recvt)o(yp)q(e,)16 b(comm\))332 933 y Fv(IN)172 b Fw(sendbuf)401
b Fv(starting)15 b(address)f(of)e(send)i(bu\013er)332
980 y(IN)172 b Fw(sendcounts)344 b Fv(in)o(teger)14 b(arra)o(y)332
1028 y(IN)172 b Fw(sdispls)422 b Fv(in)o(teger)14 b(arra)o(y)g(of)e
(send)i(displacemen)o(ts)332 1075 y(IN)172 b Fw(sendt)o(yp)q(e)383
b Fv(data)14 b(t)o(yp)q(e)f(of)g(send)h(bu\013er)g(elemen)o(ts)332
1123 y(OUT)128 b Fw(recvbuf)408 b Fv(address)14 b(of)f(receiv)o(e)h
(bu\013er)332 1170 y(IN)172 b Fw(recvcounts)351 b Fv(in)o(teger)14
b(arra)o(y)332 1218 y(IN)172 b Fw(rdispls)424 b Fv(in)o(teger)14
b(arra)o(y)g(of)e(receiv)o(e)i(displacemen)o(ts)332 1265
y(IN)172 b Fw(recvt)o(yp)q(e)390 b Fv(data)14 b(t)o(yp)q(e)f(of)g
(receiv)o(e)h(bu\013er)g(elemen)o(ts)332 1313 y(IN)172
b Fw(comm)425 b Fv(comm)o(unicator)249 1423 y Fr(int)21
b(MPI)p 405 1423 14 2 v 15 w(Alltoallv\(void*)e(sendbuf,)h(int)h
(*sendcounts,)f(int)h(*sdispls,)540 1477 y(MPI)p 609
1477 V 15 w(Datatype)f(sendtype,)g(void*)h(recvbuf,)f(int)h
(*recvcounts,)540 1531 y(int)g(*rdispls,)f(MPI)p 914
1531 V 15 w(Datatype)g(recvtype,)g(MPI)p 1409 1531 V
15 w(Comm)h(comm\))249 1615 y(MPI)p 318 1615 V 15 w
(ALLTOALLV\(SENDBUF,)d(SENDCOUNTS,)i(SDISPLS,)g(SENDTYPE,)g(RECVBUF,)
540 1669 y(RECVCOUNTS,)f(RDISPLS,)h(RECVTYPE,)g(COMM,)h(IERROR\))336
1723 y(<type>)g(SENDBUF\(*\),)e(RECVBUF\(*\))336 1777
y(INTEGER)i(SENDCOUNTS\(*\),)d(SDISPLS\(*\),)i(SENDTYPE,)g
(RECVCOUNTS\(*\),)336 1831 y(RDISPLS\(*\),)g(RECVTYPE,)g(COMM,)g
(IERROR)291 1914 y Fw(MPI)p 368 1914 13 2 v 14 w(ALL)m(TO)o(ALL)-5
b(V)14 b FA(adds)g(\015exibilit)o(y)e(to)h Fw(MPI)p 1023
1914 V 15 w(ALL)m(TO)o(ALL)h FA(in)f(that)h(the)g(lo)q(cation)f(of)g
(data)249 1968 y(for)g(the)h(send)g(is)f(sp)q(eci\014ed)i(b)o(y)e
Fw(sdispls)h FA(and)f(the)h(lo)q(cation)e(of)h(the)h(placemen)o(t)e(of)
h(the)h(data)f(on)249 2022 y(the)i(receiv)o(e)g(side)f(is)g(sp)q
(eci\014ed)h(b)o(y)f Fw(rdispls)p FA(.)291 2076 y(The)h
Fr(j)p FA(th)g(blo)q(c)o(k)g(sen)o(t)h(from)e(pro)q(cess)j
Fr(i)e FA(is)g(receiv)o(ed)h(b)o(y)f(pro)q(cess)i Fr(j)e
FA(and)g(is)h(placed)f(in)g(the)249 2130 y Fr(i)p FA(th)f(blo)q(c)o(k)f
(of)h Fw(recvbuf)p FA(.)20 b(These)15 b(blo)q(c)o(ks)f(need)g(not)g
(all)f(ha)o(v)o(e)h(the)g(same)f(size.)291 2184 y(The)h(t)o(yp)q(e)g
(signature)g(asso)q(ciated)h(with)e Fw(sendcount[j])j
FA(and)28 b Fw(sendt)o(yp)q(e)16 b FA(at)d(pro)q(cess)j
Fr(i)d FA(m)o(ust)249 2238 y(b)q(e)i(equal)f(to)g(the)h(t)o(yp)q(e)g
(signature)f(asso)q(ciated)h(with)f Fw(recvcount[i])j
FA(and)d Fw(recvt)o(yp)q(e)i FA(at)f(pro)q(cess)249 2292
y Fr(j)p FA(.)j(This)13 b(implies)f(that)i(the)g(amoun)o(t)e(of)h(data)
g(sen)o(t)h(m)o(ust)f(b)q(e)h(equal)f(to)h(the)g(amoun)o(t)e(of)h(data)
249 2346 y(receiv)o(ed,)21 b(pairwise)d(b)q(et)o(w)o(een)i(ev)o(ery)f
(pair)f(of)g(pro)q(cesses.)34 b(Distinct)19 b(t)o(yp)q(e)g(maps)e(b)q
(et)o(w)o(een)249 2400 y(sender)f(and)d(receiv)o(er)j(are)e(still)f
(allo)o(w)o(ed.)291 2454 y(The)j(outcome)g(is)g(as)h(if)f(eac)o(h)h
(pro)q(cess)h(sen)o(t)f(a)f(message)h(to)f(pro)q(cess)i
Fr(i)e FA(with)h Fw(MPI)p 1631 2454 V 14 w(Send\()249
2508 y(sendbuf)j(+)f(displs[i])p Ft(\001)p Fw(extent\(sendt)o(yp)q(e)q
(\),)j(sendcounts[i],)f(sendt)o(yp)q(e,)h(i,)d(...\))p
FA(,)f(and)g(receiv)o(ed)i(a)p eop
%%Page: 175 189
175 188 bop 2 223 2 150 v 2 76 150 2 v 1928 76 V 2076
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(175)249 507 y FA(message)12 b(from)e(pro)q(cess)j Fr(i)f
FA(with)f(a)h(call)f(to)g Fw(MPI)p 1003 507 13 2 v 15
w(Recv\()h(recvbuf)i(+)e(displs[i])p Ft(\001)p Fw(extent\(recvt)o(yp)q
(e)q(\),)249 561 y(recvcounts[i],)k(recvt)o(yp)q(e,)f(i,)e(...\))p
FA(,)g(where)i Fw(i)e(=)h(0)g Ft(\001)7 b(\001)g(\001)12
b Fw(n)j(-)e(1)p FA(.)291 615 y(All)e(argumen)o(ts)i(on)f(all)g(pro)q
(cesses)j(are)e(signi\014can)o(t.)k(The)d(argumen)o(t)d
Fw(comm)g FA(m)o(ust)h(sp)q(ecify)249 669 y(the)j(same)e(in)o(tragroup)
g(comm)o(unicatio)o(n)e(domain)h(on)i(all)e(pro)q(cesses.)249
760 y FB(R)n(ationale.)65 b FA(The)19 b(de\014nition)g(of)f
Fw(MPI)p 907 760 V 14 w(ALL)m(TO)o(ALL)-5 b(V)19 b FA(giv)o(es)f(as)h
(m)o(uc)o(h)e(\015exibilit)o(y)h(as)g(one)249 814 y(w)o(ould)13
b(ac)o(hiev)o(e)g(b)o(y)h(sp)q(ecifying)f(at)g(eac)o(h)h(pro)q(cess)i
Fr(n)d FA(indep)q(enden)o(t,)h(p)q(oin)o(t-to-p)q(oin)o(t)e(comm)o(u-)
249 868 y(nications,)18 b(with)g(the)g(exception)h(that)f(all)f
(messages)g(use)i(the)g(same)e(datat)o(yp)q(e.)30 b(\()p
FB(End)20 b(of)249 922 y(r)n(ationale.)p FA(\))249 1043
y FD(4.10)52 b(Global)19 b(Reduction)g(Op)q(erations)249
1151 y FA(The)13 b(functions)g(in)f(this)g(section)h(p)q(erform)f(a)g
(global)f(reduce)j(op)q(eration)e(\(suc)o(h)i(as)e(sum,)g(max,)249
1205 y(logical)k(AND,)h(etc.\))31 b(across)19 b(all)d(the)i(mem)o(b)q
(ers)f(of)g(a)g(group.)30 b(The)18 b(reduction)h(op)q(eration)249
1259 y(can)f(b)q(e)h(either)g(one)f(of)g(a)f(prede\014ned)j(list)e(of)f
(op)q(erations,)i(or)f(a)g(user-de\014ned)i(op)q(eration.)249
1313 y(The)d(global)d(reduction)j(functions)f(come)f(in)h(sev)o(eral)g
(\015a)o(v)o(ors:)23 b(a)15 b(reduce)j(that)e(returns)i(the)249
1367 y(result)h(of)f(the)h(reduction)g(at)g(one)f(no)q(de,)i(an)e
(all-reduce)h(that)g(returns)h(this)e(result)h(at)g(all)249
1421 y(no)q(des,)11 b(and)e(a)h(scan)g(\(parallel)f(pre\014x\))h(op)q
(eration.)17 b(In)9 b(addition,)g(a)h(reduce-scatter)j(op)q(eration)249
1474 y(com)o(bines)19 b(the)h(functionalit)o(y)f(of)g(a)g(reduce)j(and)
d(of)h(a)f(scatter)j(op)q(eration.)35 b(In)20 b(order)h(to)249
1528 y(impro)o(v)o(e)13 b(p)q(erformance,)h(the)g(functions)h(can)g(b)q
(e)f(passed)i(an)e(arra)o(y)g(of)g(v)n(alues;)g(one)g(call)g(will)249
1582 y(p)q(erform)e(a)h(sequence)j(of)d(elemen)o(t-wise)f(reductions)j
(on)e(the)h(arra)o(ys)f(of)g(v)n(alues.)k(Figure)d(4.10)249
1636 y(giv)o(es)g(a)f(pictorial)g(represen)o(tation)j(of)d(these)i(op)q
(erations.)249 1719 y Fs(4.10.1)48 b(Reduce)208 1873
y Fw(MPI)p 285 1873 V 14 w(REDUCE\()12 b(sendbuf,)j(recvbuf,)h(count,)e
(datat)o(yp)q(e,)h(op,)e(ro)q(ot,)h(comm\))332 1948 y
Fv(IN)172 b Fw(sendbuf)401 b Fv(address)14 b(of)f(send)h(bu\013er)332
1998 y(OUT)128 b Fw(recvbuf)408 b Fv(address)14 b(of)f(receiv)o(e)h
(bu\013er)332 2048 y(IN)172 b Fw(count)436 b Fv(n)o(um)o(b)q(er)14
b(of)f(elemen)o(ts)h(in)g(send)f(bu\013er)332 2097 y(IN)172
b Fw(datat)o(yp)q(e)383 b Fv(data)14 b(t)o(yp)q(e)f(of)g(elemen)o(ts)h
(of)f(send)g(bu\013er)332 2147 y(IN)172 b Fw(op)490 b
Fv(reduce)14 b(op)q(eration)332 2197 y(IN)172 b Fw(ro)q(ot)460
b Fv(rank)14 b(of)f(ro)q(ot)g(pro)q(cess)332 2247 y(IN)172
b Fw(comm)425 b Fv(comm)o(unicator)249 2357 y Fr(int)21
b(MPI)p 405 2357 14 2 v 15 w(Reduce\(void*)f(sendbuf,)g(void*)h
(recvbuf,)f(int)h(count,)540 2411 y(MPI)p 609 2411 V
15 w(Datatype)f(datatype,)g(MPI)p 1104 2411 V 15 w(Op)h(op,)g(int)h
(root,)540 2465 y(MPI)p 609 2465 V 15 w(Comm)f(comm\))p
eop
%%Page: 176 190
176 189 bop 2 223 2 150 v 2 76 150 2 v 1928 76 V 2076
225 2 150 v 249 251 a Fv(176)1256 b(Chapter)13 b(4)340
466 y
 20934380 30785863 0 0 41047818 59927183 startTexFig
 340 466 a
%%BeginDocument: ../figures/coll-reduce.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-6.0 936.0 translate 0.900 -0.900 scale
1.000 setlinewidth
% Polyline
n 219 179 m 219 119 l  159 119 l  159 179 l  clp gs col-1 s gr
% Polyline
n 219 119 m 219 59 l  159 59 l  159 119 l  clp gs col-1 s gr
% Polyline
n 219 239 m 219 179 l  159 179 l  159 239 l  clp gs col-1 s gr
% Polyline
n 159 239 m 159 179 l  99 179 l  99 239 l  clp gs col-1 s gr
% Polyline
n 99 239 m 99 179 l  39 179 l  39 239 l  clp gs col-1 s gr
% Polyline
n 99 179 m 99 119 l  39 119 l  39 179 l  clp gs col-1 s gr
% Polyline
n 159 179 m 159 119 l  99 119 l  99 179 l  clp gs col-1 s gr
% Polyline
n 159 119 m 159 59 l  99 59 l  99 119 l  clp gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
59 99 m 
gs 1 -1 scale (A0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 99 m 
gs 1 -1 scale (B0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
179 99 m 
gs 1 -1 scale (C0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 159 m 
gs 1 -1 scale (A1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 159 m 
gs 1 -1 scale (B1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
179 159 m 
gs 1 -1 scale (C1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 219 m 
gs 1 -1 scale (A2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 219 m 
gs 1 -1 scale (B2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
179 219 m 
gs 1 -1 scale (C2) col-1 show gr
% Polyline
n 99 379 m 99 319 l  39 319 l  39 379 l  clp gs col-1 s gr
% Polyline
n 219 439 m 219 379 l  159 379 l  159 439 l  clp gs col-1 s gr
% Polyline
n 219 379 m 219 319 l  159 319 l  159 379 l  clp gs col-1 s gr
% Polyline
n 219 499 m 219 439 l  159 439 l  159 499 l  clp gs col-1 s gr
% Polyline
n 159 499 m 159 439 l  99 439 l  99 499 l  clp gs col-1 s gr
% Polyline
n 99 499 m 99 439 l  39 439 l  39 499 l  clp gs col-1 s gr
% Polyline
n 99 439 m 99 379 l  39 379 l  39 439 l  clp gs col-1 s gr
% Polyline
n 159 439 m 159 379 l  99 379 l  99 439 l  clp gs col-1 s gr
% Polyline
n 159 379 m 159 319 l  99 319 l  99 379 l  clp gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
59 359 m 
gs 1 -1 scale (A0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 359 m 
gs 1 -1 scale (B0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
179 359 m 
gs 1 -1 scale (C0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 419 m 
gs 1 -1 scale (A1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 419 m 
gs 1 -1 scale (B1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
179 419 m 
gs 1 -1 scale (C1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 479 m 
gs 1 -1 scale (A2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 479 m 
gs 1 -1 scale (B2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
179 479 m 
gs 1 -1 scale (C2) col-1 show gr
% Polyline
n 99 639 m 99 579 l  39 579 l  39 639 l  clp gs col-1 s gr
% Polyline
n 219 699 m 219 639 l  159 639 l  159 699 l  clp gs col-1 s gr
% Polyline
n 219 639 m 219 579 l  159 579 l  159 639 l  clp gs col-1 s gr
% Polyline
n 219 759 m 219 699 l  159 699 l  159 759 l  clp gs col-1 s gr
% Polyline
n 159 759 m 159 699 l  99 699 l  99 759 l  clp gs col-1 s gr
% Polyline
n 99 759 m 99 699 l  39 699 l  39 759 l  clp gs col-1 s gr
% Polyline
n 99 699 m 99 639 l  39 639 l  39 699 l  clp gs col-1 s gr
% Polyline
n 159 699 m 159 639 l  99 639 l  99 699 l  clp gs col-1 s gr
% Polyline
n 159 639 m 159 579 l  99 579 l  99 639 l  clp gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
59 619 m 
gs 1 -1 scale (A0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 619 m 
gs 1 -1 scale (B0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
179 619 m 
gs 1 -1 scale (C0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 679 m 
gs 1 -1 scale (A1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 679 m 
gs 1 -1 scale (B1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
179 679 m 
gs 1 -1 scale (C1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 739 m 
gs 1 -1 scale (A2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 739 m 
gs 1 -1 scale (B2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
179 739 m 
gs 1 -1 scale (C2) col-1 show gr
% Polyline
n 99 919 m 99 859 l  39 859 l  39 919 l  clp gs col-1 s gr
% Polyline
n 219 979 m 219 919 l  159 919 l  159 979 l  clp gs col-1 s gr
% Polyline
n 219 919 m 219 859 l  159 859 l  159 919 l  clp gs col-1 s gr
% Polyline
n 219 1039 m 219 979 l  159 979 l  159 1039 l  clp gs col-1 s gr
% Polyline
n 159 1039 m 159 979 l  99 979 l  99 1039 l  clp gs col-1 s gr
% Polyline
n 99 1039 m 99 979 l  39 979 l  39 1039 l  clp gs col-1 s gr
% Polyline
n 99 979 m 99 919 l  39 919 l  39 979 l  clp gs col-1 s gr
% Polyline
n 159 979 m 159 919 l  99 919 l  99 979 l  clp gs col-1 s gr
% Polyline
n 159 919 m 159 859 l  99 859 l  99 919 l  clp gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
59 899 m 
gs 1 -1 scale (A0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 899 m 
gs 1 -1 scale (B0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
179 899 m 
gs 1 -1 scale (C0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 959 m 
gs 1 -1 scale (A1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 959 m 
gs 1 -1 scale (B1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
179 959 m 
gs 1 -1 scale (C1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 1019 m 
gs 1 -1 scale (A2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 1019 m 
gs 1 -1 scale (B2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
179 1019 m 
gs 1 -1 scale (C2) col-1 show gr
% Polyline
n 259 149 m 319 149 l  319 139 l  354 159 l  319 179 l  319 169 l 
 259 169 l gs col-1 s gr
% Polyline
n 259 149 m 259 149 l  259 169 l gs col-1 s gr
% Polyline
n 99 119 m 99 59 l  39 59 l  39 119 l  clp gs col-1 s gr
0.500 setlinewidth
% Polyline
n 599 179 m 599 119 l  499 119 l  499 179 l  clp gs col-1 s gr
/Times-Roman findfont 20.00 scalefont setfont
269 934 m 
gs 1 -1 scale (scan) col-1 show gr
1.000 setlinewidth
% Polyline
n 89 44 m 154 44 l gs col-1 s gr
n 138.000 40.000 m 154.000 44.000 l 138.000 48.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 24 149 m 24 214 l gs col-1 s gr
n 28.000 198.000 m 24.000 214.000 l 20.000 198.000 l gs 2 setlinejoin col-1 s gr
0.500 setlinewidth
% Polyline
n 599 439 m 599 379 l  499 379 l  499 439 l  clp gs col-1 s gr
1.000 setlinewidth
% Polyline
n 499 119 m 499 59 l  399 59 l  399 119 l  clp gs col-1 s gr
% Polyline
n 499 239 m 499 179 l  399 179 l  399 239 l  clp gs col-1 s gr
% Polyline
n 499 179 m 499 119 l  399 119 l  399 179 l  clp gs col-1 s gr
% Polyline
n 599 119 m 599 59 l  499 59 l  499 119 l  clp gs col-1 s gr
% Polyline
n 699 119 m 699 59 l  599 59 l  599 119 l  clp gs col-1 s gr
% Polyline
n 599 239 m 599 179 l  499 179 l  499 239 l  clp gs col-1 s gr
% Polyline
n 699 179 m 699 119 l  599 119 l  599 179 l  clp gs col-1 s gr
% Polyline
n 699 239 m 699 179 l  599 179 l  599 239 l  clp gs col-1 s gr
% Polyline
n 699 379 m 699 319 l  599 319 l  599 379 l  clp gs col-1 s gr
% Polyline
n 599 379 m 599 319 l  499 319 l  499 379 l  clp gs col-1 s gr
% Polyline
n 499 379 m 499 319 l  399 319 l  399 379 l  clp gs col-1 s gr
% Polyline
n 499 499 m 499 439 l  399 439 l  399 499 l  clp gs col-1 s gr
% Polyline
n 499 439 m 499 379 l  399 379 l  399 439 l  clp gs col-1 s gr
% Polyline
n 599 499 m 599 439 l  499 439 l  499 499 l  clp gs col-1 s gr
% Polyline
n 699 439 m 699 379 l  599 379 l  599 439 l  clp gs col-1 s gr
% Polyline
n 699 499 m 699 439 l  599 439 l  599 499 l  clp gs col-1 s gr
% Polyline
n 499 639 m 499 579 l  399 579 l  399 639 l  clp gs col-1 s gr
% Polyline
n 599 699 m 599 639 l  499 639 l  499 699 l  clp gs col-1 s gr
% Polyline
n 599 759 m 599 699 l  499 699 l  499 759 l  clp gs col-1 s gr
% Polyline
n 599 639 m 599 579 l  499 579 l  499 639 l  clp gs col-1 s gr
% Polyline
n 699 639 m 699 579 l  599 579 l  599 639 l  clp gs col-1 s gr
% Polyline
n 699 759 m 699 699 l  599 699 l  599 759 l  clp gs col-1 s gr
% Polyline
n 699 699 m 699 639 l  599 639 l  599 699 l  clp gs col-1 s gr
% Polyline
n 499 919 m 499 859 l  399 859 l  399 919 l  clp gs col-1 s gr
% Polyline
n 499 1039 m 499 979 l  399 979 l  399 1039 l  clp gs col-1 s gr
% Polyline
n 599 979 m 599 919 l  499 919 l  499 979 l  clp gs col-1 s gr
% Polyline
n 599 919 m 599 859 l  499 859 l  499 919 l  clp gs col-1 s gr
% Polyline
n 699 919 m 699 859 l  599 859 l  599 919 l  clp gs col-1 s gr
% Polyline
n 699 979 m 699 919 l  599 919 l  599 979 l  clp gs col-1 s gr
% Polyline
n 699 1039 m 699 979 l  599 979 l  599 1039 l  clp gs col-1 s gr
% Polyline
n 599 1039 m 599 979 l  499 979 l  499 1039 l  clp gs col-1 s gr
% Polyline
n 259 949 m 259 949 l  259 969 l gs col-1 s gr
% Polyline
n 259 949 m 319 949 l  319 939 l  354 959 l  319 979 l  319 969 l 
 259 969 l gs col-1 s gr
% Polyline
n 259 669 m 319 669 l  319 659 l  354 679 l  319 699 l  319 689 l 
 259 689 l gs col-1 s gr
% Polyline
n 259 669 m 259 669 l  259 689 l gs col-1 s gr
% Polyline
n 259 409 m 319 409 l  319 399 l  354 419 l  319 439 l  319 429 l 
 259 429 l gs col-1 s gr
% Polyline
n 259 409 m 259 409 l  259 429 l gs col-1 s gr
% Polyline
n 499 699 m 499 639 l  399 639 l  399 699 l  clp gs col-1 s gr
% Polyline
n 499 759 m 499 699 l  399 699 l  399 759 l  clp gs col-1 s gr
% Polyline
n 499 979 m 499 919 l  399 919 l  399 979 l  clp gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
404 99 m 
gs 1 -1 scale (A0+A1+A2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
404 619 m 
gs 1 -1 scale (A0+A1+A2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
404 679 m 
gs 1 -1 scale (B0+B1+B2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
409 739 m 
gs 1 -1 scale (C0+C1+C2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
404 359 m 
gs 1 -1 scale (A0+A1+A2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
509 359 m 
gs 1 -1 scale (B0+B1+B2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
609 359 m 
gs 1 -1 scale (C0+C1+C2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
404 419 m 
gs 1 -1 scale (A0+A1+A2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
509 419 m 
gs 1 -1 scale (B0+B1+B2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
609 419 m 
gs 1 -1 scale (C0+C1+C2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
404 479 m 
gs 1 -1 scale (A0+A1+A2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
509 479 m 
gs 1 -1 scale (B0+B1+B2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
609 479 m 
gs 1 -1 scale (C0+C1+C2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
509 99 m 
gs 1 -1 scale (B0+B1+B2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
609 99 m 
gs 1 -1 scale (C0+C1+C2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
404 1019 m 
gs 1 -1 scale (A0+A1+A2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
509 1019 m 
gs 1 -1 scale (B0+B1+B2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
609 1019 m 
gs 1 -1 scale (C0+C1+C2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
404 899 m 
gs 1 -1 scale (A0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
404 959 m 
gs 1 -1 scale (A0+A1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
509 899 m 
gs 1 -1 scale (B0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
509 959 m 
gs 1 -1 scale (B0+B1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
609 899 m 
gs 1 -1 scale (C0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
609 959 m 
gs 1 -1 scale (C0+C1) col-1 show gr
/Times-Roman findfont 20.00 scalefont setfont
29 134 m 
gs 1 -1 scale  90.0 rotate (processes) col-1 show gr
/Times-Roman findfont 20.00 scalefont setfont
49 49 m 
gs 1 -1 scale (data) col-1 show gr
/Times-Roman findfont 20.00 scalefont setfont
269 134 m 
gs 1 -1 scale (reduce) col-1 show gr
/Times-Roman findfont 20.00 scalefont setfont
269 394 m 
gs 1 -1 scale (allreduce) col-1 show gr
/Times-Roman findfont 20.00 scalefont setfont
254 654 m 
gs 1 -1 scale (reduce-scatter) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 2478 a Fo(Figure)g(4.10)249 2515 y Fz(Reduce)d(functions)f
(illustrated)g(for)i(a)g(group)f(of)h(three)g(pro)q(cesses.)i(In)e(eac)
o(h)f(case,)h(eac)o(h)f(ro)o(w)i(of)f(b)q(o)o(xes)249
2553 y(represen)o(ts)e(data)i(items)f(in)h(one)g(pro)q(cess.)i(Th)o
(us,)f(in)f(the)f(reduce,)g(initially)f(eac)o(h)i(pro)q(cess)f(has)h
(three)f(items;)249 2590 y(after)g(the)h(reduce)f(the)h(ro)q(ot)f(pro)q
(cess)g(has)h(three)f(sums.)p eop
%%Page: 177 191
177 190 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(177)249 507 y Fr(MPI)p 318 507 14 2 v 15 w(REDUCE\(SENDBUF,)19
b(RECVBUF,)h(COUNT,)h(DATATYPE,)e(OP,)j(ROOT,)e(COMM,)540
561 y(IERROR\))336 615 y(<type>)h(SENDBUF\(*\),)e(RECVBUF\(*\))336
669 y(INTEGER)i(COUNT,)f(DATATYPE,)g(OP,)h(ROOT,)g(COMM,)g(IERROR)291
753 y Fw(MPI)p 368 753 13 2 v 14 w(REDUCE)15 b FA(com)o(bines)h(the)i
(elemen)o(ts)e(pro)o(vided)h(in)g(the)g(input)g(bu\013er)h(of)e(eac)o
(h)i(pro-)249 807 y(cess)g(in)e(the)g(group,)h(using)f(the)g(op)q
(eration)g Fw(op)p FA(,)h(and)f(returns)i(the)f(com)o(bined)d(v)n(alue)
i(in)g(the)249 861 y(output)e(bu\013er)i(of)d(the)i(pro)q(cess)h(with)e
(rank)g Fw(ro)q(ot)p FA(.)k(The)d(input)f(bu\013er)h(is)f(de\014ned)h
(b)o(y)f(the)h(ar-)249 915 y(gumen)o(ts)c Fw(sendbuf)p
FA(,)i Fw(count)g FA(and)f Fw(datat)o(yp)q(e)p FA(;)h(the)f(output)g
(bu\013er)h(is)f(de\014ned)g(b)o(y)g(the)g(argumen)o(ts)249
969 y Fw(recvbuf)p FA(,)h Fw(count)g FA(and)e Fw(datat)o(yp)q(e)p
FA(;)i(b)q(oth)f(ha)o(v)o(e)f(the)h(same)f(n)o(um)o(b)q(er)g(of)g
(elemen)o(ts,)g(with)g(the)h(same)249 1023 y(t)o(yp)q(e.)18
b(The)12 b(argumen)o(ts)g Fw(count,)h(op)f FA(and)g Fw(ro)q(ot)g
FA(m)o(ust)f(ha)o(v)o(e)g(iden)o(tical)h(v)n(alues)g(at)f(all)g(pro)q
(cesses,)249 1077 y(the)k Fw(datat)o(yp)q(e)g FA(argumen)o(ts)e(should)
h(matc)o(h,)e(and)i Fw(comm)e FA(should)i(represen)o(t)i(the)f(same)e
(in)o(tra-)249 1131 y(group)e(comm)o(unicatio)o(n)d(domain.)15
b(Th)o(us,)c(all)f(pro)q(cesses)k(pro)o(vide)c(input)h(bu\013ers)h(and)
f(output)249 1185 y(bu\013ers)g(of)e(the)h(same)f(length,)h(with)f
(elemen)o(ts)h(of)e(the)j(same)d(t)o(yp)q(e.)17 b(Eac)o(h)10
b(pro)q(cess)i(can)e(pro)o(vide)249 1239 y(one)j(elemen)o(t,)e(or)h(a)g
(sequence)j(of)c(elemen)o(ts,)h(in)g(whic)o(h)g(case)i(the)f(com)o
(bine)e(op)q(eration)h(is)g(exe-)249 1293 y(cuted)j(elemen)o(t-wise)f
(on)f(eac)o(h)i(en)o(try)f(of)f(the)i(sequence.)20 b(F)m(or)13
b(example,)f(if)h(the)i(op)q(eration)f(is)249 1347 y
Fq(MPI)p 321 1347 12 2 v 13 w(MAX)c FA(and)g(the)i(send)g(bu\013er)g
(con)o(tains)f(t)o(w)o(o)f(elemen)o(ts)h(that)g(are)g(\015oating)f(p)q
(oin)o(t)h(n)o(um)o(b)q(ers)249 1401 y(\()p Fw(count)16
b FA(=)f(2)f(and)g Fw(datat)o(yp)q(e)i FA(=)f Fq(MPI)p
824 1401 V 12 w(FLO)o(A)m(T)p FA(\),)f(then)i Fw(recvbuf)s
FA(\()p Fw(0)p FA(\))e(=)f(global)7 b(max)l(\()p Fw(sendbuf)s
FA(\()p Fw(0)p FA(\)\))249 1455 y(and)14 b Fw(recvbuf)s
FA(\()p Fw(1)p FA(\))f(=)f(global)7 b(max)l(\()p Fw(sendbuf)s
FA(\()p Fw(1)p FA(\)\).)291 1509 y(Section)j(4.10.2)f(lists)h(the)h
(set)h(of)e(prede\014ned)i(op)q(erations)f(pro)o(vided)f(b)o(y)g
Fw(MPI)p FA(.)f(That)i(section)249 1563 y(also)k(en)o(umerates)g(the)h
(allo)o(w)o(ed)e(datat)o(yp)q(es)i(for)e(eac)o(h)i(op)q(eration.)22
b(In)15 b(addition,)f(users)i(ma)o(y)249 1617 y(de\014ne)d(their)f(o)o
(wn)g(op)q(erations)g(that)g(can)g(b)q(e)g(o)o(v)o(erloaded)g(to)f(op)q
(erate)i(on)f(sev)o(eral)g(datat)o(yp)q(es,)249 1671
y(either)j(basic)f(or)g(deriv)o(ed.)k(This)c(is)g(further)g(explained)g
(in)g(Section)g(4.12.)291 1724 y(The)g(op)q(eration)f
Fw(op)h FA(is)f(alw)o(a)o(ys)g(assumed)g(to)h(b)q(e)g(asso)q(ciativ)o
(e.)k(All)13 b(prede\014ned)i(op)q(erations)249 1778
y(are)i(also)e(comm)o(utativ)o(e.)22 b(Users)c(ma)o(y)c(de\014ne)j(op)q
(erations)g(that)f(are)h(assumed)f(to)g(b)q(e)g(asso-)249
1832 y(ciativ)o(e,)f(but)i(not)e(comm)o(utativ)o(e.)21
b(The)c(\\canonical")d(ev)n(aluation)h(order)h(of)f(a)h(reduction)h(is)
249 1886 y(determined)g(b)o(y)g(the)h(ranks)f(of)f(the)i(pro)q(cesses)i
(in)c(the)i(group.)27 b(Ho)o(w)o(ev)o(er,)18 b(the)f(implemen-)249
1940 y(tation)g(can)g(tak)o(e)g(adv)n(an)o(tage)f(of)h(asso)q(ciativit)
o(y)m(,)f(or)h(asso)q(ciativit)o(y)g(and)g(comm)o(utati)o(vit)o(y)d(in)
249 1994 y(order)d(to)g(c)o(hange)g(the)g(order)g(of)f(ev)n(aluation.)
16 b(This)10 b(ma)o(y)f(c)o(hange)i(the)g(result)g(of)f(the)i
(reduction)249 2048 y(for)k(op)q(erations)g(that)h(are)f(not)g
(strictly)h(asso)q(ciativ)o(e)f(and)g(comm)o(utativ)o(e,)d(suc)o(h)k
(as)f(\015oating)249 2102 y(p)q(oin)o(t)d(addition.)249
2194 y FB(A)n(dvic)n(e)k(to)g(implementors.)51 b FA(It)17
b(is)f(strongly)g(recommended)g(that)g Fw(MPI)p 1434
2194 13 2 v 15 w(REDUCE)e FA(b)q(e)k(im-)249 2248 y(plemen)o(ted)f(so)h
(that)g(the)g(same)f(result)i(b)q(e)f(obtained)g(whenev)o(er)h(the)f
(function)f(is)h(applied)249 2301 y(on)c(the)i(same)d(argumen)o(ts,)h
(app)q(earing)g(in)g(the)h(same)f(order.)21 b(Note)15
b(that)f(this)h(ma)o(y)d(prev)o(en)o(t)249 2355 y(optimizations)h(that)
j(tak)o(e)g(adv)n(an)o(tage)f(of)g(the)i(ph)o(ysical)e(lo)q(cation)g
(of)g(pro)q(cessors.)26 b(\()p FB(End)18 b(of)249 2409
y(advic)n(e)d(to)g(implementors.)p FA(\))p eop
%%Page: 178 192
178 191 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(178)1256 b(Chapter)13 b(4)291
507 y FA(The)e Fw(datat)o(yp)q(e)i FA(argumen)o(t)d(of)h
Fw(MPI)p 840 507 13 2 v 14 w(REDUCE)f FA(m)o(ust)g(b)q(e)i(compatible)d
(with)i Fw(op)p FA(.)17 b(Prede\014ned)249 561 y(op)q(erators)d(w)o
(ork)e(only)g(with)h(the)g Fw(MPI)f FA(t)o(yp)q(es)i(listed)f(in)f
(Section)h(4.10.2)e(and)i(Section)g(4.10.3.)249 615 y(User-de\014ned)20
b(op)q(erators)f(ma)o(y)d(op)q(erate)j(on)f(general,)h(deriv)o(ed)f
(datat)o(yp)q(es.)31 b(In)18 b(this)g(case,)249 669 y(eac)o(h)c
(argumen)o(t)f(that)h(the)h(reduce)g(op)q(eration)f(is)g(applied)f(to)h
(is)f(one)i(elemen)o(t)e(describ)q(ed)j(b)o(y)249 723
y(suc)o(h)e(a)g(datat)o(yp)q(e,)f(whic)o(h)h(ma)o(y)d(con)o(tain)j(sev)
o(eral)g(basic)f(v)n(alues.)18 b(This)c(is)f(further)i(explained)249
777 y(in)e(Section)i(4.12.)249 860 y Fs(4.10.2)48 b(Prede\014ned)13
b(Reduce)h(Op)q(erations)249 943 y FA(The)c(follo)o(wing)e
(prede\014ned)j(op)q(erations)f(are)g(supplied)g(for)g
Fw(MPI)p 1258 943 V 14 w(REDUCE)e FA(and)i(related)g(func-)249
997 y(tions)20 b Fw(MPI)p 434 997 V 14 w(ALLREDUCE)p
FA(,)e Fw(MPI)p 788 997 V 14 w(REDUCE)p 965 997 V 14
w(SCA)m(TTER)p FA(,)g(and)h Fw(MPI)p 1353 997 V 15 w(SCAN)p
FA(.)f(These)j(op)q(era-)249 1051 y(tions)14 b(are)g(in)o(v)o(ok)o(ed)f
(b)o(y)h(placing)f(the)h(follo)o(wing)e(in)h Fw(op)p
FA(.)291 1194 y Fq(Name)738 b FA(Meaning)291 1291 y Fq(MPI)p
363 1291 12 2 v 12 w(MAX)662 b FA(maxim)n(um)291 1339
y Fq(MPI)p 363 1339 V 12 w(MIN)676 b FA(minim)n(um)291
1387 y Fq(MPI)p 363 1387 V 12 w(SUM)667 b FA(sum)291
1436 y Fq(MPI)p 363 1436 V 12 w(PROD)642 b FA(pro)q(duct)291
1484 y Fq(MPI)p 363 1484 V 12 w(LAND)k FA(logical)12
b(and)291 1532 y Fq(MPI)p 363 1532 V 12 w(BAND)641 b
FA(bit-wise)14 b(and)291 1581 y Fq(MPI)p 363 1581 V 12
w(LOR)674 b FA(logical)12 b(or)291 1629 y Fq(MPI)p 363
1629 V 12 w(BOR)669 b FA(bit-wise)14 b(or)291 1677 y
Fq(MPI)p 363 1677 V 12 w(LX)o(OR)649 b FA(logical)12
b(xor)291 1725 y Fq(MPI)p 363 1725 V 12 w(BX)o(OR)644
b FA(bit-wise)14 b(xor)291 1774 y Fq(MPI)p 363 1774 V
12 w(MAXLOC)588 b FA(max)12 b(v)n(alue)h(and)h(lo)q(cation)291
1822 y Fq(MPI)p 363 1822 V 12 w(MINLOC)602 b FA(min)12
b(v)n(alue)h(and)h(lo)q(cation)291 1890 y(The)j(t)o(w)o(o)f(op)q
(erations)i Fq(MPI)p 738 1890 V 12 w(MINLOC)e FA(and)h
Fq(MPI)p 1066 1890 V 13 w(MAXLOC)e FA(are)j(discussed)g(separately)g
(in)249 1944 y(Section)10 b(4.10.3.)15 b(F)m(or)9 b(the)i(other)f
(prede\014ned)i(op)q(erations,)e(w)o(e)g(en)o(umerate)g(b)q(elo)o(w)f
(the)i(allo)o(w)o(ed)249 1998 y(com)o(binations)18 b(of)i
Fw(op)g FA(and)g Fw(datat)o(yp)q(e)h FA(argumen)o(ts.)36
b(First,)22 b(de\014ne)f(groups)f(of)g Fw(MPI)f FA(basic)249
2052 y(datat)o(yp)q(es)c(in)e(the)h(follo)o(wing)e(w)o(a)o(y)m(.)291
2196 y Fq(C)g(integer:)672 b(MPI)p 1193 2196 V 12 w(INT,)25
b(MPI)p 1375 2196 V 12 w(LONG,)f(MPI)p 1594 2196 V 13
w(SHORT,)1079 2250 y(MPI)p 1151 2250 V 13 w(UNSIGNED)p
1353 2250 V 14 w(SHORT,)9 b(MPI)p 1584 2250 V 13 w(UNSIGNED,)1079
2304 y(MPI)p 1151 2304 V 13 w(UNSIGNED)p 1353 2304 V
14 w(LONG)291 2352 y(F)o(o)o(rtran)k(integer:)579 b(MPI)p
1193 2352 V 12 w(INTEGER)291 2400 y(Floating)11 b(p)q(oint:)592
b(MPI)p 1193 2400 V 12 w(FLO)o(A)m(T,)9 b(MPI)p 1414
2400 V 12 w(DOUBLE,)g(MPI)p 1668 2400 V 12 w(REAL,)1079
2454 y(MPI)p 1151 2454 V 13 w(DOUBLE)p 1316 2454 V 14
w(PRECISION,)i(MPI)p 1618 2454 V 13 w(LONG-)p 1079 2508
V 1091 2508 a(DOUBLE)p eop
%%Page: 179 193
179 192 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(179)291 507 y Fq(Logical:)705 b(MPI)p 1193 507 12 2
v 12 w(LOGICAL)291 557 y(Complex:)680 b(MPI)p 1193 557
V 12 w(COMPLEX)291 606 y(Byte:)744 b(MPI)p 1193 606 V
12 w(BYTE)291 675 y FA(No)o(w,)13 b(the)h(v)n(alid)e(datat)o(yp)q(es)j
(for)e(eac)o(h)i(option)e(is)h(sp)q(eci\014ed)h(b)q(elo)o(w.)291
818 y Fq(Op)782 b FA(Allo)o(w)o(ed)13 b(T)o(yp)q(es)291
917 y Fq(MPI)p 363 917 V 12 w(MAX,)f(MPI)p 554 917 V
12 w(MIN)485 b(C)8 b(integer,)g(F)o(o)o(rtran)h(integer,)g(Floating)e
(p)q(oint)291 966 y(MPI)p 363 966 V 12 w(SUM,)13 b(MPI)p
550 966 V 13 w(PROD)454 b(C)8 b(integer,)g(F)o(o)o(rtran)h(integer,)g
(Floating)e(p)q(oint,)1079 1020 y(Complex)291 1070 y(MPI)p
363 1070 V 12 w(LAND,)12 b(MPI)p 570 1070 V 13 w(LOR,)h(MPI)p
751 1070 V 12 w(LX)o(OR)261 b(C)12 b(integer,)g(Logical)291
1119 y(MPI)p 363 1119 V 12 w(BAND,)g(MPI)p 575 1119 V
13 w(BOR,)g(MPI)p 760 1119 V 13 w(BX)o(OR)246 b(C)12
b(integer,)g(F)o(o)o(rtran)h(integer,)f(Byte)249 1227
y Fs(Example)j(4.15)21 b FA(A)15 b(routine)h(that)f(computes)g(the)h
(dot)f(pro)q(duct)i(of)d(t)o(w)o(o)h(v)o(ectors)i(that)e(are)249
1281 y(distributed)g(across)f(a)g(group)g(of)f(pro)q(cesses)k(and)c
(returns)j(the)e(answ)o(er)h(at)e(no)q(de)i(zero.)249
1335 y Fr(SUBROUTINE)20 b(PAR_BLAS1\(m,)f(a,)i(b,)h(c,)f(comm\))249
1389 y(REAL)g(a\(m\),)g(b\(m\))152 b(!)21 b(local)g(slice)g(of)g(array)
249 1443 y(REAL)g(c)349 b(!)21 b(result)g(\(at)g(node)g(zero\))249
1497 y(REAL)g(sum)249 1551 y(INTEGER)f(m,)i(comm,)f(i,)g(ierr)249
1659 y(!)h(local)e(sum)249 1713 y(sum)h(=)h(0.0)249 1767
y(DO)f(i)h(=)g(1,)f(m)314 1821 y(sum)h(=)f(sum)g(+)h(a\(i\)*b\(i\))249
1875 y(END)f(DO)249 1983 y(!)h(global)e(sum)249 2037
y(CALL)h(MPI_REDUCE\(sum,)e(c,)i(1,)g(MPI_REAL,)f(MPI_SUM,)h(0,)g
(comm,)g(ierr\))249 2091 y(RETURN)249 2238 y Fs(Example)15
b(4.16)21 b FA(A)11 b(routine)h(that)g(computes)f(the)h(pro)q(duct)h
(of)e(a)g(v)o(ector)h(and)g(an)f(arra)o(y)g(that)249
2292 y(are)18 b(distributed)f(across)h(a)f(group)g(of)f(pro)q(cesses)k
(and)d(returns)h(the)g(answ)o(er)g(at)f(no)q(de)g(zero.)249
2346 y(The)d(distribution)g(of)f(v)o(ector)i Fr(a)e FA(and)h(matrix)e
Fr(b)i FA(is)f(illustrated)h(in)g(Figure)g(4.11.)249
2400 y Fr(SUBROUTINE)20 b(PAR_BLAS2\(m,)f(n,)i(a,)h(b,)f(c,)h(comm\))
249 2454 y(REAL)f(a\(m\),)g(b\(m,n\))86 b(!)21 b(local)g(slice)g(of)g
(array)249 2508 y(REAL)g(c\(n\))261 b(!)21 b(result)p
eop
%%Page: 180 194
180 193 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(180)1256 b(Chapter)13 b(4)478
466 y
 16577003 8122730 0 0 36706222 18024202 startTexFig
 478 466 a
%%BeginDocument: ../figures/coll-blas2.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-40.0 373.0 translate 0.900 -0.900 scale
1.000 setlinewidth
n 342.000 190.000 m 338.000 198.000 l 334.000 190.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 338 198 m 338 178 l gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
343 173 m 
gs 1 -1 scale  90.0 rotate (m) col-1 show gr
% Polyline
n 469 199 m 469 139 l  349 139 l  349 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 469 259 m 469 199 l  349 199 l  349 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 469 319 m 469 259 l  349 259 l  349 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 469 379 m 469 319 l  349 319 l  349 379 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 419 124 m 469 124 l gs 0.50 setgray fill gr
gs col-1 s gr
n 461.000 120.000 m 469.000 124.000 l 461.000 128.000 l gs 2 setlinejoin col-1 s gr
n 357.000 128.000 m 349.000 124.000 l 357.000 120.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 349 124 m 399 124 l gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
404 129 m 
gs 1 -1 scale (n) col-1 show gr
% Polyline
n 614 224 m 664 224 l gs 0.50 setgray fill gr
gs col-1 s gr
n 656.000 220.000 m 664.000 224.000 l 656.000 228.000 l gs 2 setlinejoin col-1 s gr
n 552.000 228.000 m 544.000 224.000 l 552.000 220.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 544 224 m 594 224 l gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
599 229 m 
gs 1 -1 scale (n) col-1 show gr
% Polyline
n 664 259 m 664 239 l  544 239 l  544 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 338 158 m 338 138 l gs 0.50 setgray fill gr
gs col-1 s gr
n 334.000 146.000 m 338.000 138.000 l 342.000 146.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 24.00 scalefont setfont
594 294 m 
gs 1 -1 scale (c) col-1 show gr
/Times-Roman findfont 24.00 scalefont setfont
404 414 m 
gs 1 -1 scale (b) col-1 show gr
% Polyline
n 84 229 m 104 229 l gs 0.50 setgray fill gr
gs col-1 s gr
n 96.000 225.000 m 104.000 229.000 l 96.000 233.000 l gs 2 setlinejoin col-1 s gr
n 52.000 233.000 m 44.000 229.000 l 52.000 225.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 44 229 m 64 229 l gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
69 234 m 
gs 1 -1 scale (m) col-1 show gr
% Polyline
n 104 259 m 104 239 l  44 239 l  44 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 164 259 m 164 239 l  104 239 l  104 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 224 259 m 224 239 l  164 239 l  164 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 284 259 m 284 239 l  224 239 l  224 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 24.00 scalefont setfont
159 289 m 
gs 1 -1 scale (a) col-1 show gr
% Polyline
n 309 244 m 319 259 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 319 244 m 309 259 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 499 249 m 514 249 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 499 254 m 514 254 l gs 0.50 setgray fill gr
gs col-1 s gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1043 a Fo(Figure)g(4.11)249 1080 y Fz(v)o(ector-matr)o(ix)8
b(pro)q(duct.)13 b(V)m(ector)d Fl(a)h Fz(and)g(matrix)e
Fl(b)i Fz(are)f(distributed)e(in)j(one)f(dimension.)j(The)e
(distribution)249 1117 y(is)h(illustrated)c(for)j(four)g(pro)q(cesses.)
i(The)f(slices)e(need)h(not)f(b)q(e)h(all)g(of)g(the)g(same)g(size:)j
(eac)o(h)d(pro)q(cess)f(ma)o(y)249 1155 y(ha)o(v)o(e)g(a)i(di\013eren)o
(t)d(v)n(alue)h(for)h Fl(m)p Fz(.)249 1271 y Fr(REAL)21
b(sum\(n\))249 1325 y(INTEGER)f(m,)i(n,)f(comm,)g(i,)g(j,)h(ierr)249
1433 y(!)g(local)e(sum)249 1487 y(DO)h(j=)h(1,)f(n)293
1541 y(sum\(j\))f(=)i(0.0)293 1595 y(DO)f(i)h(=)f(1,)h(m)336
1649 y(sum\(j\))f(=)g(sum\(j\))g(+)h(a\(i\)*b\(i,j\))293
1703 y(END)f(DO)249 1757 y(END)g(DO)249 1864 y(!)h(global)e(sum)249
1918 y(CALL)h(MPI_REDUCE\(sum,)e(c,)i(n,)g(MPI_REAL,)f(MPI_SUM,)h(0,)g
(comm,)g(ierr\))249 2026 y(!)h(return)e(result)h(at)g(node)g(zero)g
(\(and)g(garbage)f(at)i(the)f(other)g(nodes\))249 2080
y(RETURN)249 2259 y Fs(4.10.3)48 b(MINLOC)17 b(and)e(MAXLOC)249
2342 y FA(The)21 b(op)q(erator)f Fq(MPI)p 586 2342 12
2 v 13 w(MINLOC)f FA(is)h(used)h(to)f(compute)39 b(a)20
b(global)f(minim)n(um)c(and)20 b(also)g(an)249 2396 y(index)c(attac)o
(hed)h(to)f(the)h(minim)n(um)12 b(v)n(alue.)25 b Fq(MPI)p
1053 2396 V 13 w(MAXLOC)15 b FA(similarly)e(computes)j(a)g(global)249
2450 y(maxim)n(um)d(and)k(index.)28 b(One)18 b(application)e(of)h
(these)h(is)f(to)g(compute)g(a)g(global)f(minim)n(um)249
2504 y(\(maxim)n(um)o(\))11 b(and)j(the)g(rank)g(of)f(the)i(pro)q(cess)
h(con)o(taining)c(this)i(v)n(alue.)p eop
%%Page: 181 195
181 194 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(181)291 507 y FA(The)14 b(op)q(eration)g(that)g(de\014nes)h
Fq(MPI)p 860 507 12 2 v 13 w(MAXLOC)d FA(is:)291 552
y Fi(\022)342 584 y Fp(u)347 638 y(i)386 552 y Fi(\023)424
611 y Ft(\016)452 552 y Fi(\022)503 584 y Fp(v)504 638
y(j)545 552 y Fi(\023)587 611 y FA(=)631 552 y Fi(\022)682
584 y Fp(w)686 638 y(k)734 552 y Fi(\023)777 611 y FA(where)i
Fp(w)e FA(=)g(max)o(\()p Fp(u;)7 b(v)q FA(\))12 b(and)h
Fp(k)f FA(=)1326 526 y Fi(8)1326 563 y(<)1326 638 y(:)1384
557 y Fp(i)181 b FA(if)13 b Fp(u)e(>)h(v)1384 611 y FA(min)n(\()p
Fp(i;)7 b(j)r FA(\))42 b(if)13 b Fp(u)e FA(=)h Fp(v)1384
665 y(j)178 b FA(if)13 b Fp(u)e(<)h(v)291 714 y Fq(MPI)p
363 714 V 12 w(MINLOC)h FA(is)h(de\014ned)h(similarly:)291
759 y Fi(\022)342 791 y Fp(u)347 845 y(i)386 759 y Fi(\023)426
818 y Ft(\016)456 759 y Fi(\022)507 791 y Fp(v)508 845
y(j)549 759 y Fi(\023)591 818 y FA(=)635 759 y Fi(\022)686
791 y Fp(w)690 845 y(k)738 759 y Fi(\023)782 818 y FA(where)g
Fp(w)d FA(=)g(min)n(\()p Fp(u;)7 b(v)q FA(\))14 b(and)g
Fp(k)e FA(=)1326 733 y Fi(8)1326 770 y(<)1326 845 y(:)1384
764 y Fp(i)181 b FA(if)13 b Fp(u)e(<)h(v)1384 818 y FA(min)n(\()p
Fp(i;)7 b(j)r FA(\))42 b(if)13 b Fp(u)e FA(=)h Fp(v)1384
872 y(j)178 b FA(if)13 b Fp(u)e(>)h(v)291 921 y FA(Both)j(op)q
(erations)g(are)h(asso)q(ciativ)o(e)f(and)g(comm)o(utativ)o(e.)k(Note)d
(that)f(if)f Fq(MPI)p 1531 921 V 13 w(MAXLOC)g FA(is)249
975 y(applied)c(to)g(reduce)i(a)e(sequence)j(of)d(pairs)g(\()p
Fp(u)948 981 y Fk(0)966 975 y Fp(;)d FA(0\))p Fp(;)g
FA(\()p Fp(u)1081 981 y Fk(1)1099 975 y Fp(;)g FA(1\))p
Fp(;)g(:)g(:)g(:)t(;)g FA(\()p Fp(u)1287 981 y Fj(n)p
Fm(\000)p Fk(1)1351 975 y Fp(;)g(n)r Ft(\000)r FA(1\),)k(then)g(the)g
(v)n(alue)249 1029 y(returned)i(is)f(\()p Fp(u;)7 b(r)q
FA(\),)k(where)i Fp(u)e FA(=)h(max)847 1035 y Fj(i)868
1029 y Fp(u)892 1035 y Fj(i)917 1029 y FA(and)g Fp(r)g
FA(is)g(the)g(index)g(of)f(the)h(\014rst)h(global)d(maxim)n(um)249
1083 y(in)18 b(the)h(sequence.)34 b(Th)o(us,)19 b(if)f(eac)o(h)g(pro)q
(cess)j(supplies)d(a)h(v)n(alue)e(and)h(its)h(rank)f(within)g(the)249
1137 y(group,)c(then)i(a)e(reduce)i(op)q(eration)f(with)f
Fw(op)h FA(=)g Fq(MPI)p 1100 1137 V 13 w(MAXLOC)e FA(will)g(return)j
(the)g(maxim)n(um)249 1191 y(v)n(alue)d(and)g(the)h(rank)f(of)g(the)h
(\014rst)g(pro)q(cess)h(with)e(that)h(v)n(alue.)j(Similarly)l(,)10
b Fq(MPI)p 1512 1191 V 13 w(MINLOC)i FA(can)249 1245
y(b)q(e)19 b(used)f(to)g(return)h(a)f(minim)n(um)13 b(and)18
b(its)g(index.)30 b(More)18 b(generally)m(,)g Fq(MPI)p
1482 1245 V 13 w(MINLOC)f FA(com-)249 1299 y(putes)g(a)e
FB(lexic)n(o)n(gr)n(aphic)h(minimum)p FA(,)f(where)i(elemen)o(ts)e(are)
h(ordered)h(according)e(to)h(the)g(\014rst)249 1353 y(comp)q(onen)o(t)d
(of)h(eac)o(h)g(pair,)f(and)h(ties)g(are)g(resolv)o(ed)h(according)f
(to)f(the)i(second)g(comp)q(onen)o(t.)291 1407 y(The)g(reduce)i(op)q
(eration)e(is)f(de\014ned)j(to)d(op)q(erate)i(on)f(argumen)o(ts)f(that)
i(consist)f(of)g(a)f(pair:)249 1461 y(v)n(alue)20 b(and)h(index.)38
b(In)21 b(order)h(to)e(use)i Fq(MPI)p 982 1461 V 13 w(MINLOC)e
FA(and)g Fq(MPI)p 1318 1461 V 13 w(MAXLOC)f FA(in)i(a)41
b(reduce)249 1515 y(op)q(eration,)13 b(one)g(m)o(ust)f(pro)o(vide)h(a)g
Fw(datat)o(yp)q(e)h FA(argumen)o(t)e(that)h(represen)o(ts)j(a)c(pair)h
(\(v)n(alue)g(and)249 1569 y(index\).)18 b Fw(MPI)13
b FA(pro)o(vides)g(nine)h(suc)o(h)g(prede\014ned)h(datat)o(yp)q(es.)k
(In)13 b(C,)g(the)h(index)f(is)g(an)g Fq(int)g FA(and)249
1623 y(the)g(v)n(alue)g(can)g(b)q(e)g(a)g(short)g(or)g(long)e
Fq(int)p FA(,)h(a)g Fq(\015oat)p FA(,)h(or)g(a)f Fq(double)p
FA(.)17 b(The)c(p)q(oten)o(tially)f(mixed-t)o(yp)q(e)249
1677 y(nature)17 b(of)e(suc)o(h)h(argumen)o(ts)f(is)h(a)f(problem)g(in)
g(F)m(ortran.)24 b(The)16 b(problem)e(is)i(circum)o(v)o(en)o(ted,)249
1731 y(for)d(F)m(ortran,)g(b)o(y)h(ha)o(ving)e(the)j
Fw(MPI)p FA(-pro)o(vided)d(t)o(yp)q(e)i(consist)h(of)e(a)g(pair)g(of)g
(the)h(same)f(t)o(yp)q(e)h(as)249 1785 y(v)n(alue,)f(and)h(co)q(ercing)
g(the)h(index)f(to)f(this)h(t)o(yp)q(e)h(also.)291 1839
y(The)20 b(op)q(erations)g Fq(MPI)p 662 1839 V 13 w(MAXLOC)f
FA(and)g Fq(MPI)p 1010 1839 V 13 w(MINLOC)g FA(can)i(b)q(e)f(used)h
(with)f(eac)o(h)g(of)g(the)249 1893 y(follo)o(wing)11
b(datat)o(yp)q(es.)291 1982 y Fq(F)o(o)o(rtran:)291 2032
y(Name)738 b FA(Description)291 2082 y Fq(MPI)p 363 2082
V 12 w(2REAL)634 b FA(pair)13 b(of)h Fr(REAL)p FA(s)291
2132 y Fq(MPI)p 363 2132 V 12 w(2DOUBLE)p 546 2132 V
14 w(PRECISION)367 b FA(pair)9 b(of)f Fr(DOUBLE)21 b(PRECISION)7
b FA(v)n(ariables)291 2181 y Fq(MPI)p 363 2181 V 12 w(2INTEGER)568
b FA(pair)13 b(of)h Fr(INTEGER)p FA(s)291 2340 y Fq(C:)291
2389 y(Name)738 b FA(Description)291 2439 y Fq(MPI)p
363 2439 V 12 w(FLO)o(A)m(T)p 494 2439 V 14 w(INT)551
b(\015oat)14 b FA(and)f Fq(int)291 2489 y(MPI)p 363 2489
V 12 w(DOUBLE)p 527 2489 V 14 w(INT)518 b(double)13 b
FA(and)g Fq(int)p eop
%%Page: 182 196
182 195 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(182)1256 b(Chapter)13 b(4)291
507 y Fq(MPI)p 363 507 12 2 v 12 w(LONG)p 477 507 V 14
w(INT)568 b(long)13 b FA(and)h Fq(int)291 557 y(MPI)p
363 557 V 12 w(2INT)665 b FA(pair)13 b(of)h Fq(int)291
607 y(MPI)p 363 607 V 12 w(SHORT)p 502 607 V 15 w(INT)542
b(sho)o(rt)13 b FA(and)h Fq(int)291 657 y(MPI)p 363 657
V 12 w(LONG)p 477 657 V 14 w(DOUBLE)p 643 657 V 14 w(INT)402
b(long)12 b(double)h FA(and)g Fq(int)291 725 y FA(The)h(datat)o(yp)q(e)
g Fq(MPI)p 622 725 V 13 w(2REAL)f FA(is)h FB(as)h(if)e
FA(de\014ned)i(b)o(y)f(the)g(follo)o(wing)e(\(see)j(Section)f(3.3\).)
249 821 y Fr(MPI_TYPE_CONTIGUOU)o(S\(2,)k(MPI_REAL,)i(MPI_2REAL\))291
916 y FA(Similar)8 b(statemen)o(ts)k(apply)f(for)g Fq(MPI)p
883 916 V 13 w(2INTEGER)p FA(,)g Fq(MPI)p 1169 916 V
13 w(2DOUBLE)p 1353 916 V 14 w(PRECISION)p FA(,)f(and)i
Fq(MPI-)p 249 970 V 261 970 a(2INT)p FA(.)291 1024 y(The)18
b(datat)o(yp)q(e)h Fq(MPI)p 631 1024 V 12 w(FLO)o(A)m(T)p
762 1024 V 14 w(INT)f FA(is)g FB(as)h(if)f FA(de\014ned)h(b)o(y)f(the)h
(follo)o(wing)c(sequence)20 b(of)e(in-)249 1078 y(structions.)249
1165 y Fr(type[0])i(=)i(MPI_FLOAT)249 1219 y(type[1])e(=)i(MPI_INT)249
1273 y(disp[0])e(=)i(0)249 1327 y(disp[1])e(=)i(sizeof\(float\))249
1381 y(block[0])e(=)i(1)249 1435 y(block[1])e(=)i(1)249
1489 y(MPI_TYPE_STRUCT\(2,)c(block,)j(disp,)f(type,)h(MPI_FLOAT_INT\))
249 1576 y FA(Similar)11 b(statemen)o(ts)j(apply)f(for)h(the)h(other)f
(mixed)e(t)o(yp)q(es)j(in)f(C.)249 1672 y Fs(Example)h(4.17)21
b FA(Eac)o(h)14 b(pro)q(cess)h(has)f(an)f(arra)o(y)h(of)f(30)g
Fr(double)p FA(s,)f(in)h(C.)g(F)m(or)h(eac)o(h)g(of)f(the)h(30)249
1726 y(lo)q(cations,)f(compute)g(the)i(v)n(alue)e(and)h(rank)g(of)f
(the)h(pro)q(cess)i(con)o(taining)d(the)h(largest)g(v)n(alue.)336
1780 y Fr(...)336 1834 y(/*)22 b(each)f(process)f(has)h(an)g(array)g
(of)h(30)f(doubles:)f(ain[30])358 1888 y(*/)336 1942
y(double)h(ain[30],)f(aout[30];)336 1996 y(int)43 b(ind[30];)336
2050 y(struct)21 b({)423 2104 y(double)g(val;)423 2157
y(int)65 b(rank;)336 2211 y(})22 b(in[30],)e(out[30];)336
2265 y(int)h(i,)h(myrank,)e(root;)336 2373 y(MPI_Comm_rank\(MPI_C)o
(OMM_)o(WORLD)o(,)f(&myrank\);)336 2427 y(for)i(\(i=0;)g(i<30;)g(++i\))
g({)423 2481 y(in[i].val)f(=)i(ain[i];)p eop
%%Page: 183 197
183 196 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(183)423 507 y Fr(in[i].rank)20 b(=)i(myrank;)336 561
y(})336 615 y(MPI_Reduce\()e(in,)h(out,)g(30,)g(MPI_DOUBLE_INT,)e
(MPI_MAXLOC,)g(root,)i(comm)g(\);)336 669 y(/*)h(At)f(this)g(point,)g
(the)g(answer)f(resides)h(on)g(process)f(root)358 723
y(*/)336 777 y(if)i(\(myrank)e(==)h(root\))g({)423 831
y(/*)h(read)f(ranks)g(out)445 885 y(*/)423 939 y(for)h(\(i=0;)e(i<30;)h
(++i\))g({)511 993 y(aout[i])f(=)i(out[i].val;)511 1047
y(ind[i])e(=)i(out[i].rank;)423 1101 y(})336 1155 y(})249
1304 y Fs(Example)15 b(4.18)21 b FA(Same)13 b(example,)f(in)h(F)m
(ortran.)336 1358 y Fr(...)336 1412 y(!)22 b(each)f(process)f(has)h(an)
h(array)e(of)i(30)f(doubles:)f(ain\(30\))336 1520 y(DOUBLE)h(PRECISION)
f(ain\(30\),)g(aout\(30\))336 1574 y(INTEGER)h(ind\(30\);)336
1628 y(DOUBLE)g(PRECISION)f(in\(2,30\),)g(out\(2,30\))336
1682 y(INTEGER)h(i,)g(myrank,)f(root,)h(ierr;)336 1790
y(MPI_COMM_RANK\(MPI_C)o(OMM_)o(WORLD)o(,)e(myrank\);)336
1844 y(DO)j(i=1,)f(30)423 1898 y(in\(1,i\))g(=)g(ain\(i\))423
1952 y(in\(2,i\))g(=)g(myrank)86 b(!)22 b(myrank)e(is)i(coerced)e(to)i
(a)f(double)336 2006 y(END)g(DO)336 2114 y(MPI_REDUCE\()f(in,)h(out,)g
(30,)g(MPI_2DOUBLE_PRECIS)o(ION,)d(MPI_MAXLOC,)i(root,)1513
2168 y(comm,)h(ierr)g(\);)336 2222 y(!)h(At)f(this)g(point,)g(the)g
(answer)f(resides)h(on)g(process)g(root)336 2330 y(IF)h(\(myrank)e
(.EQ.)h(root\))g(THEN)423 2384 y(!)h(read)f(ranks)g(out)423
2438 y(DO)h(I=)f(1,)h(30)511 2492 y(aout\(i\))e(=)i(out\(1,i\))p
eop
%%Page: 184 198
184 197 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(184)1256 b(Chapter)13 b(4)511
507 y Fr(ind\(i\))20 b(=)i(out\(2,i\))42 b(!)21 b(rank)g(is)h(coerced)e
(back)h(to)g(an)h(integer)423 561 y(END)g(DO)336 615
y(END)f(IF)249 765 y Fs(Example)15 b(4.19)21 b FA(Eac)o(h)13
b(pro)q(cess)i(has)e(a)f(non-empt)o(y)g(arra)o(y)g(of)g(v)n(alues.)18
b(Find)12 b(the)i(minim)n(um)249 819 y(global)e(v)n(alue,)h(the)i(rank)
e(of)h(the)g(pro)q(cess)i(that)e(holds)f(it)h(and)g(its)g(index)f(on)h
(this)g(pro)q(cess.)249 873 y Fr(#define)42 b(LEN)65
b(1000)249 981 y(float)21 b(val[LEN];)172 b(/*)22 b(local)e(array)h(of)
h(values)e(*/)249 1034 y(int)h(count;)282 b(/*)22 b(local)e(number)h
(of)g(values)g(*/)249 1088 y(int)g(myrank,)g(minrank,)f(minindex;)249
1142 y(float)h(minval;)249 1250 y(struct)g({)336 1304
y(float)g(value;)336 1358 y(int)65 b(index;)249 1412
y(})22 b(in,)f(out;)336 1520 y(/*)h(local)e(minloc)h(*/)249
1574 y(in.value)f(=)i(val[0];)249 1628 y(in.index)e(=)i(0;)249
1682 y(for)f(\(i=1;)g(i)h(<)f(count;)g(i++\))336 1736
y(if)h(\(in.value)e(>)h(val[i]\))f({)423 1790 y(in.value)h(=)g(val[i];)
423 1844 y(in.index)g(=)g(i;)336 1898 y(})336 2006 y(/*)h(global)e
(minloc)h(*/)249 2060 y(MPI_Comm_rank\(MPI_)o(COMM_)o(WORL)o(D,)e
(&myrank\);)249 2114 y(in.index)h(=)i(myrank*LEN)e(+)h(in.index;)249
2168 y(MPI_Reduce\()f(in,)h(out,)g(1,)g(MPI_FLOAT_INT,)e(MPI_MINLOC,)h
(root,)g(comm)h(\);)336 2222 y(/*)h(At)f(this)g(point,)g(the)g(answer)f
(resides)h(on)g(process)f(root)358 2276 y(*/)249 2330
y(if)h(\(myrank)g(==)g(root\))g({)336 2384 y(/*)h(read)f(answer)f(out)
358 2438 y(*/)336 2492 y(minval)h(=)g(out.value;)p eop
%%Page: 185 199
185 198 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(185)336 507 y Fr(minrank)21 b(=)g(out.index)f(/)i(LEN;)336
561 y(minindex)e(=)i(out.index)e(\045)h(LEN;)249 615
y(})249 763 y FB(R)n(ationale.)50 b FA(The)17 b(de\014nition)e(of)h
Fq(MPI)p 879 763 12 2 v 12 w(MINLOC)g FA(and)f Fq(MPI)p
1205 763 V 13 w(MAXLOC)g FA(giv)o(en)31 b(here)18 b(has)e(the)249
817 y(adv)n(an)o(tage)9 b(that)i(it)f(do)q(es)g(not)h(require)g(an)o(y)
e(sp)q(ecial-case)j(handling)d(of)g(these)j(t)o(w)o(o)e(op)q(erations:)
249 871 y(they)21 b(are)g(handled)g(lik)o(e)f(an)o(y)g(other)h(reduce)h
(op)q(eration.)39 b(A)20 b(programmer)f(can)i(pro)o(vide)249
925 y(his)f(or)f(her)i(o)o(wn)e(de\014nition)h(of)f Fq(MPI)p
862 925 V 12 w(MAXLOC)g FA(and)g Fq(MPI)p 1209 925 V
13 w(MINLOC)p FA(,)f(if)h(so)h(desired.)37 b(The)249
979 y(disadv)n(an)o(tage)11 b(is)g(that)h(v)n(alues)g(and)f(indices)h
(ha)o(v)o(e)g(to)f(b)q(e)i(\014rst)f(in)o(terlea)o(v)o(ed,)g(and)f
(that)h(indices)249 1033 y(and)i(v)n(alues)f(ha)o(v)o(e)h(to)g(b)q(e)g
(co)q(erced)i(to)e(the)g(same)f(t)o(yp)q(e,)h(in)g(F)m(ortran.)k(\()p
FB(End)d(of)g(r)n(ationale.)p FA(\))249 1124 y Fs(4.10.4)48
b(All)14 b(Reduce)249 1207 y Fw(MPI)f FA(includes)h(v)n(arian)o(ts)e
(of)h(eac)o(h)h(of)e(the)i(reduce)h(op)q(erations)f(where)g(the)g
(result)h(is)e(returned)249 1261 y(to)g(all)f(pro)q(cesses)k(in)d(the)h
(group.)k Fw(MPI)13 b FA(requires)h(that)g(all)e(pro)q(cesses)k
(participating)c(in)h(these)249 1315 y(op)q(erations)h(receiv)o(e)h
(iden)o(tical)f(results.)249 1439 y Fw(MPI)p 326 1439
13 2 v 14 w(ALLREDUCE\()f(sendbuf,)j(recvbuf,)f(count,)f(datat)o(yp)q
(e,)h(op,)f(comm\))332 1514 y Fv(IN)158 b Fw(sendbuf)415
b Fv(starting)15 b(address)f(of)e(send)i(bu\013er)332
1564 y(OUT)114 b Fw(recvbuf)422 b Fv(starting)15 b(address)f(of)e
(receiv)o(e)i(bu\013er)332 1613 y(IN)158 b Fw(count)450
b Fv(n)o(um)o(b)q(er)14 b(of)f(elemen)o(ts)h(in)g(send)f(bu\013er)332
1662 y(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(data)14 b(t)o(yp)q(e)f(of)g
(elemen)o(ts)h(of)f(send)g(bu\013er)332 1712 y(IN)158
b Fw(op)504 b Fv(op)q(eration)332 1761 y(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)249 1871 y Fr(int)21 b(MPI)p 405
1871 14 2 v 15 w(Allreduce\(void*)e(sendbuf,)h(void*)h(recvbuf,)f(int)h
(count,)540 1925 y(MPI)p 609 1925 V 15 w(Datatype)f(datatype,)g(MPI)p
1104 1925 V 15 w(Op)h(op,)g(MPI)p 1337 1925 V 15 w(Comm)g(comm\))249
2009 y(MPI)p 318 2009 V 15 w(ALLREDUCE\(SENDBUF,)d(RECVBUF,)i(COUNT,)h
(DATATYPE,)f(OP,)h(COMM,)g(IERROR\))336 2063 y(<type>)g(SENDBUF\(*\),)e
(RECVBUF\(*\))336 2117 y(INTEGER)i(COUNT,)f(DATATYPE,)g(OP,)h(COMM,)g
(IERROR)291 2201 y FA(Same)12 b(as)i Fw(MPI)p 529 2201
13 2 v 14 w(REDUCE)f FA(except)i(that)f(the)g(result)h(app)q(ears)g(in)
e(the)h(receiv)o(e)i(bu\013er)e(of)g(all)249 2255 y(the)h(group)e(mem)o
(b)q(ers.)249 2346 y FB(A)n(dvic)n(e)20 b(to)h(implementors.)73
b FA(The)21 b(all-reduce)f(op)q(erations)h(can)f(b)q(e)h(implem)o(en)o
(ted)e(as)h(a)249 2400 y(reduce,)h(follo)o(w)o(ed)c(b)o(y)i(a)f
(broadcast.)33 b(Ho)o(w)o(ev)o(er,)20 b(a)e(direct)i(implemen)o(tatio)o
(n)c(can)j(lead)g(to)249 2454 y(b)q(etter)14 b(p)q(erformance.)j(In)12
b(this)g(case)h(care)g(m)o(ust)e(b)q(e)i(tak)o(en)f(to)g(mak)o(e)f
(sure)i(that)f(all)f(pro)q(cesses)249 2508 y(receiv)o(e)k(the)g(same)e
(result.)19 b(\()p FB(End)c(of)g(advic)n(e)g(to)g(implementors.)p
FA(\))p eop
%%Page: 186 200
186 199 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(186)1256 b(Chapter)13 b(4)249
507 y Fs(Example)i(4.20)21 b FA(A)11 b(routine)h(that)g(computes)f(the)
h(pro)q(duct)h(of)e(a)g(v)o(ector)h(and)g(an)f(arra)o(y)g(that)249
561 y(are)i(distributed)g(across)h(a)e(group)h(of)f(pro)q(cesses)j(and)
e(returns)h(the)f(answ)o(er)h(at)e(all)g(no)q(des)h(\(see)249
615 y(also)g(Example)g(4.16,)f(page)i(179\).)249 669
y Fr(SUBROUTINE)20 b(PAR_BLAS2\(m,)f(n,)i(a,)h(b,)f(c,)h(comm\))249
723 y(REAL)f(a\(m\),)g(b\(m,n\))86 b(!)21 b(local)g(slice)g(of)g(array)
249 777 y(REAL)g(c\(n\))261 b(!)21 b(result)249 831 y(REAL)g(sum\(n\))
249 885 y(INTEGER)f(m,)i(n,)f(comm,)g(i,)g(j,)h(ierr)249
993 y(!)g(local)e(sum)249 1047 y(DO)h(j=)h(1,)f(n)293
1101 y(sum\(j\))f(=)i(0.0)293 1155 y(DO)f(i)h(=)f(1,)h(m)336
1209 y(sum\(j\))f(=)g(sum\(j\))g(+)h(a\(i\)*b\(i,j\))293
1263 y(END)f(DO)249 1317 y(END)g(DO)249 1425 y(!)h(global)e(sum)249
1479 y(CALL)h(MPI_ALLREDUCE\(sum,)d(c,)j(n,)h(MPI_REAL,)e(MPI_SUM,)g
(comm,)h(ierr\))249 1587 y(!)h(return)e(result)h(at)g(all)g(nodes)249
1641 y(RETURN)249 1774 y Fs(4.10.5)48 b(Reduce-Scatter)249
1857 y Fw(MPI)12 b FA(includes)h(v)n(arian)o(ts)f(of)g(eac)o(h)h(of)f
(the)h(reduce)i(op)q(erations)e(where)g(the)h(result)f(is)f(scattered)
249 1911 y(to)i(all)e(pro)q(cesses)17 b(in)c(the)i(group)f(on)f
(return.)249 2036 y Fw(MPI)p 326 2036 13 2 v 14 w(REDUCE)p
503 2036 V 14 w(SCA)m(TTER\()g(sendbuf,)i(recvbuf,)g(recvcounts,)h
(datat)o(yp)q(e,)e(op,)g(comm\))332 2111 y Fv(IN)158
b Fw(sendbuf)415 b Fv(starting)15 b(address)f(of)e(send)i(bu\013er)332
2157 y(OUT)114 b Fw(recvbuf)422 b Fv(starting)15 b(address)f(of)e
(receiv)o(e)i(bu\013er)332 2204 y(IN)158 b Fw(recvcounts)365
b Fv(in)o(teger)14 b(arra)o(y)332 2251 y(IN)158 b Fw(datat)o(yp)q(e)397
b Fv(data)14 b(t)o(yp)q(e)f(of)g(elemen)o(ts)h(of)f(input)h(bu\013er)
332 2297 y(IN)158 b Fw(op)504 b Fv(op)q(eration)332 2344
y(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)249 2454
y Fr(int)21 b(MPI)p 405 2454 14 2 v 15 w(Reduce)p 552
2454 V 15 w(scatter\(void*)e(sendbuf,)h(void*)h(recvbuf,)f(int)h
(*recvcounts,)540 2508 y(MPI)p 609 2508 V 15 w(Datatype)f(datatype,)g
(MPI)p 1104 2508 V 15 w(Op)h(op,)g(MPI)p 1337 2508 V
15 w(Comm)g(comm\))p eop
%%Page: 187 201
187 200 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(187)249 507 y Fr(MPI)p 318 507 14 2 v 15 w(REDUCE)p
465 507 V 15 w(SCATTER\(SENDBUF)o(,)19 b(RECVBUF,)h(RECVCOUNTS,)g
(DATATYPE,)g(OP,)h(COMM,)540 561 y(IERROR\))336 615 y(<type>)g
(SENDBUF\(*\),)e(RECVBUF\(*\))336 669 y(INTEGER)i(RECVCOUNTS\(*\),)d
(DATATYPE,)i(OP,)i(COMM,)e(IERROR)291 753 y Fw(MPI)p
368 753 13 2 v 14 w(REDUCE)p 545 753 V 13 w(SCA)m(TTER)g
FA(acts)h(as)f(if)g(it)g(\014rst)i(do)q(es)f(an)f(elemen)o(t-wise)g
(reduction)i(on)249 807 y(v)o(ector)17 b(of)e Fw(count)i
FA(=)585 776 y Fi(P)629 821 y Fw(i)648 807 y(recvcounts)p
FA([)p Fw(i)p FA(])g(elemen)o(ts)f(in)f(the)i(send)g(bu\013er)g
(de\014ned)g(b)o(y)f Fw(sendbuf,)249 861 y(count)k FA(and)f
Fw(datat)o(yp)q(e)p FA(.)34 b(Next,)20 b(the)f(resulting)g(v)o(ector)h
(of)e(results)i(is)e(split)h(in)o(to)f Fr(n)g FA(disjoin)o(t)249
915 y(segmen)o(ts,)f(where)h Fr(n)f FA(is)g(the)h(n)o(um)o(b)q(er)e(of)
g(pro)q(cesses)k(in)c(the)i(group)f(of)f Fw(comm)p FA(.)25
b(Segmen)o(t)17 b Fr(i)249 969 y FA(con)o(tains)c Fw(recvcounts[i])j
FA(elemen)o(ts.)i(The)c Fr(i)p FA(th)f(segmen)o(t)g(is)g(sen)o(t)h(to)g
(pro)q(cess)h Fr(i)e FA(and)g(stored)i(in)249 1023 y(the)g(receiv)o(e)g
(bu\013er)g(de\014ned)g(b)o(y)e Fw(recvbuf,)i(recvcounts[i])h
FA(and)e Fw(datat)o(yp)q(e)p FA(.)249 1105 y Fs(Example)h(4.21)21
b FA(A)11 b(routine)h(that)g(computes)f(the)h(pro)q(duct)h(of)e(a)g(v)o
(ector)h(and)g(an)f(arra)o(y)g(that)249 1159 y(are)j(distributed)g
(across)h(a)e(group)g(of)g(pro)q(cesses)k(and)c(returns)i(the)f(answ)o
(er)g(in)g(a)f(distributed)249 1213 y(arra)o(y)m(.)k(The)11
b(distribution)g(of)g(v)o(ectors)i Fr(a)e FA(and)g Fr(c)g
FA(and)g(matrix)f Fr(b)h FA(is)g(illustrated)h(in)f(Figure)g(4.12.)249
1267 y Fr(SUBROUTINE)20 b(PAR_BLAS2\(m,)f(n,)i(k,)h(a,)f(b,)h(c,)f
(comm\))249 1321 y(REAL)g(a\(m\),)g(b\(m,n\),)f(c\(k\))86
b(!)22 b(local)f(slice)g(of)g(array)249 1375 y(REAL)g(sum\(n\))249
1429 y(INTEGER)f(m,)i(n,)f(k,)h(comm,)e(i,)i(j,)f(gsize,)g(ierr)249
1483 y(INTEGER,)f(ALLOCATABLE)g(recvcounts\(:\))249 1591
y(!)i(distribute)d(to)j(all)f(processes)f(the)h(sizes)g(of)g(the)g
(slices)g(of)249 1645 y(!)h(array)e(c)i(\(in)f(real)g(life,)g(this)g
(would)g(be)g(precomputed\))249 1699 y(CALL)g(MPI_COMM_SIZE\(comm)o(,)e
(gsize,)h(ierr\))249 1753 y(ALLOCATE)g(recvcounts\(gsize\))249
1807 y(CALL)h(MPI_ALLGATHER\(k,)e(1,)i(MPI_INTEGER,)e(recvcounts,)h(1,)
881 1861 y(MPI_INTEGER,)f(comm,)i(ierr\))249 1968 y(!)h(local)e(sum)249
2022 y(DO)h(j=)h(1,)f(n)293 2076 y(sum\(j\))f(=)i(0.0)293
2130 y(DO)f(i)h(=)f(1,)h(m)336 2184 y(sum\(j\))f(=)g(sum\(j\))g(+)h
(a\(i\)*b\(i,j\))293 2238 y(END)f(DO)249 2292 y(END)g(DO)249
2400 y(!)h(global)e(sum)h(and)h(distribution)d(of)i(vector)g(c)249
2454 y(CALL)g(MPI_REDUCE_SCATTER)o(\(sum)o(,)e(c,)i(recvcounts,)f
(MPI_REAL,)925 2508 y(MPI_SUM,)g(comm,)h(ierr\))p eop
%%Page: 188 202
188 201 bop 2 223 2 150 v 2 76 150 2 v 1928 76 V 2076
225 2 150 v 249 251 a Fv(188)1256 b(Chapter)13 b(4)478
466 y
 16577003 7293880 0 0 40258437 18024202 startTexFig
 478 466 a
%%BeginDocument: ../figures/coll-blas22.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-40.0 373.0 translate 0.900 -0.900 scale
1.000 setlinewidth
n 52.000 233.000 m 44.000 229.000 l 52.000 225.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 44 229 m 64 229 l gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
69 234 m 
gs 1 -1 scale (m) col-1 show gr
% Polyline
n 104 259 m 104 239 l  44 239 l  44 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 164 259 m 164 239 l  104 239 l  104 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 224 259 m 224 239 l  164 239 l  164 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 284 259 m 284 239 l  224 239 l  224 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 24.00 scalefont setfont
159 289 m 
gs 1 -1 scale (a) col-1 show gr
% Polyline
n 309 244 m 319 259 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 319 244 m 309 259 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 328 158 m 328 138 l gs 0.50 setgray fill gr
gs col-1 s gr
n 324.000 146.000 m 328.000 138.000 l 332.000 146.000 l gs 2 setlinejoin col-1 s gr
n 332.000 190.000 m 328.000 198.000 l 324.000 190.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 328 198 m 328 178 l gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
333 173 m 
gs 1 -1 scale  90.0 rotate (m) col-1 show gr
% Polyline
n 524 244 m 539 244 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 524 249 m 539 249 l gs 0.50 setgray fill gr
gs col-1 s gr
n 572.000 223.000 m 564.000 219.000 l 572.000 215.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 564 219 m 634 219 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 724 254 m 724 234 l  564 234 l  564 254 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 654 219 m 724 219 l gs 0.50 setgray fill gr
gs col-1 s gr
n 716.000 215.000 m 724.000 219.000 l 716.000 223.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 604 234 m 604 254 l gs col-1 s gr
% Polyline
n 644 234 m 644 254 l gs col-1 s gr
% Polyline
n 684 234 m 684 254 l gs col-1 s gr
% Polyline
n 84 229 m 104 229 l gs 0.50 setgray fill gr
gs col-1 s gr
n 96.000 225.000 m 104.000 229.000 l 96.000 233.000 l gs 2 setlinejoin col-1 s gr
n 572.000 278.000 m 564.000 274.000 l 572.000 270.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 564 274 m 579 274 l gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
412 129 m 
gs 1 -1 scale (n) col-1 show gr
% Polyline
n 589 274 m 604 274 l gs 0.50 setgray fill gr
gs col-1 s gr
n 596.000 270.000 m 604.000 274.000 l 596.000 278.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
639 224 m 
gs 1 -1 scale (n) col-1 show gr
/Times-Roman findfont 24.00 scalefont setfont
639 304 m 
gs 1 -1 scale (c) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
581 279 m 
gs 1 -1 scale (k) col-1 show gr
% Polyline
n 104 259 m 104 239 l  44 239 l  44 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 164 259 m 164 239 l  104 239 l  104 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 224 259 m 224 239 l  164 239 l  164 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 284 259 m 284 239 l  224 239 l  224 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 498 199 m 498 139 l  340 139 l  340 199 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 498 259 m 498 199 l  340 199 l  340 259 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 498 319 m 498 259 l  340 259 l  340 319 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 498 379 m 498 319 l  340 319 l  340 379 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 432 124 m 498 124 l gs 0.50 setgray fill gr
gs col-1 s gr
n 490.000 120.000 m 498.000 124.000 l 490.000 128.000 l gs 2 setlinejoin col-1 s gr
n 348.000 128.000 m 340.000 124.000 l 348.000 120.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 340 124 m 406 124 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 84 229 m 104 229 l gs 0.50 setgray fill gr
gs col-1 s gr
n 96.000 225.000 m 104.000 229.000 l 96.000 233.000 l gs 2 setlinejoin col-1 s gr
n 52.000 233.000 m 44.000 229.000 l 52.000 225.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 44 229 m 64 229 l gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 24.00 scalefont setfont
159 289 m 
gs 1 -1 scale (a) col-1 show gr
/Times-Roman findfont 24.00 scalefont setfont
394 414 m 
gs 1 -1 scale (b) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
69 234 m 
gs 1 -1 scale (m) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 990 a Fo(Figure)g(4.12)249 1027 y Fz(v)o(ector-matr)o(ix)c(pro)q
(duct.)k(All)f(v)o(ectors)d(and)i(matrices)e(are)i(distributed.)h(The)g
(distribution)c(is)k(illustrated)249 1065 y(for)f(four)g(pro)q(cesses.)
i(Eac)o(h)e(pro)q(cess)e(ma)o(y)i(ha)o(v)o(e)f(a)i(di\013eren)o(t)d(v)n
(alue)h(for)h Fl(m)g Fz(and)g Fl(k)p Fz(.)249 1240 y
Fr(!)22 b(return)e(result)h(in)g(distributed)f(vector)249
1293 y(RETURN)249 1477 y FB(A)n(dvic)n(e)g(to)h(implementors.)73
b FA(The)20 b Fw(MPI)p 941 1477 13 2 v 15 w(REDUCE)p
1119 1477 V 13 w(SCA)m(TTER)f FA(routine)h(is)g(functionally)249
1531 y(equiv)n(alen)o(t)e(to:)28 b(A)19 b Fw(MPI)p 655
1531 V 15 w(REDUCE)e FA(op)q(eration)i(function)g(with)f
Fw(count)i FA(equal)f(to)g(the)g(sum)249 1585 y(of)e
Fw(recvcounts[i])i FA(follo)o(w)o(ed)d(b)o(y)h Fw(MPI)p
836 1585 V 15 w(SCA)m(TTERV)f FA(with)h Fw(sendcounts)i
FA(equal)e(to)h Fw(recvcounts)p FA(.)249 1639 y(Ho)o(w)o(ev)o(er,)11
b(a)g(direct)h(implem)o(en)o(tation)c(ma)o(y)h(run)i(faster.)18
b(\()p FB(End)13 b(of)f(advic)n(e)g(to)g(implementors.)p
FA(\))249 1760 y FD(4.11)52 b(Scan)208 1939 y Fw(MPI)p
285 1939 V 14 w(SCAN\()14 b(sendbuf,)h(recvbuf,)g(count,)f(datat)o(yp)q
(e,)h(op,)f(comm)e(\))332 2013 y Fv(IN)158 b Fw(sendbuf)415
b Fv(starting)15 b(address)f(of)e(send)i(bu\013er)332
2063 y(OUT)114 b Fw(recvbuf)422 b Fv(starting)15 b(address)f(of)e
(receiv)o(e)i(bu\013er)332 2112 y(IN)158 b Fw(count)450
b Fv(n)o(um)o(b)q(er)14 b(of)f(elemen)o(ts)h(in)g(input)g(bu\013er)332
2161 y(IN)158 b Fw(datat)o(yp)q(e)397 b Fv(data)14 b(t)o(yp)q(e)f(of)g
(elemen)o(ts)h(of)f(input)h(bu\013er)332 2211 y(IN)158
b Fw(op)504 b Fv(op)q(eration)332 2260 y(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)249 2370 y Fr(int)21 b(MPI)p 405
2370 14 2 v 15 w(Scan\(void*)f(sendbuf,)g(void*)h(recvbuf,)f(int)h
(count,)540 2424 y(MPI)p 609 2424 V 15 w(Datatype)f(datatype,)g(MPI)p
1104 2424 V 15 w(Op)h(op,)g(MPI)p 1337 2424 V 15 w(Comm)g(comm)g(\))249
2508 y(MPI)p 318 2508 V 15 w(SCAN\(SENDBUF,)e(RECVBUF,)h(COUNT,)h
(DATATYPE,)f(OP,)h(COMM,)g(IERROR\))p eop
%%Page: 189 203
189 202 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(189)336 507 y Fr(<type>)21 b(SENDBUF\(*\),)e(RECVBUF\(*\))336
561 y(INTEGER)i(COUNT,)f(DATATYPE,)g(OP,)h(COMM,)g(IERROR)291
645 y Fw(MPI)p 368 645 13 2 v 14 w(SCAN)15 b FA(is)g(used)h(to)g(p)q
(erform)e(a)h(pre\014x)h(reduction)g(on)f(data)h(distributed)g(across)g
(the)249 699 y(group.)32 b(The)19 b(op)q(eration)g(returns,)i(in)d(the)
h(receiv)o(e)h(bu\013er)g(of)e(the)h(pro)q(cess)h(with)f(rank)f
Fr(i)p FA(,)249 753 y(the)h(reduction)g(of)f(the)h(v)n(alues)g(in)f
(the)h(send)g(bu\013ers)h(of)e(pro)q(cesses)j(with)d(ranks)h
Fr(0,...,i)249 807 y FA(\(inclusiv)o(e\).)f(The)13 b(t)o(yp)q(e)h(of)f
(op)q(erations)g(supp)q(orted,)h(their)g(seman)o(tics,)e(and)h(the)h
(constrain)o(ts)249 861 y(on)g(send)h(and)e(receiv)o(e)i(bu\013ers)h
(are)e(as)g(for)f Fw(MPI)p 1014 861 V 15 w(REDUCE)p FA(.)249
951 y FB(R)n(ationale.)36 b FA(The)13 b(MPI)g(F)m(orum)e(de\014ned)j
(an)e(inclusiv)o(e)g(scan,)h(that)g(is,)f(the)h(pre\014x)h(reduction)
249 1005 y(on)k(pro)q(cess)i Fr(i)e FA(includes)h(the)g(data)f(from)e
(pro)q(cess)k Fr(i)p FA(.)31 b(An)18 b(alternativ)o(e)g(is)g(to)h
(de\014ne)g(scan)249 1059 y(in)14 b(an)g(exclusiv)o(e)i(manner,)d
(where)j(the)f(result)g(on)f Fr(i)h FA(only)e(includes)i(data)g(up)f
(to)h Fr(i-1)p FA(.)k(Both)249 1112 y(de\014nitions)10
b(are)g(useful.)17 b(The)10 b(latter)g(has)g(some)f(adv)n(an)o(tages:)
16 b(the)10 b(inclusiv)o(e)g(scan)g(can)g(alw)o(a)o(ys)249
1166 y(b)q(e)16 b(computed)f(from)e(the)j(exclusiv)o(e)g(scan)g(with)f
(no)g(additional)f(comm)o(unicati)o(on;)f(for)i(non-)249
1220 y(in)o(v)o(ertible)e(op)q(erations)h(suc)o(h)h(as)f(max)e(and)h
(min,)f(comm)o(unicatio)o(n)f(is)j(required)g(to)g(compute)249
1274 y(the)h(exclusiv)o(e)g(scan)g(from)d(the)j(inclusiv)o(e)f(scan.)20
b(There)15 b(is,)f(ho)o(w)o(ev)o(er,)g(a)g(complication)e(with)249
1328 y(exclusiv)o(e)17 b(scan)h(since)f(one)g(m)o(ust)f(de\014ne)i(the)
f(\\unit")f(elemen)o(t)h(for)f(the)h(reduction)h(in)e(this)249
1382 y(case.)i(That)9 b(is,)h(one)g(m)o(ust)f(explicitly)f(sa)o(y)i
(what)g(o)q(ccurs)h(for)e(pro)q(cess)j Fr(0)p FA(.)k(This)9
b(w)o(as)h(though)o(t)g(to)249 1436 y(b)q(e)k(complex)e(for)h
(user-de\014ned)i(op)q(erations)e(and)g(hence,)i(the)f(exclusiv)o(e)f
(scan)h(w)o(as)f(dropp)q(ed.)249 1490 y(\()p FB(End)j(of)f(r)n
(ationale.)p FA(\))249 1611 y FD(4.12)52 b(User-De\014ned)18
b(Op)q(erations)g(for)f(Reduce)h(and)g(Scan)208 1789
y Fw(MPI)p 285 1789 V 14 w(OP)p 357 1789 V 14 w(CREA)m(TE\()12
b(function,)j(commute,)d(op\))332 1864 y Fv(IN)158 b
Fw(function)406 b Fv(user)14 b(de\014ned)g(function)332
1912 y(IN)158 b Fw(commute)385 b Fc(true)12 b Fv(if)h(comm)o(utativ)o
(e;)h Fc(false)d Fv(otherwise.)332 1960 y(OUT)114 b Fw(op)504
b Fv(op)q(eration)249 2070 y Fr(int)21 b(MPI)p 405 2070
14 2 v 15 w(Op)p 464 2070 V 16 w(create\(MPI)p 700 2070
V 13 w(User)p 801 2070 V 15 w(function)f(*function,)g(int)h(commute,)
540 2124 y(MPI)p 609 2124 V 15 w(Op)g(*op\))249 2208
y(MPI)p 318 2208 V 15 w(OP)p 377 2208 V 15 w(CREATE\()g(FUNCTION,)f
(COMMUTE,)g(OP,)h(IERROR\))336 2262 y(EXTERNAL)f(FUNCTION)336
2316 y(LOGICAL)h(COMMUTE)336 2370 y(INTEGER)g(OP,)g(IERROR)291
2454 y Fw(MPI)p 368 2454 13 2 v 14 w(OP)p 440 2454 V
14 w(CREA)m(TE)11 b FA(binds)i(a)f(user-de\014ned)j(global)c(op)q
(eration)i(to)f(an)h Fw(op)g FA(handle)f(that)h(can)249
2508 y(subsequen)o(tly)e(b)q(e)e(used)i(in)d Fw(MPI)p
753 2508 V 15 w(REDUCE)p FA(,)f Fw(MPI)p 1025 2508 V
14 w(ALLREDUCE)p FA(,)h Fw(MPI)p 1369 2508 V 14 w(REDUCE)p
1546 2508 V 14 w(SCA)m(TTER)p FA(,)p eop
%%Page: 190 204
190 203 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(190)1256 b(Chapter)13 b(4)249
507 y FA(and)j Fw(MPI)p 409 507 13 2 v 14 w(SCAN)p FA(.)f(The)h
(user-de\014ned)i(op)q(eration)e(is)f(assumed)g(to)h(b)q(e)g(asso)q
(ciativ)o(e.)24 b(If)15 b Fw(com-)249 561 y(mute)g FA(=)g
Fr(true)p FA(,)f(then)i(the)g(op)q(eration)f(should)f(b)q(e)i(b)q(oth)f
(comm)o(utativ)o(e)d(and)j(asso)q(ciativ)o(e.)22 b(If)249
615 y Fw(commute)17 b FA(=)i Fr(false)p FA(,)f(then)h(the)f(order)h(of)
f(op)q(erations)h(is)f(\014xed)g(and)g(is)h(de\014ned)g(to)f(b)q(e)h
(in)249 669 y(ascending,)g(pro)q(cess)g(rank)f(order,)h(b)q(eginning)e
(with)g(pro)q(cess)i(zero.)31 b(The)18 b(order)g(of)f(ev)n(alu-)249
723 y(ation)g(can)h(b)q(e)g(c)o(hanged,)h(taking)e(adv)n(an)o(tage)g
(of)g(the)h(asso)q(ciativit)o(y)f(of)g(the)h(op)q(eration.)30
b(If)249 777 y Fw(commute)12 b FA(=)i Fr(true)e FA(then)i(the)f(order)h
(of)f(ev)n(aluation)e(can)j(b)q(e)f(c)o(hanged,)h(taking)e(adv)n(an)o
(tage)g(of)249 831 y(comm)o(utativi)o(t)o(y)f(and)j(asso)q(ciativit)o
(y)m(.)291 885 y Fw(function)k FA(is)e(the)i(user-de\014ned)h
(function,)e(whic)o(h)g(m)o(ust)f(ha)o(v)o(e)g(the)i(follo)o(wing)c
(four)j(argu-)249 939 y(men)o(ts:)h Fw(invec,)c(inoutvec,)h(len)g
FA(and)f Fw(datat)o(yp)q(e)p FA(.)291 993 y(The)g(ANSI-C)g(protot)o(yp)
q(e)g(for)g(the)g(function)g(is)g(the)g(follo)o(wing.)249
1079 y Fr(typedef)20 b(void)h(MPI_User_function\()d(void)j(*invec,)g
(void)g(*inoutvec,)e(int)j(*len,)1273 1133 y(MPI_Datatype)e
(*datatype\);)291 1219 y FA(The)14 b(F)m(ortran)g(declaration)f(of)g
(the)i(user-de\014ned)h(function)e(app)q(ears)g(b)q(elo)o(w.)249
1306 y Fr(FUNCTION)20 b(USER_FUNCTION\()f(INVEC\(*\),)h(INOUTVEC\(*\),)
f(LEN,)i(TYPE\))249 1359 y(<type>)g(INVEC\(LEN\),)e(INOUTVEC\(LEN\))271
1413 y(INTEGER)h(LEN,)h(TYPE)291 1500 y FA(The)d Fw(datat)o(yp)q(e)h
FA(argumen)o(t)d(is)i(a)f(handle)h(to)g(the)g(data)f(t)o(yp)q(e)i(that)
e(w)o(as)h(passed)h(in)o(to)e(the)249 1554 y(call)g(to)h
Fw(MPI)p 461 1554 V 14 w(REDUCE)p FA(.)e(The)j(user)g(reduce)g
(function)f(should)g(b)q(e)h(written)f(suc)o(h)h(that)f(the)249
1608 y(follo)o(wing)c(holds:)24 b(Let)17 b Fw(u[0],)h(...)26
b(,)17 b(u[len-1])h FA(b)q(e)f(the)h Fw(len)f FA(elemen)o(ts)g(in)f
(the)i(comm)o(unicatio)o(n)249 1662 y(bu\013er)j(describ)q(ed)g(b)o(y)e
(the)h(argumen)o(ts)f Fw(invec,)j(len)e FA(and)f Fw(datat)o(yp)q(e)i
FA(when)f(the)g(function)g(is)249 1715 y(in)o(v)o(ok)o(ed;)11
b(let)h Fw(v[0],)g(...)k(,)11 b(v[len-1])i FA(b)q(e)f
Fw(len)g FA(elemen)o(ts)g(in)f(the)i(comm)o(unicati)o(on)c(bu\013er)k
(describ)q(ed)249 1769 y(b)o(y)d(the)g(argumen)o(ts)f
Fw(inoutvec,)i(len)g FA(and)f Fw(datat)o(yp)q(e)h FA(when)f(the)g
(function)g(is)f(in)o(v)o(ok)o(ed;)h(let)g Fw(w[0],)g(...)249
1823 y(,)j(w[len-1])i FA(b)q(e)f Fw(len)h FA(elemen)o(ts)f(in)f(the)h
(comm)o(unication)d(bu\013er)k(describ)q(ed)g(b)o(y)f(the)g(argumen)o
(ts)249 1877 y Fw(inoutvec,)h(len)f FA(and)f Fw(datat)o(yp)q(e)i
FA(when)f(the)g(function)g(returns;)g(then)h Fw(w[i])e(=)h(u[i])p
Ft(\016)p Fw(v[i])p FA(,)f(for)g Fw(i=0)h(,)249 1931
y(...)j(,)c(len-1)p FA(,)h(where)h Ft(\016)f FA(is)g(the)g(reduce)i(op)
q(eration)d(that)h(the)h(function)e(computes.)291 1985
y(Informally)l(,)18 b(w)o(e)i(can)f(think)h(of)f Fw(invec)i
FA(and)e Fw(inoutvec)i FA(as)f(arra)o(ys)g(of)f Fw(len)h
FA(elemen)o(ts)f(that)249 2039 y Fw(function)f FA(is)f(com)o(bining.)24
b(The)17 b(result)h(of)e(the)i(reduction)f(o)o(v)o(er-writes)g(v)n
(alues)g(in)f Fw(inoutvec)p FA(,)249 2093 y(hence)d(the)f(name.)k(Eac)o
(h)c(in)o(v)o(o)q(cation)f(of)g(the)h(function)f(results)i(in)e(the)i
(p)q(oin)o(t)o(wise)e(ev)n(aluation)249 2147 y(of)k(the)i(reduce)g(op)q
(erator)f(on)g Fw(len)g FA(elemen)o(ts:)22 b(i.e,)15
b(the)i(function)e(returns)i(in)f Fw(inoutvec[i])h FA(the)249
2201 y(v)n(alue)10 b Fw(invec)p FA([)p Fw(i)p FA(])s
Ft(\016)s Fw(inoutvec)p FA([)p Fw(i)p FA(],)i(for)f Fw(i)g
FA(=)h Fw(0)p Fp(;)7 b(:)g(:)g(:)e(;)i Fw(count)s Ft(\000)s
Fw(1)p FA(,)k(where)h Ft(\016)f FA(is)g(the)g(com)o(bining)e(op)q
(eration)249 2255 y(computed)k(b)o(y)h(the)h(function.)249
2346 y FB(R)n(ationale.)51 b FA(The)17 b(len)f(argumen)o(t)f(allo)o(ws)
g Fw(MPI)p 1032 2346 V 14 w(REDUCE)g FA(to)h(a)o(v)o(oid)f(calling)g
(the)i(function)249 2400 y(for)e(eac)o(h)h(elemen)o(t)g(in)f(the)h
(input)f(bu\013er.)25 b(Rather,)15 b(the)i(system)e(can)h(c)o(ho)q(ose)
g(to)g(apply)f(the)249 2454 y(function)k(to)g(c)o(h)o(unks)h(of)e
(input.)34 b(In)19 b(C,)g(it)g(is)g(passed)h(in)f(as)g(a)g(reference)j
(for)d(reasons)h(of)249 2508 y(compatibilit)o(y)11 b(with)i(F)m
(ortran.)p eop
%%Page: 191 205
191 204 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(191)249 507 y FA(By)14 b(in)o(ternally)e(comparing)g(the)i(v)n(alue)f
(of)g(the)h Fw(datat)o(yp)q(e)h FA(argumen)o(t)d(to)h(kno)o(wn,)g
(global)f(han-)249 561 y(dles,)j(it)f(is)h(p)q(ossible)g(to)g(o)o(v)o
(erload)f(the)h(use)h(of)e(a)g(single)h(user-de\014ned)h(function)f
(for)f(sev)o(eral,)249 615 y(di\013eren)o(t)h(data)e(t)o(yp)q(es.)19
b(\()p FB(End)d(of)f(r)n(ationale.)p FA(\))291 704 y(General)10
b(datat)o(yp)q(es)i(ma)o(y)d(b)q(e)i(passed)h(to)f(the)g(user)h
(function.)17 b(Ho)o(w)o(ev)o(er,)11 b(use)h(of)e(datat)o(yp)q(es)249
758 y(that)k(are)g(not)g(con)o(tiguous)g(is)f(lik)o(ely)g(to)h(lead)f
(to)h(ine\016ciencies.)291 812 y(No)f Fw(MPI)g FA(comm)o(unicatio)o(n)e
(function)i(ma)o(y)f(b)q(e)i(called)f(inside)g(the)h(user)h(function.)j
Fw(MPI)p 1690 812 13 2 v 14 w(A-)249 866 y(BORT)13 b
FA(ma)o(y)f(b)q(e)j(called)e(inside)h(the)h(function)e(in)h(case)g(of)g
(an)f(error.)249 954 y FB(A)n(dvic)n(e)18 b(to)f(users.)56
b FA(Supp)q(ose)18 b(one)f(de\014nes)h(a)f(library)f(of)h
(user-de\014ned)i(reduce)f(functions)249 1008 y(that)g(are)g(o)o(v)o
(erloaded:)24 b(the)18 b Fw(datat)o(yp)q(e)h FA(argumen)o(t)e(is)g
(used)h(to)g(select)h(the)f(righ)o(t)f(execution)249
1062 y(path)d(at)h(eac)o(h)g(in)o(v)o(o)q(cation,)e(according)h(to)g
(the)i(t)o(yp)q(es)f(of)f(the)h(op)q(erands.)20 b(The)15
b(user-de\014ned)249 1116 y(reduce)g(function)e(cannot)g(\\deco)q(de")h
(the)f Fw(datat)o(yp)q(e)i FA(argumen)o(t)d(that)h(it)g(is)g(passed,)g
(and)g(can-)249 1170 y(not)k(iden)o(tify)m(,)f(b)o(y)h(itself,)g(the)g
(corresp)q(ondence)j(b)q(et)o(w)o(een)f(the)e(datat)o(yp)q(e)h(handles)
f(and)g(the)249 1224 y(datat)o(yp)q(e)d(they)g(represen)o(t.)20
b(This)14 b(corresp)q(ondence)j(w)o(as)c(established)h(when)h(the)f
(datat)o(yp)q(es)249 1278 y(w)o(ere)i(created.)23 b(Before)16
b(the)g(library)e(is)h(used,)h(a)e(library)h(initialization)d(pream)o
(ble)i(m)o(ust)g(b)q(e)249 1332 y(executed.)19 b(This)11
b(pream)o(ble)f(co)q(de)i(will)d(de\014ne)j(the)g(datat)o(yp)q(es)f
(that)g(are)h(used)g(b)o(y)e(the)i(library)m(,)249 1386
y(and)j(store)g(handles)g(to)g(these)h(datat)o(yp)q(es)g(in)e(global,)f
(static)i(v)n(ariables)f(that)h(are)g(shared)h(b)o(y)249
1440 y(the)f(user)g(co)q(de)f(and)g(the)g(library)g(co)q(de.)249
1508 y(The)f(F)m(ortran)g(v)o(ersion)f(of)g Fw(MPI)p
745 1508 V 15 w(REDUCE)f FA(will)g(in)o(v)o(ok)o(e)h(a)g
(user-de\014ned)j(reduce)f(function)e(us-)249 1562 y(ing)e(the)h(F)m
(ortran)f(calling)f(con)o(v)o(en)o(tions)h(and)h(will)e(pass)i(a)f(F)m
(ortran-t)o(yp)q(e)g(datat)o(yp)q(e)h(argumen)o(t;)249
1616 y(the)j(C)g(v)o(ersion)f(will)g(use)h(C)f(calling)g(con)o(v)o(en)o
(tion)g(and)g(the)h(C)g(represen)o(tation)h(of)e(a)g(datat)o(yp)q(e)249
1670 y(handle.)25 b(Users)18 b(who)d(plan)h(to)g(mix)e(languages)i
(should)g(de\014ne)h(their)f(reduction)h(functions)249
1724 y(accordingly)m(.)g(\()p FB(End)f(of)f(advic)n(e)g(to)g(users.)p
FA(\))249 1812 y FB(A)n(dvic)n(e)f(to)h(implementors.)36
b FA(W)m(e)13 b(outline)g(b)q(elo)o(w)h(a)f(naiv)o(e)g(and)g
(ine\016cien)o(t)h(implemen)o(tatio)o(n)249 1866 y(of)f
Fw(MPI)p 373 1866 V 15 w(REDUCE)p FA(.)249 1968 y Fr(if)21
b(\(rank)g(>)h(0\))f({)336 2022 y(MPI_RECV\(tempbuf,)e(count,)h
(datatype,)g(rank-1,...\))336 2076 y(User_reduce\()g(tempbuf,)g
(sendbuf,)g(count,)g(datatype\))249 2130 y(})249 2184
y(if)h(\(rank)g(<)h(groupsize-1\))d({)336 2238 y(MPI_SEND\()h(sendbuf,)
g(count,)h(datatype,)f(rank+1,)g(...\))249 2292 y(})249
2346 y(/*)h(answer)g(now)g(resides)g(in)g(process)f(groupsize-1)g(...)h
(now)g(send)g(to)g(root)271 2400 y(*/)249 2454 y(if)g(\(rank)g(==)h
(groupsize-1\))d({)336 2508 y(MPI_SEND\()h(sendbuf,)g(count,)h
(datatype,)f(root,)h(...\))p eop
%%Page: 192 206
192 205 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(192)1256 b(Chapter)13 b(4)249
507 y Fr(})249 561 y(if)21 b(\(rank)g(==)h(root\))e({)336
615 y(MPI_RECV\(recvbuf,)f(count,)h(datatype,)g(groupsize-1,...\))249
669 y(})249 777 y FA(The)25 b(reduction)h(computation)d(pro)q(ceeds,)30
b(sequen)o(tially)m(,)c(from)d(pro)q(cess)k Fr(0)e FA(to)g(pro)q(cess)
249 831 y Fr(groupsize-1)p FA(.)g(This)17 b(order)h(is)f(c)o(hosen)g
(so)h(as)f(to)f(resp)q(ect)k(the)d(order)h(of)e(a)h(p)q(ossibly)g(non-)
249 885 y(comm)o(utativ)o(e)e(op)q(erator)k(de\014ned)h(b)o(y)e(the)h
(function)f Fr(User)p 1217 885 14 2 v 15 w(reduce\(\))p
FA(.)29 b(A)19 b(more)e(e\016cien)o(t)249 939 y(implemen)o(tation)11
b(is)k(ac)o(hiev)o(ed)g(b)o(y)g(taking)f(adv)n(an)o(tage)g(of)g(asso)q
(ciativit)o(y)g(and)h(using)f(a)h(loga-)249 993 y(rithmic)f(tree)k
(reduction.)24 b(Comm)o(utativi)o(t)o(y)13 b(can)j(b)q(e)g(used)h(to)f
(adv)n(an)o(tage,)f(for)g(those)i(cases)249 1047 y(in)h(whic)o(h)g(the)
g Fw(commute)f FA(argumen)o(t)g(to)h Fw(MPI)p 1000 1047
13 2 v 14 w(OP)p 1072 1047 V 15 w(CREA)m(TE)e FA(is)i(true.)31
b(Also,)19 b(the)f(amoun)o(t)249 1101 y(of)13 b(temp)q(orary)g
(bu\013er)h(required)h(can)e(b)q(e)i(reduced,)f(and)g(comm)o(unicati)o
(on)d(can)i(b)q(e)i(pip)q(elined)249 1155 y(with)e(computation,)f(b)o
(y)h(transferring)h(and)f(reducing)h(the)g(elemen)o(ts)g(in)f(c)o(h)o
(unks)h(of)f(size)h Fr(len)249 1209 y Fp(<)p Fr(count)p
FA(.)249 1279 y(The)h(prede\014ned)i(reduce)g(op)q(erations)e(can)g(b)q
(e)h(implem)o(en)o(ted)d(as)i(a)g(library)f(of)g(user-de\014ned)249
1333 y(op)q(erations.)21 b(Ho)o(w)o(ev)o(er,)15 b(b)q(etter)h(p)q
(erformance)f(migh)o(t)e(b)q(e)i(ac)o(hiev)o(ed)g(if)f
Fw(MPI)p 1474 1333 V 15 w(REDUCE)f FA(han-)249 1387 y(dles)h(these)i
(functions)e(as)g(a)f(sp)q(ecial)h(case.)19 b(\()p FB(End)d(of)f(advic)
n(e)g(to)g(implementors.)p FA(\))249 1549 y Fw(MPI)p
326 1549 V 14 w(OP)p 398 1549 V 14 w(FREE\()e(op\))332
1624 y Fv(IN)158 b Fw(op)504 b Fv(op)q(eration)249 1734
y Fr(int)21 b(MPI)p 405 1734 14 2 v 15 w(op)p 464 1734
V 16 w(free\()f(MPI)p 676 1734 V 15 w(Op)i(*op\))249
1818 y(MPI)p 318 1818 V 15 w(OP)p 377 1818 V 15 w(FREE\()f(OP,)g
(IERROR\))336 1872 y(INTEGER)g(OP,)g(IERROR)291 1956
y FA(Marks)12 b(a)f(user-de\014ned)j(reduction)f(op)q(eration)e(for)h
(deallo)q(cation)f(and)g(sets)i Fw(op)f FA(to)g Fq(MPI)p
1667 1956 12 2 v 13 w(OP-)p 249 2010 V 261 2010 a(NULL)p
FA(.)291 2064 y(The)i(follo)o(wing)d(t)o(w)o(o)j(examples)f(illustrate)
g(usage)h(of)g(user-de\014ned)i(reduction.)249 2160 y
Fs(Example)f(4.22)21 b FA(Compute)13 b(the)h(pro)q(duct)h(of)e(an)h
(arra)o(y)g(of)f(complex)f(n)o(um)o(b)q(ers,)h(in)h(C.)249
2214 y Fr(typedef)20 b(struct)h({)336 2268 y(double)g(real,imag;)249
2322 y(})h(Complex;)249 2429 y(/*)f(the)h(user-defined)d(function)271
2483 y(*/)p eop
%%Page: 193 207
193 206 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(193)249 507 y Fr(void)21 b(myProd\()f(Complex)h(*in,)g(Complex)f
(*inout,)g(int)i(*len,)e(MPI_Datatype)g(*dptr)g(\))249
561 y({)336 615 y(int)h(i;)336 669 y(Complex)g(c;)336
777 y(for)g(\(i=0;)g(i<)h(*len;)e(++i\))h({)423 831 y(c.real)g(=)h
(inout->real*in-)o(>real)c(-)663 885 y(inout->imag*in->im)o(ag;)423
939 y(c.imag)j(=)h(inout->real*in-)o(>imag)c(+)663 993
y(inout->imag*in->re)o(al;)423 1047 y(*inout)j(=)h(c;)423
1101 y(in++;)f(inout++;)336 1155 y(})249 1209 y(})249
1317 y(/*)g(and,)g(to)h(call)f(it...)271 1371 y(*/)249
1425 y(...)336 1533 y(/*)h(each)f(process)f(has)h(an)g(array)g(of)h
(100)f(Complexes)358 1587 y(*/)336 1641 y(Complex)g(a[100],)f
(answer[100];)336 1694 y(MPI_Op)h(myOp;)336 1748 y(MPI_Datatype)f
(ctype;)336 1856 y(/*)i(explain)e(to)h(MPI)h(how)f(type)g(Complex)f(is)
h(defined)358 1910 y(*/)336 1964 y(MPI_Type_contiguous)o(\()e(2,)i
(MPI_DOUBLE,)f(&ctype)g(\);)336 2018 y(MPI_Type_commit\()f(&ctype)h
(\);)336 2072 y(/*)i(create)e(the)h(complex-product)e(user-op)358
2126 y(*/)336 2180 y(MPI_Op_create\()g(myProd,)h(True,)h(&myOp)g(\);)
336 2288 y(MPI_Reduce\()f(a,)h(answer,)f(100,)h(ctype,)g(myOp,)g(root,)
g(comm)f(\);)336 2396 y(/*)i(At)f(this)g(point,)g(the)g(answer,)f
(which)h(consists)f(of)h(100)g(Complexes,)358 2450 y(*)h(resides)e(on)h
(process)g(root)358 2504 y(*/)p eop
%%Page: 194 208
194 207 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(194)1256 b(Chapter)13 b(4)249
592 y Fs(Example)i(4.23)21 b FA(This)10 b(example)g(uses)h(a)g
(user-de\014ned)h(op)q(eration)f(to)f(pro)q(duce)i(a)e
FB(se)n(gmente)n(d)249 646 y(sc)n(an)p FA(.)24 b(A)16
b(segmen)o(ted)g(scan)g(tak)o(es,)g(as)g(input,)f(a)h(set)g(of)f(v)n
(alues)h(and)f(a)h(set)g(of)f(logicals,)g(and)249 700
y(the)g(logicals)d(delineate)i(the)h(v)n(arious)e(segmen)o(ts)h(of)f
(the)i(scan.)j(F)m(or)c(example:)311 750 y Fp(v)q(al)q(ues)65
b(v)514 756 y Fk(1)619 750 y Fp(v)639 756 y Fk(2)744
750 y Fp(v)764 756 y Fk(3)869 750 y Fp(v)889 756 y Fk(4)1084
750 y Fp(v)1104 756 y Fk(5)1254 750 y Fp(v)1274 756 y
Fk(6)1379 750 y Fp(v)1399 756 y Fk(7)1504 750 y Fp(v)1524
756 y Fk(8)311 804 y Fp(l)q(og)q(ical)q(s)52 b FA(0)104
b(0)g(1)g(1)194 b(1)149 b(0)104 b(0)f(1)311 858 y Fp(r)q(esul)q(t)73
b(v)514 864 y Fk(1)575 858 y Fp(v)595 864 y Fk(1)623
858 y FA(+)9 b Fp(v)684 864 y Fk(2)744 858 y Fp(v)764
864 y Fk(3)825 858 y Fp(v)845 864 y Fk(3)873 858 y FA(+)g
Fp(v)934 864 y Fk(4)994 858 y Fp(v)1014 864 y Fk(3)1042
858 y FA(+)h Fp(v)1104 864 y Fk(4)1132 858 y FA(+)f Fp(v)1193
864 y Fk(5)1254 858 y Fp(v)1274 864 y Fk(6)1334 858 y
Fp(v)1354 864 y Fk(6)1382 858 y FA(+)g Fp(v)1443 864
y Fk(7)1504 858 y Fp(v)1524 864 y Fk(8)249 907 y FA(The)14
b(op)q(erator)h(that)f(pro)q(duces)h(this)f(e\013ect)i(is,)291
925 y Fi(\022)342 957 y Fp(u)347 1011 y(i)386 925 y Fi(\023)426
983 y Ft(\016)456 925 y Fi(\022)507 957 y Fp(v)509 1011
y(j)550 925 y Fi(\023)592 983 y FA(=)636 925 y Fi(\022)687
957 y Fp(w)693 1011 y(j)739 925 y Fi(\023)776 983 y Fp(;)249
1060 y FA(where,)291 1136 y Fp(w)c FA(=)377 1078 y Fi(\032)429
1110 y Fp(u)d FA(+)g Fp(v)43 b FA(if)13 b Fp(i)f FA(=)g
Fp(j)429 1164 y(v)117 b FA(if)13 b Fp(i)f Ft(6)p FA(=)g
Fp(j)726 1136 y(:)249 1213 y FA(Note)j(that)f(this)h(is)f(a)g(non-comm)
o(utati)o(v)o(e)e(op)q(erator.)20 b(C)14 b(co)q(de)h(that)g(implemen)o
(ts)d(it)i(is)g(giv)o(en)249 1267 y(b)q(elo)o(w.)249
1321 y Fr(typedef)20 b(struct)h({)336 1375 y(double)g(val;)336
1429 y(int)g(log;)249 1483 y(})h(SegScanPair;)249 1591
y(/*)f(the)h(user-defined)d(function)271 1645 y(*/)249
1699 y(void)i(segScan\()f(SegScanPair)g(*in,)h(SegScanPair)e(*inout,)i
(int)g(*len,)1295 1753 y(MPI_Datatype)e(*dptr)i(\))249
1807 y({)336 1861 y(int)g(i;)336 1914 y(SegScanPair)f(c;)336
2022 y(for)h(\(i=0;)g(i<)h(*len;)e(++i\))h({)423 2076
y(if)h(\()f(in->log)g(==)g(inout->log)f(\))511 2130 y(c.val)g(=)i
(in->val)e(+)i(inout->val;)423 2184 y(else)511 2238 y(c.val)e(=)i
(inout->val;)423 2292 y(c.log)f(=)h(inout->log;)423 2346
y(*inout)f(=)h(c;)423 2400 y(in++;)f(inout++;)336 2454
y(})249 2508 y(})p eop
%%Page: 195 209
195 208 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(195)423 561 y Fr(/*)22 b(Note)f(that)g(the)g(inout)g(argument)f(to)h
(the)g(user-defined)445 615 y(*)h(function)e(corresponds)f(to)j(the)f
(right-hand)f(operand)g(of)h(the)445 669 y(*)h(operator.)42
b(When)20 b(using)h(this)g(operator,)f(we)i(must)e(be)i(careful)445
723 y(*)g(to)f(specify)g(that)f(it)i(is)f(non-commutative,)e(as)i(in)g
(the)h(following.)445 777 y(*/)336 885 y(int)f(i,base;)336
939 y(SeqScanPair)42 b(a,)21 b(answer;)336 993 y(MPI_Op)152
b(myOp;)336 1047 y(MPI_Datatype)20 b(type[2])g(=)h({MPI_DOUBLE,)f
(MPI_INT};)336 1101 y(MPI_Aint)108 b(disp[2];)336 1155
y(int)218 b(blocklen[2])19 b(=)j({)f(1,)h(1};)336 1209
y(MPI_Datatype)e(sspair;)336 1317 y(/*)i(explain)e(to)h(MPI)h(how)f
(type)g(SegScanPair)e(is)j(defined)358 1371 y(*/)336
1425 y(MPI_Address\()e(a,)h(disp\);)336 1479 y(MPI_Address\()f(a.log,)g
(disp+1\);)336 1533 y(base)h(=)h(disp[0];)336 1587 y(for)f(\(i=0;)g
(i<2;)g(++i\))g(disp[i])f(-=)i(base;)336 1641 y(MPI_Type_struct\()d(2,)
i(blocklen,)f(disp,)h(type,)g(&sspair)f(\);)336 1694
y(MPI_Type_commit\()f(&sspair)h(\);)336 1748 y(/*)i(create)e(the)h
(segmented-scan)e(user-op)358 1802 y(*/)336 1856 y(MPI_Op_create\()g
(segScan,)h(False,)h(&myOp)g(\);)336 1910 y(...)336 1964
y(MPI_Scan\()f(a,)i(answer,)e(1,)h(sspair,)g(myOp,)f(root,)h(comm)g
(\);)249 2139 y FD(4.13)52 b(The)18 b(Seman)o(tics)g(of)f(Collectiv)o
(e)i(Comm)o(unications)249 2247 y FA(A)c(correct,)i(p)q(ortable)e
(program)e(m)o(ust)h(in)o(v)o(ok)o(e)g(collectiv)o(e)h(comm)o
(unications)d(so)j(that)g(dead-)249 2301 y(lo)q(c)o(k)i(will)f(not)h(o)
q(ccur,)i(whether)f(collectiv)o(e)g(comm)o(uni)o(cations)d(are)i(sync)o
(hronizing)h(or)f(not.)249 2355 y(The)d(follo)o(wing)e(examples)h
(illustrate)g(dangerous)i(use)f(of)g(collectiv)o(e)f(routines.)p
eop
%%Page: 196 210
196 209 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(196)1256 b(Chapter)13 b(4)249
507 y Fs(Example)i(4.24)21 b FA(The)14 b(follo)o(wing)d(is)j
(erroneous.)249 561 y Fr(switch\(rank\))19 b({)336 615
y(case)i(0:)423 669 y(MPI_Bcast\(buf1,)e(count,)i(type,)f(0,)i(comm\);)
423 723 y(MPI_Bcast\(buf2,)d(count,)i(type,)f(1,)i(comm\);)423
777 y(break;)336 831 y(case)f(1:)423 885 y(MPI_Bcast\(buf2,)e(count,)i
(type,)f(1,)i(comm\);)423 939 y(MPI_Bcast\(buf1,)d(count,)i(type,)f(0,)
i(comm\);)423 993 y(break;)249 1047 y(})291 1155 y FA(W)m(e)9
b(assume)g(that)h(the)h(group)f(of)f Fw(comm)f FA(is)i
Ft(f)p FA(0,1)p Ft(g)p FA(.)15 b(Tw)o(o)9 b(pro)q(cesses)k(execute)e(t)
o(w)o(o)f(broadcast)249 1209 y(op)q(erations)i(in)f(rev)o(erse)i
(order.)18 b Fw(MPI)11 b FA(ma)o(y)f(matc)o(h)g(the)i(\014rst)g
(broadcast)g(call)f(of)g(eac)o(h)h(pro)q(cess,)249 1263
y(resulting)i(in)g(an)g(error,)h(since)g(the)g(calls)e(do)h(not)g(sp)q
(ecify)h(the)g(same)e(ro)q(ot.)19 b(Alternativ)o(ely)m(,)13
b(if)249 1317 y Fw(MPI)h FA(matc)o(hes)h(the)h(calls)e(correctly)m(,)i
(then)f(a)g(deadlo)q(c)o(k)g(will)e(o)q(ccur)j(if)f(the)g(the)h(op)q
(eration)f(is)249 1371 y(sync)o(hronizing.)291 1425 y(Collectiv)o(e)f
(op)q(erations)g(m)o(ust)g(b)q(e)h(executed)h(in)e(the)h(same)e(order)i
(at)g(all)e(mem)o(b)q(ers)g(of)h(the)249 1479 y(comm)o(unication)c
(group.)249 1574 y Fs(Example)15 b(4.25)21 b FA(The)14
b(follo)o(wing)d(is)j(erroneous.)249 1628 y Fr(switch\(rank\))19
b({)336 1682 y(case)i(0:)423 1736 y(MPI_Bcast\(buf1,)e(count,)i(type,)f
(0,)i(comm0\);)423 1790 y(MPI_Bcast\(buf2,)d(count,)i(type,)f(2,)i
(comm2\);)423 1844 y(break;)336 1898 y(case)f(1:)423
1952 y(MPI_Bcast\(buf1,)e(count,)i(type,)f(1,)i(comm1\);)423
2006 y(MPI_Bcast\(buf2,)d(count,)i(type,)f(0,)i(comm0\);)423
2060 y(break;)336 2114 y(case)f(2:)423 2168 y(MPI_Bcast\(buf1,)e
(count,)i(type,)f(2,)i(comm2\);)423 2222 y(MPI_Bcast\(buf2,)d(count,)i
(type,)f(1,)i(comm1\);)423 2276 y(break;)249 2330 y(})291
2438 y FA(Assume)15 b(that)g(the)h(group)g(of)e Fw(comm0)g
FA(is)h Ft(f)p FA(0,1)p Ft(g)p FA(,)f(of)g Fw(comm1)g
FA(is)h Ft(f)p FA(1,)g(2)p Ft(g)f FA(and)i(of)e Fw(comm2)g
FA(is)249 2492 y Ft(f)p FA(2,0)p Ft(g)p FA(.)21 b(If)14
b(the)i(broadcast)g(is)f(a)g(sync)o(hronizing)g(op)q(eration,)g(then)h
(there)h(is)e(a)g(cyclic)g(dep)q(en-)p eop
%%Page: 197 211
197 210 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(197)249 507 y FA(dency:)21 b(the)15 b(broadcast)g(in)f
Fw(comm2)f FA(completes)i(only)e(after)i(the)h(broadcast)f(in)f
Fw(comm0)p FA(;)f(the)249 561 y(broadcast)i(in)f Fw(comm0)e
FA(completes)i(only)g(after)g(the)h(broadcast)g(in)f
Fw(comm1)p FA(;)e(and)i(the)h(broad-)249 615 y(cast)h(in)f
Fw(comm1)f FA(completes)h(only)g(after)h(the)g(broadcast)g(in)f
Fw(comm2)p FA(.)21 b(Th)o(us,)16 b(the)g(co)q(de)h(will)249
669 y(deadlo)q(c)o(k.)291 723 y(Collectiv)o(e)10 b(op)q(erations)h(m)o
(ust)f(b)q(e)i(executed)g(in)f(an)f(order)i(so)f(that)g(no)g(cyclic)g
(dep)q(endencies)249 777 y(o)q(ccur.)249 860 y Fs(Example)k(4.26)21
b FA(The)14 b(follo)o(wing)d(is)j(erroneous.)249 914
y Fr(switch\(rank\))19 b({)336 968 y(case)i(0:)423 1022
y(MPI_Bcast\(buf1,)e(count,)i(type,)f(0,)i(comm\);)423
1076 y(MPI_Send\(buf2,)d(count,)i(type,)g(1,)g(tag,)g(comm\);)423
1130 y(break;)336 1184 y(case)g(1:)423 1238 y(MPI_Recv\(buf2,)e(count,)
i(type,)g(0,)g(tag,)g(comm\);)423 1292 y(MPI_Bcast\(buf1,)e(count,)i
(type,)f(0,)i(comm\);)423 1346 y(break;)249 1400 y(})291
1508 y FA(Pro)q(cess)12 b(zero)f(executes)i(a)d(broadcast,)h(follo)o(w)
o(ed)e(b)o(y)h(a)g(blo)q(c)o(king)f(send)j(op)q(eration.)k(Pro)q(cess)
249 1562 y(one)f(\014rst)g(executes)i(a)e(blo)q(c)o(king)f(receiv)o(e)i
(that)e(matc)o(hes)h(the)g(send,)g(follo)o(w)o(ed)e(b)o(y)i(broadcast)
249 1616 y(call)e(that)h(matc)o(hes)g(the)g(broadcast)h(of)e(pro)q
(cess)j(zero.)j(This)14 b(program)e(ma)o(y)g(deadlo)q(c)o(k.)18
b(The)249 1670 y(broadcast)e(call)f(on)g(pro)q(cess)i(zero)f
FB(may)g FA(blo)q(c)o(k)f(un)o(til)f(pro)q(cess)j(one)f(executes)h(the)
f(matc)o(hing)249 1724 y(broadcast)g(call,)f(so)h(that)f(the)h(send)h
(is)e(not)h(executed.)25 b(Pro)q(cess)17 b(one)f(will)e(de\014nitely)i
(blo)q(c)o(k)249 1778 y(on)e(the)g(receiv)o(e)h(and)f(so,)g(in)f(this)h
(case,)g(nev)o(er)h(executes)h(the)f(broadcast.)291 1831
y(The)e(relativ)o(e)f(order)h(of)f(execution)h(of)f(collectiv)o(e)h(op)
q(erations)g(and)f(p)q(oin)o(t-to-p)q(oin)o(t)f(op)q(era-)249
1885 y(tions)g(should)g(b)q(e)h(suc)o(h,)g(so)f(that)h(ev)o(en)g(if)e
(the)i(collectiv)o(e)f(op)q(erations)h(and)f(the)h(p)q(oin)o(t-to-p)q
(oin)o(t)249 1939 y(op)q(erations)i(are)h(sync)o(hronizing,)e(no)h
(deadlo)q(c)o(k)f(will)g(o)q(ccur.)249 2022 y Fs(Example)i(4.27)21
b FA(A)14 b(correct,)h(but)f(non-deterministic)f(program.)249
2076 y Fr(switch\(rank\))19 b({)336 2130 y(case)i(0:)423
2184 y(MPI_Bcast\(buf1,)e(count,)i(type,)f(0,)i(comm\);)423
2238 y(MPI_Send\(buf2,)d(count,)i(type,)g(1,)g(tag,)g(comm\);)423
2292 y(break;)336 2346 y(case)g(1:)423 2400 y(MPI_Recv\(buf2,)e(count,)
i(type,)g(MPI_ANY_SOURCE,)d(tag,)j(comm\);)423 2454 y(MPI_Bcast\(buf1,)
e(count,)i(type,)f(0,)i(comm\);)423 2508 y(MPI_Recv\(buf2,)d(count,)i
(type,)g(MPI_ANY_SOURCE,)d(tag,)j(comm\);)p eop
%%Page: 198 212
198 211 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(198)1256 b(Chapter)13 b(4)423
507 y Fr(break;)336 561 y(case)21 b(2:)423 615 y(MPI_Send\(buf2,)e
(count,)i(type,)g(1,)g(tag,)g(comm\);)423 669 y(MPI_Bcast\(buf1,)e
(count,)i(type,)f(0,)i(comm\);)423 723 y(break;)249 777
y(})291 885 y FA(All)c(three)i(pro)q(cesses)i(participate)d(in)g(a)g
(broadcast.)34 b(Pro)q(cess)22 b(0)c(sends)j(a)e(message)g(to)249
939 y(pro)q(cess)f(1)f(after)g(the)g(broadcast,)g(and)f(pro)q(cess)j(2)
d(sends)i(a)e(message)h(to)f(pro)q(cess)i(1)f(b)q(efore)249
993 y(the)f(broadcast.)23 b(Pro)q(cess)17 b(1)e(receiv)o(es)i(b)q
(efore)f(and)g(after)f(the)h(broadcast,)g(with)f(a)g(wildcard)249
1047 y(source)g(argumen)o(t.)291 1101 y(Tw)o(o)f(p)q(ossible)i
(executions)g(of)e(this)i(program,)d(with)i(di\013eren)o(t)h(matc)o
(hings)e(of)g(sends)j(and)249 1155 y(receiv)o(es,)k(are)e(illustrated)f
(in)g(Figure)h(4.13.)31 b(Note)19 b(that)f(the)h(second)h(execution)f
(has)g(the)249 1209 y(p)q(eculiar)13 b(e\013ect)i(that)d(a)h(send)h
(executed)g(after)f(the)h(broadcast)f(is)g(receiv)o(ed)h(at)f(another)g
(no)q(de)249 1263 y(b)q(efore)18 b(the)g(broadcast.)30
b(This)17 b(example)f(illustrates)i(the)g(fact)f(that)h(one)g(should)f
(not)g(rely)249 1317 y(on)g(collectiv)o(e)h(comm)o(unicatio)o(n)d
(functions)i(to)h(ha)o(v)o(e)f(particular)g(sync)o(hronization)h
(e\013ects.)249 1371 y(A)f(program)d(that)j(w)o(orks)f(correctly)i
(only)e(when)h(the)g(\014rst)g(execution)g(o)q(ccurs)h(\(only)e(when)
249 1425 y(broadcast)f(is)e(sync)o(hronizing\))h(is)g(erroneous.)291
1508 y(Finally)m(,)c(in)j(m)o(ultithreaded)f(implem)o(en)o(tations,)e
(one)k(can)f(ha)o(v)o(e)g(more)f(than)h(one,)g(concur-)249
1562 y(ren)o(tly)j(executing,)h(collectiv)o(e)e(comm)o(unication)e
(calls)i(at)h(a)f(pro)q(cess.)26 b(In)16 b(these)h(situations,)249
1616 y(it)h(is)g(the)h(user's)g(resp)q(onsibilit)o(y)e(to)h(ensure)i
(that)e(the)h(same)e(comm)o(unicator)e(is)j(not)h(used)249
1670 y(concurren)o(tly)c(b)o(y)f(t)o(w)o(o)f(di\013eren)o(t)i
(collectiv)o(e)f(comm)o(unicatio)o(n)d(calls)j(at)g(the)g(same)f(pro)q
(cess.)249 1759 y FB(A)n(dvic)n(e)k(to)g(implementors.)49
b FA(Assume)16 b(that)g(broadcast)h(is)f(implem)o(en)o(ted)f(using)g(p)
q(oin)o(t-to-)249 1813 y(p)q(oin)o(t)e Fw(MPI)h FA(comm)o(unicati)o
(on.)h(Supp)q(ose)g(the)g(follo)o(wing)c(t)o(w)o(o)i(rules)i(are)f
(follo)o(w)o(ed.)291 1881 y(1.)20 b(All)13 b(receiv)o(es)i(sp)q(ecify)g
(their)f(source)h(explicitly)e(\(no)h(wildcards\).)291
1949 y(2.)20 b(Eac)o(h)11 b(pro)q(cess)j(sends)e(all)f(messages)g(that)
h(p)q(ertain)f(to)h(one)f(collectiv)o(e)h(call)e(b)q(efore)j(send-)291
2003 y(ing)g(an)o(y)g(message)h(that)g(p)q(ertain)g(to)g(a)f(subsequen)
o(t)j(collectiv)o(e)e(call.)249 2071 y(Then,)e(messages)f(b)q(elonging)
f(to)h(successiv)o(e)j(broadcasts)e(cannot)f(b)q(e)h(confused,)g(as)f
(the)h(order)249 2125 y(of)h(p)q(oin)o(t-to-p)q(oin)o(t)g(messages)h
(is)g(preserv)o(ed.)249 2193 y(It)k(is)g(the)h(implemen)o(tor's)c(resp)
q(onsibilit)o(y)j(to)g(ensure)i(that)e(p)q(oin)o(t-to-p)q(oin)o(t)f
(messages)h(are)249 2247 y(not)f(confused)i(with)e(collectiv)o(e)g
(messages.)29 b(One)18 b(w)o(a)o(y)f(to)g(accomplish)f(this)h(is,)h
(whenev)o(er)249 2301 y(a)e(comm)o(uni)o(cator)d(is)j(created,)h(to)f
(also)f(create)i(a)f(\\hidden)f(comm)o(unicator")e(for)i(collectiv)o(e)
249 2355 y(comm)o(unication.)20 b(One)c(could)f(ac)o(hiev)o(e)h(a)f
(similar)e(e\013ect)18 b(more)c(c)o(heaply)m(,)h(for)g(example,)g(b)o
(y)249 2409 y(using)e(a)f(hidden)h(tag)g(or)f(con)o(text)i(bit)e(to)h
(indicate)g(whether)h(the)f(comm)o(unicator)d(is)j(used)h(for)249
2463 y(p)q(oin)o(t-to-p)q(oin)o(t)f(or)g(collectiv)o(e)h(comm)o
(unication.)h(\()p FB(End)h(of)e(advic)n(e)i(to)e(implementors.)p
FA(\))p eop
%%Page: 199 213
199 212 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Collectiv)o(e)15 b(Comm)o(unications)982
b(199)403 466 y
 18945146 16482269 0 0 29733355 25918013 startTexFig
 403 466 a
%%BeginDocument: ../figures/coll-matchings.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-50 0 translate
-40.0 436.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 469 134 m 334 134 l gs col-1 s gr
n 342.000 136.000 m 334.000 134.000 l 342.000 132.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 154 399 m 284 399 l gs col-1 s gr
n 276.000 397.000 m 284.000 399.000 l 276.000 401.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 469 454 m 329 454 l gs col-1 s gr
n 337.000 456.000 m 329.000 454.000 l 337.000 452.000 l gs 2 setlinejoin col-1 s gr
/Times-Italic findfont 18.00 scalefont setfont
279 59 m 
gs 1 -1 scale (First Execution) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
274 299 m 
gs 1 -1 scale (Second Execution) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
139 94 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
319 94 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
509 94 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
294 194 m 
gs 1 -1 scale (recv) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
119 164 m 
gs 1 -1 scale (broadcast) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
294 164 m 
gs 1 -1 scale (broadcast) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
484 164 m 
gs 1 -1 scale (broadcast) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
119 194 m 
gs 1 -1 scale (send) col-1 show gr
% Polyline
n 159 189 m 279 189 l gs col-1 s gr
n 271.000 187.000 m 279.000 189.000 l 271.000 191.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 16.00 scalefont setfont
294 139 m 
gs 1 -1 scale (recv) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
44 94 m 
gs 1 -1 scale (process:) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
484 139 m 
gs 1 -1 scale (send) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
199 184 m 
gs 1 -1 scale (match) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
384 129 m 
gs 1 -1 scale (match) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
294 429 m 
gs 1 -1 scale (broadcast) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
294 404 m 
gs 1 -1 scale (recv) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
294 459 m 
gs 1 -1 scale (recv) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
479 459 m 
gs 1 -1 scale (send) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
479 484 m 
gs 1 -1 scale (broadcast) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
119 404 m 
gs 1 -1 scale (send) col-1 show gr
/Times-Roman findfont 16.00 scalefont setfont
119 379 m 
gs 1 -1 scale (broadcast) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
194 394 m 
gs 1 -1 scale (match) col-1 show gr
/Times-Italic findfont 16.00 scalefont setfont
379 449 m 
gs 1 -1 scale (match) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1572 a Fo(Figure)13 b(4.13)249 1609 y Fz(A)f(race)f(condition)e
(causes)h(non-determ)o(inis)o(tic)e(matc)o(hing)h(of)i(sends)g(and)g
(receiv)o(es.)i(One)e(cannot)f(rely)h(on)249 1647 y(sync)o(hronizat)o
(ion)d(from)j(a)g(broadcast)e(to)i(mak)o(e)f(the)h(program)e
(deterministic)o(.)p eop
%%Page: 200 214
200 213 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(200)1256 b(Chapter)13 b(4)p
eop
%%Page: 201 215
201 214 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 325 a Fu(5)25 b FD(Comm)o(unicators)249
628 y(5.1)52 b(In)o(tro)q(duction)249 736 y FA(It)14
b(w)o(as)f(the)h(in)o(ten)o(t)g(of)f(the)h(creators)h(of)e(the)h
Fw(MPI)f FA(standard)h(to)f(address)i(sev)o(eral)f(issues)g(that)249
790 y(augmen)o(t)c(the)i(p)q(o)o(w)o(er)g(and)g(usefulness)h(of)e(p)q
(oin)o(t-to-p)q(oin)o(t)f(and)h(collectiv)o(e)h(comm)o(unicatio)o(ns.)
249 844 y(These)17 b(issues)f(are)g(mainly)c(concerned)18
b(with)c(the)i(the)g(creation)g(of)f(p)q(ortable,)g(e\016cien)o(t)h
(and)249 897 y(safe)d(libraries)f(and)h(co)q(des)h(with)e
Fw(MPI)p FA(,)g(and)g(will)g(b)q(e)h(discussed)h(in)f(this)f(c)o
(hapter.)19 b(This)13 b(e\013ort)249 951 y(w)o(as)k(driv)o(en)f(b)o(y)h
(the)g(need)g(to)g(o)o(v)o(ercome)f(sev)o(eral)h(limitatio)o(ns)d(in)j
(man)o(y)d(message)j(passing)249 1005 y(systems.)h(The)d(next)f(few)g
(sections)h(describ)q(e)h(these)f(limitatio)o(ns.)249
1088 y Fs(5.1.1)48 b(Division)13 b(of)i(Pro)q(cesses)249
1171 y FA(In)j(some)g(applications)f(it)h(is)g(desirable)h(to)f(divide)
g(up)h(the)g(pro)q(cesses)i(to)d(allo)o(w)e(di\013eren)o(t)249
1225 y(groups)e(of)f(pro)q(cesses)k(to)c(p)q(erform)g(indep)q(enden)o
(t)i(w)o(ork.)j(F)m(or)c(example,)e(w)o(e)i(migh)o(t)d(w)o(an)o(t)j(an)
249 1279 y(application)c(to)h(utilize)635 1263 y Fk(2)p
635 1270 17 2 v 635 1294 a(3)668 1279 y FA(of)f(its)h(pro)q(cesses)j
(to)d(predict)h(the)g(w)o(eather)f(based)h(on)f(data)g(already)249
1333 y(pro)q(cessed,)j(while)d(the)i(other)732 1317 y
Fk(1)p 732 1324 V 732 1348 a(3)765 1333 y FA(of)e(the)h(pro)q(cesses)j
(initially)9 b(pro)q(cess)14 b(new)e(data.)17 b(This)11
b(w)o(ould)249 1387 y(allo)o(w)h(the)i(application)e(to)h(regularly)g
(complete)g(a)g(w)o(eather)h(forecast.)19 b(Ho)o(w)o(ev)o(er,)13
b(if)g(no)g(new)249 1441 y(data)f(is)h(a)o(v)n(ailable)d(for)j(pro)q
(cessing)g(w)o(e)g(migh)o(t)e(w)o(an)o(t)h(the)h(same)f(application)f
(to)i(use)g(all)e(of)h(its)249 1495 y(pro)q(cesses)17
b(to)c(mak)o(e)g(a)g(w)o(eather)i(forecast.)291 1549
y(Being)j(able)g(to)f(do)h(this)g(e\016cien)o(tly)g(and)g(easily)g
(requires)h(the)g(application)d(to)i(b)q(e)h(able)249
1603 y(to)g(logically)e(divide)i(the)g(pro)q(cesses)j(in)o(to)d(indep)q
(enden)o(t)h(subsets.)36 b(It)19 b(is)g(imp)q(ortan)o(t)e(that)249
1657 y(these)d(subsets)g(are)f(logically)d(the)j(same)f(as)g(the)h
(initial)e(set)i(of)f(pro)q(cesses.)20 b(F)m(or)12 b(example,)f(the)249
1711 y(mo)q(dule)k(to)h(predict)h(the)f(w)o(eather)h(migh)o(t)d(use)j
(pro)q(cess)h(0)e(as)g(the)h(master)f(pro)q(cess)i(to)e(dole)249
1765 y(out)c(w)o(ork.)17 b(If)12 b(subsets)i(of)e(pro)q(cesses)i(are)f
(not)f(n)o(um)o(b)q(ered)g(in)g(a)f(consisten)o(t)j(manner)d(with)h
(the)249 1819 y(initial)h(set)k(of)e(pro)q(cesses,)i(then)f(there)h(ma)
o(y)d(b)q(e)i(no)f(pro)q(cess)i(0)e(in)g(one)g(of)g(the)h(t)o(w)o(o)f
(subsets.)249 1873 y(This)f(w)o(ould)f(cause)i(the)f(w)o(eather)h
(prediction)f(mo)q(del)f(to)g(fail.)291 1927 y(Applications)c(also)h
(need)h(to)f(ha)o(v)o(e)h(collectiv)o(e)f(op)q(erations)h(w)o(ork)f(on)
g(a)g(subset)i(of)d(pro)q(cesses.)249 1981 y(If)j(collectiv)o(e)f(op)q
(erations)h(only)f(w)o(ork)h(on)g(the)g(initial)e(set)j(of)e(pro)q
(cesses)j(then)f(it)e(is)h(imp)q(ossible)249 2035 y(to)k(create)h
(indep)q(enden)o(t)g(subsets)h(that)e(p)q(erform)f(collectiv)o(e)h(op)q
(erations.)24 b(Ev)o(en)16 b(if)f(the)i(ap-)249 2089
y(plication)c(do)q(es)j(not)e(need)i(indep)q(enden)o(t)g(subsets,)g(ha)
o(ving)e(collectiv)o(e)g(op)q(erations)h(w)o(ork)g(on)249
2143 y(subsets)e(is)f(desirable.)17 b(Since)12 b(the)h(time)d(to)h
(complete)g(most)f(collectiv)o(e)i(op)q(erations)g(increases)249
2197 y(with)i(the)h(n)o(um)o(b)q(er)f(of)f(pro)q(cesses,)k(limiting)11
b(a)j(collectiv)o(e)g(op)q(eration)g(to)g(only)g(the)h(pro)q(cesses)249
2251 y(that)j(need)g(to)g(b)q(e)g(in)o(v)o(olv)o(ed)f(yields)g(m)o(uc)o
(h)f(b)q(etter)k(scaling)d(b)q(eha)o(vior.)29 b(F)m(or)17
b(example,)g(if)g(a)249 2305 y(matrix)10 b(computation)g(needs)j(to)e
(broadcast)i(information)c(along)h(the)i(diagonal)e(of)h(a)h(matrix,)
249 2359 y(only)h(the)i(pro)q(cesses)h(con)o(taining)d(diagonal)f
(elemen)o(ts)i(should)f(b)q(e)i(in)o(v)o(olv)o(ed.)965
2613 y(201)p eop
%%Page: 202 216
202 215 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(202)1256 b(Chapter)13 b(5)249
507 y Fs(5.1.2)48 b(Av)o(oiding)13 b(Message)j(Con\015icts)e(Bet)o(w)o
(een)g(Mo)q(dules)249 590 y FA(Library)d(routines)h(ha)o(v)o(e)f
(historically)f(had)h(di\016cult)o(y)g(in)g(isolating)e(their)j(o)o(wn)
f(message)g(pass-)249 644 y(ing)j(calls)h(from)f(those)h(in)g(other)h
(libraries)f(or)g(in)f(the)i(user's)g(co)q(de.)23 b(F)m(or)15
b(example,)e(supp)q(ose)249 698 y(the)j(user's)h(co)q(de)f(p)q(osts)g
(a)f(non-blo)q(c)o(king)g(receiv)o(e)h(with)g(b)q(oth)f(tag)g(and)h
(source)g(wildcarded)249 752 y(b)q(efore)j(it)e(en)o(ters)j(a)e
(library)f(routine.)30 b(The)19 b(\014rst)f(send)h(in)f(the)g(library)f
(ma)o(y)f(b)q(e)j(receiv)o(ed)249 806 y(b)o(y)f(the)h(user's)h(p)q
(osted)f(receiv)o(e)h(instead)f(of)f(the)h(one)f(p)q(osted)i(b)o(y)e
(the)h(library)m(.)31 b(This)18 b(will)249 860 y(undoubtedly)c(cause)h
(the)f(library)g(to)f(fail.)291 914 y(The)h(solution)e(to)i(this)f
(di\016cult)o(y)g(is)g(to)h(allo)o(w)e(a)h(mo)q(dule)f(to)i(isolate)f
(its)g(message)h(passing)249 968 y(calls)h(from)f(the)i(other)g(mo)q
(dules.)21 b(Some)14 b(applications)h(ma)o(y)e(only)i(determine)g(at)g
(run)h(time)249 1022 y(whic)o(h)f(mo)q(dules)f(will)g(run)h(so)g(it)g
(can)g(b)q(e)h(imp)q(ossible)d(to)i(statically)f(isolate)h(all)f(mo)q
(dules)g(in)249 1076 y(adv)n(ance.)k(This)c(necessitates)i(a)e(run)g
(time)f(callable)g(system)g(to)h(p)q(erform)f(this)h(function.)249
1159 y Fs(5.1.3)48 b(Extensibili)o(t)n(y)13 b(b)o(y)i(Users)249
1242 y FA(W)m(riters)g(of)g(libraries)f(often)h(w)o(an)o(t)g(to)g
(expand)g(the)h(functionalit)o(y)d(of)h(the)i(message)f(passing)249
1296 y(system.)26 b(F)m(or)16 b(example,)f(the)i(library)f(ma)o(y)e(w)o
(an)o(t)j(to)f(create)i(its)e(o)o(wn)g(sp)q(ecial)h(and)f(unique)249
1350 y(collectiv)o(e)g(op)q(eration.)24 b(Suc)o(h)16
b(a)g(collectiv)o(e)g(op)q(eration)g(ma)o(y)e(b)q(e)i(called)g(man)o(y)
e(times)h(if)g(the)249 1404 y(library)e(is)h(called)g(rep)q(etitiv)o
(ely)g(or)g(if)g(m)o(ultiple)d(libraries)j(use)h(the)f(same)g
(collectiv)o(e)g(routine.)249 1458 y(T)m(o)f(p)q(erform)g(the)h
(collectiv)o(e)g(op)q(eration)f(e\016cien)o(tly)h(ma)o(y)e(require)i(a)
g(mo)q(derately)e(exp)q(ensiv)o(e)249 1512 y(calculation)18
b(up)g(fron)o(t)h(suc)o(h)g(as)g(determining)e(the)i(b)q(est)h(comm)o
(unicatio)o(n)c(pattern.)33 b(It)19 b(is)249 1566 y(most)12
b(e\016cien)o(t)i(to)f(reuse)i(the)f(up)f(fron)o(t)g(calculations)g(if)
f(the)i(same)e(the)i(set)g(of)f(pro)q(cesses)j(are)249
1620 y(in)o(v)o(olv)o(ed.)f(This)10 b(is)f(most)g(easily)g(done)h(b)o
(y)f(attac)o(hing)g(the)h(results)h(of)e(the)h(up)g(fron)o(t)f
(calculation)249 1674 y(to)17 b(the)i(set)f(of)f(pro)q(cesses)j(in)o(v)
o(olv)o(ed.)28 b(These)19 b(t)o(yp)q(es)f(of)f(optimization)e(are)j
(routinely)f(done)249 1728 y(in)o(ternally)g(in)h(message)g(passing)g
(systems.)32 b(The)19 b(desire)g(is)f(to)g(allo)o(w)f(others)i(to)f(p)q
(erform)249 1782 y(similar)11 b(optimizations)h(in)h(the)i(same)e(w)o
(a)o(y)m(.)249 1865 y Fs(5.1.4)48 b(Safet)o(y)249 1948
y FA(There)20 b(are)g(t)o(w)o(o)f(philosophies)f(used)j(to)e(pro)o
(vide)g(mec)o(hanisms)e(for)i(creating)g(subgroups,)249
2002 y(isolating)11 b(messages,)h(etc.)18 b(One)13 b(p)q(oin)o(t)e(of)h
(view)g(is)g(to)f(allo)o(w)g(the)h(user)i(total)d(con)o(trol)h(o)o(v)o
(er)g(the)249 2056 y(pro)q(cess.)23 b(This)15 b(allo)o(ws)f(maxim)n(um)
d(\015exibilit)o(y)i(to)i(the)h(user)g(and)f(can,)g(in)f(some)g(cases,)
j(lead)249 2110 y(to)f(fast)h(implemen)o(tati)o(ons.)23
b(The)17 b(other)g(p)q(oin)o(t)f(of)g(view)g(is)h(to)f(ha)o(v)o(e)g
(the)h(message)g(passing)249 2164 y(system)i(con)o(trol)g(these)h
(functions.)34 b(This)19 b(adds)g(a)g(degree)i(of)d(safet)o(y)h(while)g
(limiting)d(the)249 2218 y(mec)o(hanisms)10 b(to)h(those)h(pro)o(vided)
f(b)o(y)h(the)g(system.)17 b Fw(MPI)10 b FA(c)o(hose)j(to)e(use)h(the)g
(latter)g(approac)o(h.)249 2271 y(The)17 b(added)f(safet)o(y)g(w)o(as)g
(deemed)g(to)g(b)q(e)h(v)o(ery)f(imp)q(ortan)o(t)f(for)g(writing)h(p)q
(ortable)g(message)249 2325 y(passing)i(co)q(des.)31
b(Since)19 b(the)f Fw(MPI)f FA(system)h(con)o(trols)g(these)i
(functions,)e(mo)q(dules)f(that)h(are)249 2379 y(written)13
b(indep)q(enden)o(tly)h(can)f(safely)g(p)q(erform)f(these)i(op)q
(erations)f(without)f(w)o(orrying)h(ab)q(out)249 2433
y(con\015icts.)22 b(As)15 b(in)f(other)i(areas,)f Fw(MPI)f
FA(also)g(decided)i(to)f(pro)o(vide)f(a)h(ric)o(h)g(set)g(of)f
(functions)h(so)249 2487 y(that)f(users)h(w)o(ould)e(ha)o(v)o(e)h(the)h
(functionalit)o(y)d(they)i(are)h(lik)o(ely)d(to)i(need.)p
eop
%%Page: 203 217
203 216 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(203)249
507 y FD(5.2)52 b(Ov)o(erview)249 615 y FA(The)14 b(ab)q(o)o(v)o(e)f
(features)i(and)e(sev)o(eral)h(more)f(are)h(pro)o(vided)f(in)g
Fw(MPI)g FA(through)g(comm)o(unicators.)249 669 y(The)18
b(concepts)h(b)q(ehind)f(comm)o(unicators)d(encompass)j(sev)o(eral)g
(cen)o(tral)g(and)f(fundamen)o(tal)249 723 y(ideas)d(in)g
Fw(MPI)p FA(.)e(The)j(imp)q(ortance)e(of)g(comm)o(unicators)f(can)i(b)q
(e)g(seen)i(b)o(y)d(the)i(fact)f(that)g(they)249 777
y(are)h(presen)o(t)h(in)f(most)e(calls)h(in)g Fw(MPI)p
FA(.)g(There)i(are)f(sev)o(eral)g(reasons)g(that)g(these)h(features)g
(are)249 831 y(encapsulated)21 b(in)o(to)d(a)h(single)h
Fw(MPI)e FA(ob)r(ject.)36 b(One)20 b(reason)g(is)f(that)h(it)f
(simpli\014es)f(calls)h(to)249 885 y Fw(MPI)14 b FA(functions.)22
b(Grouping)14 b(logically)f(related)i(items)f(in)o(to)h(comm)o
(unicators)d(substan)o(tially)249 939 y(reduces)19 b(the)f(n)o(um)o(b)q
(er)e(of)g(calling)g(argumen)o(ts.)26 b(A)17 b(second)h(reason)g(is)f
(it)f(allo)o(ws)g(for)h(easier)249 993 y(extensibilit)o(y)m(.)g(Both)c
(the)g Fw(MPI)f FA(system)h(and)f(the)i(user)g(can)f(add)f(information)
e(on)o(to)i(comm)o(u-)249 1047 y(nicators)j(that)f(will)f(b)q(e)j
(passed)f(in)f(calls)g(without)g(c)o(hanging)g(the)h(calling)e(argumen)
o(ts.)20 b(This)249 1101 y(is)14 b(consisten)o(t)h(with)e(the)i(use)g
(of)e(opaque)h(ob)r(jects)h(throughout)f Fw(MPI)p FA(.)249
1184 y Fs(5.2.1)48 b(Groups)249 1267 y FA(A)10 b Fs(group)f
FA(is)h(an)g(ordered)h(set)g(of)e(pro)q(cess)j(iden)o(ti\014ers)f
(\(henceforth)h(pro)q(cesses\);)h(pro)q(cesses)g(are)249
1321 y(implemen)o(tation-)o(dep)q(enden)o(t)h(ob)r(jects.)23
b(Eac)o(h)15 b(pro)q(cess)i(in)d(a)h(group)g(is)f(asso)q(ciated)i(with)
f(an)249 1375 y(in)o(teger)g Fs(rank)p FA(.)k(Ranks)13
b(are)i(con)o(tiguous)f(and)g(start)h(from)e(zero.)40
b(Groups)14 b(are)h(represen)o(ted)249 1429 y(b)o(y)20
b(opaque)g Fs(group)i(ob)s(jects)p FA(,)e(and)g(hence)i(cannot)e(b)q(e)
h(directly)g(transferred)h(from)c(one)249 1483 y(pro)q(cess)e(to)e
(another.)291 1537 y(There)g(is)f(a)g(sp)q(ecial)h(pre-de\014ned)h
(group:)j Fq(MPI)p 1040 1537 12 2 v 12 w(GROUP)p 1182
1537 V 14 w(EMPTY)p FA(,)12 b(whic)o(h)h(is)g(a)h(group)f(with)249
1591 y(no)j(mem)o(b)q(ers.)23 b(The)17 b(prede\014ned)h(constan)o(t)e
Fq(MPI)p 1039 1591 V 13 w(GROUP)p 1182 1591 V 14 w(NULL)g
FA(is)g(the)h(v)n(alue)e(used)i(for)f(in-)249 1645 y(v)n(alid)i(group)i
(handles.)35 b Fq(MPI)p 734 1645 V 13 w(GROUP)p 877 1645
V 13 w(EMPTY)p FA(,)19 b(whic)o(h)g(is)h(a)f(v)n(alid)f(handle)i(to)f
(an)g(empt)o(y)249 1699 y(group,)14 b(should)h(not)f(b)q(e)h(confused)h
(with)e Fq(MPI)p 981 1699 V 13 w(GROUP)p 1124 1699 V
14 w(NULL)p FA(,)g(whic)o(h)h(is)f(an)h(in)o(v)n(alid)d(handle.)249
1753 y(The)j(former)f(ma)o(y)f(b)q(e)j(used)g(as)f(an)g(argumen)o(t)e
(to)i(group)g(op)q(erations;)g(the)h(latter,)f(whic)o(h)g(is)249
1807 y(returned)h(when)e(a)g(group)f(is)h(freed,)g(in)g(not)g(a)f(v)n
(alid)g(argumen)o(t.)291 1861 y(Group)g(op)q(erations)h(are)h
(discussed)g(in)f(Section)g(5.3.)249 1944 y Fs(5.2.2)48
b(Comm)o(unicator)249 2027 y FA(A)17 b(comm)o(unicator)d(is)j(an)f
(opaque)h(ob)r(ject)h(with)e(a)h(n)o(um)o(b)q(er)f(of)g(attributes,)i
(together)g(with)249 2081 y(simple)11 b(rules)h(that)g(go)o(v)o(ern)g
(its)g(creation,)g(use)h(and)f(destruction.)19 b(The)12
b(comm)o(unicator)d(sp)q(ec-)249 2135 y(i\014es)k(a)e
Fs(comm)o(unication)g(domain)f FA(whic)o(h)i(can)g(b)q(e)h(used)g(for)f
(p)q(oin)o(t-to-p)q(oin)o(t)f(comm)o(uni)o(ca-)249 2188
y(tions.)17 b(An)12 b Fs(in)o(tracomm)o(un)o(icator)c
FA(is)k(used)g(for)g(comm)o(unicating)c(within)j(a)h(single)f(group)h
(of)249 2242 y(pro)q(cesses;)19 b(w)o(e)d(call)g(suc)o(h)g(comm)o
(unication)d FB(intr)n(a-gr)n(oup)j(c)n(ommunic)n(ation)p
FA(.)25 b(An)16 b(in)o(tracom-)249 2296 y(m)o(unicator)11
b(has)i(t)o(w)o(o)f(\014xed)h(attributes.)37 b(These)14
b(are)f(the)g(pro)q(cess)h(group)f(and)f(the)i(top)q(ology)249
2350 y(describing)i(the)g(logical)d(la)o(y)o(out)h(of)h(the)h(pro)q
(cesses)i(in)c(the)i(group.)22 b(Pro)q(cess)c(top)q(ologies)c(are)249
2404 y(the)e(sub)r(ject)h(of)e(c)o(hapter)h(6.)17 b(In)o(tracomm)o
(unicators)9 b(are)j(also)f(used)i(for)e(collectiv)o(e)g(op)q(erations)
249 2458 y(within)i(a)h(group)g(of)f(pro)q(cesses.)p
eop
%%Page: 204 218
204 217 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(204)1256 b(Chapter)13 b(5)291
507 y FA(An)g Fs(in)o(tercomm)o(u)o(ni)o(cator)d FA(is)j(used)h(for)f
(p)q(oin)o(t-to-p)q(oin)o(t)f(comm)o(uni)o(cation)e(b)q(et)o(w)o(een)15
b(t)o(w)o(o)249 561 y(disjoin)o(t)i(groups)h(of)f(pro)q(cesses.)33
b(W)m(e)18 b(call)f(suc)o(h)i(comm)o(unicati)o(on)c FB(inter-gr)n(oup)j
(c)n(ommuni-)249 615 y(c)n(ation)p FA(.)38 b(The)20 b(\014xed)h
(attributes)g(of)f(an)g(in)o(tercomm)o(unicator)e(are)i(the)h(t)o(w)o
(o)f(groups.)38 b(No)249 669 y(top)q(ology)11 b(is)h(asso)q(ciated)h
(with)e(an)h(in)o(tercomm)o(unicator.)j(In)d(addition)f(to)h(\014xed)h
(attributes)g(a)249 723 y(comm)o(unicator)e(ma)o(y)g(also)h(ha)o(v)o(e)
i(user-de\014ned)h(attributes)f(whic)o(h)f(are)h(asso)q(ciated)g(with)f
(the)249 777 y(comm)o(unicator)i(using)i Fw(MPI)p FA('s)f(cac)o(hing)h
(mec)o(hanism,)f(as)h(describ)q(ed)i(in)e(Section)h(5.6.)27
b(The)249 831 y(table)11 b(b)q(elo)o(w)g(summarizes)e(the)j
(di\013erences)24 b(b)q(et)o(w)o(een)12 b(in)o(tracomm)o(unicators)d
(and)i(in)o(tercom-)249 885 y(m)o(unicators.)p 275 957
1442 2 v 274 1010 2 54 v 300 994 a(F)m(unctionalit)o(y)p
924 1010 V 408 w(In)o(tracomm)o(unicator)p 1321 1010
V 47 w(In)o(tercomm)o(unicator)p 1716 1010 V 275 1012
1442 2 v 274 1066 2 54 v 300 1050 a(#)j(of)f(groups)p
924 1066 V 434 w(1)p 1321 1066 V 376 w(2)p 1716 1066
V 274 1120 V 300 1104 a(Comm)o(unicatio)o(n)e(Safet)o(y)p
924 1120 V 237 w(Y)m(es)p 1321 1120 V 335 w(Y)m(es)p
1716 1120 V 274 1174 V 300 1158 a(Collectiv)o(e)j(Op)q(erations)p
924 1174 V 259 w(Y)m(es)p 1321 1174 V 335 w(No)p 1716
1174 V 274 1228 V 300 1212 a(T)m(op)q(ologies)p 924 1228
V 457 w(Y)m(es)p 1321 1228 V 335 w(No)p 1716 1228 V 274
1282 V 300 1266 a(Cac)o(hing)p 924 1282 V 503 w(Y)m(es)p
1321 1282 V 335 w(Y)m(es)p 1716 1282 V 275 1284 1442
2 v 291 1352 a(In)o(tracomm)o(unicator)f(op)q(erations)k(are)g(describ)
q(ed)h(in)e(Section)h(5.4,)e(and)h(in)o(tercomm)o(uni-)249
1406 y(cator)e(op)q(erations)g(are)h(discussed)g(in)f(Section)g(5.7.)
249 1489 y Fs(5.2.3)48 b(Comm)o(unication)12 b(Domains)249
1572 y FA(An)o(y)k(p)q(oin)o(t-to-p)q(oin)o(t)f(or)h(collectiv)o(e)g
(comm)o(unication)d(o)q(ccurs)18 b(in)e Fw(MPI)f FA(within)h(a)g
Fs(comm)o(u-)249 1626 y(nication)e(domain)p FA(.)i(Suc)o(h)f(a)f(comm)o
(uni)o(cation)d(domain)h(is)i(represen)o(ted)j(b)o(y)d(a)f(set)i(of)f
(com-)249 1680 y(m)o(unicators)f(with)h(consisten)o(t)h(v)n(alues,)e
(one)h(at)g(eac)o(h)h(of)e(the)i(participating)e(pro)q(cesses;)j(eac)o
(h)249 1734 y(comm)o(unicator)d(is)i(the)h(lo)q(cal)f(represen)o
(tation)i(of)e(the)h(global)d(comm)o(unication)f(domain.)21
b(If)249 1788 y(this)16 b(domain)e(is)i(for)g(in)o(tra-group)f(comm)o
(unication)e(then)j(all)f(the)i(comm)o(unicators)d(are)i(in-)249
1842 y(tracomm)o(unicators,)i(and)i(all)e(ha)o(v)o(e)h(the)h(same)f
(group)g(attribute.)35 b(Eac)o(h)20 b(comm)o(unicator)249
1896 y(iden)o(ti\014es)14 b(all)f(the)i(other)f(corresp)q(onding)h
(comm)o(unicators.)291 1950 y(One)h(can)f(think)g(of)g(a)g(comm)o
(unicator)e(as)i(an)g(arra)o(y)h(of)e(links)h(to)g(other)h(comm)o
(unicators.)249 2004 y(An)d(in)o(tra-group)g(comm)o(uni)o(cation)d
(domain)h(is)i(sp)q(eci\014ed)h(b)o(y)f(a)g(set)h(of)e(comm)o
(unicators)f(suc)o(h)249 2058 y(that)208 2141 y Ft(\017)20
b FA(their)14 b(links)g(form)e(a)h(complete)h(graph:)k(eac)o(h)c(comm)o
(unicator)d(is)j(link)o(ed)f(to)h(all)f(comm)o(uni)o(ca-)249
2195 y(tors)h(in)g(the)g(set,)h(including)e(itself;)g(and)208
2263 y Ft(\017)20 b FA(links)e(ha)o(v)o(e)h(consisten)o(t)h(indices:)28
b(at)19 b(eac)o(h)g(comm)o(unicator,)e(the)i Fw(i)p FA(-th)g(link)f(p)q
(oin)o(ts)g(to)h(the)249 2317 y(comm)o(unicator)11 b(for)j(pro)q(cess)h
Fw(i)p FA(.)249 2400 y(This)g(distributed)h(data)f(structure)i(is)e
(illustrated)g(in)g(Figure)h(5.1,)e(for)h(the)g(case)i(of)d(a)h(three)
249 2454 y(mem)o(b)q(er)d(group.)291 2508 y(W)m(e)h(discuss)i(in)o
(ter-group)f(comm)o(unication)c(domains)i(in)i(Section)g(5.7.)p
eop
%%Page: 205 219
205 218 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(205)478
466 y
 16577003 8122730 0 0 43152834 21313290 startTexFig
 478 466 a
%%BeginDocument: ../figures/context-intracomm.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
 /DrawEllipse {
	/endangle exch def
	/startangle exch def
	/yrad exch def
	/xrad exch def
	/y exch def
	/x exch def
	/savematrix mtrx currentmatrix def
	x y translate xrad yrad scale 0 0 1 startangle endangle arc
	savematrix setmatrix
	} def

	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-18.0 378.0 translate 0.900 -0.900 scale
1.000 setlinewidth
% Ellipse
n 520 340 21 21 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 599 338 21 21 0 360 DrawEllipse gs col-1 s gr
% Polyline
n 486 299 m 479 299 479 372 7 arcto 4 {pop} repeat 479 379 712 379 7 arcto 4 {pop} repeat 719 379 719 306 7 arcto 4 {pop} repeat 719 299 486 299 7 arcto 4 {pop} repeat clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
519 344 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
599 344 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
679 344 m 
gs 1 -1 scale (2) col-1 show gr
% Ellipse
n 460 140 21 21 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 300 140 21 21 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 379 138 21 21 0 360 DrawEllipse gs col-1 s gr
% Polyline
n 266 99 m 259 99 259 172 7 arcto 4 {pop} repeat 259 179 492 179 7 arcto 4 {pop} repeat 499 179 499 106 7 arcto 4 {pop} repeat 499 99 266 99 7 arcto 4 {pop} repeat clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
299 144 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
379 144 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 144 m 
gs 1 -1 scale (2) col-1 show gr
% Ellipse
n 240 340 21 21 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 80 340 21 21 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 680 340 21 21 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 159 338 21 21 0 360 DrawEllipse gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
739 339 m 
gs 1 -1 scale (2) col-1 show gr
% Polyline
n 46 299 m 39 299 39 372 7 arcto 4 {pop} repeat 39 379 272 379 7 arcto 4 {pop} repeat 279 379 279 306 7 arcto 4 {pop} repeat 279 299 46 299 7 arcto 4 {pop} repeat clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
79 344 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 344 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
239 344 m 
gs 1 -1 scale (2) col-1 show gr
% Polyline
n 499 339 m 279 339 l gs col-1 s gr
n 295.000 343.000 m 279.000 339.000 l 295.000 335.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 300 160 m 140 300 l gs col-1 s gr
n 154.675 292.474 m 140.000 300.000 l 149.407 286.454 l gs 2 setlinejoin col-1 s gr
% Polyline
n 159 317 m 319 177 l gs col-1 s gr
n 304.325 184.526 m 319.000 177.000 l 309.593 190.546 l gs 2 setlinejoin col-1 s gr
% Polyline
n 598 317 m 438 177 l gs col-1 s gr
n 447.407 190.546 m 438.000 177.000 l 452.675 184.526 l gs 2 setlinejoin col-1 s gr
% Polyline
n 459 159 m 619 299 l gs col-1 s gr
n 609.593 285.454 m 619.000 299.000 l 604.325 291.474 l gs 2 setlinejoin col-1 s gr
% Polyline
n 679 359 m 679 419 l  639 419 l  639 379 l gs col-1 s gr
n 635.000 395.000 m 639.000 379.000 l 643.000 395.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 379 119 m 379 59 l  419 59 l  419 99 l gs col-1 s gr
n 423.000 83.000 m 419.000 99.000 l 415.000 83.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 239 359 m 239 419 l  539 419 l  539 379 l gs col-1 s gr
n 535.000 395.000 m 539.000 379.000 l 543.000 395.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 79 359 m 79 419 l  119 419 l  119 379 l gs col-1 s gr
n 115.000 395.000 m 119.000 379.000 l 123.000 395.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
19 339 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
239 139 m 
gs 1 -1 scale (1) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1043 a Fo(Figure)13 b(5.1)249 1080 y Fz(Distributed)c(data)h
(structure)g(for)g(in)o(tra-comm)o(un)o(ica)o(tio)o(n)f(domain.)291
1196 y FA(In)17 b(p)q(oin)o(t-to-p)q(oin)o(t)f(comm)o(unication,)f
(matc)o(hing)g(send)k(and)e(receiv)o(e)i(calls)e(should)h(ha)o(v)o(e)
249 1250 y(comm)o(unicator)d(argumen)o(ts)h(that)i(represen)o(t)i(the)e
(same)e(comm)o(unication)e(domains.)27 b(The)249 1304
y(rank)12 b(of)f(the)h(pro)q(cesses)i(is)d(in)o(terpreted)j(relativ)o
(e)d(to)g(the)i(group,)e(or)h(groups,)f(asso)q(ciated)i(with)249
1358 y(the)i(comm)o(unicator.)h(Th)o(us,)e(in)g(an)g(in)o(tra-group)f
(comm)o(unicatio)o(n)f(domain,)f(pro)q(cess)16 b(ranks)249
1412 y(are)e(relativ)o(e)g(to)g(the)g(group)g(asso)q(ciated)h(with)e
(the)i(comm)o(unicator.)291 1466 y(Similarl)o(y)m(,)8
b(a)j(collectiv)o(e)g(comm)o(unicati)o(on)d(call)j(in)o(v)o(olv)o(es)f
(all)f(pro)q(cesses)14 b(in)d(the)g(group)g(of)g(an)249
1520 y(in)o(tra-group)k(comm)o(unicatio)o(n)e(domain,)g(and)i(all)f
(pro)q(cesses)19 b(should)c(use)h(a)f(comm)o(unicator)249
1574 y(argumen)o(t)i(that)i(represen)o(ts)i(this)d(domain.)29
b(In)o(tercomm)o(unicators)17 b(ma)o(y)f(not)j(b)q(e)g(used)g(in)249
1628 y(collectiv)o(e)14 b(comm)o(unicatio)o(n)d(op)q(erations.)291
1682 y(W)m(e)j(shall)f(sometimes)g(sa)o(y)m(,)g(for)h(simplicit)o(y)m
(,)d(that)k(t)o(w)o(o)e(comm)o(unicators)f(are)j(the)g(same,)e(if)249
1736 y(they)h(represen)o(t)h(the)e(same)f(comm)o(unication)e(domain.)15
b(One)f(should)f(not)g(b)q(e)g(misled)f(b)o(y)g(this)249
1790 y(abuse)g(of)e(language:)16 b(Eac)o(h)11 b(comm)o(unicator)d(is)j
(really)g(a)f(distinct)h(ob)r(ject,)h(lo)q(cal)f(to)f(a)h(pro)q(cess.)
249 1844 y(F)m(urthermore,)i(comm)o(unicators)e(that)j(represen)o(t)h
(the)g(same)d(comm)o(unication)e(domain)h(ma)o(y)249
1898 y(ha)o(v)o(e)j(di\013eren)o(t)h(attribute)f(v)n(alues)g(attac)o
(hed)g(to)g(them)f(at)h(di\013eren)o(t)h(pro)q(cesses.)249
1989 y FB(A)n(dvic)n(e)d(to)g(implementors.)34 b FA(An)11
b(often-used)g(design)g(is)g(that)f(eac)o(h)i(comm)o(unicator)c(is)i
(asso)q(ci-)249 2043 y(ated)h(with)g(an)f(id)g(whic)o(h)h(is)f(pro)q
(cess-unique,)j(and)e(whic)o(h)f(is)h(iden)o(tical)f(at)g(all)g(comm)o
(unicators)249 2097 y(that)j(de\014ne)h(one)f(in)o(tra-group)f(comm)o
(unication)d(domain.)16 b(This)d(id)f(is)h(referred)h(as)f(the)h(com-)
249 2151 y(m)o(unication)i FB(c)n(ontext)p FA(.)32 b(Th)o(us,)19
b(eac)o(h)g(message)f(is)g(tagged)g(with)g(the)h(con)o(text)g(of)f(the)
h(send)249 2205 y(comm)o(unicator)14 b(argumen)o(t,)i(and)g(that)h(con)
o(text)h(iden)o(ti\014es)f(the)g(matc)o(hing)e(comm)o(unicator)249
2259 y(at)f(the)g(receiving)h(pro)q(cess.)249 2329 y(In)i(more)f
(detail:)24 b(a)17 b(group)g(can)h(b)q(e)f(represen)o(ted)j(b)o(y)d(an)
g(arra)o(y)g Fw(group)h FA(suc)o(h)g(that)f Fw(group[i])249
2383 y FA(is)f(the)h(address)g(of)e(the)i(pro)q(cess)h(with)d(rank)h
Fw(i)g FA(in)g Fw(group)p FA(.)25 b(An)16 b(in)o(tracomm)o(uni)o(cator)
e(can)i(b)q(e)249 2437 y(represen)o(ted)h(b)o(y)c(a)h(structure)i(with)
e(comp)q(onen)o(ts)f Fw(group,)h(myrank)g FA(and)g Fw(context)p
FA(.)249 2508 y(When)f(a)f(pro)q(cess)j(p)q(osts)e(a)f(send)i(with)e
(argumen)o(ts)g Fw(dest,)h(tag)g FA(and)f Fw(comm)p FA(,)f(then)i(the)g
(address)p eop
%%Page: 206 220
206 219 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(206)1256 b(Chapter)13 b(5)249
507 y FA(of)k(the)i(destination)f(is)f(computed)h(as)g
Fw(comm.group[dest])p FA(.)29 b(The)18 b(message)g(sen)o(t)h(carries)g
(a)249 561 y(header)c(with)e(the)i(tuple)f Fw(\(comm.myrank,)d(tag,)i
(comm.context\))p FA(.)249 632 y(If)i(a)g(pro)q(cess)i(p)q(osts)f(a)f
(receiv)o(e)i(with)e(argumen)o(t)f Fw(source,)j(tag)e
FA(and)g Fw(comm)p FA(,)e(then)j(headers)h(of)249 686
y(incoming)12 b(messages)i(are)h(matc)o(hed)e(to)h(the)h(tuple)f
Fw(\(source,)h(tag,)f(comm.context\))f FA(\(\014rst)i(t)o(w)o(o)249
740 y(ma)o(y)d(b)q(e)j(don)o(tcare\).)249 810 y(Another)f(design)e(is)h
(to)g(use)g(ids)g(whic)o(h)f(are)i(pro)q(cess-unique,)g(but)f(not)f
(necessarily)i(iden)o(tical)249 864 y(at)c(all)f(pro)q(cesses.)20
b(In)10 b(suc)o(h)h(case,)h(the)f(con)o(text)g(comp)q(onen)o(t)e(of)h
(the)h(comm)o(unicator)c(structure)249 918 y(is)16 b(an)g(arra)o(y)m(,)
f(where)j Fw(comm.context[i])c FA(is)i(the)h(id)f(c)o(hosen)h(b)o(y)e
(the)i(pro)q(cess)h(with)e(rank)g Fw(i)g FA(for)249 972
y(that)i(comm)o(unication)d(domain.)29 b(A)18 b(message)g(is)g(sen)o(t)
h(with)f(header)h Fw(comm.m)o(yrank,)e(tag,)249 1026
y(comm.context[dest])p FA(;)c(a)g(receiv)o(e)i(call)e(causes)i
(incoming)d(messages)h(to)h(b)q(e)g(matc)o(hed)f(against)249
1080 y(the)i(tuple)f Fw(\(source,)g(tag,)f(comm.context[myrank]\))p
FA(.)249 1151 y(The)h(later)f(design)g(uses)i(more)d(storage)i(for)f
(the)h(comm)o(uni)o(cator)d(ob)r(ject,)j(but)f(simpli\014es)f(the)249
1205 y(creation)i(of)f(new)h(comm)o(uni)o(cators,)d(since)j(ids)g(can)f
(b)q(e)h(selected)i(lo)q(cally)c(\(they)i(still)e(need)j(to)249
1259 y(b)q(e)g(broadcast)f(to)g(all)e(other)j(group)f(mem)o(b)q(ers\).)
249 1329 y(It)e(is)g(imp)q(ortan)o(t)e(to)h(remem)o(b)q(er)g(that)h
Fw(MPI)f FA(do)q(es)i(not)f(require)g(a)g(unique)g(con)o(text)g(to)g(b)
q(e)g(asso-)249 1383 y(ciated)h(with)g(eac)o(h)g(comm)o(unicator.)i
(\\Con)o(text")e(is)g(a)f(p)q(ossible)h(implemen)o(tation)d(structure,)
249 1437 y(not)k(an)g Fw(MPI)f FA(ob)r(ject.)249 1508
y(With)g(b)q(oth)h(designs)h(w)o(e)f(assumed)f(a)h(\\\015at")f
(represen)o(tation)j(for)d(groups,)h(where)h(eac)o(h)g(pro-)249
1562 y(cess)e(holds)f(a)f(complete)g(list)h(of)f(group)g(mem)o(b)q
(ers.)16 b(This)c(requires,)h(at)e(eac)o(h)h(pro)q(cess,)i(storage)249
1616 y(of)g(size)i(prop)q(ortional)d(to)i(the)g(size)h(of)e(the)h
(group.)21 b(While)13 b(this)i(presen)o(ts)i(no)d(problem)g(with)249
1670 y(groups)k(of)f(practical)h(size)g(\(100's)f(or)h(1000's)e(of)i
(pro)q(cesses\))i(it)d(is)h(not)g(a)f(scalable)h(design.)249
1724 y(Other)e(represen)o(tations)h(will)d(b)q(e)i(needed)h(for)d
Fw(MPI)h FA(computations)f(that)h(spa)o(wn)g(the)h(In)o(ter-)249
1778 y(net.)i(The)c(group)f(information)d(ma)o(y)i(b)q(e)i(distributed)
f(and)g(managed)f(hierarc)o(hically)m(,)g(as)h(are)249
1831 y(In)o(ternet)i(addresses,)h(at)e(the)h(exp)q(ense)h(of)d
(additional)f(comm)o(unication.)j(\()p FB(End)h(of)f(advic)n(e)g(to)249
1885 y(implementors.)p FA(\))291 1977 y Fw(MPI)e FA(is)h(designed)h(to)
f(ensure)h(that)g(comm)o(uni)o(cator)d(constructors)k(alw)o(a)o(ys)d
(generate)i(con-)249 2031 y(sisten)o(t)j(comm)o(unicators)e(that)h(are)
h(a)f(v)n(alid)f(represen)o(tation)j(of)e(the)h(newly)g(created)h(com-)
249 2085 y(m)o(unication)14 b(domain.)24 b(This)17 b(is)f(done)h(b)o(y)
f(requiring)h(that)f(a)g(new)h(in)o(tracomm)o(unicator)d(b)q(e)249
2139 y(constructed)j(out)f(of)e(an)h(existing)g(paren)o(t)h(comm)o
(unicator,)c(and)j(that)g(this)h(b)q(e)f(a)g(collectiv)o(e)249
2193 y(op)q(eration)d(o)o(v)o(er)g(all)f(pro)q(cesses)k(in)d(the)h
(group)f(asso)q(ciated)h(with)f(the)h(paren)o(t)g(comm)o(unicator.)249
2247 y(The)j(group)g(asso)q(ciated)h(with)e(a)h(new)g(in)o(tracomm)o
(unicator)d(m)o(ust)i(b)q(e)h(a)g(subgroup)g(of)f(that)249
2301 y(asso)q(ciated)j(with)f(the)i(paren)o(t)f(in)o(tracomm)n
(unicator.)26 b(Th)o(us,)18 b(all)f(the)h(in)o(tracomm)n(unicator)249
2355 y(constructor)g(routines)f(describ)q(ed)h(in)e(Section)g(5.4.2)f
(ha)o(v)o(e)h(an)g(existing)g(comm)o(unicator)d(as)249
2408 y(an)i(input)g(argumen)o(t,)f(and)h(the)h(newly)f(created)i(in)o
(tracomm)o(uni)o(cator)c(as)i(an)g(output)h(argu-)249
2462 y(men)o(t.)29 b(This)18 b(leads)g(to)g(a)g(c)o(hic)o(k)o
(en-and-egg)g(situation)f(since)i(w)o(e)f(m)o(ust)f(ha)o(v)o(e)h(an)g
(existing)p eop
%%Page: 207 221
207 220 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(207)249
507 y FA(comm)o(unicator)10 b(to)i(create)i(a)e(new)h(comm)o(unicator.)
i(This)e(problem)e(is)h(solv)o(ed)h(b)o(y)f(the)h(pro)o(vi-)249
561 y(sion)g(of)g(a)h(prede\014ned)h(in)o(tracomm)o(uni)o(cator,)c
Fq(MPI)p 1057 561 12 2 v 13 w(COMM)p 1191 561 V 12 w(W)o(ORLD)p
FA(,)j(whic)o(h)f(is)g(a)o(v)n(ailable)f(for)249 615
y(use)k(once)g(the)f(routine)h Fw(MPI)p 712 615 13 2
v 14 w(INIT)f FA(has)g(b)q(een)h(called.)21 b Fq(MPI)p
1203 615 12 2 v 13 w(COMM)p 1337 615 V 13 w(W)o(ORLD)p
FA(,)14 b(whic)o(h)h(has)g(as)249 669 y(its)d(group)g(attribute)g(all)f
(pro)q(cesses)j(with)e(whic)o(h)f(the)i(lo)q(cal)e(pro)q(cess)j(can)e
(comm)o(unicate,)d(can)249 723 y(b)q(e)k(used)f(as)g(the)h(paren)o(t)f
(comm)o(unicator)d(in)i(constructing)i(new)f(comm)o(unicators.)j(A)d
(second)249 777 y(pre-de\014ned)18 b(comm)o(unicator,)13
b Fq(MPI)p 823 777 V 13 w(COMM)p 957 777 V 13 w(SELF)p
FA(,)j(is)g(also)g(a)o(v)n(ailable)e(for)h(use)i(after)g(calling)249
831 y Fw(MPI)p 326 831 13 2 v 14 w(INIT)11 b FA(and)h(has)f(as)g(its)h
(asso)q(ciated)g(group)f(just)h(the)f(pro)q(cess)j(itself.)i
Fq(MPI)p 1472 831 12 2 v 13 w(COMM)p 1606 831 V 13 w(SELF)c
FA(is)249 885 y(pro)o(vided)e(as)g(a)g(con)o(v)o(enience)h(since)g(it)f
(could)g(easily)f(b)q(e)i(created)h(out)e(of)f Fq(MPI)p
1450 885 V 13 w(COMM)p 1584 885 V 13 w(W)o(ORLD)p FA(.)249
968 y Fs(5.2.4)48 b(Compatibili)o(t)n(y)13 b(with)i(Curren)o(t)f
(Practice)249 1051 y FA(The)j(curren)o(t)g(practice)g(in)f(man)o(y)e
(co)q(des)j(is)f(that)g(there)i(is)d(a)h(unique,)g(prede\014ned)i(comm)
o(u-)249 1105 y(nication)13 b(univ)o(erse)h(that)f(includes)h(all)e
(pro)q(cesses)k(a)o(v)n(ailable)c(when)i(the)g(parallel)e(program)g(is)
249 1159 y(initiated;)i(the)h(pro)q(cesses)i(are)e(assigned)g
(consecutiv)o(e)h(ranks.)k(P)o(articipan)o(ts)15 b(in)f(a)g(p)q(oin)o
(t-to-)249 1213 y(p)q(oin)o(t)e(comm)o(uni)o(cation)d(are)k(iden)o
(ti\014ed)f(b)o(y)g(their)g(rank;)g(a)g(collectiv)o(e)g(comm)o
(unicatio)o(n)e(\(suc)o(h)249 1267 y(as)j(broadcast\))h(alw)o(a)o(ys)e
(in)o(v)o(olv)o(es)g(all)g(pro)q(cesses.)20 b(As)14 b(suc)o(h,)f(most)f
(curren)o(t)j(message)e(passing)249 1321 y(libraries)h(ha)o(v)o(e)g(no)
f(equiv)n(alen)o(t)h(argumen)o(t)e(to)i(the)h(comm)o(unicator.)g(It)f
(is)g(implicitly)d(all)i(the)249 1375 y(pro)q(cesses)k(as)d(rank)o(ed)g
(b)o(y)f(the)i(system.)291 1429 y(This)20 b(practice)i(can)f(b)q(e)g
(follo)o(w)o(ed)f(in)g Fw(MPI)g FA(b)o(y)h(using)f(the)i(prede\014ned)g
(comm)o(unicator)249 1483 y Fw(MPI)p 326 1483 13 2 v
14 w(COMM)p 470 1483 V 15 w(W)o(ORLD)14 b FA(wherev)o(er)h(a)f(comm)o
(unicator)d(argumen)o(t)h(is)i(required.)19 b(Th)o(us,)14
b(using)249 1537 y(curren)o(t)g(practice)f(in)f Fw(MPI)f
FA(is)h(v)o(ery)h(easy)m(.)k(Users)d(that)e(are)h(con)o(ten)o(t)g(with)
e(it)h(can)h(ignore)f(most)249 1591 y(of)18 b(the)h(information)d(in)i
(this)g(c)o(hapter.)33 b(Ho)o(w)o(ev)o(er,)20 b(ev)o(ery)o(one)f
(should)g(seriously)g(consider)249 1645 y(understanding)10
b(the)g(p)q(oten)o(tial)f(risks)h(in)f(using)g Fw(MPI)p
1072 1645 V 15 w(COMM)p 1217 1645 V 14 w(W)o(ORLD)h FA(to)f(a)o(v)o
(oid)f(unexp)q(ected)249 1699 y(b)q(eha)o(vior)14 b(of)f(their)h
(programs.)249 1819 y FD(5.3)52 b(Group)17 b(Managemen)o(t)249
1927 y FA(This)12 b(section)g(describ)q(es)i(the)e(manipulation)d(of)i
(pro)q(cess)i(groups)f(in)g Fw(MPI)p FA(.)e(These)j(op)q(erations)249
1981 y(are)d(lo)q(cal)f(and)h(their)g(execution)h(do)e(not)h(require)g
(in)o(terpro)q(cess)i(comm)o(unication.)i Fw(MPI)9 b
FA(allo)o(ws)249 2035 y(manipulation)i(of)j(groups)g(outside)g(of)g
(comm)o(unicators)e(but)i(groups)g(can)h(only)e(b)q(e)i(used)g(for)249
2089 y(message)f(passing)f(inside)h(of)g(a)f(comm)o(unicator.)p
eop
%%Page: 208 222
208 221 bop 2 223 2 150 v 2 76 150 2 v 1928 76 V 2076
225 2 150 v 249 251 a Fv(208)1256 b(Chapter)13 b(5)249
507 y Fs(5.3.1)48 b(Group)14 b(Accessors)208 661 y Fw(MPI)p
285 661 13 2 v 14 w(GROUP)p 441 661 V 13 w(SIZE\(group,)g(size\))332
736 y Fv(IN)158 b Fw(group)448 b Fv(group)332 786 y(OUT)114
b Fw(size)484 b Fv(n)o(um)o(b)q(er)14 b(of)f(pro)q(cesses)h(in)g(group)
249 896 y Fr(int)21 b(MPI)p 405 896 14 2 v 15 w(Group)p
530 896 V 15 w(size\(MPI)p 721 896 V 14 w(Group)g(group,)f(int)h
(*size\))249 980 y(MPI)p 318 980 V 15 w(GROUP)p 443 980
V 15 w(SIZE\(GROUP,)e(SIZE,)i(IERROR\))336 1034 y(INTEGER)g(GROUP,)f
(SIZE,)h(IERROR)291 1118 y Fw(MPI)p 368 1118 13 2 v 14
w(GROUP)p 524 1118 V 13 w(SIZE)14 b FA(returns)i(the)g(n)o(um)o(b)q(er)
e(of)g(pro)q(cesses)j(in)d(the)h(group.)20 b(Th)o(us,)15
b(if)f Fw(group)249 1172 y(=)i(MPI)p 374 1172 V 14 w(GROUP)p
530 1172 V 13 w(EMPTY)f FA(then)h(the)g(call)f(will)f(return)i
Fw(size)g(=)f(0)p FA(.)23 b(\(On)16 b(the)g(other)g(hand,)f(a)249
1226 y(call)e(with)h Fw(group)g(=)g(MPI)p 655 1226 V
15 w(GROUP)p 812 1226 V 13 w(NULL)g FA(is)g(erroneous.\))249
1351 y Fw(MPI)p 326 1351 V 14 w(GROUP)p 482 1351 V 13
w(RANK\(group,)g(rank\))332 1425 y Fv(IN)158 b Fw(group)448
b Fv(group)332 1475 y(OUT)114 b Fw(rank)471 b Fv(rank)14
b(of)f(the)g(calling)i(pro)q(cess)f(in)g(group)249 1585
y Fr(int)21 b(MPI)p 405 1585 14 2 v 15 w(Group)p 530
1585 V 15 w(rank\(MPI)p 721 1585 V 14 w(Group)g(group,)f(int)h(*rank\))
249 1669 y(MPI)p 318 1669 V 15 w(GROUP)p 443 1669 V 15
w(RANK\(GROUP,)e(RANK,)i(IERROR\))336 1723 y(INTEGER)g(GROUP,)f(RANK,)h
(IERROR)291 1807 y Fw(MPI)p 368 1807 13 2 v 14 w(GROUP)p
524 1807 V 13 w(RANK)9 b FA(returns)i(the)f(rank)g(of)f(the)h(calling)e
(pro)q(cess)j(in)e(group.)16 b(If)9 b(the)i(pro)q(cess)249
1861 y(is)j(not)g(a)f(mem)o(b)q(er)f(of)i(group)f(then)i
Fw(MPI)p 895 1861 V 14 w(UNDEFINED)e FA(is)h(returned.)249
1986 y Fw(MPI)p 326 1986 V 14 w(GROUP)p 482 1986 V 13
w(TRANSLA)m(TE)p 730 1986 V 15 w(RANKS)g(\(group1,)g(n,)g(ranks1,)g
(group2,)f(ranks2\))332 2061 y Fv(IN)158 b Fw(group1)427
b Fv(group1)332 2110 y(IN)158 b Fw(n)525 b Fv(n)o(um)o(b)q(er)17
b(of)g(ranks)g(in)33 b Fq(ranks1)16 b Fv(and)h Fq(ranks2)1079
2164 y Fv(arra)o(ys)332 2214 y(IN)158 b Fw(ranks1)434
b Fv(arra)o(y)9 b(of)g(zero)g(or)g(more)f(v)n(alid)j(ranks)e(in)h
(group1)332 2264 y(IN)158 b Fw(group2)427 b Fv(group2)332
2314 y(OUT)114 b Fw(ranks2)434 b Fv(arra)o(y)14 b(of)e(corresp)q
(onding)k(ranks)e(in)g(group2)249 2424 y Fr(int)21 b(MPI)p
405 2424 14 2 v 15 w(Group)p 530 2424 V 15 w(translate)p
743 2424 V 14 w(ranks)g(\(MPI)p 976 2424 V 14 w(Group)g(group1,)g(int)g
(n,)g(int)g(*ranks1,)540 2478 y(MPI)p 609 2478 V 15 w(Group)f(group2,)h
(int)g(*ranks2\))p eop
%%Page: 209 223
209 222 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(209)249
507 y Fr(MPI)p 318 507 14 2 v 15 w(GROUP)p 443 507 V
15 w(TRANSLATE)p 656 507 V 14 w(RANKS\(GROUP1,)19 b(N,)i(RANKS1,)f
(GROUP2,)h(RANKS2,)f(IERROR\))336 561 y(INTEGER)h(GROUP1,)f(N,)h
(RANKS1\(*\),)f(GROUP2,)g(RANKS2\(*\),)g(IERROR)291 645
y Fw(MPI)p 368 645 13 2 v 14 w(GROUP)p 524 645 V 13 w(TRANSLA)m(TE)p
772 645 V 15 w(RANKS)11 b FA(maps)f(the)i(ranks)g(of)f(a)g(set)h(of)f
(pro)q(cesses)j(in)d Fw(group1)249 699 y FA(to)g(their)g(ranks)h(in)e
Fw(group2)p FA(.)18 b(Up)q(on)11 b(return,)h(the)g(arra)o(y)e
Fw(ranks2)i FA(con)o(tains)f(the)g(ranks)h(in)e Fw(group2)249
753 y FA(for)i(the)h(pro)q(cesses)i(in)d(group1)g(with)g(ranks)h
(listed)g(in)f Fw(ranks1)p FA(.)18 b(If)12 b(a)g(pro)q(cess)i(in)e
Fw(group1)h FA(found)249 807 y(in)g Fw(ranks1)i FA(do)q(es)g(not)e(b)q
(elong)h(to)g Fw(group2)g FA(then)g Fw(MPI)p 1079 807
V 15 w(UNDEFINED)f FA(is)g(returned)j(in)d Fw(ranks2)p
FA(.)291 861 y(This)j(function)g(is)h(imp)q(ortan)o(t)d(for)i
(determining)g(the)h(relativ)o(e)f(n)o(um)o(b)q(ering)f(of)h(the)h
(same)249 915 y(pro)q(cesses)i(in)c(t)o(w)o(o)h(di\013eren)o(t)h
(groups.)24 b(F)m(or)16 b(instance,)g(if)g(one)g(kno)o(ws)g(the)g
(ranks)g(of)g(certain)249 969 y(pro)q(cesses)g(in)e(the)g(group)g(of)f
Fq(MPI)p 785 969 12 2 v 12 w(COMM)p 918 969 V 13 w(W)o(ORLD)p
FA(,)g(one)h(migh)o(t)e(w)o(an)o(t)h(to)h(kno)o(w)f(their)h(ranks)249
1023 y(in)f(a)h(subset)h(of)f(that)g(group.)249 1118
y Fs(Example)h(5.1)21 b FA(Let)f Fw(group1)f FA(b)q(e)h(a)f(handle)g
(to)g(the)g(group)g Ft(f)p Fw(a,b,c,d,e,f)p Ft(g)f FA(and)h(let)g
Fw(group2)249 1172 y FA(b)q(e)k(a)f(handle)g(to)g(the)g(group)g
Ft(f)p Fw(d,e,a,c)p Ft(g)p FA(.)43 b(Let)22 b Fw(ranks1)h(=)f
(\(0,5,0,2\))p FA(.)41 b(Then,)24 b(a)e(call)g(to)249
1226 y Fw(MPI)p 326 1226 13 2 v 14 w(GROUP)p 482 1226
V 13 w(TRANSLA)m(TE)p 730 1226 V 15 w(RANKS)16 b FA(will)e(return)j
(the)g(ranks)f(of)f(the)i(pro)q(cesses)h Ft(f)p Fw(a,f,a,c)p
Ft(g)249 1280 y FA(in)13 b Fw(group2)p FA(,)h(namely)e
Fw(ranks2)j(=)f(\(2,)p Ft(?)p Fw(,2,3\))p FA(.)h(\()p
Ft(?)f FA(denotes)h(the)f(v)n(alue)f Fq(MPI)p 1413 1280
12 2 v 13 w(UNDEFINED)p FA(.\))249 1447 y Fw(MPI)p 326
1447 13 2 v 14 w(GROUP)p 482 1447 V 13 w(COMP)m(ARE\(group1,)f(group2,)
i(result\))332 1521 y Fv(IN)158 b Fw(group1)427 b Fv(\014rst)14
b(group)332 1571 y(IN)158 b Fw(group2)427 b Fv(second)14
b(group)332 1621 y(OUT)114 b Fw(result)452 b Fv(result)249
1731 y Fr(int)21 b(MPI)p 405 1731 14 2 v 15 w(Group)p
530 1731 V 15 w(compare\(MPI)p 787 1731 V 13 w(Group)g(group1,MPI)p
1151 1731 V 14 w(Group)g(group2,)f(int)h(*result\))249
1815 y(MPI)p 318 1815 V 15 w(GROUP)p 443 1815 V 15 w(COMPARE\(GROUP1,)d
(GROUP2,)j(RESULT,)f(IERROR\))336 1869 y(INTEGER)h(GROUP1,)f(GROUP2,)g
(RESULT,)h(IERROR)291 1953 y Fw(MPI)p 368 1953 13 2 v
14 w(GROUP)p 524 1953 V 13 w(COMP)m(ARE)7 b FA(returns)k(the)f
(relationship)f(b)q(et)o(w)o(een)h(t)o(w)o(o)f(groups.)17
b Fq(MPI)p 1618 1953 12 2 v 13 w(IDENT)249 2007 y FA(results)f(if)e
(the)i(group)e(mem)o(b)q(ers)g(and)h(group)f(order)i(is)f(exactly)g
(the)g(same)f(in)h(b)q(oth)g(groups.)249 2061 y(This)h(happ)q(ens,)i
(for)e(instance,)h(if)f Fw(group1)h FA(and)f Fw(group2)h
FA(are)g(handles)f(to)g(the)i(same)d(ob)r(ject.)249 2115
y Fq(MPI)p 321 2115 V 13 w(SIMILAR)e FA(results)j(if)e(the)h(group)g
(mem)o(b)q(ers)e(are)i(the)h(same)e(but)h(the)g(order)g(is)g
(di\013eren)o(t.)249 2169 y Fq(MPI)p 321 2169 V 13 w(UNEQUAL)g
FA(results)g(otherwise.)249 2252 y Fs(5.3.2)48 b(Group)14
b(Constructors)249 2335 y FA(Group)h(constructors)j(are)e(used)h(to)e
(construct)j(new)e(groups)g(from)d(existing)j(groups,)g(using)249
2389 y(v)n(arious)j(set)h(op)q(erations.)34 b(These)20
b(are)g(lo)q(cal)e(op)q(erations,)j(and)e(distinct)g(groups)h(ma)o(y)d
(b)q(e)249 2443 y(de\014ned)j(on)f(di\013eren)o(t)h(pro)q(cesses;)k(a)
19 b(pro)q(cess)i(ma)o(y)c(also)i(de\014ne)h(a)f(group)f(that)i(do)q
(es)g(not)p eop
%%Page: 210 224
210 223 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(210)1256 b(Chapter)13 b(5)249
507 y FA(include)18 b(itself.)28 b(Consisten)o(t)18 b(de\014nitions)f
(are)h(required)g(when)g(groups)f(are)h(used)g(as)g(argu-)249
561 y(men)o(ts)h(in)g(comm)o(uni)o(cator-buildi)o(ng)e(functions.)34
b Fw(MPI)18 b FA(do)q(es)i(not)g(pro)o(vide)f(a)g(mec)o(hanism)249
615 y(to)h(build)f(a)g(group)h(from)e(scratc)o(h,)k(but)e(only)f(from)g
(other,)i(previously)f(de\014ned)h(groups.)249 669 y(The)16
b(base)h(group,)e(up)q(on)h(whic)o(h)f(all)g(other)h(groups)g(are)g
(de\014ned,)h(is)f(the)g(group)g(asso)q(ciated)249 723
y(with)g(the)h(initial)d(comm)o(unicator)f Fw(MPI)p 892
723 13 2 v 15 w(COMM)p 1037 723 V 14 w(W)o(ORLD)k FA(\(accessible)g
(through)g(the)f(func-)249 777 y(tion)d Fw(MPI)p 411
777 V 15 w(COMM)p 556 777 V 14 w(GROUP)p FA(\).)291 831
y(Lo)q(cal)d(group)h(creation)g(functions)g(are)h(useful)f(since)h
(some)e(applications)g(ha)o(v)o(e)g(the)i(needed)249
885 y(information)17 b(distributed)j(on)g(all)e(no)q(des.)36
b(Th)o(us,)21 b(new)f(groups)g(can)g(b)q(e)h(created)g(lo)q(cally)249
939 y(without)9 b(comm)o(unication.)14 b(This)9 b(can)h(signi\014can)o
(tly)f(reduce)j(the)e(necessary)i(comm)o(unicatio)o(n)249
993 y(in)h(creating)i(a)e(new)i(comm)o(unicator)c(to)i(use)i(this)f
(group.)291 1047 y(In)d(Section)g(5.4.2,)f(comm)o(uni)o(cator)f
(creation)i(functions)g(are)h(describ)q(ed)h(whic)o(h)e(also)f(create)
249 1101 y(new)h(groups.)17 b(These)12 b(are)e(more)g(general)g(group)h
(creation)f(functions)h(where)g(the)g(information)249
1155 y(do)q(es)17 b(not)f(ha)o(v)o(e)g(to)g(b)q(e)g(lo)q(cal)g(to)g
(eac)o(h)g(no)q(de.)25 b(They)17 b(are)f(part)g(of)g(comm)o(unicator)d
(creation)249 1209 y(since)i(they)h(will)d(normally)f(require)j(comm)o
(unication)c(for)j(group)h(creation.)20 b(Since)15 b(comm)o(u-)249
1263 y(nicator)h(creation)h(ma)o(y)d(also)i(require)h(comm)o(unicatio)o
(n,)d(it)i(is)g(logical)e(to)i(group)g(these)i(t)o(w)o(o)249
1317 y(functions)c(together)h(for)e(this)h(case.)249
1408 y FB(R)n(ationale.)72 b FA(In)20 b(what)g(follo)o(ws,)f(there)i
(is)e(no)h(group)g(duplication)e(function)i(analogous)249
1462 y(to)d Fw(MPI)p 380 1462 V 14 w(COMM)p 524 1462
V 15 w(DUP)p FA(,)e(de\014ned)k(later)e(in)f(this)h(c)o(hapter.)29
b(There)18 b(is)e(no)h(need)h(for)f(a)g(group)249 1516
y(duplicator.)33 b(A)19 b(group,)g(once)h(created,)h(can)e(ha)o(v)o(e)g
(sev)o(eral)g(references)j(to)d(it)f(b)o(y)h(making)249
1570 y(copies)g(of)f(the)h(handle.)32 b(Ho)o(w)o(ev)o(er,)20
b(care)f(should)g(b)q(e)g(tak)o(en)g(when)g(\\aliasing")d(groups)j(in)
249 1624 y(this)d(w)o(a)o(y)e(since)j(a)e(call)f(to)i(free)g(a)f(group)
g(using)g Fw(MPI)p 1110 1624 V 15 w(GROUP)p 1267 1624
V 13 w(FREE)f FA(ma)o(y)g(lea)o(v)o(e)h(dangling)249
1678 y(references.)21 b(\()p FB(End)16 b(of)e(r)n(ationale.)p
FA(\))249 1769 y FB(A)n(dvic)n(e)i(to)g(implementors.)42
b FA(Eac)o(h)16 b(group)e(constructor)j(b)q(eha)o(v)o(es)f(as)f(if)f
(it)h(returned)h(a)f(new)249 1823 y(group)h(ob)r(ject.)25
b(When)16 b(this)g(new)h(group)e(is)h(a)g(cop)o(y)g(of)f(an)h(existing)
g(group,)f(then)i(one)f(can)249 1877 y(a)o(v)o(oid)9
b(creating)j(suc)o(h)f(new)g(ob)r(jects,)h(using)f(a)f(reference-coun)o
(t)k(mec)o(hanism.)g(\()p FB(End)f(of)f(advic)n(e)249
1931 y(to)j(implementors.)p FA(\))249 2093 y Fw(MPI)p
326 2093 V 14 w(COMM)p 470 2093 V 15 w(GROUP\(comm)o(,)c(group\))332
2168 y Fv(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)332
2218 y(OUT)114 b Fw(group)448 b Fv(group)14 b(corresp)q(onding)i(to)d
Fq(comm)249 2328 y Fr(int)21 b(MPI)p 405 2328 14 2 v
15 w(Comm)p 508 2328 V 15 w(group\(MPI)p 721 2328 V 14
w(Comm)g(comm,)g(MPI)p 1041 2328 V 15 w(Group)g(*group\))249
2412 y(MPI)p 318 2412 V 15 w(COMM)p 421 2412 V 15 w(GROUP\(COMM,)f
(GROUP,)g(IERROR\))336 2466 y(INTEGER)h(COMM,)f(GROUP,)h(IERROR)p
eop
%%Page: 211 225
211 224 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(211)291
507 y Fw(MPI)p 368 507 13 2 v 14 w(COMM)p 512 507 V 15
w(GROUP)11 b FA(returns)16 b(in)d Fw(group)i FA(a)e(handle)h(to)g(the)g
(group)g(of)f Fw(comm)p FA(.)291 561 y(The)i(follo)o(wing)e(three)j
(functions)f(do)g(standard)h(set)g(t)o(yp)q(e)f(op)q(erations.)22
b(The)16 b(only)e(di\013er-)249 615 y(ence)h(is)f(that)g(ordering)g(is)
g(imp)q(ortan)o(t)e(so)i(that)g(ranks)g(are)g(consisten)o(tly)h
(de\014ned.)249 740 y Fw(MPI)p 326 740 V 14 w(GROUP)p
482 740 V 13 w(UNION\(group1,)f(group2,)f(newgroup\))332
815 y Fv(IN)158 b Fw(group1)427 b Fv(\014rst)14 b(group)332
865 y(IN)158 b Fw(group2)427 b Fv(second)14 b(group)332
914 y(OUT)114 b Fw(newgroup)381 b Fv(union)15 b(group)249
1025 y Fr(int)21 b(MPI)p 405 1025 14 2 v 15 w(Group)p
530 1025 V 15 w(union\(MPI)p 743 1025 V 14 w(Group)g(group1,)f(MPI)p
1128 1025 V 15 w(Group)h(group2,)540 1078 y(MPI)p 609
1078 V 15 w(Group)f(*newgroup\))249 1162 y(MPI)p 318
1162 V 15 w(GROUP)p 443 1162 V 15 w(UNION\(GROUP1,)f(GROUP2,)h
(NEWGROUP,)g(IERROR\))336 1216 y(INTEGER)h(GROUP1,)f(GROUP2,)g
(NEWGROUP,)g(IERROR)249 1371 y Fw(MPI)p 326 1371 13 2
v 14 w(GROUP)p 482 1371 V 13 w(INTERSECTION\(group1,)13
b(group2,)h(newgroup\))332 1446 y Fv(IN)158 b Fw(group1)427
b Fv(\014rst)14 b(group)332 1496 y(IN)158 b Fw(group2)427
b Fv(second)14 b(group)332 1546 y(OUT)114 b Fw(newgroup)381
b Fv(in)o(tersection)15 b(group)249 1656 y Fr(int)21
b(MPI)p 405 1656 14 2 v 15 w(Group)p 530 1656 V 15 w(intersection\(MPI)
p 896 1656 V 12 w(Group)g(group1,)f(MPI)p 1280 1656 V
16 w(Group)g(group2,)540 1710 y(MPI)p 609 1710 V 15 w(Group)g
(*newgroup\))249 1794 y(MPI)p 318 1794 V 15 w(GROUP)p
443 1794 V 15 w(INTERSECTION\(GRO)o(UP1,)e(GROUP2,)j(NEWGROUP,)f
(IERROR\))336 1848 y(INTEGER)h(GROUP1,)f(GROUP2,)g(NEWGROUP,)g(IERROR)
249 2002 y Fw(MPI)p 326 2002 13 2 v 14 w(GROUP)p 482
2002 V 13 w(DIFFERENCE\(group1,)12 b(group2,)i(newgroup\))332
2077 y Fv(IN)158 b Fw(group1)427 b Fv(\014rst)14 b(group)332
2127 y(IN)158 b Fw(group2)427 b Fv(second)14 b(group)332
2177 y(OUT)114 b Fw(newgroup)381 b Fv(di\013erence)15
b(group)249 2287 y Fr(int)21 b(MPI)p 405 2287 14 2 v
15 w(Group)p 530 2287 V 15 w(difference\(MPI)p 853 2287
V 13 w(Group)g(group1,)f(MPI)p 1237 2287 V 15 w(Group)h(group2,)540
2341 y(MPI)p 609 2341 V 15 w(Group)f(*newgroup\))249
2425 y(MPI)p 318 2425 V 15 w(GROUP)p 443 2425 V 15 w(DIFFERENCE\(GROUP)
o(1,)f(GROUP2,)h(NEWGROUP,)g(IERROR\))336 2479 y(INTEGER)h(GROUP1,)f
(GROUP2,)g(NEWGROUP,)g(IERROR)p eop
%%Page: 212 226
212 225 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(212)1256 b(Chapter)13 b(5)249
507 y FA(The)h(op)q(erations)h(are)f(de\014ned)h(as)f(follo)o(ws:)249
590 y Fs(union)19 b FA(All)13 b(elemen)o(ts)h(of)g(the)h(\014rst)h
(group)e(\()p Fw(group1)p FA(\),)h(follo)o(w)o(ed)e(b)o(y)h(all)f
(elemen)o(ts)h(of)g(second)249 644 y(group)g(\()p Fw(group2)p
FA(\))g(not)g(in)f(\014rst.)249 714 y Fs(in)o(tersecti)o(on)18
b FA(All)f(elemen)o(ts)i(of)f(the)i(\014rst)f(group)g(that)g(are)g
(also)f(in)h(the)g(second)h(group,)249 768 y(ordered)15
b(as)f(in)g(\014rst)g(group.)249 838 y Fs(di\013erence)k
FA(All)10 b(elemen)o(ts)h(of)f(the)i(\014rst)f(group)g(that)g(are)g
(not)g(in)f(the)h(second)h(group,)f(ordered)249 892 y(as)j(in)f(the)i
(\014rst)g(group.)249 975 y(Note)g(that)f(for)g(these)h(op)q(erations)g
(the)f(order)h(of)f(pro)q(cesses)j(in)c(the)i(output)f(group)g(is)g
(deter-)249 1029 y(mined)f(primarily)g(b)o(y)h(order)h(in)g(the)g
(\014rst)g(group)g(\(if)f(p)q(ossible\))h(and)g(then,)g(if)f(necessary)
m(,)i(b)o(y)249 1083 y(order)i(in)f(the)h(second)g(group.)29
b(Neither)18 b(union)f(nor)g(in)o(tersection)i(are)e(comm)o(utativ)o
(e,)e(but)249 1137 y(b)q(oth)f(are)g(asso)q(ciativ)o(e.)291
1191 y(The)g(new)g(group)g(can)g(b)q(e)h(empt)o(y)m(,)c(that)j(is,)g
(equal)f(to)h Fq(MPI)p 1222 1191 12 2 v 13 w(GROUP)p
1365 1191 V 13 w(EMPTY)p FA(.)249 1284 y Fs(Example)h(5.2)21
b FA(Let)14 b Fw(group1)e FA(=)g Ft(f)p Fw(a)p Fp(;)7
b Fw(b)p Fp(;)g Fw(c)p Fp(;)g Fw(d)p Ft(g)13 b FA(and)h
Fw(group2)e FA(=)f Ft(f)p Fw(d)p Fp(;)c Fw(a)p Fp(;)g
Fw(e)p Ft(g)p FA(.)18 b(Then)249 1374 y Fw(group1)375
1335 y Fi([)428 1374 y Fw(group2)12 b FA(=)g Ft(f)p Fw(a)p
Fp(;)7 b Fw(b)p Fp(;)g Fw(c)p Fp(;)g Fw(d)p Fp(;)g Fw(e)p
Ft(g)13 b FA(\(union\);)249 1508 y Fw(group1)375 1468
y Fi(\\)428 1508 y Fw(group2)f FA(=)g Ft(f)p Fw(a)p Fp(;)7
b Fw(d)p Ft(g)13 b FA(\(in)o(tersection\);)249 1593 y(and)249
1679 y Fw(group1)d Ft(n)f Fw(group2)i FA(=)h Ft(f)p Fw(b)p
Fp(;)7 b Fw(c)p Ft(g)14 b FA(\(di\013erence\))p Fp(:)249
1875 y Fw(MPI)p 326 1875 13 2 v 14 w(GROUP)p 482 1875
V 13 w(INCL\(group,)g(n,)g(ranks,)g(newgroup\))332 1950
y Fv(IN)158 b Fw(group)448 b Fv(group)332 1999 y(IN)158
b Fw(n)525 b Fv(n)o(um)o(b)q(er)14 b(of)e(elemen)o(ts)i(in)f(arra)o(y)g
(ranks)h(\(and)1079 2053 y(size)g(of)f Fq(newgroup)p
Fv(\))332 2103 y(IN)158 b Fw(ranks)455 b Fv(ranks)13
b(of)g(pro)q(cesses)g(in)g Fq(group)g Fv(to)f(app)q(ear)h(in)1079
2157 y Fq(newgroup)332 2206 y Fv(OUT)114 b Fw(newgroup)381
b Fv(new)19 b(group)g(deriv)o(ed)h(from)e(ab)q(o)o(v)o(e,)i(in)f(the)
1079 2260 y(order)14 b(de\014ned)g(b)o(y)26 b Fq(ranks)249
2370 y Fr(int)21 b(MPI)p 405 2370 14 2 v 15 w(Group)p
530 2370 V 15 w(incl\(MPI)p 721 2370 V 14 w(Group)g(group,)f(int)h(n,)h
(int)f(*ranks,)540 2424 y(MPI)p 609 2424 V 15 w(Group)f(*newgroup\))249
2508 y(MPI)p 318 2508 V 15 w(GROUP)p 443 2508 V 15 w(INCL\(GROUP,)f(N,)
j(RANKS,)e(NEWGROUP,)g(IERROR\))p eop
%%Page: 213 227
213 226 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(213)336
507 y Fr(INTEGER)21 b(GROUP,)f(N,)i(RANKS\(*\),)d(NEWGROUP,)h(IERROR)
291 591 y FA(The)e(function)f Fw(MPI)p 623 591 13 2 v
14 w(GROUP)p 779 591 V 13 w(INCL)h FA(creates)h(a)f(group)f
Fw(newgroup)i FA(that)f(consists)h(of)e(the)249 645 y
Fw(n)h FA(pro)q(cesses)j(in)c Fw(group)h FA(with)g(ranks)g
Fw(rank[0],)p Fp(:)7 b(:)g(:)e Fw(,)18 b(rank[n-1])p
FA(;)i(the)f(pro)q(cess)g(with)f(rank)f Fw(i)h FA(in)249
699 y Fw(newgroup)d FA(is)d(the)h(pro)q(cess)i(with)d(rank)h
Fw(ranks[i])g FA(in)f Fw(group)p FA(.)19 b(Eac)o(h)13
b(of)f(the)h Fw(n)g FA(elemen)o(ts)g(of)f Fw(ranks)249
753 y FA(m)o(ust)h(b)q(e)j(a)e(v)n(alid)e(rank)j(in)f
Fw(group)h FA(and)f(all)f(elemen)o(ts)i(m)o(ust)e(b)q(e)i(distinct,)f
(or)h(else)g(the)g(call)f(is)249 807 y(erroneous.)25
b(If)15 b Fw(n)h(=)g(0)p FA(,)f(then)i Fw(newgroup)g
FA(is)f Fq(MPI)p 1029 807 12 2 v 12 w(GROUP)p 1171 807
V 14 w(EMPTY)p FA(.)e(This)i(function)f(can,)h(for)249
861 y(instance,)e(b)q(e)h(used)g(to)e(reorder)j(the)e(elemen)o(ts)g(of)
f(a)h(group.)249 950 y Fs(Example)h(5.3)21 b FA(Let)e
Fw(group)h FA(b)q(e)f(a)g(handle)g(to)f(the)i(group)e
Ft(f)p Fw(a,b,c,d,e,f)p Ft(g)g FA(and)h(let)g Fw(ranks)g(=)249
1004 y(\(3,1,2\))p FA(.)e(Then,)d(a)f(handle)h(to)g(the)g(group)g
Ft(f)p Fw(d,b,c)p Ft(g)g FA(is)f(returned)j(in)d Fw(newgroup)p
FA(.)291 1094 y(Assume)d(that)g Fw(newgroup)i FA(w)o(as)e(created)h(b)o
(y)f(a)g(call)f(to)h Fw(MPI)p 1202 1094 13 2 v 14 w(GROUP)p
1358 1094 V 13 w(INCL\(group,)h(n,)g(ranks,)249 1148
y(newgroup\))p FA(.)19 b(Then,)12 b(a)f(subsequen)o(t)i(call)d(to)h
Fw(MPI)p 1019 1148 V 15 w(GROUP)p 1176 1148 V 13 w(TRANSLA)m(TE)p
1424 1148 V 15 w(RANKS\(group,)g(n,)249 1202 y(ranks,)j(newgroup,)g
(newranks\))i FA(will)11 b(return)k Fr(newranks)p FA([)p
Fr(i)p FA(])9 b(=)i Fr(i)p Fp(;)28 b Fr(i)12 b FA(=)g
Fr(0)p Fp(;)7 b(:)g(:)g(:)t(;)g Fr(n)g Ft(\000)h Fr(1)13
b FA(\(in)g(C\))g(or)249 1256 y Fr(newranks)p FA(\()p
Fr(i)8 b FA(+)h Fr(1)p FA(\))j(=)f Fr(i)p Fp(;)28 b Fr(i)12
b FA(=)g Fr(0)p Fp(;)7 b(:)g(:)g(:)t(;)g Fr(n)i Ft(\000)g
Fr(1)14 b FA(\(in)f(F)m(ortran\).)249 1381 y Fw(MPI)p
326 1381 V 14 w(GROUP)p 482 1381 V 13 w(EX)o(CL\(group,)h(n,)g(ranks,)g
(newgroup\))332 1455 y Fv(IN)158 b Fw(group)448 b Fv(group)332
1504 y(IN)158 b Fw(n)525 b Fv(n)o(um)o(b)q(er)14 b(of)f(elemen)o(ts)h
(in)g(arra)o(y)f(ranks)332 1552 y(IN)158 b Fw(ranks)455
b Fv(arra)o(y)19 b(of)f(in)o(teger)i(ranks)f(in)g Fq(group)g
Fv(not)f(to)1079 1606 y(app)q(ear)c(in)g Fq(newgroup)332
1655 y Fv(OUT)114 b Fw(newgroup)381 b Fv(new)13 b(group)g(deriv)o(ed)h
(from)f(ab)q(o)o(v)o(e,)g(preserv-)1079 1709 y(ing)h(the)f(order)h
(de\014ned)g(b)o(y)26 b Fq(group)249 1819 y Fr(int)21
b(MPI)p 405 1819 14 2 v 15 w(Group)p 530 1819 V 15 w(excl\(MPI)p
721 1819 V 14 w(Group)g(group,)f(int)h(n,)h(int)f(*ranks,)540
1873 y(MPI)p 609 1873 V 15 w(Group)f(*newgroup\))249
1957 y(MPI)p 318 1957 V 15 w(GROUP)p 443 1957 V 15 w(EXCL\(GROUP,)f(N,)
j(RANKS,)e(NEWGROUP,)g(IERROR\))336 2011 y(INTEGER)h(GROUP,)f(N,)i
(RANKS\(*\),)d(NEWGROUP,)h(IERROR)291 2095 y FA(The)d(function)g
Fw(MPI)p 622 2095 13 2 v 14 w(GROUP)p 778 2095 V 13 w(EX)o(CL)f
FA(creates)j(a)d(group)h(of)f(pro)q(cesses)k Fw(newgroup)f
FA(that)e(is)249 2149 y(obtained)d(b)o(y)g(deleting)g(from)f
Fw(group)h FA(those)h(pro)q(cesses)i(with)d(ranks)g Fw(ranks[0],)p
Fp(:)7 b(:)g(:)f Fw(,)14 b(ranks[n-1])249 2203 y FA(in)h(C)g(or)h
Fw(ranks[1],)p Fp(:)7 b(:)g(:)e Fw(,)15 b(ranks[n])i
FA(in)e(F)m(ortran.)22 b(The)16 b(ordering)g(of)e(pro)q(cesses)k(in)d
Fw(newgroup)j FA(is)249 2257 y(iden)o(tical)13 b(to)h(the)h(ordering)f
(in)g Fw(group)p FA(.)19 b(Eac)o(h)c(of)e(the)i Fw(n)f
FA(elemen)o(ts)g(of)g Fw(ranks)g FA(m)o(ust)f(b)q(e)i(a)f(v)n(alid)249
2311 y(rank)f(in)g Fw(group)h FA(and)f(all)f(elemen)o(ts)h(m)o(ust)f(b)
q(e)i(distinct;)f(otherwise,)h(the)g(call)e(is)i(erroneous.)19
b(If)249 2365 y Fw(n)14 b(=)g(0)p FA(,)g(then)g Fw(newgroup)i
FA(is)e(iden)o(tical)f(to)h Fw(group)p FA(.)249 2454
y Fs(Example)h(5.4)21 b FA(Let)e Fw(group)h FA(b)q(e)f(a)g(handle)g(to)
f(the)i(group)e Ft(f)p Fw(a,b,c,d,e,f)p Ft(g)g FA(and)h(let)g
Fw(ranks)g(=)249 2508 y(\(3,1,2\))p FA(.)e(Then,)d(a)f(handle)h(to)g
(the)g(group)g Ft(f)p Fw(a,e,f)p Ft(g)e FA(is)i(returned)i(in)d
Fw(newgroup)p FA(.)p eop
%%Page: 214 228
214 227 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(214)1256 b(Chapter)13 b(5)291
507 y FA(Supp)q(ose)d(one)f(calls)g Fw(MPI)p 685 507
13 2 v 14 w(GROUP)p 841 507 V 13 w(INCL\(group,)i(n,)f(ranks,)g
(newgroupi\))i FA(and)d Fw(MPI)p 1591 507 V 14 w(GROUP-)p
249 561 V 262 561 a(EX)o(CL\(group,)14 b(n,)h(ranks,)g(newgroup)q(e\))p
FA(.)24 b(The)15 b(call)f Fw(MPI)p 1145 561 V 14 w(GROUP)p
1301 561 V 13 w(UNION\(newgroupi,)i(new-)249 615 y(group)q(e,)j
(newgroup\))g FA(w)o(ould)e(return)h(in)f Fw(newgroup)i
FA(a)e(group)g(with)g(the)h(same)e(mem)o(b)q(ers)g(as)249
669 y Fw(group)10 b FA(but)f(p)q(ossibly)g(in)g(a)g(di\013eren)o(t)h
(order.)18 b(The)9 b(call)g Fw(MPI)p 1169 669 V 14 w(GROUP)p
1325 669 V 13 w(INTERSECTION\(groupi,)249 723 y(group)q(e,)15
b(newgroup\))g FA(w)o(ould)f(return)h Fq(MPI)p 910 723
12 2 v 12 w(GROUP)p 1052 723 V 14 w(EMPTY)p FA(.)249
848 y Fw(MPI)p 326 848 13 2 v 14 w(GROUP)p 482 848 V
13 w(RANGE)p 632 848 V 15 w(INCL\(group,)f(n,)g(ranges,)g(newgroup\))
332 923 y Fv(IN)158 b Fw(group)448 b Fv(group)332 972
y(IN)158 b Fw(n)525 b Fv(n)o(um)o(b)q(er)14 b(of)f(triplets)h(in)g
(arra)o(y)26 b Fq(ranges)332 1022 y Fv(IN)158 b Fw(ranges)436
b Fv(an)15 b(arra)o(y)f(of)g(in)o(teger)i(triplets,)f(of)f(the)h(form)
1079 1076 y(\(\014rst)g(rank,)h(last)g(rank,)f(stride\))h(indicating)
1079 1130 y(ranks)10 b(in)f Fq(group)g Fv(of)f(pro)q(cesses)i(to)f(b)q
(e)g(included)1079 1184 y(in)14 b Fq(newgroup)332 1234
y Fv(OUT)114 b Fw(newgroup)381 b Fv(new)19 b(group)g(deriv)o(ed)h(from)
e(ab)q(o)o(v)o(e,)i(in)f(the)1079 1288 y(order)14 b(de\014ned)g(b)o(y)
26 b Fq(ranges)249 1398 y Fr(int)21 b(MPI)p 405 1398
14 2 v 15 w(Group)p 530 1398 V 15 w(range)p 655 1398
V 15 w(incl\(MPI)p 846 1398 V 14 w(Group)f(group,)h(int)g(n,)h(int)f
(ranges[][3],)540 1452 y(MPI)p 609 1452 V 15 w(Group)f(*newgroup\))249
1536 y(MPI)p 318 1536 V 15 w(GROUP)p 443 1536 V 15 w(RANGE)p
568 1536 V 14 w(INCL\(GROUP,)g(N,)h(RANGES,)g(NEWGROUP,)f(IERROR\))336
1590 y(INTEGER)h(GROUP,)f(N,)i(RANGES\(3,*\),)d(NEWGROUP,)h(IERROR)249
1674 y FA(Eac)o(h)15 b(triplet)g(in)g Fw(ranges)g FA(sp)q(eci\014es)i
(a)d(sequence)j(of)e(ranks)g(for)f(pro)q(cesses)k(to)c(b)q(e)i
(included)f(in)249 1728 y(the)f(newly)e(created)j(group.)i(The)d(newly)
f(created)h(group)f(con)o(tains)g(the)g(pro)q(cesses)j(sp)q(eci\014ed)
249 1782 y(b)o(y)e(the)g(\014rst)h(triplet,)e(follo)o(w)o(ed)g(b)o(y)g
(the)i(pro)q(cesses)h(sp)q(eci\014ed)g(b)o(y)d(the)i(second)g(triplet,)
e(etc.)249 1877 y Fs(Example)i(5.5)21 b FA(Let)12 b Fw(group)h
FA(b)q(e)f(a)g(handle)f(to)h(the)h(group)e Ft(f)p Fw
(a,b,c,d,e,f,g,h,i,j)p Ft(g)e FA(and)j(let)g Fw(ranges)249
1931 y(=)18 b(\(\(6,7,1\),\(1,6,2\),)o(\(0,9,)o(4\)\))p
FA(.)26 b(The)19 b(\014rst)f(triplet)g Fw(\(6,7,1\))p
Ft(g)e FA(sp)q(eci\014es)j(the)f(pro)q(cesses)j Ft(f)p
Fw(g,h)p Ft(g)p FA(,)249 1985 y(with)f(ranks)h Fw(\(6,7\))p
FA(;)h(the)f(second)g(triplet)f Fw(\(1,6,2\))f FA(sp)q(eci\014es)j(the)
f(pro)q(cesses)i Ft(f)p Fw(b,d,f)p Ft(g)p FA(,)e(with)249
2039 y(ranks)13 b Fw(\(1,3,5\))p FA(;)e(and)h(the)h(third)f(triplet)g
Fw(\(0,9,4\))f FA(sp)q(eci\014es)j(the)f(pro)q(cesses)i
Ft(f)p Fw(a,e,i)p Ft(g)p FA(,)c(with)h(ranks)249 2093
y Fw(\(0,4,8\))p FA(.)17 b(The)d(call)f(creates)j(the)e(new)h(group)e
Ft(f)p Fw(g,h,b,d,f,a,e,i)p Ft(g)p FA(.)291 2189 y(Generally)m(,)f(if)
27 b Fw(ranges)14 b FA(consist)h(of)e(the)i(triplets)249
2276 y(\()p Fp(f)t(ir)q(st)357 2282 y Fk(1)377 2276 y
Fp(;)7 b(l)q(ast)465 2282 y Fk(1)484 2276 y Fp(;)g(str)q(ide)612
2282 y Fk(1)631 2276 y FA(\))p Fp(;)g(:)g(:)g(:)t(;)g
FA(\()p Fp(f)t(ir)q(st)847 2282 y Fj(n)871 2276 y Fp(;)g(l)q(ast)959
2282 y Fj(n)982 2276 y Fp(;)g(str)q(ide)1110 2282 y Fj(n)1132
2276 y FA(\))249 2363 y(then)15 b Fw(newgroup)g FA(consists)g(of)e(the)
i(sequence)h(of)d(pro)q(cesses)k(in)c Fw(group)i FA(with)e(ranks)249
2469 y Fp(f)t(ir)q(st)341 2475 y Fk(1)361 2469 y Fp(;)7
b(f)t(ir)q(st)472 2475 y Fk(1)501 2469 y FA(+)i Fp(str)q(ide)651
2475 y Fk(1)671 2469 y Fp(;)e(:)g(:)g(:)t(;)g(f)t(ir)q(st)855
2475 y Fk(1)884 2469 y FA(+)926 2410 y Fi(\026)955 2441
y Fp(l)q(ast)1024 2447 y Fk(1)1052 2441 y Ft(\000)j Fp(f)t(ir)q(st)1186
2447 y Fk(1)p 955 2459 251 2 v 1016 2497 a Fp(str)q(ide)1125
2503 y Fk(1)1211 2410 y Fi(\027)1244 2469 y Ft(\001)f
Fp(str)q(ide)1374 2475 y Fk(1)1393 2469 y Fp(;)e(:)g(:)g(:)p
eop
%%Page: 215 229
215 228 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(215)249
526 y Fp(f)t(ir)q(st)341 532 y Fj(n)365 526 y Fp(;)7
b(f)t(ir)q(st)476 532 y Fj(n)509 526 y FA(+)i Fp(str)q(ide)659
532 y Fj(n)682 526 y Fp(;)e(:)g(:)g(:)e(;)i(f)t(ir)q(st)867
532 y Fj(n)900 526 y FA(+)941 467 y Fi(\026)971 498 y
Fp(l)q(ast)1040 504 y Fj(n)1072 498 y Ft(\000)j Fp(f)t(ir)q(st)1206
504 y Fj(n)p 971 516 259 2 v 1034 554 a Fp(str)q(ide)1143
560 y Fj(n)1235 467 y Fi(\027)1268 526 y Ft(\001)f Fp(str)q(ide)1398
532 y Fj(n)1421 526 y Fp(:)291 627 y FA(Eac)o(h)j(computed)g(rank)h(m)o
(ust)e(b)q(e)i(a)g(v)n(alid)e(rank)h(in)g Fw(group)h
FA(and)f(all)g(computed)g(ranks)g(m)o(ust)249 681 y(b)q(e)j(distinct,)f
(or)h(else)g(the)g(call)e(is)i(erroneous.)21 b(Note)14
b(that)h(a)f(call)g(ma)o(y)e(ha)o(v)o(e)i Fp(f)t(ir)q(st)1576
687 y Fj(i)1604 681 y Fp(>)f(l)q(ast)1718 687 y Fj(i)1732
681 y FA(,)249 735 y(and)h Fp(str)q(ide)439 741 y Fj(i)467
735 y FA(ma)o(y)e(b)q(e)i(negativ)o(e,)g(but)g(cannot)g(b)q(e)g(zero.)
291 789 y(The)j(functionalit)o(y)d(of)i(this)h(routine)g(is)f(sp)q
(eci\014ed)i(to)e(b)q(e)i(equiv)n(alen)o(t)d(to)i(expanding)f(the)249
843 y(arra)o(y)g(of)f(ranges)i(to)f(an)g(arra)o(y)g(of)f(the)i
(included)f(ranks)h(and)f(passing)g(the)g(resulting)h(arra)o(y)249
897 y(of)12 b(ranks)h(and)f(other)h(argumen)o(ts)f(to)h
Fw(MPI)p 920 897 13 2 v 14 w(GROUP)p 1076 897 V 13 w(INCL)p
FA(.)f(A)h(call)e(to)i Fw(MPI)p 1446 897 V 14 w(GROUP)p
1602 897 V 13 w(INCL)g FA(is)249 950 y(equiv)n(alen)o(t)e(to)h(a)f
(call)g(to)h Fw(MPI)p 725 950 V 14 w(GROUP)p 881 950
V 13 w(RANGE)p 1031 950 V 14 w(INCL)g FA(with)f(eac)o(h)h(rank)g
Fw(i)g FA(in)f Fw(ranks)h FA(replaced)249 1004 y(b)o(y)i(the)g(triplet)
g Fr(\(i,i,1\))f FA(in)g(the)h(argumen)o(t)f Fw(ranges)p
FA(.)249 1129 y Fw(MPI)p 326 1129 V 14 w(GROUP)p 482
1129 V 13 w(RANGE)p 632 1129 V 15 w(EX)o(CL\(group,)g(n,)h(ranges,)g
(newgroup\))332 1204 y Fv(IN)158 b Fw(group)448 b Fv(group)332
1253 y(IN)158 b Fw(n)525 b Fv(n)o(um)o(b)q(er)14 b(of)f(elemen)o(ts)h
(in)g(arra)o(y)f(ranks)332 1301 y(IN)158 b Fw(ranges)436
b Fv(an)16 b(arra)o(y)h(of)e(in)o(teger)i(triplets)g(of)f(the)g(form)
1079 1355 y(\(\014rst)d(rank,)h(last)f(rank,)h(stride\),)f(indicating)
1079 1409 y(the)f(ranks)g(in)g Fq(group)f Fv(of)g(pro)q(cesses)i(to)e
(b)q(e)g(ex-)1079 1463 y(cluded)h(from)e(the)g(output)h(group)g
Fq(newgroup)p Fv(.)332 1512 y(OUT)114 b Fw(newgroup)381
b Fv(new)13 b(group)g(deriv)o(ed)h(from)f(ab)q(o)o(v)o(e,)g(preserv-)
1079 1566 y(ing)h(the)f(order)h(in)g Fq(group)249 1676
y Fr(int)21 b(MPI)p 405 1676 14 2 v 15 w(Group)p 530
1676 V 15 w(range)p 655 1676 V 15 w(excl\(MPI)p 846 1676
V 14 w(Group)f(group,)h(int)g(n,)h(int)f(ranges[][3],)540
1730 y(MPI)p 609 1730 V 15 w(Group)f(*newgroup\))249
1814 y(MPI)p 318 1814 V 15 w(GROUP)p 443 1814 V 15 w(RANGE)p
568 1814 V 14 w(EXCL\(GROUP,)g(N,)h(RANGES,)g(NEWGROUP,)f(IERROR\))336
1868 y(INTEGER)h(GROUP,)f(N,)i(RANGES\(3,*\),)d(NEWGROUP,)h(IERROR)249
1952 y FA(Eac)o(h)f(triplet)f(in)g Fw(ranges)g FA(sp)q(eci\014es)j(a)c
(sequence)k(of)c(ranks)i(for)f(pro)q(cesses)j(to)d(b)q(e)g(excluded)249
2006 y(from)e(the)i(newly)f(created)i(group.)28 b(The)18
b(newly)f(created)i(group)e(con)o(tains)g(the)h(remaining)249
2060 y(pro)q(cesses,)e(ordered)f(as)f(in)g Fw(group)p
FA(.)249 2149 y Fs(Example)h(5.6)21 b FA(Let,)11 b(as)f(in)f(Example)f
(5.5,)i Fw(group)g FA(b)q(e)h(a)e(handle)h(to)g(the)g(group)g
Ft(f)p Fw(a,b,c,d,e,f,g,-)249 2203 y(h,i,j)p Ft(g)h FA(and)h(let)f
Fw(ranges)i(=)f(\(\(6,7,1\),\(1,6,2\),)o(\(0,9,)o(4\)\))p
FA(.)i(The)f(call)e(creates)i(the)g(new)f(group)f Ft(f)p
Fw(c,j)p Ft(g)p FA(,)249 2257 y(consisting)j(of)f(all)g(pro)q(cesses)j
(in)e(the)g(old)g(group)f(omitted)g(b)o(y)g(the)i(list)e(of)h
(triplets.)291 2346 y(Eac)o(h)e(computed)g(rank)h(m)o(ust)e(b)q(e)i(a)g
(v)n(alid)e(rank)h(in)g Fw(group)h FA(and)f(all)g(computed)g(ranks)g(m)
o(ust)249 2400 y(b)q(e)j(distinct,)e(or)h(else)h(the)f(call)f(is)h
(erroneous.)291 2454 y(The)j(functionalit)o(y)d(of)i(this)h(routine)g
(is)f(sp)q(eci\014ed)i(to)e(b)q(e)i(equiv)n(alen)o(t)d(to)i(expanding)f
(the)249 2508 y(arra)o(y)c(of)g(ranges)h(to)f(an)h(arra)o(y)f(of)g(the)
h(excluded)g(ranks)g(and)f(passing)g(the)h(resulting)g(arra)o(y)f(of)p
eop
%%Page: 216 230
216 229 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(216)1256 b(Chapter)13 b(5)249
507 y FA(ranks)i(and)g(other)h(argumen)o(ts)e(to)h Fw(MPI)p
886 507 13 2 v 15 w(GROUP)p 1043 507 V 13 w(EX)o(CL)p
FA(.)f(A)h(call)f(to)h Fw(MPI)p 1433 507 V 14 w(GROUP)p
1589 507 V 13 w(EX)o(CL)g FA(is)249 561 y(equiv)n(alen)o(t)10
b(to)h(a)f(call)h(to)f Fw(MPI)p 720 561 V 15 w(GROUP)p
877 561 V 13 w(RANGE)p 1027 561 V 14 w(EX)o(CL)g FA(with)h(eac)o(h)g
(rank)g Fw(i)f FA(in)h Fw(ranks)g FA(replaced)249 615
y(b)o(y)j(the)g(triplet)g Fr(\(i,i,1\))f FA(in)g(the)h(argumen)o(t)f
Fw(ranges)p FA(.)249 707 y FB(A)n(dvic)n(e)18 b(to)h(users.)61
b FA(The)18 b(range)g(op)q(erations)g(do)g(not)g(explicitly)f(en)o
(umerate)h(ranks,)h(and)249 760 y(therefore)c(are)e(more)g(scalable)g
(if)f(implemen)o(ted)f(e\016cien)o(tly)m(.)17 b(Hence,)e(it)d(is)i
(recommend)d(that)249 814 y Fw(MPI)19 b FA(programmers)e(use)j(them)f
(whenev)o(er)i(p)q(ossible,)f(as)f(high-qualit)o(y)f(implem)o(en)o
(tations)249 868 y(ma)o(y)12 b(tak)o(e)i(adv)n(an)o(tage)f(of)g(this)h
(fact.)k(\()p FB(End)e(of)f(advic)n(e)g(to)g(users.)p
FA(\))249 960 y FB(A)n(dvic)n(e)e(to)g(implementors.)35
b FA(The)12 b(range)g(op)q(erations)g(should)g(b)q(e)g(implemen)o(ted,)
e(if)h(p)q(ossible,)249 1014 y(without)g(en)o(umerating)f(the)i(group)f
(mem)o(b)q(ers,)f(in)h(order)h(to)f(obtain)f(b)q(etter)j(scalabilit)o
(y)d(\(time)249 1068 y(and)k(space\).)19 b(\()p FB(End)d(of)f(advic)n
(e)g(to)g(implementors.)p FA(\))249 1159 y Fs(5.3.3)48
b(Group)14 b(Destructors)208 1313 y Fw(MPI)p 285 1313
V 14 w(GROUP)p 441 1313 V 13 w(FREE\(group\))332 1388
y Fv(INOUT)71 b Fw(group)448 b Fv(group)249 1498 y Fr(int)21
b(MPI)p 405 1498 14 2 v 15 w(Group)p 530 1498 V 15 w(free\(MPI)p
721 1498 V 14 w(Group)g(*group\))249 1582 y(MPI)p 318
1582 V 15 w(GROUP)p 443 1582 V 15 w(FREE\(GROUP,)e(IERROR\))336
1636 y(INTEGER)i(GROUP,)f(IERROR)291 1720 y FA(This)12
b(op)q(eration)h(marks)e(a)h(group)h(ob)r(ject)g(for)f(deallo)q
(cation.)17 b(The)c(handle)f Fw(group)i FA(is)e(set)i(to)249
1774 y Fq(MPI)p 321 1774 12 2 v 13 w(GROUP)p 464 1774
V 13 w(NULL)d FA(b)o(y)f(the)h(call.)16 b(An)o(y)10 b(ongoing)e(op)q
(eration)i(using)g(this)g(group)g(will)f(complete)249
1828 y(normally)m(.)249 1919 y FB(A)n(dvic)n(e)20 b(to)g(implementors.)
68 b FA(One)20 b(can)f(k)o(eep)h(a)f(reference)j(coun)o(t)e(that)f(is)g
(incremen)o(ted)249 1973 y(for)c(eac)o(h)g(call)g(to)g
Fw(MPI)p 615 1973 13 2 v 14 w(COMM)p 759 1973 V 15 w(CREA)m(TE)e
FA(and)i Fw(MPI)p 1101 1973 V 14 w(COMM)p 1245 1973 V
15 w(DUP)p FA(,)f(and)g(decremen)o(ted)j(for)249 2027
y(eac)o(h)11 b(call)e(to)h Fw(MPI)p 535 2027 V 15 w(GROUP)p
692 2027 V 13 w(FREE)f FA(or)h Fw(MPI)p 937 2027 V 14
w(COMM)p 1081 2027 V 15 w(FREE)p FA(;)f(the)i(group)f(ob)r(ject)h(is)f
(ultimately)249 2081 y(deallo)q(cated)16 b(when)g(the)g(reference)i
(coun)o(t)e(drops)g(to)g(zero.)24 b(\()p FB(End)17 b(of)f(advic)n(e)h
(to)g(implemen-)249 2135 y(tors.)p FA(\))249 2255 y FD(5.4)52
b(Comm)o(unicator)17 b(Managemen)o(t)249 2363 y FA(This)12
b(section)i(describ)q(es)g(the)f(manipulation)d(of)i(comm)o(uni)o
(cators)f(in)h Fw(MPI)p FA(.)f(Op)q(erations)i(that)249
2417 y(access)19 b(comm)o(unicators)14 b(are)j(lo)q(cal)f(and)h(their)g
(execution)g(do)q(es)h(not)f(require)g(in)o(terpro)q(cess)249
2471 y(comm)o(unication.)35 b(Op)q(erations)22 b(that)f(create)h(comm)o
(unicators)d(are)i(collectiv)o(e)g(and)f(ma)o(y)p eop
%%Page: 217 231
217 230 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(217)249
507 y FA(require)16 b(in)o(terpro)q(cess)i(comm)o(unicatio)o(n.)i(W)m
(e)15 b(describ)q(e)i(the)f(b)q(eha)o(vior)f(of)g(these)i(functions,)
249 561 y(assuming)12 b(that)i(their)g Fw(comm)e FA(argumen)o(t)h(is)g
(an)h(in)o(tracomm)n(unicator;)d(w)o(e)j(describ)q(e)h(later)f(in)249
615 y(Section)g(5.7)f(their)i(seman)o(tics)e(for)g(in)o(tercomm)o
(unicator)f(argumen)o(ts.)249 698 y Fs(5.4.1)48 b(Comm)o(unicator)13
b(Accessors)249 781 y FA(The)h(follo)o(wing)e(are)i(all)f(lo)q(cal)g
(op)q(erations.)249 906 y Fw(MPI)p 326 906 13 2 v 14
w(COMM)p 470 906 V 15 w(SIZE\(comm,)e(size\))332 981
y Fv(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)332 1031
y(OUT)114 b Fw(size)484 b Fv(n)o(um)o(b)q(er)10 b(of)e(pro)q(cesses)i
(in)g(the)f(group)g(of)17 b Fq(comm)249 1141 y Fr(int)k(MPI)p
405 1141 14 2 v 15 w(Comm)p 508 1141 V 15 w(size\(MPI)p
699 1141 V 14 w(Comm)g(comm,)g(int)g(*size\))249 1225
y(MPI)p 318 1225 V 15 w(COMM)p 421 1225 V 15 w(SIZE\(COMM,)f(SIZE,)g
(IERROR\))336 1279 y(INTEGER)h(COMM,)f(SIZE,)h(IERROR)291
1363 y Fw(MPI)p 368 1363 13 2 v 14 w(COMM)p 512 1363
V 15 w(SIZE)13 b FA(returns)j(the)e(size)h(of)e(the)h(group)g(asso)q
(ciated)h(with)e Fw(comm)p FA(.)291 1417 y(This)g(function)h(indicates)
g(the)g(n)o(um)o(b)q(er)g(of)f(pro)q(cesses)j(in)o(v)o(olv)o(ed)d(in)g
(an)h(in)o(tracomm)o(uni)o(ca-)249 1471 y(tor.)28 b(F)m(or)16
b Fq(MPI)p 491 1471 12 2 v 13 w(COMM)p 625 1471 V 13
w(W)o(ORLD)p FA(,)g(it)h(indicates)g(the)h(total)e(n)o(um)o(b)q(er)h
(of)f(pro)q(cesses)k(a)o(v)n(ailable)249 1525 y(at)e(initialization)e
(time.)30 b(\(F)m(or)18 b(this)g(v)o(ersion)g(of)g Fw(MPI)p
FA(,)f(this)h(is)g(also)g(the)h(total)e(n)o(um)o(b)q(er)h(of)249
1579 y(pro)q(cesses)f(a)o(v)n(ailable)11 b(throughout)j(the)h
(computation\).)249 1670 y FB(R)n(ationale.)36 b FA(This)11
b(function)h(is)f(equiv)n(alen)o(t)g(to)h(accessing)h(the)f(comm)o
(unicator's)d(group)j(with)249 1724 y Fw(MPI)p 326 1724
13 2 v 14 w(COMM)p 470 1724 V 15 w(GROUP)f FA(\(see)j(ab)q(o)o(v)o
(e\),)f(computing)e(the)j(size)f(using)g Fw(MPI)p 1400
1724 V 14 w(GROUP)p 1556 1724 V 13 w(SIZE)p FA(,)g(and)249
1778 y(then)g(freeing)f(the)h(group)f(temp)q(orary)g(via)f
Fw(MPI)p 1006 1778 V 15 w(GROUP)p 1163 1778 V 13 w(FREE)p
FA(.)g(Ho)o(w)o(ev)o(er,)h(this)h(function)f(is)249 1832
y(so)i(commonly)d(used,)j(that)g(this)g(shortcut)h(w)o(as)f(in)o(tro)q
(duced.)k(\()p FB(End)e(of)f(r)n(ationale.)p FA(\))249
1994 y Fw(MPI)p 326 1994 V 14 w(COMM)p 470 1994 V 15
w(RANK\(comm,)c(rank\))332 2069 y Fv(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)332 2118 y(OUT)114 b Fw(rank)471
b Fv(rank)18 b(of)e(the)h(calling)i(pro)q(cess)f(in)f(group)h(of)1079
2172 y Fq(comm)249 2283 y Fr(int)j(MPI)p 405 2283 14
2 v 15 w(Comm)p 508 2283 V 15 w(rank\(MPI)p 699 2283
V 14 w(Comm)g(comm,)g(int)g(*rank\))249 2367 y(MPI)p
318 2367 V 15 w(COMM)p 421 2367 V 15 w(RANK\(COMM,)f(RANK,)g(IERROR\))
336 2421 y(INTEGER)h(COMM,)f(RANK,)h(IERROR)p eop
%%Page: 218 232
218 231 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(218)1256 b(Chapter)13 b(5)291
507 y Fw(MPI)p 368 507 13 2 v 14 w(COMM)p 512 507 V 15
w(RANK)j FA(indicates)h(the)g(rank)g(of)f(the)h(pro)q(cess)h(that)f
(calls)f(it,)h(in)f(the)h(range)249 561 y(from)d(0)7
b Fp(:)g(:)g(:)n Fw(size)p Ft(\000)p FA(1,)17 b(where)g
Fw(size)f FA(is)g(the)h(return)g(v)n(alue)e(of)h Fw(MPI)p
1252 561 V 14 w(COMM)p 1396 561 V 15 w(SIZE)p FA(.)f(This)h(rank)g(is)
249 615 y(relativ)o(e)h(to)h(the)g(group)g(asso)q(ciated)g(with)f(the)h
(in)o(tracomm)o(unicator)d Fw(comm)p FA(.)27 b(Th)o(us,)18
b Fw(MPI-)p 249 669 V 262 669 a(COMM)p 394 669 V 14 w(RANK\(MPI)p
612 669 V 14 w(COMM)p 756 669 V 15 w(W)o(ORLD,)c(rank\))i
FA(returns)g(in)f Fw(rank)g FA(the)h(\\absolute")e(rank)h(of)249
723 y(the)21 b(calling)e(pro)q(cess)j(in)d(the)i(global)e(comm)o
(unicati)o(on)e(group)j(of)g Fw(MPI)p 1427 723 V 14 w(COMM)p
1571 723 V 15 w(W)o(ORLD)p FA(;)249 777 y Fw(MPI)p 326
777 V 14 w(COMM)p 470 777 V 15 w(RANK\()14 b(MPI)p 703
777 V 14 w(COMM)p 847 777 V 15 w(SELF,)f(rank\))i FA(returns)g
Fw(rank)g(=)f(0)p FA(.)249 868 y FB(R)n(ationale.)36
b FA(This)11 b(function)h(is)f(equiv)n(alen)o(t)g(to)h(accessing)h(the)
f(comm)o(unicator's)d(group)j(with)249 922 y Fw(MPI)p
326 922 V 14 w(COMM)p 470 922 V 15 w(GROUP)k FA(\(see)j(ab)q(o)o(v)o
(e\),)f(computing)e(the)j(rank)e(using)h Fw(MPI)p 1452
922 V 14 w(GROUP)p 1608 922 V 13 w(RANK)p FA(,)249 976
y(and)c(then)h(freeing)f(the)h(group)f(temp)q(orary)g(via)f
Fw(MPI)p 1099 976 V 14 w(GROUP)p 1255 976 V 13 w(FREE)p
FA(.)g(Ho)o(w)o(ev)o(er,)h(this)g(func-)249 1030 y(tion)f(is)h(so)g
(commonly)d(used,)j(that)g(this)g(shortcut)h(w)o(as)f(in)o(tro)q
(duced.)k(\()p FB(End)e(of)f(r)n(ationale.)p FA(\))249
1122 y FB(A)n(dvic)n(e)k(to)f(users.)62 b FA(Man)o(y)17
b(programs)g(will)g(b)q(e)h(written)h(with)f(the)g(master-sla)o(v)o(e)f
(mo)q(del,)249 1176 y(where)k(one)g(pro)q(cess)h(\(suc)o(h)f(as)f(the)g
(rank-zero)h(pro)q(cess\))h(will)d(pla)o(y)g(a)h(sup)q(ervisory)h
(role,)249 1230 y(and)16 b(the)h(other)g(pro)q(cesses)h(will)d(serv)o
(e)j(as)e(compute)f(no)q(des.)26 b(In)16 b(this)g(framew)o(ork,)f(the)i
(t)o(w)o(o)249 1284 y(preceding)i(calls)f(are)h(useful)f(for)g
(determining)f(the)h(roles)h(of)e(the)i(v)n(arious)e(pro)q(cesses)k(of)
d(a)249 1337 y(comm)o(unicator.)d(\()p FB(End)h(of)f(advic)n(e)g(to)g
(users.)p FA(\))249 1500 y Fw(MPI)p 326 1500 V 14 w(COMM)p
470 1500 V 15 w(COMP)m(ARE\(comm)o(1,)10 b(comm2,)h(result\))332
1574 y Fv(IN)158 b Fw(comm1)418 b Fv(\014rst)14 b(comm)o(unicator)332
1624 y(IN)158 b Fw(comm2)418 b Fv(second)14 b(comm)o(unicator)332
1674 y(OUT)114 b Fw(result)452 b Fv(result)249 1784 y
Fr(int)21 b(MPI)p 405 1784 14 2 v 15 w(Comm)p 508 1784
V 15 w(compare\(MPI)p 765 1784 V 14 w(Comm)g(comm1,MPI)p
1086 1784 V 13 w(Comm)g(comm2,)g(int)g(*result\))249
1868 y(MPI)p 318 1868 V 15 w(COMM)p 421 1868 V 15 w(COMPARE\(COMM1,)e
(COMM2,)h(RESULT,)h(IERROR\))336 1922 y(INTEGER)g(COMM1,)f(COMM2,)h
(RESULT,)f(IERROR)291 2006 y Fw(MPI)p 368 2006 13 2 v
14 w(COMM)p 512 2006 V 15 w(COMP)m(ARE)13 b FA(is)i(used)h(to)f(\014nd)
h(the)g(relationship)f(b)q(et)o(w)o(een)h(t)o(w)o(o)f(intra-com-)249
2060 y(m)o(unicators.)h Fq(MPI)p 550 2060 12 2 v 13 w(IDENT)11
b FA(results)i(if)e(and)g(only)g(if)g Fw(comm1)f FA(and)h
Fw(comm2)f FA(are)i(handles)g(for)f(the)249 2114 y(same)h(ob)r(ject)h
(\(represen)o(ting)i(the)e(same)f(comm)o(unicati)o(on)e(domain\).)15
b Fq(MPI)p 1438 2114 V 13 w(CONGRUENT)e FA(re-)249 2168
y(sults)f(if)f(the)h(underlying)f(groups)h(are)g(iden)o(tical)f(in)g
(constituen)o(ts)h(and)g(rank)f(order)i(\(the)f(com-)249
2222 y(m)o(unicators)f(represen)o(t)j(t)o(w)o(o)e(distinct)g(comm)o
(unicatio)o(n)d(domains)i(with)g(the)i(same)e(group)h(at-)249
2276 y(tribute\).)18 b Fq(MPI)p 491 2276 V 13 w(SIMILAR)11
b FA(results)j(if)d(the)i(group)g(mem)o(b)q(ers)e(of)g(b)q(oth)i(comm)o
(unicators)d(are)j(the)249 2330 y(same)e(but)i(the)g(rank)f(order)h
(di\013ers.)18 b Fq(MPI)p 908 2330 V 13 w(UNEQUAL)13
b FA(results)g(otherwise.)18 b(The)13 b(groups)f(asso-)249
2384 y(ciated)j(with)g(t)o(w)o(o)f FB(di\013er)n(ent)h
FA(comm)o(unicators)e(could)i(b)q(e)g(gotten)g(via)f
Fw(MPI)p 1446 2384 13 2 v 15 w(COMM)p 1591 2384 V 14
w(GROUP)249 2438 y FA(and)22 b(then)i(used)f(in)f(a)g(call)g(to)g
Fw(MPI)p 866 2438 V 15 w(GROUP)p 1023 2438 V 13 w(COMP)m(ARE)p
FA(.)e(If)i Fw(MPI)p 1391 2438 V 14 w(COMM)p 1535 2438
V 15 w(COMP)m(ARE)249 2492 y FA(giv)o(es)14 b Fq(MPI)p
423 2492 12 2 v 12 w(CONGRUENT)g FA(then)g Fw(MPI)p 851
2492 13 2 v 15 w(GROUP)p 1008 2492 V 13 w(COMP)m(ARE)d
FA(will)h(giv)o(e)h Fq(MPI)p 1463 2492 12 2 v 13 w(IDENT)p
FA(.)g(If)g Fw(MPI-)p eop
%%Page: 219 233
219 232 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(219)p
249 507 13 2 v 262 507 a Fw(COMM)p 394 507 V 14 w(COMP)m(ARE)10
b FA(giv)o(es)i Fq(MPI)p 786 507 12 2 v 13 w(SIMILAR)f
FA(then)h Fw(MPI)p 1126 507 13 2 v 15 w(GROUP)p 1283
507 V 13 w(COMP)m(ARE)e FA(will)g(giv)o(e)i Fq(MPI-)p
249 561 12 2 v 261 561 a(SIMILAR)p FA(.)249 644 y Fs(5.4.2)48
b(Comm)o(unicator)13 b(Constructors)249 727 y FA(The)g(follo)o(wing)c
(are)k(collectiv)o(e)f(functions)g(that)g(are)h(in)o(v)o(ok)o(ed)e(b)o
(y)h(all)e(pro)q(cesses)15 b(in)d(the)h(group)249 781
y(asso)q(ciated)i(with)e Fw(comm)p FA(.)249 906 y Fw(MPI)p
326 906 13 2 v 14 w(COMM)p 470 906 V 15 w(DUP\(comm,)e(new)o(comm\))332
981 y Fv(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)332
1028 y(OUT)114 b Fw(new)o(comm)373 b Fv(cop)o(y)14 b(of)f
Fq(comm)249 1138 y Fr(int)21 b(MPI)p 405 1138 14 2 v
15 w(Comm)p 508 1138 V 15 w(dup\(MPI)p 677 1138 V 14
w(Comm)g(comm,)g(MPI)p 997 1138 V 15 w(Comm)g(*newcomm\))249
1222 y(MPI)p 318 1222 V 15 w(COMM)p 421 1222 V 15 w(DUP\(COMM,)f
(NEWCOMM,)g(IERROR\))336 1276 y(INTEGER)h(COMM,)f(NEWCOMM,)g(IERROR)291
1360 y Fw(MPI)p 368 1360 13 2 v 14 w(COMM)p 512 1360
V 15 w(DUP)d FA(creates)j(a)e(new)h(in)o(tracomm)o(unicator,)d
Fw(new)o(comm)p FA(,)i(with)g(the)h(same)249 1414 y(\014xed)c
(attributes)g(\(group,)f(or)g(groups,)g(and)g(top)q(ology\))g(as)g(the)
h(input)f(in)o(tracomm)o(unicator,)249 1468 y Fw(comm)p
FA(.)23 b(The)16 b(newly)g(created)i(comm)o(unicators)13
b(at)j(the)h(pro)q(cesses)i(in)c(the)i(group)f(of)f Fw(comm)249
1522 y FA(de\014ne)21 b(a)f(new,)i(distinct)e(comm)o(unication)d
(domain,)i(with)h(the)h(same)e(group)h(as)g(the)h(old)249
1576 y(comm)o(unicators.)16 b(The)e(function)g(can)g(also)f(b)q(e)h
(used)h(to)f(replicate)g(in)o(tercomm)o(unicators.)291
1630 y(The)d(asso)q(ciation)f(of)g(user-de\014ned)i(\(or)f(cac)o(hed\))
h(attributes)f(with)f Fw(new)o(comm)g FA(is)h(con)o(trolled)249
1684 y(b)o(y)j(the)h(cop)o(y)g(callbac)o(k)f(function)g(sp)q(eci\014ed)
i(when)f(the)g(attribute)g(w)o(as)f(attac)o(hed)h(to)g
Fw(comm)p FA(.)249 1738 y(F)m(or)f(eac)o(h)h(k)o(ey)g(v)n(alue,)e(the)i
(resp)q(ectiv)o(e)i(cop)o(y)d(callbac)o(k)g(function)g(determines)h
(the)g(attribute)249 1792 y(v)n(alue)h(asso)q(ciated)h(with)f(this)g(k)
o(ey)h(in)f(the)h(new)f(comm)o(unicator.)23 b(User-de\014ned)c
(attributes)249 1845 y(are)14 b(discussed)i(in)d(Section)i(5.6.)249
1934 y FB(A)n(dvic)n(e)k(to)g(users.)65 b FA(This)18
b(op)q(eration)h(can)f(b)q(e)i(used)f(to)f(pro)o(vide)h(a)f(parallel)f
(library)h(call)249 1988 y(with)13 b(a)g(duplicate)g(comm)o(unication)d
(space)k(that)f(has)h(the)f(same)g(prop)q(erties)h(as)f(the)h(original)
249 2042 y(comm)o(unicator.)19 b(This)c(includes)h(an)o(y)f
(user-de\014ned)i(attributes)f(\(see)h(b)q(elo)o(w\),)d(and)h(top)q
(olo-)249 2096 y(gies)k(\(see)i(c)o(hapter)f(6\).)35
b(This)19 b(call)f(is)i(v)n(alid)d(ev)o(en)j(if)f(there)i(are)e(p)q
(ending)h(p)q(oin)o(t-to-p)q(oin)o(t)249 2150 y(comm)o(unications)11
b(in)o(v)o(olving)g(the)j(comm)o(unicator)d Fw(comm)p
FA(.)16 b(A)d(t)o(ypical)g(call)g(migh)o(t)e(in)o(v)o(olv)o(e)i(a)249
2204 y Fw(MPI)p 326 2204 V 14 w(COMM)p 470 2204 V 15
w(DUP)i FA(at)h(the)h(b)q(eginning)e(of)h(the)g(parallel)f(call,)h(and)
g(an)f Fw(MPI)p 1486 2204 V 15 w(COMM)p 1631 2204 V 14
w(FREE)249 2258 y FA(of)f(that)g(duplicated)g(comm)o(unicator)d(at)j
(the)h(end)g(of)e(the)i(call)e({)h(see)h(Example)e(5.11.)k(Other)249
2312 y(mo)q(dels)c(of)g(comm)o(unicator)e(managemen)o(t)g(are)k(also)e
(p)q(ossible.)18 b(\()p FB(End)e(of)f(advic)n(e)g(to)g(users.)p
FA(\))249 2400 y FB(A)n(dvic)n(e)k(to)g(implementors.)65
b FA(Assume)19 b(that)g(comm)o(unicators)d(are)j(implemen)o(ted)d(as)j
(de-)249 2454 y(scrib)q(ed)d(on)e(page)g(205.)19 b(If)14
b(a)g(unique)h(con)o(text)g(is)f(used)i(p)q(er)f(comm)o(unicatio)o(n)d
(domain,)g(then)249 2508 y(the)19 b(generation)g(of)e(a)h(new)h(comm)o
(unicator)d(requires)j(a)f(collectiv)o(e)h(call)e(where)j(pro)q(cesses)
p eop
%%Page: 220 234
220 233 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(220)1256 b(Chapter)13 b(5)249
507 y FA(agree)h(on)g(a)f(new)h(con)o(text)g(v)n(alue.)j(E.g.,)c(this)g
(could)h(b)q(e)g(1)8 b(+)h(max)n Ft(f)p FA(already)p
1453 507 13 2 v 15 w(used)p 1547 507 V 16 w(con)o(texts)p
Ft(g)p FA(,)249 561 y(computed)16 b(using)h(an)g Fw(MPI)p
693 561 V 14 w(ALLREDUCE)f FA(call)g(\(assuming)g(there)i(is)e(no)h
(need)h(to)f(garbage)249 615 y(collect)g(con)o(texts\).)28
b(If)16 b(a)g(di\013eren)o(t)i(con)o(text)f(is)g(used)g(b)o(y)g(eac)o
(h)g(pro)q(cess,)i(then)e(a)f(collectiv)o(e)249 669 y(call)c(is)g
(needed)i(where)f(eac)o(h)g(pro)q(cess)h(exc)o(hange)f(with)f(all)f
(other)i(pro)q(cesses)i(the)e(v)n(alue)f(of)g(the)249
723 y(con)o(text)j(it)e(selected,)i(using)f(an)g Fw(MPI)p
848 723 V 14 w(ALLGA)m(THER)g FA(call.)249 792 y(It)e(is)f
(theoretically)g(p)q(ossible)h(to)f(agree)h(on)f(a)g(group-wide)h
(unique)f(con)o(text)h(with)f(no)g(comm)o(u-)249 846
y(nication:)17 b(e.g.)g(one)c(could)g(use)g(as)g(con)o(text)g(a)g
(unique)g(enco)q(ding)g(of)f(the)h(group,)g(follo)o(w)o(ed)e(b)o(y)249
900 y(a)j(sequence)j(n)o(um)o(b)q(er)d(for)g(in)o(tracomm)o(unicators)e
(with)i(this)h(group.)20 b(Since)15 b(all)f(pro)q(cesses)j(in)249
953 y(the)e(group)f(execute)j(the)e(same)e(sequence)k(of)c(calls)h(to)h
Fw(MPI)p 1207 953 V 14 w(COMM)p 1351 953 V 15 w(DUP)e
FA(with)h(this)h(group)249 1007 y(argumen)o(t,)i(all)g(pro)q(cesses)k
(will)16 b(lo)q(cally)h(compute)g(the)i(same)e(id.)29
b(This)18 b(design)g(is)g(not)g(b)q(e)249 1061 y(practical)d(b)q
(ecause)i(it)e(generates)h(large)f(con)o(text)h(ids.)21
b(Implemen)o(tations)13 b(ma)o(y)g(strik)o(e)i(v)n(ari-)249
1115 y(ous)e(compromises)e(b)q(et)o(w)o(een)j(comm)o(unicatio)o(n)c(o)o
(v)o(erhead)j(for)g(comm)o(uni)o(cator)e(creation)i(and)249
1169 y(con)o(text)i(size.)249 1238 y(Imp)q(ortan)o(t:)i(If)c(new)h
(comm)o(unicators)d(are)j(created)h(without)e(sync)o(hronizing)h(the)g
(pro)q(cesses)249 1292 y(in)o(v)o(olv)o(ed)k(then)i(the)g(comm)o
(unication)c(system)j(should)g(b)q(e)h(able)f(to)g(cop)q(e)h(with)f
(messages)249 1346 y(arriving)11 b(for)h(a)g(comm)o(unicator)e(that)i
(has)h(not)f(y)o(et)h(b)q(een)g(created)h(at)e(the)h(receiving)g(pro)q
(cess.)249 1414 y(When)j(a)f(comm)o(unicator)e(is)j(duplicated,)g(one)g
(need)g(not)g(actually)f(cop)o(y)g(the)i(group)e(infor-)249
1468 y(mation,)d(but)j(only)f(add)h(a)f(new)h(reference)j(and)c
(incremen)o(t)h(the)g(reference)i(coun)o(t.)k(\()p FB(End)c(of)249
1522 y(advic)n(e)e(to)g(implementors.)p FA(\))249 1682
y Fw(MPI)p 326 1682 V 14 w(COMM)p 470 1682 V 15 w(CREA)m(TE\(comm,)10
b(group,)k(new)o(comm\))332 1757 y Fv(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)332 1805 y(IN)158 b Fw(group)448
b Fv(Group,)12 b(whic)o(h)g(is)g(a)f(subset)h(of)f(the)g(group)i(of)
1079 1859 y Fq(comm)332 1906 y Fv(OUT)114 b Fw(new)o(comm)373
b Fv(new)13 b(comm)o(unicator)249 2016 y Fr(int)21 b(MPI)p
405 2016 14 2 v 15 w(Comm)p 508 2016 V 15 w(create\(MPI)p
743 2016 V 14 w(Comm)g(comm,)g(MPI)p 1063 2016 V 15 w(Group)f(group,)
540 2070 y(MPI)p 609 2070 V 15 w(Comm)h(*newcomm\))249
2154 y(MPI)p 318 2154 V 15 w(COMM)p 421 2154 V 15 w(CREATE\(COMM,)e
(GROUP,)i(NEWCOMM,)f(IERROR\))336 2208 y(INTEGER)h(COMM,)f(GROUP,)h
(NEWCOMM,)f(IERROR)249 2292 y FA(This)i(function)g(creates)h(a)f(new)g
(in)o(tracomm)o(unicator)d Fw(new)o(comm)i FA(with)h(comm)o(unicatio)o
(n)249 2346 y(group)16 b(de\014ned)i(b)o(y)e Fw(group)p
FA(.)26 b(No)17 b(attributes)g(propagates)g(from)d Fw(comm)h
FA(to)h Fw(new)o(comm)p FA(.)25 b(The)249 2400 y(function)13
b(returns)i Fq(MPI)p 626 2400 12 2 v 12 w(COMM)p 759
2400 V 13 w(NULL)f FA(to)f(pro)q(cesses)j(that)d(are)h(not)f(in)f
Fw(group)p FA(.)19 b(The)13 b(comm)o(u-)249 2454 y(nicators)f(returned)
h(at)e(the)h(pro)q(cesses)i(in)d Fw(group)h FA(de\014ne)g(a)f(new)h(in)
o(tra-group)f(comm)o(unicatio)o(n)249 2508 y(domain.)p
eop
%%Page: 221 235
221 234 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(221)291
507 y FA(The)13 b(call)g(is)g(erroneous)i(if)d(not)i(all)e
Fw(group)i FA(argumen)o(ts)e(ha)o(v)o(e)h(the)h(same)f(v)n(alue)f(on)h
(di\013eren)o(t)249 561 y(pro)q(cesses,)21 b(or)c(if)g
Fw(group)h FA(is)g(not)f(a)h(subset)h(of)e(the)h(group)f(asso)q(ciated)
i(with)e Fw(comm)f FA(\(but)i(it)249 615 y(do)q(es)f(not)e(ha)o(v)o(e)h
(to)g(b)q(e)g(a)g(prop)q(er)g(subset\).)26 b(Note)16
b(that)g(the)g(call)f(is)h(to)g(b)q(e)g(executed)i(b)o(y)e(all)249
669 y(pro)q(cesses)h(in)c Fw(comm)p FA(,)f(ev)o(en)i(if)f(they)i(do)e
(not)h(b)q(elong)g(to)f(the)i(new)f(group.)249 760 y
FB(R)n(ationale.)38 b FA(The)15 b(requiremen)o(t)f(that)g(the)g(en)o
(tire)h(group)f(of)g Fw(comm)e FA(participate)i(in)g(the)g(call)249
814 y(stems)g(from)e(the)i(follo)o(wing)e(considerations:)291
885 y Ft(\017)28 b FA(It)15 b(allo)o(ws)e(the)i(implemen)o(tation)c(to)
k(la)o(y)o(er)f Fw(MPI)p 1109 885 13 2 v 14 w(COMM)p
1253 885 V 15 w(CREA)m(TE)f FA(on)h(top)g(of)g(regular)291
939 y(collectiv)o(e)f(comm)o(unications.)291 1010 y Ft(\017)28
b FA(It)14 b(pro)o(vides)f(additional)e(safet)o(y)m(,)i(in)f
(particular)h(in)g(the)g(case)h(where)h(partially)c(o)o(v)o(erlap-)291
1064 y(ping)i(groups)h(are)g(used)h(to)f(create)h(new)f(comm)o
(unicators.)291 1134 y Ft(\017)28 b FA(It)14 b(p)q(ermits)f(implemen)o
(tatio)o(ns)e(sometimes)h(to)h(a)o(v)o(oid)f(comm)o(unication)e
(related)k(to)g(the)291 1188 y(creation)g(of)f(comm)o(unicators.)249
1259 y(\()p FB(End)j(of)f(r)n(ationale.)p FA(\))249 1350
y FB(A)n(dvic)n(e)k(to)h(users.)65 b Fw(MPI)p 689 1350
V 14 w(COMM)p 833 1350 V 15 w(CREA)m(TE)17 b FA(pro)o(vides)i(a)f
(means)g(to)h(subset)h(a)e(group)h(of)249 1404 y(pro)q(cesses)c(for)d
(the)h(purp)q(ose)h(of)e(separate)i(MIMD)e(computation,)e(with)i(a)h
(separate)g(comm)o(u-)249 1458 y(nication)i(space.)24
b Fw(new)o(comm)p FA(,)15 b(whic)o(h)h(emerges)g(from)d
Fw(MPI)p 1198 1458 V 15 w(COMM)p 1343 1458 V 14 w(CREA)m(TE)h
FA(can)i(b)q(e)h(used)249 1512 y(in)d(subsequen)o(t)i(calls)d(to)h
Fw(MPI)p 731 1512 V 15 w(COMM)p 876 1512 V 14 w(CREA)m(TE)f
FA(\(or)h(other)h(comm)o(unicator)c(constructors\))249
1566 y(further)i(to)e(sub)q(divide)h(a)f(computation)f(in)o(to)h
(parallel)g(sub-computations.)16 b(A)c(more)e(general)249
1620 y(service)15 b(is)f(pro)o(vided)g(b)o(y)f Fw(MPI)p
731 1620 V 15 w(COMM)p 876 1620 V 14 w(SPLIT)p FA(,)h(b)q(elo)o(w.)j
(\()p FB(End)f(of)f(advic)n(e)g(to)g(users.)p FA(\))249
1782 y Fw(MPI)p 326 1782 V 14 w(COMM)p 470 1782 V 15
w(SPLIT\(comm,)d(colo)o(r,)h(k)o(ey)m(,)g(new)o(comm\))332
1857 y Fv(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)332
1906 y(IN)158 b Fw(colo)o(r)463 b Fv(con)o(trol)14 b(of)f(subset)h
(assignmen)o(t)332 1956 y(IN)158 b Fw(k)o(ey)490 b Fv(con)o(trol)14
b(of)f(rank)h(assignmen)o(t)332 2006 y(OUT)114 b Fw(new)o(comm)373
b Fv(new)13 b(comm)o(unicator)249 2116 y Fr(int)21 b(MPI)p
405 2116 14 2 v 15 w(Comm)p 508 2116 V 15 w(split\(MPI)p
721 2116 V 14 w(Comm)g(comm,)g(int)g(color,)f(int)i(key,)540
2170 y(MPI)p 609 2170 V 15 w(Comm)f(*newcomm\))249 2254
y(MPI)p 318 2254 V 15 w(COMM)p 421 2254 V 15 w(SPLIT\(COMM,)f(COLOR,)g
(KEY,)h(NEWCOMM,)f(IERROR\))336 2308 y(INTEGER)h(COMM,)f(COLOR,)h(KEY,)
g(NEWCOMM,)f(IERROR)249 2392 y FA(This)c(function)g(partitions)f(the)i
(group)f(asso)q(ciated)g(with)g Fw(comm)e FA(in)o(to)h(disjoin)o(t)g
(subgroups,)249 2446 y(one)e(for)g(eac)o(h)h(v)n(alue)e(of)g
Fw(colo)o(r)p FA(.)18 b(Eac)o(h)13 b(subgroup)h(con)o(tains)f(all)e
(pro)q(cesses)16 b(of)c(the)i(same)e(color.)249 2500
y(Within)i(eac)o(h)i(subgroup,)f(the)h(pro)q(cesses)i(are)d(rank)o(ed)h
(in)e(the)i(order)g(de\014ned)g(b)o(y)f(the)h(v)n(alue)p
eop
%%Page: 222 236
222 235 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(222)1256 b(Chapter)13 b(5)249
507 y FA(of)18 b(the)h(argumen)o(t)e Fw(k)o(ey)p FA(,)j(with)e(ties)g
(brok)o(en)h(according)f(to)h(their)f(rank)h(in)e(the)i(old)f(group.)
249 561 y(A)g(new)f(comm)o(unication)d(domain)h(is)j(created)g(for)f
(eac)o(h)h(subgroup)g(and)f(a)g(handle)h(to)f(the)249
615 y(represen)o(tativ)o(e)h(comm)o(unicator)13 b(is)j(returned)i(in)d
Fw(new)o(comm)p FA(.)24 b(A)16 b(pro)q(cess)i(ma)o(y)c(supply)i(the)249
669 y(color)d(v)n(alue)g Fw(MPI)p 534 669 13 2 v 14 w(UNDEFINED)g
FA(to)g(not)g(b)q(e)i(a)e(mem)o(b)q(er)e(of)i(an)o(y)g(new)h(group,)f
(in)g(whic)o(h)g(case)249 723 y Fw(new)o(comm)k FA(returns)j
Fq(MPI)p 659 723 12 2 v 13 w(COMM)p 793 723 V 12 w(NULL)p
FA(.)e(This)g(is)g(a)g(collectiv)o(e)g(call,)g(but)g(eac)o(h)h(pro)q
(cess)h(is)249 777 y(p)q(ermitted)14 b(to)g(pro)o(vide)f(di\013eren)o
(t)i(v)n(alues)f(for)g Fw(colo)o(r)f FA(and)h Fw(k)o(ey)p
FA(.)19 b(The)c(v)n(alue)e(of)g(color)h(m)o(ust)f(b)q(e)249
831 y(nonnegativ)o(e.)249 908 y Fs(Example)i(5.7)21 b
FA(Assume)13 b(that)f(a)h(collectiv)o(e)f(call)g(to)h
Fw(MPI)p 1183 908 13 2 v 14 w(COMM)p 1327 908 V 15 w(SPLIT)f
FA(is)h(executed)h(in)f(a)249 962 y(10)g(elemen)o(t)h(group,)f(with)h
(the)g(argumen)o(ts)f(listed)h(in)g(the)g(table)g(b)q(elo)o(w.)p
291 1006 915 2 v 290 1060 2 54 v 315 1044 a(rank)p 470
1060 V 99 w(0)56 b(1)f(2)c(3)f(4)g(5)f(6)i(7)g(8)k(9)p
1204 1060 V 291 1062 915 2 v 290 1116 2 54 v 315 1100
a(pro)q(cess)p 470 1116 V 52 w(a)f(b)i(c)51 b(d)g(e)56
b(f)d(g)d(h)k(i)64 b(j)p 1204 1116 V 291 1118 915 2 v
290 1171 2 54 v 315 1155 a(color)p 470 1171 V 93 w(0)50
b Ft(?)f FA(3)i(0)f(3)g(0)f(0)i(5)g(3)e Ft(?)p 1204 1171
V 291 1173 915 2 v 290 1227 2 54 v 315 1211 a FA(k)o(ey)p
470 1227 V 120 w(3)56 b(1)f(2)c(5)f(1)g(1)f(1)i(2)g(1)k(0)p
1204 1227 V 291 1229 915 2 v 291 1292 a(The)22 b(call)g(generates)i
(three)f(new)g(comm)o(unication)c(domains:)33 b(the)23
b(\014rst)g(with)f(group)249 1346 y Ft(f)p Fw(f,g,a,d)p
Ft(g)p FA(,)16 b(the)i(second)h(with)e(group)g Ft(f)p
Fw(e,i,c)p Ft(g)p FA(,)g(and)h(the)g(third)f(with)h(singleton)f(group)g
Ft(f)p Fw(h)p Ft(g)p FA(.)249 1400 y(The)f(pro)q(cesses)i
Fw(b)d FA(and)g Fw(j)h FA(do)f(not)g(participate)g(in)g(an)o(y)g(of)g
(the)h(newly)f(created)i(comm)o(uni)o(ca-)249 1454 y(tion)c(domains,)f
(and)i(are)g(returned)h(a)f(n)o(ull)f(comm)o(unicator)e(handle.)291
1531 y(A)17 b(call)f(to)h Fw(MPI)p 549 1531 13 2 v 14
w(COMM)p 693 1531 V 15 w(CREA)m(TE\(comm)o(,)e(group,)i(new)o(comm\))g
FA(is)f(equiv)n(alen)o(t)h(to)g(a)f(call)249 1585 y(to)j
Fw(MPI)p 382 1585 V 14 w(COMM)p 526 1585 V 15 w(SPLIT\(comm,)f(colo)o
(r,)i(k)o(ey)m(,)g(new)o(comm\))p FA(,)f(where)h(all)e(mem)o(b)q(ers)f
(of)i Fw(group)249 1639 y FA(pro)o(vide)12 b Fw(colo)o(r)f
FA(=)24 b(0)12 b(and)f Fw(k)o(ey)i FA(=)24 b(rank)11
b(in)h Fw(group)p FA(,)g(and)g(all)e(pro)q(cesses)15
b(that)d(are)g(not)g(mem)o(b)q(ers)249 1693 y(of)e Fw(group)h
FA(pro)o(vide)f Fw(colo)o(r)h FA(=)21 b Fw(MPI)p 770
1693 V 14 w(UNDEFINED)p FA(.)9 b(The)i(function)f Fw(MPI)p
1354 1693 V 15 w(COMM)p 1499 1693 V 14 w(SPLIT)h FA(allo)o(ws)249
1747 y(more)18 b(general)i(partitioning)e(of)h(a)g(group)g(in)o(to)g
(one)g(or)g(more)g(subgroups)h(with)f(optional)249 1801
y(reordering.)249 1889 y FB(A)n(dvic)n(e)e(to)g(users.)51
b FA(This)17 b(is)f(an)g(extremely)g(p)q(o)o(w)o(erful)g(mec)o(hanism)e
(for)i(dividing)f(a)h(single)249 1942 y(comm)o(unicating)8
b(group)j(of)f(pro)q(cesses)k(in)o(to)c Fp(k)i FA(subgroups,)g(with)e
Fp(k)i FA(c)o(hosen)g(implicitly)c(b)o(y)j(the)249 1996
y(user)k(\(b)o(y)e(the)h(n)o(um)o(b)q(er)e(of)h(colors)g(asserted)j(o)o
(v)o(er)d(all)f(the)i(pro)q(cesses\).)21 b(Eac)o(h)13
b(resulting)h(com-)249 2050 y(m)o(unication)c(domain)f(will)h(b)q(e)j
(unique)f(and)f(their)i(asso)q(ciated)f(groups)g(are)g(non-o)o(v)o
(erlapping.)249 2104 y(Suc)o(h)17 b(a)f(division)g(could)g(b)q(e)h
(useful)g(for)f(de\014ning)g(a)h(hierarc)o(h)o(y)g(of)f(computations,)f
(suc)o(h)i(as)249 2158 y(for)d(m)o(ultigrid,)c(or)k(linear)g(algebra.)
249 2225 y(Multiple)e(calls)g(to)h Fw(MPI)p 633 2225
V 14 w(COMM)p 777 2225 V 15 w(SPLIT)f FA(can)h(b)q(e)g(used)h(to)f(o)o
(v)o(ercome)e(the)j(requiremen)o(t)e(that)249 2279 y(an)o(y)f(call)g
(ha)o(v)o(e)h(no)f(o)o(v)o(erlap)g(of)g(the)h(resulting)g(comm)o
(unicators)d(\(eac)o(h)j(pro)q(cess)i(is)d(of)g(only)g(one)249
2333 y(color)j(p)q(er)g(call\).)k(In)13 b(this)h(w)o(a)o(y)m(,)e(m)o
(ultiple)g(o)o(v)o(erlapping)g(comm)o(unication)f(structures)16
b(can)e(b)q(e)249 2387 y(created.)249 2454 y(Note)f(that,)f(for)g(a)g
(\014xed)h(color,)f(the)g(k)o(eys)h(need)h(not)e(b)q(e)h(unique.)k(It)c
(is)f Fw(MPI)p 1447 2454 V 14 w(COMM)p 1591 2454 V 15
w(SPLIT)p FA('s)249 2508 y(resp)q(onsibilit)o(y)18 b(to)h(sort)g(pro)q
(cesses)j(in)c(ascending)h(order)h(according)e(to)h(this)g(k)o(ey)m(,)g
(and)g(to)p eop
%%Page: 223 237
223 236 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(223)249
507 y FA(break)15 b(ties)g(according)g(to)f(old)g(rank.)20
b(If)14 b(all)f(the)i(k)o(eys)g(are)g(sp)q(eci\014ed)h(with)f(the)g
(same)f(v)n(alue,)249 561 y(then)e(all)f(the)h(pro)q(cesses)j(in)c(a)h
(giv)o(en)f(color)g(will)g(ha)o(v)o(e)g(the)h(same)f(relativ)o(e)h
(rank)g(order)g(as)g(they)249 615 y(did)i(in)f(their)h(paren)o(t)h
(group.)j(\()p FB(End)d(of)g(advic)n(e)g(to)g(users.)p
FA(\))249 707 y Fs(5.4.3)48 b(Comm)o(unicator)13 b(Destructor)208
860 y Fw(MPI)p 285 860 13 2 v 14 w(COMM)p 429 860 V 15
w(FREE\(comm\))332 935 y Fv(INOUT)71 b Fw(comm)439 b
Fv(comm)o(unicator)15 b(to)e(b)q(e)g(destro)o(y)o(ed)249
1045 y Fr(int)21 b(MPI)p 405 1045 14 2 v 15 w(Comm)p
508 1045 V 15 w(free\(MPI)p 699 1045 V 14 w(Comm)g(*comm\))249
1129 y(MPI)p 318 1129 V 15 w(COMM)p 421 1129 V 15 w(FREE\(COMM,)f
(IERROR\))336 1183 y(INTEGER)h(COMM,)f(IERROR)291 1267
y FA(This)13 b(collectiv)o(e)h(op)q(eration)g(marks)e(the)j(comm)o
(unicatio)o(n)c(ob)r(ject)k(for)e(deallo)q(cation.)k(The)249
1321 y(handle)g(is)f(set)i(to)e Fq(MPI)p 623 1321 12
2 v 13 w(COMM)p 757 1321 V 13 w(NULL)p FA(.)g(An)o(y)h(p)q(ending)g(op)
q(erations)f(that)h(use)h(this)e(comm)o(u-)249 1375 y(nicator)f(will)e
(complete)h(normally;)d(the)16 b(ob)r(ject)f(is)f(actually)g(deallo)q
(cated)h(only)e(if)h(there)i(are)249 1429 y(no)c(other)h(activ)o(e)g
(references)i(to)e(it.)k(This)12 b(call)g(applies)g(to)h(in)o(tra-)f
(and)g(in)o(tercomm)o(unicators.)249 1483 y(The)k(delete)g(callbac)o(k)
f(functions)h(for)f(all)f(cac)o(hed)i(attributes)h(\(see)f(Section)g
(5.6\))f(are)h(called)249 1537 y(in)d(arbitrary)h(order.)19
b(It)14 b(is)g(erroneous)h(to)f(attempt)f(to)h(free)g
Fw(MPI)p 1290 1537 13 2 v 15 w(COMM)p 1435 1537 V 14
w(NULL)p FA(.)249 1628 y FB(A)n(dvic)n(e)d(to)f(implementors.)33
b FA(Though)9 b(collectiv)o(e,)h(it)f(is)g(an)o(ticipated)g(that)g
(this)h(op)q(eration)f(will)249 1682 y(normally)14 b(b)q(e)k(implem)o
(en)o(ted)d(with)i(no)f(comm)o(unication,)e(though)j(the)g(debugging)f
(v)o(ersion)249 1736 y(of)d(an)h Fw(MPI)f FA(library)g(migh)o(t)f(c)o
(ho)q(ose)j(to)f(sync)o(hronize.)19 b(\()p FB(End)c(of)g(advic)n(e)g
(to)g(implementors.)p FA(\))249 1828 y FB(A)n(dvic)n(e)c(to)h(users.)33
b FA(Aliasing)9 b(of)g(comm)o(unicators)f(\(e.g.,)i Fw(comma)e(=)i
(commb)p FA(\))f(is)h(p)q(ossible,)g(but)249 1882 y(is)h(not)g
(generally)g(advised.)17 b(After)12 b(calling)e Fw(MPI)p
1009 1882 V 14 w(COMM)p 1153 1882 V 15 w(FREE)g FA(an)o(y)h(aliased)f
(comm)o(unicator)249 1936 y(handle)k(will)e(b)q(e)j(left)e(in)h(an)f
(unde\014ned)j(state.)i(\()p FB(End)e(of)f(advic)n(e)g(to)g(users.)p
FA(\))249 2056 y FD(5.5)52 b(Safe)18 b(P)o(arallel)h(Libraries)249
2164 y FA(This)10 b(section)i(illustrates)e(the)h(design)g(of)f
(parallel)f(libraries,)h(and)h(the)g(use)g(of)f(comm)o(unicators)249
2218 y(to)k(ensure)h(the)g(safet)o(y)f(of)f(in)o(ternal)h(library)f
(comm)o(unicati)o(ons.)291 2272 y(Assume)g(that)h(a)g(new)g(parallel)f
(library)g(function)g(is)h(needed)h(that)f(is)g(similar)d(to)j(the)g
Fw(MPI)249 2326 y FA(broadcast)e(function,)e(except)j(that)e(it)f(is)h
(not)g(required)h(that)f(all)f(pro)q(cesses)j(pro)o(vide)e(the)g(rank)
249 2380 y(of)f(the)i(ro)q(ot)f(pro)q(cess.)19 b(Instead)12
b(of)e(the)i(ro)q(ot)f(argumen)o(t)e(of)i Fw(MPI)p 1255
2380 V 14 w(BCAST)p FA(,)f(the)h(function)g(tak)o(es)249
2434 y(a)j(Bo)q(olean)h(\015ag)f(input)h(that)f(is)h
Fw(true)h FA(if)d(the)j(calling)d(pro)q(cess)j(is)f(the)g(ro)q(ot,)g
Fw(false)p FA(,)f(otherwise.)249 2488 y(T)m(o)h(simplify)d(the)k
(example)f(w)o(e)g(mak)o(e)f(another)i(assumption:)k(namely)14
b(that)h(the)h(datat)o(yp)q(e)p eop
%%Page: 224 238
224 237 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(224)1256 b(Chapter)13 b(5)249
507 y FA(of)k(the)h(send)g(bu\013er)g(is)g(iden)o(tical)e(to)i(the)g
(datat)o(yp)q(e)f(of)g(the)h(receiv)o(e)h(bu\013er,)f(so)g(that)f(only)
249 561 y(one)f(datat)o(yp)q(e)g(argumen)o(t)f(is)h(needed.)26
b(A)16 b(p)q(ossible)g(co)q(de)g(for)g(suc)o(h)h(a)e(mo)q(di\014ed)g
(broadcast)249 615 y(function)f(is)f(sho)o(wn)h(b)q(elo)o(w.)249
711 y Fs(Example)h(5.8)21 b FA(Co)q(de)11 b(for)g(mo)q(di\014ed)e
(broadcast)j(function)e Fw(mcast\(\))p FA(.)17 b(The)11
b(algorithm)e(uses)j(a)249 765 y(broadcast)g(tree)h(that)f(is)f(built)g
(dynamically)m(.)j(The)e(ro)q(ot)g(divides)g(the)g(sequence)i(of)d(pro)
q(cesses)249 819 y(that)18 b(follo)o(ws)e(the)j(ro)q(ot)e(in)o(to)h(t)o
(w)o(o)f(segmen)o(ts.)30 b(It)18 b(sends)h(a)e(message)h(to)g(the)g
(\014rst)h(pro)q(cess)249 873 y(in)d(the)i(second)g(segmen)o(t,)f(whic)
o(h)f(b)q(ecomes)h(the)h(ro)q(ot)f(for)f(this)h(segmen)o(t.)27
b(The)17 b(pro)q(cess)i(is)249 927 y(rep)q(eated,)c(recursiv)o(ely)m(,)
f(within)f(eac)o(h)i(subsegmen)o(t.)291 981 y(In)9 b(this)g(example,)g
(w)o(e)g(use)h(blo)q(c)o(king)f(comm)o(unicatio)o(n.)14
b(Also,)9 b(w)o(e)h(select)h(the)f(t)o(w)o(o)e(segmen)o(ts)249
1034 y(to)16 b(b)q(e)i(of)d(equal)i(size;)h(p)q(erformance)e(can)h(b)q
(e)g(impro)o(v)o(ed)e(b)o(y)h(using)g(a)h(biased)f(tree,)i(and)f(b)o(y)
249 1088 y(using)d(non)o(blo)q(c)o(king)e(comm)o(unication.)249
1250 y Fr(void)21 b(mcast\()g(void)g(*buff,)173 b(/*)21
b(address)f(of)i(output)e(buffer)h(at)65 b(*/)925 1304
y(/*)21 b(root;)g(address)f(of)i(input)e(buffer)h(*/)925
1358 y(/*)g(at)g(other)g(processes.)238 b(*/)511 1412
y(int)21 b(count,)195 b(/*)21 b(number)g(of)g(items)g(to)g(broadcast)42
b(*/)511 1466 y(MPI_Datatype)19 b(type,)i(/*)g(types)g(of)g(items)g(to)
g(broadcast)64 b(*/)511 1520 y(int)21 b(isroot,)173 b(/*)21
b(=1)g(if)h(calling)e(process)g(is)i(root)f(*/)925 1574
y(/*)g(=0,)g(otherwise)369 b(*/)511 1628 y(MPI_Comm)20
b(comm\))108 b(/*)21 b(communicator)e(for)j(broadcast)85
b(*/)249 1736 y({)249 1790 y(int)21 b(size,)174 b(/*)21
b(group)g(size)740 b(*/)336 1844 y(rank,)174 b(/*)21
b(rank)g(in)g(group)675 b(*/)336 1898 y(numleaves,)64
b(/*)21 b(number)f(of)i(leaves)e(in)i(broadcast)e(tree)217
b(*/)336 1952 y(child,)152 b(/*)21 b(rank)g(of)g(current)g(child)f(in)i
(broadcast)e(tree)108 b(*/)336 2006 y(childleaves;)20
b(/*)h(number)f(of)i(leaves)e(in)i(child's)e(broadcast)g(tree)43
b(*/)249 2060 y(MPI_Status)20 b(status;)249 2168 y(MPI_Comm_size\(comm)
o(,)f(&size\);)249 2222 y(MPI_Comm_rank\(comm)o(,)g(&rank\);)249
2330 y(if)i(\(isroot\))g({)314 2384 y(numleaves)f(=)i(size-1;)314
2438 y(})249 2492 y(else)f({)p eop
%%Page: 225 239
225 238 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(225)358
507 y Fr(/*)21 b(receive)g(from)g(parent)f(leaf)h(count)g(and)g
(message)g(*/)314 561 y(MPI_Recv\(&numleaves,)d(1,)j(MPI_INT,)g
(MPI_ANY_SOURCE,)d(0,)k(comm,)e(&status\);)314 615 y(MPI_Recv\(buff,)f
(count,)i(type,)g(MPI_ANY_SOURCE,)d(0,)k(comm,)e(&status\);)314
669 y(})249 723 y(while)h(\(numleaves)f(>)h(0\))h({)336
777 y(/*)g(pick)f(child)f(in)i(middle)e(of)i(current)e(leaf)h
(processes)f(*/)314 831 y(child)h(=)h(\(rank)f(+)g
(\(numleaves+1\)/2\)\045s)o(ize;)314 885 y(childleaves)f(=)i
(numleaves/2;)314 939 y(/*)g(send)f(to)g(child)g(leaf)g(count)g(and)g
(message)f(*/)314 993 y(MPI_Send\(&childleave)o(s,)f(1,)i(MPI_INT,)f
(child,)h(0,)g(comm\);)314 1047 y(MPI_Send\(buff,)e(count,)i(type,)g
(child,)f(0,)i(comm\);)314 1101 y(/*)g(compute)e(remaining)g(number)h
(of)g(leaves)g(*/)314 1155 y(numleaves)f(-=)i(\(childleaves+1\);)314
1209 y(})249 1263 y(})291 1408 y FA(Consider)c(a)g(collectiv)o(e)g(in)o
(v)o(o)q(cation)f(to)h(the)h(broadcast)f(function)g(just)g(de\014ned,)i
(in)e(the)249 1462 y(con)o(text)d(of)f(the)h(program)e(segmen)o(t)h
(sho)o(wn)h(in)f(the)h(example)e(b)q(elo)o(w,)h(for)g(a)g(group)g(of)g
(three)249 1516 y(pro)q(cesses.)249 1607 y Fs(Example)h(5.9)21
b FA(Before)16 b(the)g(collectiv)o(e)f(in)o(v)o(o)q(cation)g(to)g
Fw(mcast\(\))p FA(,)f(pro)q(cess)k(2)d(sends)h(a)f(mes-)249
1661 y(sage)c(to)g(pro)q(cess)h(1;)f(pro)q(cess)i(1)d(p)q(osts)i(a)e
(receiv)o(e)i(with)f(a)f(don)o(tcare)i(source.)18 b Fw(mcast)10
b FA(is)h(in)o(v)o(ok)o(ed,)249 1715 y(with)j(pro)q(cess)h(0)f(as)g
(the)g(ro)q(ot.)249 1823 y Fr(...)249 1877 y(MPI_Comm_rank\(comm)o(,)19
b(&myrank\);)249 1931 y(if)i(\(myrank)g(==)g(2\))314
1985 y(MPI_Send\(&i,)f(1,)h(MPI_INT,)f(1,)i(0,)f(comm\);)249
2039 y(else)g(if)g(\(myrank)g(==)g(1\))314 2093 y(MPI_Recv\(&i,)f(1,)h
(MPI_INT,)f(MPI_ANY_SOURCE,)f(0,)i(comm,)g(&status\);)249
2201 y(mcast\(&i,)f(1,)h(MPI_INT,)g(\(myrank)f(==0\),)h(comm\);)249
2255 y(...)291 2346 y FA(A)15 b(\(correct\))j(execution)e(of)f(this)g
(co)q(de)h(is)g(illustrated)f(in)g(Figure)g(5.2,)g(with)g(arro)o(ws)h
(used)249 2400 y(to)e(indicate)g(comm)o(unicati)o(ons.)291
2454 y(Since)h(the)g(in)o(v)o(o)q(cation)e(of)h Fw(mcast)f
FA(at)i(the)g(three)h(pro)q(cesses)h(is)d(not)h(sim)o(ultaneous,)d(it)i
(ma)o(y)249 2508 y(actually)h(happ)q(en)i(that)f Fw(mcast)f
FA(is)h(in)o(v)o(ok)o(ed)f(at)h(pro)q(cess)i(0)e(b)q(efore)g(pro)q
(cess)i(1)e(executed)i(the)p eop
%%Page: 226 240
226 239 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(226)1256 b(Chapter)13 b(5)478
466 y
 16577003 6962340 0 0 31969935 13682606 startTexFig
 478 466 a
%%BeginDocument: ../figures/context-lib1good.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-27.0 229.0 translate 0.900 -0.900 scale
2.000 setlinewidth
% Polyline
n 151 69 m 139 69 139 102 12 arcto 4 {pop} repeat 139 114 557 114 12 arcto 4 {pop} repeat 569 114 569 81 12 arcto 4 {pop} repeat 569 69 151 69 12 arcto 4 {pop} repeat clp gs col-1 s gr
	1 setlinecap [1 6.000000] 6.000000 setdash
% Polyline
n 151 129 m 139 129 139 242 12 arcto 4 {pop} repeat 139 254 557 254 12 arcto 4 {pop} repeat 569 254 569 141 12 arcto 4 {pop} repeat 569 129 151 129 12 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
1.000 setlinewidth
% Polyline
n 469 94 m 374 94 l gs col-1 s gr
n 390.000 98.000 m 374.000 94.000 l 390.000 90.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 214 154 m 314 154 l gs col-1 s gr
n 298.000 150.000 m 314.000 154.000 l 298.000 158.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 214 179 m 314 179 l gs col-1 s gr
n 298.000 175.000 m 314.000 179.000 l 298.000 183.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 374 204 m 474 204 l gs col-1 s gr
n 458.000 200.000 m 474.000 204.000 l 458.000 208.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 374 229 m 474 229 l gs col-1 s gr
n 458.000 225.000 m 474.000 229.000 l 458.000 233.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
159 44 m 
gs 1 -1 scale (Process 0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 44 m 
gs 1 -1 scale (Process 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 44 m 
gs 1 -1 scale (Process 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 99 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 99 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 159 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 184 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 209 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 234 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 159 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 184 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 214 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 239 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
29 199 m 
gs 1 -1 scale (Callee code) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
34 104 m 
gs 1 -1 scale (Caller code) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 969 a Fo(Figure)g(5.2)249 1006 y Fz(Correct)e(in)o(v)o(o)q(cation)
d(of)j Fw(mcast)478 1056 y
 16577003 6962340 0 0 31969935 13682606 startTexFig
 478 1056 a
%%BeginDocument: ../figures/context-lib1bad.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-27.0 229.0 translate 0.900 -0.900 scale
2.000 setlinewidth
% Polyline
n 151 69 m 139 69 139 102 12 arcto 4 {pop} repeat 139 114 557 114 12 arcto 4 {pop} repeat 569 114 569 81 12 arcto 4 {pop} repeat 569 69 151 69 12 arcto 4 {pop} repeat clp gs col-1 s gr
	1 setlinecap [1 6.000000] 6.000000 setdash
% Polyline
n 151 129 m 139 129 139 242 12 arcto 4 {pop} repeat 139 254 557 254 12 arcto 4 {pop} repeat 569 254 569 141 12 arcto 4 {pop} repeat 569 129 151 129 12 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
1.000 setlinewidth
% Polyline
n 209 149 m 314 94 l gs col-1 s gr
n 297.971 97.881 m 314.000 94.000 l 301.683 104.967 l gs 2 setlinejoin col-1 s gr
% Polyline
n 474 94 m 374 149 l gs col-1 s gr
n 389.947 144.794 m 374.000 149.000 l 386.092 137.784 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
159 44 m 
gs 1 -1 scale (Process 0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 44 m 
gs 1 -1 scale (Process 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 44 m 
gs 1 -1 scale (Process 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 99 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 99 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 159 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 184 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 209 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 234 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 159 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 184 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 214 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 239 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
29 199 m 
gs 1 -1 scale (Callee code) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
34 104 m 
gs 1 -1 scale (Caller code) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1559 a Fo(Figure)i(5.3)249 1596 y Fz(Erroneous)c(in)o(v)o(o)q
(cation)g(of)i Fw(mcast)249 1712 y FA(receiv)o(e)18 b(in)f(the)g
(caller)g(co)q(de.)28 b(This)17 b(receiv)o(e,)h(rather)g(than)f(b)q
(eing)g(matc)o(hed)f(b)o(y)h(the)g(caller)249 1766 y(co)q(de)i(send)h
(at)e(pro)q(cess)i(2,)f(migh)o(t)d(b)q(e)j(matc)o(hed)f(b)o(y)g(the)h
(\014rst)g(send)g(of)f(pro)q(cess)i(0)e(within)249 1820
y Fw(mcast)p FA(.)f(The)e(erroneous)g(execution)g(illustrated)e(in)h
(Figure)g(5.3)f(results.)291 1874 y(Ho)o(w)h(can)i(suc)o(h)g(erroneous)
g(execution)g(b)q(e)g(prev)o(en)o(ted?)24 b(One)16 b(option)e(is)h(to)g
(enforce)h(syn-)249 1928 y(c)o(hronization)h(at)g(the)h(en)o(try)f(to)g
Fw(mcast)p FA(,)g(and,)h(for)e(symmetric)g(reasons,)i(at)f(the)h(exit)f
(from)249 1982 y Fw(mcast)p FA(.)f(E.g.,)11 b(the)h(\014rst)g(and)f
(last)g(executable)h(statemen)o(ts)g(within)e(the)i(co)q(de)g(of)f
Fw(mcast)f FA(w)o(ould)249 2036 y(b)q(e)i(a)f(call)f(to)h
Fw(MPI)p 533 2036 13 2 v 14 w(Ba)o(rrier\(comm\))p FA(.)16
b(This,)11 b(ho)o(w)o(ev)o(er,)g(in)o(tro)q(duces)i(t)o(w)o(o)d(sup)q
(er\015uous)j(sync)o(hro-)249 2090 y(nizations)i(that)g(will)e(slo)o(w)
i(do)o(wn)f(execution.)23 b(F)m(urthermore,)14 b(this)h(sync)o
(hronization)g(w)o(orks)249 2144 y(only)f(if)g(the)i(caller)f(co)q(de)h
(ob)q(eys)g(the)f(con)o(v)o(en)o(tion)g(that)g(messages)g(sen)o(t)h(b)q
(efore)g(a)e(collectiv)o(e)249 2198 y(in)o(v)o(o)q(cation)i(should)g
(also)g(b)q(e)i(receiv)o(ed)g(at)f(their)g(destination)g(b)q(efore)g
(the)h(matc)o(hing)d(in)o(v)o(o-)249 2252 y(cation.)31
b(Consider)19 b(an)g(in)o(v)o(o)q(cation)e(to)h Fw(mcast\(\))g
FA(in)g(a)g(con)o(text)h(that)g(do)q(es)g(not)g(ob)q(ey)f(this)249
2306 y(restriction,)c(as)g(sho)o(wn)g(in)g(the)g(example)f(b)q(elo)o
(w.)249 2400 y Fs(Example)i(5.10)21 b FA(Before)14 b(the)f(collectiv)o
(e)g(in)o(v)o(o)q(cation)f(to)h Fw(mcast\(\))p FA(,)f(pro)q(cess)j(2)d
(sends)j(a)d(mes-)249 2454 y(sage)j(to)g(pro)q(cess)h(1;)f(pro)q(cess)i
(1)d(p)q(osts)i(a)e(matc)o(hing)f(receiv)o(e)j(with)f(a)f(don)o(tcare)i
(source)g(after)249 2508 y(the)f(in)o(v)o(o)q(cation)d(to)i
Fw(mcast)p FA(.)p eop
%%Page: 227 241
227 240 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(227)478
466 y
 16577003 8785810 0 0 31969935 17234821 startTexFig
 478 466 a
%%BeginDocument: ../figures/context-lib2good.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-27.0 283.0 translate 0.900 -0.900 scale
2.000 setlinewidth
% Polyline
n 151 69 m 139 69 139 102 12 arcto 4 {pop} repeat 139 114 557 114 12 arcto 4 {pop} repeat 569 114 569 81 12 arcto 4 {pop} repeat 569 69 151 69 12 arcto 4 {pop} repeat clp gs col-1 s gr
	1 setlinecap [1 6.000000] 6.000000 setdash
% Polyline
n 151 129 m 139 129 139 242 12 arcto 4 {pop} repeat 139 254 557 254 12 arcto 4 {pop} repeat 569 254 569 141 12 arcto 4 {pop} repeat 569 129 151 129 12 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
1.000 setlinewidth
% Polyline
n 214 154 m 314 154 l gs col-1 s gr
n 298.000 150.000 m 314.000 154.000 l 298.000 158.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 214 179 m 314 179 l gs col-1 s gr
n 298.000 175.000 m 314.000 179.000 l 298.000 183.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 374 204 m 474 204 l gs col-1 s gr
n 458.000 200.000 m 474.000 204.000 l 458.000 208.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 374 229 m 474 229 l gs col-1 s gr
n 458.000 225.000 m 474.000 229.000 l 458.000 233.000 l gs 2 setlinejoin col-1 s gr
2.000 setlinewidth
% Polyline
n 151 269 m 139 269 139 302 12 arcto 4 {pop} repeat 139 314 557 314 12 arcto 4 {pop} repeat 569 314 569 281 12 arcto 4 {pop} repeat 569 269 151 269 12 arcto 4 {pop} repeat clp gs col-1 s gr
1.000 setlinewidth
% Polyline
n 474 94 m 374 284 l gs col-1 s gr
n 384.992 271.704 m 374.000 284.000 l 377.912 267.978 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
159 44 m 
gs 1 -1 scale (Process 0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 44 m 
gs 1 -1 scale (Process 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 44 m 
gs 1 -1 scale (Process 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 99 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 159 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 184 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 209 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 234 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 159 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 184 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 214 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 239 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
29 199 m 
gs 1 -1 scale (Callee code) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
34 104 m 
gs 1 -1 scale (Caller code) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 299 m 
gs 1 -1 scale (Recv *) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1085 a Fo(Figure)13 b(5.4)249 1122 y Fz(Correct)e(in)o(v)o(o)q
(cation)d(of)j Fw(mcast)249 1292 y Fr(...)249 1346 y
(MPI_Comm_rank\(comm)o(,)19 b(&myrank\);)249 1400 y(if)i(\(myrank)g(==)
g(2\))314 1454 y(MPI_Send\(&i,)f(1,)h(MPI_INT,)f(1,)i(0,)f(comm\);)249
1562 y(mcast\(&i,)f(1,)h(MPI_INT,)g(\(myrank)f(==0\),)h(comm\);)249
1670 y(if)g(\(myrank)g(==)g(1\))314 1724 y(MPI_Recv\(&i,)f(1,)h
(MPI_INT,)f(MPI_ANY_SOURCE,)f(0,)i(comm,)g(&status\);)291
1819 y FA(The)14 b(desired)h(execution)g(of)e(the)h(co)q(de)h(in)e
(this)h(example)f(is)h(illustrated)f(in)h(Figure)g(5.4.)291
1873 y(Ho)o(w)o(ev)o(er,)e(a)g(more)f(lik)o(ely)g(matc)o(hing)f(of)i
(sends)h(with)f(receiv)o(es)i(will)c(lead)i(to)g(the)h(erroneous)249
1927 y(execution)h(is)f(illustrated)f(in)h(Figure)g(5.5.)j(Erroneous)f
(results)f(ma)o(y)d(also)h(o)q(ccur)i(if)e(a)h(pro)q(cess)249
1981 y(that)d(is)g(not)g(in)f(the)i(group)e(of)h Fw(comm)e
FA(and)h(do)q(es)i(not)f(participate)g(in)f(the)i(collectiv)o(e)f(in)o
(v)o(o)q(cation)249 2035 y(of)j Fw(mcast)g FA(sends)j(a)d(message)h(to)
g(pro)q(cesses)i(one)e(or)g(t)o(w)o(o)f(in)h(the)g(group)g(of)f
Fw(comm)p FA(.)291 2089 y(A)d(more)f(robust)i(solution)e(to)h(this)h
(problem)d(is)j(to)f(use)h(a)f(distinct)g(comm)o(unicatio)o(n)e(domain)
249 2143 y(for)16 b(comm)o(unicatio)o(n)e(within)h(the)i(library)m(,)e
(whic)o(h)h(is)g(not)h(used)g(b)o(y)f(the)g(caller)h(co)q(de.)26
b(This)249 2197 y(will)14 b(ensure)k(that)d(messages)h(sen)o(t)g(b)o(y)
g(the)g(library)f(are)h(not)g(receiv)o(ed)h(outside)f(the)g(library)m
(,)249 2251 y(and)e(vice-v)o(ersa.)19 b(The)14 b(mo)q(di\014ed)e(co)q
(de)j(of)e(the)i(function)e Fw(mcast)h FA(is)f(sho)o(wn)h(b)q(elo)o(w.)
249 2346 y Fs(Example)h(5.11)21 b FA(Co)q(de)15 b(for)g(mo)q(di\014ed)f
(broadcast)i(function)f Fw(mcast\(\))g FA(that)g(uses)i(a)e(priv)n(ate)
249 2400 y(comm)o(unicator.)g(The)f(co)q(de)g(is)f(iden)o(tical)f(to)i
(the)f(one)h(in)f(Example)e(5.8,)h(with)h(the)h(follo)o(wing)249
2454 y(exceptions:)26 b(Up)q(on)18 b(en)o(try)m(,)g(a)f(duplicate)g
Fw(p)q(comm)f FA(of)h(the)h(input)f(comm)o(unicator)e
Fw(comm)h FA(is)249 2508 y(created.)24 b(This)15 b(priv)n(ate)g(comm)o
(unicator)d(is)j(used)h(for)f(comm)o(unication)d(within)i(the)i
(library)p eop
%%Page: 228 242
228 241 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(228)1256 b(Chapter)13 b(5)478
466 y
 16577003 8785810 0 0 31969935 17234821 startTexFig
 478 466 a
%%BeginDocument: ../figures/context-lib2bad.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-27.0 283.0 translate 0.900 -0.900 scale
2.000 setlinewidth
% Polyline
n 151 69 m 139 69 139 102 12 arcto 4 {pop} repeat 139 114 557 114 12 arcto 4 {pop} repeat 569 114 569 81 12 arcto 4 {pop} repeat 569 69 151 69 12 arcto 4 {pop} repeat clp gs col-1 s gr
	1 setlinecap [1 6.000000] 6.000000 setdash
% Polyline
n 151 129 m 139 129 139 242 12 arcto 4 {pop} repeat 139 254 557 254 12 arcto 4 {pop} repeat 569 254 569 141 12 arcto 4 {pop} repeat 569 129 151 129 12 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
% Polyline
n 151 269 m 139 269 139 302 12 arcto 4 {pop} repeat 139 314 557 314 12 arcto 4 {pop} repeat 569 314 569 281 12 arcto 4 {pop} repeat 569 269 151 269 12 arcto 4 {pop} repeat clp gs col-1 s gr
1.000 setlinewidth
% Polyline
n 474 94 m 374 149 l gs col-1 s gr
n 389.947 144.794 m 374.000 149.000 l 386.092 137.784 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
159 44 m 
gs 1 -1 scale (Process 0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 44 m 
gs 1 -1 scale (Process 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 44 m 
gs 1 -1 scale (Process 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 99 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 159 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 184 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 209 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 234 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 159 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 184 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 214 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 239 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
29 199 m 
gs 1 -1 scale (Callee code) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
34 104 m 
gs 1 -1 scale (Caller code) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 299 m 
gs 1 -1 scale (Recv *) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1085 a Fo(Figure)g(5.5)249 1122 y Fz(Erroneous)c(in)o(v)o(o)q
(cation)g(of)i Fw(mcast)249 1238 y FA(co)q(de.)19 b(It)14
b(is)g(freed)g(b)q(efore)h(exit.)249 1346 y Fr(void)21
b(mcast\()g(void)g(*buff,)f(int)h(count,)g(MPI_Datatype)e(type,)881
1400 y(int)i(isroot,)g(MPI_Comm)f(comm\))249 1454 y({)249
1508 y(int)h(size,)g(rank,)g(numleaves,)e(child,)i(childleaves;)249
1562 y(MPI_Status)f(status;)249 1616 y(MPI_Comm)g(pcomm;)43
b(/*)21 b(private)f(communicator,)f(for)j(internal)e(communication)f
(*/)249 1724 y(MPI_Comm_dup\(comm,)f(&pcomm\);)249 1832
y(MPI_Comm_size\(pcom)o(m,)h(&size\);)249 1886 y(MPI_Comm_rank\(pcom)o
(m,)g(&rank\);)249 1994 y(if)i(\(isroot\))g({)314 2048
y(numleaves)f(=)i(size-1;)314 2102 y(})249 2156 y(else)f({)358
2209 y(/*)g(receive)g(from)g(parent)f(leaf)h(count)g(and)g(message)g
(*/)314 2263 y(MPI_Recv\(&numleaves,)d(1,)j(MPI_INT,)g(MPI_ANY_SOURCE,)
d(0,)k(pcomm,)e(&status\);)314 2317 y(MPI_Recv\(buff,)f(count,)i(type,)
g(MPI_ANY_SOURCE,)d(0,)k(pcomm,)e(&status\);)314 2371
y(})249 2425 y(while)h(\(numleaves)f(>)h(0\))h({)336
2479 y(/*)g(pick)f(child)f(in)i(middle)e(of)i(current)e(leaf)h
(processes)f(*/)p eop
%%Page: 229 243
229 242 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(229)314
507 y Fr(child)21 b(=)h(\(rank)f(+)g(\(numleaves+1\)/2\)\045s)o(ize;)
314 561 y(childleaves)f(=)i(numleaves/2;)314 615 y(/*)g(send)f(to)g
(child)g(leaf)g(count)g(and)g(message)f(*/)314 669 y
(MPI_Send\(&childleave)o(s,)f(1,)i(MPI_INT,)f(child,)h(0,)g(pcomm\);)
314 723 y(MPI_Send\(buff,)e(count,)i(type,)g(child,)f(0,)i(pcomm\);)314
777 y(/*)g(compute)e(remaining)g(number)h(of)g(leaves)g(*/)314
831 y(numleaves)f(-=)i(\(childleaves+1\);)314 885 y(})249
993 y(MPI_Comm_free\(&pco)o(mm\);)249 1047 y(})291 1196
y FA(This)11 b(co)q(de)i(su\013ers)h(the)f(p)q(enalt)o(y)f(of)f(one)h
(comm)o(unicator)d(allo)q(cation)i(and)h(deallo)q(cation)f(at)249
1250 y(eac)o(h)k(in)o(v)o(o)q(cation.)k(W)m(e)c(sho)o(w)f(in)g(the)i
(next)f(section,)g(in)f(Example)f(5.12,)g(ho)o(w)i(to)f(a)o(v)o(oid)f
(this)249 1304 y(o)o(v)o(erhead,)h(b)o(y)f(using)h(a)g(preallo)q(cated)
g(comm)o(unicator.)249 1425 y FD(5.6)52 b(Cac)o(hing)249
1533 y Fs(5.6.1)c(In)o(tro)q(duction)249 1616 y FA(As)12
b(the)g(previous)g(examples)f(sho)o(w)o(ed,)h(a)f(comm)o(unicator)e
(pro)o(vides)j(a)f(\\scop)q(e")h(for)f(collectiv)o(e)249
1670 y(in)o(v)o(o)q(cations.)17 b(The)d(comm)o(unicator,)c(whic)o(h)j
(is)g(passed)i(as)e(parameter)g(to)g(the)h(call,)f(sp)q(eci\014es)249
1724 y(the)k(group)g(of)f(pro)q(cesses)j(that)e(participate)f(in)h(the)
g(call)f(and)g(pro)o(vide)h(a)f(priv)n(ate)g(comm)o(u-)249
1778 y(nication)g(domain)f(for)i(comm)o(unicatio)o(ns)e(within)h(the)i
(callee)f(b)q(o)q(dy)m(.)27 b(In)17 b(addition,)g(it)f(ma)o(y)249
1831 y(carry)e(information)c(ab)q(out)k(the)g(logical)d(top)q(ology)h
(of)h(the)h(executing)g(pro)q(cesses.)21 b(It)13 b(is)g(often)249
1885 y(useful)18 b(to)f(attac)o(h)h(additional)e(p)q(ersisten)o(t)j(v)n
(alues)f(to)f(this)h(scop)q(e;)i(e.g.,)e(initialization)d(pa-)249
1939 y(rameters)g(for)g(a)g(library)m(,)e(or)i(additional)f(comm)o(uni)
o(cators)f(to)i(pro)o(vide)g(a)g(separate,)h(priv)n(ate)249
1993 y(comm)o(unication)10 b(domain.)291 2047 y Fw(MPI)18
b FA(pro)o(vides)g(a)h(cac)o(hing)f(facilit)o(y)f(that)i(allo)o(ws)f
(an)g(application)f(to)i(attac)o(h)g(arbitrary)249 2101
y(pieces)f(of)f(information,)d(called)i Fs(attributes)p
FA(,)e(to)j(b)q(oth)g(in)o(tra-)f(and)h(in)o(tercomm)o(unicators.)249
2155 y(More)d(precisely)m(,)g(the)h(cac)o(hing)f(facilit)o(y)e(allo)o
(ws)g(a)i(p)q(ortable)g(library)f(to)h(do)g(the)g(follo)o(wing:)249
2238 y Ft(\017)29 b FA(pass)12 b(information)d(b)q(et)o(w)o(een)k
(calls)e(b)o(y)h(asso)q(ciating)f(it)g(with)g(an)h Fw(MPI)f
FA(in)o(tra-)g(or)h(inter-com-)249 2292 y(m)o(unicator,)249
2346 y Ft(\017)29 b FA(quic)o(kly)13 b(retriev)o(e)i(that)f
(information,)c(and)249 2400 y Ft(\017)29 b FA(b)q(e)16
b(guaran)o(teed)g(that)f(out-of-date)g(information)e(is)i(nev)o(er)h
(retriev)o(ed,)h(ev)o(en)f(if)f(the)h(com-)249 2454 y(m)o(unicator)c
(is)i(freed)h(and)f(its)f(handle)h(subsequen)o(tly)h(reused)h(b)o(y)d
Fw(MPI)p FA(.)p eop
%%Page: 230 244
230 243 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(230)1256 b(Chapter)13 b(5)291
507 y FA(Eac)o(h)19 b(attribute)h(is)f(asso)q(ciated)i(with)e(a)g
Fs(k)o(ey)p FA(.)69 b(T)m(o)19 b(pro)o(vide)g(safet)o(y)m(,)h
Fw(MPI)e FA(in)o(ternally)249 561 y(generates)f(k)o(ey)e(v)n(alues.)20
b Fw(MPI)15 b FA(functions)g(are)g(pro)o(vided)g(whic)o(h)f(allo)o(w)g
(the)h(user)h(to)f(allo)q(cate)249 615 y(and)f(deallo)q(cate)g(k)o(ey)g
(v)n(alues)g(\()p Fw(MPI)p 817 615 13 2 v 14 w(KEYV)m(AL)p
988 615 V 14 w(CREA)m(TE)e FA(and)i Fw(MPI)p 1327 615
V 14 w(KEYV)m(AL)p 1498 615 V 14 w(FREE)p FA(\).)e(Once)249
669 y(a)20 b(k)o(ey)g(is)h(allo)q(cated)e(b)o(y)h(a)g(pro)q(cess,)k(it)
19 b(can)i(b)q(e)g(used)g(to)f(attac)o(h)h(one)f(attribute)h(to)f(an)o
(y)249 723 y(comm)o(unicator)9 b(de\014ned)j(at)f(that)h(pro)q(cess.)19
b(Th)o(us,)11 b(the)h(allo)q(cation)e(of)h(a)g(k)o(ey)g(can)h(b)q(e)g
(though)o(t)249 777 y(of)g(as)h(creating)h(an)e(empt)o(y)g(b)q(o)o(x)h
(at)g(eac)o(h)g(curren)o(t)h(or)f(future)h(comm)o(unicator)c(ob)r(ject)
k(at)e(that)249 831 y(pro)q(cess;)j(this)f(b)q(o)o(x)g(has)g(a)f(lo)q
(c)o(k)h(that)g(matc)o(hes)f(the)i(allo)q(cated)e(k)o(ey)m(.)18
b(\(The)c(b)q(o)o(x)g(is)f(\\virtual":)249 885 y(one)e(need)g(not)f
(allo)q(cate)g(an)o(y)f(actual)h(space)i(b)q(efore)f(an)f(attempt)f(is)
h(made)f(to)i(store)g(something)249 939 y(in)i(the)i(b)q(o)o(x.\))291
993 y(Once)i(the)f(k)o(ey)g(is)g(allo)q(cated,)f(the)i(user)g(can)f
(set)h(or)f(access)h(attributes)g(asso)q(ciated)g(with)249
1047 y(this)e(k)o(ey)m(.)21 b(The)15 b Fw(MPI)f FA(call)g
Fw(MPI)p 751 1047 V 15 w(A)m(TTR)p 874 1047 V 14 w(PUT)g
FA(can)h(b)q(e)h(used)g(to)e(set)i(an)f(attribute.)21
b(This)15 b(call)249 1101 y(stores)g(an)f(attribute,)f(or)h(replaces)h
(an)e(attribute)i(in)e(one)h(b)q(o)o(x:)j(the)e(b)q(o)o(x)e(attac)o
(hed)h(with)g(the)249 1155 y(sp)q(eci\014ed)h(comm)o(unicator)d(with)h
(a)h(lo)q(c)o(k)f(that)h(matc)o(hes)g(the)g(sp)q(eci\014ed)i(k)o(ey)m
(.)291 1209 y(The)i(call)f Fw(MPI)p 537 1209 V 15 w(A)m(TTR)p
660 1209 V 14 w(GET)h FA(can)g(b)q(e)h(used)g(to)f(access)i(the)f
(attribute)f(v)n(alue)g(asso)q(ciated)249 1263 y(with)13
b(a)g(giv)o(en)g(k)o(ey)h(and)f(comm)o(unicator.)i(I.e.,)e(it)g(allo)o
(ws)f(one)h(to)h(access)h(the)f(con)o(ten)o(t)g(of)f(the)249
1317 y(b)q(o)o(x)k(attac)o(hed)g(with)g(the)g(sp)q(eci\014ed)h(comm)o
(unicator,)d(that)i(has)f(a)h(lo)q(c)o(k)f(that)h(matc)o(hes)g(the)249
1371 y(sp)q(eci\014ed)g(k)o(ey)m(.)22 b(This)15 b(call)g(is)g(v)n(alid)
f(ev)o(en)i(if)f(the)h(b)q(o)o(x)f(is)g(empt)o(y)m(,)f(e.g.,)g(if)h
(the)h(attribute)g(w)o(as)249 1425 y(nev)o(er)f(set.)k(In)14
b(suc)o(h)g(case,)h(a)e(sp)q(ecial)h(\\empt)o(y")f(v)n(alue)g(is)h
(returned.)291 1479 y(Finally)m(,)h(the)j(call)f Fw(MPI)p
676 1479 V 14 w(A)m(TTR)p 798 1479 V 14 w(DELETE)h FA(allo)o(ws)e(one)h
(to)g(delete)i(an)e(attribute.)29 b(I.e.,)17 b(it)249
1533 y(allo)o(ws)12 b(one)h(to)g(empt)o(y)f(the)i(b)q(o)o(x)f(attac)o
(hed)h(with)e(the)i(sp)q(eci\014ed)h(comm)o(unicator)10
b(with)j(a)g(lo)q(c)o(k)249 1587 y(that)h(matc)o(hes)g(the)g(sp)q
(eci\014ed)h(k)o(ey)m(.)291 1641 y(T)m(o)j(b)q(e)j(general,)f(the)h
(attribute)f(mec)o(hanism)d(m)o(ust)h(b)q(e)j(able)e(to)g(store)i
(arbitrary)e(user)249 1694 y(information.)26 b(On)18
b(the)g(other)g(hand,)g(attributes)g(m)o(ust)f(b)q(e)h(of)e(a)i
(\014xed,)g(prede\014ned)h(t)o(yp)q(e,)249 1748 y(b)q(oth)e(in)f(F)m
(ortran)g(and)g(C)h(|)f(the)h(t)o(yp)q(e)g(sp)q(eci\014ed)h(b)o(y)e
(the)h Fw(MPI)f FA(functions)h(that)f(access)i(or)249
1802 y(up)q(date)c(attributes.)k(A)o(ttributes)c(are)g(de\014ned)g(in)f
(C)g(to)f(b)q(e)i(of)f(t)o(yp)q(e)g Fq(void)e(*)p FA(.)18
b(Generally)m(,)12 b(suc)o(h)249 1856 y(an)f(attribute)h(will)e(b)q(e)h
(a)g(p)q(oin)o(ter)h(to)f(a)g(user-de\014ned)i(data)e(structure)j(or)d
(a)g(handle)g(to)g(an)g Fw(MPI)249 1910 y FA(opaque)16
b(ob)r(ject.)25 b(In)15 b(F)m(ortran,)h(attributes)h(are)f(of)f(t)o(yp)
q(e)i Fr(INTEGER)p FA(.)d(These)j(can)f(b)q(e)g(handles)249
1964 y(to)e(opaque)g Fw(MPI)f FA(ob)r(jects)i(or)f(indices)g(to)g
(user-de\014ned)i(tables.)291 2018 y(An)f(attribute,)g(from)e(the)i
Fw(MPI)g FA(viewp)q(oin)o(t,)f(is)h(a)f(p)q(oin)o(ter)h(or)g(an)g(in)o
(teger.)21 b(An)15 b(attribute,)249 2072 y(from)10 b(the)j(application)
e(viewp)q(oin)o(t,)g(ma)o(y)g(con)o(tain)g(arbitrary)h(information)e
(that)i(is)g(attac)o(hed)249 2126 y(to)19 b(the)g(\\)p
Fw(MPI)f FA(attribute".)33 b(User-de\014ned)21 b(attributes)f(are)f
(\\copied")g(when)g(a)g(new)g(com-)249 2180 y(m)o(unicator)f(is)i
(created)h(b)o(y)f(a)f(call)g(to)h Fw(MPI)p 971 2180
V 14 w(COMM)p 1115 2180 V 14 w(DUP)p FA(;)f(they)h(are)g(\\deleted")g
(when)h(a)249 2234 y(comm)o(unicator)13 b(is)j(deallo)q(cated)g(b)o(y)g
(a)f(call)g(to)h Fw(MPI)p 1090 2234 V 14 w(COMM)p 1234
2234 V 15 w(FREE)p FA(.)e(Because)k(of)e(the)g(arbi-)249
2288 y(trary)h(nature)g(of)f(the)i(information)c(that)i(is)h(copied)g
(or)f(deleted,)i(the)g(user)f(has)g(to)g(sp)q(ecify)249
2342 y(the)k(seman)o(tics)f(of)f(attribute)i(cop)o(ying)f(or)g
(deletion.)37 b(The)21 b(user)g(do)q(es)g(so)g(b)o(y)f(pro)o(viding)249
2396 y(cop)o(y)13 b(and)g(delete)h(callbac)o(k)f(functions)g(when)g
(the)h(attribute)g(k)o(ey)f(is)g(allo)q(cated)f(\(b)o(y)h(a)g(call)g
(to)249 2450 y Fw(MPI)p 326 2450 V 14 w(KEYV)m(AL)p 497
2450 V 14 w(CREA)m(TE)p FA(\).)e(Prede\014ned,)j(default)e(cop)o(y)h
(and)f(delete)i(callbac)o(k)d(functions)i(are)249 2504
y(a)o(v)n(ailable.)p eop
%%Page: 231 245
231 244 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(231)291
507 y FA(All)18 b(attribute)h(manipulation)c(functions)k(are)h(lo)q
(cal)d(and)i(require)h(no)e(comm)o(unication.)249 561
y(Tw)o(o)12 b(comm)o(unicator)d(ob)r(jects)14 b(at)e(t)o(w)o(o)g
(di\013eren)o(t)h(pro)q(cesses)i(that)e(represen)o(t)h(the)f(same)f
(com-)249 615 y(m)o(unication)d(domain)f(ma)o(y)h(ha)o(v)o(e)h(a)h
(di\013eren)o(t)g(set)h(of)e(attribute)h(k)o(eys)h(and)e(di\013eren)o
(t)i(attribute)249 669 y(v)n(alues)i(asso)q(ciated)g(with)g(them.)291
723 y Fw(MPI)d FA(reserv)o(es)j(a)d(set)h(of)g(prede\014ned)h(k)o(ey)f
(v)n(alues)f(in)g(order)i(to)e(asso)q(ciate)i(with)e
Fq(MPI)p 1600 723 12 2 v 13 w(COMM-)p 249 777 V 261 777
a(W)o(ORLD)j FA(information)e(ab)q(out)j(the)g(execution)g(en)o
(vironmen)o(t,)f(at)g Fw(MPI)g FA(initialization)e(time.)249
831 y(These)i(attribute)g(k)o(eys)f(are)g(discussed)i(in)d(Chapter)i
(7.)j(These)d(k)o(eys)g(cannot)f(b)q(e)g(deallo)q(cated)249
885 y(and)20 b(the)g(asso)q(ciated)g(attributes)h(cannot)f(b)q(e)g(up)q
(dated)g(b)o(y)g(the)g(user.)37 b(Otherwise,)22 b(they)249
939 y(b)q(eha)o(v)o(e)14 b(lik)o(e)g(user-de\014ned)i(attributes.)249
1030 y FB(R)n(ationale.)47 b FA(A)15 b(m)o(uc)o(h)g(smaller)f(in)o
(terface,)i(consisting)f(of)g(just)h(a)f(callbac)o(k)g(facilit)o(y)m(,)
e(w)o(ould)249 1084 y(allo)o(w)c(the)j(en)o(tire)g(cac)o(hing)e
(facilit)o(y)g(to)g(b)q(e)i(implemen)o(ted)d(b)o(y)h(p)q(ortable)h(co)q
(de.)18 b(Ho)o(w)o(ev)o(er,)12 b(suc)o(h)249 1138 y(a)k(minima)o(l)d
(in)o(terface)k(do)q(es)h(not)e(pro)o(vide)g(go)q(o)q(d)g(protection)h
(when)g(di\013eren)o(t)h(libraries)e(try)249 1192 y(to)c(attac)o(h)h
(attributes)g(to)f(the)h(same)e(comm)o(unicator.)k(Some)c(con)o(v)o(en)
o(tion)h(will)f(b)q(e)i(needed)h(to)249 1246 y(a)o(v)o(oid)g(them)g
(using)h(the)h(same)e(k)o(ey)i(v)n(alues.)21 b(With)15
b(the)g(curren)o(t)i(design,)e(the)h(initialization)249
1300 y(co)q(de)i(for)e(eac)o(h)i(library)e(can)h(allo)q(cate)f(a)h
(separate)h(k)o(ey)e(v)n(alue)h(for)f(that)h(library;)g(the)h(co)q(de)
249 1354 y(written)13 b(for)f(one)g(library)g(is)g(indep)q(enden)o(t)h
(of)f(the)h(co)q(de)g(used)g(b)o(y)f(another)g(library)m(.)17
b(F)m(urther-)249 1408 y(more)11 b(the)i(more)e(complete)h(in)o
(terface)g(de\014ned)h(here)h(allo)o(ws)d(high-qualit)o(y)f(implem)o
(en)o(tations)249 1462 y(of)j Fw(MPI)g FA(to)h(implem)o(en)o(t)e(fast)h
(attribute)h(access)i(algorithms)11 b(\(e.g.,)i(using)g(an)h(incremen)o
(table)249 1516 y(dictionary)f(data)h(structure\).)249
1587 y(A)o(ttribute)h(k)o(eys)g(are)g(allo)q(cated)f(pro)q(cess-wide,)i
(rather)g(then)f(sp)q(eci\014cally)f(for)h(one)f(comm)o(u-)249
1641 y(nicator.)30 b(This)18 b(often)f(simpli\014es)g(usage,)h(since)h
(a)e(particular)h(t)o(yp)q(e)g(of)g(attribute)g(ma)o(y)e(b)q(e)249
1694 y(asso)q(ciated)f(with)e(man)o(y)f(comm)o(unicators;)f(and)j
(simpli\014es)e(implemen)o(tation.)249 1765 y(The)g(use)g(of)f(callbac)
o(k)f(functions)i(for)f(attribute)h(cop)o(ying)e(and)h(deletion)h(allo)
o(ws)e(one)h(to)g(de\014ne)249 1819 y(di\013eren)o(t)21
b(b)q(eha)o(viors)e(for)g(these)i(op)q(erations.)35 b(F)m(or)19
b(example,)g(cop)o(ying)g(ma)o(y)f(in)o(v)o(olv)o(e)g(the)249
1873 y(allo)q(cation)12 b(of)h(a)g(new)h(data)f(structure,)i(if)d(the)i
(attribute)g(is)f(mo)q(di\014able;)e(or,)i(it)g(ma)o(y)f(in)o(v)o(olv)o
(e)249 1927 y(only)17 b(the)h(incremen)o(t)g(of)f(a)g(reference)j(coun)
o(t)e(if)f(the)h(attribute)h(is)e(not)h(mo)q(di\014able.)27
b(With)249 1981 y(the)14 b(curren)o(t)g(design,)f(the)g(implemen)o
(tation)c(of)k(attribute)g(cop)o(ying)f(and)h(deletion)g(is)f
(de\014ned)249 2035 y(when)h(the)f(attribute)h(k)o(ey)f(is)g(allo)q
(cated,)f(and)h(need)h(not)f(b)q(e)h(visible)e(to)h(all)f(program)f(mo)
q(dules)249 2089 y(that)k(use)h(this)f(k)o(ey)m(.)j(\()p
FB(End)f(of)f(r)n(ationale.)p FA(\))249 2180 y FB(A)n(dvic)n(e)d(to)g
(users.)35 b FA(The)12 b(comm)o(unicator)c Fq(MPI)p 990
2180 V 13 w(COMM)p 1124 2180 V 12 w(SELF)k FA(can)f(b)q(e)h(used)g(to)f
(store)h(pro)q(cess-)249 2234 y(lo)q(cal)h(attributes,)h(via)f(this)h
(attribute)h(cac)o(hing)e(mec)o(hanism.)j(\()p FB(End)g(of)f(advic)n(e)
g(to)g(users.)p FA(\))249 2325 y FB(A)n(dvic)n(e)g(to)f(implementors.)
36 b FA(C)14 b(A)o(ttributes)h(are)f(scalar)g(v)n(alues,)f(equal)g(in)g
(size)i(to,)e(or)g(larger)249 2379 y(than)g(a)g(C-language)f(p)q(oin)o
(ter.)18 b(F)m(ortran)13 b(attributes)i(are)e(of)g(t)o(yp)q(e)h
Fr(INTEGER)p FA(.)d(A)o(ttributes)j(can)249 2433 y(alw)o(a)o(ys)h(hold)
g(an)g Fw(MPI)g FA(handle.)23 b(It)16 b(is)f(v)o(ery)h(desirable)g(to)g
(ha)o(v)o(e)f(iden)o(tical)g(attribute)h(t)o(yp)q(es,)249
2487 y(b)q(oth)f(for)g(F)m(ortran)f(and)h(C,)f(in)h(order)h(to)e
(facilitate)g(mixed)f(language)h(programming.)k(E.g.,)p
eop
%%Page: 232 246
232 245 bop 2 223 2 150 v 2 76 150 2 v 1928 76 V 2076
225 2 150 v 249 251 a Fv(232)1256 b(Chapter)13 b(5)249
507 y FA(on)f(systems)h(with)f(64)g(bit)g(C)g(p)q(oin)o(ters)h(but)f
(32)g(bit)g(F)m(ortran)h Fr(INTEGER)p FA(,)d(one)j(could)f(use)h(64)f
(bit)249 561 y(attribute)k(v)n(alues.)23 b(F)m(ortran)15
b(calls)g(will)f(con)o(v)o(ert)j(from)c Fr(INTEGER\(4\))h
FA(to)h Fr(INTEGER\(8\))p FA(,)f(and)249 615 y(vice)g(v)o(ersa.)249
686 y(Cac)o(hing)j(and)g(callbac)o(k)g(functions)g(are)h(only)e(called)
h(sync)o(hronously)m(,)h(in)f(resp)q(onse)i(to)e(ex-)249
740 y(plicit)11 b(application)g(requests.)19 b(This)12
b(a)o(v)o(oid)e(problems)h(that)h(result)h(from)d(rep)q(eated)k
(crossings)249 794 y(b)q(et)o(w)o(een)e(user)g(and)f(system)f(space.)18
b(\(This)11 b(sync)o(hronous)g(calling)f(rule)h(is)f(a)h(general)g
(prop)q(ert)o(y)249 848 y(of)i Fw(MPI)p FA(.\))g(\()p
FB(End)j(of)f(advic)n(e)g(to)g(implementors.)p FA(\))249
939 y Fs(5.6.2)48 b(Cac)o(hing)15 b(F)l(unctions)208
1022 y Fw(MPI)e FA(pro)o(vides)h(the)g(follo)o(wing)e(services)j
(related)g(to)e(cac)o(hing.)18 b(They)d(are)f(all)f(pro)q(cess)i(lo)q
(cal.)249 1147 y Fw(MPI)p 326 1147 13 2 v 14 w(KEYV)m(AL)p
497 1147 V 14 w(CREA)m(TE\(cop)o(y)p 762 1147 V 14 w(fn,)f(delete)p
936 1147 V 16 w(fn,)g(k)o(eyval,)g(extra)p 1229 1147
V 16 w(state\))332 1222 y Fv(IN)158 b Fw(cop)o(y)p 613
1222 V 15 w(fn)419 b Fv(Cop)o(y)14 b(callbac)o(k)h(function)f(for)f
Fq(k)o(eyval)332 1271 y Fv(IN)158 b Fw(delete)p 635 1271
V 16 w(fn)396 b Fv(Delete)14 b(callbac)o(k)h(function)g(for)e
Fq(k)o(eyval)332 1321 y Fv(OUT)114 b Fw(k)o(eyval)441
b Fv(k)o(ey)14 b(v)n(alue)g(for)f(future)g(access)332
1371 y(IN)158 b Fw(extra)p 621 1371 V 15 w(state)361
b Fv(Extra)14 b(state)f(for)f(callbac)o(k)k(functions)249
1481 y Fr(int)21 b(MPI)p 405 1481 14 2 v 15 w(Keyval)p
552 1481 V 15 w(create\(MPI)p 787 1481 V 13 w(Copy)p
888 1481 V 15 w(function)f(*copy)p 1209 1481 V 15 w(fn,)h(MPI)p
1377 1481 V 15 w(Delete)p 1524 1481 V 15 w(function)540
1535 y(*delete)p 697 1535 V 14 w(fn,)g(int)g(*keyval,)f(void*)h(extra)p
1322 1535 V 15 w(state\))249 1619 y(MPI)p 318 1619 V
15 w(KEYVAL)p 465 1619 V 15 w(CREATE\(COPY)p 722 1619
V 13 w(FN,)g(DELETE)p 954 1619 V 15 w(FN,)g(KEYVAL,)f(EXTRA)p
1340 1619 V 15 w(STATE,)g(IERROR\))336 1673 y(EXTERNAL)g(COPY)p
623 1673 V 15 w(FN,)h(DELETE)p 857 1673 V 15 w(FN)336
1727 y(INTEGER)g(KEYVAL,)f(EXTRA)p 798 1727 V 15 w(STATE,)g(IERROR)291
1811 y FA(MPI)p 374 1811 13 2 v 15 w(KEYV)-5 b(AL)p 563
1811 V 16 w(CREA)m(TE)18 b(allo)q(cates)g(a)g(new)h(attribute)g(k)o(ey)
f(v)n(alue.)31 b(Key)19 b(v)n(alues)f(are)249 1865 y(unique)i(in)g(a)f
(pro)q(cess.)75 b(Once)21 b(allo)q(cated,)g(the)f(k)o(ey)g(v)n(alue)f
(can)i(b)q(e)f(used)h(to)f(asso)q(ciate)249 1919 y(attributes)c(and)f
(access)h(them)f(on)f(an)o(y)h(lo)q(cally)e(de\014ned)j(comm)o
(unicator.)j(The)c(sp)q(ecial)g(k)o(ey)249 1973 y(v)n(alue)c
Fq(MPI)p 426 1973 12 2 v 12 w(KEYV)m(AL)p 584 1973 V
13 w(INV)m(ALID)e FA(is)i(nev)o(er)i(returned)g(b)o(y)e
Fw(MPI)p 1197 1973 13 2 v 14 w(KEYV)m(AL)p 1368 1973
V 13 w(CREA)m(TE)p FA(.)f(Therefore,)249 2027 y(it)i(can)h(b)q(e)h
(used)f(for)g(static)g(initialization)d(of)i(k)o(ey)h(v)n(ariables,)e
(to)i(indicate)g(an)f(\\unallo)q(cated")249 2081 y(k)o(ey)m(.)291
2135 y(The)20 b Fw(cop)o(y)p 462 2135 V 15 w(fn)g FA(function)g(is)g
(in)o(v)o(ok)o(ed)f(when)h(a)g(comm)o(unicator)d(is)j(duplicated)g(b)o
(y)f Fw(MPI-)p 249 2189 V 262 2189 a(COMM)p 394 2189
V 14 w(DUP)p FA(.)14 b Fw(cop)o(y)p 598 2189 V 15 w(fn)h
FA(should)g(b)q(e)g(of)f(t)o(yp)q(e)i Fq(MPI)p 1065 2189
12 2 v 12 w(Cop)o(y)p 1158 2189 V 13 w(function)p FA(,)d(whic)o(h)i(is)
g(de\014ned)h(as)f(fol-)249 2243 y(lo)o(ws:)249 2330
y Fr(typedef)20 b(int)i(MPI_Copy_functi)o(on\(MP)o(I_Com)o(m)d
(oldcomm,)h(int)h(keyval,)903 2384 y(void)g(*extra_state,)e(void)i
(*attribute_val_in)o(,)903 2438 y(void)g(*attribute_val_ou)o(t,)e(int)i
(*flag\))p eop
%%Page: 233 247
233 246 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(233)291
507 y FA(A)14 b(F)m(ortran)f(declaration)h(for)f(suc)o(h)i(a)f
(function)f(is)h(as)g(follo)o(ws:)249 561 y Fr(SUBROUTINE)20
b(COPY)p 580 561 14 2 v 15 w(FUNCTION\(OLDCOMM)o(,)f(KEYVAL,)h(EXTRA)p
1271 561 V 15 w(STATE,)540 615 y(ATTRIBUTE)p 741 615
V 13 w(VAL)p 820 615 V 16 w(IN,)h(ATTRIBUTE)p 1121 615
V 14 w(VAL)p 1201 615 V 15 w(OUT,)g(FLAG,)f(IERR\))336
669 y(INTEGER)h(OLDCOMM,)f(KEYVAL,)g(EXTRA)p 994 669
V 15 w(STATE,)g(ATTRIBUTE)p 1359 669 V 14 w(VAL)p 1439
669 V 15 w(IN,)336 723 y(ATTRIBUTE)p 537 723 V 14 w(VAL)p
617 723 V 15 w(OUT,)h(IERR)336 777 y(LOGICAL)g(FLAG)291
861 y FA(Whenev)o(er)13 b(a)f(comm)o(unicator)e(is)j(replicated)g
(using)f(the)h(function)g Fw(MPI)p 1434 861 13 2 v 14
w(COMM)p 1578 861 V 15 w(DUP)p FA(,)e(all)249 915 y(callbac)o(k)16
b(cop)o(y)g(functions)h(for)f(attributes)i(that)e(are)h(curren)o(tly)h
(set)f(are)g(in)o(v)o(ok)o(ed)f(\(in)g(arbi-)249 969
y(trary)k(order\).)35 b(Eac)o(h)20 b(call)f(to)g(the)h(cop)o(y)f
(callbac)o(k)g(is)g(passed)i(as)e(input)g(parameters)h(the)249
1023 y(old)c(comm)o(unicator)e Fw(oldcomm)p FA(,)i(the)h(k)o(ey)g(v)n
(alue)f Fw(k)o(eyval)p FA(,)i(the)g(additional)d(state)j
Fw(extra)p 1646 1023 V 15 w(state)249 1077 y FA(that)d(w)o(as)f(pro)o
(vided)h(to)f Fw(MPI)p 720 1077 V 15 w(KEYV)m(AL)p 892
1077 V 13 w(CREA)m(TE)f FA(when)i(the)h(k)o(ey)e(v)n(alue)g(w)o(as)h
(created,)h(and)249 1131 y(the)i(curren)o(t)h(attribute)f(v)n(alue)e
Fw(attribute)p 912 1131 V 17 w(val)p 978 1131 V 15 w(in)p
FA(.)28 b(If)17 b(it)g(returns)i Fq(\015ag)d(=)g(false)p
FA(,)h(then)h(the)g(at-)249 1185 y(tribute)h(is)f(deleted)h(in)f(the)g
(duplicated)h(comm)o(unicator.)28 b(Otherwise,)20 b(when)e
Fq(\015ag)f(=)g(true)p FA(,)249 1239 y(the)e(new)g(attribute)g(v)n
(alue)f(is)g(set)i(to)e(the)h(v)n(alue)f(returned)i(in)e
Fw(attribute)p 1399 1239 V 16 w(val)p 1464 1239 V 15
w(out)p FA(.)20 b(The)15 b(func-)249 1293 y(tion)h(returns)h
Fq(MPI)p 554 1293 12 2 v 13 w(SUCCESS)f FA(on)g(success)j(and)d(an)g
(error)h(co)q(de)g(on)e(failure)h(\(in)f(whic)o(h)h(case)249
1347 y Fw(MPI)p 326 1347 13 2 v 14 w(COMM)p 470 1347
V 15 w(DUP)d FA(will)f(fail\).)291 1401 y Fw(cop)o(y)p
371 1401 V 15 w(fn)18 b FA(ma)o(y)e(b)q(e)j(sp)q(eci\014ed)h(as)e
Fw(MPI)p 895 1401 V 14 w(NULL)p 1011 1401 V 16 w(COPY)p
1140 1401 V 13 w(FN)g FA(or)g Fw(MPI)p 1354 1401 V 14
w(DUP)p 1454 1401 V 14 w(FN)g FA(from)f(either)249 1455
y(C)d(or)g(F)o(OR)m(TRAN.)e Fw(MPI)p 654 1455 V 14 w(NULL)p
770 1455 V 16 w(COPY)p 899 1455 V 14 w(FN)h FA(is)h(a)g(function)f
(that)h(do)q(es)h(nothing)e(other)h(than)249 1509 y(returning)f
Fq(\015ag)e(=)h(0)g FA(and)g Fq(MPI)p 723 1509 12 2 v
13 w(SUCCESS)p FA(;)g(I.e.,)f(the)i(attribute)g(is)f(not)g(copied.)18
b Fw(MPI)p 1578 1509 13 2 v 14 w(DUP)p 1678 1509 V 14
w(FN)249 1563 y FA(sets)i Fq(\015ag)d(=)f(1)p FA(,)j(returns)h(the)f(v)
n(alue)e(of)h Fw(attribute)p 1044 1563 V 16 w(val)p 1109
1563 V 15 w(in)h FA(in)e Fw(attribute)p 1375 1563 V 17
w(val)p 1441 1563 V 15 w(out)h FA(and)g(returns)249 1617
y Fq(MPI)p 321 1617 12 2 v 13 w(SUCCESS)p FA(.)c(I.e.,)e(the)j
(attribute)f(v)n(alue)g(is)f(copied,)h(with)g(no)f(side-e\013ects.)249
1705 y FB(R)n(ationale.)34 b FA(The)10 b(use)h(of)e(the)h
Fw(extra)p 814 1705 13 2 v 16 w(state)g FA(argumen)o(t)e(allo)o(ws)h
(one)h(to)f(sp)q(ecialize)h(the)h(b)q(eha)o(vior)249
1759 y(of)h(a)f(generic)i(cop)o(y)f(callbac)o(k)g(function)f(to)h(a)g
(particular)g(attribute.)18 b(E.g.,)11 b(one)h(migh)o(t)e(ha)o(v)o(e)i
(a)249 1813 y(generic)i(cop)o(y)f(function)g(that)h(allo)q(cates)f
Fw(m)f FA(b)o(ytes)i(of)f(storage,)g(cop)o(y)g Fw(m)g
FA(b)o(ytes)h(from)d(address)249 1867 y Fw(attribute)p
400 1867 V 16 w(val)p 465 1867 V 15 w(in)k FA(in)o(to)f(the)h(newly)f
(allo)q(cated)g(space,)h(and)f(returns)i(the)f(address)g(of)f(the)h
(allo-)249 1921 y(cated)h(space)h(in)e Fw(attribute)p
675 1921 V 16 w(val)p 740 1921 V 15 w(out)p FA(;)h(the)g(v)n(alue)e(of)
h Fw(m)p FA(,)f(i.e.,)g(the)i(size)h(of)d(the)i(data)f(structure)249
1975 y(for)f(a)f(sp)q(eci\014c)j(attribute,)d(can)i(b)q(e)f(sp)q
(eci\014ed)i(via)d Fw(extra)p 1135 1975 V 15 w(state)p
FA(.)18 b(\()p FB(End)e(of)f(r)n(ationale.)p FA(\))249
2063 y FB(A)n(dvic)n(e)20 b(to)h(users.)73 b FA(Ev)o(en)20
b(though)g(b)q(oth)g(formal)d(argumen)o(ts)i Fw(attribute)p
1478 2063 V 17 w(val)p 1544 2063 V 15 w(in)h FA(and)g
Fw(at-)249 2117 y(tribute)p 365 2117 V 16 w(val)p 430
2117 V 15 w(out)14 b FA(are)g(of)f(t)o(yp)q(e)h Fq(void)d(*)p
FA(,)i(their)h(usage)g(di\013ers.)19 b(The)14 b(C)f(cop)o(y)h(function)
f(is)g(passed)249 2171 y(b)o(y)18 b Fw(MPI)g FA(in)g
Fw(attribute)p 608 2171 V 16 w(val)p 673 2171 V 15 w(in)h
FA(the)g FB(value)f FA(of)g(the)h(attribute,)h(and)e(in)g
Fw(attribute)p 1532 2171 V 16 w(val)p 1597 2171 V 15
w(out)h FA(the)249 2225 y FB(addr)n(ess)c FA(of)g(the)h(attribute,)g
(so)f(as)h(to)f(allo)o(w)e(the)j(function)f(to)g(return)i(the)f
(\(new\))g(attribute)249 2279 y(v)n(alue.)h(The)e(use)f(of)g(t)o(yp)q
(e)g Fq(void)e(*)i FA(for)f(b)q(oth)h(is)g(to)g(a)o(v)o(oid)e(messy)i
(t)o(yp)q(e)g(casts.)249 2346 y(A)f(v)n(alid)f(cop)o(y)h(function)g(is)
f(one)i(that)f(completely)f(duplicates)h(the)h(information)c(b)o(y)j
(making)249 2400 y(a)g(full)g(duplicate)g(cop)o(y)h(of)f(the)h(data)f
(structures)j(implied)11 b(b)o(y)j(an)f(attribute;)h(another)g(migh)o
(t)249 2454 y(just)i(mak)o(e)f(another)i(reference)i(to)d(that)g(data)g
(structure,)i(while)e(using)g(a)g(reference-coun)o(t)249
2508 y(mec)o(hanism.)f(Other)f(t)o(yp)q(es)f(of)f(attributes)i(migh)o
(t)c(not)i(cop)o(y)h(at)f(all)f(\(they)i(migh)o(t)e(b)q(e)i(sp)q
(eci\014c)p eop
%%Page: 234 248
234 247 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(234)1256 b(Chapter)13 b(5)249
507 y FA(to)h Fw(oldcomm)e FA(only\).)17 b(\()p FB(End)f(of)f(advic)n
(e)g(to)g(users.)p FA(\))249 599 y FB(A)n(dvic)n(e)j(to)g
(implementors.)57 b FA(A)18 b(C)f(in)o(terface)h(should)g(b)q(e)g
(assumed)f(for)g(cop)o(y)g(and)g(delete)249 653 y(functions)12
b(asso)q(ciated)g(with)f(k)o(ey)h(v)n(alues)f(created)i(in)f(C;)f(a)g
(F)m(ortran)g(calling)f(in)o(terface)j(should)249 707
y(b)q(e)i(assumed)e(for)h(k)o(ey)g(v)n(alues)f(created)j(in)d(F)m
(ortran.)18 b(\()p FB(End)e(of)e(advic)n(e)i(to)e(implementors.)p
FA(\))291 798 y(Analogous)k(to)i Fw(cop)o(y)p 635 798
13 2 v 15 w(fn)g FA(is)f(a)g(callbac)o(k)g(deletion)g(function,)i
(de\014ned)f(as)g(follo)o(ws.)33 b(The)249 852 y Fw(delete)p
351 852 V 17 w(fn)12 b FA(function)g(is)g(in)o(v)o(ok)o(ed)g(when)g(a)g
(comm)o(unicator)e(is)i(deleted)h(b)o(y)f Fw(MPI)p 1486
852 V 15 w(COMM)p 1631 852 V 14 w(FREE)249 906 y FA(or)h(b)o(y)g(a)g
(call)g(to)g Fw(MPI)p 593 906 V 14 w(A)m(TTR)p 715 906
V 15 w(DELETE)g FA(or)g Fw(MPI)p 1023 906 V 15 w(A)m(TTR)p
1146 906 V 14 w(PUT)p FA(.)f Fw(delete)p 1368 906 V 17
w(fn)h FA(should)g(b)q(e)h(of)f(t)o(yp)q(e)249 960 y
Fq(MPI)p 321 960 12 2 v 13 w(Delete)p 437 960 V 13 w(function)p
FA(,)e(whic)o(h)j(is)g(de\014ned)h(as)f(follo)o(ws:)249
1055 y Fr(typedef)20 b(int)i(MPI_Delete_func)o(tion\()o(MPI_C)o(omm)d
(comm,)h(int)i(keyval,)946 1109 y(void)f(*attribute_val,)e(void)i
(*extra_state\);)291 1205 y FA(A)14 b(F)m(ortran)f(declaration)h(for)f
(suc)o(h)i(a)f(function)f(is)h(as)g(follo)o(ws:)249 1259
y Fr(SUBROUTINE)20 b(DELETE)p 624 1259 14 2 v 14 w(FUNCTION\(COMM,)f
(KEYVAL,)h(ATTRIBUTE)p 1337 1259 V 14 w(VAL,)h(EXTRA)p
1570 1259 V 15 w(STATE,)540 1313 y(IERR\))336 1367 y(INTEGER)g(COMM,)f
(KEYVAL,)h(ATTRIBUTE)p 1017 1367 V 14 w(VAL,)f(EXTRA)p
1249 1367 V 15 w(STATE,)h(IERR)291 1451 y FA(Whenev)o(er)c(a)f(comm)o
(unicator)d(is)k(deleted)g(using)f(the)h(function)f Fw(MPI)p
1415 1451 13 2 v 14 w(COMM)p 1559 1451 V 15 w(FREE)p
FA(,)f(all)249 1504 y(callbac)o(k)i(delete)h(functions)g(for)f
(attributes)h(that)g(are)g(curren)o(tly)g(set)h(are)f(in)o(v)o(ok)o(ed)
e(\(in)i(ar-)249 1558 y(bitrary)f(order\).)30 b(In)17
b(addition)f(the)i(callbac)o(k)f(delete)h(function)f(for)g(the)h
(deleted)h(attribute)249 1612 y(is)14 b(in)o(v)o(ok)o(ed)g(b)o(y)g
Fw(MPI)p 578 1612 V 14 w(A)m(TTR)p 700 1612 V 14 w(DELETE)h
FA(and)f Fw(MPI)p 1040 1612 V 14 w(A)m(TTR)p 1162 1612
V 14 w(PUT)p FA(.)f(The)i(function)f(is)g(passed)h(as)249
1666 y(input)j(parameters)f(the)i(comm)o(unicator)c Fw(comm)p
FA(,)h(the)i(k)o(ey)g(v)n(alue)f Fw(k)o(eyval)p FA(,)i(the)g(curren)o
(t)g(at-)249 1720 y(tribute)d(v)n(alue)f Fw(attribute)p
649 1720 V 17 w(val)p FA(,)g(and)h(the)g(additional)e(state)j
Fw(extra)p 1286 1720 V 15 w(state)f FA(that)g(w)o(as)g(passed)h(to)249
1774 y Fw(MPI)p 326 1774 V 14 w(KEYV)m(AL)p 497 1774
V 14 w(CREA)m(TE)g FA(when)i(the)h(k)o(ey)e(v)n(alue)h(w)o(as)f(allo)q
(cated.)32 b(The)19 b(function)g(returns)249 1828 y Fq(MPI)p
321 1828 12 2 v 13 w(SUCCESS)c FA(on)g(success)i(and)d(an)h(error)h(co)
q(de)f(on)g(failure)f(\(in)g(whic)o(h)h(case)h Fw(MPI)p
1588 1828 13 2 v 14 w(COMM-)p 249 1882 V 262 1882 a(FREE)c
FA(will)h(fail\).)291 1936 y Fw(delete)p 393 1936 V 16
w(fn)21 b FA(ma)o(y)d(b)q(e)j(sp)q(eci\014ed)i(as)d Fw(MPI)p
930 1936 V 14 w(NULL)p 1046 1936 V 16 w(DELETE)p 1217
1936 V 15 w(FN)h FA(from)e(either)i(C)f(or)h(F)o(OR-)249
1990 y(TRAN;)12 b Fw(MPI)p 473 1990 V 14 w(NULL)p 589
1990 V 16 w(DELETE)p 760 1990 V 15 w(FN)g FA(is)g(a)g(function)g(that)g
(do)q(es)h(nothing,)e(other)i(than)f(return-)249 2044
y(ing)h Fq(MPI)p 390 2044 12 2 v 13 w(SUCCESS)p FA(.)249
2135 y FB(A)n(dvic)n(e)20 b(to)h(users.)73 b FA(The)21
b(delete)g(callbac)o(k)e(function)h(ma)o(y)e(b)q(e)i(in)o(v)o(ok)o(ed)f
(b)o(y)h Fw(MPI)g FA(asyn-)249 2189 y(c)o(hronously)m(,)11
b(after)h(the)g(call)f(to)g Fw(MPI)p 827 2189 13 2 v
14 w(COMM)p 971 2189 V 15 w(FREE)f FA(returned,)k(when)e
Fw(MPI)e FA(actually)h(deletes)249 2243 y(the)k(comm)o(uni)o(cator)d
(ob)r(ject.)18 b(\()p FB(End)e(of)f(advic)n(e)g(to)g(users.)p
FA(\))p eop
%%Page: 235 249
235 248 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(235)249
507 y Fw(MPI)p 326 507 13 2 v 14 w(KEYV)m(AL)p 497 507
V 14 w(FREE\(k)o(eyval\))332 582 y Fv(INOUT)71 b Fw(k)o(eyval)441
b Fv(F)m(rees)13 b(the)g(in)o(teger)h(k)o(ey)g(v)n(alue)249
692 y Fr(int)21 b(MPI)p 405 692 14 2 v 15 w(Keyval)p
552 692 V 15 w(free\(int)f(*keyval\))249 776 y(MPI)p
318 776 V 15 w(KEYVAL)p 465 776 V 15 w(FREE\(KEYVAL,)f(IERROR\))336
830 y(INTEGER)i(KEYVAL,)f(IERROR)291 914 y FA(MPI)p 374
914 13 2 v 15 w(KEYV)-5 b(AL)p 563 914 V 16 w(FREE)14
b(deallo)q(cates)g(an)g(attribute)g(k)o(ey)g(v)n(alue.)j(This)d
(function)g(sets)h(the)249 968 y(v)n(alue)h(of)g Fw(k)o(eyval)h
FA(to)f Fq(MPI)p 656 968 12 2 v 13 w(KEYV)m(AL)p 815
968 V 12 w(INV)m(ALID)p FA(.)e(Note)33 b(that)17 b(it)f(is)g(not)g
(erroneous)i(to)e(free)i(an)249 1022 y(attribute)h(k)o(ey)g(that)g(is)g
(in)g(use)g(\(i.e.,)g(has)g(attac)o(hed)h(v)n(alues)f(for)f(some)g
(comm)o(unicators\);)249 1076 y(the)d(k)o(ey)g(v)n(alue)f(is)g(not)h
(actually)f(deallo)q(cated)g(un)o(til)g(after)h(no)f(attribute)h(v)n
(alues)g(are)g(lo)q(cally)249 1130 y(attac)o(hed)g(to)e(this)h(k)o(ey)m
(.)k(All)13 b(suc)o(h)h(attribute)h(v)n(alues)e(need)i(to)f(b)q(e)g
(explicitly)f(deallo)q(cated)h(b)o(y)249 1184 y(the)c(program,)f
(either)h(via)f(calls)h(to)f Fw(MPI)p 880 1184 13 2 v
14 w(A)m(TTR)p 1002 1184 V 15 w(DELETE)h FA(that)f(free)i(one)f
(attribute)g(instance,)249 1238 y(or)17 b(b)o(y)g(calls)g(to)g
Fw(MPI)p 591 1238 V 14 w(COMM)p 735 1238 V 15 w(FREE)f
FA(that)h(free)h(all)e(attribute)i(instances)g(asso)q(ciated)g(with)249
1292 y(the)d(freed)f(comm)o(unicator.)249 1417 y Fw(MPI)p
326 1417 V 14 w(A)m(TTR)p 448 1417 V 15 w(PUT\(comm,)d(k)o(eyval,)j
(attribute)p 973 1417 V 16 w(val\))332 1491 y Fv(IN)158
b Fw(comm)439 b Fv(comm)o(unicator)12 b(to)d(whic)o(h)h(attribute)h
(will)g(b)q(e)1079 1545 y(attac)o(hed)332 1595 y(IN)158
b Fw(k)o(eyval)441 b Fv(k)o(ey)14 b(v)n(alue,)g(as)f(returned)h(b)o(y)
1079 1649 y Fq(MPI)p 1151 1649 12 2 v 13 w(KEYV)m(AL)p
1310 1649 V 12 w(CREA)m(TE)332 1699 y Fv(IN)158 b Fw(attribute)p
684 1699 13 2 v 16 w(val)332 b Fv(attribute)15 b(v)n(alue)249
1809 y Fr(int)21 b(MPI)p 405 1809 14 2 v 15 w(Attr)p
508 1809 V 15 w(put\(MPI)p 677 1809 V 14 w(Comm)g(comm,)g(int)g
(keyval,)g(void*)f(attribute)p 1521 1809 V 14 w(val\))249
1893 y(MPI)p 318 1893 V 15 w(ATTR)p 421 1893 V 15 w(PUT\(COMM,)g
(KEYVAL,)g(ATTRIBUTE)p 1026 1893 V 14 w(VAL,)h(IERROR\))336
1947 y(INTEGER)g(COMM,)f(KEYVAL,)h(ATTRIBUTE)p 1017 1947
V 14 w(VAL,)f(IERROR)291 2031 y FA(MPI)p 374 2031 13
2 v 15 w(A)m(TTR)p 508 2031 V 14 w(PUT)10 b(asso)q(ciates)h(the)g(v)n
(alue)e Fw(attribute)p 1128 2031 V 16 w(val)h FA(with)g(the)g(k)o(ey)g
Fw(k)o(eyval)h FA(on)e(comm)o(u-)249 2085 y(nicator)14
b Fw(comm)p FA(.)i(If)e(a)f(v)n(alue)h(is)g(already)f(asso)q(ciated)i
(with)e(this)h(k)o(ey)g(on)g(the)h(comm)o(unicator,)249
2139 y(then)h(the)g(outcome)f(is)g(as)h(if)e Fw(MPI)p
798 2139 V 15 w(A)m(TTR)p 921 2139 V 14 w(DELETE)i FA(w)o(as)f(\014rst)
h(called)g(to)f(delete)h(the)g(previ-)249 2193 y(ous)e(v)n(alue)g
(\(and)g(the)h(callbac)o(k)f(function)g Fw(delete)p 1025
2193 V 16 w(fn)h FA(w)o(as)f(executed\),)i(and)e(a)g(new)h(v)n(alue)f
(w)o(as)249 2247 y(next)g(stored.)19 b(The)13 b(call)g(is)g(erroneous)i
(if)d(there)j(is)e(no)g(k)o(ey)g(with)g(v)n(alue)g Fw(k)o(eyval)p
FA(;)h(in)f(particular)249 2301 y Fq(MPI)p 321 2301 12
2 v 13 w(KEYV)m(AL)p 480 2301 V 12 w(INV)m(ALID)f FA(is)i(an)g
(erroneous)h(v)n(alue)e(for)h Fw(k)o(eyval)p FA(.)p eop
%%Page: 236 250
236 249 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(236)1256 b(Chapter)13 b(5)249
507 y Fw(MPI)p 326 507 13 2 v 14 w(A)m(TTR)p 448 507
V 15 w(GET\(comm,)e(k)o(eyval,)j(attribute)p 970 507
V 17 w(val,)f(\015ag\))332 582 y Fv(IN)158 b Fw(comm)439
b Fv(comm)o(unicator)17 b(to)e(whic)o(h)g(attribute)h(is)g(at-)1079
636 y(tac)o(hed)332 686 y(IN)158 b Fw(k)o(eyval)441 b
Fv(k)o(ey)14 b(v)n(alue)332 736 y(OUT)114 b Fw(attribute)p
684 736 V 16 w(val)332 b Fv(attribute)15 b(v)n(alue,)e(unless)i
Fq(\015ag)e Fv(=)g(false)332 785 y(OUT)114 b Fw(\015ag)483
b Fc(true)8 b Fv(if)j(an)f(attribute)h(v)n(alue)g(w)o(as)f(extracted;)
1079 839 y Fc(false)i Fv(if)j(no)f(attribute)h(is)g(asso)q(ciated)h
(with)1079 893 y(the)d(k)o(ey)249 1003 y Fr(int)21 b(MPI)p
405 1003 14 2 v 15 w(Attr)p 508 1003 V 15 w(get\(MPI)p
677 1003 V 14 w(Comm)g(comm,)g(int)g(keyval,)g(void)g(*attribute)p
1522 1003 V 13 w(val,)540 1057 y(int)g(*flag\))249 1141
y(MPI)p 318 1141 V 15 w(ATTR)p 421 1141 V 15 w(GET\(COMM,)f(KEYVAL,)g
(ATTRIBUTE)p 1026 1141 V 14 w(VAL,)h(FLAG,)g(IERROR\))336
1195 y(INTEGER)g(COMM,)f(KEYVAL,)h(ATTRIBUTE)p 1017 1195
V 14 w(VAL,)f(IERROR)336 1249 y(LOGICAL)h(FLAG)291 1333
y FA(MPI)p 374 1333 13 2 v 15 w(A)m(TTR)p 508 1333 V
14 w(GET)d(retriev)o(es)h(an)f(attribute)g(v)n(alue)f(b)o(y)h(k)o(ey)m
(.)30 b(The)18 b(call)f(is)h(erroneous)h(if)249 1387
y(there)12 b(is)e(no)g(k)o(ey)g(with)g(v)n(alue)g Fw(k)o(eyval)p
FA(.)18 b(In)10 b(particular)g Fq(MPI)p 1153 1387 12
2 v 13 w(KEYV)m(AL)p 1312 1387 V 12 w(INV)m(ALID)f FA(is)h(an)g
(erroneous)249 1441 y(v)n(alue)k(for)g Fw(k)o(eyval)p
FA(.)22 b(On)15 b(the)g(other)g(hand,)g(the)g(call)f(is)h(correct)h(if)
e(the)h(k)o(ey)g(v)n(alue)f(exists,)h(but)249 1495 y(no)f(attribute)g
(is)f(attac)o(hed)i(on)e Fr(comm)g FA(for)g(that)h(k)o(ey;)f(in)h(suc)o
(h)g(a)g(case,)g(the)g(call)f(returns)i Fr(flag)249 1549
y(=)22 b(false)p FA(.)16 b(If)e(an)f(attribute)h(is)f(attac)o(hed)h(on)
g Fw(comm)d FA(to)i Fw(k)o(eyval)p FA(,)h(then)g(the)h(call)d(returns)j
Fr(flag)249 1603 y(=)22 b(true)p FA(,)12 b(and)i(returns)h(the)g
(attribute)f(v)n(alue)f(in)h Fw(attribute)p 1183 1603
13 2 v 16 w(val)p FA(.)249 1694 y FB(A)n(dvic)n(e)i(to)g(users.)46
b FA(The)15 b(call)g(to)g Fw(MPI)p 879 1694 V 14 w(A)o(ttr)p
964 1694 V 15 w(put)h FA(passes)h(in)e Fw(attribute)p
1378 1694 V 16 w(val)h FA(the)f FB(value)h FA(of)f(the)249
1748 y(attribute;)d(the)h(call)d(to)i Fw(MPI)p 703 1748
V 14 w(A)o(ttr)p 788 1748 V 15 w(get)f FA(passes)i(in)e
Fw(attribute)p 1186 1748 V 17 w(val)g FA(the)h FB(addr)n(ess)g
FA(of)f(the)h(the)g(lo)q(ca-)249 1802 y(tion)i(where)h(the)g(attribute)
g(v)n(alue)e(is)h(to)g(b)q(e)h(returned.)21 b(Th)o(us,)14
b(if)g(the)g(attribute)h(v)n(alue)f(itself)249 1856 y(is)i(a)f(p)q(oin)
o(ter)h(of)f(t)o(yp)q(e)i Fq(void*)p FA(,)d(then)j(the)f(actual)g
Fw(attribute)p 1179 1856 V 16 w(val)g FA(parameter)f(to)h
Fw(MPI)p 1588 1856 V 14 w(A)o(ttr)p 1673 1856 V 15 w(put)249
1910 y FA(will)d(b)q(e)h(of)g(t)o(yp)q(e)g Fq(void*)f
FA(and)h(the)h(actual)e Fw(attribute)p 1052 1910 V 17
w(val)h FA(parameter)f(to)h Fw(MPI)p 1456 1910 V 14 w(A)o(ttr)p
1541 1910 V 15 w(get)g FA(will)f(b)q(e)249 1964 y(of)g(t)o(yp)q(e)i
Fq(void**)p FA(.)i(\()p FB(End)f(of)f(advic)n(e)g(to)g(users.)p
FA(\))249 2056 y FB(R)n(ationale.)42 b FA(The)15 b(use)h(of)e(a)g
(formal)e(parameter)j Fw(attribute)p 1199 2056 V 16 w(val)g
FA(of)f(t)o(yp)q(e)h Fq(void*)f FA(\(rather)h(than)249
2110 y Fq(void**)p FA(\))f(in)h Fw(MPI)p 511 2110 V 14
w(A)o(ttr)p 596 2110 V 15 w(get)g FA(a)o(v)o(oids)f(the)h(messy)g(t)o
(yp)q(e)h(casting)f(that)g(w)o(ould)f(b)q(e)h(needed)i(if)d(the)249
2164 y(attribute)g(is)g(declared)h(with)f(a)f(t)o(yp)q(e)i(other)f
(than)g Fq(void*)p FA(.)j(\()p FB(End)f(of)f(r)n(ationale.)p
FA(\))p eop
%%Page: 237 251
237 250 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(237)249
507 y Fw(MPI)p 326 507 13 2 v 14 w(A)m(TTR)p 448 507
V 15 w(DELETE\(comm,)12 b(k)o(eyval\))332 582 y Fv(IN)158
b Fw(comm)439 b Fv(comm)o(unicator)17 b(to)e(whic)o(h)g(attribute)h(is)
g(at-)1079 636 y(tac)o(hed)332 684 y(IN)158 b Fw(k)o(eyval)441
b Fv(The)13 b(k)o(ey)h(v)n(alue)g(of)f(the)g(deleted)h(attribute)249
795 y Fr(int)21 b(MPI)p 405 795 14 2 v 15 w(Attr)p 508
795 V 15 w(delete\(MPI)p 743 795 V 14 w(Comm)g(comm,)g(int)g(keyval\))
249 879 y(MPI)p 318 879 V 15 w(ATTR)p 421 879 V 15 w(DELETE\(COMM,)e
(KEYVAL,)i(IERROR\))336 932 y(INTEGER)g(COMM,)f(KEYVAL,)h(IERROR)291
1016 y FA(MPI)p 374 1016 13 2 v 15 w(A)m(TTR)p 508 1016
V 14 w(DELETE)10 b(deletes)i(the)f(attribute)g(attac)o(hed)f(to)g(k)o
(ey)h Fw(k)o(eyval)g FA(on)f Fw(comm)p FA(.)15 b(This)249
1070 y(function)j(in)o(v)o(ok)o(es)f(the)i(attribute)f(delete)h
(function)f Fw(delete)p 1212 1070 V 16 w(fn)g FA(sp)q(eci\014ed)i(when)
e(the)h Fw(k)o(eyval)249 1124 y FA(w)o(as)13 b(created.)20
b(The)14 b(call)e(will)g(fail)g(if)g(there)j(is)e(no)h(k)o(ey)f(with)g
(v)n(alue)g Fw(k)o(eyval)h FA(or)f(if)g(the)h Fw(delete)p
1695 1124 V 16 w(fn)249 1178 y FA(function)j(returns)h(an)e(error)i(co)
q(de)g(other)f(than)g Fq(MPI)p 1108 1178 12 2 v 12 w(SUCCESS)p
FA(.)g(On)g(the)h(other)f(hand,)g(the)249 1232 y(call)c(is)h(correct)i
(ev)o(en)e(if)f(no)h(attribute)g(is)g(curren)o(tly)h(attac)o(hed)f(to)g
Fw(k)o(eyval)h FA(on)e Fw(comm)p FA(.)249 1321 y Fs(Example)i(5.12)21
b FA(W)m(e)11 b(come)g(bac)o(k)h(to)f(the)i(co)q(de)f(in)f(Example)f
(5.11.)16 b(Rather)c(than)g(duplicat-)249 1375 y(ing)h(the)i(comm)o
(unicator)d Fw(comm)g FA(at)i(eac)o(h)g(in)o(v)o(o)q(cation,)f(w)o(e)h
(desire)h(to)f(do)g(it)g(once,)h(and)e(store)249 1429
y(the)f(duplicate)g(comm)o(unicator.)i(It)e(w)o(ould)f(b)q(e)h(incon)o
(v)o(enien)o(t)g(to)f(require)i(initialization)c(co)q(de)249
1483 y(that)14 b(duplicates)f(all)g(comm)o(uni)o(cators)f(to)h(b)q(e)h
(used)g(later)g(with)f Fw(mcast)p FA(.)k(F)m(ortunately)m(,)12
b(this)i(is)249 1537 y(not)g(needed.)20 b(Instead,)15
b(w)o(e)f(shall)g(use)h(an)e(initialization)f(co)q(de)j(that)f(allo)q
(cates)g(an)g(attribute)249 1591 y(k)o(ey)g(for)f(the)h(exclusiv)o(e)h
(use)f(of)f Fw(mcast\(\))p FA(.)18 b(This)13 b(k)o(ey)h(can)g(then)g(b)
q(e)g(used)h(to)e(store,)i(with)e(eac)o(h)249 1645 y(comm)o(unicator)d
Fw(comm)p FA(,)h(a)i(priv)n(ate)g(cop)o(y)g(of)g Fw(comm)e
FA(whic)o(h)i(is)g(used)h(b)o(y)f Fw(mcast)p FA(.)k(This)c(cop)o(y)h
(is)249 1699 y(created)h(once)g(at)f(the)g(\014rst)h(in)o(v)o(o)q
(cation)e(of)g Fw(mcast)g FA(with)h(argumen)o(t)e Fw(comm)p
FA(.)249 1807 y Fr(static)21 b(int)g(*extra_state;)215
b(/*)21 b(not)h(used)f(*/)249 1861 y(static)g(void)g(*mcast_key)e(=)j
(MPI_KEYVAL_INVALI)o(D;)707 1914 y(/*)f(attribute)f(key)h(for)g(mcast)
392 b(*/)249 1968 y(int)21 b(mcast_delete_fn\(MPI)o(_Com)o(m)e(comm,)i
(int)g(keyval,)f(void)h(*attr_val,)685 2022 y(void)g(*extra_state\))707
2076 y(/*)g(delete)g(function)f(to)h(be)h(used)f(for)g(mcast_key)f(*/)
707 2130 y(/*)h(attribute.)42 b(The)21 b(callback)f(function)g(frees)43
b(*/)707 2184 y(/*)21 b(the)g(private)g(communicator)e(attached)h(to)
109 b(*/)707 2238 y(/*)21 b(this)g(key)719 b(*/)249 2292
y({)249 2346 y(return)21 b(MPI_Comm_free\(\(M)o(PI_C)o(omm)e
(*\)&attr_val\);)249 2400 y(})249 2508 y(void)i(mcast_init\(\))85
b(/*)21 b(initialization)e(function)h(for)h(mcast.)43
b(It)65 b(*/)p eop
%%Page: 238 252
238 251 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(238)1256 b(Chapter)13 b(5)707
507 y Fr(/*)21 b(should)g(be)g(invoked)f(once)h(by)h(each)f(process)64
b(*/)707 561 y(/*)21 b(before)g(it)g(invokes)f(mcast)392
b(*/)249 615 y({)249 669 y(MPI_Keyval_create\()18 b(MPI_NULL_COPY_FN,)g
(mcast_delete_fn,)663 723 y(&mcast_key,)i(extra_state\);)249
777 y(})249 885 y(void)h(mcast\(void)f(*buff,)g(int)h(count,)g
(MPI_Datatype)e(type,)859 939 y(int)i(isroot,)g(MPI_Comm)f(comm\))249
993 y({)249 1047 y(int)h(size,)g(rank,)g(numleaves,)e(child,)i
(childleaves,)e(flag;)249 1101 y(MPI_Comm)h(pcomm;)249
1155 y(void)h(*attr_val;)249 1209 y(MPI_Status)f(status;)249
1317 y(MPI_Attr_get\(comm,)e(mcast_key,)i(&attr_val,)g(&flag\);)249
1371 y(if)h(\(flag\))239 b(/*)21 b(private)g(communicator)e(cached)326
b(*/)314 1425 y(pcomm)21 b(=)h(\(MPI_Comm\)attr_v)o(al;)249
1479 y(else)f({)305 b(/*)21 b(first)g(invocation;)f(no)h(cached)g
(communicator)41 b(*/)685 1533 y(/*)21 b(create)g(private)f
(communicator)325 b(*/)293 1587 y(MPI_Comm_dup\(com)o(m,)19
b(&pcomm\);)685 1641 y(/*)i(and)g(cache)g(it)654 b(*/)293
1694 y(MPI_Attr_put\(com)o(m,)19 b(mcast_key,)g(pcomm\);)293
1748 y(})249 1856 y(/*)i(continue)g(now)g(as)g(before)g(*/)249
1964 y(MPI_Comm_size\(pcom)o(m,)e(&size\);)249 2018 y
(MPI_Comm_rank\(pcom)o(m,)g(&rank\);)249 2126 y(if)i(\(isroot\))g({)314
2180 y(numleaves)f(=)i(size-1;)314 2234 y(})249 2288
y(else)f({)358 2342 y(/*)g(receive)g(from)g(parent)f(leaf)h(count)g
(and)g(message)g(*/)314 2396 y(MPI_RECV\(&numleaves,)d(1,)j(MPI_INT,)g
(MPI_ANY_SOURCE,)d(0,)k(pcomm,)e(&status\);)314 2450
y(MPI_RECV\(buff,)f(count,)i(type,)g(MPI_ANY_SOURCE,)d(0,)k(pcomm,)e
(&status\);)314 2504 y(})p eop
%%Page: 239 253
239 252 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(239)249
507 y Fr(while)21 b(\(numleaves)f(>)h(0\))h({)336 561
y(/*)g(pick)f(child)f(in)i(middle)e(of)i(current)e(leaf)h(processes)f
(*/)314 615 y(child)h(=)h(mod\(rank)e(+)i(\(numleaves+1\)/2)o(,)d
(size\);)314 669 y(childleaves)h(=)i(numleaves/2;)314
723 y(/*)g(send)f(to)g(child)g(leaf)g(count)g(and)g(message)f(*/)314
777 y(MPI_SEND\(&childleave)o(s,)f(1,)i(MPI_INT,)f(child,)h(0,)g
(pcomm\);)314 831 y(MPI_SEND\(buff,)e(count,)i(type,)g(child,)f(0,)i
(pcomm\);)314 885 y(/*)g(compute)e(remaining)g(number)h(of)g(leaves)g
(*/)314 939 y(numleaves)f(-=)i(\(childleaves+1\);)314
993 y(})249 1047 y(})291 1196 y FA(The)12 b(co)q(de)h(ab)q(o)o(v)o(e)f
(dedicates)h(a)f(statically)f(allo)q(cated)h(priv)n(ate)g(comm)o
(unicator)d(for)j(the)h(use)249 1250 y(of)j Fw(mcast)p
FA(.)24 b(This)16 b(segregates)h(comm)o(unication)c(within)i(the)i
(library)f(from)e(comm)o(unicatio)o(n)249 1304 y(outside)j(the)h
(library)m(.)27 b(Ho)o(w)o(ev)o(er,)17 b(this)g(approac)o(h)h(do)q(es)f
(not)g(pro)o(vide)g(separation)g(of)g(com-)249 1358 y(m)o(unications)f
(b)q(elonging)g(to)h(distinct)h(in)o(v)o(o)q(cations)f(of)g(the)h(same)
e(library)h(function,)h(since)249 1412 y(they)f(all)f(use)h(the)g(same)
f(comm)o(unication)d(domain.)24 b(Consider)17 b(t)o(w)o(o)g(successiv)o
(e)h(collectiv)o(e)249 1466 y(in)o(v)o(o)q(cations)12
b(of)g Fw(mcast)f FA(b)o(y)i(four)f(pro)q(cesses,)j(where)f(pro)q(cess)
g(0)e(is)h(the)g(broadcast)g(ro)q(ot)g(in)f(the)249 1520
y(\014rst)j(one,)f(and)g(pro)q(cess)i(3)e(is)g(the)h(ro)q(ot)f(in)g
(the)h(second)g(one.)k(The)c(in)o(tended)g(execution)g(and)249
1574 y(comm)o(unication)10 b(\015o)o(w)k(for)g(these)h(t)o(w)o(o)e(in)o
(v)o(o)q(cations)g(is)h(illustrated)g(in)f(Figure)h(5.6.)291
1628 y(Ho)o(w)o(ev)o(er,)g(there)h(is)f(a)g(race)h(b)q(et)o(w)o(een)h
(messages)e(sen)o(t)h(b)o(y)f(the)h(\014rst)g(in)o(v)o(o)q(cation)e(of)
h Fw(mcast)p FA(,)249 1682 y(from)f(pro)q(cess)j(0)e(to)g(pro)q(cess)i
(1,)e(and)g(messages)h(sen)o(t)g(b)o(y)f(the)h(second)h(in)o(v)o(o)q
(cation)d(of)h Fw(mcast)p FA(,)249 1736 y(from)e(pro)q(cess)j(3)d(to)h
(pro)q(cess)i(1.)j(The)c(erroneous)g(execution)g(illustrated)f(in)g
(Figure)g(5.7)f(ma)o(y)249 1790 y(o)q(ccur,)k(where)g(messages)f(sen)o
(t)h(b)o(y)f(second)h(in)o(v)o(o)q(cation)e(o)o(v)o(ertak)o(e)h
(messages)h(from)d(the)j(\014rst)249 1844 y(in)o(v)o(o)q(cation.)h
(This)d(phenomenon)f(is)h(kno)o(wn)f(as)h FB(b)n(ackmasking)p
FA(.)291 1898 y(Ho)o(w)k(can)h(w)o(e)h(a)o(v)o(oid)d(bac)o(kmasking?)32
b(One)19 b(option)g(is)f(to)h(rev)o(ert)i(to)d(the)i(approac)o(h)f(in)
249 1952 y(Example)12 b(5.11,)f(where)j(a)f(separate)h(comm)o
(unication)c(domain)g(is)j(generated)i(for)d(eac)o(h)i(in)o(v)o(o-)249
2006 y(cation.)22 b(Another)16 b(option)f(is)g(to)h(add)f(a)g(barrier)h
(sync)o(hronization,)f(either)h(at)f(the)h(en)o(try)g(or)249
2060 y(at)e(the)h(exit)f(from)e(the)i(library)g(call.)j(Y)m(et)e
(another)f(option)f(is)h(to)g(rewrite)h(the)g(library)e(co)q(de,)249
2114 y(so)i(as)g(to)g(prev)o(en)o(t)g(the)h(nondeterministic)e(race.)22
b(The)15 b(race)g(o)q(ccurs)i(b)q(ecause)f(receiv)o(es)h(with)249
2168 y(don)o(tcare's)g(are)f(used.)26 b(It)17 b(is)f(often)g(p)q
(ossible)g(to)g(a)o(v)o(oid)f(the)i(use)g(of)f(suc)o(h)g(constructs.)27
b(Un-)249 2222 y(fortunately)m(,)12 b(a)o(v)o(oiding)g(don)o(tcares)i
(leads)g(to)f(a)g(less)h(e\016cien)o(t)g(implem)o(en)o(tation)d(of)h
Fw(mcast)p FA(.)17 b(A)249 2276 y(p)q(ossible)c(alternativ)o(e)g(is)g
(to)f(use)i(increasing)f(tag)g(n)o(um)o(b)q(ers)f(to)h(disam)o(biguate)
e(successiv)o(e)k(in-)249 2330 y(v)o(o)q(cations)d(of)g
Fw(mcast)p FA(.)k(An)d(\\in)o(v)o(o)q(cation)d(coun)o(t")j(can)f(b)q(e)
h(cac)o(hed)g(with)f(eac)o(h)h(comm)o(unicator,)249 2384
y(as)h(an)g(additional)e(library)h(attribute.)18 b(The)d(resulting)f
(co)q(de)g(is)g(sho)o(wn)g(b)q(elo)o(w.)p eop
%%Page: 240 254
240 253 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(240)1256 b(Chapter)13 b(5)328
564 y
 21313290 11935437 0 0 39666401 22563143 startTexFig
 328 564 a
%%BeginDocument: ../figures/context-maskgood.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-36.0 364.0 translate 0.900 -0.900 scale
1.000 setlinewidth
	[6.000000] 0 setdash
% Polyline
n 151 69 m 139 69 139 187 12 arcto 4 {pop} repeat 139 199 697 199 12 arcto 4 {pop} repeat 709 199 709 81 12 arcto 4 {pop} repeat 709 69 151 69 12 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash
	1 setlinecap [1 4.500000] 4.500000 setdash
% Polyline
n 151 224 m 139 224 139 342 12 arcto 4 {pop} repeat 139 354 697 354 12 arcto 4 {pop} repeat 709 354 709 236 12 arcto 4 {pop} repeat 709 224 151 224 12 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
% Polyline
n 214 94 m 474 94 l gs col-1 s gr
n 458.000 90.000 m 474.000 94.000 l 458.000 98.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 214 144 m 314 144 l gs col-1 s gr
n 298.000 140.000 m 314.000 144.000 l 298.000 148.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 534 144 m 634 144 l gs col-1 s gr
n 618.000 140.000 m 634.000 144.000 l 618.000 148.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 374 304 m 474 304 l gs col-1 s gr
n 458.000 300.000 m 474.000 304.000 l 458.000 308.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 214 169 m 314 169 l gs col-1 s gr
n 298.000 165.000 m 314.000 169.000 l 298.000 173.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 214 119 m 474 119 l gs col-1 s gr
n 458.000 115.000 m 474.000 119.000 l 458.000 123.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 534 169 m 634 169 l gs col-1 s gr
n 618.000 165.000 m 634.000 169.000 l 618.000 173.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 374 329 m 474 329 l gs col-1 s gr
n 458.000 325.000 m 474.000 329.000 l 458.000 333.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 634 254 m 374 254 l gs col-1 s gr
n 390.000 258.000 m 374.000 254.000 l 390.000 250.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 634 299 m 499 374 l  314 374 l  214 314 l gs col-1 s gr
n 225.662 325.662 m 214.000 314.000 l 229.778 318.802 l gs 2 setlinejoin col-1 s gr
% Polyline
n 634 279 m 374 279 l gs col-1 s gr
n 390.000 283.000 m 374.000 279.000 l 390.000 275.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 634 329 m 499 404 l  314 404 l  214 344 l gs col-1 s gr
n 225.662 355.662 m 214.000 344.000 l 229.778 348.802 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
159 44 m 
gs 1 -1 scale (Process 0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 44 m 
gs 1 -1 scale (Process 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 44 m 
gs 1 -1 scale (Process 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 44 m 
gs 1 -1 scale (Process 3) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 99 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 124 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 149 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 174 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 99 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 124 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 149 m 
gs 1 -1 scale (Send 3) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 174 m 
gs 1 -1 scale (Send 3) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
39 139 m 
gs 1 -1 scale (First call) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 259 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 284 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 309 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 334 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 314 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 339 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 259 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 284 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 309 m 
gs 1 -1 scale (Send 0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 334 m 
gs 1 -1 scale (Send 0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
39 304 m 
gs 1 -1 scale (Second call) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 149 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 174 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 149 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 174 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 309 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 334 m 
gs 1 -1 scale (Recv *) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1382 a Fo(Figure)g(5.6)249 1419 y Fz(Correct)e(execution)d(of)k(t)
o(w)o(o)f(successiv)o(e)e(in)o(v)o(o)q(cations)g(of)i
Fw(mcast)328 1649 y
 21313290 10443504 0 0 39666401 19602964 startTexFig
 328 1649 a
%%BeginDocument: ../figures/context-maskbad.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-36.0 319.0 translate 0.900 -0.900 scale
1.000 setlinewidth
	[6.000000] 0 setdash
% Polyline
n 151 69 m 139 69 139 187 12 arcto 4 {pop} repeat 139 199 697 199 12 arcto 4 {pop} repeat 709 199 709 81 12 arcto 4 {pop} repeat 709 69 151 69 12 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash
	1 setlinecap [1 4.500000] 4.500000 setdash
% Polyline
n 151 224 m 139 224 139 342 12 arcto 4 {pop} repeat 139 354 697 354 12 arcto 4 {pop} repeat 709 354 709 236 12 arcto 4 {pop} repeat 709 224 151 224 12 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
% Polyline
n 214 94 m 474 94 l gs col-1 s gr
n 458.000 90.000 m 474.000 94.000 l 458.000 98.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 534 144 m 634 144 l gs col-1 s gr
n 618.000 140.000 m 634.000 144.000 l 618.000 148.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 214 119 m 474 119 l gs col-1 s gr
n 458.000 115.000 m 474.000 119.000 l 458.000 123.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 534 169 m 634 169 l gs col-1 s gr
n 618.000 165.000 m 634.000 169.000 l 618.000 173.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 634 249 m 374 149 l gs col-1 s gr
n 387.498 158.477 m 374.000 149.000 l 390.369 151.010 l gs 2 setlinejoin col-1 s gr
% Polyline
n 214 144 m 314 249 l gs col-1 s gr
n 305.862 234.655 m 314.000 249.000 l 300.069 240.172 l gs 2 setlinejoin col-1 s gr
% Polyline
n 214 168 m 314 273 l gs col-1 s gr
n 305.862 258.655 m 314.000 273.000 l 300.069 264.172 l gs 2 setlinejoin col-1 s gr
% Polyline
n 634 273 m 374 173 l gs col-1 s gr
n 387.498 182.477 m 374.000 173.000 l 390.369 175.010 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
159 44 m 
gs 1 -1 scale (Process 0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 44 m 
gs 1 -1 scale (Process 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 44 m 
gs 1 -1 scale (Process 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 44 m 
gs 1 -1 scale (Process 3) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 99 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 124 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 149 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 174 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 99 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 124 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 149 m 
gs 1 -1 scale (Send 3) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 174 m 
gs 1 -1 scale (Send 3) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
39 139 m 
gs 1 -1 scale (First call) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 259 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 284 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 309 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 334 m 
gs 1 -1 scale (Send 2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 314 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
159 339 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 259 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 284 m 
gs 1 -1 scale (Send 1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 309 m 
gs 1 -1 scale (Send 0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 334 m 
gs 1 -1 scale (Send 0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
39 304 m 
gs 1 -1 scale (Second call) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 149 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
319 174 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 149 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 174 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 309 m 
gs 1 -1 scale (Recv *) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 334 m 
gs 1 -1 scale (Recv *) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 2373 a Fo(Figure)i(5.7)249 2410 y Fz(Erroneous)c(execution)g(of)i
(t)o(w)o(o)h(successiv)o(e)d(in)o(v)o(o)q(cations)g(of)i
Fw(mcast)p eop
%%Page: 241 255
241 254 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(241)249
507 y Fs(Example)15 b(5.13)21 b FA(Co)q(de)e(in)g(previous)g(example)f
(is)h(mo)q(di\014ed,)f(to)h(prev)o(en)o(t)h(bac)o(kmasking:)249
561 y(successiv)o(e)c(in)o(v)o(o)q(cations)d(of)g Fw(mcast)h
FA(with)f(the)i(same)e(comm)o(unicator)e(use)j(distinct)h(tags.)249
669 y Fr(static)21 b(int)g(*extra_state;)193 b(/*)22
b(not)f(used)g(*/)249 723 y(static)g(void)g(*mcast_key)e(=)j
(MPI_KEYVAL_INVALI)o(D;)249 777 y(typedef)42 b(struct)21
b({)196 b(/*)21 b(mcast)g(attribute)f(structure)g(*/)380
831 y(MPI_Comm)g(pcomm;)108 b(/*)21 b(private)f(communicator)129
b(*/)380 885 y(int)21 b(invcount;)151 b(/*)21 b(invocation)f(count)217
b(*/)380 939 y(})21 b(Mcast_attr;)249 1047 y(int)g
(mcast_delete_fn\(MPI)o(_Com)o(m)e(comm,)i(int)g(keyval,)f(void)h
(*attr_val,)685 1101 y(void)g(*extra_state\))249 1155
y({)249 1209 y(MPI_Comm_free\(&\(\(M)o(cast_)o(attr)d
(*\)attr_val\)->pcomm\))o(;)249 1263 y(free\(attr_val\);)249
1317 y(})249 1425 y(void)j(mcast_init\(\))85 b(/*)21
b(initialization)e(function)h(for)h(mcast.)152 b(*/)249
1479 y({)249 1533 y(MPI_Keyval_create\()18 b(MPI_NULL_COPY_FN,)g
(mcast_delete_fn,)663 1587 y(&mcast_key,)i(extra_state\);)249
1641 y(})249 1748 y(void)h(mcast\(void)f(*buff,)g(int)h(count,)g
(MPI_Datatype)e(type,)881 1802 y(int)i(isroot,)g(MPI_Comm)f(comm\))249
1856 y({)249 1910 y(int)h(size,)g(rank,)g(numleaves,)e(child,)i
(childleaves,)e(flag,)i(tag;)249 1964 y(MPI_Comm)f(pcomm;)249
2018 y(void)h(*attr_val;)249 2072 y(Mcast_attr)f(*attr_struct;)249
2126 y(MPI_Status)g(status;)249 2234 y(MPI_Attr_get\(comm,)e
(mcast_key,)i(&attr_val,)g(&flag\);)249 2288 y(if)h(\(flag\))g({)196
b(/*)21 b(attribute)42 b(cached)522 b(*/)336 2342 y(attr_struct)20
b(=)h(\(Mcast_attr)f(*\)attr_val;)336 2396 y(pcomm)h(=)h
(attr_struct->pc)o(omm;)336 2450 y(tag)f(=)h(++attr_struct->in)o(vcoun)
o(t;)314 2504 y(})p eop
%%Page: 242 256
242 255 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(242)1256 b(Chapter)13 b(5)249
507 y Fr(else)21 b({)305 b(/*)21 b(first)g(invocation;)f(no)h(cached)g
(communicator)41 b(*/)685 561 y(/*)21 b(create)g(private)f
(communicator)325 b(*/)314 615 y(MPI_Comm_dup\(comm,)19
b(&pcomm\);)685 669 y(/*)i(create)g(attribute)f(structure)347
b(*/)314 723 y(attr_struct)20 b(=)i(\(Mcast_attr)d
(*\)malloc\(sizeof\(Mc)o(ast_a)o(ttr\))o(\);)314 777
y(attr_struct->pcomm)g(=)i(pcomm;)314 831 y(attr_struct->invcoun)o(t)e
(=)i(0;)314 885 y(MPI_Attr_put\(comm,)e(mcast_key,)g(attr_struct\);)293
939 y(})249 1047 y(/*)i(broadcast)f(code,)h(using)g(tag)108
b(*/)249 1155 y(MPI_Comm_size\(pcom)o(m,)19 b(&size\);)249
1209 y(MPI_Comm_rank\(pcom)o(m,)g(&rank\);)249 1317 y(if)i(\(isroot\))g
({)314 1371 y(numleaves)f(=)i(size-1;)314 1425 y(})249
1479 y(else)f({)358 1533 y(/*)g(receive)g(from)g(parent)f(leaf)h(count)
g(and)g(message)g(*/)314 1587 y(MPI_RECV\(&numleaves,)d(1,)j(MPI_INT,)g
(MPI_ANY_SOURCE,)d(tag,)j(pcomm,)g(&status\);)314 1641
y(MPI_RECV\(buff,)e(count,)i(type,)g(MPI_ANY_SOURCE,)d(tag,)j(pcomm,)g
(&status\);)314 1694 y(})249 1748 y(while)g(\(numleaves)f(>)h(0\))h({)
336 1802 y(/*)g(pick)f(child)f(in)i(middle)e(of)i(current)e(leaf)h
(processes)f(*/)314 1856 y(child)h(=)h(mod\(rank)e(+)i
(\(numleaves+1\)/2)o(,)d(size\);)314 1910 y(childleaves)h(=)i
(numleaves/2;)314 1964 y(/*)g(send)f(to)g(child)g(leaf)g(count)g(and)g
(message)f(*/)314 2018 y(MPI_SEND\(&childleave)o(s,)f(1,)i(MPI_INT,)f
(child,)h(0,)g(pcomm\);)314 2072 y(MPI_SEND\(buff,)e(count,)i(type,)g
(child,)f(0,)i(pcomm\);)314 2126 y(/*)g(compute)e(remaining)g(number)h
(of)g(leaves)g(*/)314 2180 y(numleaves)f(-=)i(\(childleaves+1\);)314
2234 y(})249 2288 y(})p eop
%%Page: 243 257
243 256 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(243)249
507 y FD(5.7)52 b(In)o(tercomm)o(unication)249 615 y
Fs(5.7.1)c(In)o(tro)q(duction)249 698 y FA(This)14 b(section)g(in)o
(tro)q(duces)h(the)f(concept)h(of)e(in)o(ter-comm)o(unicatio)o(n)e(and)
i(describ)q(es)j(the)e(p)q(or-)249 752 y(tions)g(of)f
Fw(MPI)g FA(that)h(supp)q(ort)h(it.)291 806 y(All)i(p)q(oin)o(t-to-p)q
(oin)o(t)g(comm)o(unicatio)o(n)f(describ)q(ed)k(th)o(us)e(far)g(has)h
(in)o(v)o(olv)o(ed)e(comm)o(uni)o(ca-)249 860 y(tion)j(b)q(et)o(w)o
(een)i(pro)q(cesses)h(that)e(are)g(mem)o(b)q(ers)e(of)h(the)i(same)d
(group.)38 b(In)21 b(mo)q(dular)e(and)249 914 y(m)o(ulti-disciplina)o
(ry)d(applications,)h(di\013eren)o(t)i(pro)q(cess)g(groups)g(execute)g
(distinct)f(mo)q(dules)249 968 y(and)12 b(pro)q(cesses)i(within)d
(di\013eren)o(t)i(mo)q(dules)e(comm)o(unicate)f(with)h(one)h(another)h
(in)e(a)h(pip)q(eline)249 1022 y(or)k(a)f(more)g(general)h(mo)q(dule)e
(graph.)24 b(In)16 b(these)h(applications,)d(the)j(most)d(natural)i(w)o
(a)o(y)f(for)249 1076 y(a)i(pro)q(cess)h(to)f(sp)q(ecify)h(a)e(p)q(eer)
i(pro)q(cess)h(is)e(b)o(y)g(the)g(rank)g(of)f(the)i(p)q(eer)g(pro)q
(cess)h(within)d(the)249 1130 y(p)q(eer)d(group.)k(In)12
b(applications)e(that)i(con)o(tain)f(in)o(ternal)g(user-lev)o(el)h
(serv)o(ers,)h(eac)o(h)f(serv)o(er)h(ma)o(y)249 1184
y(b)q(e)k(a)g(pro)q(cess)i(group)d(that)h(pro)o(vides)g(services)i(to)d
(one)h(or)g(more)f(clien)o(ts,)h(and)g(eac)o(h)g(clien)o(t)249
1238 y(ma)o(y)d(b)q(e)i(a)g(pro)q(cess)i(group)d(that)h(uses)h(the)g
(services)g(of)f(one)g(or)f(more)g(serv)o(ers.)26 b(It)16
b(is)g(again)249 1292 y(most)g(natural)h(to)g(sp)q(ecify)h(the)g(p)q
(eer)h(pro)q(cess)g(b)o(y)e(rank)g(within)f(the)i(p)q(eer)h(group)e(in)
g(these)249 1346 y(applications.)291 1400 y(An)10 b(in)o(ter-group)g
(comm)o(uni)o(cation)d(domain)h(is)i(sp)q(eci\014ed)h(b)o(y)f(a)f(set)i
(of)f(in)o(tercomm)o(unicators)249 1454 y(with)k(the)g(pair)g(of)f
(disjoin)o(t)g(groups)h Fw(\(A,B\))f FA(as)h(their)g(attribute,)g(suc)o
(h)h(that)208 1537 y Ft(\017)20 b FA(their)c(links)g(form)e(a)h
(bipartite)h(graph:)22 b(eac)o(h)16 b(comm)o(unicator)d(at)j(a)f(pro)q
(cess)j(in)d(group)h Fw(A)g FA(is)249 1591 y(link)o(ed)d(to)h(all)f
(comm)o(unicators)e(at)j(pro)q(cesses)i(in)e(group)g
Fw(B)p FA(,)f(and)g(vice-v)o(ersa;)h(and)208 1661 y Ft(\017)20
b FA(links)c(ha)o(v)o(e)g(consisten)o(t)h(indices:)23
b(at)16 b(eac)o(h)h(comm)o(unicator)c(at)k(a)f(pro)q(cess)i(in)d(group)
h Fw(A)p FA(,)g(the)249 1715 y Fw(i)p FA(-th)e(link)f(p)q(oin)o(ts)g
(to)h(the)h(comm)o(unicator)c(for)i(pro)q(cess)j Fw(i)e
FA(in)f(group)h Fw(B)p FA(;)f(and)h(vice-v)o(ersa.)291
1798 y(This)f(distributed)i(data)e(structure)j(is)e(illustrated)f(in)g
(Figure)h(5.8,)f(for)g(the)h(case)h(of)e(a)h(pair)249
1852 y(of)c(groups)i Fw(\(A,B\))p FA(,)d(with)i(t)o(w)o(o)f(\(upp)q(er)
j(b)q(o)o(x\))d(and)h(three)i(\(lo)o(w)o(er)d(b)q(o)o(x\))h(pro)q
(cesses,)j(resp)q(ectiv)o(ely)m(.)291 1960 y(The)20 b(comm)o(unicator)d
(structure)22 b(distinguishes)e(b)q(et)o(w)o(een)h(a)f
FB(lo)n(c)n(al)f FA(group,)i(namely)d(the)249 2014 y(group)9
b(con)o(taining)g(the)h(pro)q(cess)h(where)g(the)f(structure)h(reside,)
g(and)e(a)h FB(r)n(emote)e FA(group,)i(namely)249 2068
y(the)15 b(other)g(group.)40 b(The)15 b(structure)i(is)d(symmetric:)k
(for)c(pro)q(cesses)j(in)d(group)h Fw(A)p FA(,)e(then)i
Fw(A)g FA(is)249 2122 y(the)g(lo)q(cal)e(group)h(and)g
Fw(B)g FA(is)g(the)h(remote)e(group,)h(whereas)h(for)f(pro)q(cesses)j
(in)c(group)h Fw(B)p FA(,)g(then)249 2176 y Fw(B)g FA(is)f(the)i(lo)q
(cal)e(group)h(and)f Fw(A)h FA(is)g(the)g(remote)f(group.)291
2230 y(An)k(in)o(ter-group)g(comm)o(uni)o(cation)d(will)i(in)o(v)o(olv)
o(e)f(a)i(pro)q(cess)i(in)d(one)h(group)g(executing)h(a)249
2284 y(send)h(call)e(and)h(another)h(pro)q(cess,)h(in)e(the)h(other)g
(group,)f(executing)h(a)f(matc)o(hing)e(receiv)o(e)249
2338 y(call.)21 b(As)16 b(in)f(in)o(tra-group)g(comm)o(uni)o(cation,)d
(the)k(matc)o(hing)e(pro)q(cess)j(\(destination)e(of)g(send)249
2392 y(or)i(source)h(of)e(receiv)o(e\))i(is)e(sp)q(eci\014ed)j(using)d
(a)g Fw(\(communicato)o(r,)g(rank\))i FA(pair.)26 b(Unlik)o(e)16
b(in)o(tra-)249 2446 y(group)g(comm)o(unicati)o(on,)d(the)j(rank)g(is)g
(relativ)o(e)f(to)h(the)g(second,)h(remote)e(group.)24
b(Th)o(us,)16 b(in)249 2500 y(the)f(comm)o(unication)d(domain)g
(illustrated)i(in)h(Figure)f(5.8,)g(pro)q(cess)i(1)f(in)f(group)g
Fw(A)h FA(sends)h(a)p eop
%%Page: 244 258
244 257 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(244)1256 b(Chapter)13 b(5)478
466 y
 16577003 6796570 0 0 46113013 18945146 startTexFig
 478 466 a
%%BeginDocument: ../figures/context-intercomm.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
 /DrawEllipse {
	/endangle exch def
	/startangle exch def
	/yrad exch def
	/xrad exch def
	/y exch def
	/x exch def
	/savematrix mtrx currentmatrix def
	x y translate xrad yrad scale 0 0 1 startangle endangle arc
	savematrix setmatrix
	} def

	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-59.0 387.0 translate 0.900 -0.900 scale
1.000 setlinewidth
% Ellipse
n 259 371 21 22 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 518 371 21 22 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 700 371 21 22 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 779 371 21 22 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 180 168 21 21 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 780 168 21 21 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 620 168 21 21 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 699 170 21 21 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 259 169 21 21 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 339 169 21 21 0 360 DrawEllipse gs col-1 s gr
% Ellipse
n 440 371 21 22 0 360 DrawEllipse gs col-1 s gr
% Polyline
n 146 329 m 139 329 139 402 7 arcto 4 {pop} repeat 139 409 292 409 7 arcto 4 {pop} repeat 299 409 299 336 7 arcto 4 {pop} repeat 299 329 146 329 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 406 329 m 399 329 399 402 7 arcto 4 {pop} repeat 399 409 552 409 7 arcto 4 {pop} repeat 559 409 559 336 7 arcto 4 {pop} repeat 559 329 406 329 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 666 329 m 659 329 659 402 7 arcto 4 {pop} repeat 659 409 812 409 7 arcto 4 {pop} repeat 819 409 819 336 7 arcto 4 {pop} repeat 819 329 666 329 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 179 189 m 159 329 l gs col-1 s gr
n 165.223 313.726 m 159.000 329.000 l 157.303 312.595 l gs 2 setlinejoin col-1 s gr
% Polyline
n 439 349 m 259 209 l gs col-1 s gr
n 269.174 221.980 m 259.000 209.000 l 274.085 215.666 l gs 2 setlinejoin col-1 s gr
% Polyline
n 699 349 m 339 209 l gs col-1 s gr
n 352.462 218.527 m 339.000 209.000 l 355.362 211.071 l gs 2 setlinejoin col-1 s gr
% Polyline
n 258 191 m 439 329 l gs col-1 s gr
n 428.702 316.118 m 439.000 329.000 l 423.851 322.480 l gs 2 setlinejoin col-1 s gr
% Polyline
n 339 189 m 699 329 l gs col-1 s gr
n 685.538 319.473 m 699.000 329.000 l 682.638 326.929 l gs 2 setlinejoin col-1 s gr
% Polyline
n 619 189 m 259 329 l gs col-1 s gr
n 275.362 326.929 m 259.000 329.000 l 272.462 319.473 l gs 2 setlinejoin col-1 s gr
% Polyline
n 259 349 m 619 209 l gs col-1 s gr
n 602.638 211.071 m 619.000 209.000 l 605.538 218.527 l gs 2 setlinejoin col-1 s gr
% Polyline
n 698 191 m 519 329 l gs col-1 s gr
n 534.114 322.399 m 519.000 329.000 l 529.229 316.063 l gs 2 setlinejoin col-1 s gr
% Polyline
n 519 349 m 699 209 l gs col-1 s gr
n 683.915 215.666 m 699.000 209.000 l 688.826 221.980 l gs 2 setlinejoin col-1 s gr
% Polyline
n 779 349 m 759 209 l gs col-1 s gr
n 757.303 225.405 m 759.000 209.000 l 765.223 224.274 l gs 2 setlinejoin col-1 s gr
% Ellipse
n 180 371 21 22 0 360 DrawEllipse gs col-1 s gr
% Polyline
n 779 189 m 799 329 l gs col-1 s gr
n 800.697 312.595 m 799.000 329.000 l 792.777 313.726 l gs 2 setlinejoin col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
65 178 m 
gs 1 -1 scale (A) col-1 show gr
	1 setlinecap [1 4.500000] 4.500000 setdash
% Polyline
n 116 109 m 109 109 109 237 7 arcto 4 {pop} repeat 109 244 837 244 7 arcto 4 {pop} repeat 844 244 844 116 7 arcto 4 {pop} repeat 844 109 116 109 7 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
	1 setlinecap [1 4.500000] 4.500000 setdash
% Polyline
n 116 294 m 109 294 109 422 7 arcto 4 {pop} repeat 109 429 837 429 7 arcto 4 {pop} repeat 844 429 844 301 7 arcto 4 {pop} repeat 844 294 116 294 7 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
% Polyline
n 179 349 m 199 209 l gs col-1 s gr
n 192.777 224.274 m 199.000 209.000 l 200.697 225.405 l gs 2 setlinejoin col-1 s gr
% Polyline
n 146 129 m 139 129 139 202 7 arcto 4 {pop} repeat 139 209 372 209 7 arcto 4 {pop} repeat 379 209 379 136 7 arcto 4 {pop} repeat 379 129 146 129 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 586 129 m 579 129 579 202 7 arcto 4 {pop} repeat 579 209 812 209 7 arcto 4 {pop} repeat 819 209 819 136 7 arcto 4 {pop} repeat 819 129 586 129 7 arcto 4 {pop} repeat clp gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
119 369 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
379 369 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
639 369 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
119 169 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
559 169 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
336 172 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
256 172 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
177 171 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
178 375 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
257 374 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
438 374 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
516 375 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
618 171 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
697 173 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
698 373 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
778 171 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
776 375 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
66 377 m 
gs 1 -1 scale (B) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 959 a Fo(Figure)g(5.8)249 996 y Fz(Distributed)c(data)h(structure)
g(for)g(in)o(ter-comm)o(un)o(ica)o(tio)o(n)f(domain.)249
1112 y FA(message)17 b(to)g(pro)q(cess)i(2)e(in)g(group)g
Fw(B)g FA(with)f(a)h(call)g Fw(MPI)p 1162 1112 13 2 v
14 w(SEND\()p Fp(:)7 b(:)g(:)f Fw(,)17 b(2,)h(tag,)f(comm\))p
FA(;)g(pro-)249 1166 y(cess)g(2)e(in)f(group)h Fw(B)g
FA(receiv)o(es)i(this)e(message)g(with)g(a)f(call)h Fw(MPI)p
1264 1166 V 14 w(RECV\()p Fp(:)7 b(:)g(:)t Fw(,)15 b(1,)g(tag,)g
(comm\))p FA(.)249 1220 y(Con)o(v)o(ersely)m(,)k(pro)q(cess)h(2)e(in)f
(group)h Fw(B)g FA(sends)i(a)d(message)h(to)g(pro)q(cess)i(1)e(in)g
(group)g Fw(A)g FA(with)249 1274 y(a)f(call)f(to)g Fw(MPI)p
496 1274 V 15 w(SEND\()p Fp(:)7 b(:)g(:)e Fw(,)18 b(1,)e(tag,)h(comm\))
p FA(,)f(and)g(the)i(message)e(is)h(receiv)o(ed)h(b)o(y)f(a)f(call)h
(to)249 1328 y Fw(MPI)p 326 1328 V 14 w(RECV\()p Fp(:)7
b(:)g(:)e Fw(,)16 b(2,)f(tag,)h(comm\))p FA(;)f(a)h(remote)f(pro)q
(cess)j(is)e(iden)o(ti\014ed)g(in)g(the)g(same)f(w)o(a)o(y)h(for)249
1382 y(the)h(purp)q(oses)g(of)e(sending)h(or)g(receiving.)24
b(All)15 b(p)q(oin)o(t-to-p)q(oin)o(t)g(comm)o(unicatio)o(n)e
(functions)249 1436 y(can)h(b)q(e)h(used)f(with)g(in)o(tercomm)o
(unicators)e(for)h(in)o(ter-group)h(comm)o(unication.)291
1490 y(Here)f(is)e(a)h(summary)d(of)j(the)g(prop)q(erties)h(of)f(in)o
(ter-group)f(comm)o(unication)e(and)j(in)o(tercom-)249
1544 y(m)o(unicators:)249 1627 y Ft(\017)29 b FA(The)13
b(syn)o(tax)g(of)f(p)q(oin)o(t-to-p)q(oin)o(t)g(comm)o(uni)o(cation)e
(is)j(the)g(same)f(for)h(b)q(oth)f(in)o(ter-)h(and)g(in)o(t-)249
1681 y(ra-comm)o(unicatio)o(n.)30 b(The)19 b(same)f(comm)o(unicator)e
(can)j(b)q(e)h(used)f(b)q(oth)g(for)g(send)g(and)g(for)249
1735 y(receiv)o(e)c(op)q(erations.)249 1789 y Ft(\017)29
b FA(A)17 b(target)g(pro)q(cess)i(is)e(addressed)h(b)o(y)f(its)g(rank)g
(in)f(the)i(remote)e(group,)i(b)q(oth)f(for)f(sends)249
1843 y(and)e(for)f(receiv)o(es.)249 1897 y Ft(\017)29
b FA(Comm)o(uni)o(cations)8 b(using)j(an)f(in)o(tercomm)o(unicator)f
(are)i(guaran)o(teed)g(not)g(to)g(con\015ict)g(with)249
1951 y(an)o(y)i(comm)o(unications)e(that)j(use)h(a)f(di\013eren)o(t)g
(comm)o(unicator.)249 2005 y Ft(\017)29 b FA(An)14 b(in)o(tercomm)o
(unicator)d(cannot)j(b)q(e)h(used)g(for)e(collectiv)o(e)h(comm)o
(unication.)249 2059 y Ft(\017)29 b FA(A)14 b(comm)o(unicator)d(will)h
(pro)o(vide)i(either)h(in)o(tra-)e(or)h(in)o(ter-comm)o(unication,)c
(nev)o(er)15 b(b)q(oth.)249 2142 y(The)c(routine)f Fw(MPI)p
547 2142 V 14 w(COMM)p 691 2142 V 15 w(TEST)p 810 2142
V 15 w(INTER)g FA(ma)o(y)e(b)q(e)j(used)g(to)f(determine)g(if)f(a)h
(comm)o(unicator)249 2196 y(is)15 b(an)g(in)o(ter-)h(or)f(in)o(tracomm)
o(uni)o(cator.)20 b(In)o(tercomm)o(unicators)13 b(can)j(b)q(e)g(used)g
(as)f(argumen)o(ts)249 2250 y(to)j(some)f(of)h(the)g(other)h(comm)o
(unicator)c(access)20 b(routines.)31 b(In)o(tercomm)o(unicators)16
b(cannot)249 2303 y(b)q(e)h(used)g(as)f(input)g(to)f(some)g(of)h(the)h
(constructor)g(routines)g(for)e(in)o(tracomm)o(unicators)f(\(for)249
2357 y(instance,)g Fw(MPI)p 499 2357 V 15 w(COMM)p 644
2357 V 14 w(CREA)m(TE)p FA(\).)249 2449 y FB(R)n(ationale.)34
b FA(The)10 b(corresp)q(ondence)j(b)q(et)o(w)o(een)e(in)o(ter-)f(and)f
(in)o(tracomm)o(unicators)e(can)j(b)q(e)g(b)q(est)249
2503 y(understo)q(o)q(d)h(b)o(y)f(thinking)f(of)g(an)h(in)o(tra-group)f
(comm)o(unication)e(domain)g(as)j(a)g(sp)q(ecial)g(case)h(of)p
eop
%%Page: 245 259
245 258 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(245)249
507 y FA(an)13 b(in)o(ter-group)h(comm)o(unication)c(domain,)h(where)k
(b)q(oth)f(comm)o(unicatio)o(n)d(groups)j(happ)q(en)249
561 y(to)j(b)q(e)g(iden)o(tical.)27 b(This)16 b(in)o(terpretation)i
(can)f(b)q(e)g(used)h(to)f(deriv)o(e)g(a)g(consisten)o(t)h(seman)o
(tics)249 615 y(for)f(comm)o(unicator)d(inquiry)j(functions)g(and)g
(for)g(p)q(oin)o(t-to-p)q(oin)o(t)e(comm)o(unication,)g(or)i(an)249
669 y(iden)o(tical)c(implemen)o(tation)e(for)i(b)q(oth)h(t)o(yp)q(es)h
(of)e(ob)r(jects.)249 740 y(This)20 b(corresp)q(ondence)j(indicates)d
(ho)o(w)g(collectiv)o(e)g(comm)o(uni)o(cation)d(functions)j(could)g(b)q
(e)249 794 y(extended)e(to)f(in)o(ter-group)f(comm)o(unication:)k
(Rather)d(than)g(a)f(symmetric)f(design,)i(where)249
848 y(pro)q(cesses)c(in)d(the)i(group)e(b)q(oth)h(send)g(and)g(receiv)o
(e,)h(one)f(w)o(ould)e(ha)o(v)o(e)i(an)f(asymmetric)f(design,)249
902 y(where)19 b(one)f(group)g(sends)i(\(either)f(from)d(a)i(single)f
(ro)q(ot)h(or)g(from)e(all)h(pro)q(cesses\))k(and)d(the)249
956 y(other)c(group)g(receiv)o(es)h(\(either)f(to)g(a)f(single)g(ro)q
(ot)h(or)f(to)g(all)g(pro)q(cesses\).)20 b(Additional)12
b(syn)o(tax)249 1010 y(is)19 b(needed)h(to)f(distinguish)f(sender)j
(group)e(from)e(receiv)o(er)k(group.)33 b(Suc)o(h)19
b(extensions)h(are)249 1064 y(discussed)c(for)d Fw(MPI)p
FA(-2.)249 1134 y(Note,)g(ho)o(w)o(ev)o(er,)f(that)g(the)h(t)o(w)o(o)e
(groups)i(of)e(an)h(in)o(tercomm)o(unicator)e(are)i(curren)o(tly)h
(required)249 1188 y(to)h(b)q(e)g(disjoin)o(t,)f(for)g(reasons)i
(explained)f(later)g(in)f(this)h(section.)19 b(\()p FB(End)d(of)e(r)n
(ationale.)p FA(\))249 1279 y FB(A)n(dvic)n(e)h(to)h(implementors.)39
b FA(An)14 b(in)o(tercomm)o(unicator)e(can)j(b)q(e)g(implem)o(en)o(ted)
e(with)h(a)g(data)249 1333 y(structure)f(v)o(ery)e(similar)d(to)j(that)
g(used)g(for)g(an)f(in)o(tracomm)o(unicator.)k(The)d(in)o(tercomm)o
(unica-)249 1387 y(tor)h(can)g(b)q(e)h(represen)o(ted)i(b)o(y)d(a)f
(structure)k(with)c(comp)q(onen)o(ts)h Fw(group,)g(myrank,)g(lo)q(cal)p
1602 1387 13 2 v 15 w(context)249 1441 y FA(and)h Fw(remote)p
451 1441 V 15 w(context)p FA(.)19 b(The)14 b Fw(group)f
FA(arra)o(y)g(represen)o(ts)j(the)e(remote)f(group,)g(whereas)h
Fw(myrank)249 1495 y FA(is)g(the)g(rank)g(of)f(the)i(pro)q(cess)h(in)d
(the)i(lo)q(cal)e(group.)249 1566 y(When)g(a)f(pro)q(cess)j(p)q(osts)e
(a)f(send)i(with)e(argumen)o(ts)g Fw(dest,)h(tag)g FA(and)f
Fw(comm)p FA(,)f(then)i(the)g(address)249 1620 y(of)k(the)i
(destination)f(is)f(computed)h(as)g Fw(comm.group[dest])p
FA(.)29 b(The)18 b(message)g(sen)o(t)h(carries)g(a)249
1674 y(header)c(with)e(the)i(tuple)f Fw(\(comm.myrank,)d(tag,)i
(comm.remote)p 1263 1674 V 13 w(context\))p FA(.)249
1744 y(If)i(a)g(pro)q(cess)i(p)q(osts)f(a)f(receiv)o(e)i(with)e
(argumen)o(t)f Fw(source,)j(tag)e FA(and)g Fw(comm)p
FA(,)e(then)j(headers)h(of)249 1798 y(incoming)10 b(messages)j(are)g
(matc)o(hed)e(to)i(the)g(tuple)f Fw(\(source,)i(tag,)e(comm.lo)q(cal)p
1488 1798 V 13 w(context\))h FA(\(\014rst)249 1852 y(t)o(w)o(o)g(ma)o
(y)f(b)q(e)j(don)o(tcare's\).)249 1923 y(This)f(design)g(pro)o(vides)g
(a)g(safe)g(in)o(ter-group)g(comm)o(uni)o(cation)d(domain)h(pro)o
(vided)h(that)249 1993 y Ft(\017)21 b FA(the)c Fw(lo)q(cal)p
447 1993 V 15 w(context)h FA(is)e(pro)q(cess)j(unique)d(and)h(is)f
(iden)o(tical)g(at)g(all)g(pro)q(cesses)j(in)d(the)h(same)291
2047 y(group;)c(and)249 2118 y Ft(\017)21 b FA(the)14
b Fw(lo)q(cal)p 444 2118 V 15 w(context)h FA(of)e(one)i(group)e(equals)
h(to)g(the)g Fw(remote)p 1210 2118 V 15 w(context)h FA(of)f(the)g
(other)h(group.)249 2188 y(Note)f(that)g(this)g(data)f(structure)j(can)
e(b)q(e)g(used)h(to)e(represen)o(t)j(in)o(tracomm)o(unicators)11
b(merely)249 2242 y(b)q(e)k(setting)g Fw(lo)q(cal)p 525
2242 V 15 w(context)g(=)g(remote)p 849 2242 V 14 w(context)p
FA(.)20 b(It)15 b(is)f(then)h(iden)o(tical)e(to)h(the)h(\014rst)g
(represen-)249 2296 y(tation)e(discussed)j(on)e(page)f(205.)249
2367 y(Another)h(design)e(is)h(to)g(use)g(ids)g(whic)o(h)f(are)i(pro)q
(cess-unique,)g(but)f(not)f(necessarily)i(iden)o(tical)249
2421 y(at)j(all)g(pro)q(cesses.)31 b(In)18 b(suc)o(h)g(case,)h(the)f
Fw(remote)p 1025 2421 V 15 w(context)h FA(comp)q(onen)o(t)d(of)h(the)i
(comm)o(uni)o(ca-)249 2475 y(tor)f(structure)j(is)d(an)g(arra)o(y)m(,)g
(where)h Fw(comm.remote)p 1098 2475 V 13 w(context[i])g
FA(is)f(the)h(con)o(text)g(c)o(hosen)g(b)o(y)p eop
%%Page: 246 260
246 259 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(246)1256 b(Chapter)13 b(5)249
507 y FA(pro)q(cess)k Fw(i)e FA(in)g(remote)g(group)g(to)g(iden)o(tify)
g(that)g(comm)o(unication)d(domain;)h Fw(lo)q(cal)p 1559
507 13 2 v 15 w(context)k FA(is)249 561 y(the)i(con)o(text)f(c)o(hosen)
h(b)o(y)f(the)g(lo)q(cal)f(pro)q(cess)j(to)e(iden)o(tify)f(that)h(comm)
o(unicatio)o(n)d(domain.)249 615 y(A)f(message)f(is)h(sen)o(t)h(with)e
(header)i Fw(comm.m)o(yrank,)d(tag,)h(comm.remote)p 1402
615 V 12 w(context[dest])p FA(;)i(a)f(re-)249 669 y(ceiv)o(e)i(call)f
(causes)j(incoming)13 b(messages)j(to)f(b)q(e)i(matc)o(hed)e(against)g
(the)h(tuple)g Fw(\(source,)h(tag,)249 723 y(comm.lo)q(cal)p
450 723 V 13 w(context\))p FA(.)249 794 y(Comparing)g(with)h(the)h
(second)h(implemen)o(tation)15 b(outlined)k(on)f(page)h(205,)g(w)o(e)g
(see)h(again)249 848 y(that)e(the)g(same)f(data)g(structure)j(can)d(b)q
(e)i(used)f(to)g(represen)o(t)h(an)f(in)o(tra-group)f(comm)o(uni-)249
902 y(cation)f(domain,)e(with)i(no)f(c)o(hanges.)26 b(When)16
b(used)h(for)f(an)g(in)o(tracomm)o(uni)o(cator,)e(then)j(the)249
956 y(iden)o(tit)o(y)d Fw(comm.lo)q(cal)p 604 956 V 13
w(context)i(=)f(comm.remote)p 1046 956 V 13 w(context[myrank])g
FA(holds.)21 b(\()p FB(End)c(of)e(advic)n(e)249 1010
y(to)g(implementors.)p FA(\))291 1101 y(It)e(is)f(often)h(con)o(v)o
(enien)o(t)g(to)g(generate)h(an)f(in)o(ter-group)g(comm)o(unicatio)o(n)
d(domain)h(b)o(y)i(join-)249 1155 y(ing)20 b(together)h(t)o(w)o(o)f(in)
o(tra-group)g(comm)o(unication)d(domains,)j(i.e.,)h(building)e(the)i
(pair)f(of)249 1209 y(comm)o(unicating)11 b(groups)k(from)e(the)i
(individual)e(groups.)20 b(This)14 b(requires)i(that)f(there)h(exists)
249 1263 y(one)g(pro)q(cess)h(in)e(eac)o(h)h(group)f(that)h(can)f(comm)
o(unicate)e(with)i(eac)o(h)h(other)g(through)g(a)f(com-)249
1317 y(m)o(unication)e(domain)f(that)j(serv)o(es)h(as)f(a)g(bridge)g(b)
q(et)o(w)o(een)h(the)f(t)o(w)o(o)g(groups.)21 b(F)m(or)14
b(example,)249 1371 y(supp)q(ose)i(that)g Fw(comm1)d
FA(has)i(3)g(pro)q(cesses)j(and)d Fw(comm2)e FA(has)i(4)g(pro)q(cesses)
j(\(see)e(Figure)g(5.9\).)249 1425 y(In)e(terms)g(of)f(the)h(MPI)p
618 1425 V 16 w(COMM)p 772 1425 V 15 w(W)o(ORLD,)e(the)j(pro)q(cesses)h
(in)e Fw(comm1)d FA(are)k(0,)e(1)g(and)h(2)g(and)249
1479 y(in)i Fw(comm2)e FA(are)j(3,)f(4,)g(5)g(and)h(6.)25
b(Let)17 b(lo)q(cal)e(pro)q(cess)j(0)e(in)g(eac)o(h)h(in)o(tracomm)o
(unicator)c(form)249 1533 y(the)j(bridge.)22 b(They)16
b(can)f(comm)o(unicate)e(via)i(MPI)p 1062 1533 V 15 w(COMM)p
1215 1533 V 15 w(W)o(ORLD)f(where)j(pro)q(cess)g(0)e(in)249
1587 y Fw(comm1)9 b FA(has)i(rank)g(0)g(and)g(pro)q(cess)i(0)d(in)h
Fw(comm2)e FA(has)i(rank)g(3.)17 b(Once)12 b(the)g(in)o(tercomm)o
(unicator)249 1641 y(is)j(formed,)e(the)j(original)d(group)h(for)h(eac)
o(h)g(in)o(tracomm)o(unicator)d(is)i(the)i(lo)q(cal)e(group)g(in)h(the)
249 1694 y(in)o(tercomm)o(unicator)e(and)h(the)i(group)f(from)e(the)j
(other)g(in)o(tracomm)o(uni)o(cator)d(b)q(ecomes)i(the)249
1748 y(remote)i(group.)28 b(F)m(or)17 b(comm)o(unication)d(with)j(this)
g(in)o(tercomm)o(unicator,)f(the)i(rank)f(in)g(the)249
1802 y(remote)c(group)f(is)h(used.)19 b(F)m(or)12 b(example,)g(if)g(a)g
(pro)q(cess)j(in)e Fw(comm1)d FA(w)o(an)o(ts)j(to)g(send)h(to)f(pro)q
(cess)249 1856 y(2)g(of)g Fw(comm2)f FA(\(MPI)p 569 1856
V 15 w(COMM)p 722 1856 V 15 w(W)o(ORLD)h(rank)g(5\))h(then)g(it)f(uses)
i(2)e(as)h(the)g(rank)g(in)f(the)h(send.)291 1910 y(In)o(tercomm)o
(unicators)h(are)j(created)h(in)e(this)h(fashion)f(b)o(y)g(the)h(call)f
Fw(MPI)p 1467 1910 V 14 w(INTERCOMM-)p 249 1964 V 262
1964 a(CREA)m(TE)p FA(.)9 b(The)k(t)o(w)o(o)e(joined)g(groups)h(are)h
(required)g(to)e(b)q(e)i(disjoin)o(t.)j(The)c(con)o(v)o(erse)i
(function)249 2018 y(of)i(building)g(an)h(in)o(tracomm)o(uni)o(cator)e
(from)g(an)i(in)o(tercomm)o(unicator)d(is)j(pro)o(vided)g(b)o(y)g(the)
249 2072 y(call)12 b Fw(MPI)p 401 2072 V 14 w(INTERCOMM)p
666 2072 V 15 w(MERGE)p FA(.)g(This)g(call)h(generates)h(a)f(comm)o
(unicati)o(on)d(domain)h(with)249 2126 y(a)h(group)h(whic)o(h)f(is)h
(the)g(union)f(of)g(the)h(t)o(w)o(o)f(groups)h(of)f(the)h(in)o
(ter-group)g(comm)o(unicati)o(on)d(do-)249 2180 y(main.)15
b(Both)c(calls)g(are)g(blo)q(c)o(king.)16 b(Both)c(will)d(generally)i
(require)h(collectiv)o(e)f(comm)o(unicatio)o(n)249 2234
y(within)i(eac)o(h)i(of)e(the)h(in)o(v)o(olv)o(ed)f(groups,)h(as)g(w)o
(ell)f(as)h(comm)o(unicati)o(on)d(across)k(the)f(groups.)249
2325 y FB(R)n(ationale.)37 b FA(The)14 b(t)o(w)o(o)g(groups)g(of)f(an)h
(in)o(ter-group)f(comm)o(unication)e(domain)g(are)j(required)249
2379 y(to)f(b)q(e)g(disjoin)o(t)f(in)g(order)i(to)f(supp)q(ort)g(the)h
(de\014ned)g(in)o(tercomm)o(unicator)c(creation)j(function.)249
2433 y(If)g(the)h(groups)g(w)o(ere)h(not)e(disjoin)o(t)g(then)h(a)f
(pro)q(cess)j(in)d(the)h(in)o(tersection)h(of)e(the)h(t)o(w)o(o)f
(groups)249 2487 y(w)o(ould)e(ha)o(v)o(e)h(to)g(mak)o(e)e(t)o(w)o(o)h
(calls)h(to)g Fw(MPI)p 910 2487 V 14 w(INTERCOMM)p 1175
2487 V 14 w(CREA)m(TE)p FA(,)e(one)i(on)g(b)q(ehalf)g(of)f(eac)o(h)p
eop
%%Page: 247 261
247 260 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(247)403
466 y
 18945146 9472570 0 0 33482915 16840130 startTexFig
 403 466 a
%%BeginDocument: ../figures/context-fig6.eps
/$F2psDict 6400 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
	/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
	/$F2psEnd {$F2psEnteredState restore end} def
	%%EndProlog

$F2psBegin
0 setlinecap 0 setlinejoin
-130 18 translate
0.0 256.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 334 149 m 334 64 l  279 64 l  279 149 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
284 79 m 
gs 1 -1 scale (local rank) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
304 99 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
304 119 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
304 139 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
289 54 m 
gs 1 -1 scale (comm1) col-1 show gr
% Polyline
n 339 289 m 339 184 l  279 184 l  279 289 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
284 199 m 
gs 1 -1 scale (local rank) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
304 219 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
304 239 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
304 259 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
304 279 m 
gs 1 -1 scale (3) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
294 179 m 
gs 1 -1 scale (comm2) col-1 show gr
% Polyline
n 234 289 m 234 59 l  154 59 l  154 289 l 
 clp gs col-1 s gr
% Polyline
n 204 94 m 219 94 l  219 219 l  209 219 l gs col-1 s gr
% Polyline
n 186 84 m 179 84 179 97 7 arcto 4 {pop} repeat 179 104 312 104 7 arcto 4 {pop} repeat 319 104 319 91 7 arcto 4 {pop} repeat 319 84 186 84 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 186 204 m 179 204 179 217 7 arcto 4 {pop} repeat 179 224 312 224 7 arcto 4 {pop} repeat 319 224 319 211 7 arcto 4 {pop} repeat 319 204 186 204 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 349 109 m 399 109 l gs col-1 s gr
n 391.000 107.000 m 399.000 109.000 l 391.000 111.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 349 239 m 399 239 l gs col-1 s gr
n 391.000 237.000 m 399.000 239.000 l 391.000 241.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 709 164 m 709 34 l  404 34 l  404 164 l 
 clp gs col-1 s gr
% Polyline
n 709 304 m 709 174 l  404 174 l  404 304 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
159 79 m 
gs 1 -1 scale (WORLD rank) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
189 99 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
189 119 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
189 139 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
189 219 m 
gs 1 -1 scale (3) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
189 239 m 
gs 1 -1 scale (4) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
189 259 m 
gs 1 -1 scale (5) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
189 279 m 
gs 1 -1 scale (6) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
144 54 m 
gs 1 -1 scale (MPI_COMM_WORLD) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
229 174 m 
gs 1 -1 scale (Bridge) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 99 m 
gs 1 -1 scale (0 \(0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 119 m 
gs 1 -1 scale (1 \(1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 139 m 
gs 1 -1 scale (2 \(2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
569 79 m 
gs 1 -1 scale (local rank \(WORLD rank\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
599 59 m 
gs 1 -1 scale (remote group) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
609 99 m 
gs 1 -1 scale (0 \(3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
609 119 m 
gs 1 -1 scale (1 \(4\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
609 139 m 
gs 1 -1 scale (2 \(5\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
609 159 m 
gs 1 -1 scale (3 \(6\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
444 59 m 
gs 1 -1 scale (local group) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
419 79 m 
gs 1 -1 scale (local rank \(WORLD rank\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
599 199 m 
gs 1 -1 scale (remote group) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
569 219 m 
gs 1 -1 scale (local rank \(WORLD rank\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 239 m 
gs 1 -1 scale (0 \(3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 259 m 
gs 1 -1 scale (1 \(4\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 279 m 
gs 1 -1 scale (2 \(5\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 299 m 
gs 1 -1 scale (3 \(6\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
609 239 m 
gs 1 -1 scale (0 \(0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
609 259 m 
gs 1 -1 scale (1 \(1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
609 279 m 
gs 1 -1 scale (2 \(2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
444 199 m 
gs 1 -1 scale (local group) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
419 219 m 
gs 1 -1 scale (local rank \(WORLD rank\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
264 34 m 
gs 1 -1 scale (intra-communicator) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
519 29 m 
gs 1 -1 scale (inter-communicator) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1128 a Fo(Figure)13 b(5.9)249 1165 y Fz(Example)d(of)h(t)o(w)o(o)g
(in)o(tracomm)o(un)o(ica)o(tors)d(merging)i(to)h(b)q(ecome)e(one)i(in)o
(tercomm)n(unic)o(ato)o(r.)249 1288 y FA(group)16 b(it)f(b)q(elongs)h
(to.)23 b(This)15 b(is)h(not)f(feasible)h(with)f(a)g(blo)q(c)o(king)g
(call.)23 b(One)16 b(w)o(ould)f(need)i(to)249 1342 y(use)g(a)f(non)o
(blo)q(c)o(king)f(call,)g(implemen)o(ted)f(using)h(non)o(blo)q(c)o
(king)g(collectiv)o(e)h(comm)o(unication,)249 1396 y(in)d(order)i(to)f
(relax)g(the)g(disjoin)o(tness)g(condition.)j(\()p FB(End)f(of)f(r)n
(ationale.)p FA(\))249 1487 y Fs(5.7.2)48 b(In)o(tercomm)o(uni)o(cator)
12 b(Accessors)208 1641 y Fw(MPI)p 285 1641 13 2 v 14
w(COMM)p 429 1641 V 15 w(TEST)p 548 1641 V 15 w(INTER\(comm,)f
(\015ag\))332 1716 y Fv(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)332
1766 y(OUT)114 b Fw(\015ag)483 b Fv(true)13 b(if)h(comm)f(is)g(in)o
(tercomm)o(unicator)249 1876 y Fr(int)21 b(MPI)p 405
1876 14 2 v 15 w(Comm)p 508 1876 V 15 w(test)p 611 1876
V 15 w(inter\(MPI)p 824 1876 V 14 w(Comm)g(comm,)g(int)g(*flag\))249
1960 y(MPI)p 318 1960 V 15 w(COMM)p 421 1960 V 15 w(TEST)p
524 1960 V 15 w(INTER\(COMM,)e(FLAG,)i(IERROR\))336 2014
y(INTEGER)g(COMM,)f(IERROR)336 2068 y(LOGICAL)h(FLAG)291
2152 y FA(MPI)p 374 2152 13 2 v 15 w(COMM)p 527 2152
V 15 w(TEST)p 653 2152 V 15 w(INTER)15 b(is)g(a)g(lo)q(cal)g(routine)g
(that)g(allo)o(ws)f(the)i(calling)e(pro)q(cess)j(to)249
2206 y(determine)c(if)f(a)g(comm)o(unicator)e(is)i(an)h(in)o(tercomm)o
(unicator)d(or)i(an)h(in)o(tracomm)o(uni)o(cator.)i(It)249
2260 y(returns)h Fq(true)d FA(if)g(it)h(is)g(an)f(in)o(tercomm)o
(unicator,)e(otherwise)k Fq(false)p FA(.)291 2314 y(When)e(an)h(in)o
(tercomm)o(unicator)d(is)j(used)g(as)g(an)f(input)h(argumen)o(t)e(to)i
(the)g(comm)o(unicator)249 2368 y(accessors)i(describ)q(ed)g(in)d
(Section)i(5.4.1,)c(the)k(follo)o(wing)c(table)j(describ)q(es)i(the)e
(b)q(eha)o(vior.)p eop
%%Page: 248 262
248 261 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(248)1256 b(Chapter)13 b(5)p
309 467 1374 2 v 308 521 2 54 v 702 505 a Fw(MPI)p 779
505 13 2 v 14 w(COMM)p 923 505 V 15 w(*)g FA(F)m(unction)h(Beha)o(vior)
p 1682 521 2 54 v 308 575 V 704 559 a(\(in)f(In)o(ter-Comm)o(unication)
e(Mo)q(de\))p 1682 575 V 309 577 1374 2 v 309 587 V 308
641 2 54 v 334 625 a Fw(MPI)p 411 625 13 2 v 15 w(COMM)p
556 625 V 14 w(SIZE)p 732 641 2 54 v 105 w FA(returns)16
b(the)e(size)h(of)e(the)i(lo)q(cal)e(group.)p 1682 641
V 308 695 V 334 679 a Fw(MPI)p 411 679 13 2 v 15 w(COMM)p
556 679 V 14 w(GROUP)p 732 695 2 54 v 48 w FA(returns)j(the)e(lo)q(cal)
f(group.)p 1682 695 V 308 749 V 334 733 a Fw(MPI)p 411
733 13 2 v 15 w(COMM)p 556 733 V 14 w(RANK)p 732 749
2 54 v 77 w FA(returns)j(the)e(rank)g(in)f(the)i(lo)q(cal)e(group)p
1682 749 V 309 751 1374 2 v 249 811 a(F)m(urthermore,)19
b(the)g(op)q(eration)g Fw(MPI)p 851 811 13 2 v 14 w(COMM)p
995 811 V 15 w(COMP)m(ARE)d FA(is)i(v)n(alid)f(for)h(in)o(tercomm)o
(unica-)249 865 y(tors.)34 b(Both)19 b(comm)o(unicators)e(m)o(ust)h(b)q
(e)i(either)g(in)o(tra-)e(or)h(in)o(tercomm)o(unicators,)f(or)h(else)
249 919 y Fq(MPI)p 321 919 12 2 v 13 w(UNEQUAL)14 b FA(results.)19
b(Both)14 b(corresp)q(onding)g(lo)q(cal)e(and)h(remote)g(groups)h(m)o
(ust)e(compare)249 973 y(correctly)k(to)e(get)h(the)g(results)h
Fq(MPI)p 820 973 V 13 w(CONGRUENT)f FA(and)f Fq(MPI)p
1232 973 V 13 w(SIMILAR)p FA(.)f(In)h(particular,)g(it)h(is)263
1027 y(p)q(ossible)g(for)e Fq(MPI)p 555 1027 V 13 w(SIMILAR)g
FA(to)h(result)h(b)q(ecause)h(either)f(the)g(lo)q(cal)e(or)h(remote)g
(groups)g(w)o(ere)249 1081 y(similar)d(but)k(not)e(iden)o(tical.)291
1135 y(The)j(follo)o(wing)d(accessors)k(pro)o(vide)f(consisten)o(t)h
(access)g(to)f(the)g(remote)f(group)h(of)f(an)g(in-)249
1189 y(tercomm)o(unicator;)d(they)i(are)g(all)f(lo)q(cal)g(op)q
(erations.)249 1314 y Fw(MPI)p 326 1314 13 2 v 14 w(COMM)p
470 1314 V 15 w(REMOTE)p 657 1314 V 15 w(SIZE\(comm,)e(size\))332
1388 y Fv(IN)158 b Fw(comm)439 b Fv(in)o(tercomm)o(unicator)332
1436 y(OUT)114 b Fw(size)484 b Fv(n)o(um)o(b)q(er)11
b(of)e(pro)q(cesses)i(in)f(the)g(remote)f(group)1079
1489 y(of)26 b Fq(comm)249 1600 y Fr(int)21 b(MPI)p 405
1600 14 2 v 15 w(Comm)p 508 1600 V 15 w(remote)p 655
1600 V 15 w(size\(MPI)p 846 1600 V 14 w(Comm)g(comm,)f(int)i(*size\))
249 1684 y(MPI)p 318 1684 V 15 w(COMM)p 421 1684 V 15
w(REMOTE)p 568 1684 V 14 w(SIZE\(COMM,)e(SIZE,)h(IERROR\))336
1738 y(INTEGER)g(COMM,)f(SIZE,)h(IERROR)291 1822 y Fw(MPI)p
368 1822 13 2 v 14 w(COMM)p 512 1822 V 15 w(REMOTE)p
699 1822 V 14 w(SIZE)11 b FA(returns)i(the)f(size)g(of)e(the)i(remote)f
(group)g(in)g(the)h(in)o(tercom-)249 1875 y(m)o(unicator.)17
b(Note)d(that)g(the)g(size)h(of)e(the)i(lo)q(cal)e(group)g(is)h(giv)o
(en)g(b)o(y)f Fw(MPI)p 1422 1875 V 15 w(COMM)p 1567 1875
V 14 w(SIZE)p FA(.)249 2000 y Fw(MPI)p 326 2000 V 14
w(COMM)p 470 2000 V 15 w(REMOTE)p 657 2000 V 15 w(GROUP\(comm)o(,)d
(group\))332 2075 y Fv(IN)158 b Fw(comm)439 b Fv(in)o(tercomm)o
(unicator)332 2122 y(OUT)114 b Fw(group)448 b Fv(remote)13
b(group)h(corresp)q(onding)i(to)d Fq(comm)249 2232 y
Fr(int)21 b(MPI)p 405 2232 14 2 v 15 w(Comm)p 508 2232
V 15 w(remote)p 655 2232 V 15 w(group\(MPI)p 868 2232
V 13 w(Comm)g(comm,)g(MPI)p 1187 2232 V 15 w(Group)g(*group\))249
2316 y(MPI)p 318 2316 V 15 w(COMM)p 421 2316 V 15 w(REMOTE)p
568 2316 V 14 w(GROUP\(COMM,)f(GROUP,)h(IERROR\))336
2370 y(INTEGER)g(COMM,)f(GROUP,)h(IERROR)291 2454 y Fw(MPI)p
368 2454 13 2 v 14 w(COMM)p 512 2454 V 15 w(REMOTE)p
699 2454 V 14 w(GROUP)10 b FA(returns)j(the)g(remote)e(group)h(in)f
(the)h(in)o(tercomm)o(unica-)249 2508 y(tor.)18 b(Note)d(that)e(the)i
(lo)q(cal)e(group)h(is)f(giv)o(e)h(b)o(y)f Fw(MPI)p 1071
2508 V 15 w(COMM)p 1216 2508 V 14 w(GROUP)p FA(.)p eop
%%Page: 249 263
249 262 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(249)249
507 y FB(A)n(dvic)n(e)15 b(to)g(implementors.)38 b FA(It)15
b(is)f(necessary)i(to)e(expand)g(the)h(represen)o(tation)h(outlined)e
(on)249 561 y(page)f(245,)f(in)g(order)h(to)g(supp)q(ort)g(in)o
(tercomm)o(unicator)e(accessors)k(that)d(return)i(information)249
615 y(on)k(the)h(lo)q(cal)f(group:)27 b(namely)m(,)17
b(the)i(data)f(structure)i(has)f(to)f(carry)h(information)d(on)i(the)
249 669 y(lo)q(cal)e(group,)h(in)f(addition)f(to)i(the)g(remote)g
(group.)26 b(This)16 b(information)e(is)j(also)f(needed)i(in)249
723 y(order)e(to)f(supp)q(ort)h(con)o(v)o(enien)o(tly)f(the)h(call)e
Fw(MPI)p 1033 723 13 2 v 15 w(INTERCOMM)p 1299 723 V
14 w(MERGE)p FA(.)g(\()p FB(End)j(of)f(advic)n(e)249
777 y(to)f(implementors.)p FA(\))249 868 y Fs(5.7.3)48
b(In)o(tercomm)o(uni)o(cator)12 b(Constructors)249 951
y FA(An)22 b(in)o(tercomm)o(unicator)e(can)i(b)q(e)g(created)i(b)o(y)d
(a)h(call)f(to)h Fw(MPI)p 1319 951 V 14 w(COMM)p 1463
951 V 15 w(DUP)p FA(,)f(see)i(Sec-)249 1005 y(tion)15
b(5.4.2.)21 b(As)16 b(for)f(in)o(tracomm)o(uni)o(cators,)e(this)j(call)
e(generates)j(a)f(new)f(in)o(ter-group)h(com-)249 1059
y(m)o(unication)d(domain)f(with)i(the)i(same)d(groups)i(as)g(the)h(old)
e(one,)g(and)h(also)f(replicates)h(user-)249 1113 y(de\014ned)h
(attributes.)21 b(An)15 b(in)o(tercomm)o(unicator)d(is)i(deallo)q
(cated)h(b)o(y)f(a)g(call)g(to)h Fw(MPI)p 1588 1113 V
14 w(COMM-)p 249 1167 V 262 1167 a(FREE)p FA(.)d(The)i(other)g(in)o
(tracomm)o(uni)o(cator)d(constructor)16 b(functions)d(of)g(Section)h
(5.4.2)e(do)i(not)249 1221 y(apply)h(to)g(in)o(tercomm)o(unicators.)21
b(Tw)o(o)15 b(new)h(functions)f(are)h(sp)q(eci\014c)h(to)e(in)o
(tercomm)o(unica-)249 1275 y(tors.)249 1400 y Fw(MPI)p
326 1400 V 14 w(INTERCOMM)p 591 1400 V 15 w(CREA)m(TE\(lo)q(cal)p
859 1400 V 13 w(comm,)k(lo)q(cal)p 1090 1400 V 15 w(leader,)i(b)o
(ridge)p 1343 1400 V 16 w(comm,)e(remote)p 1617 1400
V 15 w(leader,)249 1454 y(tag,)13 b(newintercomm\))291
1529 y Fv(IN)157 b Fw(lo)q(cal)p 573 1529 V 15 w(comm)386
b Fv(lo)q(cal)15 b(in)o(tracomm)o(unicator)291 1579 y(IN)157
b Fw(lo)q(cal)p 573 1579 V 15 w(leader)392 b Fv(rank)12
b(of)f(lo)q(cal)i(group)f(leader)g(in)g Fq(lo)q(cal)p
1635 1579 12 2 v 13 w(comm)291 1628 y Fv(IN)157 b Fw(b)o(ridge)p
597 1628 13 2 v 16 w(comm)361 b Fv(\\bridge")12 b(comm)o(unicator;)h
(signi\014can)o(t)g(only)1079 1682 y(at)g(t)o(w)o(o)g(lo)q(cal)h
(leaders)291 1732 y(IN)157 b Fw(remote)p 613 1732 V 15
w(leader)352 b Fv(rank)10 b(of)e(remote)h(group)h(leader)f(in)h
Fq(b)o(ridge)p 1681 1732 12 2 v 13 w(comm)p Fv(;)1079
1786 y(signi\014can)o(t)16 b(only)e(at)f(t)o(w)o(o)g(lo)q(cal)h
(leaders)291 1836 y(IN)157 b Fw(tag)532 b Fv(\\safe")14
b(tag)291 1886 y(OUT)113 b Fw(newintercomm)336 b Fv(new)13
b(in)o(tercomm)o(unicator)j(\(handle\))249 1996 y Fr(int)21
b(MPI)p 405 1996 14 2 v 15 w(Intercomm)p 618 1996 V 14
w(create\(MPI)p 852 1996 V 14 w(Comm)g(local)p 1085 1996
V 14 w(comm,)g(int)g(local)p 1427 1996 V 15 w(leader,)540
2050 y(MPI)p 609 2050 V 15 w(Comm)g(bridge)p 865 2050
V 14 w(comm,)g(int)g(remote)p 1229 2050 V 15 w(leader,)f(int)h(tag,)540
2104 y(MPI)p 609 2104 V 15 w(Comm)g(*newintercomm\))249
2188 y(MPI)p 318 2188 V 15 w(INTERCOMM)p 531 2188 V 14
w(CREATE\(LOCAL)p 809 2188 V 13 w(COMM,)g(LOCAL)p 1063
2188 V 15 w(LEADER,)f(PEER)p 1340 2188 V 15 w(COMM,)540
2242 y(REMOTE)p 675 2242 V 14 w(LEADER,)g(TAG,)h(NEWINTERCOMM,)f
(IERROR\))336 2296 y(INTEGER)h(LOCAL)p 624 2296 V 14
w(COMM,)g(LOCAL)p 879 2296 V 15 w(LEADER,)f(PEER)p 1156
2296 V 15 w(COMM,)h(REMOTE)p 1434 2296 V 14 w(LEADER,)f(TAG,)336
2350 y(NEWINTERCOMM,)f(IERROR)291 2434 y FA(MPI)p 374
2434 13 2 v 15 w(INTER)o(COMM)p 661 2434 V 15 w(CREA)m(TE)f(creates)j
(an)e(in)o(tercomm)o(unicator.)31 b(The)19 b(call)f(is)h(col-)249
2488 y(lectiv)o(e)k(o)o(v)o(er)f(the)h(union)f(of)g(the)h(t)o(w)o(o)f
(groups.)44 b(Pro)q(cesses)25 b(should)d(pro)o(vide)g(matc)o(hing)p
eop
%%Page: 250 264
250 263 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(250)1256 b(Chapter)13 b(5)249
507 y Fw(lo)q(cal)p 331 507 13 2 v 15 w(comm)19 b FA(and)h(iden)o
(tical)g Fw(lo)q(cal)p 813 507 V 15 w(leader)i FA(argumen)o(ts)e
(within)g(eac)o(h)h(of)f(the)i(t)o(w)o(o)e(groups.)249
561 y(The)15 b(t)o(w)o(o)f(leaders)h(sp)q(ecify)f(matc)o(hing)f
Fw(b)o(ridge)p 978 561 V 16 w(comm)f FA(argumen)o(ts,)h(and)h(eac)o(h)h
(pro)o(vide)f(in)g Fw(re-)249 615 y(mote)p 339 615 V
14 w(leader)j FA(the)f(rank)f(of)f(the)i(other)g(leader)g(within)e(the)
i(domain)d(of)i Fw(b)o(ridge)p 1501 615 V 16 w(comm)p
FA(.)20 b(Both)249 669 y(pro)o(vide)14 b(iden)o(tical)f(tag)g(v)n
(alues.)291 723 y(Wildcards)g(are)h(not)g(p)q(ermitted)g(for)f
Fw(remote)p 1009 723 V 15 w(leader,)i(lo)q(cal)p 1232
723 V 15 w(leader)p FA(,)g(nor)f Fw(tag)p FA(.)291 777
y(This)k(call)g(uses)i(p)q(oin)o(t-to-p)q(oin)o(t)e(comm)o(unicatio)o
(n)e(with)j(comm)o(unicator)d Fw(b)o(ridge)p 1613 777
V 16 w(comm)p FA(,)249 831 y(and)f(with)f(tag)h Fw(tag)g
FA(b)q(et)o(w)o(een)h(the)f(leaders.)22 b(Th)o(us,)16
b(care)f(m)o(ust)f(b)q(e)i(tak)o(en)f(that)g(there)h(b)q(e)g(no)249
885 y(p)q(ending)d(comm)o(unication)d(on)j Fw(b)o(ridge)p
858 885 V 16 w(comm)e FA(that)i(could)g(in)o(terfere)h(with)e(this)i
(comm)o(uni)o(ca-)249 939 y(tion.)249 1064 y Fw(MPI)p
326 1064 V 14 w(INTERCOMM)p 591 1064 V 15 w(MERGE\(intercomm,)e(high,)i
(newintracomm\))332 1139 y Fv(IN)158 b Fw(intercomm)361
b Fv(In)o(terComm)o(unicator)332 1188 y(IN)158 b Fw(high)473
b Fv(see)13 b(b)q(elo)o(w)332 1238 y(OUT)114 b Fw(newintracomm)292
b Fv(new)13 b(in)o(tracomm)o(unicator)249 1348 y Fr(int)21
b(MPI)p 405 1348 14 2 v 15 w(Intercomm)p 618 1348 V 14
w(merge\(MPI)p 830 1348 V 14 w(Comm)g(intercomm,)f(int)h(high,)540
1402 y(MPI)p 609 1402 V 15 w(Comm)g(*newintracomm\))249
1486 y(MPI)p 318 1486 V 15 w(INTERCOMM)p 531 1486 V 14
w(MERGE\(INTERCOMM,)d(HIGH,)j(NEWINTRACOMM,)e(IERROR\))336
1540 y(INTEGER)i(INTERCOMM,)e(NEWINTRACOMM,)g(IERROR)336
1594 y(LOGICAL)i(HIGH)291 1678 y FA(MPI)p 374 1678 13
2 v 15 w(INTER)o(COMM)p 661 1678 V 15 w(MER)o(GE)c(creates)j(an)d(in)o
(tracomm)o(unicator)e(from)h(the)i(union)f(of)249 1732
y(the)g(t)o(w)o(o)f(groups)g(that)h(are)g(asso)q(ciated)g(with)f
Fw(intercomm)p FA(.)24 b(All)15 b(pro)q(cesses)k(should)e(pro)o(vide)
249 1786 y(the)k(same)f Fw(high)h FA(v)n(alue)e(within)h(eac)o(h)h(of)f
(the)h(t)o(w)o(o)f(groups.)38 b(If)20 b(pro)q(cesses)j(in)d(one)h
(group)249 1840 y(pro)o(vided)12 b(the)h(v)n(alue)f Fw(high)h(=)f
(false)h FA(and)f(pro)q(cesses)j(in)d(the)h(other)g(group)f(pro)o
(vided)g(the)h(v)n(alue)249 1894 y Fw(high)i(=)h(true)f
FA(then)h(the)f(union)g(orders)h(the)f(\\lo)o(w")f(group)g(b)q(efore)i
(the)g(\\high")d(group.)21 b(If)15 b(all)249 1948 y(pro)q(cesses)g(pro)
o(vided)c(the)i(same)e Fw(high)h FA(argumen)o(t)f(then)i(the)f(order)h
(of)e(the)h(union)g(is)f(arbitrary)m(.)249 2002 y(This)j(call)f(is)h
(blo)q(c)o(king)f(and)g(collectiv)o(e)h(within)f(the)i(union)e(of)g
(the)i(t)o(w)o(o)e(groups.)249 2093 y FB(A)n(dvic)n(e)22
b(to)h(implementors.)85 b FA(In)22 b(order)h(to)f(implem)o(en)o(t)e
Fw(MPI)p 1314 2093 V 14 w(INTERCOMM)p 1579 2093 V 15
w(MERGE)p FA(,)249 2147 y Fw(MPI)p 326 2147 V 14 w(COMM)p
470 2147 V 15 w(FREE)11 b FA(and)h Fw(MPI)p 751 2147
V 14 w(COMM)p 895 2147 V 15 w(DUP)p FA(,)e(it)i(is)f(necessary)j(to)e
(supp)q(ort)h(collectiv)o(e)f(com-)249 2201 y(m)o(unication)7
b(within)i(the)h(t)o(w)o(o)f(groups)h(as)g(w)o(ell)f(as)g(comm)o
(unication)d(b)q(et)o(w)o(een)11 b(the)g(t)o(w)o(o)e(groups.)249
2255 y(One)j(p)q(ossible)f(mec)o(hanism)d(is)j(to)g(create)h(a)f(data)f
(structure)j(that)e(will)e(allo)o(w)h(one)h(to)f(run)i(co)q(de)249
2309 y(similar)f(to)h(that)h(used)h(for)f Fw(MPI)p 757
2309 V 14 w(INTERCOMM)p 1022 2309 V 15 w(CREA)m(TE)p
FA(:)e(A)i(priv)n(ate)f(comm)o(unication)e(do-)249 2363
y(main)i(for)i(eac)o(h)h(group,)e(a)h(leader)h(for)f(eac)o(h)g(group,)g
(and)g(a)g(priv)n(ate)g(bridge)g(comm)o(unicatio)o(n)249
2417 y(domain)e(for)h(the)i(t)o(w)o(o)e(leaders.)19 b(\()p
FB(End)d(of)e(advic)n(e)i(to)e(implementors.)p FA(\))p
eop
%%Page: 251 265
251 264 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Comm)o(unicators)1175 b(251)403
466 y
 18945146 9093664 0 0 27825684 13485260 startTexFig
 403 466 a
%%BeginDocument: ../figures/context-threepipe.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-72.0 324.0 translate 0.900 -0.900 scale
/Times-Bold findfont 16.00 scalefont setfont
99 219 m 
gs 1 -1 scale (0 \(0\)) col-1 show gr
/Times-Bold findfont 16.00 scalefont setfont
99 259 m 
gs 1 -1 scale (1 \(3\)) col-1 show gr
/Times-Bold findfont 16.00 scalefont setfont
99 299 m 
gs 1 -1 scale (2 \(6\)) col-1 show gr
/Times-Bold findfont 16.00 scalefont setfont
99 339 m 
gs 1 -1 scale (3 \(9\)) col-1 show gr
1.000 setlinewidth
% Polyline
n 255 266 m 231 252 l gs col-1 s gr
% Polyline
n 255 266 m 231 280 l gs col-1 s gr
% Polyline
n 172 266 m 196 252 l gs col-1 s gr
% Polyline
n 172 266 m 196 280 l gs col-1 s gr
% Polyline
n 186 259 m 241 259 l gs col-1 s gr
% Polyline
n 186 273 m 241 273 l gs col-1 s gr
% Polyline
n 456 266 m 432 252 l gs col-1 s gr
% Polyline
n 456 266 m 432 280 l gs col-1 s gr
% Polyline
n 373 266 m 397 252 l gs col-1 s gr
% Polyline
n 373 266 m 397 280 l gs col-1 s gr
	1 setlinecap [1 4.500000] 4.500000 setdash
% Polyline
n 86 179 m 79 179 79 352 7 arcto 4 {pop} repeat 79 359 142 359 7 arcto 4 {pop} repeat 149 359 149 186 7 arcto 4 {pop} repeat 149 179 86 179 7 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
% Polyline
n 387 259 m 442 259 l gs col-1 s gr
/Times-Bold findfont 16.00 scalefont setfont
499 339 m 
gs 1 -1 scale (3 \(11\)) col-1 show gr
% Polyline
n 387 273 m 442 273 l gs col-1 s gr
	1 setlinecap [1 4.500000] 4.500000 setdash
% Polyline
n 286 179 m 279 179 279 352 7 arcto 4 {pop} repeat 279 359 342 359 7 arcto 4 {pop} repeat 349 359 349 186 7 arcto 4 {pop} repeat 349 179 286 179 7 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
	1 setlinecap [1 4.500000] 4.500000 setdash
% Polyline
n 486 179 m 479 179 479 352 7 arcto 4 {pop} repeat 479 359 542 359 7 arcto 4 {pop} repeat 549 359 549 186 7 arcto 4 {pop} repeat 549 179 486 179 7 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
/Times-Bold findfont 16.00 scalefont setfont
299 219 m 
gs 1 -1 scale (0 \(1\)) col-1 show gr
/Times-Bold findfont 16.00 scalefont setfont
299 299 m 
gs 1 -1 scale (2 \(7\)) col-1 show gr
/Times-Bold findfont 16.00 scalefont setfont
299 259 m 
gs 1 -1 scale (1 \(4\)) col-1 show gr
/Times-Bold findfont 16.00 scalefont setfont
299 339 m 
gs 1 -1 scale (3 \(10\)) col-1 show gr
/Times-Bold findfont 16.00 scalefont setfont
499 219 m 
gs 1 -1 scale (0 \(2\)) col-1 show gr
/Times-Bold findfont 16.00 scalefont setfont
499 259 m 
gs 1 -1 scale (1 \(5\)) col-1 show gr
/Times-Bold findfont 16.00 scalefont setfont
499 299 m 
gs 1 -1 scale (2 \(8\)) col-1 show gr
/Times-Roman findfont 20.00 scalefont setfont
84 154 m 
gs 1 -1 scale (Group 0) col-1 show gr
/Times-Roman findfont 20.00 scalefont setfont
289 154 m 
gs 1 -1 scale (Group 1) col-1 show gr
/Times-Roman findfont 20.00 scalefont setfont
484 154 m 
gs 1 -1 scale (Group 2) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1104 a Fo(Figure)13 b(5.10)249 1141 y Fz(Three-group)c(pip)q
(eline.)k(The)f(\014gure)e(sho)o(ws)h(the)g(lo)q(cal)f(rank)g(and)h
(\(within)g(brac)o(k)o(ets\))e(the)h(global)g(rank)h(of)249
1179 y(eac)o(h)f(pro)q(cess.)249 1301 y Fs(Example)15
b(5.14)21 b FA(In)15 b(this)h(example,)d(pro)q(cesses)18
b(are)e(divided)f(in)g(three)i(groups.)22 b(Groups)16
b(0)249 1355 y(and)11 b(1)h(comm)o(unicate.)j(Groups)c(1)g(and)h(2)f
(comm)o(unicate.)k(Therefore,)e(group)e(0)g(requires)i(one)249
1409 y(in)o(tercomm)o(unicator,)c(group)j(1)f(requires)i(t)o(w)o(o)f
(in)o(tercomm)o(unicators,)d(and)j(group)g(2)f(requires)249
1463 y(1)j(in)o(tercomm)o(unicator.)h(See)g(Figure)f(5.10)249
1517 y Fr(#include)20 b(<mpi.h>)249 1625 y(main\(int)g(argc,)h(char)g
(**argv\))249 1679 y({)293 1733 y(MPI_Comm)63 b(myComm;)151
b(/*)22 b(intra-communicato)o(r)d(of)i(local)g(sub-group)f(*/)293
1787 y(MPI_Comm)63 b(myFirstComm;)41 b(/*)22 b(inter-communicato)o(r)d
(*/)293 1841 y(MPI_Comm)63 b(mySecondComm;)19 b(/*)j(second)e
(inter-communicator)e(\(group)j(1)h(only\))e(*/)293 1895
y(int)h(membershipKey,)e(rank;)293 2003 y(MPI_Init\(&argc,)f(&argv\);)
293 2057 y(MPI_Comm_rank\(MP)o(I_COM)o(M_WO)o(RLD,)g(&rank\);)293
2165 y(/*)j(Generate)f(membershipKey)f(in)j(the)f(range)g([0,)g(1,)g
(2])h(*/)293 2219 y(membershipKey)d(=)i(rank)g(\045)h(3;)293
2327 y(/*)f(Build)g(intra-communicat)o(or)e(for)i(local)g(sub-group)f
(*/)293 2381 y(MPI_Comm_split\(M)o(PI_CO)o(MM_W)o(ORLD,)e
(membershipKey,)h(rank,)i(&myComm\);)293 2489 y(/*)g(Build)g
(inter-communicat)o(ors.)40 b(Tags)21 b(are)g(hard-coded.)f(*/)p
eop
%%Page: 252 266
252 265 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(252)1256 b(Chapter)13 b(5)293
507 y Fr(if)21 b(\(membershipKey)e(==)i(0\))h({)336 561
y(/*)g(Group)e(0)i(communicates)d(with)i(group)g(1.)g(*/)336
615 y(MPI_Intercomm_creat)o(e\()e(myComm,)h(0,)h(MPI_COMM_WORLD,)e(1,)i
(01,)h(&myFirstComm\);)293 669 y(})293 723 y(else)f(if)g
(\(membershipKey)e(==)i(1\))h({)336 777 y(/*)g(Group)e(1)i
(communicates)d(with)i(groups)g(0)g(and)h(2.)f(*/)336
831 y(MPI_Intercomm_creat)o(e\()e(myComm,)h(0,)h(MPI_COMM_WORLD,)e(0,)i
(01,)h(&myFirstComm\);)336 885 y(MPI_Intercomm_creat)o(e\()d(myComm,)h
(0,)h(MPI_COMM_WORLD,)e(2,)i(12,)h(&mySecondComm\);)293
939 y(})293 993 y(else)f(if)g(\(membershipKey)e(==)i(2\))h({)336
1047 y(/*)g(Group)e(2)i(communicates)d(with)i(group)g(1.)g(*/)336
1101 y(MPI_Intercomm_creat)o(e\()e(myComm,)h(0,)h(MPI_COMM_WORLD,)e(1,)
i(12,)h(&myFirstComm\);)293 1155 y(})293 1263 y(/*)f(Do)g(work)g(...)h
(\(not)f(shown\))f(*/)293 1371 y(/*)h(free)g(communicators)e
(appropriately)g(*/)293 1425 y(MPI_Comm_free\(&m)o(yComm)o(\);)293
1479 y(MPI_Comm_free\(&m)o(yFirs)o(tCom)o(m\);)293 1533
y(if\(membershipkey)f(==)k(1\))336 1587 y(MPI_Comm_free\(&mySe)o(cond)o
(Comm\))o(;)293 1641 y(MPI_Finalize\(\);)249 1694 y(})p
eop
%%Page: 253 267
253 266 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 325 a Fu(6)25 b FD(Pro)q(cess)17 b(T)l(op)q(ologies)249
628 y(6.1)52 b(In)o(tro)q(duction)249 736 y FA(This)20
b(c)o(hapter)g(discusses)i(the)e Fw(MPI)f FA(top)q(ology)g(mec)o
(hanism.)33 b(A)20 b(top)q(ology)e(is)i(an)f(extra,)249
790 y(optional)c(attribute)h(that)g(one)g(can)g(giv)o(e)g(to)f(an)h(in)
o(tra-comm)o(uni)o(cator;)e(top)q(ologies)h(cannot)249
844 y(b)q(e)k(added)f(to)g(in)o(ter-comm)o(unicators.)28
b(A)18 b(top)q(ology)f(can)i(pro)o(vide)f(a)f(con)o(v)o(enien)o(t)i
(naming)249 897 y(mec)o(hanism)10 b(for)i(the)h(pro)q(cesses)i(of)d(a)g
(group)g(\(within)g(a)g(comm)o(unicator\),)e(and)i(additionally)m(,)249
951 y(ma)o(y)g(assist)i(the)h(run)o(time)e(system)g(in)h(mapping)d(the)
k(pro)q(cesses)h(on)o(to)e(hardw)o(are.)291 1005 y(As)k(stated)g(in)f
(Chapter)h(5,)g(a)f(pro)q(cess)j(group)d(in)g Fw(MPI)g
FA(is)h(a)f(collection)g(of)g Fr(n)g FA(pro)q(cesses.)249
1059 y(Eac)o(h)c(pro)q(cess)i(in)26 b(the)14 b(group)f(is)g(assigned)g
(a)g(rank)g(b)q(et)o(w)o(een)h Fr(0)f FA(and)g Fr(n-1)p
FA(.)k(In)c(man)o(y)f(parallel)249 1113 y(applications)17
b(a)h(linear)g(ranking)f(of)h(pro)q(cesses)i(do)q(es)f(not)f
(adequately)h(re\015ect)g(the)g(logical)249 1167 y(comm)o(unication)8
b(pattern)13 b(of)e(the)h(pro)q(cesses)j(\(whic)o(h)d(is)f(usually)g
(determined)h(b)o(y)f(the)i(under-)249 1221 y(lying)h(problem)h
(geometry)g(and)g(the)h(n)o(umerical)e(algorithm)f(used\).)25
b(Often)16 b(the)32 b(pro)q(cesses)249 1275 y(are)14
b(arranged)f(in)g(top)q(ological)f(patterns)i(suc)o(h)h(as)e(t)o(w)o
(o-)g(or)g(three-dimensional)f(grids.)18 b(More)249 1329
y(generally)m(,)13 b(the)i(logical)d(pro)q(cess)k(arrangemen)o(t)e(is)g
(describ)q(ed)i(b)o(y)e(a)f(graph.)19 b(In)14 b(this)g(c)o(hapter)249
1383 y(w)o(e)g(will)f(refer)i(to)e(this)h(logical)e(pro)q(cess)k
(arrangemen)o(t)d(as)h(the)h(\\virtual)e(top)q(ology)m(.")291
1437 y(A)i(clear)g(distinction)f(m)o(ust)g(b)q(e)i(made)e(b)q(et)o(w)o
(een)i(the)g(virtual)e(pro)q(cess)i(top)q(ology)e(and)h(the)249
1491 y(top)q(ology)i(of)g(the)h(underlying,)g(ph)o(ysical)g(hardw)o
(are.)30 b(The)18 b(virtual)f(top)q(ology)g(can)h(b)q(e)g(ex-)249
1545 y(ploited)c(b)o(y)g(the)g(system)g(in)g(the)h(assignmen)o(t)e(of)h
(pro)q(cesses)i(to)e(ph)o(ysical)g(pro)q(cessors,)i(if)d(this)249
1599 y(helps)k(to)g(impro)o(v)o(e)e(the)j(comm)o(unicatio)o(n)c(p)q
(erformance)j(on)g(a)f(giv)o(en)h(mac)o(hine.)26 b(Ho)o(w)16
b(this)249 1653 y(mapping)c(is)i(done,)g(ho)o(w)o(ev)o(er,)g(is)h
(outside)f(the)h(scop)q(e)g(of)f Fw(MPI)p FA(.)f(The)i(description)f
(of)g(the)h(vir-)249 1707 y(tual)d(top)q(ology)m(,)f(on)i(the)g(other)g
(hand,)g(dep)q(ends)h(only)e(on)g(the)i(application,)d(and)h(is)h(mac)o
(hine-)249 1761 y(indep)q(enden)o(t.)31 b(The)18 b(functions)g(in)g
(this)g(c)o(hapter)g(deal)g(only)f(with)g(mac)o(hine-indep)q(enden)o(t)
249 1815 y(mapping.)249 1902 y FB(R)n(ationale.)37 b
FA(Though)12 b(ph)o(ysical)h(mapping)e(is)i(not)g(discussed,)i(the)f
(existence)h(of)d(the)i(virtual)249 1956 y(top)q(ology)c(information)e
(ma)o(y)h(b)q(e)j(used)g(as)g(advice)f(b)o(y)g(the)g(run)o(time)f
(system.)17 b(There)c(are)e(w)o(ell-)249 2010 y(kno)o(wn)g(tec)o
(hniques)i(for)e(mapping)e(grid/torus)i(structures)j(to)d(hardw)o(are)h
(top)q(ologies)e(suc)o(h)i(as)249 2064 y(h)o(yp)q(ercub)q(es)17
b(or)e(grids.)20 b(F)m(or)14 b(more)g(complicated)f(graph)i(structures)
i(go)q(o)q(d)d(heuristics)i(often)249 2118 y(yield)i(nearly)g(optimal)e
(results)j([21)o(].)31 b(On)18 b(the)h(other)g(hand,)g(if)e(there)j(is)
e(no)g(w)o(a)o(y)g(for)g(the)249 2172 y(user)e(to)g(sp)q(ecify)g(the)g
(logical)d(pro)q(cess)k(arrangemen)o(t)e(as)g(a)g(\\virtual)g(top)q
(ology)m(,")e(a)i(random)249 2226 y(mapping)h(is)j(most)e(lik)o(ely)h
(to)g(result.)33 b(On)19 b(some)f(mac)o(hines,)g(this)h(will)e(lead)h
(to)h(unneces-)249 2280 y(sary)c(con)o(ten)o(tion)f(in)g(the)h(in)o
(terconnection)g(net)o(w)o(ork.)20 b(Some)13 b(details)i(ab)q(out)f
(predicted)i(and)249 2334 y(measured)j(p)q(erformance)g(impro)o(v)o
(emen)o(ts)e(that)j(result)g(from)d(go)q(o)q(d)i(pro)q(cess-to-pro)q
(cessor)249 2388 y(mapping)12 b(on)h(mo)q(dern)h(w)o(ormhole-routing)d
(arc)o(hitectures)16 b(can)e(b)q(e)h(found)e(in)h([9)o(,)f(8].)249
2454 y(Besides)g(p)q(ossible)f(p)q(erformance)f(b)q(ene\014ts,)i(the)f
(virtual)e(top)q(ology)g(can)i(function)f(as)g(a)g(con)o(v)o(e-)249
2508 y(nien)o(t,)j(pro)q(cess-naming)f(structure,)i(with)f(tremendous)g
(b)q(ene\014ts)i(for)d(program)g(readabilit)o(y)965 2613
y(253)p eop
%%Page: 254 268
254 267 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(254)1256 b(Chapter)13 b(6)249
507 y FA(and)h(notational)e(p)q(o)o(w)o(er)i(in)g(message-passing)f
(programming)o(.)i(\()p FB(End)h(of)f(r)n(ationale.)p
FA(\))249 628 y FD(6.2)52 b(Virtual)18 b(T)l(op)q(ologies)249
736 y FA(The)10 b(comm)o(unication)d(pattern)k(of)e(a)h(set)h(of)e(pro)
q(cesses)k(can)d(b)q(e)g(represen)o(ted)j(b)o(y)d(a)f(graph.)17
b(The)249 790 y(no)q(des)f(stand)g(for)e(the)i(pro)q(cesses,)i(and)d
(the)h(edges)g(connect)h(pro)q(cesses)h(that)d(comm)o(unicate)249
844 y(with)j(eac)o(h)g(other.)31 b(Since)19 b(comm)o(unicatio)o(n)c(is)
j(most)f(often)h(symmetric,)f(comm)o(unicatio)o(n)249
897 y(graphs)h(are)g(assumed)f(to)g(b)q(e)i(symmetric:)k(if)17
b(an)g(edge)i Fp(uv)f FA(connects)i(no)q(de)e Fp(u)f
FA(to)g(no)q(de)h Fp(v)q FA(,)249 951 y(then)d(an)e(edge)i
Fp(v)q(u)f FA(connects)i(no)q(de)e Fp(v)h FA(to)f(no)q(de)g
Fp(u)p FA(.)291 1005 y Fw(MPI)g FA(pro)o(vides)i(message-passing)f(b)q
(et)o(w)o(een)i(an)o(y)e(pair)g(of)g(pro)q(cesses)j(in)d(a)g(group.)23
b(There)249 1059 y(is)16 b(no)f(requiremen)o(t)h(for)f(op)q(ening)h(a)f
(c)o(hannel)h(explicitly)m(.)22 b(Therefore,)17 b(a)f(\\missing)d
(link")i(in)249 1113 y(the)h(user-de\014ned)h(pro)q(cess)g(graph)d(do)q
(es)i(not)f(prev)o(en)o(t)h(the)g(corresp)q(onding)g(pro)q(cesses)h
(from)249 1167 y(exc)o(hanging)h(messages.)31 b(It)19
b(means,)f(rather,)i(that)e(this)g(connection)h(is)f(neglected)i(in)e
(the)249 1221 y(virtual)c(top)q(ology)m(.)19 b(This)c(strategy)h
(implies)d(that)h(the)i(top)q(ology)e(giv)o(es)g(no)h(con)o(v)o(enien)o
(t)g(w)o(a)o(y)249 1275 y(of)h(naming)e(this)i(path)o(w)o(a)o(y)f(of)h
(comm)o(unication.)22 b(Another)17 b(p)q(ossible)g(consequence)h(is)e
(that)249 1329 y(an)11 b(automatic)f(mapping)f(to)q(ol)h(\(if)h(one)h
(exists)g(for)f(the)h(run)o(time)e(en)o(vironmen)o(t\))g(will)g(not)h
(tak)o(e)249 1383 y(accoun)o(t)j(of)e(this)i(edge)g(when)f(mapping,)e
(and)i(comm)o(unication)d(on)j(the)h(\\missing")d(link)h(will)249
1437 y(b)q(e)j(less)f(e\016cien)o(t.)249 1528 y FB(R)n(ationale.)53
b FA(As)17 b(previously)g(stated,)g(the)h(message)e(passing)g(in)h(a)f
(program)f(can)i(b)q(e)g(rep-)249 1582 y(resen)o(ted)k(as)d(a)g
(directed)i(graph)e(where)i(the)f(v)o(ertices)h(are)f(pro)q(cesses)i
(and)d(the)h(edges)h(are)249 1636 y(messages.)30 b(On)18
b(man)o(y)e(systems,)i(optimizing)d(comm)o(unication)g(sp)q(eeds)k
(requires)g(a)f(mini-)249 1690 y(mization)10 b(of)h(the)h(con)o(ten)o
(tion)g(for)g(ph)o(ysical)f(wires)h(b)o(y)g(messages)g(o)q(ccurring)g
(sim)o(ultaneously)m(.)249 1744 y(P)o(erforming)f(this)i(optimization)d
(requires)k(kno)o(wledge)f(of)f(when)i(messages)e(o)q(ccur)i(and)f
(their)249 1798 y(resource)19 b(requiremen)o(ts.)27 b(Not)16
b(only)g(is)h(this)f(information)e(di\016cult)i(to)h(represen)o(t,)i
(it)d(ma)o(y)249 1852 y(not)f(b)q(e)h(a)o(v)n(ailable)d(at)j(top)q
(ology)e(creation)i(time)e(in)h(complex)f(programs.)21
b(A)15 b(simpler)f(alter-)249 1906 y(nativ)o(e)e(is)f(to)h(pro)o(vide)g
(information)d(ab)q(out)j(\\spatial")e(distribution)i(of)f(comm)o
(unication)e(and)249 1960 y(ignore)j(\\temp)q(oral")f(distribution.)17
b(Though)12 b(the)i(former)d(metho)q(d)h(can)h(lead)f(to)g(greater)i
(op-)249 2014 y(timizations)c(and)i(faster)g(programs,)f(the)h(later)g
(metho)q(d)g(is)f(used)i(in)f Fw(MPI)f FA(to)h(allo)o(w)e(a)i(simpler)
249 2068 y(in)o(terface)i(that)g(is)g(w)o(ell)f(understo)q(o)q(d)i(at)f
(the)g(curren)o(t)i(time.)g(As)f(a)e(result,)h(the)h(programmer)249
2122 y(tells)e(the)h Fw(MPI)e FA(system)h(the)g(t)o(ypical)f
(connections,)i(e.g.,)e(top)q(ology)m(,)f(of)h(their)h(program.)k(This)
249 2176 y(can)f(lead)f(to)h(compromises)d(when)k(a)e(sp)q(eci\014c)i
(top)q(ology)d(ma)o(y)g(o)o(v)o(er-)h(or)h(under-sp)q(ecify)h(the)249
2230 y(connectivit)o(y)c(that)g(is)g(used)h(at)f(an)o(y)g(time)e(in)i
(the)g(program.)k(Ov)o(erall,)12 b(ho)o(w)o(ev)o(er,)h(the)g(c)o(hosen)
249 2284 y(top)q(ology)j(mec)o(hanism)g(w)o(as)h(seen)i(as)e(a)h
(useful)f(compromise)f(b)q(et)o(w)o(een)j(functionalit)o(y)d(and)249
2338 y(ease)h(of)f(usage.)24 b(Exp)q(erience)18 b(with)e(similar)e(tec)
o(hniques)j(in)f(P)m(ARMA)o(CS)f([3,)g(7])g(sho)o(w)h(that)249
2392 y(this)e(information)d(is)j(usually)f(su\016cien)o(t)h(for)g(a)f
(go)q(o)q(d)h(mapping.)i(\()p FB(End)f(of)g(r)n(ationale.)p
FA(\))p eop
%%Page: 255 269
255 268 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(255)628 466 y
 11840716 8880532 0 0 14208860 10656645 startTexFig
 628 466 a
%%BeginDocument: ../figures/topol-fig1.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-72.0 198.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 199 159 m 199 99 l  139 99 l  139 159 l  clp gs col-1 s gr
% Polyline
n 259 159 m 259 99 l  199 99 l  199 159 l  clp gs col-1 s gr
% Polyline
n 319 159 m 319 99 l  259 99 l  259 159 l  clp gs col-1 s gr
% Polyline
n 259 219 m 259 159 l  199 159 l  199 219 l  clp gs col-1 s gr
% Polyline
n 199 219 m 199 159 l  139 159 l  139 219 l  clp gs col-1 s gr
% Polyline
n 139 99 m 139 39 l  79 39 l  79 99 l  clp gs col-1 s gr
% Polyline
n 199 99 m 199 39 l  139 39 l  139 99 l  clp gs col-1 s gr
% Polyline
n 259 99 m 259 39 l  199 39 l  199 99 l  clp gs col-1 s gr
% Polyline
n 319 99 m 319 39 l  259 39 l  259 99 l  clp gs col-1 s gr
% Polyline
n 139 219 m 139 159 l  79 159 l  79 219 l  clp gs col-1 s gr
% Polyline
n 319 219 m 319 159 l  259 159 l  259 219 l  clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
104 54 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 74 m 
gs 1 -1 scale (\(0,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 74 m 
gs 1 -1 scale (\(0,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 74 m 
gs 1 -1 scale (\(0,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
104 114 m 
gs 1 -1 scale (4) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 134 m 
gs 1 -1 scale (\(1,0\)) col-1 show gr
% Polyline
n 139 159 m 139 99 l  79 99 l  79 159 l  clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
164 114 m 
gs 1 -1 scale (5) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 74 m 
gs 1 -1 scale (\(0,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 134 m 
gs 1 -1 scale (\(1,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
104 174 m 
gs 1 -1 scale (8) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
164 174 m 
gs 1 -1 scale (9) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
224 174 m 
gs 1 -1 scale (10) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 134 m 
gs 1 -1 scale (\(1,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 134 m 
gs 1 -1 scale (\(1,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 194 m 
gs 1 -1 scale (\(2,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 194 m 
gs 1 -1 scale (\(2,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 194 m 
gs 1 -1 scale (\(2,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 194 m 
gs 1 -1 scale (\(2,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 54 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 54 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 54 m 
gs 1 -1 scale (3) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 114 m 
gs 1 -1 scale (6) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 114 m 
gs 1 -1 scale (7) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 174 m 
gs 1 -1 scale (11) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1091 a Fo(Figure)13 b(6.1)249 1128 y Fz(Relationship)8
b(b)q(et)o(w)o(een)i(ranks)f(and)h(Cartesian)f(co)q(ordinates)f(for)j
(a)f(3x4)g(2D)h(top)q(ology)m(.)i(The)d(upp)q(er)g(n)o(um)o(b)q(er)249
1165 y(in)h(eac)o(h)g(b)q(o)o(x)f(is)i(the)f(rank)f(of)h(the)g(pro)q
(cess)f(and)g(the)h(lo)o(w)o(er)g(v)n(alue)f(is)i(the)f(\(ro)o(w,)g
(column\))e(co)q(ordinates.)291 1290 y FA(Sp)q(ecifying)g(the)h
(virtual)f(top)q(ology)g(in)g(terms)h(of)f(a)g(graph)h(is)g(su\016cien)
o(t)g(for)f(all)g(applications.)249 1344 y(Ho)o(w)o(ev)o(er,)k(in)f
(man)o(y)f(applications)h(the)i(graph)e(structure)j(is)e(regular,)g
(and)f(the)i(detailed)f(set-)249 1398 y(up)e(of)g(the)h(graph)f(w)o
(ould)g(b)q(e)h(incon)o(v)o(enien)o(t)f(for)g(the)h(user)g(and)f(migh)o
(t)e(b)q(e)j(less)g(e\016cien)o(t)g(at)f(run)249 1452
y(time.)20 b(A)14 b(large)h(fraction)f(of)h(all)e(parallel)h
(applications)g(use)h(pro)q(cess)i(top)q(ologies)d(lik)o(e)g(rings,)249
1506 y(t)o(w)o(o-)h(or)g(higher-dimensional)d(grids,)j(or)g(tori.)22
b(These)16 b(structures)i(are)d(completely)f(de\014ned)249
1560 y(b)o(y)20 b(the)h(n)o(um)o(b)q(er)e(of)h(dimensions)f(and)h(the)g
(n)o(um)o(b)q(ers)g(of)g(pro)q(cesses)j(in)c(eac)o(h)i(co)q(ordinate)
249 1614 y(direction.)g(Also,)14 b(the)i(mapping)c(of)i(grids)h(and)g
(tori)f(is)h(generally)f(an)g(easier)i(problem)d(than)249
1668 y(general)h(graphs.)k(Th)o(us,)c(it)g(is)f(desirable)i(to)e
(address)j(these)f(cases)g(explicitly)m(.)291 1721 y(Pro)q(cess)i(co)q
(ordinates)f(in)f(a)h(Cartesian)f(structure)j(b)q(egin)d(their)h(n)o
(um)o(b)q(ering)f(at)g(0.)22 b(Ro)o(w-)249 1775 y(ma)r(jor)15
b(n)o(um)o(b)q(ering)g(is)i(alw)o(a)o(ys)e(used)j(for)e(the)h(pro)q
(cesses)i(in)d(a)g(Cartesian)h(structure.)29 b(This)249
1829 y(means)9 b(that,)h(for)g(example,)f(the)h(relation)f(b)q(et)o(w)o
(een)i(group)f(rank)g(and)f(co)q(ordinates)i(for)e(t)o(w)o(elv)o(e)249
1883 y(pro)q(cesses)17 b(in)c(a)h(3)9 b Ft(\002)g FA(4)14
b(grid)f(is)h(as)g(sho)o(wn)g(in)f(Figure)h(6.1.)249
2004 y FD(6.3)52 b(Ov)o(erlapping)18 b(T)l(op)q(ologies)249
2112 y FA(In)11 b(some)g(applications,)f(it)h(is)g(desirable)h(to)f
(use)i(di\013eren)o(t)f(Cartesian)g(top)q(ologies)e(at)h(di\013eren)o
(t)249 2166 y(stages)j(in)e(the)h(computation.)j(F)m(or)d(example,)e
(in)h(a)h(QR)f(factorization,)g(the)i Fp(i)1486 2151
y Fk(th)1532 2166 y FA(transforma-)249 2220 y(tion)f(is)g(determined)h
(b)o(y)f(the)h(data)f(b)q(elo)o(w)g(the)h(diagonal)e(in)h(the)h
Fp(i)1301 2205 y Fk(th)1348 2220 y FA(column)e(of)h(the)h(matrix.)249
2274 y(It)j(is)g(often)g(easiest)h(to)f(think)f(of)h(the)g(upp)q(er)h
(righ)o(t)e(hand)h(corner)h(of)f(the)g(2D)g(top)q(ology)e(as)249
2328 y(starting)20 b(on)f(the)i(pro)q(cess)g(with)f(the)g
Fp(i)893 2312 y Fk(th)946 2328 y FA(diagonal)e(elemen)o(t)i(of)f(the)h
(matrix)e(for)h(the)i Fp(i)1710 2312 y Fk(th)249 2382
y FA(stage)14 b(of)e(the)i(computation.)i(Since)d(the)h(original)d
(matrix)h(w)o(as)h(laid)e(out)i(in)g(the)h(original)d(2D)249
2435 y(top)q(ology)m(,)j(it)h(is)g(necessary)j(to)d(main)o(tain)e(a)i
(relationship)g(b)q(et)o(w)o(een)i(it)e(and)g(the)h(shifted)g(2D)249
2489 y(top)q(ology)e(in)h(the)h Fp(i)558 2474 y Fk(th)607
2489 y FA(stage.)22 b(F)m(or)15 b(example,)f(the)h(pro)q(cesses)j
(forming)13 b(a)i(ro)o(w)g(or)g(column)f(in)p eop
%%Page: 256 270
256 269 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(256)1256 b(Chapter)13 b(6)249
507 y FA(the)i(original)e(2D)h(top)q(ology)g(m)o(ust)g(also)g(form)f(a)
h(ro)o(w)h(or)f(column)f(in)i(the)g(shifted)g(2D)f(top)q(ol-)249
561 y(ogy)h(in)g(the)h Fp(i)465 546 y Fk(th)515 561 y
FA(stage.)23 b(As)16 b(stated)h(in)e(Section)h(6.2)f(and)g(sho)o(wn)h
(in)f(Figure)h(6.1,)e(there)j(is)f(a)249 615 y(clear)e(corresp)q
(ondence)i(b)q(et)o(w)o(een)f(the)f(rank)f(of)g(a)g(pro)q(cess)i(and)f
(its)f(co)q(ordinates)h(in)f(a)g(Carte-)249 669 y(sian)e(top)q(ology)m
(.)k(This)d(relationship)e(can)i(b)q(e)g(used)g(to)f(create)i(m)o
(ultiple)c(Cartesian)i(top)q(ologies)249 723 y(with)f(the)i(desired)g
(relationship.)k(Figure)11 b(6.2)f(sho)o(ws)h(the)g(relationship)g(of)f
(t)o(w)o(o)g(2D)g(Cartesian)249 777 y(top)q(ologies)j(where)i(the)g
(second)g(one)f(is)g(shifted)g(b)o(y)f(t)o(w)o(o)h(ro)o(ws)g(and)g(t)o
(w)o(o)f(columns.)628 835 y
 11840716 8880532 0 0 14208860 10656645 startTexFig
 628 835 a
%%BeginDocument: ../figures/topol-fig4.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-72.0 198.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 199 159 m 199 99 l  139 99 l  139 159 l  clp gs col-1 s gr
% Polyline
n 259 159 m 259 99 l  199 99 l  199 159 l  clp gs col-1 s gr
% Polyline
n 319 159 m 319 99 l  259 99 l  259 159 l  clp gs col-1 s gr
% Polyline
n 259 219 m 259 159 l  199 159 l  199 219 l  clp gs col-1 s gr
% Polyline
n 199 219 m 199 159 l  139 159 l  139 219 l  clp gs col-1 s gr
% Polyline
n 139 99 m 139 39 l  79 39 l  79 99 l  clp gs col-1 s gr
% Polyline
n 199 99 m 199 39 l  139 39 l  139 99 l  clp gs col-1 s gr
% Polyline
n 259 99 m 259 39 l  199 39 l  199 99 l  clp gs col-1 s gr
% Polyline
n 319 99 m 319 39 l  259 39 l  259 99 l  clp gs col-1 s gr
% Polyline
n 139 219 m 139 159 l  79 159 l  79 219 l  clp gs col-1 s gr
% Polyline
n 319 219 m 319 159 l  259 159 l  259 219 l  clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
89 59 m 
gs 1 -1 scale (0 / \(0,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
89 77 m 
gs 1 -1 scale (6 / \(1,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
149 59 m 
gs 1 -1 scale (1 / \(0,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
149 77 m 
gs 1 -1 scale (7 / \(1,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
209 77 m 
gs 1 -1 scale (4 / \(1,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
269 59 m 
gs 1 -1 scale (3 / \(0,3\)) col-1 show gr
% Polyline
n 139 159 m 139 99 l  79 99 l  79 159 l  clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
269 77 m 
gs 1 -1 scale (5 / \(1,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
209 59 m 
gs 1 -1 scale (2 / \(0,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
89 119 m 
gs 1 -1 scale (4 / \(1,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
89 137 m 
gs 1 -1 scale (10 / \(2,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
149 119 m 
gs 1 -1 scale (5 / \(1,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
149 137 m 
gs 1 -1 scale (11 / \(2,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
209 119 m 
gs 1 -1 scale (6 / \(1,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
209 137 m 
gs 1 -1 scale (8 / \(2,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
269 119 m 
gs 1 -1 scale (7 / \(1,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
269 137 m 
gs 1 -1 scale (9 / \(2,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
89 179 m 
gs 1 -1 scale (8 / \(2,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
89 197 m 
gs 1 -1 scale (2 / \(0,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
149 179 m 
gs 1 -1 scale (9 / \(2,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
149 197 m 
gs 1 -1 scale (3 / \(0,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
209 179 m 
gs 1 -1 scale (10 / \(2,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
209 197 m 
gs 1 -1 scale (0 / \(0,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
269 179 m 
gs 1 -1 scale (11 / \(2,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
269 197 m 
gs 1 -1 scale (1 / \(0,1\)) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1460 a Fo(Figure)g(6.2)249 1497 y Fz(The)f(relationship)c(b)q(et)o
(w)o(een)i(t)o(w)o(o)i(o)o(v)o(erlaid)d(top)q(ologies)g(on)i(a)g(3)d
Fy(\002)g Fz(4)k(torus.)i(The)d(upp)q(er)f(v)n(alues)g(in)h(eac)o(h)249
1534 y(pro)q(cess)f(is)h(the)g(rank)g(/)g(\(ro)o(w,col\))f(in)h(the)g
(original)e(2D)j(top)q(ology)d(and)h(the)h(lo)o(w)o(er)g(v)n(alues)f
(are)h(the)g(same)f(for)249 1572 y(the)h(shifted)f(2D)h(top)q(ology)m
(.)i(Note)e(that)g(ro)o(ws)g(and)g(columns)e(of)i(pro)q(cesses)f
(remain)g(in)o(tact.)249 1740 y FD(6.4)52 b(Em)o(b)q(edding)18
b(in)g Fw(MPI)249 1848 y FA(The)j(supp)q(ort)f(for)g(virtual)f(top)q
(ologies)h(as)g(de\014ned)h(in)e(this)i(c)o(hapter)g(is)f(consisten)o
(t)h(with)249 1902 y(other)13 b(parts)g(of)e Fw(MPI)p
FA(,)g(and,)h(whenev)o(er)i(p)q(ossible,)e(mak)o(es)f(use)i(of)f
(functions)g(that)h(are)f(de\014ned)249 1956 y(elsewhere.)40
b(T)m(op)q(ology)19 b(information)e(is)k(asso)q(ciated)g(with)f(comm)o
(unicators.)35 b(It)21 b(can)g(b)q(e)249 2010 y(implemen)o(ted)12
b(using)h(the)i(cac)o(hing)f(mec)o(hanism)d(describ)q(ed)16
b(in)d(Chapter)i(5.)249 2102 y FB(R)n(ationale.)48 b
FA(As)16 b(with)f(collectiv)o(e)h(comm)o(uni)o(cations,)d(the)j
(virtual)f(top)q(ology)f(features)j(can)249 2156 y(b)q(e)k(la)o(y)o
(ered)f(on)h(top)f(of)g(p)q(oin)o(t-to-p)q(oin)o(t)f(and)h(comm)o
(unicator)d(functionalit)o(y)m(.)36 b(By)20 b(doing)249
2209 y(this,)15 b(a)f(la)o(y)o(ered)h(implemen)o(tation)d(is)i(p)q
(ossible,)h(though)g(not)g(required.)22 b(A)15 b(consequence)i(of)249
2263 y(this)d(design)h(is)f(that)h(top)q(ology)e(information)e(is)j
(not)h(giv)o(en)f(directly)g(to)g(p)q(oin)o(t-to-p)q(oin)o(t)f(nor)249
2317 y(collectiv)o(e)i(routines.)24 b(Instead,)16 b(the)g(top)q(ology)e
(in)o(terface)i(pro)o(vides)f(functions)h(to)f(translate)249
2371 y(b)q(et)o(w)o(een)i(the)e(virtual)g(top)q(ology)f(and)h(the)h
(ranks)f(used)h(in)f Fw(MPI)g FA(comm)o(uni)o(cation)d(routines.)249
2425 y(\()p FB(End)k(of)f(r)n(ationale.)p FA(\))p eop
%%Page: 257 271
257 270 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(257)249 507 y FD(6.5)52 b(Cartesian)18 b(T)l(op)q(ology)h(F)l
(unctions)249 615 y FA(This)14 b(section)g(describ)q(es)i(the)f
Fw(MPI)e FA(functions)h(for)g(creating)g(Cartesian)g(top)q(ologies.)249
698 y Fs(6.5.1)48 b(Cartesian)14 b(Constructor)g(F)l(unction)249
781 y Fw(MPI)p 326 781 13 2 v 14 w(CART)p 450 781 V 15
w(CREA)m(TE)g FA(can)i(b)q(e)g(used)h(to)e(describ)q(e)j(Cartesian)e
(structures)i(of)d(arbitrary)h(di-)249 835 y(mension.)h(F)m(or)c(eac)o
(h)g(co)q(ordinate)h(direction)g(one)f(sp)q(eci\014es)i(whether)g(the)f
(pro)q(cess)h(structure)249 889 y(is)i(p)q(erio)q(dic)g(or)g(not.)26
b(F)m(or)17 b(a)f(1D)g(top)q(ology)m(,)g(it)g(is)h(linear)f(if)g(it)g
(is)h(not)g(p)q(erio)q(dic)g(and)f(a)h(ring)249 943 y(if)e(it)h(is)f(p)
q(erio)q(dic.)25 b(F)m(or)15 b(a)h(2D)f(top)q(ology)m(,)f(it)i(is)g(a)f
(rectangle,)i(cylinder,)f(or)g(torus)g(as)g(it)g(go)q(es)249
997 y(from)h(non-p)q(erio)q(dic)i(to)g(p)q(erio)q(dic)g(in)g(one)g
(dimension)e(to)i(fully)f(p)q(erio)q(dic.)33 b(Note)20
b(that)f(an)249 1051 y Fp(n)p FA(-dimensional)10 b(h)o(yp)q(ercub)q(e)j
(is)f(an)g Fp(n)p FA(-dimensional)e(torus)i(with)g(2)g(pro)q(cesses)i
(p)q(er)f(co)q(ordinate)249 1105 y(direction.)18 b(Th)o(us,)c(sp)q
(ecial)g(supp)q(ort)h(for)e(h)o(yp)q(ercub)q(e)j(structures)h(is)c(not)
h(necessary)m(.)249 1230 y Fw(MPI)p 326 1230 V 14 w(CART)p
450 1230 V 15 w(CREA)m(TE\(comm)p 744 1230 V 11 w(old,)g(ndims,)f
(dims,)f(p)q(erio)q(ds,)j(reo)o(rder,)g(comm)p 1469 1230
V 13 w(ca)o(rt\))332 1305 y Fv(IN)172 b Fw(comm)p 656
1305 V 13 w(old)360 b Fv(input)15 b(comm)o(unicator)332
1354 y(IN)172 b Fw(ndims)430 b Fv(n)o(um)o(b)q(er)14
b(of)f(dimensions)j(of)c(Cartesian)i(grid)332 1404 y(IN)172
b Fw(dims)451 b Fv(in)o(teger)11 b(arra)o(y)g(of)e(size)i
Fq(ndims)e Fv(sp)q(ecifying)j(the)1079 1458 y(n)o(um)o(b)q(er)i(of)f
(pro)q(cesses)h(in)g(eac)o(h)f(dimension)332 1508 y(IN)172
b Fw(p)q(erio)q(ds)409 b Fv(logical)11 b(arra)o(y)f(of)e(size)i
Fq(ndims)d Fv(sp)q(ecifying)k(whether)1079 1562 y(the)k(grid)g(is)g(p)q
(erio)q(dic)i(\()p Fq(true)p Fv(\))d(or)h(not)f(\()p
Fq(false)p Fv(\))1079 1616 y(in)g(eac)o(h)f(dimension)332
1666 y(IN)172 b Fw(reo)o(rder)413 b Fv(ranks)22 b(ma)o(y)e(b)q(e)h
(reordered)g(\()p Fq(true)p Fv(\))f(or)h(not)1079 1720
y(\()p Fq(false)p Fv(\))332 1770 y(OUT)128 b Fw(comm)p
656 1770 V 13 w(ca)o(rt)346 b Fv(comm)o(unicator)11 b(with)e(new)g
(Cartesian)g(top)q(ol-)1079 1823 y(ogy)249 1934 y Fr(int)21
b(MPI)p 405 1934 14 2 v 15 w(Cart)p 508 1934 V 15 w(create\(MPI)p
743 1934 V 14 w(Comm)g(comm)p 954 1934 V 15 w(old,)g(int)g(ndims,)f
(int)h(*dims,)540 1988 y(int)g(*periods,)f(int)h(reorder,)f(MPI)p
1197 1988 V 15 w(Comm)h(*comm)p 1431 1988 V 15 w(cart\))249
2072 y(MPI)p 318 2072 V 15 w(CART)p 421 2072 V 15 w(CREATE\(COMM)p
678 2072 V 13 w(OLD,)g(NDIMS,)g(DIMS,)g(PERIODS,)f(REORDER,)g(COMM)p
1564 2072 V 15 w(CART,)540 2126 y(IERROR\))336 2179 y(INTEGER)h(COMM)p
602 2179 V 14 w(OLD,)g(NDIMS,)g(DIMS\(*\),)f(COMM)p 1162
2179 V 15 w(CART,)h(IERROR)336 2233 y(LOGICAL)g(PERIODS\(*\),)e
(REORDER)291 2317 y Fw(MPI)p 368 2317 13 2 v 14 w(CART)p
492 2317 V 14 w(CREA)m(TE)9 b FA(returns)j(a)d(handle)i(to)f(a)g(new)g
(comm)o(unicator)e(to)i(whic)o(h)g(the)h(Carte-)249 2371
y(sian)19 b(top)q(ology)f(information)e(is)j(attac)o(hed.)34
b(In)19 b(analogy)f(to)h(the)h(function)f Fw(MPI)p 1588
2371 V 14 w(COMM-)p 249 2425 V 262 2425 a(CREA)m(TE)p
FA(,)12 b(no)i(cac)o(hed)h(information)d(propagates)j(to)f(the)h(new)g
(comm)o(unicator.)i(Also,)c(this)p eop
%%Page: 258 272
258 271 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(258)1256 b(Chapter)13 b(6)249
507 y FA(function)i(is)g(collectiv)o(e.)21 b(As)16 b(with)f(other)g
(collectiv)o(e)g(calls,)g(the)h(program)d(m)o(ust)h(b)q(e)i(written)249
561 y(to)e(w)o(ork)f(correctly)m(,)i(whether)g(the)f(call)f(sync)o
(hronizes)j(or)e(not.)291 615 y(If)k Fw(reo)o(rder)i(=)g(false)e
FA(then)i(the)f(rank)g(of)f(eac)o(h)i(pro)q(cess)g(in)f(the)g(new)h
(group)e(is)h(iden)o(tical)249 669 y(to)e(its)h(rank)f(in)g(the)h(old)f
(group.)29 b(Otherwise,)19 b(the)f(function)f(ma)o(y)f(reorder)j(the)f
(pro)q(cesses)249 723 y(\(p)q(ossibly)10 b(so)h(as)g(to)f(c)o(ho)q(ose)
i(a)e(go)q(o)q(d)g(em)o(b)q(edding)g(of)f(the)j(virtual)d(top)q(ology)h
(on)o(to)g(the)h(ph)o(ysical)249 777 y(mac)o(hine\).)31
b(If)18 b(the)i(total)d(size)j(of)e(the)h(Cartesian)g(grid)f(is)h
(smaller)e(than)h(the)h(size)h(of)e(the)249 831 y(group)13
b(of)f Fw(comm)p 521 831 13 2 v 13 w(old)p FA(,)h(then)h(some)e(pro)q
(cesses)j(are)f(returned)g Fq(MPI)p 1292 831 12 2 v 13
w(COMM)p 1426 831 V 13 w(NULL)p FA(,)e(in)h(analogy)249
885 y(to)g Fw(MPI)p 376 885 13 2 v 14 w(COMM)p 520 885
V 15 w(SPLIT)p FA(.)f(The)i(call)e(is)h(erroneous)i(if)d(it)h(sp)q
(eci\014es)i(a)e(grid)f(that)h(is)g(larger)g(than)249
939 y(the)i(group)e(size.)249 1030 y FB(A)n(dvic)n(e)j(to)g
(implementors.)45 b Fw(MPI)p 813 1030 V 14 w(CART)p 937
1030 V 15 w(CREA)m(TE)13 b FA(can)j(b)q(e)g(implemen)o(ted)d(b)o(y)i
(creating)h(a)249 1084 y(new)g(comm)o(unicator,)e(and)h(cac)o(hing)h
(with)g(the)g(new)g(comm)o(unicator)d(a)j(description)h(of)e(the)249
1138 y(Cartesian)f(grid,)f(e.g.,)291 1209 y(1.)20 b Fr(ndims)12
b FA(\(n)o(um)o(b)q(er)i(of)f(dimensions\),)291 1279
y(2.)20 b Fr(dims)13 b FA(\(n)o(um)o(b)q(ers)g(of)h(pro)q(cesses)i(p)q
(er)f(co)q(ordinate)f(direction\),)291 1350 y(3.)20 b
Fr(periods)12 b FA(\(p)q(erio)q(dicit)o(y)i(information\),)291
1421 y(4.)20 b Fr(own_position)11 b FA(\(o)o(wn)j(p)q(osition)f(in)g
(grid\))249 1491 y(\()p FB(End)j(of)f(advic)n(e)g(to)g(implementors.)p
FA(\))249 1582 y Fs(6.5.2)48 b(Cartesian)14 b(Con)o(v)o(enience)g(F)l
(unction:)19 b Fw(MPI)p 1181 1582 V 14 w(DIMS)p 1296
1582 V 15 w(CREA)m(TE)249 1665 y FA(F)m(or)g(Cartesian)h(top)q
(ologies,)g(the)g(function)f Fw(MPI)p 1058 1665 V 15
w(DIMS)p 1174 1665 V 14 w(CREA)m(TE)f FA(helps)i(the)g(user)h(select)
249 1719 y(a)e(balanced)h(distribution)f(of)g(pro)q(cesses)j(p)q(er)e
(co)q(ordinate)g(direction,)g(dep)q(ending)h(on)e(the)249
1773 y(n)o(um)o(b)q(er)13 b(of)f(pro)q(cesses)k(in)d(the)h(group)f(to)g
(b)q(e)h(balanced)g(and)f(optional)f(constrain)o(ts)i(that)f(can)249
1827 y(b)q(e)18 b(sp)q(eci\014ed)g(b)o(y)e(the)i(user.)28
b(One)17 b(p)q(ossible)h(use)f(of)f(this)h(function)g(is)g(to)f
(partition)g(all)g(the)249 1881 y(pro)q(cesses)g(\(the)f(size)f(of)f
Fq(MPI)p 713 1881 12 2 v 13 w(COMM)p 847 1881 V 13 w(W)o(ORLD)p
FA('s)g(group\))h(in)o(to)f(an)g Fp(n)p FA(-dimensional)f(top)q(ology)m
(.)249 2006 y Fw(MPI)p 326 2006 13 2 v 14 w(DIMS)p 441
2006 V 15 w(CREA)m(TE\(nno)q(des,)i(ndims,)f(dims\))332
2081 y Fv(IN)172 b Fw(nno)q(des)413 b Fv(n)o(um)o(b)q(er)14
b(of)f(no)q(des)h(in)g(a)f(grid)332 2131 y(IN)172 b Fw(ndims)430
b Fv(n)o(um)o(b)q(er)14 b(of)f(Cartesian)h(dimensions)332
2180 y(INOUT)85 b Fw(dims)451 b Fv(in)o(teger)11 b(arra)o(y)e(of)g
(size)h Fc(ndims)d Fv(sp)q(ecifying)12 b(the)1079 2234
y(n)o(um)o(b)q(er)i(of)f(no)q(des)h(in)g(eac)o(h)f(dimension)249
2345 y Fr(int)21 b(MPI)p 405 2345 14 2 v 15 w(Dims)p
508 2345 V 15 w(create\(int)f(nnodes,)g(int)h(ndims,)g(int)g(*dims\))
249 2429 y(MPI)p 318 2429 V 15 w(DIMS)p 421 2429 V 15
w(CREATE\(NNODES,)e(NDIMS,)h(DIMS,)h(IERROR\))336 2483
y(INTEGER)g(NNODES,)f(NDIMS,)g(DIMS\(*\),)h(IERROR)p
eop
%%Page: 259 273
259 272 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(259)291 507 y FA(The)18 b(en)o(tries)i(in)e(the)h(arra)o(y)f
Fw(dims)g FA(are)g(set)i(to)e(describ)q(e)i(a)e(Cartesian)h(grid)f
(with)g Fw(ndims)249 561 y FA(dimensions)c(and)h(a)h(total)e(of)h
Fw(nno)q(des)i FA(no)q(des.)24 b(The)15 b(dimensions)g(are)g(set)i(to)e
(b)q(e)h(as)g(close)g(to)249 615 y(eac)o(h)f(other)f(as)g(p)q(ossible,)
g(using)g(an)g(appropriate)g(divisibilit)o(y)d(algorithm.)16
b(The)e(caller)g(ma)o(y)249 669 y(further)e(constrain)g(the)g(op)q
(eration)g(of)f(this)g(routine)h(b)o(y)f(sp)q(ecifying)g(elemen)o(ts)h
(of)f(arra)o(y)g Fr(dims)p FA(.)249 723 y(If)k Fr(dims[i])e
FA(is)i(set)h(to)e(a)h(p)q(ositiv)o(e)g(n)o(um)o(b)q(er,)f(the)h
(routine)g(will)f(not)h(mo)q(dify)d(the)k(n)o(um)o(b)q(er)e(of)249
777 y(no)q(des)j(in)e(dimension)g Fr(i)p FA(;)h(only)f(those)i(en)o
(tries)g(where)g Fr(dims[i])j(=)i(0)15 b FA(are)i(mo)q(di\014ed)d(b)o
(y)i(the)249 831 y(call.)291 885 y(Negativ)o(e)d(input)f(v)n(alues)h
(of)g Fr(dims[i])e FA(are)j(erroneous.)19 b(An)13 b(error)h(will)d(o)q
(ccur)k(if)d Fr(nnodes)g FA(is)249 939 y(not)i(a)f(m)o(ultiple)f(of)625
900 y Fi(Y)567 991 y Fj(i;dims)p Fk([)p Fj(i)p Fk(])p
Fm(6)p Fk(=0)743 939 y Fp(dims)p FA([)p Fp(i)p FA(].)291
1035 y(F)m(or)f Fr(dims[i])f FA(set)j(b)o(y)e(the)i(call,)e
Fr(dims[i])f FA(will)g(b)q(e)j(ordered)f(in)g(monotonically)c
(decreasing)249 1089 y(order.)38 b(Arra)o(y)20 b Fr(dims)f
FA(is)h(suitable)g(for)g(use)h(as)g(input)f(to)g(routine)g
Fw(MPI)p 1440 1089 13 2 v 14 w(CART)p 1564 1089 V 15
w(CREA)m(TE)p FA(.)249 1143 y Fw(MPI)p 326 1143 V 14
w(DIMS)p 441 1143 V 15 w(CREA)m(TE)12 b FA(is)i(lo)q(cal.)j(Sev)o(eral)
d(sample)f(calls)h(are)g(sho)o(wn)g(in)f(Example)g(6.1.)249
1386 y Fs(Example)i(6.1)p 528 1213 1152 2 v 527 1267
2 54 v 553 1251 a Fr(dims)p 764 1267 V 149 w FA(function)e(call)p
1379 1267 V 390 w Fr(dims)p 1678 1267 V 527 1321 V 553
1304 a FA(b)q(efore)h(call)p 764 1321 V 1379 1321 V 665
w(on)f(return)p 1678 1321 V 528 1322 1152 2 v 527 1376
2 54 v 553 1360 a(\(0,0\))p 764 1376 V 151 w Fw(MPI)p
867 1360 13 2 v 14 w(DIMS)p 982 1360 V 15 w(CREA)m(TE\(6,)e(2,)i
(dims\))p 1379 1376 2 54 v 50 w FA(\(3,2\))p 1678 1376
V 527 1430 V 553 1414 a(\(0,0\))p 764 1430 V 151 w Fw(MPI)p
867 1414 13 2 v 14 w(DIMS)p 982 1414 V 15 w(CREA)m(TE\(7,)e(2,)i
(dims\))p 1379 1430 2 54 v 50 w FA(\(7,1\))p 1678 1430
V 527 1484 V 553 1468 a(\(0,3,0\))p 764 1484 V 118 w
Fw(MPI)p 867 1468 13 2 v 14 w(DIMS)p 982 1468 V 15 w(CREA)m(TE\(6,)e
(3,)i(dims\))p 1379 1484 2 54 v 50 w FA(\(2,3,1\))p 1678
1484 V 527 1538 V 553 1522 a(\(0,3,0\))p 764 1538 V 118
w Fw(MPI)p 867 1522 13 2 v 14 w(DIMS)p 982 1522 V 15
w(CREA)m(TE\(7,)e(3,)i(dims\))p 1379 1538 2 54 v 50 w
FA(erroneous)i(call)p 1678 1538 V 528 1540 1152 2 v 249
1682 a Fs(6.5.3)48 b(Cartesian)14 b(Inquiry)h(F)l(unctions)249
1765 y FA(Once)21 b(a)e(Cartesian)h(top)q(ology)e(is)h(set)h(up,)h(it)e
(ma)o(y)e(b)q(e)k(necessary)g(to)e(inquire)g(ab)q(out)h(the)249
1819 y(top)q(ology)m(.)c(These)g(functions)e(are)g(giv)o(en)f(b)q(elo)o
(w)h(and)g(are)g(all)e(lo)q(cal)i(calls.)249 1944 y Fw(MPI)p
326 1944 13 2 v 14 w(CARTDIM)p 528 1944 V 14 w(GET\(comm,)e(ndims\))332
2019 y Fv(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)15
b(with)e(Cartesian)i(structure)332 2068 y(OUT)128 b Fw(ndims)430
b Fv(n)o(um)o(b)q(er)17 b(of)e(dimensions)k(of)c(the)h(Cartesian)1079
2122 y(structure)249 2232 y Fr(int)21 b(MPI)p 405 2232
14 2 v 15 w(Cartdim)p 574 2232 V 15 w(get\(MPI)p 743
2232 V 14 w(Comm)g(comm,)g(int)g(*ndims\))249 2316 y(MPI)p
318 2316 V 15 w(CARTDIM)p 487 2316 V 14 w(GET\(COMM,)f(NDIMS,)h
(IERROR\))336 2370 y(INTEGER)g(COMM,)f(NDIMS,)h(IERROR)291
2454 y Fw(MPI)p 368 2454 13 2 v 14 w(CARTDIM)p 570 2454
V 14 w(GET)10 b FA(returns)i(the)g(n)o(um)o(b)q(er)e(of)g(dimensions)f
(of)h(the)h(Cartesian)g(structure)249 2508 y(asso)q(ciated)18
b(with)f Fw(comm)p FA(.)27 b(This)18 b(can)f(b)q(e)h(used)h(to)e(pro)o
(vide)g(the)h(other)g(Cartesian)g(inquiry)p eop
%%Page: 260 274
260 273 bop 2 223 2 150 v 2 76 150 2 v 1928 76 V 2076
225 2 150 v 249 251 a Fv(260)1256 b(Chapter)13 b(6)249
507 y FA(functions)i(with)g(the)h(correct)g(size)g(of)e(arra)o(ys.)22
b(The)15 b(comm)o(unicator)e(with)h(the)i(top)q(ology)e(in)249
561 y(Figure)g(6.1)f(w)o(ould)g(return)i Fw(ndims)c FA(=)h(2.)249
686 y Fw(MPI)p 326 686 13 2 v 14 w(CART)p 450 686 V 15
w(GET\(comm,)f(maxdims,)h(dims,)g(p)q(erio)q(ds,)j(co)q(o)o(rds\))332
761 y Fv(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)15
b(with)e(Cartesian)i(structure)332 811 y(IN)172 b Fw(maxdims)378
b Fv(length)22 b(of)f(v)o(ectors)g Fc(dims,)c(periods)p
Fv(,)j(and)1079 865 y Fc(coords)11 b Fv(in)j(the)f(calling)i(program)
332 914 y(OUT)128 b Fw(dims)451 b Fv(n)o(um)o(b)q(er)16
b(of)e(pro)q(cesses)i(for)f(eac)o(h)g(Cartesian)1079
968 y(dimension)332 1018 y(OUT)128 b Fw(p)q(erio)q(ds)409
b Fv(p)q(erio)q(dicit)o(y)22 b(\()p Fq(true)p Fv(/)p
Fq(false)p Fv(\))c(for)g(eac)o(h)i(Carte-)1079 1072 y(sian)14
b(dimension)332 1122 y(OUT)128 b Fw(co)q(o)o(rds)421
b Fv(co)q(ordinates)17 b(of)e(calling)i(pro)q(cess)f(in)g(Carte-)1079
1176 y(sian)e(structure)249 1286 y Fr(int)21 b(MPI)p
405 1286 14 2 v 15 w(Cart)p 508 1286 V 15 w(get\(MPI)p
677 1286 V 14 w(Comm)g(comm,)g(int)g(maxdims,)f(int)i(*dims,)e(int)h
(*periods,)540 1340 y(int)g(*coords\))249 1424 y(MPI)p
318 1424 V 15 w(CART)p 421 1424 V 15 w(GET\(COMM,)f(MAXDIMS,)g(DIMS,)h
(PERIODS,)f(COORDS,)g(IERROR\))336 1478 y(INTEGER)h(COMM,)f(MAXDIMS,)g
(DIMS\(*\),)h(COORDS\(*\),)e(IERROR)336 1532 y(LOGICAL)i(PERIODS\(*\))
291 1616 y Fw(MPI)p 368 1616 13 2 v 14 w(CART)p 492 1616
V 14 w(GET)15 b FA(returns)i(information)12 b(on)j(the)h(Cartesian)g
(top)q(ology)e(asso)q(ciated)i(with)249 1670 y Fw(comm)p
FA(.)24 b Fw(maxdims)15 b FA(m)o(ust)h(b)q(e)h(at)f(least)h
Fw(ndims)f FA(as)h(returned)h(b)o(y)f Fw(MPI)p 1360 1670
V 14 w(CARTDIM)p 1562 1670 V 14 w(GET)p FA(.)f(F)m(or)249
1724 y(the)h(example)d(in)i(Figure)g(6.1,)f Fw(dims)f
FA(=)i(\(3)p Fp(;)7 b FA(4\).)23 b(The)17 b Fw(co)q(o)o(rds)f
FA(are)g(as)g(giv)o(en)g(for)g(the)g(rank)g(of)249 1778
y(the)f(calling)d(pro)q(cess)k(as)e(sho)o(wn,)f(e.g.,)g(pro)q(cess)i(6)
f(returns)i Fw(co)q(o)o(rds)c FA(=)f(\(1)p Fp(;)c FA(2\).)249
1861 y Fs(6.5.4)48 b(Cartesian)14 b(T)l(ranslator)g(F)l(unctions)249
1944 y FA(The)e(functions)f(in)g(this)h(section)g(translate)f(to/from)f
(the)i(rank)f(and)g(the)h(Cartesian)g(top)q(ology)249
1998 y(co)q(ordinates.)19 b(These)c(calls)e(are)i(lo)q(cal.)249
2123 y Fw(MPI)p 326 2123 V 14 w(CART)p 450 2123 V 15
w(RANK\(comm,)c(co)q(o)o(rds,)j(rank\))332 2197 y Fv(IN)172
b Fw(comm)425 b Fv(comm)o(unicator)15 b(with)e(Cartesian)i(structure)
332 2247 y(IN)172 b Fw(co)q(o)o(rds)421 b Fv(in)o(teger)22
b(arra)o(y)g(sp)q(ecifying)h(the)e(Cartesian)1079 2301
y(co)q(ordinates)15 b(of)e(a)g(pro)q(cess)332 2351 y(OUT)128
b Fw(rank)457 b Fv(rank)14 b(of)f(sp)q(eci\014ed)i(pro)q(cess)249
2461 y Fr(int)21 b(MPI)p 405 2461 14 2 v 15 w(Cart)p
508 2461 V 15 w(rank\(MPI)p 699 2461 V 14 w(Comm)g(comm,)g(int)g
(*coords,)f(int)h(*rank\))p eop
%%Page: 261 275
261 274 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(261)249 507 y Fr(MPI)p 318 507 14 2 v 15 w(CART)p 421
507 V 15 w(RANK\(COMM,)20 b(COORDS,)g(RANK,)h(IERROR\))336
561 y(INTEGER)g(COMM,)f(COORDS\(*\),)g(RANK,)h(IERROR)291
645 y FA(F)m(or)d(a)h(pro)q(cess)j(group)d(with)g(Cartesian)g
(structure,)j(the)e(function)f Fw(MPI)p 1494 645 13 2
v 15 w(CART)p 1619 645 V 14 w(RANK)249 699 y FA(translates)c(the)g
(logical)e(pro)q(cess)j(co)q(ordinates)g(to)e(pro)q(cess)i(ranks)f(as)f
(they)h(are)g(used)h(b)o(y)e(the)249 753 y(p)q(oin)o(t-to-p)q(oin)o(t)d
(routines.)19 b Fw(co)q(o)o(rds)13 b FA(is)f(an)h(arra)o(y)f(of)g(size)
i Fw(ndims)e FA(as)h(returned)i(b)o(y)d Fw(MPI)p 1608
753 V 14 w(CART-)249 807 y(DIM)p 329 807 V 15 w(GET)p
FA(.)h(F)m(or)g(the)i(example)d(in)i(Figure)g(6.1,)e
Fw(co)q(o)o(rds)g FA(=)g(\(1)p Fp(;)7 b FA(2\))13 b(w)o(ould)g(return)i
Fw(rank)e FA(=)f(6.)291 861 y(F)m(or)d(dimension)g Fr(i)h
FA(with)f Fr(periods\(i\))20 b(=)i(true)p FA(,)9 b(if)g(the)i(co)q
(ordinate,)g Fr(coords\(i\))p FA(,)d(is)i(out)g(of)249
915 y(range,)j(that)h(is,)f Fr(coords\(i\))19 b Fp(<)k
Fr(0)13 b FA(or)g Fr(coords\(i\))20 b Ft(\025)i Fr(dims\(i\))p
FA(,)11 b(it)i(is)h(shifted)f(bac)o(k)h(to)f(the)249
969 y(in)o(terv)n(al)d Fr(0)22 b Ft(\024)g Fr(coords\(i\))e
Fp(<)i Fr(dims\(i\))9 b FA(automatically)m(.)14 b(If)c(the)i(top)q
(ology)e(in)g(Figure)i(6.1)e(is)249 1023 y(p)q(erio)q(dic)h(in)e(b)q
(oth)i(dimensions)d(\(torus\),)k(then)f Fw(co)q(o)o(rds)h
FA(=)f(\(4)p Fp(;)c FA(6\))j(w)o(ould)f(also)h(return)h
Fw(rank)h FA(=)g(6.)249 1077 y(Out-of-range)i(co)q(ordinates)g(are)h
(erroneous)g(for)e(non-p)q(erio)q(dic)h(dimensions.)249
1202 y Fw(MPI)p 326 1202 V 14 w(CART)p 450 1202 V 15
w(COORDS\(comm)o(,)d(rank,)j(maxdims,)e(co)q(o)o(rds\))332
1276 y Fv(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)15
b(with)e(Cartesian)i(structure)332 1326 y(IN)172 b Fw(rank)457
b Fv(rank)13 b(of)g(a)f(pro)q(cess)i(within)g(group)f(of)f
Fq(comm)332 1376 y Fv(IN)172 b Fw(maxdims)378 b Fv(length)11
b(of)f(v)o(ector)f Fc(coord)f Fv(in)i(the)g(calling)i(pro-)1079
1430 y(gram)332 1480 y(OUT)128 b Fw(co)q(o)o(rds)421
b Fv(in)o(teger)20 b(arra)o(y)g(con)o(taining)h(the)e(Cartesian)1079
1534 y(co)q(ordinates)c(of)e(sp)q(eci\014ed)i(pro)q(cess)249
1644 y Fr(int)21 b(MPI)p 405 1644 14 2 v 15 w(Cart)p
508 1644 V 15 w(coords\(MPI)p 743 1644 V 14 w(Comm)g(comm,)g(int)g
(rank,)f(int)i(maxdims,)540 1698 y(int)f(*coords\))249
1782 y(MPI)p 318 1782 V 15 w(CART)p 421 1782 V 15 w(COORDS\(COMM,)e
(RANK,)i(MAXDIMS,)f(COORDS,)h(IERROR\))336 1836 y(INTEGER)g(COMM,)f
(RANK,)h(MAXDIMS,)f(COORDS\(*\),)g(IERROR)291 1920 y
Fw(MPI)p 368 1920 13 2 v 14 w(CART)p 492 1920 V 14 w(COORDS)10
b FA(is)i(the)g(rank-to-co)q(ordinates)g(translator.)17
b(It)12 b(is)g(the)g(in)o(v)o(erse)g(map-)249 1974 y(ping)21
b(of)g Fw(MPI)p 481 1974 V 14 w(CART)p 605 1974 V 14
w(RANK)p FA(.)g Fw(maxdims)e FA(is)j(at)f(least)g(as)h(big)f(as)g
Fw(ndims)g FA(as)h(returned)h(b)o(y)249 2028 y Fw(MPI)p
326 2028 V 14 w(CARTDIM)p 528 2028 V 14 w(GET)p FA(.)10
b(F)m(or)f(the)i(example)d(in)i(Figure)g(6.1,)f Fw(rank)j
FA(=)g(6)e(w)o(ould)f(return)i Fw(co)q(o)o(rds)h FA(=)249
2082 y(\(1)p Fp(;)7 b FA(2\).)249 2165 y Fs(6.5.5)48
b(Cartesian)14 b(Shift)g(F)l(unction)249 2248 y FA(If)k(the)h(pro)q
(cess)h(top)q(ology)d(is)h(a)g(Cartesian)g(structure,)j(a)d
Fw(MPI)p 1282 2248 V 14 w(SENDRECV)f FA(op)q(eration)i(is)249
2302 y(lik)o(ely)12 b(to)i(b)q(e)g(used)h(along)d(a)h(co)q(ordinate)h
(direction)g(to)g(p)q(erform)f(a)g(shift)g(of)g(data.)18
b(As)c(input,)249 2356 y Fw(MPI)p 326 2356 V 14 w(SENDRECV)e
FA(tak)o(es)i(the)f(rank)g(of)f(a)h(source)h(pro)q(cess)h(for)d(the)i
(receiv)o(e,)g(and)f(the)g(rank)g(of)249 2410 y(a)i(destination)g(pro)q
(cess)i(for)e(the)g(send.)23 b(A)15 b(Cartesian)g(shift)g(op)q(eration)
g(is)g(sp)q(eci\014ed)i(b)o(y)e(the)249 2464 y(co)q(ordinate)f(of)g
(the)g(shift)g(and)g(b)o(y)f(the)i(size)g(of)e(the)h(shift)g(step)h
(\(p)q(ositiv)o(e)f(or)g(negativ)o(e\).)k(The)p eop
%%Page: 262 276
262 275 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(262)1256 b(Chapter)13 b(6)249
507 y FA(function)k Fw(MPI)p 492 507 13 2 v 14 w(CART)p
616 507 V 14 w(SHIFT)g FA(inputs)g(suc)o(h)h(sp)q(eci\014cation)g(and)e
(returns)j(the)e(information)249 561 y(needed)e(to)f(call)f
Fw(MPI)p 591 561 V 15 w(SENDRECV)p FA(.)f(The)i(function)g
Fw(MPI)p 1167 561 V 14 w(CART)p 1291 561 V 14 w(SHIFT)g
FA(is)g(lo)q(cal.)249 686 y Fw(MPI)p 326 686 V 14 w(CART)p
450 686 V 15 w(SHIFT\(comm,)d(direction,)k(disp,)f(rank)p
1071 686 V 16 w(source,)h(rank)p 1297 686 V 15 w(dest\))332
761 y Fv(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)15
b(with)e(Cartesian)i(structure)332 809 y(IN)172 b Fw(direction)384
b Fv(co)q(ordinate)15 b(dimension)h(of)c(shift)332 858
y(IN)172 b Fw(disp)464 b Fv(displacemen)o(t)17 b(\()p
Fb(>)c Fv(0:)20 b(up)o(w)o(ards)15 b(shift,)h Fb(<)d
Fv(0:)1079 912 y(do)o(wn)o(w)o(ards)h(shift\))332 960
y(OUT)128 b Fw(rank)p 624 960 V 15 w(source)334 b Fv(rank)14
b(of)f(source)g(pro)q(cess)332 1008 y(OUT)128 b Fw(rank)p
624 1008 V 15 w(dest)372 b Fv(rank)14 b(of)f(destination)i(pro)q(cess)
249 1119 y Fr(int)21 b(MPI)p 405 1119 14 2 v 15 w(Cart)p
508 1119 V 15 w(shift\(MPI)p 721 1119 V 14 w(Comm)g(comm,)g(int)g
(direction,)f(int)h(disp,)540 1172 y(int)g(*rank)p 740
1172 V 14 w(source,)g(int)g(*rank)p 1126 1172 V 15 w(dest\))249
1256 y(MPI)p 318 1256 V 15 w(CART)p 421 1256 V 15 w(SHIFT\(COMM,)f
(DIRECTION,)f(DISP,)i(RANK)p 1156 1256 V 15 w(SOURCE,)f(RANK)p
1433 1256 V 15 w(DEST,)h(IERROR\))336 1310 y(INTEGER)g(COMM,)f
(DIRECTION,)g(DISP,)h(RANK)p 1103 1310 V 15 w(SOURCE,)f(RANK)p
1380 1310 V 15 w(DEST,)h(IERROR)291 1394 y FA(The)15
b Fw(direction)i FA(argumen)o(t)d(indicates)h(the)h(dimension)d(of)h
(the)i(shift,)f(i.e.,)e(the)j(co)q(ordinate)249 1448
y(whose)k(v)n(alue)e(is)h(mo)q(di\014ed)f(b)o(y)g(the)i(shift.)33
b(The)20 b(co)q(ordinates)f(are)h(n)o(um)o(b)q(ered)f(from)e
Fw(0)i FA(to)249 1502 y Fw(ndims-1)p FA(,)13 b(where)i
Fw(ndims)e FA(is)h(the)h(n)o(um)o(b)q(er)e(of)g(dimensions.)291
1556 y(Dep)q(ending)h(on)h(the)g(p)q(erio)q(dicit)o(y)f(of)g(the)h
(Cartesian)g(group)f(in)g(the)h(sp)q(eci\014ed)h(co)q(ordinate)249
1610 y(direction,)21 b Fw(MPI)p 518 1610 13 2 v 14 w(CART)p
642 1610 V 15 w(SHIFT)e FA(pro)o(vides)h(the)g(iden)o(ti\014ers)h(for)e
(a)h(circular)g(or)g(an)f(end-o\013)249 1664 y(shift.)f(In)13
b(the)g(case)h(of)f(an)g(end-o\013)g(shift,)g(the)g(v)n(alue)g
Fq(MPI)p 1161 1664 12 2 v 13 w(PROC)p 1277 1664 V 13
w(NULL)g FA(ma)o(y)e(b)q(e)j(returned)h(in)249 1718 y
Fw(rank)p 326 1718 13 2 v 16 w(source)g FA(and/or)e Fw(rank)p
678 1718 V 16 w(dest)p FA(,)h(indicating)e(that)i(the)h(source)g
(and/or)e(the)h(destination)g(for)249 1772 y(the)h(shift)e(is)h(out)g
(of)f(range.)18 b(This)c(is)g(a)f(v)n(alid)g(input)g(to)h(the)h
(sendrecv)g(functions.)291 1826 y(Neither)k Fw(MPI)p
521 1826 V 14 w(CART)p 645 1826 V 14 w(SHIFT)p FA(,)f(nor)g
Fw(MPI)p 958 1826 V 14 w(SENDRECV)f FA(are)i(collectiv)o(e)f
(functions.)30 b(It)19 b(is)249 1880 y(not)f(required)h(that)f(all)f
(pro)q(cesses)k(in)c(the)i(grid)e(call)h Fw(MPI)p 1209
1880 V 14 w(CART)p 1333 1880 V 14 w(SHIFT)g FA(with)g(the)g(same)249
1934 y Fw(direction)d FA(and)d Fw(disp)i FA(argumen)o(ts,)e(but)h(only)
f(that)h(sends)h(matc)o(h)e(receiv)o(es)j(in)d(the)i(subsequen)o(t)249
1988 y(calls)f(to)g Fw(MPI)p 468 1988 V 14 w(SENDRECV)p
FA(.)e(Example)h(6.2)g(sho)o(ws)h(suc)o(h)h(use)g(of)e
Fw(MPI)p 1360 1988 V 15 w(CART)p 1485 1988 V 14 w(SHIFT)p
FA(,)g(where)249 2042 y(eac)o(h)h(column)d(of)h(a)h(2D)f(grid)h(is)g
(shifted)g(b)o(y)g(a)g(di\013eren)o(t)h(amoun)o(t.)i(Figures)e(6.3)e
(and)g(6.4)g(sho)o(w)249 2096 y(the)k(result)f(on)g(12)f(pro)q
(cessors.)249 2184 y Fs(Example)i(6.2)21 b FA(The)13
b(comm)o(unicator,)d Fw(comm)p FA(,)h(has)i(a)f(3)7 b
Ft(\002)g FA(4)13 b(p)q(erio)q(dic,)g(Cartesian)g(top)q(ology)249
2238 y(asso)q(ciated)g(with)e(it.)17 b(A)c(t)o(w)o(o-dimensional)c
(arra)o(y)i(of)h Fr(REAL)p FA(s)f(is)h(stored)h(one)f(elemen)o(t)g(p)q
(er)h(pro-)249 2292 y(cess,)i(in)e(v)n(ariable)g Fr(a)p
FA(.)18 b(One)c(wishes)h(to)f(sk)o(ew)g(this)g(arra)o(y)m(,)f(b)o(y)g
(shifting)g(column)f Fr(i)i FA(\(v)o(ertically)m(,)249
2346 y(i.e.,)e(along)h(the)i(column\))d(b)o(y)i Fr(i)f
FA(steps.)249 2400 y Fr(INTEGER)20 b(comm_2d,)h(rank,)f(coords\(2\),)g
(ierr,)h(source,)f(dest)249 2454 y(INTEGER)g(status\(MPI_STATUS_S)o
(IZE\),)e(dims\(2\))249 2508 y(LOGICAL)i(reorder,)h(periods\(2\))p
eop
%%Page: 263 277
263 276 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(263)249 507 y Fr(REAL)21 b(a,)g(b)249 615 y(CALL)g
(MPI_COMM_SIZE\(MPI_)o(COMM)o(_WORL)o(D,)e(isize,)h(ierr\))249
669 y(IF)h(\(isize.LT.12\))f(CALL)h(MPI_ABORT\(MPI_C)o(OMM_W)o(ORLD,)d
(MPI_ERR_OTHER,)h(ierr\))249 723 y(CALL)i(MPI_COMM_RANK\(MPI_)o(COMM)o
(_WORL)o(D,)e(rank,)i(ierr\))249 831 y(!)h(initialize)d(arrays)249
885 y(a)j(=)f(rank)249 939 y(b)h(=)f(-1)249 1047 y(!)h(create)e
(topology)249 1101 y(!)i(values)e(to)i(run)f(on)g(12)h(processes)249
1155 y(dims\(1\))e(=)i(3)249 1209 y(dims\(2\))e(=)i(4)249
1263 y(!)g(change)e(to)i(.FALSE.)e(for)h(non-periodic)249
1317 y(periods\(1\))f(=)h(.TRUE.)249 1371 y(periods\(2\))f(=)h(.TRUE.)
249 1425 y(reorder)f(=)i(.FALSE.)249 1479 y(CALL)f(MPI_CART_CREATE\(MP)
o(I_CO)o(MM_WO)o(RLD,)d(2,)k(dims,)f(periods,)990 1533
y(reorder,)f(comm_2d,)g(ierr\))249 1587 y(!)i(first)e(12)i(processes)e
(of)h(MPI_COMM_WORLD)e(are)i(in)h(group)e(of)i(comm_2d,)249
1641 y(!)g(with)f(same)g(rank)g(as)g(in)g(MPI_COMM_WORLD)249
1748 y(!)h(find)f(Cartesian)f(coordinates)249 1802 y(CALL)h
(MPI_CART_COORDS\(co)o(mm_2)o(d,)e(rank,)i(2,)g(coords,)f(ierr\))249
1856 y(!)i(compute)e(shift)h(source)f(and)h(destination)249
1910 y(CALL)g(MPI_CART_SHIFT\(com)o(m_2d)o(,)e(0,)i(coords\(2\),)f
(source,)h(dest,)f(ierr\))249 2018 y(!)i(skew)f(a)g(into)g(b)271
2072 y(CALL)g(MPI_SENDRECV\(a,)e(1,)i(MPI_REAL,)f(dest,)h(13,)g(b,)g
(1,)h(MPI_REAL,)837 2126 y(source,)f(13,)g(comm_2d,)f(status,)g(ierr\))
249 2238 y FB(R)n(ationale.)39 b FA(The)15 b(e\013ect)h(of)d(returning)
i Fq(MPI)p 970 2238 12 2 v 13 w(PROC)p 1086 2238 V 13
w(NULL)f FA(when)h(the)g(source)g(of)f(an)g(end-o\013)249
2292 y(shift)j(is)g(out)g(of)g(range)g(is)g(that,)h(in)f(the)h
(subsequen)o(t)h(shift,)e(the)h(destination)f(bu\013er)h(sta)o(ys)249
2346 y(unc)o(hanged.)25 b(This)16 b(is)g(di\013eren)o(t)h(from)e(the)h
(b)q(eha)o(vior)g(of)g(a)g(F)m(ortran)f(90)h Fr(EOSHIFT)f
FA(in)o(trinsic)249 2400 y(function,)c(where)h(the)f(user)h(can)f(pro)o
(vide)f(a)h(\014ll)f(v)n(alue)g(for)g(the)h(target)h(of)e(a)g(shift,)h
(if)f(the)h(source)249 2454 y(is)k(out)h(of)f(range,)g(with)g(a)h
(default)f(whic)o(h)g(is)g(zero)i(or)e(blank.)22 b(T)m(o)15
b(ac)o(hiev)o(e)h(the)g(b)q(eha)o(vior)f(of)249 2508
y(the)j(F)m(ortran)f(function,)g(one)g(w)o(ould)g(need)h(that)f(a)g
(receiv)o(e)i(from)c Fq(MPI)p 1404 2508 V 13 w(PROC)p
1520 2508 V 13 w(NULL)i FA(put)h(a)p eop
%%Page: 264 278
264 277 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(264)1256 b(Chapter)13 b(6)178
466 y
 26049576 7814871 0 0 35522150 10656645 startTexFig
 178 466 a
%%BeginDocument: ../figures/topol-fig2.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-72.0 198.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 199 159 m 199 99 l  139 99 l  139 159 l  clp gs col-1 s gr
% Polyline
n 259 159 m 259 99 l  199 99 l  199 159 l  clp gs col-1 s gr
% Polyline
n 319 159 m 319 99 l  259 99 l  259 159 l  clp gs col-1 s gr
% Polyline
n 259 219 m 259 159 l  199 159 l  199 219 l  clp gs col-1 s gr
% Polyline
n 199 219 m 199 159 l  139 159 l  139 219 l  clp gs col-1 s gr
% Polyline
n 139 99 m 139 39 l  79 39 l  79 99 l  clp gs col-1 s gr
% Polyline
n 199 99 m 199 39 l  139 39 l  139 99 l  clp gs col-1 s gr
% Polyline
n 259 99 m 259 39 l  199 39 l  199 99 l  clp gs col-1 s gr
% Polyline
n 319 99 m 319 39 l  259 39 l  259 99 l  clp gs col-1 s gr
% Polyline
n 139 219 m 139 159 l  79 159 l  79 219 l  clp gs col-1 s gr
% Polyline
n 319 219 m 319 159 l  259 159 l  259 219 l  clp gs col-1 s gr
% Polyline
n 339 129 m 419 129 l gs col-1 s gr
n 411.000 127.000 m 419.000 129.000 l 411.000 131.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 499 219 m 499 159 l  439 159 l  439 219 l  clp gs col-1 s gr
% Polyline
n 499 159 m 499 99 l  439 99 l  439 159 l  clp gs col-1 s gr
% Polyline
n 499 99 m 499 39 l  439 39 l  439 99 l  clp gs col-1 s gr
% Polyline
n 559 99 m 559 39 l  499 39 l  499 99 l  clp gs col-1 s gr
% Polyline
n 559 219 m 559 159 l  499 159 l  499 219 l  clp gs col-1 s gr
% Polyline
n 619 219 m 619 159 l  559 159 l  559 219 l  clp gs col-1 s gr
% Polyline
n 619 99 m 619 39 l  559 39 l  559 99 l  clp gs col-1 s gr
% Polyline
n 679 99 m 679 39 l  619 39 l  619 99 l  clp gs col-1 s gr
% Polyline
n 679 159 m 679 99 l  619 99 l  619 159 l  clp gs col-1 s gr
% Polyline
n 619 159 m 619 99 l  559 99 l  559 159 l  clp gs col-1 s gr
% Polyline
n 559 159 m 559 99 l  499 99 l  499 159 l  clp gs col-1 s gr
% Polyline
n 679 219 m 679 159 l  619 159 l  619 219 l  clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
104 54 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 74 m 
gs 1 -1 scale (\(0,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 94 m 
gs 1 -1 scale (0 / 0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 94 m 
gs 1 -1 scale (9 / 5) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
224 54 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 74 m 
gs 1 -1 scale (\(0,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 94 m 
gs 1 -1 scale (6 / 10) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
284 54 m 
gs 1 -1 scale (3) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 74 m 
gs 1 -1 scale (\(0,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 94 m 
gs 1 -1 scale (3 / 3) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
104 114 m 
gs 1 -1 scale (4) col-1 show gr
% Polyline
n 139 159 m 139 99 l  79 99 l  79 159 l  clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
99 134 m 
gs 1 -1 scale (\(1,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
164 54 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 154 m 
gs 1 -1 scale (4 / 4) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
164 114 m 
gs 1 -1 scale (5) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 134 m 
gs 1 -1 scale (\(1,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 154 m 
gs 1 -1 scale (1 / 9) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
224 114 m 
gs 1 -1 scale (6) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
284 114 m 
gs 1 -1 scale (7) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
104 174 m 
gs 1 -1 scale (8) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
164 174 m 
gs 1 -1 scale (9) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
224 174 m 
gs 1 -1 scale (10) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
284 174 m 
gs 1 -1 scale (11) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 134 m 
gs 1 -1 scale (\(1,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 134 m 
gs 1 -1 scale (\(1,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 194 m 
gs 1 -1 scale (\(2,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 194 m 
gs 1 -1 scale (\(2,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 194 m 
gs 1 -1 scale (\(2,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 194 m 
gs 1 -1 scale (\(2,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 154 m 
gs 1 -1 scale (10 / 2) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 149 m 
gs 1 -1 scale (7 / 7) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 214 m 
gs 1 -1 scale (8 / 8) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 214 m 
gs 1 -1 scale (5 / 1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 214 m 
gs 1 -1 scale (2 / 6) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 214 m 
gs 1 -1 scale (11 / 11) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 59 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 119 m 
gs 1 -1 scale (4) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 179 m 
gs 1 -1 scale (8) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
519 59 m 
gs 1 -1 scale (9) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
519 119 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
519 179 m 
gs 1 -1 scale (5) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
579 59 m 
gs 1 -1 scale (6) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
579 119 m 
gs 1 -1 scale (10) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
579 179 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
639 54 m 
gs 1 -1 scale (3) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
639 119 m 
gs 1 -1 scale (7) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
639 179 m 
gs 1 -1 scale (11) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 74 m 
gs 1 -1 scale (\(0,1\)) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1023 a Fo(Figure)g(6.3)249 1060 y Fz(Outcome)d(of)h(Example)f(6.2)
h(when)g(the)f(2D)i(top)q(ology)d(is)i(p)q(erio)q(dic)f(\(a)h(torus\))f
(on)h(12)g(pro)q(cesses.)i(In)e(the)249 1098 y(b)q(o)o(xes)f(on)h(the)g
(left,)g(the)f(upp)q(er)g(n)o(um)o(b)q(er)g(in)h(eac)o(h)f(b)q(o)o(x)h
(represen)o(ts)e(the)i(pro)q(cess)f(rank,)g(the)h(middle)e(v)n(alues)
249 1135 y(are)i(the)g(\(ro)o(w,)g(column\))e(co)q(ordinate,)f(and)j
(the)g(lo)o(w)o(er)g(v)n(alues)f(are)h(the)g(source/dest)d(for)j(the)g
(sendrecv)249 1172 y(op)q(eration.)i(The)e(v)n(alue)f(in)h(the)g(b)q(o)
o(xes)f(on)h(the)g(righ)o(t)g(are)f(the)h(results)f(in)h
Fl(b)h Fz(after)e(the)h(sendrecv)e(has)249 1210 y(completed.)178
1266 y
 26049576 7814871 0 0 35522150 10656645 startTexFig
 178 1266 a
%%BeginDocument: ../figures/topol-fig3.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-72.0 198.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 199 159 m 199 99 l  139 99 l  139 159 l  clp gs col-1 s gr
% Polyline
n 259 159 m 259 99 l  199 99 l  199 159 l  clp gs col-1 s gr
% Polyline
n 319 159 m 319 99 l  259 99 l  259 159 l  clp gs col-1 s gr
% Polyline
n 259 219 m 259 159 l  199 159 l  199 219 l  clp gs col-1 s gr
% Polyline
n 199 219 m 199 159 l  139 159 l  139 219 l  clp gs col-1 s gr
% Polyline
n 139 99 m 139 39 l  79 39 l  79 99 l  clp gs col-1 s gr
% Polyline
n 259 99 m 259 39 l  199 39 l  199 99 l  clp gs col-1 s gr
% Polyline
n 319 99 m 319 39 l  259 39 l  259 99 l  clp gs col-1 s gr
% Polyline
n 139 219 m 139 159 l  79 159 l  79 219 l  clp gs col-1 s gr
% Polyline
n 319 219 m 319 159 l  259 159 l  259 219 l  clp gs col-1 s gr
% Polyline
n 339 129 m 419 129 l gs col-1 s gr
n 411.000 127.000 m 419.000 129.000 l 411.000 131.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 499 219 m 499 159 l  439 159 l  439 219 l  clp gs col-1 s gr
% Polyline
n 499 159 m 499 99 l  439 99 l  439 159 l  clp gs col-1 s gr
% Polyline
n 499 99 m 499 39 l  439 39 l  439 99 l  clp gs col-1 s gr
% Polyline
n 559 99 m 559 39 l  499 39 l  499 99 l  clp gs col-1 s gr
% Polyline
n 559 219 m 559 159 l  499 159 l  499 219 l  clp gs col-1 s gr
% Polyline
n 619 219 m 619 159 l  559 159 l  559 219 l  clp gs col-1 s gr
% Polyline
n 619 99 m 619 39 l  559 39 l  559 99 l  clp gs col-1 s gr
% Polyline
n 679 99 m 679 39 l  619 39 l  619 99 l  clp gs col-1 s gr
% Polyline
n 679 159 m 679 99 l  619 99 l  619 159 l  clp gs col-1 s gr
% Polyline
n 619 159 m 619 99 l  559 99 l  559 159 l  clp gs col-1 s gr
% Polyline
n 559 159 m 559 99 l  499 99 l  499 159 l  clp gs col-1 s gr
% Polyline
n 679 219 m 679 159 l  619 159 l  619 219 l  clp gs col-1 s gr
% Polyline
n 199 99 m 199 39 l  139 39 l  139 99 l  clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
104 54 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 74 m 
gs 1 -1 scale (\(0,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 94 m 
gs 1 -1 scale (0 / 0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 74 m 
gs 1 -1 scale (\(0,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 74 m 
gs 1 -1 scale (\(0,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
104 114 m 
gs 1 -1 scale (4) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 134 m 
gs 1 -1 scale (\(1,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 154 m 
gs 1 -1 scale (4 / 4) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
164 114 m 
gs 1 -1 scale (5) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 134 m 
gs 1 -1 scale (\(1,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 154 m 
gs 1 -1 scale (1 / 9) col-1 show gr
% Polyline
n 139 159 m 139 99 l  79 99 l  79 159 l  clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
104 174 m 
gs 1 -1 scale (8) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
284 114 m 
gs 1 -1 scale (7) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
164 174 m 
gs 1 -1 scale (9) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
224 174 m 
gs 1 -1 scale (10) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 134 m 
gs 1 -1 scale (\(1,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 134 m 
gs 1 -1 scale (\(1,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 194 m 
gs 1 -1 scale (\(2,0\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 194 m 
gs 1 -1 scale (\(2,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 194 m 
gs 1 -1 scale (\(2,2\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 194 m 
gs 1 -1 scale (\(2,3\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
99 214 m 
gs 1 -1 scale (8 / 8) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 59 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 119 m 
gs 1 -1 scale (4) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
459 179 m 
gs 1 -1 scale (8) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
519 119 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
519 179 m 
gs 1 -1 scale (5) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
579 179 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 174 m 
gs 1 -1 scale (11) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 94 m 
gs 1 -1 scale (- / 5) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 154 m 
gs 1 -1 scale (- / -) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 94 m 
gs 1 -1 scale (- / - ) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 154 m 
gs 1 -1 scale (- / -) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
279 214 m 
gs 1 -1 scale (- / -) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 214 m 
gs 1 -1 scale (5 / -) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 214 m 
gs 1 -1 scale (2 / -) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
519 59 m 
gs 1 -1 scale (-1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
579 59 m 
gs 1 -1 scale (-1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
639 59 m 
gs 1 -1 scale (-1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
639 119 m 
gs 1 -1 scale (-1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
579 119 m 
gs 1 -1 scale (-1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
639 179 m 
gs 1 -1 scale (-1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 94 m 
gs 1 -1 scale (- / 10) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
159 74 m 
gs 1 -1 scale (\(0,1\)) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
164 54 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
224 54 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
284 54 m 
gs 1 -1 scale (3) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
224 114 m 
gs 1 -1 scale (6) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1823 a Fo(Figure)k(6.4)249 1861 y Fz(Similar)c(to)i(Figure)f(6.3)g
(except)f(the)i(2D)g(Cartesian)e(top)q(ology)g(is)i(not)f(p)q(erio)q
(dic)f(\(a)i(rectangle\).)h(This)f(results)249 1898 y(when)g(the)g(v)n
(alues)f(of)h Fl(periods\(1\))d Fz(and)j Fl(periods\(2\))d
Fz(are)j(made)f(.F)l(ALSE.)i(A)g(\\-")f(in)g(a)g(source)f(or)h(dest)249
1935 y(v)n(alue)f(indicates)f Fw(MPI)p 564 1935 13 2
v 15 w(CART)p 689 1935 V 14 w(SHIFT)j Fz(returns)d Fq(MPI)p
1022 1935 12 2 v 13 w(PROC)p 1138 1935 V 13 w(NULL)p
Fz(.)249 2052 y FA(\014xed)15 b(\014ll)f(v)n(alue)g(in)h(the)g(receiv)o
(e)h(bu\013er.)22 b(A)14 b(default)h(\014ll)f(cannot)h(b)q(e)g(easily)f
(pro)o(vided,)h(since)249 2106 y(a)f(di\013eren)o(t)g(\014ll)f(v)n
(alue)g(is)h(required)h(for)e(eac)o(h)i Fw(datat)o(yp)q(e)g
FA(argumen)o(t)e(used)h(in)g(the)g(sendreceiv)o(e)249
2160 y(call.)k(Since)c(the)h(user)g(can)f(mimi)o(c)e(the)i
Fr(EOSHIFT)f FA(b)q(eha)o(vior)g(with)h(little)f(additional)f(co)q(de,)
j(it)249 2214 y(w)o(as)f(felt)g(preferable)g(to)g(c)o(ho)q(ose)h(the)f
(simpler)f(in)o(terface.)18 b(\()p FB(End)e(of)f(r)n(ationale.)p
FA(\))249 2305 y FB(A)n(dvic)n(e)k(to)h(users.)66 b FA(In)19
b(F)m(ortran,)g(the)h(dimension)d(indicated)i(b)o(y)g
Fw(DIRECTION)e FA(=)i(i)f(has)249 2359 y Fw(DIMS\(i+1\))13
b FA(pro)q(cesses,)i(where)g Fw(DIMS)d FA(is)h(the)h(arra)o(y)f(that)g
(w)o(as)f(used)i(to)f(create)i(the)e(grid.)k(In)249 2413
y(C,)f(the)i(dimension)d(indicated)i(b)o(y)g Fw(direction)h
FA(=)f(i)f(is)h(the)h(dimension)d(sp)q(eci\014ed)j(b)o(y)f
Fw(dims[i])p FA(.)249 2467 y(\()p FB(End)f(of)f(advic)n(e)g(to)g
(users.)p FA(\))p eop
%%Page: 265 279
265 278 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(265)249 507 y Fs(6.5.6)48 b(Cartesian)14 b(P)o(artition)f(F)l
(unction)208 661 y Fw(MPI)p 285 661 13 2 v 14 w(CART)p
409 661 V 14 w(SUB\(comm,)e(remain)p 766 661 V 15 w(dims,)i(new)o
(comm\))332 736 y Fv(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)15
b(with)e(Cartesian)i(structure)332 786 y(IN)172 b Fw(remain)p
666 786 V 14 w(dims)320 b Fv(the)22 b Fc(i)p Fv(th)e(en)o(try)i(of)f
Fq(remain)p 1501 786 12 2 v 13 w(dims)g Fv(sp)q(eci\014es)1079
840 y(whether)11 b(the)f Fc(i)p Fv(th)f(dimension)k(is)d(k)o(ept)g(in)h
(the)1079 894 y(subgrid)k(\()p Fc(true)p Fv(\))c(or)i(is)h(dropp)q(ed)g
(\()p Fc(false)p Fv(\))332 943 y(OUT)128 b Fw(new)o(comm)359
b Fv(comm)o(unicator)11 b(con)o(taining)g(the)e(subgrid)i(that)1079
997 y(includes)16 b(the)d(calling)i(pro)q(cess)249 1108
y Fr(int)21 b(MPI)p 405 1108 14 2 v 15 w(Cart)p 508 1108
V 15 w(sub\(MPI)p 677 1108 V 14 w(Comm)g(comm,)g(int)g(*remain)p
1172 1108 V 15 w(dims,)f(MPI)p 1383 1108 V 15 w(Comm)h(*newcomm\))249
1192 y(MPI)p 318 1192 V 15 w(CART)p 421 1192 V 15 w(SUB\(COMM,)f
(REMAIN)p 786 1192 V 14 w(DIMS,)h(NEWCOMM,)f(IERROR\))336
1245 y(INTEGER)h(COMM,)f(NEWCOMM,)g(IERROR)336 1299 y(LOGICAL)h(REMAIN)
p 646 1299 V 14 w(DIMS\(*\))291 1383 y FA(If)12 b(a)h(Cartesian)h(top)q
(ology)d(has)j(b)q(een)g(created)h(with)d Fw(MPI)p 1207
1383 13 2 v 15 w(CART)p 1332 1383 V 14 w(CREA)m(TE)p
FA(,)f(the)j(function)249 1437 y Fw(MPI)p 326 1437 V
14 w(CART)p 450 1437 V 15 w(SUB)g FA(can)h(b)q(e)g(used)h(to)e
(partition)g(the)i(comm)o(unicator)c(group)j(in)o(to)f(subgroups)249
1491 y(that)h(form)e(lo)o(w)o(er-dimensional)f(Cartesian)j(subgrids,)g
(and)g(to)g(build)f(for)g(eac)o(h)i(subgroup)f(a)249
1545 y(comm)o(unicator)d(with)j(the)h(asso)q(ciated)g(subgrid)f
(Cartesian)h(top)q(ology)m(.)k(This)15 b(call)f(is)h(collec-)249
1599 y(tiv)o(e.)249 1691 y FB(A)n(dvic)n(e)g(to)f(users.)37
b FA(The)14 b(same)f(functionalit)o(y)f(as)i Fw(MPI)p
1134 1691 V 14 w(CART)p 1258 1691 V 14 w(SUB)f FA(can)h(b)q(e)h(ac)o
(hiev)o(ed)f(with)249 1745 y Fw(MPI)p 326 1745 V 14 w(COMM)p
470 1745 V 15 w(SPLIT)p FA(.)g(Ho)o(w)o(ev)o(er,)g(since)h
Fw(MPI)p 979 1745 V 14 w(CART)p 1103 1745 V 14 w(SUB)e
FA(has)i(additional)d(information,)f(it)249 1799 y(can)18
b(greatly)g(reduce)i(the)e(comm)o(unication)d(and)i(w)o(ork)h(needed)h
(b)o(y)f(logically)e(w)o(orking)h(on)249 1852 y(the)h(top)q(ology)m(.)
28 b(As)18 b(suc)o(h,)h Fw(MPI)p 771 1852 V 14 w(CART)p
895 1852 V 14 w(SUB)e FA(can)h(b)q(e)g(easily)g(implem)o(en)o(ted)e(in)
h(a)h(scalable)249 1906 y(fashion.)f(\()p FB(End)f(of)f(advic)n(e)g(to)
g(users.)p FA(\))249 1998 y FB(A)n(dvic)n(e)c(to)g(implementors.)33
b FA(The)11 b(function)e Fw(MPI)p 1031 1998 V 14 w(CART)p
1155 1998 V 15 w(SUB\(comm,)e(remain)p 1509 1998 V 15
w(dims,)i(comm-)p 249 2052 V 262 2052 a(new\))j FA(can)g(b)q(e)h
(implem)o(en)o(ted)d(b)o(y)h(a)h(call)e(to)i Fw(MPI)p
1016 2052 V 14 w(COMM)p 1160 2052 V 15 w(SPLIT\()f(comm,)f(colo)o(r,)i
(k)o(ey)m(,)f(comm-)p 249 2106 V 262 2106 a(new)i(\))p
FA(,)f(using)g(a)g(single)f(n)o(um)o(b)q(er)h(enco)q(ding)g(of)f(the)i
(lost)f(dimensions)f(as)h Fr(color)f FA(and)h(a)g(single)249
2160 y(n)o(um)o(b)q(er)e(enco)q(ding)h(of)f(the)i(preserv)o(ed)h
(dimensions)c(as)i Fr(key)p FA(.)16 b(In)11 b(addition,)f(the)h(new)h
(top)q(ology)249 2214 y(information)f(has)j(to)g(b)q(e)g(cac)o(hed.)19
b(\()p FB(End)d(of)f(advic)n(e)g(to)g(implementors.)p
FA(\))249 2309 y Fs(Example)g(6.3)21 b FA(Assume)c(that)f
Fw(MPI)p 854 2309 V 15 w(CART)p 979 2309 V 14 w(CREA)m(TE)p
Fr(\(...,)j(comm\))d FA(has)h(de\014ned)h(a)e(\(2)11
b Ft(\002)249 2363 y FA(3)e Ft(\002)h FA(4\))j(grid.)18
b(Let)c Fr(remain)p 682 2363 14 2 v 15 w(dims)21 b(=)g(\(true,)g
(false,)f(true\))p FA(.)d(Then)e(a)e(call)g(to,)358 2450
y Fr(MPI_CART_SUB\(comm,)18 b(remain_dims,)h(comm_new\),)p
eop
%%Page: 266 280
266 279 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(266)1256 b(Chapter)13 b(6)249
507 y FA(will)18 b(create)j(three)f(comm)o(unicators)d(eac)o(h)j(with)f
(eigh)o(t)g(pro)q(cesses)j(in)d(a)g(2)13 b Ft(\002)g
FA(4)19 b(Cartesian)249 561 y(top)q(ology)m(.)j(If)15
b Fr(remain)p 616 561 14 2 v 14 w(dims)21 b(=)h(\(false,)e(false,)h
(true\))14 b FA(then)j(the)f(call)f(to)g Fw(MPI)p 1608
561 13 2 v 14 w(CART-)p 249 615 V 262 615 a(SUB\()e(comm,)e(remain)p
620 615 V 15 w(dims,)i(comm)p 848 615 V 13 w(new\))i
FA(will)e(create)i(six)f(non-o)o(v)o(erlapping)f(comm)o(uni)o(ca-)249
669 y(tors,)h(eac)o(h)g(with)g(four)g(pro)q(cesses,)i(in)d(a)h
(one-dimensional)d(Cartesian)j(top)q(ology)m(.)249 765
y Fs(6.5.7)48 b(Cartesian)14 b(Lo)o(w-lev)o(el)g(F)l(unctions)249
848 y FA(T)o(ypically)m(,)k(the)h(functions)g(already)g(presen)o(ted)i
(are)e(used)h(to)f(create)i(and)d(use)i(Cartesian)249
902 y(top)q(ologies.)25 b(Ho)o(w)o(ev)o(er,)17 b(some)f(applications)f
(ma)o(y)g(w)o(an)o(t)h(more)f(con)o(trol)h(o)o(v)o(er)h(the)g(pro)q
(cess.)249 956 y Fw(MPI)p 326 956 V 14 w(CART)p 450 956
V 15 w(MAP)e FA(returns)i(the)f(Cartesian)g(map)e(recommended)h(b)o(y)g
(the)h Fw(MPI)f FA(system,)h(in)249 1010 y(order)e(to)e(map)f(w)o(ell)h
(the)i(virtual)e(comm)o(unicati)o(on)e(graph)j(of)f(the)h(application)e
(on)i(the)g(ph)o(ys-)249 1064 y(ical)g(mac)o(hine)g(top)q(ology)m(.)j
(This)e(call)f(is)h(collectiv)o(e.)249 1188 y Fw(MPI)p
326 1188 V 14 w(CART)p 450 1188 V 15 w(MAP\(comm,)d(ndims,)i(dims,)f(p)
q(erio)q(ds,)j(newrank\))332 1263 y Fv(IN)172 b Fw(comm)425
b Fv(input)15 b(comm)o(unicator)332 1313 y(IN)172 b Fw(ndims)430
b Fv(n)o(um)o(b)q(er)10 b(of)e(dimensions)k(of)c(Cartesian)i(struc-)
1079 1367 y(ture)332 1417 y(IN)172 b Fw(dims)451 b Fv(in)o(teger)11
b(arra)o(y)e(of)g(size)h Fc(ndims)d Fv(sp)q(ecifying)12
b(the)1079 1471 y(n)o(um)o(b)q(er)k(of)e(pro)q(cesses)h(in)h(eac)o(h)e
(co)q(ordinate)1079 1525 y(direction)332 1574 y(IN)172
b Fw(p)q(erio)q(ds)409 b Fv(logical)13 b(arra)o(y)e(of)g(size)g
Fc(ndims)d Fv(sp)q(ecifying)13 b(the)1079 1628 y(p)q(erio)q(dicit)o(y)
18 b(sp)q(eci\014cation)f(in)e(eac)o(h)g(co)q(ordi-)1079
1682 y(nate)f(direction)332 1732 y(OUT)128 b Fw(newrank)390
b Fv(reordered)10 b(rank)f(of)g(the)g(calling)i(pro)q(cess;)g
Fq(MPI-)p 1079 1786 12 2 v 1091 1786 a(UNDEFINED)g Fv(if)h(calling)i
(pro)q(cess)e(do)q(es)g(not)1079 1840 y(b)q(elong)j(to)e(grid)249
1950 y Fr(int)21 b(MPI)p 405 1950 14 2 v 15 w(Cart)p
508 1950 V 15 w(map\(MPI)p 677 1950 V 14 w(Comm)g(comm,)g(int)g(ndims,)
g(int)g(*dims,)g(int)g(*periods,)540 2004 y(int)g(*newrank\))249
2088 y(MPI)p 318 2088 V 15 w(CART)p 421 2088 V 15 w(MAP\(COMM,)f
(NDIMS,)g(DIMS,)h(PERIODS,)f(NEWRANK,)h(IERROR\))336
2142 y(INTEGER)g(COMM,)f(NDIMS,)h(DIMS\(*\),)f(NEWRANK,)g(IERROR)336
2196 y(LOGICAL)h(PERIODS\(*\))291 2280 y Fw(MPI)p 368
2280 13 2 v 14 w(CART)p 492 2280 V 14 w(MAP)11 b FA(computes)g(an)g
(\\optimal")e(placemen)o(t)h(for)h(the)h(calling)e(pro)q(cess)k(on)d
(the)249 2334 y(ph)o(ysical)i(mac)o(hine.)249 2425 y
FB(A)n(dvic)n(e)k(to)h(implementors.)54 b FA(The)17 b(function)g
Fw(MPI)p 1079 2425 V 14 w(CART)p 1203 2425 V 14 w(CREA)m(TE\(comm,)d
(ndims,)j(dims,)249 2479 y(p)q(erio)q(ds,)e(reo)o(rder,)h(comm)p
655 2479 V 13 w(ca)o(rt\))p FA(,)e(with)g Fr(reorder)20
b(=)i(true)13 b FA(can)i(b)q(e)g(implemen)o(ted)d(b)o(y)i(calling)p
eop
%%Page: 267 281
267 280 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(267)249 507 y Fw(MPI)p 326 507 13 2 v 14 w(CART)p 450
507 V 15 w(MAP\(comm,)56 b(ndims,)j(dims,)f(p)q(erio)q(ds,)i(newrank\))
p FA(,)h(then)51 b(calling)249 561 y Fw(MPI)p 326 561
V 14 w(COMM)p 470 561 V 15 w(SPLIT\(comm,)17 b(colo)o(r,)j(k)o(ey)m(,)f
(comm)p 1055 561 V 13 w(ca)o(rt\))p FA(,)h(with)e Fr(color)j(=)h(0)c
FA(if)g Fr(newrank)i Ft(6)p FA(=)249 615 y Fr(MPI)p 318
615 14 2 v 15 w(UNDEFINED)p FA(,)11 b Fr(color)21 b(=)h(MPI)p
795 615 V 15 w(UNDEFINED)11 b FA(otherwise,)k(and)e Fr(key)21
b(=)h(newrank)p FA(.)16 b(\()p FB(End)g(of)249 669 y(advic)n(e)f(to)g
(implementors.)p FA(\))249 790 y FD(6.6)52 b(Graph)18
b(T)l(op)q(ology)g(F)l(unctions)249 897 y FA(This)c(section)g(describ)q
(es)i(the)f Fw(MPI)e FA(functions)h(for)g(creating)g(graph)g(top)q
(ologies.)249 981 y Fs(6.6.1)48 b(Graph)14 b(Constructor)g(F)l(unction)
208 1134 y Fw(MPI)p 285 1134 13 2 v 14 w(GRAPH)p 438
1134 V 14 w(CREA)m(TE\(comm)p 732 1134 V 12 w(old,)f(nno)q(des,)i
(index,)g(edges,)f(reo)o(rder,)h(comm)p 1456 1134 V 13
w(graph\))332 1209 y Fv(IN)172 b Fw(comm)p 656 1209 V
13 w(old)360 b Fv(input)15 b(comm)o(unicator)332 1259
y(IN)172 b Fw(nno)q(des)413 b Fv(n)o(um)o(b)q(er)14 b(of)f(no)q(des)h
(in)g(graph)332 1309 y(IN)172 b Fw(index)443 b Fv(arra)o(y)10
b(of)f(in)o(tegers)i(describing)g(no)q(de)g(degrees)1079
1363 y(\(see)i(b)q(elo)o(w\))332 1413 y(IN)172 b Fw(edges)438
b Fv(arra)o(y)13 b(of)f(in)o(tegers)i(describing)h(graph)f(edges)1079
1466 y(\(see)f(b)q(elo)o(w\))332 1516 y(IN)172 b Fw(reo)o(rder)413
b Fv(ranking)17 b(ma)o(y)d(b)q(e)h(reordered)g(\()p Fq(true)p
Fv(\))f(or)h(not)1079 1570 y(\()p Fq(false)p Fv(\))332
1620 y(OUT)128 b Fw(comm)p 656 1620 V 13 w(graph)315
b Fv(comm)o(unicator)11 b(with)e(graph)h(top)q(ology)g(added)249
1730 y Fr(int)21 b(MPI)p 405 1730 14 2 v 15 w(Graph)p
530 1730 V 15 w(create\(MPI)p 765 1730 V 14 w(Comm)g(comm)p
976 1730 V 14 w(old,)g(int)h(nnodes,)e(int)h(*index,)540
1784 y(int)g(*edges,)f(int)h(reorder,)f(MPI)p 1153 1784
V 16 w(Comm)h(*comm)p 1388 1784 V 14 w(graph\))249 1868
y(MPI)p 318 1868 V 15 w(GRAPH)p 443 1868 V 15 w(CREATE\(COMM)p
700 1868 V 13 w(OLD,)g(NNODES,)g(INDEX,)f(EDGES,)h(REORDER,)f(COMM)p
1586 1868 V 15 w(GRAPH,)540 1922 y(IERROR\))336 1976
y(INTEGER)h(COMM)p 602 1976 V 14 w(OLD,)g(NNODES,)g(INDEX\(*\),)f
(EDGES\(*\),)g(COMM)p 1424 1976 V 14 w(GRAPH,)h(IERROR)336
2030 y(LOGICAL)g(REORDER)291 2114 y Fw(MPI)p 368 2114
13 2 v 14 w(GRAPH)p 521 2114 V 14 w(CREA)m(TE)11 b FA(returns)k(a)d
(new)i(comm)o(unicator)c(to)j(whic)o(h)f(the)i(graph)f(top)q(ology)249
2168 y(information)j(is)i(attac)o(hed.)33 b(If)18 b Fw(reo)o(rder)j(=)d
(false)h FA(then)g(the)g(rank)g(of)f(eac)o(h)h(pro)q(cess)i(in)d(the)
249 2222 y(new)f(group)f(is)g(iden)o(tical)f(to)h(its)g(rank)g(in)g
(the)h(old)e(group.)25 b(Otherwise,)18 b(the)f(function)e(ma)o(y)249
2276 y(reorder)20 b(the)g(pro)q(cesses.)35 b(If)18 b(the)i(size,)g
Fw(nno)q(des)p FA(,)h(of)d(the)h(graph)g(is)f(smaller)g(than)g(the)i
(size)249 2330 y(of)c(the)g(group)g(of)g Fw(comm)p 651
2330 V 13 w(old)p FA(,)g(then)h(some)e(pro)q(cesses)k(are)e(returned)g
Fq(MPI)p 1441 2330 12 2 v 13 w(COMM)p 1575 2330 V 13
w(NULL)p FA(,)f(in)249 2384 y(analogy)e(to)h Fw(MPI)p
533 2384 13 2 v 14 w(COMM)p 677 2384 V 15 w(SPLIT)p FA(.)g(The)g(call)g
(is)g(erroneous)i(if)d(it)h(sp)q(eci\014es)i(a)e(graph)g(that)h(is)249
2438 y(larger)f(than)g(the)h(group)f(size)h(of)e(the)i(input)f(comm)o
(unicator.)k(In)c(analogy)f(to)h(the)h(function)249 2492
y Fw(MPI)p 326 2492 V 14 w(COMM)p 470 2492 V 15 w(CREA)m(TE)p
FA(,)9 b(no)h(cac)o(hed)i(information)c(propagates)j(to)g(the)g(new)h
(comm)o(unicator.)p eop
%%Page: 268 282
268 281 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(268)1256 b(Chapter)13 b(6)249
507 y FA(Also,)j(this)g(function)g(is)g(collectiv)o(e.)25
b(As)17 b(with)e(other)i(collectiv)o(e)f(calls,)g(the)h(program)d(m)o
(ust)249 561 y(b)q(e)h(written)f(to)g(w)o(ork)f(correctly)m(,)h
(whether)i(the)e(call)f(sync)o(hronizes)j(or)e(not.)291
615 y(The)e(three)i(parameters)e Fw(nno)q(des,)i(index)f
FA(and)f Fw(edges)h FA(de\014ne)g(the)g(graph)f(structure.)20
b Fw(nno)q(des)249 669 y FA(is)12 b(the)h(n)o(um)o(b)q(er)f(of)g(no)q
(des)h(of)f(the)h(graph.)k(The)c(no)q(des)g(are)g(n)o(um)o(b)q(ered)f
(from)f Fr(0)h FA(to)h Fr(nnodes-1)p FA(.)249 723 y(The)19
b Fr(i)p FA(th)f(en)o(try)h(of)e(arra)o(y)h Fw(index)i
FA(stores)f(the)g(total)f(n)o(um)o(b)q(er)f(of)h(neigh)o(b)q(ors)g(of)g
(the)h(\014rst)g Fr(i)249 777 y FA(graph)d(no)q(des.)25
b(The)17 b(lists)f(of)f(neigh)o(b)q(ors)h(of)g(no)q(des)g
Fr(0,)22 b(1,)f Fp(:)7 b(:)g(:)f Fr(,)21 b(nnodes-1)14
b FA(are)j(stored)g(in)249 831 y(consecutiv)o(e)12 b(lo)q(cations)e(in)
g(arra)o(y)g Fw(edges)p FA(.)18 b(The)11 b(arra)o(y)f
Fw(edges)i FA(is)e(a)g(\015attened)i(represen)o(tation)g(of)249
885 y(the)i(edge)g(lists.)k(The)c(total)e(n)o(um)o(b)q(er)h(of)g(en)o
(tries)h(in)f Fw(index)i FA(is)e Fw(nno)q(des)i FA(and)e(the)h(total)f
(n)o(um)o(b)q(er)249 939 y(of)g(en)o(tries)i(in)f Fw(edges)h
FA(is)e(equal)h(to)g(the)g(n)o(um)o(b)q(er)f(of)h(graph)f(edges.)291
993 y(The)18 b(de\014nitions)g(of)g(the)h(argumen)o(ts)e
Fr(nnodes)p FA(,)h Fr(index)p FA(,)f(and)h Fr(edges)f
FA(are)i(illustrated)f(in)249 1047 y(Example)12 b(6.4.)249
1142 y Fs(Example)j(6.4)21 b FA(Assume)15 b(there)h(are)g(four)e(pro)q
(cesses)k(0,)d(1,)f(2,)h(3)g(with)f(the)i(follo)o(wing)c(adja-)249
1196 y(cency)j(matrix:)p 346 1292 404 2 v 345 1346 2
54 v 371 1330 a(pro)q(cess)p 526 1346 V 52 w(neigh)o(b)q(ors)p
749 1346 V 346 1348 404 2 v 345 1401 2 54 v 426 1385
a(0)p 526 1401 V 105 w(1,)e(3)p 749 1401 V 345 1455 V
426 1439 a(1)p 526 1455 V 105 w(0)p 749 1455 V 345 1509
V 426 1493 a(2)p 526 1509 V 105 w(3)p 749 1509 V 345
1563 V 426 1547 a(3)p 526 1563 V 105 w(0,)g(2)p 749 1563
V 346 1565 404 2 v 291 1634 a(Then,)g(the)i(input)f(argumen)o(ts)f
(are:)371 1765 y Fr(nnodes)f FA(=)51 b(4)371 1819 y Fr(index)13
b FA(=)72 b(\(2,)13 b(3,)g(4,)g(6\))371 1873 y Fr(edges)g
FA(=)72 b(\(1,)13 b(3,)g(0,)g(3,)g(0,)g(2\))291 1958
y(Th)o(us,)i(in)g(C,)g Fr(index[0])e FA(is)i(the)h(degree)h(of)e(no)q
(de)h(zero,)g(and)f Fr(index[i])20 b(-)i(index[i-1])249
2012 y FA(is)13 b(the)h(degree)h(of)e(no)q(de)g Fr(i,)22
b(i=1,)f Fp(:)7 b(:)g(:)e Fr(,)22 b(nnodes-1)p FA(;)11
b(the)j(list)f(of)f(neigh)o(b)q(ors)i(of)f(no)q(de)g(zero)i(is)249
2066 y(stored)h(in)f Fr(edges[j])p FA(,)e(for)i Fr(0)f
Ft(\024)g Fr(j)f Ft(\024)h Fr(index)p FA([)p Fr(0)p FA(])8
b Ft(\000)i Fr(1)15 b FA(and)g(the)h(list)f(of)f(neigh)o(b)q(ors)i(of)f
(no)q(de)g Fr(i)p FA(,)249 2120 y Fr(i)c Fp(>)h Fr(0)p
FA(,)h(is)h(stored)h(in)e Fr(edges[j])p FA(,)f Fr(index)p
FA([)p Fr(i)c Ft(\000)h Fr(1)p FA(])i Ft(\024)h Fr(j)f
Ft(\024)h Fr(index)p FA([)p Fr(i)p FA(])7 b Ft(\000)j
Fr(1)p FA(.)291 2174 y(In)16 b(F)m(ortran,)g Fr(index\(1\))e
FA(is)i(the)h(degree)g(of)e(no)q(de)i(zero,)g(and)f Fr(index\(i+1\))k
(-)h(index\(i\))249 2228 y FA(is)c(the)g(degree)h(of)e(no)q(de)h
Fr(i,)k(i=1,)g Fp(:)7 b(:)g(:)f Fr(,)21 b(nnodes-1)p
FA(;)16 b(the)h(list)f(of)h(neigh)o(b)q(ors)f(of)g(no)q(de)i(zero)249
2282 y(is)e(stored)i(in)d Fr(edges\(j\))p FA(,)g(for)h
Fr(1)f Ft(\024)h Fr(j)g Ft(\024)f Fr(index)p FA(\()p
Fr(1)p FA(\))h(and)g(the)h(list)e(of)h(neigh)o(b)q(ors)h(of)e(no)q(de)i
Fr(i)p FA(,)249 2336 y Fr(i)11 b Fp(>)h Fr(0)p FA(,)h(is)h(stored)h(in)
e Fr(edges\(j\))p FA(,)f Fr(index)p FA(\()p Fr(i)p FA(\))c(+)i
Fr(1)h Ft(\024)h Fr(j)f Ft(\024)h Fr(index)p FA(\()p
Fr(i)c FA(+)i Fr(1)p FA(\).)249 2431 y FB(R)n(ationale.)78
b FA(Since)21 b(bidirectional)f(comm)o(unicatio)o(n)e(is)j(assumed,)g
(the)g(edges)h(arra)o(y)f(is)249 2485 y(symmetric.)16
b(T)m(o)d(allo)o(w)f(input)i(c)o(hec)o(king)g(and)f(to)h(mak)o(e)e(the)
i(graph)g(construction)g(easier)h(for)p eop
%%Page: 269 283
269 282 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(269)249 507 y FA(the)15 b(user,)f(the)h(full)d(graph)i(is)g(giv)o(en)
f(and)h(not)g(just)g(half)f(of)g(the)i(symmetric)d(graph.)18
b(\()p FB(End)e(of)249 561 y(r)n(ationale.)p FA(\))249
653 y FB(A)n(dvic)n(e)g(to)g(implementors.)44 b FA(A)15
b(graph)g(top)q(ology)f(can)h(b)q(e)h(implemen)o(ted)d(b)o(y)i(cac)o
(hing)g(with)249 707 y(the)g(comm)o(uni)o(cator)d(the)i(t)o(w)o(o)g
(arra)o(ys)291 777 y(1.)20 b Fr(index)p FA(,)291 848
y(2.)g Fr(edges)249 918 y FA(The)10 b(n)o(um)o(b)q(er)f(of)g(no)q(des)h
(is)g(equal)f(to)g(the)i(n)o(um)o(b)q(er)e(of)g(pro)q(cesses)j(in)d
(the)h(group.)17 b(An)9 b(additional)249 972 y(zero)15
b(en)o(try)f(at)g(the)g(start)g(of)f(arra)o(y)h Fw(index)h
FA(simpli\014es)d(access)j(to)f(the)g(top)q(ology)f(information.)249
1026 y(\()p FB(End)j(of)f(advic)n(e)g(to)g(implementors.)p
FA(\))249 1117 y Fs(6.6.2)48 b(Graph)14 b(Inquiry)h(F)l(unctions)249
1201 y FA(Once)e(a)f(graph)f(top)q(ology)g(is)h(set)g(up,)g(it)g(ma)o
(y)e(b)q(e)i(necessary)i(to)e(inquire)f(ab)q(out)h(the)h(top)q(ology)m
(.)249 1254 y(These)i(functions)f(are)g(giv)o(en)g(b)q(elo)o(w)f(and)h
(are)g(all)f(lo)q(cal)g(calls.)249 1379 y Fw(MPI)p 326
1379 13 2 v 14 w(GRAPHDIMS)p 580 1379 V 14 w(GET\(comm,)f(nno)q(des,)j
(nedges\))332 1454 y Fv(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)11
b(for)d(group)i(with)f(graph)h(struc-)1079 1508 y(ture)332
1558 y(OUT)128 b Fw(nno)q(des)413 b Fv(n)o(um)o(b)q(er)14
b(of)f(no)q(des)h(in)g(graph)332 1608 y(OUT)128 b Fw(nedges)417
b Fv(n)o(um)o(b)q(er)14 b(of)f(edges)g(in)h(graph)249
1718 y Fr(int)21 b(MPI)p 405 1718 14 2 v 15 w(Graphdims)p
618 1718 V 14 w(get\(MPI)p 786 1718 V 14 w(Comm)g(comm,)g(int)g
(*nnodes,)f(int)i(*nedges\))249 1802 y(MPI)p 318 1802
V 15 w(GRAPHDIMS)p 531 1802 V 14 w(GET\(COMM,)e(NNODES,)g(NEDGES,)h
(IERROR\))336 1856 y(INTEGER)g(COMM,)f(NNODES,)h(NEDGES,)f(IERROR)291
1940 y Fw(MPI)p 368 1940 13 2 v 14 w(GRAPHDIMS)p 622
1940 V 14 w(GET)d FA(returns)i(the)f(n)o(um)o(b)q(er)f(of)g(no)q(des)i
(and)e(the)h(n)o(um)o(b)q(er)f(of)g(edges)249 1994 y(in)d(the)h(graph.)
20 b(The)15 b(n)o(um)o(b)q(er)e(of)h(no)q(des)i(is)e(iden)o(tical)g(to)
g(the)h(size)g(of)f(the)h(group)g(asso)q(ciated)249 2048
y(with)c Fw(comm)p FA(.)k Fw(nno)q(des)e FA(and)f Fw(nedges)h
FA(can)e(b)q(e)h(used)h(to)e(supply)g(arra)o(ys)h(of)f(correct)i(size)f
(for)f Fw(index)249 2102 y FA(and)h Fw(edges)p FA(,)h(resp)q(ectiv)o
(ely)m(,)h(in)e Fw(MPI)p 805 2102 V 14 w(GRAPH)p 958
2102 V 14 w(GET)p FA(.)f Fw(MPI)p 1151 2102 V 15 w(GRAPHDIMS)p
1406 2102 V 14 w(GET)h FA(w)o(ould)f(return)249 2156
y Fw(nno)q(des)i FA(=)f(4)i(and)f Fw(nedges)g FA(=)f(6)i(for)f(Example)
g(6.4.)p eop
%%Page: 270 284
270 283 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(270)1256 b(Chapter)13 b(6)249
507 y Fw(MPI)p 326 507 13 2 v 14 w(GRAPH)p 479 507 V
14 w(GET\(comm,)f(maxindex,)i(maxedges,)f(index,)i(edges\))332
582 y Fv(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)15
b(with)e(graph)h(structure)332 632 y(IN)172 b Fw(maxindex)370
b Fv(length)13 b(of)f(v)o(ector)g Fq(index)e Fv(in)i(the)g(calling)i
(pro-)1079 686 y(gram)332 736 y(IN)172 b Fw(maxedges)365
b Fv(length)13 b(of)d(v)o(ector)i Fq(edges)e Fv(in)i(the)f(calling)j
(pro-)1079 790 y(gram)332 839 y(OUT)128 b Fw(index)443
b Fv(arra)o(y)20 b(of)e(in)o(tegers)i(con)o(taining)h(the)e(graph)1079
893 y(structure)332 943 y(OUT)128 b Fw(edges)438 b Fv(arra)o(y)20
b(of)e(in)o(tegers)i(con)o(taining)h(the)e(graph)1079
997 y(structure)249 1107 y Fr(int)i(MPI)p 405 1107 14
2 v 15 w(Graph)p 530 1107 V 15 w(get\(MPI)p 699 1107
V 14 w(Comm)g(comm,)g(int)g(maxindex,)f(int)h(maxedges,)540
1161 y(int)g(*index,)f(int)h(*edges\))249 1245 y(MPI)p
318 1245 V 15 w(GRAPH)p 443 1245 V 15 w(GET\(COMM,)f(MAXINDEX,)g
(MAXEDGES,)g(INDEX,)g(EDGES,)h(IERROR\))336 1299 y(INTEGER)g(COMM,)f
(MAXINDEX,)g(MAXEDGES,)g(INDEX\(*\),)g(EDGES\(*\),)g(IERROR)291
1383 y Fw(MPI)p 368 1383 13 2 v 14 w(GRAPH)p 521 1383
V 14 w(GET)13 b FA(returns)j Fw(index)f FA(and)e Fw(edges)i
FA(as)f(w)o(as)g(supplied)g(to)f Fw(MPI)p 1486 1383 V
14 w(GRAPH)p 1639 1383 V 15 w(CRE-)249 1437 y(A)m(TE)p
FA(.)f Fw(maxindex)h FA(and)g Fw(maxedges)g FA(are)g(at)g(least)g(as)g
(big)f(as)i Fw(nno)q(des)g FA(and)f Fw(nedges)p FA(,)h(resp)q(ectiv)o
(ely)m(,)249 1491 y(as)i(returned)i(b)o(y)e Fw(MPI)p
610 1491 V 14 w(GRAPHDIMS)p 864 1491 V 14 w(GET)f FA(ab)q(o)o(v)o(e.)25
b(Using)15 b(the)i Fw(comm)d FA(created)k(in)d(Exam-)249
1545 y(ple)f(6.4)f(w)o(ould)g(return)i(the)f Fw(index)i
FA(and)d Fw(edges)i FA(giv)o(en)f(in)f(the)i(example.)249
1628 y Fs(6.6.3)48 b(Graph)14 b(Information)f(F)l(unctions)249
1711 y FA(The)h(functions)g(in)f(this)h(section)h(pro)o(vide)e
(information)e(ab)q(out)j(the)g(structure)i(of)d(the)i(graph)249
1765 y(top)q(ology)m(.)h(All)d(calls)h(are)g(lo)q(cal.)249
1890 y Fw(MPI)p 326 1890 V 14 w(GRAPH)p 479 1890 V 14
w(NEIGHBORS)p 725 1890 V 14 w(COUNT\(comm,)d(rank,)j(nneighb)q(o)o
(rs\))332 1965 y Fv(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)15
b(with)e(graph)h(top)q(ology)332 2014 y(IN)172 b Fw(rank)457
b Fv(rank)14 b(of)f(pro)q(cess)g(in)h(group)g(of)f Fq(comm)332
2064 y Fv(OUT)128 b Fw(nneighb)q(o)o(rs)348 b Fv(n)o(um)o(b)q(er)12
b(of)e(neigh)o(b)q(ors)j(of)d(sp)q(eci\014ed)i(pro)q(cess)249
2174 y Fr(int)21 b(MPI)p 405 2174 14 2 v 15 w(Graph)p
530 2174 V 15 w(neighbors)p 743 2174 V 14 w(count\(MPI)p
955 2174 V 14 w(Comm)g(comm,)f(int)i(rank,)540 2228 y(int)f
(*nneighbors\))249 2312 y(MPI)p 318 2312 V 15 w(GRAPH)p
443 2312 V 15 w(NEIGHBORS)p 656 2312 V 14 w(COUNT\(COMM,)e(RANK,)i
(NNEIGHBORS,)e(IERROR\))336 2366 y(INTEGER)i(COMM,)f(RANK,)h
(NNEIGHBORS,)f(IERROR)291 2450 y Fw(MPI)p 368 2450 13
2 v 14 w(GRAPH)p 521 2450 V 14 w(NEIGHBORS)p 767 2450
V 14 w(COUNT)13 b FA(returns)i(the)f(n)o(um)o(b)q(er)f(of)g(neigh)o(b)q
(ors)h(for)f(the)i(pro-)249 2504 y(cess)22 b(signi\014ed)e(b)o(y)g
Fw(rank)p FA(.)38 b(It)20 b(can)h(b)q(e)f(used)h(b)o(y)f
Fw(MPI)p 1134 2504 V 15 w(GRAPH)p 1288 2504 V 14 w(NEIGHBORS)f
FA(to)h(giv)o(e)g(an)p eop
%%Page: 271 285
271 284 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(271)249 507 y FA(arra)o(y)17 b(of)f(correct)j(size)f(for)e
Fw(neighb)q(o)o(rs)p FA(.)29 b(Using)17 b(Example)f(6.4)g(with)g
Fw(rank)i FA(=)f(3)g(w)o(ould)f(giv)o(e)249 561 y Fw(nneighb)q(o)o(rs)d
FA(=)f(2.)249 686 y Fw(MPI)p 326 686 13 2 v 14 w(GRAPH)p
479 686 V 14 w(NEIGHBORS\(comm,)f(rank,)j(maxneighb)q(o)o(rs,)g(neighb)
q(o)o(rs\))332 761 y Fv(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)15
b(with)e(graph)h(top)q(ology)332 808 y(IN)172 b Fw(rank)457
b Fv(rank)14 b(of)f(pro)q(cess)g(in)h(group)g(of)f Fq(comm)332
856 y Fv(IN)172 b Fw(maxneighb)q(o)o(rs)296 b Fv(size)14
b(of)f(arra)o(y)g Fq(neighb)q(o)o(rs)332 904 y Fv(OUT)128
b Fw(neighb)q(o)o(rs)369 b Fv(arra)o(y)9 b(of)g(ranks)g(of)g(pro)q
(cesses)h(that)f(are)f(neigh-)1079 958 y(b)q(ors)14 b(to)f(sp)q
(eci\014ed)i(pro)q(cess)249 1068 y Fr(int)21 b(MPI)p
405 1068 14 2 v 15 w(Graph)p 530 1068 V 15 w(neighbors\(MPI)p
831 1068 V 13 w(Comm)g(comm,)g(int)g(rank,)g(int)g(maxneighbors,)540
1122 y(int)g(*neighbors\))249 1206 y(MPI)p 318 1206 V
15 w(GRAPH)p 443 1206 V 15 w(NEIGHBORS\(COMM,)d(RANK,)j(MAXNEIGHBORS,)e
(NEIGHBORS,)h(IERROR\))336 1260 y(INTEGER)h(COMM,)f(RANK,)h
(MAXNEIGHBORS,)e(NEIGHBORS\(*\),)g(IERROR)291 1344 y
Fw(MPI)p 368 1344 13 2 v 14 w(GRAPH)p 521 1344 V 14 w(NEIGHBORS)f
FA(returns)i(the)g(part)f(of)g(the)g Fw(edges)h FA(arra)o(y)f(asso)q
(ciated)h(with)249 1397 y(pro)q(cess)15 b Fw(rank)p FA(.)j(Using)13
b(Example)e(6.4,)g Fw(rank)i FA(=)e(3)i(w)o(ould)f(return)i
Fw(neighb)q(o)o(rs)f FA(=)e(0)p Fp(;)19 b FA(2.)f(Another)249
1451 y(use)d(is)f(giv)o(en)f(in)g(Example)g(6.5.)249
1536 y Fs(Example)i(6.5)21 b FA(Supp)q(ose)12 b(that)f
Fr(comm)e FA(is)i(a)g(comm)o(uni)o(cator)e(with)h(a)h(sh)o(u\017e-exc)o
(hange)g(top)q(ol-)249 1590 y(ogy)m(.)22 b(The)15 b(group)h(has)f(2)646
1575 y Fj(n)684 1590 y FA(mem)o(b)q(ers.)21 b(Eac)o(h)16
b(pro)q(cess)h(is)f(lab)q(eled)f(b)o(y)g Fp(a)1399 1596
y Fk(1)1418 1590 y Fp(;)7 b(:)g(:)g(:)e(;)i(a)1533 1596
y Fj(n)1570 1590 y FA(with)15 b Fp(a)1688 1596 y Fj(i)1716
1590 y Ft(2)249 1644 y(f)p FA(0)p Fp(;)7 b FA(1)p Ft(g)p
FA(,)i(and)h(has)g(three)h(neigh)o(b)q(ors:)16 b(exc)o(hange\()p
Fp(a)1024 1650 y Fk(1)1044 1644 y Fp(;)7 b(:)g(:)g(:)t(;)g(a)1158
1650 y Fj(n)1180 1644 y FA(\))12 b(=)g Fp(a)1274 1650
y Fk(1)1292 1644 y Fp(;)7 b(:)g(:)g(:)e(;)i(a)1407 1650
y Fj(n)p Fm(\000)p Fk(1)1472 1644 y Fp(;)g FA(\026)-21
b Fp(a)1513 1650 y Fj(n)1545 1644 y FA(\()q(\026)f Fp(a)11
b FA(=)h(1)q Ft(\000)q Fp(a)p FA(\),)249 1698 y(unsh)o(u\017e\()p
Fp(a)447 1704 y Fk(1)466 1698 y Fp(;)7 b(:)g(:)g(:)e(;)i(a)581
1704 y Fj(n)603 1698 y FA(\))22 b(=)f Fp(a)716 1704 y
Fk(2)735 1698 y Fp(;)7 b(:)g(:)g(:)e(;)i(a)850 1704 y
Fj(n)872 1698 y Fp(;)g(a)913 1704 y Fk(1)931 1698 y FA(,)20
b(and)g(sh)o(u\017e\()p Fp(a)1202 1704 y Fk(1)1221 1698
y Fp(;)7 b(:)g(:)g(:)e(;)i(a)1336 1704 y Fj(n)1358 1698
y FA(\))21 b(=)h Fp(a)1471 1704 y Fj(n)1494 1698 y Fp(;)7
b(a)1535 1704 y Fk(1)1553 1698 y Fp(;)g(:)g(:)g(:)t(;)g(a)1667
1704 y Fj(n)p Fm(\000)p Fk(1)1732 1698 y FA(.)249 1752
y(The)14 b(graph)g(adjacency)h(list)e(is)h(illustrated)f(b)q(elo)o(w)h
(for)g Fp(n)d FA(=)h(3.)p 249 1819 1044 2 v 248 1873
2 54 v 306 1857 a Fs(no)q(de)p 463 1873 V 101 w(exc)o(hange)88
b(unsh)o(u\017e)114 b(sh)o(u\017e)p 1292 1873 V 248 1927
V 463 1927 V 489 1911 a FA(neigh)o(b)q(ors\(1\))50 b(neigh)o(b)q
(ors\(2\))g(neigh)o(b)q(ors\(3\))p 1292 1927 V 249 1929
1044 2 v 248 1983 2 54 v 274 1967 a(0)g(\(000\))p 463
1983 V 152 w(1)255 b(0)g(0)p 1292 1983 V 248 2037 V 274
2020 a(1)50 b(\(001\))p 463 2037 V 152 w(0)255 b(2)g(4)p
1292 2037 V 248 2091 V 274 2074 a(2)50 b(\(010\))p 463
2091 V 152 w(3)255 b(4)g(1)p 1292 2091 V 248 2145 V 274
2128 a(3)50 b(\(011\))p 463 2145 V 152 w(2)255 b(6)g(5)p
1292 2145 V 248 2199 V 274 2182 a(4)50 b(\(100\))p 463
2199 V 152 w(5)255 b(1)g(2)p 1292 2199 V 248 2253 V 274
2236 a(5)50 b(\(101\))p 463 2253 V 152 w(4)255 b(3)g(6)p
1292 2253 V 248 2306 V 274 2290 a(6)50 b(\(110\))p 463
2306 V 152 w(7)255 b(5)g(3)p 1292 2306 V 248 2360 V 274
2344 a(7)50 b(\(111\))p 463 2360 V 152 w(6)255 b(7)g(7)p
1292 2360 V 249 2362 1044 2 v 291 2454 a(Supp)q(ose)15
b(that)g(the)g(comm)o(unicator)d Fr(comm)i FA(has)g(this)h(top)q(ology)
e(asso)q(ciated)j(with)e(it.)20 b(The)249 2508 y(follo)o(wing)12
b(co)q(de)k(fragmen)o(t)d(cycles)j(through)f(the)g(three)h(t)o(yp)q(es)
g(of)e(neigh)o(b)q(ors)h(and)g(p)q(erforms)p eop
%%Page: 272 286
272 285 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(272)1256 b(Chapter)13 b(6)249
507 y FA(an)h(appropriate)g(p)q(erm)o(utation)e(for)i(eac)o(h.)249
561 y Fr(!)22 b(assume:)e(each)h(process)f(has)h(stored)g(a)h(real)f
(number)f(A.)249 615 y(!)i(extract)e(neighborhood)f(information)249
669 y(CALL)i(MPI_COMM_RANK\(comm)o(,)e(myrank,)h(ierr\))249
723 y(CALL)h(MPI_GRAPH_NEIGHBOR)o(S\(co)o(mm,)e(myrank,)h(3,)h
(neighbors,)f(ierr\))249 777 y(!)43 b(perform)21 b(exchange)f
(permutation)249 831 y(CALL)h(MPI_SENDRECV_REPLA)o(CE\(A)o(,)e(1,)i
(MPI_REAL,)f(neighbors\(1\),)f(0,)750 885 y(neighbors\(1\),)g(0,)j
(comm,)f(status,)f(ierr\))249 939 y(!)43 b(perform)21
b(unshuffle)f(permutation)249 993 y(CALL)h(MPI_SENDRECV_REPLA)o(CE\(A)o
(,)e(1,)i(MPI_REAL,)f(neighbors\(2\),)f(0,)750 1047 y(neighbors\(3\),)g
(0,)j(comm,)f(status,)f(ierr\))249 1101 y(!)i(perform)e(shuffle)g
(permutation)249 1155 y(CALL)h(MPI_SENDRECV_REPLA)o(CE\(A)o(,)e(1,)i
(MPI_REAL,)f(neighbors\(3\),)f(0,)750 1209 y(neighbors\(2\),)g(0,)j
(comm,)f(status,)f(ierr\))249 1292 y Fs(6.6.4)48 b(Lo)o(w-lev)o(el)14
b(Graph)g(F)l(unctions)249 1375 y FA(The)i(lo)o(w-lev)o(el)e(function)h
(for)h(general)f(graph)h(top)q(ologies)f(as)g(in)g(the)h(Cartesian)g
(top)q(ologies)249 1429 y(giv)o(en)d(in)h(Section)g(6.5.7)e(is)i(as)g
(follo)o(ws.)i(This)e(call)f(is)h(collectiv)o(e.)249
1554 y Fw(MPI)p 326 1554 13 2 v 14 w(GRAPH)p 479 1554
V 14 w(MAP\(comm,)e(nno)q(des,)j(index,)f(edges,)h(newrank\))332
1628 y Fv(IN)172 b Fw(comm)425 b Fv(input)15 b(comm)o(unicator)332
1676 y(IN)172 b Fw(nno)q(des)413 b Fv(n)o(um)o(b)q(er)14
b(of)f(graph)h(no)q(des)332 1723 y(IN)172 b Fw(index)443
b Fv(in)o(teger)12 b(arra)o(y)f(sp)q(ecifying)h(the)f(graph)g(struc-)
1079 1777 y(ture,)i(see)g Fq(MPI)p 1305 1777 12 2 v 13
w(GRAPH)p 1447 1777 V 13 w(CREA)m(TE)332 1824 y Fv(IN)172
b Fw(edges)438 b Fv(in)o(teger)12 b(arra)o(y)f(sp)q(ecifying)h(the)f
(graph)g(struc-)1079 1878 y(ture)332 1925 y(OUT)128 b
Fw(newrank)390 b Fv(reordered)10 b(rank)f(of)g(the)g(calling)i(pro)q
(cess;)g Fq(MPI-)p 1079 1979 V 1091 1979 a(UNDEFINED)h
Fv(if)g(the)g(calling)i(pro)q(cess)f(do)q(es)1079 2033
y(not)h(b)q(elong)g(to)f(graph)249 2143 y Fr(int)21 b(MPI)p
405 2143 14 2 v 15 w(Graph)p 530 2143 V 15 w(map\(MPI)p
699 2143 V 14 w(Comm)g(comm,)g(int)g(nnodes,)f(int)i(*index,)e(int)h
(*edges,)540 2197 y(int)g(*newrank\))249 2281 y(MPI)p
318 2281 V 15 w(GRAPH)p 443 2281 V 15 w(MAP\(COMM,)f(NNODES,)g(INDEX,)h
(EDGES,)f(NEWRANK,)g(IERROR\))336 2335 y(INTEGER)h(COMM,)f(NNODES,)h
(INDEX\(*\),)f(EDGES\(*\),)g(NEWRANK,)g(IERROR)249 2454
y FB(A)n(dvic)n(e)j(to)f(implementors.)87 b FA(The)23
b(function)f Fw(MPI)p 1133 2454 13 2 v 15 w(GRAPH)p 1287
2454 V 14 w(CREA)m(TE\(comm)o(,)f(nno)q(des,)249 2508
y(index,)k(edges,)g(reo)o(rder,)g(comm)p 771 2508 V 13
w(graph\))p FA(,)g(with)d Fr(reorder)e(=)i(true)f FA(can)i(b)q(e)g
(implem)o(en)o(ted)p eop
%%Page: 273 287
273 286 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(273)249 507 y FA(b)o(y)19 b(calling)e Fw(MPI)p 525
507 13 2 v 14 w(GRAPH)p 678 507 V 14 w(MAP\(comm,)h(nno)q(des,)j
(index,)g(edges,)g(newrank\))p FA(,)g(then)f(calling)249
561 y Fw(MPI)p 326 561 V 14 w(COMM)p 470 561 V 15 w(SPLIT\(comm,)13
b(colo)o(r,)h(k)o(ey)m(,)g(comm)p 1040 561 V 14 w(graph\))p
FA(,)h(with)f Fr(color)21 b(=)h(0)14 b FA(if)g Fr(newrank)20
b Ft(6)p FA(=)249 615 y Fr(MPI)p 318 615 14 2 v 15 w(UNDEFINED)p
FA(,)11 b Fr(color)21 b(=)h(MPI)p 795 615 V 15 w(UNDEFINED)11
b FA(otherwise,)k(and)e Fr(key)21 b(=)h(newrank)p FA(.)16
b(\()p FB(End)g(of)249 669 y(advic)n(e)f(to)g(implementors.)p
FA(\))249 790 y FD(6.7)52 b(T)l(op)q(ology)19 b(Inquiry)d(F)l(unctions)
249 897 y FA(A)d(routine)f(ma)o(y)f(receiv)o(e)i(a)g(comm)o(uni)o
(cator)d(for)i(whic)o(h)h(it)f(is)g(unkno)o(wn)g(what)g(t)o(yp)q(e)h
(of)f(top)q(ol-)249 951 y(ogy)18 b(is)g(asso)q(ciated)g(with)g(it.)31
b Fw(MPI)p 825 951 13 2 v 14 w(TOPO)p 956 951 V 14 w(TEST)18
b FA(allo)o(ws)f(one)i(to)f(answ)o(er)g(this)h(question.)249
1005 y(This)14 b(is)g(a)f(lo)q(cal)g(call.)249 1130 y
Fw(MPI)p 326 1130 V 14 w(TOPO)p 457 1130 V 14 w(TEST\(comm,)f(status\))
332 1205 y Fv(IN)172 b Fw(comm)425 b Fv(comm)o(unicator)332
1255 y(OUT)128 b Fw(status)429 b Fv(top)q(ology)15 b(t)o(yp)q(e)f(of)e
(comm)o(unicator)j Fc(comm)249 1365 y Fr(int)21 b(MPI)p
405 1365 14 2 v 15 w(Topo)p 508 1365 V 15 w(test\(MPI)p
699 1365 V 14 w(Comm)g(comm,)g(int)g(*status\))249 1449
y(MPI)p 318 1449 V 15 w(TOPO)p 421 1449 V 15 w(TEST\(COMM,)f(STATUS,)g
(IERROR\))336 1503 y(INTEGER)h(COMM,)f(STATUS,)h(IERROR)291
1587 y FA(The)15 b(function)f Fw(MPI)p 617 1587 13 2
v 14 w(TOPO)p 748 1587 V 14 w(TEST)h FA(returns)h(the)f(t)o(yp)q(e)g
(of)f(top)q(ology)g(that)g(is)h(assigned)g(to)249 1641
y(a)f(comm)o(unicator.)291 1695 y(The)g(output)g(v)n(alue)f
Fr(status)g FA(is)h(one)g(of)f(the)h(follo)o(wing:)291
1784 y Fq(MPI)p 363 1784 12 2 v 12 w(GRAPH)619 b FA(graph)14
b(top)q(ology)291 1834 y Fq(MPI)p 363 1834 V 12 w(CART)646
b FA(Cartesian)14 b(top)q(ology)291 1884 y Fq(MPI)p 363
1884 V 12 w(UNDEFINED)533 b FA(no)13 b(top)q(ology)249
2019 y FD(6.8)52 b(An)17 b(Application)j(Example)249
2127 y Fs(Example)15 b(6.6)21 b FA(W)m(e)15 b(presen)o(t)i(here)g(t)o
(w)o(o)e(algorithms)e(for)i(parallel)g(matrix)e(pro)q(duct.)24
b(Both)249 2181 y(co)q(des)19 b(compute)f(a)f(pro)q(duct)i
Fr(C)f FA(=)h Fr(A)12 b Ft(\002)g Fr(B)p FA(,)18 b(where)i
Fr(A)d FA(is)h(an)g Fp(n)1254 2187 y Fk(1)1284 2181 y
Ft(\002)13 b Fp(n)1354 2187 y Fk(2)1390 2181 y FA(matrix)j(and)i
Fr(B)g FA(is)g(an)249 2235 y Fp(n)274 2241 y Fk(2)305
2235 y Ft(\002)13 b Fp(n)375 2241 y Fk(3)412 2235 y FA(matrix)k(\(the)i
(result)g(matrix)e Fr(C)i FA(has)f(size)i Fp(n)1132 2241
y Fk(1)1163 2235 y Ft(\002)12 b Fp(n)1232 2241 y Fk(3)1251
2235 y FA(\).)32 b(The)19 b(input)g(matrices)f(are)249
2289 y(initially)9 b(a)o(v)n(ailable)h(on)i(pro)q(cess)i(zero,)e(and)g
(the)g(result)h(matrix)d(is)i(returned)i(at)d(pro)q(cess)j(zero.)291
2343 y(The)g(\014rst)h(parallel)e(algorithm)e(maps)i(the)i(computation)
d(on)o(to)h(a)h Fp(p)1371 2349 y Fk(1)1399 2343 y Ft(\002)c
Fp(p)1462 2349 y Fk(2)1494 2343 y FA(2-dimensional)249
2397 y(grid)16 b(of)f(pro)q(cesses.)27 b(The)17 b(matrices)e(are)i
(partitioned)e(as)h(sho)o(wn)g(in)g(Figure)g(6.5:)22
b(matrix)14 b Fr(A)249 2451 y FA(is)h(partitioned)g(in)o(to)g
Fp(p)615 2457 y Fk(1)648 2451 y FA(horizon)o(tal)g(slices,)g(the)h
(matrix)d Fr(B)i FA(is)g(partitioned)g(in)o(to)g Fp(p)1576
2457 y Fk(2)1610 2451 y FA(v)o(ertical)249 2505 y(slices,)f(and)g
(matrix)e Fr(C)i FA(is)f(partitioned)h(in)o(to)f Fp(p)980
2511 y Fk(1)1008 2505 y Ft(\002)c Fp(p)1070 2511 y Fk(2)1103
2505 y FA(submatrices.)p eop
%%Page: 274 288
274 287 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(274)1256 b(Chapter)13 b(6)478
466 y
 16577003 7128110 0 0 31114772 13682606 startTexFig
 478 466 a
%%BeginDocument: ../figures/topol-matmult2.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-49.0 751.0 translate 0.900 -0.900 scale
/Times-Roman findfont 12.00 scalefont setfont
59 734 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
539 634 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
534 624 m 
gs 1 -1 scale (p) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
329 639 m 
gs 1 -1 scale (p) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
334 649 m 
gs 1 -1 scale (2) col-1 show gr
1.000 setlinewidth
% Polyline
n 258 712 m 247 731 l gs col-1 s gr
% Polyline
n 247 712 m 258 731 l gs col-1 s gr
% Polyline
n 427 713 m 446 713 l gs col-1 s gr
% Polyline
n 427 725 m 446 725 l gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
474 724 m 
gs 1 -1 scale (p) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
479 734 m 
gs 1 -1 scale (1) col-1 show gr
% Polyline
n 379 779 m 339 779 l  339 659 l  379 659 l  clp gs col-1 s gr
% Polyline
n 199 759 m 199 719 l  79 719 l  79 759 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 339 659 m 339 659 l  339 659 l  339 659 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
54 724 m 
gs 1 -1 scale (p) col-1 show gr
% Polyline
n 379 779 m 379 659 l  339 659 l  339 779 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
339 834 m 
gs 1 -1 scale (B) col-1 show gr
% Polyline
n 78 759 m 200 759 l  200 719 l  78 719 l  clp gs col-1 s gr
% Polyline
n 78 719 m 200 719 l  200 679 l  78 679 l  clp gs col-1 s gr
% Polyline
n 78 799 m 200 799 l  200 759 l  78 759 l  clp gs col-1 s gr
% Polyline
n 499 759 m 579 759 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 499 719 m 579 719 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 499 679 m 579 679 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 539 799 m 499 799 l  499 639 l  539 639 l  clp gs col-1 s gr
% Polyline
n 579 799 m 539 799 l  539 639 l  579 639 l  clp gs col-1 s gr
% Polyline
n 579 759 m 579 719 l  539 719 l  539 759 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 78 679 m 200 679 l  200 639 l  78 639 l  clp gs col-1 s gr
% Polyline
n 339 779 m 299 779 l  299 659 l  339 659 l  clp gs col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
124 834 m 
gs 1 -1 scale (A) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
534 834 m 
gs 1 -1 scale (C) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 980 a Fo(Figure)g(6.5)249 1017 y Fz(Data)e(partition)e(in)i(2D)g
(parallel)f(matrix)g(pro)q(duct)f(algorithm.)291 1140
y FA(Eac)o(h)14 b(pro)q(cess)i(\()p Fp(i;)7 b(j)r FA(\))15
b(computes)f(the)h(pro)q(duct)h(of)d(the)i Fp(i)p FA(-th)g(slice)f(of)g
Fr(A)g FA(and)g(the)h Fp(j)r FA(-th)g(slice)249 1194
y(of)e Fr(B)p FA(,)h(resulting)g(in)f(submatrix)f(\()p
Fp(i;)7 b(j)r FA(\))15 b(of)e Fr(C)p FA(.)291 1248 y(The)h(successiv)o
(e)i(phases)f(of)e(the)i(computation)d(are)i(illustrated)g(in)f(Figure)
h(6.6:)196 1331 y(1.)20 b(Matrix)14 b Fr(A)f FA(is)h(scattered)i(in)o
(to)d(slices)i(on)e(the)i(\()p Fp(x;)7 b FA(0\))13 b(line;)196
1384 y(2.)20 b(Matrix)14 b Fr(B)f FA(is)h(scattered)i(in)o(to)d(slices)
i(on)e(the)i(\(0)p Fp(;)7 b(y)q FA(\))14 b(line.)196
1438 y(3.)20 b(The)14 b(slices)h(of)e Fr(A)h FA(are)g(replicated)h(in)e
(the)i Fp(y)g FA(dimension.)196 1492 y(4.)20 b(The)14
b(slices)h(of)e Fr(B)h FA(are)g(replicated)h(in)e(the)i
Fp(x)e FA(dimension.)196 1546 y(5.)20 b(Eac)o(h)14 b(pro)q(cess)i
(computes)e(one)g(submatrix)e(pro)q(duct.)196 1600 y(6.)20
b(Matrix)14 b Fr(C)f FA(is)h(gathered)h(from)d(the)i(\()p
Fp(x;)7 b(y)q FA(\))14 b(plane.)249 1683 y Fr(SUBROUTINE)20
b(PMATMULT\()g(A,)h(B,)g(C,)h(n,)f(p,)h(comm\))380 1737
y(!)f(subroutine)f(arguments)g(are)h(meaningful)f(only)h(at)g(process)g
(0)249 1791 y(INTEGER)f(n\(3\))380 1845 y(!)h(matrix)g(dimensions)249
1899 y(REAL)86 b(A\(n\(1\),n\(2\)\),)423 1953 y(B\(n\(2\),n\(3\)\),)423
2007 y(C\(n\(1\),n\(3\)\))380 2061 y(!)21 b(data)249
2115 y(INTEGER)f(p\(2\))380 2169 y(!)h(dimensions)f(of)i(processor)d
(grid.)i(p\(1\))g(divides)g(n\(1\),)f(p\(2\))380 2223
y(!)h(divides)g(n\(3\))g(and)g(the)g(product)f(of)i(the)f(2)h
(dimensions)380 2277 y(!)f(must)g(equal)g(the)g(size)g(of)h(the)f
(group)g(of)g(comm)249 2331 y(INTEGER)f(comm)380 2385
y(!)h(communicator)f(for)h(processes)f(that)h(participate)e(in)j
(computation)249 2493 y(INTEGER)e(nn\(2\))p eop
%%Page: 275 289
275 288 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(275)328 534 y
 21313289 28417720 0 0 39403274 51901808 startTexFig
 328 534 a
%%BeginDocument: ../figures/topol-matrix2.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
 /DrawEllipse {
	/endangle exch def
	/startangle exch def
	/yrad exch def
	/xrad exch def
	/y exch def
	/x exch def
	/savematrix mtrx currentmatrix def
	x y translate xrad yrad scale 0 0 1 startangle endangle arc
	savematrix setmatrix
	} def

	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-22.0 792.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 599 559 m 599 399 l gs col-1 s gr
% Polyline
n 679 399 m 679 559 l gs col-1 s gr
% Polyline
n 519 559 m 679 559 l gs col-1 s gr
% Polyline
n 519 559 m 519 399 l  679 399 l gs col-1 s gr
1.000 setlinewidth
% Polyline
n 529 409 m 529 389 l  509 389 l  509 409 l  clp gs col-1 s gr
% Polyline
n 609 409 m 609 389 l  589 389 l  589 409 l  clp gs col-1 s gr
% Polyline
n 689 409 m 689 389 l  669 389 l  669 409 l  clp gs col-1 s gr
% Polyline
n 529 489 m 529 469 l  509 469 l  509 489 l  clp gs col-1 s gr
% Polyline
n 529 569 m 529 549 l  509 549 l  509 569 l  clp gs col-1 s gr
% Polyline
n 609 569 m 609 549 l  589 549 l  589 569 l  clp gs col-1 s gr
% Polyline
n 609 489 m 609 469 l  589 469 l  589 489 l  clp gs col-1 s gr
% Polyline
n 684 489 m 684 469 l  664 469 l  664 489 l  clp gs col-1 s gr
% Polyline
n 689 569 m 689 549 l  669 549 l  669 569 l  clp gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
544 604 m 
gs 1 -1 scale (5. compute ) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
549 629 m 
gs 1 -1 scale (   products of) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
549 654 m 
gs 1 -1 scale (   submatrices) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
539 344 m 
gs 1 -1 scale (    submatrices ) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
539 369 m 
gs 1 -1 scale (    ) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
649 344 m 
gs 1 -1 scale (of A) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
539 319 m 
gs 1 -1 scale (3. broadcast) col-1 show gr
0.500 setlinewidth
% Polyline
n 599 119 m 599 279 l gs col-1 s gr
% Polyline
n 519 199 m 679 199 l gs col-1 s gr
% Polyline
n 679 279 m 519 279 l gs col-1 s gr
% Polyline
n 519 119 m 519 279 l gs col-1 s gr
% Polyline
n 519 119 m 679 119 l  679 279 l gs col-1 s gr
1.000 setlinewidth
% Rotated Ellipse
gs
519 119 translate
-269.978 rotate
n 0 0 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
gr
% Rotated Ellipse
gs
519 199 translate
-269.978 rotate
n 0 0 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
gr
% Rotated Ellipse
gs
519 199 translate
-269.978 rotate
n 0 0 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
gr
% Rotated Ellipse
gs
519 279 translate
-269.978 rotate
n 0 0 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
gr
% Polyline
n 519 119 m 599 119 l gs col-1 s gr
n 583.000 115.000 m 599.000 119.000 l 583.000 123.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 519 119 m 679 119 l gs col-1 s gr
n 663.000 115.000 m 679.000 119.000 l 663.000 123.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 519 199 m 599 199 l gs col-1 s gr
n 583.000 195.000 m 599.000 199.000 l 583.000 203.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 524 199 m 679 199 l gs col-1 s gr
n 663.000 195.000 m 679.000 199.000 l 663.000 203.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 519 279 m 599 279 l gs col-1 s gr
n 583.000 275.000 m 599.000 279.000 l 583.000 283.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 519 279 m 679 279 l gs col-1 s gr
n 663.000 275.000 m 679.000 279.000 l 663.000 283.000 l gs 2 setlinejoin col-1 s gr
0.500 setlinewidth
% Polyline
n 119 479 m 279 479 l gs col-1 s gr
% Polyline
n 199 399 m 199 559 l gs col-1 s gr
% Polyline
n 279 559 m 279 399 l gs col-1 s gr
% Polyline
n 119 399 m 279 399 l gs col-1 s gr
% Polyline
n 119 399 m 119 559 l  279 559 l gs col-1 s gr
1.000 setlinewidth
% Ellipse
n 119 399 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 199 399 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 199 399 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 279 399 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 119 399 m 119 479 l gs col-1 s gr
n 123.000 463.000 m 119.000 479.000 l 115.000 463.000 l gs 2 setlinejoin col-1 s gr
0.500 setlinewidth
% Polyline
n 519 479 m 679 479 l gs col-1 s gr
1.000 setlinewidth
% Polyline
n 119 399 m 119 559 l gs col-1 s gr
n 123.000 543.000 m 119.000 559.000 l 115.000 543.000 l gs 2 setlinejoin col-1 s gr
/Times-Italic findfont 18.00 scalefont setfont
384 99 m 
gs 1 -1 scale (x) col-1 show gr
% Polyline
n 199 399 m 199 479 l gs col-1 s gr
n 203.000 463.000 m 199.000 479.000 l 195.000 463.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 199 404 m 199 559 l gs col-1 s gr
n 203.000 543.000 m 199.000 559.000 l 195.000 543.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 279 399 m 279 479 l gs col-1 s gr
n 283.000 463.000 m 279.000 479.000 l 275.000 463.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 279 399 m 279 559 l gs col-1 s gr
n 283.000 543.000 m 279.000 559.000 l 275.000 543.000 l gs 2 setlinejoin col-1 s gr
0.500 setlinewidth
% Polyline
n 119 199 m 279 199 l gs col-1 s gr
% Polyline
n 199 119 m 199 279 l gs col-1 s gr
% Polyline
n 279 279 m 279 119 l gs col-1 s gr
% Polyline
n 119 119 m 279 119 l gs col-1 s gr
% Polyline
n 119 119 m 119 279 l  279 279 l gs col-1 s gr
1.000 setlinewidth
% Ellipse
n 118 116 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
0.500 setlinewidth
% Polyline
n 119 119 m 199 119 l gs col-1 s gr
1.000 setlinewidth
% Polyline
n 119 114 m 119 199 l gs col-1 s gr
n 123.000 183.000 m 119.000 199.000 l 115.000 183.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 124 119 m 204 119 l gs col-1 s gr
n 188.000 115.000 m 204.000 119.000 l 188.000 123.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 119 m 119 279 l gs col-1 s gr
n 123.000 263.000 m 119.000 279.000 l 115.000 263.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 119 m 274 119 l gs col-1 s gr
n 258.000 115.000 m 274.000 119.000 l 258.000 123.000 l gs 2 setlinejoin col-1 s gr
% Ellipse
n 119 839 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 199 839 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 276 838 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 119 759 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 199 759 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 278 761 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 199 679 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 278 678 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 119 679 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
0.500 setlinewidth
% Polyline
n 119 759 m 279 759 l gs col-1 s gr
% Polyline
n 199 679 m 199 839 l gs col-1 s gr
% Polyline
n 279 839 m 279 679 l gs col-1 s gr
% Polyline
n 119 679 m 279 679 l gs col-1 s gr
% Polyline
n 119 679 m 119 839 l  279 839 l gs col-1 s gr
1.000 setlinewidth
% Polyline
n 119 839 m 119 679 l gs col-1 s gr
n 115.000 695.000 m 119.000 679.000 l 123.000 695.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 199 839 m 119 679 l gs col-1 s gr
n 122.578 695.100 m 119.000 679.000 l 129.733 691.522 l gs 2 setlinejoin col-1 s gr
% Polyline
n 279 679 m 119 679 l gs col-1 s gr
n 135.000 683.000 m 119.000 679.000 l 135.000 675.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 279 759 m 119 679 l gs col-1 s gr
n 131.522 689.733 m 119.000 679.000 l 135.100 682.578 l gs 2 setlinejoin col-1 s gr
% Polyline
n 274 839 m 119 679 l gs col-1 s gr
n 127.260 693.275 m 119.000 679.000 l 133.006 687.709 l gs 2 setlinejoin col-1 s gr
% Polyline
n 374 44 m 374 104 l gs col-1 s gr
n 378.000 88.000 m 374.000 104.000 l 370.000 88.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 374 44 m 434 44 l gs col-1 s gr
n 418.000 40.000 m 434.000 44.000 l 418.000 48.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
124 619 m 
gs 1 -1 scale (    submatrices ) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
124 644 m 
gs 1 -1 scale (    ) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
234 619 m 
gs 1 -1 scale (of B) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
124 594 m 
gs 1 -1 scale (4. broadcast) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
384 24 m 
gs 1 -1 scale (Axes) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
414 64 m 
gs 1 -1 scale (y) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
24 204 m 
gs 1 -1 scale (1. scatter A) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
164 104 m 
gs 1 -1 scale (2. scatter B) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
149 879 m 
gs 1 -1 scale (6. gather C) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 2396 a Fo(Figure)13 b(6.6)249 2434 y Fz(Phases)e(in)g(2D)g
(parallel)f(matrix)f(pro)q(duct)h(algorithm.)p eop
%%Page: 276 290
276 289 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(276)1256 b(Chapter)13 b(6)380
507 y Fr(!)21 b(dimensions)f(of)i(local)e(submatrices)249
561 y(REAL,)h(ALLOCATABLE)e(AA\(:\),)i(BB\(:\),)f(CC\(:,:\))380
615 y(!)h(local)g(submatrices)249 669 y(INTEGER)42 b(comm_2D,)20
b(comm_1D\(2\),)g(pcomm)380 723 y(!)h(communicators)f(for)h(2D)g(grid,)
g(for)g(subspaces,)f(and)h(copy)g(of)g(comm)249 777 y(INTEGER)f
(coords\(2\))380 831 y(!)h(Cartesian)f(coordinates)249
885 y(INTEGER)g(rank)380 939 y(!)h(process)g(rank)249
993 y(INTEGER,)f(ALLOCATABLE)g(dispc\(:\),)g(countc\(:\))380
1047 y(!)h(displacement)f(and)h(count)g(array)f(for)i(gather)e(call.)
249 1101 y(INTEGER)g(typea,)h(typec,)g(types\(2\),)e(blen\(2\),)i
(disp\(2\))380 1155 y(!)g(datatypes)f(and)i(arrays)e(for)h(datatype)f
(creation)249 1209 y(INTEGER)g(ierr,)h(i,)h(j,)f(k,)g(sizeofreal)249
1263 y(LOGICAL)f(periods\(2\),)g(remains\(2\))249 1371
y(CALL)h(MPI_COMM_DUP\()e(comm,)i(pcomm,)f(ierr\))249
1479 y(!)i(broadcast)e(parameters)f(n\(3\))i(and)g(p\(2\))249
1533 y(CALL)g(MPI_BCAST\()f(n,)h(3,)h(MPI_INTEGER,)d(0,)i(pcomm,)g
(ierr\))249 1587 y(CALL)g(MPI_BCAST\()f(p,)h(2,)h(MPI_INTEGER,)d(0,)i
(pcomm,)g(ierr\))249 1694 y(!)h(create)e(2D)i(grid)f(of)g(processes)249
1748 y(periods)f(=)i(\(/)f(.FALSE.,)g(.FALSE./\))249
1802 y(CALL)g(MPI_CART_CREATE\()e(pcomm,)h(2,)h(p,)h(periods,)e
(.FALSE.,)g(comm_2D,)g(ierr\))249 1910 y(!)i(find)f(rank)g(and)g
(Cartesian)f(coordinates)249 1964 y(CALL)h(MPI_COMM_RANK\()e(comm_2D,)h
(rank,)h(ierr\))249 2018 y(CALL)g(MPI_CART_COORDS\()e(comm_2D,)h(rank,)
g(2,)i(coords,)e(ierr\))249 2126 y(!)i(compute)e(communicators)f(for)i
(subspaces)249 2180 y(DO)g(i)h(=)g(1,)f(2)314 2234 y(DO)h(j)f(=)h(1,)f
(2)380 2288 y(remains\(j\))f(=)h(\(i.EQ.j\))314 2342
y(END)h(DO)314 2396 y(CALL)f(MPI_CART_SUB\()f(comm_2D,)g(remains,)g
(comm_1D\(i\),)f(ierr\))249 2450 y(END)i(DO)p eop
%%Page: 277 291
277 290 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(277)249 507 y Fr(!)22 b(allocate)e(submatrices)249
561 y(nn\(1\))h(=)g(n\(1\)/p\(1\))249 615 y(nn\(2\))g(=)g
(n\(3\)/p\(2\))249 669 y(END)g(DO)249 723 y(ALLOCATE)f
(\(AA\(nn\(1\),n\(2\)\),)f(BB\(n\(2\),nn\(2\)\),)f
(CC\(nn\(1\),nn\(2\)\)\))249 831 y(IF)j(\(rank.EQ.0\))f(THEN)314
885 y(!)i(compute)e(datatype)h(for)g(slice)f(of)i(A)314
939 y(CALL)f(MPI_TYPE_VECTOR\()e(n\(2\),)i(nn\(1\),)f(n\(1\),)h
(MPI_REAL,)1164 993 y(types\(1\),)f(ierr\))314 1047 y(!)i(and)f
(correct)g(extent)f(to)h(size)g(of)h(subcolumn)e(so)h(that)314
1101 y(!)h(consecutive)e(slices)g(be)h("contiguous")314
1155 y(CALL)g(MPI_TYPE_EXTENT\()e(MPI_REAL,)h(sizeofreal,)f(ierr\))314
1209 y(blen)43 b(=)22 b(\(/)f(1,)h(1)f(/\))314 1263 y(disp)43
b(=)22 b(\(/)f(0,)h(sizeofreal*nn\(1)o(\))d(/\))314 1317
y(types\(2\))i(=)g(MPI_UB)314 1371 y(CALL)g(MPI_TYPE_STRUCT\()e(2,)i
(blen,)g(disp,)g(types,)f(typea,)h(ierr\))314 1425 y(CALL)g
(MPI_TYPE_COMMIT\()e(typea,)h(ierr\))314 1533 y(!)i(compute)e(datatype)
h(for)g(submatrix)f(of)h(C)314 1587 y(CALL)g(MPI_TYPE_VECTOR\()e
(nn\(2\),)h(nn\(1\),)h(n\(1\),)g(MPI_REAL,)1164 1641
y(types\(1\),)f(ierr\))314 1694 y(!)i(and)f(correct)g(extent)f(to)h
(size)g(of)h(subcolumn)314 1748 y(CALL)f(MPI_TYPE_STRUCT\(2,)d(blen,)j
(disp,)g(types,)g(typec,)f(ierr\))314 1802 y(CALL)h
(MPI_TYPE_COMMIT\(typ)o(ec,)e(ierr\))314 1910 y(!)j(compute)e(number)h
(of)g(subcolumns)f(preceeding)g(each)h(successive)314
1964 y(!)h(submatrix)e(of)h(C.)44 b(Submatrices)19 b(are)i(ordered)g
(in)g(row-major)314 2018 y(!)h(order,)f(to)g(fit)g(the)g(order)g(of)g
(processes)f(in)i(the)f(grid.)314 2072 y(ALLOCATE)g
(\(dispc\(p\(1\)*p\(2)o(\)\),)e(countc\(p\(1\)*p\(2\))o(\)\))314
2126 y(DO)j(i)f(=)h(1,)f(p\(1\))380 2180 y(DO)g(j)h(=)f(1,)h(p\(2\))423
2234 y(dispc\(\(i-1\)*p\(2\)+j\))c(=)k(\(\(j-1\)*p\(1\))d(+)j
(\(i-1\)\)*nn\(2\))423 2288 y(countc\(\(i-1\)*p\(2\)+j)o(\))d(=)j(1)380
2342 y(END)f(DO)314 2396 y(END)h(DO)249 2450 y(END)f(IF)p
eop
%%Page: 278 292
278 291 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(278)1256 b(Chapter)13 b(6)249
507 y Fr(!)22 b(and)f(now,)g(the)g(computation)249 615
y(!)h(1.)f(scatter)f(row)i(slices)e(of)h(matrix)g(A)h(on)f(x)h(axis)249
669 y(IF)f(\(coords\(2\).EQ.0\))e(THEN)314 723 y(CALL)i
(MPI_SCATTER\(A,)e(1,)j(typea,)e(AA,)h(nn\(1\)*n\(2\),)f(MPI_REAL,)1121
777 y(0,)h(comm_1D\(1\),)f(ierr\))249 831 y(END)h(IF)249
939 y(!)h(2.)f(scatter)f(column)h(slices)f(of)i(matrix)e(B)i(on)f(y)h
(axis)249 993 y(IF)f(\(coords\(1\).EQ.0\))e(THEN)314
1047 y(CALL)i(MPI_SCATTER\(B,)e(n\(2\)*nn\(2\),)h(MPI_REAL,)g(BB,)641
1101 y(n\(2\)*nn\(2\),)g(MPI_REAL,)g(0,)h(comm_1D\(2\),)f(ierr\))249
1155 y(END)h(IF)249 1263 y(!)h(3.)f(broadcast)f(matrix)h(AA)g(in)g(y)h
(dimension)249 1317 y(CALL)f(MPI_BCAST\(AA,)e(nn\(1\)*n\(2\),)h
(MPI_REAL,)g(0,)h(comm_1D\(2\)\))249 1425 y(!)h(4.)f(broadcast)f
(matrix)h(BB)g(in)g(x)h(dimension)271 1479 y(CALL)f(MPI_BCAST\(BB,)e
(n\(2\)*nn\(2\),)g(MPI_REAL,)h(0,)i(comm_1D\(1\)\))249
1587 y(!)g(5.)f(compute)f(submatrix)g(products)249 1641
y(DO)h(j)h(=)g(1,)f(nn\(2\))314 1694 y(DO)h(i)f(=)h(1,)f(nn\(1\))380
1748 y(CC\(i,j\))f(=)i(0)380 1802 y(DO)f(k)h(=)f(1,)h(n\(2\))445
1856 y(CC\(i,j\))f(=)g(CC\(i,j\))f(+)i(AA\(i,k\)*BB\(k,j\))380
1910 y(END)f(DO)314 1964 y(END)h(DO)249 2018 y(END)f(DO)249
2126 y(!)h(6.)f(gather)g(results)f(from)h(plane)g(to)g(node)g(0)249
2180 y(CALL)g(MPI_GATHERV\()e(CC,)j(nn\(1\)*nn\(2\),)d(MPI_REAL,)576
2234 y(C,)i(countc,)g(dispc,)f(typec,)h(0,)g(comm_2D,)f(ierr\))249
2288 y(!)i(clean)e(up)249 2342 y(DEALLOCATE\(AA,)f(BB,)i(CC\))249
2396 y(MPI_COMM_FREE\()e(pcomm,)i(ierr\))249 2450 y(MPI_COMM_FREE\()e
(comm_2D,)h(ierr\))249 2504 y(DO)h(i)h(=)g(1,)f(2)p eop
%%Page: 279 293
279 292 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(279)478 466 y
 16577003 7293880 0 0 30785863 13682606 startTexFig
 478 466 a
%%BeginDocument: ../figures/topol-matmult3.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-54.0 751.0 translate 0.900 -0.900 scale
/Times-Roman findfont 12.00 scalefont setfont
134 634 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 724 m 
gs 1 -1 scale (p) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
64 734 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
279 729 m 
gs 1 -1 scale (p) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
284 739 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
479 729 m 
gs 1 -1 scale (p) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
484 739 m 
gs 1 -1 scale (1) col-1 show gr
1.000 setlinewidth
% Polyline
n 241 711 m 251 727 l gs col-1 s gr
% Polyline
n 251 711 m 241 727 l gs col-1 s gr
% Polyline
n 422 714 m 439 714 l gs col-1 s gr
% Polyline
n 422 723 m 439 723 l gs col-1 s gr
% Polyline
n 339 779 m 299 779 l  299 659 l  339 659 l  clp gs col-1 s gr
% Polyline
n 379 779 m 339 779 l  339 659 l  379 659 l  clp gs col-1 s gr
% Polyline
n 199 759 m 199 719 l  79 719 l  79 759 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 119 639 m 119 799 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 159 639 m 159 799 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 339 659 m 339 659 l  339 659 l  339 659 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 379 779 m 379 659 l  339 659 l  339 779 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
129 624 m 
gs 1 -1 scale (p) col-1 show gr
% Polyline
n 299 739 m 379 739 l gs 1.00 setgray fill gr
gs col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
334 834 m 
gs 1 -1 scale (B) col-1 show gr
% Polyline
n 299 699 m 379 699 l gs 1.00 setgray fill gr
gs col-1 s gr
% Polyline
n 78 759 m 200 759 l  200 719 l  78 719 l  clp gs col-1 s gr
% Polyline
n 78 719 m 200 719 l  200 679 l  78 679 l  clp gs col-1 s gr
% Polyline
n 78 679 m 200 679 l  200 639 l  78 639 l  clp gs col-1 s gr
% Polyline
n 78 799 m 200 799 l  200 759 l  78 759 l  clp gs col-1 s gr
% Polyline
n 499 759 m 579 759 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 499 719 m 579 719 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 499 679 m 579 679 l gs 0.50 setgray fill gr
gs col-1 s gr
% Polyline
n 539 799 m 499 799 l  499 639 l  539 639 l  clp gs col-1 s gr
% Polyline
n 579 799 m 539 799 l  539 639 l  579 639 l  clp gs col-1 s gr
% Polyline
n 579 759 m 579 719 l  539 719 l  539 759 l  clp gs 0.50 setgray fill gr
gs col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
124 834 m 
gs 1 -1 scale (A) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
334 644 m 
gs 1 -1 scale (p) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
339 654 m 
gs 1 -1 scale (3) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
534 834 m 
gs 1 -1 scale (C) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
534 624 m 
gs 1 -1 scale (p) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
539 634 m 
gs 1 -1 scale (3) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 990 a Fo(Figure)13 b(6.7)249 1027 y Fz(Data)e(partition)e(in)i(3D)
g(parallel)f(matrix)g(pro)q(duct)f(algorithm.)314 1144
y Fr(MPI_COMM_FREE\()19 b(comm_1D\(i\),)h(ierr\))249
1198 y(END)h(DO)249 1252 y(IF)g(\(rank.EQ.0\))f(THEN)314
1306 y(DEALLOCATE\(countc,)f(dispc\))314 1360 y(MPI_TYPE_FREE\()g
(typea,)i(ierr\))314 1414 y(MPI_TYPE_FREE\()e(typec,)i(ierr\))314
1468 y(MPI_TYPE_FREE\()e(types\(1\),)h(ierr\))249 1522
y(END)h(IF)249 1630 y(!)h(returns)e(matrix)h(C)g(at)h(process)e(0)249
1684 y(RETURN)249 1738 y(END)249 1968 y Fs(Example)15
b(6.7)21 b FA(F)m(or)9 b(large)h(matrices,)g(p)q(erformance)g(can)g(b)q
(e)g(impro)o(v)o(ed)f(b)o(y)g(using)h(Strassen's)249
2022 y(algorithm,)i(rather)k(than)f(the)g Fp(n)772 2007
y Fk(3)805 2022 y FA(one.)21 b(Ev)o(en)16 b(if)e(one)h(uses)h(the)f
(simple,)f Fp(n)1451 2007 y Fk(3)1484 2022 y FA(algorithm,)e(the)249
2076 y(amoun)o(t)i(of)g(comm)o(unication)e(can)k(b)q(e)g(decreased)h(b)
o(y)e(using)h(an)f(algorithm)d(that)k(maps)e(the)249
2130 y(computation)e(on)i(a)f(3-dimensional)f(grid)h(of)g(pro)q
(cesses.)291 2184 y(The)h(parallel)g(computation)e(maps)h(the)i
Fp(n)973 2190 y Fk(1)1001 2184 y Ft(\002)10 b Fp(n)1068
2190 y Fk(2)1096 2184 y Ft(\002)g Fp(n)1163 2190 y Fk(3)1196
2184 y FA(v)o(olume)i(of)i(basic)g(pro)q(ducts)i(on)o(to)249
2238 y(a)e(three-dimensional)g(grid)g(of)f(dimensions)h
Fp(p)988 2244 y Fk(1)1016 2238 y Ft(\002)c Fp(p)1079
2244 y Fk(2)1107 2238 y Ft(\002)g Fp(p)1170 2244 y Fk(3)1188
2238 y FA(.)20 b(The)15 b(matrices)f(are)h(partitioned)249
2292 y(as)i(sho)o(wn)f(in)g(Figure)h(6.7:)22 b(matrix)15
b Fr(A)h FA(is)h(partitioned)f(in)o(to)g Fp(p)1250 2298
y Fk(1)1279 2292 y Ft(\002)c Fp(p)1344 2298 y Fk(2)1379
2292 y FA(submatrices,)k(matrix)249 2346 y Fr(B)f FA(is)f(partitioned)h
(in)o(to)f Fp(p)650 2352 y Fk(2)678 2346 y Ft(\002)c
Fp(p)741 2352 y Fk(3)774 2346 y FA(submatrices,)15 b(and)f(matrix)f
Fr(C)i FA(is)f(partitioned)h(in)o(to)f Fp(p)1634 2352
y Fk(1)1662 2346 y Ft(\002)c Fp(p)1725 2352 y Fk(3)249
2400 y FA(submatrices.)19 b(Pro)q(cess)d(\()p Fp(i;)7
b(j;)g(k)q FA(\))13 b(computes)h(the)h(pro)q(duct)g(of)f(submatrix)e
(\()p Fp(i;)7 b(j)r FA(\))15 b(of)e(matrix)g Fr(A)249
2454 y FA(and)i(submatrix)g(\()p Fp(j;)7 b(k)q FA(\))15
b(of)g(matrix)f Fr(B)p FA(.)g(The)i(submatrix)f(\()p
Fp(i;)7 b(k)q FA(\))15 b(of)g(matrix)f Fr(C)h FA(is)g(obtained)h(b)o(y)
249 2508 y(summing)11 b(the)j(subpro)q(ducts)i(computed)d(at)h(pro)q
(cesses)j(\()p Fp(i;)7 b(j;)g(k)q FA(\))p Fp(;)20 b(j)14
b FA(=)d(0)p Fp(;)c(:)g(:)g(:)e(;)i(p)1520 2514 y Fk(2)1547
2508 y Ft(\000)j FA(1.)p eop
%%Page: 280 294
280 293 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(280)1256 b(Chapter)13 b(6)328
529 y
 21313290 28559805 0 0 30654300 41245163 startTexFig
 328 529 a
%%BeginDocument: ../figures/topol-matrix3.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
 /DrawEllipse {
	/endangle exch def
	/startangle exch def
	/yrad exch def
	/xrad exch def
	/y exch def
	/x exch def
	/savematrix mtrx currentmatrix def
	x y translate xrad yrad scale 0 0 1 startangle endangle arc
	savematrix setmatrix
	} def

	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-22.0 652.0 translate 0.900 -0.900 scale
1.000 setlinewidth
% Polyline
n 54 229 m 54 149 l gs col-1 s gr
n 50.000 165.000 m 54.000 149.000 l 58.000 165.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 54 229 m 114 169 l gs col-1 s gr
n 99.858 177.485 m 114.000 169.000 l 105.515 183.142 l gs 2 setlinejoin col-1 s gr
% Polyline
n 54 229 m 134 229 l gs col-1 s gr
n 118.000 225.000 m 134.000 229.000 l 118.000 233.000 l gs 2 setlinejoin col-1 s gr
0.500 setlinewidth
% Polyline
n 54 149 m 114 89 l gs col-1 s gr
1.000 setlinewidth
% Polyline
n 54 229 m 194 169 l gs col-1 s gr
n 177.718 171.626 m 194.000 169.000 l 180.869 178.979 l gs 2 setlinejoin col-1 s gr
0.500 setlinewidth
% Polyline
n 194 169 m 134 229 l  129 229 l gs col-1 s gr
% Polyline
n 114 169 m 194 169 l gs col-1 s gr
% Polyline
n 114 169 m 114 89 l gs col-1 s gr
1.000 setlinewidth
% Polyline
n 254 109 m 254 29 l gs col-1 s gr
n 250.000 45.000 m 254.000 29.000 l 258.000 45.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 254 109 m 314 109 l gs col-1 s gr
n 298.000 105.000 m 314.000 109.000 l 298.000 113.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 254 109 m 289 59 l gs col-1 s gr
n 276.548 69.814 m 289.000 59.000 l 283.102 74.402 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
264 129 m 
gs 1 -1 scale (Axes) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
239 49 m 
gs 1 -1 scale (x) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
274 59 m 
gs 1 -1 scale (y) col-1 show gr
/Times-Italic findfont 18.00 scalefont setfont
304 99 m 
gs 1 -1 scale (z) col-1 show gr
% Ellipse
n 381 210 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 444 149 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 379 124 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 444 69 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 379 209 m 459 209 l gs col-1 s gr
n 443.000 205.000 m 459.000 209.000 l 443.000 213.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 444 149 m 524 149 l gs col-1 s gr
n 508.000 145.000 m 524.000 149.000 l 508.000 153.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 379 124 m 459 124 l gs col-1 s gr
n 443.000 120.000 m 459.000 124.000 l 443.000 128.000 l gs 2 setlinejoin col-1 s gr
0.500 setlinewidth
% Polyline
n 379 209 m 444 149 l gs col-1 s gr
% Polyline
n 379 124 m 439 69 l gs col-1 s gr
% Polyline
n 379 124 m 379 209 l gs col-1 s gr
1.000 setlinewidth
% Polyline
n 444 69 m 524 69 l gs col-1 s gr
n 508.000 65.000 m 524.000 69.000 l 508.000 73.000 l gs 2 setlinejoin col-1 s gr
0.500 setlinewidth
% Polyline
n 444 69 m 444 149 l gs col-1 s gr
1.000 setlinewidth
% Ellipse
n 59 444 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 144 444 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 202 384 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 124 384 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Polyline
n 59 444 m 59 364 l gs col-1 s gr
n 55.000 380.000 m 59.000 364.000 l 63.000 380.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 144 444 m 144 364 l gs col-1 s gr
n 140.000 380.000 m 144.000 364.000 l 148.000 380.000 l gs 2 setlinejoin col-1 s gr
0.500 setlinewidth
% Polyline
n 144 444 m 204 384 l gs col-1 s gr
1.000 setlinewidth
% Polyline
n 199 384 m 199 304 l gs col-1 s gr
n 195.000 320.000 m 199.000 304.000 l 203.000 320.000 l gs 2 setlinejoin col-1 s gr
0.500 setlinewidth
% Polyline
n 59 444 m 144 444 l gs col-1 s gr
1.000 setlinewidth
% Polyline
n 124 384 m 124 304 l gs col-1 s gr
n 120.000 320.000 m 124.000 304.000 l 128.000 320.000 l gs 2 setlinejoin col-1 s gr
0.500 setlinewidth
% Polyline
n 57 442 m 122 387 l gs col-1 s gr
% Polyline
n 124 384 m 204 384 l gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
54 499 m 
gs 1 -1 scale (    submatrices of B) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
59 474 m 
gs 1 -1 scale (4. broadcast) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
379 249 m 
gs 1 -1 scale (3. broadcast) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
379 274 m 
gs 1 -1 scale (    submatrices ) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
379 299 m 
gs 1 -1 scale (    ) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
489 274 m 
gs 1 -1 scale (of A) col-1 show gr
1.000 setlinewidth
% Polyline
n 385 476 m 385 453 l  362 453 l  362 476 l  clp gs col-1 s gr
% Polyline
n 374 442 m 397 442 l  397 465 l gs col-1 s gr
% Polyline
n 374 442 m 362 453 l gs col-1 s gr
% Polyline
n 397 465 m 385 476 l gs col-1 s gr
% Polyline
n 397 442 m 385 453 l gs col-1 s gr
% Polyline
n 390 391 m 390 368 l  367 368 l  367 391 l  clp gs col-1 s gr
% Polyline
n 379 357 m 402 357 l  402 380 l gs col-1 s gr
% Polyline
n 379 357 m 367 368 l gs col-1 s gr
% Polyline
n 402 380 m 390 391 l gs col-1 s gr
% Polyline
n 402 357 m 390 368 l gs col-1 s gr
% Polyline
n 445 336 m 445 313 l  422 313 l  422 336 l  clp gs col-1 s gr
% Polyline
n 434 302 m 457 302 l  457 325 l gs col-1 s gr
% Polyline
n 434 302 m 422 313 l gs col-1 s gr
% Polyline
n 457 325 m 445 336 l gs col-1 s gr
% Polyline
n 457 302 m 445 313 l gs col-1 s gr
% Polyline
n 440 416 m 440 393 l  417 393 l  417 416 l  clp gs col-1 s gr
% Polyline
n 429 382 m 452 382 l  452 405 l gs col-1 s gr
% Polyline
n 429 382 m 417 393 l gs col-1 s gr
% Polyline
n 452 405 m 440 416 l gs col-1 s gr
% Polyline
n 54 229 m 114 89 l gs col-1 s gr
n 104.021 102.131 m 114.000 89.000 l 111.374 105.282 l gs 2 setlinejoin col-1 s gr
% Polyline
n 452 382 m 440 393 l gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
384 719 m 
gs 1 -1 scale (7. gather C) col-1 show gr
% Polyline
n 475 391 m 475 368 l  452 368 l  452 391 l  clp gs col-1 s gr
% Polyline
n 464 357 m 487 357 l  487 380 l gs col-1 s gr
% Polyline
n 464 357 m 452 368 l gs col-1 s gr
% Polyline
n 487 380 m 475 391 l gs col-1 s gr
% Polyline
n 487 357 m 475 368 l gs col-1 s gr
% Polyline
n 475 476 m 475 453 l  452 453 l  452 476 l  clp gs col-1 s gr
% Polyline
n 464 442 m 487 442 l  487 465 l gs col-1 s gr
% Polyline
n 464 442 m 452 453 l gs col-1 s gr
% Polyline
n 487 465 m 475 476 l gs col-1 s gr
% Polyline
n 487 442 m 475 453 l gs col-1 s gr
% Polyline
n 530 331 m 530 308 l  507 308 l  507 331 l  clp gs col-1 s gr
% Polyline
n 519 297 m 542 297 l  542 320 l gs col-1 s gr
% Polyline
n 519 297 m 507 308 l gs col-1 s gr
% Polyline
n 542 320 m 530 331 l gs col-1 s gr
% Polyline
n 542 297 m 530 308 l gs col-1 s gr
% Polyline
n 525 416 m 525 393 l  502 393 l  502 416 l  clp gs col-1 s gr
% Polyline
n 514 382 m 537 382 l  537 405 l gs col-1 s gr
% Polyline
n 514 382 m 502 393 l gs col-1 s gr
% Polyline
n 537 405 m 525 416 l gs col-1 s gr
% Polyline
n 537 382 m 525 393 l gs col-1 s gr
0.500 setlinewidth
	[4.000000] 0 setdash
% Polyline
n 379 374 m 434 319 l gs col-1 s gr
	[] 0 setdash
	[4.000000] 0 setdash
% Polyline
n 464 379 m 519 319 l gs col-1 s gr
	[] 0 setdash
	[4.000000] 0 setdash
% Polyline
n 379 459 m 434 399 l gs col-1 s gr
	[] 0 setdash
	[4.000000] 0 setdash
% Polyline
n 459 459 m 519 399 l gs col-1 s gr
	[] 0 setdash
	[4.000000] 0 setdash
% Polyline
n 379 374 m 379 459 l gs col-1 s gr
	[] 0 setdash
	[4.000000] 0 setdash
% Polyline
n 519 319 m 519 409 l gs col-1 s gr
	[] 0 setdash
	[4.000000] 0 setdash
% Polyline
n 379 459 m 464 459 l gs col-1 s gr
	[] 0 setdash
	[4.000000] 0 setdash
% Polyline
n 379 379 m 464 379 l gs col-1 s gr
	[] 0 setdash
	[4.000000] 0 setdash
% Polyline
n 434 319 m 519 319 l gs col-1 s gr
	[] 0 setdash
	[4.000000] 0 setdash
% Polyline
n 464 379 m 464 459 l gs col-1 s gr
	[] 0 setdash
	[4.000000] 0 setdash
% Polyline
n 434 319 m 434 399 l gs col-1 s gr
	[] 0 setdash
	[4.000000] 0 setdash
% Polyline
n 434 399 m 519 399 l gs col-1 s gr
	[] 0 setdash
1.000 setlinewidth
% Ellipse
n 114 544 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 124 614 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 199 539 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 199 619 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 64 604 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 144 604 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 144 684 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 66 684 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
0.500 setlinewidth
% Polyline
n 64 604 m 144 604 l gs col-1 s gr
% Polyline
n 64 684 m 144 684 l gs col-1 s gr
% Polyline
n 144 604 m 144 684 l gs col-1 s gr
% Polyline
n 64 604 m 64 684 l gs col-1 s gr
1.000 setlinewidth
% Polyline
n 114 544 m 64 604 l gs col-1 s gr
n 77.316 594.269 m 64.000 604.000 l 71.170 589.148 l gs 2 setlinejoin col-1 s gr
% Polyline
n 124 614 m 64 684 l gs col-1 s gr
n 77.450 674.455 m 64.000 684.000 l 71.376 669.249 l gs 2 setlinejoin col-1 s gr
% Polyline
n 199 539 m 144 604 l gs col-1 s gr
n 157.389 594.370 m 144.000 604.000 l 151.282 589.202 l gs 2 setlinejoin col-1 s gr
% Polyline
n 199 619 m 144 684 l gs col-1 s gr
n 157.389 674.370 m 144.000 684.000 l 151.282 669.202 l gs 2 setlinejoin col-1 s gr
% Ellipse
n 379 604 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 459 604 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 459 684 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
% Ellipse
n 381 685 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
0.500 setlinewidth
% Polyline
n 379 684 m 379 604 l  459 604 l gs col-1 s gr
% Polyline
n 459 604 m 459 684 l gs col-1 s gr
% Polyline
n 379 684 m 459 684 l gs col-1 s gr
1.000 setlinewidth
% Polyline
n 379 604 m 379 684 l gs col-1 s gr
n 383.000 668.000 m 379.000 684.000 l 375.000 668.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 459 604 m 384 684 l gs col-1 s gr
n 397.861 675.063 m 384.000 684.000 l 392.025 669.592 l gs 2 setlinejoin col-1 s gr
% Polyline
n 459 684 m 379 684 l gs col-1 s gr
n 395.000 688.000 m 379.000 684.000 l 395.000 680.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
349 514 m 
gs 1 -1 scale (5. compute products) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
354 539 m 
gs 1 -1 scale (   of submatrices) col-1 show gr
% Ellipse
n 54 229 7 7 0 360 DrawEllipse gs 0.00 setgray fill gr
gs col-1 s gr
/Times-Roman findfont 18.00 scalefont setfont
64 264 m 
gs 1 -1 scale (2. scatter B) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
24 84 m 
gs 1 -1 scale (1. scatter A) col-1 show gr
/Times-Roman findfont 18.00 scalefont setfont
54 724 m 
gs 1 -1 scale (6. reduce products) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 2401 a Fo(Figure)g(6.8)249 2438 y Fz(Phases)e(in)g(3D)g(parallel)f
(matrix)f(pro)q(duct)h(algorithm.)p eop
%%Page: 281 295
281 294 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(281)291 507 y FA(The)14 b(successiv)o(e)i(phases)f(of)e(the)i
(computation)d(are)i(illustrated)g(in)f(Figure)h(6.8.)196
590 y(1.)20 b(The)14 b(submatrices)g(of)g Fr(A)f FA(are)h(scattered)i
(in)e(the)g(\()p Fp(x;)7 b(y)q(;)g FA(0\))14 b(plane;)196
644 y(2.)20 b(The)14 b(submatrices)g(of)g Fr(B)f FA(are)h(scattered)i
(in)e(the)g(\(0)p Fp(;)7 b(y)q(;)g(z)r FA(\))14 b(plane.)196
698 y(3.)20 b(The)14 b(submatrices)g(of)g Fr(A)f FA(are)h(replicated)h
(in)e(the)i Fp(z)h FA(dimension.)196 752 y(4.)k(The)14
b(submatrices)g(of)g Fr(B)f FA(are)h(replicated)h(in)e(the)i
Fp(x)e FA(dimension.)196 806 y(5.)20 b(Eac)o(h)14 b(pro)q(cess)i
(computes)e(one)g(submatrix)e(pro)q(duct.)196 860 y(6.)20
b(The)14 b(subpro)q(ducts)i(are)e(reduced)i(in)d(the)i
Fp(y)h FA(dimension.)196 914 y(7.)k(Matrix)14 b Fr(C)f
FA(is)h(gathered)h(from)d(the)i(\()p Fp(x;)7 b FA(0)p
Fp(;)g(z)r FA(\))13 b(plane.)249 997 y Fr(SUBROUTINE)20
b(PMATMULT\()g(A,)h(B,)g(C,)h(n,)f(p,)h(comm\))380 1051
y(!)f(subroutine)f(arguments)g(are)h(meaningful)f(only)h(at)g(process)g
(0)249 1105 y(INTEGER)f(n\(3\))380 1159 y(!)h(matrix)g(dimensions)249
1213 y(REAL)86 b(A\(n\(1\),n\(2\)\),)423 1267 y(B\(n\(2\),n\(3\)\),)423
1321 y(C\(n\(1\),n\(3\)\))380 1375 y(!)21 b(data)249
1429 y(INTEGER)f(p\(3\))380 1483 y(!)h(dimensions)f(of)i(processor)d
(grid.)i(p\(i\))g(must)g(divide)380 1537 y(!)g(exactly)g(n\(i\))g(and)g
(the)g(product)f(of)i(the)f(3)h(dimensions)380 1591 y(!)f(must)g(equal)
g(the)g(size)g(of)h(the)f(group)g(of)g(comm)249 1645
y(INTEGER)f(comm)380 1699 y(!)h(communicator)f(for)h(processes)f(that)h
(participate)e(in)j(computation)249 1807 y(INTEGER)e(nn\(3\))380
1861 y(!)h(dimensions)f(of)i(local)e(submatrices)249
1914 y(REAL,)h(ALLOCATABLE)e(AA\(:,:\),)h(BB\(:,:\),)h(CC\(:,:\),)f
(CC1\(:,:\))380 1968 y(!)h(local)g(submatrices)249 2022
y(INTEGER)42 b(comm_3D,)20 b(comm_2D\(3\),)g(comm_1D\(3\),)f(pcomm)380
2076 y(!)i(communicators)f(for)h(3D)g(grid,)g(for)g(subspaces,)f(and)h
(copy)g(of)g(comm)249 2130 y(INTEGER)f(coords\(3\))380
2184 y(!)h(Cartesian)f(coordinates)249 2238 y(INTEGER)g(rank)380
2292 y(!)h(process)g(rank)249 2346 y(INTEGER,)f(ALLOCATABLE)g
(dispa\(:\),)g(dispb\(:\),)g(dispc\(:\),)707 2400 y(counta\(:\),)f
(countb\(:\),)h(countc\(:\))380 2454 y(!)h(displacement)f(and)h(count)g
(arrays)f(for)h(scatter/gather)e(calls.)249 2508 y(INTEGER)h(typea,)h
(typeb,)g(typec,)f(types\(2\),)g(blen\(2\),)g(disp\(2\))p
eop
%%Page: 282 296
282 295 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(282)1256 b(Chapter)13 b(6)380
507 y Fr(!)21 b(datatypes)f(and)i(arrays)e(for)h(datatype)f(creation)
249 561 y(INTEGER)g(ierr,)h(i,)h(j,)f(k,)g(sizeofreal)249
615 y(LOGICAL)f(periods\(3\),)g(remains\(3\))249 723
y(CALL)h(MPI_COMM_DUP\()e(comm,)i(pcomm,)f(ierr\))249
831 y(!)i(broadcast)e(parameters)f(n\(3\))i(and)g(p\(3\))249
885 y(CALL)g(MPI_BCAST\()f(n,)h(3,)h(MPI_INTEGER,)d(0,)i(pcomm,)g
(ierr\))249 939 y(CALL)g(MPI_BCAST\()f(p,)h(3,)h(MPI_INTEGER,)d(0,)i
(pcomm,)g(ierr\))249 1047 y(!)h(create)e(3D)i(grid)f(of)g(processes)249
1101 y(periods)f(=)i(\(\\)f(.FALSE.,)g(.FALSE.,)f(.FALSE.\\\))249
1155 y(CALL)h(MPI_CART_CREATE\()e(pcomm,)h(3,)h(p,)h(periods,)e
(.FALSE.,)g(comm_3D,)g(ierr\))249 1263 y(!)i(find)f(rank)g(and)g
(Cartesian)f(coordinates)249 1317 y(CALL)h(MPI_COMM_RANK\(comm)o(_3D,)d
(rank,)j(ierr\))249 1371 y(CALL)g(MPI_CART_COORDS\(co)o(mm_3)o(D,)e
(rank,)i(3,)g(coords,)f(ierr\))249 1479 y(!)i(compute)e(communicators)f
(for)i(subspaces)249 1587 y(!)h(2D)f(subspaces)249 1641
y(DO)g(i)h(=)g(1,)f(3)314 1694 y(DO)h(j)f(=)h(1,)f(3)380
1748 y(remains\(j\))f(=)h(\(i.NE.j\))314 1802 y(END)h(DO)314
1856 y(CALL)f(MPI_CART_SUB\()f(comm_3D,)g(remains,)g(comm_2D\(i\),)f
(ierr\))249 1910 y(END)i(DO)249 2018 y(!)h(1D)f(subspaces)249
2072 y(DO)g(i)h(=)g(1,)f(3)314 2126 y(DO)h(j)f(=)h(1,)f(3)380
2180 y(remains\(j\))f(=)h(\(i.EQ.j\))314 2234 y(END)h(DO)314
2288 y(CALL)f(MPI_CART_SUB\()f(comm_3D,)g(remains,)g(comm_1D\(i\),)f
(ierr\))249 2342 y(END)i(DO)249 2450 y(!)h(allocate)e(submatrices)249
2504 y(DO)h(i)h(=)g(1,)f(3)p eop
%%Page: 283 297
283 296 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(283)314 507 y Fr(nn\(i\))21 b(=)h(n\(i\)/p\(i\))249
561 y(END)f(DO)249 615 y(ALLOCATE)f(\(AA\(nn\(1\),nn\(2\)\),)e
(BB\(nn\(2\),nn\(3\)\),)h(CC\(nn\(1\),nn\(3\)\)\))249
723 y(IF)i(\(rank.EQ.0\))f(THEN)314 777 y(!)i(compute)e(datatype)h(for)
g(submatrix)f(of)h(A)314 831 y(CALL)g(MPI_TYPE_VECTOR\()e(nn\(2\),)h
(nn\(1\),)h(n\(1\),)g(MPI_REAL,)1164 885 y(types\(1\),)f(ierr\))314
939 y(!)i(and)f(correct)g(extent)f(to)h(size)g(of)h(subcolumn)314
993 y(MPI_TYPE_EXTENT\()d(MPI_REAL,)h(sizeofreal,)f(ierr\))314
1047 y(blen)43 b(=)22 b(\(\\)f(1,)h(1)f(\\\))314 1101
y(disp)43 b(=)22 b(\(\\)f(0,)h(sizeofreal*nn\(1)o(\))d(\\\))314
1155 y(types\(2\))i(=)g(MPI_UB)314 1209 y(CALL)g(MPI_TYPE_STRUCT\()e
(2,)i(blen,)g(disp,)g(types,)f(typea,)h(ierr\))314 1263
y(CALL)g(MPI_TYPE_COMMIT\()e(typea,)h(ierr\))314 1371
y(!)i(compute)e(number)h(of)g(subcolumns)f(preceeding)g(each)314
1425 y(!)i(submatrix)e(of)h(A.)44 b(Submatrices)19 b(are)i(ordered)g
(in)g(row-major)314 1479 y(!)h(order,)f(to)g(fit)g(the)g(order)g(of)g
(processes)f(in)i(the)f(grid.)314 1533 y(ALLOCATE)g
(\(dispa\(p\(1\)*p\(2)o(\)\),)e(counta\(p\(1\)*p\(2\))o(\)\))314
1587 y(DO)j(i)f(=)h(1,)f(p\(1\))380 1641 y(DO)g(j)h(=)f(1,)h(p\(2\))423
1694 y(dispa\(\(i-1\)*p\(2\)+j\))c(=)k(\(\(j-1\)*p\(1\))d(+)j
(\(i-1\)\)*nn\(2\))423 1748 y(counta\(\(i-1\)*p\(2\)+j)o(\))d(=)j(1)380
1802 y(END)f(DO)314 1856 y(END)h(DO)314 1964 y(!)g(same)f(for)g(array)g
(B)314 2018 y(CALL)g(MPI_TYPE_VECTOR\()e(nn\(3\),)h(nn\(2\),)h(n\(2\),)
g(MPI_REAL,)1164 2072 y(types\(1\),)f(ierr\))314 2126
y(disp\(2\))h(=)g(sizeofreal*nn\(2\))314 2180 y(CALL)g
(MPI_TYPE_STRUCT\(2,)d(blen,)j(disp,)g(types,)g(typeb,)f(ierr\))314
2234 y(CALL)h(MPI_TYPE_COMMIT\(typ)o(eb,)e(ierr\))314
2288 y(ALLOCATE)i(\(dispb\(p\(2\)*p\(3)o(\)\),)e(countb\(p\(2\)*p\(3\))
o(\)\))314 2342 y(DO)j(i)f(=)h(1,)f(p\(2\))380 2396 y(DO)g(j)h(=)f(1,)h
(p\(3\))423 2450 y(dispb\(\(i-1\)*p\(3\)+j\))c(=)k(\(\(j-1\)*p\(2\))d
(+)j(\(i-1\)\)*nn\(3\))423 2504 y(countb\(\(i-1\)*p\(3\)+j)o(\))d(=)j
(1)p eop
%%Page: 284 298
284 297 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(284)1256 b(Chapter)13 b(6)380
507 y Fr(END)21 b(DO)314 561 y(END)h(DO)314 669 y(!)g(same)f(for)g
(array)g(C)314 723 y(CALL)g(MPI_TYPE_VECTOR\(nn\()o(3\),)e(nn\(1\),)h
(n\(1\),)h(MPI_REAL,)1164 777 y(types\(1\),)f(ierr\))314
831 y(disp\(2\))h(=)g(sizeofreal*nn\(1\))314 885 y(CALL)g
(MPI_TYPE_STRUCT\(2,)d(blen,)j(disp,)g(types,)g(typec,)f(ierr\))314
939 y(CALL)h(MPI_TYPE_COMMIT\(typ)o(ec,)e(ierr\))314
993 y(ALLOCATE)i(\(dispc\(p\(1\)*p\(3)o(\)\),)e(countc\(p\(1\)*p\(3\))o
(\)\))314 1047 y(DO)j(i)f(=)h(1,)f(p\(1\))380 1101 y(DO)g(j)h(=)f(1,)h
(p\(3\))423 1155 y(dispc\(\(i-1\)*p\(3\)+j\))c(=)k(\(\(j-1\)*p\(1\))d
(+)j(\(i-1\)\)*nn\(3\))423 1209 y(countc\(\(i-1\)*p\(3\)+j)o(\))d(=)j
(1)380 1263 y(END)f(DO)314 1317 y(END)h(DO)249 1371 y(END)f(IF)249
1479 y(!)h(and)f(now,)g(the)g(computation)249 1587 y(!)h(1.)f(scatter)f
(matrix)h(A)249 1641 y(IF)g(\(coords\(3\).EQ.0\))314
1694 y(CALL)g(MPI_SCATTERV\(A,)e(counta,)h(dispa,)h(typea,)489
1748 y(AA,)g(nn\(1\)*nn\(2\),)e(MPI_REAL,)h(0,)i(Comm_2D\(3\),)d
(ierr\))249 1802 y(END)i(IF)249 1910 y(!)h(2.)f(scatter)f(matrix)h(B)
249 1964 y(IF)g(\(coords\(1\).EQ.0\))e(THEN)314 2018
y(CALL)i(MPI_SCATTERV\(B,)e(countb,)h(dispb,)h(typeb,)489
2072 y(BB,)g(nn\(2\)*nn\(3\),)e(MPI_REAL,)h(0,)i(Comm_2D\(1\),)d
(ierr\))249 2126 y(END)i(IF)249 2234 y(!)h(3.)f(broadcast)f(matrix)h
(AA)g(in)g(z)h(dimension)249 2288 y(CALL)f(MPI_BCAST\(AA,)e
(nn\(1\)*nn\(2\),)g(MPI_REAL,)h(0,)i(comm_1D\(3\),)d(ierr\))249
2396 y(!)j(4.)f(broadcast)f(matrix)h(BB)g(in)g(x)h(dimension)271
2450 y(CALL)f(MPI_BCAST\(BB,)e(nn\(2\)*nn\(3\),)g(MPI_REAL,)h(0,)i
(comm_1D\(1\),)d(ierr\))p eop
%%Page: 285 299
285 298 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Pro)q(cess)14 b(T)m(op)q(ologies)1123
b(285)249 507 y Fr(!)22 b(5.)f(compute)f(submatrix)g(products)249
561 y(DO)h(j)h(=)g(1,)f(nn\(3\))314 615 y(DO)h(i)f(=)h(1,)f(nn\(1\))380
669 y(CC\(i,j\))f(=)i(0)380 723 y(DO)f(k)h(=)f(1,)h(nn\(2\))445
777 y(CC\(i,j\))f(=)g(CC\(i,j\))f(+)i(AA\(i,k\)*BB\(k,j\))380
831 y(END)f(DO)314 885 y(END)h(DO)249 939 y(END)f(DO)249
1047 y(!)h(6.)f(reduce)g(subproducts)e(in)i(y)h(dimension)249
1101 y(!)g(need)f(additional)e(matrix,)i(since)f(one)i(cannot)e(reduce)
h("in)g(place")249 1155 y(ALLOCATE)f(\(CC1\(nn\(1\),nn\(3\)\)\))249
1209 y(CALL)h(MPI_REDUCE\(CC,)e(CC1,)i(nn\(1\)*nn\(3\),)e(MPI_REAL,)h
(MPI_SUM,)1121 1263 y(0,)h(comm_1D\(2\),)f(ierr\))249
1371 y(!)i(7.)f(gather)g(results)f(from)h(plane)g(\(x,0,z\))f(to)h
(node)g(0)249 1425 y(IF)g(\(coords\(2\).EQ.0\))e(THEN)314
1479 y(CALL)i(MPI_GATHERV\(CC1,)e(nn\(1\)*nn\(3\),)g(MPI_REAL,)576
1533 y(C,)i(countc,)g(dispc,)f(typec,)h(0,)g(comm_2D\(2\),)f(ierr\))249
1587 y(END)h(IF)249 1694 y(!)h(clean)e(up)249 1748 y(DEALLOCATE\(AA,)f
(BB,)i(CC\))249 1802 y(DEALLOCATE)f(\(CC1\))249 1856
y(IF)h(\(rank.EQ.0\))f(THEN)314 1910 y(DEALLOCATE)g(\(counta,)g
(countb,)h(countc,)f(dispa,)h(dispb,)f(dispc\))314 1964
y(MPI_TYPE_FREE\()f(typea,)i(ierr\))314 2018 y(MPI_TYPE_FREE\()e
(typeb,)i(ierr\))314 2072 y(MPI_TYPE_FREE\()e(typec,)i(ierr\))314
2126 y(MPI_TYPE_FREE\()e(types\(1\),)h(ierr\))249 2180
y(END)h(IF)249 2234 y(MPI_COMM_FREE\()e(pcomm,)i(ierr\))249
2288 y(MPI_COMM_FREE\()e(comm_3D,)h(ierr\))249 2342 y(DO)h(i)h(=)g(1,)f
(3)314 2396 y(MPI_COMM_FREE\()e(comm_2D\(i\),)h(ierr\))314
2450 y(MPI_COMM_FREE\()f(comm_1D\(i\),)h(ierr\))249 2504
y(END)h(DO)p eop
%%Page: 286 300
286 299 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(286)1256 b(Chapter)13 b(6)249
561 y Fr(!)22 b(returns)e(matrix)h(C)g(at)h(process)e(0)249
615 y(RETURN)249 669 y(END)p eop
%%Page: 287 301
287 300 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 325 a Fu(7)25 b FD(En)o(vironmen)o(tal)17
b(Managemen)o(t)291 561 y FA(This)9 b(c)o(hapter)i(discusses)g
(routines)g(for)e(getting)g(and,)h(where)h(appropriate,)f(setting)g(v)n
(arious)249 615 y(parameters)j(that)h(relate)f(to)g(the)h
Fw(MPI)f FA(implem)o(en)o(tation)d(and)j(the)h(execution)g(en)o
(vironmen)o(t.)249 669 y(It)f(discusses)i(error)f(handling)e(in)h
Fw(MPI)f FA(and)h(the)h(pro)q(cedures)h(a)o(v)n(ailable)c(for)h(con)o
(trolling)g Fw(MPI)249 723 y FA(error)g(handling.)k(The)c(pro)q
(cedures)h(for)e(en)o(tering)h(and)f(lea)o(ving)f(the)i
Fw(MPI)f FA(execution)h(en)o(viron-)249 777 y(men)o(t)f(are)h(also)f
(describ)q(ed)i(here.)18 b(Finally)m(,)10 b(the)i(c)o(hapter)h
(discusses)g(the)f(in)o(teraction)g(b)q(et)o(w)o(een)249
831 y Fw(MPI)h FA(and)h(the)g(general)h(execution)f(en)o(vironmen)o(t.)
249 951 y FD(7.1)52 b(Implemen)o(tation)18 b(Information)249
1059 y Fs(7.1.1)48 b(En)o(vironmen)o(t)o(al)13 b(Inquiries)249
1142 y FA(A)d(set)h(of)f(attributes)h(that)f(describ)q(e)i(the)e
(execution)h(en)o(vironmen)o(t)e(are)i(attac)o(hed)f(to)g(the)h(com-)
249 1196 y(m)o(unicator)d Fq(MPI)p 514 1196 12 2 v 13
w(COMM)p 648 1196 V 13 w(W)o(ORLD)h FA(when)h Fw(MPI)f
FA(is)h(initialized.)15 b(The)10 b(v)n(alue)f(of)g(these)i(attributes)
249 1250 y(can)k(b)q(e)h(inquired)f(b)o(y)g(using)g(the)g(function)g
Fw(MPI)p 1030 1250 13 2 v 14 w(A)m(TTR)p 1152 1250 V
15 w(GET)g FA(describ)q(ed)i(in)d(Chapter)i(5.)21 b(It)249
1304 y(is)14 b(erroneous)h(to)f(delete)h(these)g(attributes,)f(free)h
(their)f(k)o(eys,)g(or)g(c)o(hange)g(their)g(v)n(alues.)291
1358 y(The)g(list)f(of)h(prede\014ned)h(attribute)g(k)o(eys)f(include)
249 1441 y Fq(MPI)p 321 1441 12 2 v 13 w(T)m(A)o(G)p
408 1441 V 13 w(UB)21 b FA(Upp)q(er)15 b(b)q(ound)f(for)f(tag)h(v)n
(alue.)249 1512 y Fq(MPI)p 321 1512 V 13 w(HOST)22 b
FA(Host)14 b(pro)q(cess)i(rank,)d(if)g(suc)o(h)i(exists,)28
b Fq(MPI)p 1150 1512 V 12 w(PROC)p 1265 1512 V 13 w(NULL)p
FA(,)14 b(otherwise.)249 1582 y Fq(MPI)p 321 1582 V 13
w(IO)21 b FA(rank)13 b(of)h(a)f(no)q(de)i(that)f(has)g(regular)g(I/O)f
(facilities)g(\(p)q(ossibly)h(rank)g(of)f(calling)g(pro-)249
1636 y(cess\).)19 b(No)q(des)13 b(in)f(the)h(same)e(comm)o(unicator)f
(ma)o(y)g(return)j(di\013eren)o(t)g(v)n(alues)f(for)g(this)g(param-)249
1690 y(eter.)249 1761 y Fq(MPI)p 321 1761 V 13 w(WTIME)p
464 1761 V 13 w(IS)p 509 1761 V 14 w(GLOBAL)20 b FA(Bo)q(olean)10
b(v)n(ariable)f(that)h(indicates)h(whether)g(clo)q(c)o(ks)f(are)h(sync)
o(hro-)249 1815 y(nized.)291 1898 y(V)m(endors)h(ma)o(y)d(add)i
(implemen)o(tation)d(sp)q(eci\014c)13 b(parameters)f(\(suc)o(h)g(as)g
(no)q(de)g(n)o(um)o(b)q(er,)e(real)249 1952 y(memory)h(size,)k(virtual)
e(memory)e(size,)j(etc.\))291 2006 y(These)e(prede\014ned)g(attributes)
g(do)f(not)f(c)o(hange)i(v)n(alue)e(b)q(et)o(w)o(een)i
Fw(MPI)e FA(initialization)e(\()p Fw(MPI-)p 249 2060
13 2 v 262 2060 a(INIT)p FA(\))13 b(and)h Fw(MPI)f FA(completion)f(\()p
Fw(MPI)p 846 2060 V 15 w(FINALIZE)p FA(\).)249 2151 y
FB(A)n(dvic)n(e)g(to)h(users.)34 b FA(Note)12 b(that)f(in)g(the)h(C)f
(binding,)g(the)g(v)n(alue)g(returned)i(b)o(y)e(these)i(attributes)249
2205 y(is)h(a)f FB(p)n(ointer)h FA(to)g(an)f Fr(int)h
FA(con)o(taining)e(the)j(requested)h(v)n(alue.)h(\()p
FB(End)f(of)f(advic)n(e)g(to)g(users.)p FA(\))291 2296
y(The)f(required)h(parameter)e(v)n(alues)h(are)g(discussed)i(in)d(more)
g(detail)g(b)q(elo)o(w:)249 2379 y Fs(T)l(ag)18 b(V)l(alues)40
b FA(T)m(ag)14 b(v)n(alues)h(range)g(from)f Fr(0)h FA(to)g(the)h(v)n
(alue)e(returned)j(for)e Fq(MPI)p 1519 2379 12 2 v 12
w(T)m(A)o(G)p 1605 2379 V 13 w(UB)p FA(,)g(in-)249 2433
y(clusiv)o(e.)20 b(These)c(v)n(alues)f(are)g(guaran)o(teed)g(to)f(b)q
(e)i(unc)o(hanging)e(during)g(the)h(execution)h(of)e(an)249
2487 y Fw(MPI)g FA(program.)j(In)d(addition,)f(the)h(tag)g(upp)q(er)h
(b)q(ound)g(v)n(alue)e(m)o(ust)g(b)q(e)i FB(at)g(le)n(ast)j
FA(32767.)f(An)965 2613 y(287)p eop
%%Page: 288 302
288 301 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(288)1256 b(Chapter)13 b(7)249
507 y Fw(MPI)h FA(implemen)o(tation)d(is)k(free)g(to)g(mak)o(e)e(the)i
(v)n(alue)f(of)g Fq(MPI)p 1219 507 12 2 v 13 w(T)m(A)o(G)p
1306 507 V 13 w(UB)h FA(larger)f(than)h(this;)g(for)249
561 y(example,)d(the)h(v)n(alue)g(2)621 546 y Fk(30)663
561 y Ft(\000)8 b FA(1)13 b(is)g(also)f(a)h(legal)f(v)n(alue)g(for)h
Fq(MPI)p 1231 561 V 13 w(T)m(A)o(G)p 1318 561 V 13 w(UB)g
FA(\(on)g(a)f(system)h(where)249 615 y(this)h(v)n(alue)f(is)h(a)g
(legal)e Fq(int)h FA(or)h Fr(INTEGER)e FA(v)n(alue\).)291
669 y(The)17 b(attribute)g Fq(MPI)p 629 669 V 12 w(T)m(A)o(G)p
715 669 V 13 w(UB)g FA(has)f(the)h(same)f(v)n(alue)g(on)g(all)f(pro)q
(cesses)20 b(in)c(the)h(group)f(of)249 723 y Fq(MPI)p
321 723 V 13 w(COMM)p 455 723 V 13 w(W)o(ORLD)p FA(.)249
806 y Fs(Host)g(Rank)41 b FA(The)14 b(v)n(alue)f(returned)j(for)d
Fq(MPI)p 1012 806 V 13 w(HOST)i FA(gets)g(the)f(rank)g(of)f(the)i
Fr(HOST)e FA(pro)q(cess)249 860 y(in)k(the)h(group)g(asso)q(ciated)g
(with)f(comm)o(unicator)e Fq(MPI)p 1144 860 V 13 w(COMM)p
1278 860 V 13 w(W)o(ORLD)p FA(,)i(if)g(there)i(is)e(suc)o(h.)249
914 y Fq(MPI)p 321 914 V 13 w(PROC)p 437 914 V 13 w(NULL)j
FA(is)f(returned)i(if)e(there)i(is)e(no)h(host.)35 b(This)19
b(attribute)h(can)g(b)q(e)g(used)h(on)249 968 y(systems)16
b(that)g(ha)o(v)o(e)g(a)g(distinguished)g FB(host)g FA(pro)q(cessor,)i
(in)e(order)h(to)f(iden)o(tify)f(the)i(pro)q(cess)249
1022 y(running)i(on)f(this)h(pro)q(cessor.)35 b(Ho)o(w)o(ev)o(er,)20
b Fw(MPI)e FA(do)q(es)h(not)g(sp)q(ecify)g(what)g(it)f(means)g(for)h(a)
249 1076 y(pro)q(cess)d(to)e(b)q(e)g(a)g Fr(HOST)p FA(,)e(nor)i(do)q
(es)h(it)e(requires)i(that)f(a)g Fr(HOST)f FA(exists.)291
1130 y(The)19 b(attribute)h Fq(MPI)p 634 1130 V 13 w(HOST)g
FA(has)f(the)h(same)f(v)n(alue)f(on)h(all)f(pro)q(cesses)k(in)d(the)h
(group)f(of)249 1184 y Fq(MPI)p 321 1184 V 13 w(COMM)p
455 1184 V 13 w(W)o(ORLD)p FA(.)249 1267 y Fs(I/O)i(Rank)42
b FA(The)19 b(v)n(alue)f(returned)i(for)f Fq(MPI)p 1017
1267 V 12 w(IO)g FA(is)f(the)i(rank)e(of)g(a)h(pro)q(cessor)h(that)f
(can)249 1321 y(pro)o(vide)e(language-standard)f(I/O)h(facilities.)27
b(F)m(or)17 b(F)m(ortran,)g(this)g(means)f(that)h(all)f(of)h(the)249
1375 y(F)m(ortran)9 b(I/O)h(op)q(erations)g(are)g(supp)q(orted)g
(\(e.g.,)g Fr(OPEN)p FA(,)e Fr(REWIND)p FA(,)g Fr(WRITE)p
FA(\).)g(F)m(or)h(C,)g(this)g(means)249 1429 y(that)i(all)f(of)h(the)h
(ANSI-C)f(I/O)g(op)q(erations)g(are)h(supp)q(orted)g(\(e.g.,)f
Fr(fopen)p FA(,)f Fr(fprintf)p FA(,)g Fr(lseek)p FA(\).)291
1483 y(If)18 b(ev)o(ery)h(pro)q(cess)h(can)f(pro)o(vide)f
(language-standard)g(I/O,)g(then)i(the)f(v)n(alue)f Fq(MPI)p
1642 1483 V 12 w(ANY-)p 249 1537 V 261 1537 a(SOURCE)d
FA(will)e(b)q(e)i(returned.)22 b(Otherwise,)16 b(if)e(the)h(calling)f
(pro)q(cess)i(can)f(pro)o(vide)f(language-)249 1591 y(standard)d(I/O,)e
(then)i(its)f(rank)h(will)d(b)q(e)j(returned.)19 b(Otherwise,)12
b(if)d(some)g(pro)q(cess)j(can)f(pro)o(vide)249 1645
y(language-standard)e(I/O)h(then)g(the)g(rank)g(of)f(one)h(suc)o(h)g
(pro)q(cess)i(will)c(b)q(e)i(returned.)18 b(The)10 b(same)249
1699 y(v)n(alue)16 b(need)h(not)g(b)q(e)g(returned)h(b)o(y)f(all)e(pro)
q(cesses.)29 b(If)16 b(no)g(pro)q(cess)i(can)f(pro)o(vide)f(language-)
249 1753 y(standard)e(I/O,)g(then)g(the)h(v)n(alue)e
Fq(MPI)p 861 1753 V 13 w(PROC)p 977 1753 V 13 w(NULL)h
FA(will)f(b)q(e)h(returned.)249 1844 y FB(A)n(dvic)n(e)e(to)g(users.)34
b Fw(MPI)10 b FA(do)q(es)i(not)e(require)i(that)f(all)e(pro)q(cesses)k
(pro)o(vide)e(language-standard)249 1898 y(I/O,)i(nor)h(do)q(es)h(it)e
(sp)q(ecify)h(ho)o(w)g(the)g(standard)g(input)g(or)g(output)g(of)f(a)g
(pro)q(cess)j(is)d(link)o(ed)h(to)249 1952 y(a)g(particular)g(\014le)h
(or)f(device.)21 b(In)14 b(particular,)g(there)i(is)e(no)h(requiremen)o
(t,)f(in)g(an)g(in)o(teractiv)o(e)249 2006 y(en)o(vironmen)o(t,)21
b(that)g(k)o(eyb)q(oard)g(input)f(b)q(e)i(broadcast)f(to)g(all)e(pro)q
(cesses)24 b(whic)o(h)d(supp)q(ort)249 2060 y(language-standard)13
b(I/O.)h(\()p FB(End)h(of)g(advic)n(e)g(to)g(users.)p
FA(\))249 2151 y Fs(Clo)q(c)o(k)20 b(Sync)o(hronizati)o(on)38
b FA(The)17 b(v)n(alue)g(returned)h(for)f Fq(MPI)p 1272
2151 V 13 w(WTIME)p 1415 2151 V 14 w(IS)p 1461 2151 V
13 w(GLOBAL)g FA(is)f(1)h(if)249 2205 y(clo)q(c)o(ks)j(at)g(all)f(pro)q
(cesses)k(in)c Fq(MPI)p 809 2205 V 13 w(COMM)p 943 2205
V 13 w(W)o(ORLD)h FA(are)g(sync)o(hronized,)i(0)e(otherwise.)37
b(A)249 2259 y(collection)16 b(of)g(clo)q(c)o(ks)h(is)g(considered)h
(sync)o(hronized)g(if)e(explicit)g(e\013ort)h(has)g(b)q(een)h(tak)o(en)
f(to)249 2313 y(sync)o(hronize)g(them.)23 b(The)16 b(exp)q(ectation)h
(is)f(that)g(the)g(v)n(ariation)e(in)h(time,)g(as)h(measured)g(b)o(y)
249 2367 y(calls)j(to)f Fw(MPI)p 479 2367 13 2 v 15 w(WTIME)p
FA(,)g(will)f(b)q(e)j(less)g(then)f(one)g(half)f(the)i(round-trip)e
(time)g(for)g(an)h Fw(MPI)249 2421 y FA(message)e(of)g(length)h(zero.)
29 b(If)17 b(time)f(is)i(measured)f(at)h(a)f(pro)q(cess)i(just)f(b)q
(efore)g(a)f(send)i(and)249 2475 y(at)13 b(another)h(pro)q(cess)i(just)
e(after)f(a)h(matc)o(hing)d(receiv)o(e,)k(the)f(second)h(time)d(should)
h(b)q(e)h(alw)o(a)o(ys)p eop
%%Page: 289 303
289 302 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(En)o(vironmen)o(tal)16 b(Managemen)o(t)963
b(289)249 507 y FA(higher)14 b(than)g(the)g(\014rst)h(one.)291
561 y(The)i(attribute)g Fq(MPI)p 629 561 12 2 v 13 w(WTIME)p
772 561 V 14 w(IS)p 818 561 V 14 w(GLOBAL)f FA(need)i(not)e(b)q(e)i
(presen)o(t)h(when)e(the)h(clo)q(c)o(ks)f(are)249 615
y(not)22 b(sync)o(hronized)i(\(ho)o(w)o(ev)o(er,)h(the)e(attribute)g(k)
o(ey)f Fq(MPI)p 1204 615 V 13 w(WTIME)p 1347 615 V 14
w(IS)p 1393 615 V 14 w(GLOBAL)f FA(is)h(alw)o(a)o(ys)249
669 y(v)n(alid\).)37 b(This)20 b(attribute)i(ma)o(y)c(b)q(e)j(asso)q
(ciated)h(with)e(comm)o(unicators)e(other)k(then)f Fq(MPI-)p
249 723 V 261 723 a(COMM)p 384 723 V 12 w(W)o(ORLD)p
FA(.)291 777 y(The)14 b(attribute)h Fq(MPI)p 624 777
V 12 w(WTIME)p 766 777 V 14 w(IS)p 812 777 V 14 w(GLOBAL)e
FA(has)h(the)h(same)e(v)n(alue)g(on)h(all)f(pro)q(cesses)j(in)e(the)249
831 y(group)g(of)f Fq(MPI)p 486 831 V 13 w(COMM)p 620
831 V 13 w(W)o(ORLD)p FA(.)249 956 y Fw(MPI)p 326 956
13 2 v 14 w(GET)p 421 956 V 15 w(PROCESSOR)p 677 956
V 13 w(NAME\(name,)g(resultlen\))332 1031 y Fv(OUT)114
b Fw(name)453 b Fv(A)13 b(unique)i(sp)q(eci\014er)g(for)e(the)g(curren)
o(t)h(ph)o(ys-)1079 1085 y(ical)h(no)q(de.)332 1134 y(OUT)114
b Fw(resultlen)403 b Fv(Length)17 b(\(in)g(prin)o(table)h(c)o
(haracters\))f(of)f(the)1079 1188 y(result)e(returned)g(in)g
Fc(name)249 1299 y Fr(int)21 b(MPI)p 405 1299 14 2 v
15 w(Get)p 486 1299 V 15 w(processor)p 699 1299 V 14
w(name\(char)f(*name,)h(int)g(*resultlen\))249 1382 y(MPI)p
318 1382 V 15 w(GET)p 399 1382 V 15 w(PROCESSOR)p 612
1382 V 14 w(NAME\()g(NAME,)g(RESULTLEN,)e(IERROR\))336
1436 y(CHARACTER*\(*\))g(NAME)336 1490 y(INTEGER)i(RESULTLEN,IERRO)o(R)
291 1574 y FA(This)d(routine)h(returns)h(the)f(name)e(of)h(the)h(pro)q
(cessor)i(on)d(whic)o(h)h(it)f(w)o(as)g(called)g(at)h(the)249
1628 y(momen)o(t)12 b(of)h(the)i(call.)i(The)e(name)e(is)h(a)f(c)o
(haracter)j(string)e(for)g(maxim)n(um)c(\015exibilit)o(y)m(.)16
b(F)m(rom)249 1682 y(this)k(v)n(alue)f(it)h(m)o(ust)f(b)q(e)i(p)q
(ossible)f(to)g(iden)o(tify)f(a)h(sp)q(eci\014c)h(piece)g(of)e(hardw)o
(are;)k(p)q(ossible)249 1736 y(v)n(alues)16 b(include)g(\\pro)q(cessor)
h(9)f(in)g(rac)o(k)g(4)g(of)f(mpp.cs.org")f(and)i(\\231")e(\(where)k
(231)d(is)h(the)249 1790 y(actual)11 b(pro)q(cessor)i(n)o(um)o(b)q(er)d
(in)h(the)h(running)f(homogeneous)f(system\).)17 b(The)12
b(argumen)o(t)e Fw(name)249 1844 y FA(m)o(ust)f(represen)o(t)j(storage)
f(that)f(is)f(at)h(least)g Fq(MPI)p 998 1844 12 2 v 13
w(MAX)p 1097 1844 V 13 w(PROCESSOR)p 1331 1844 V 14 w(NAME)f
FA(c)o(haracters)j(long.)249 1898 y Fw(MPI)p 326 1898
13 2 v 14 w(GET)p 421 1898 V 15 w(PROCESSOR)p 677 1898
V 13 w(NAME)i FA(ma)o(y)e(write)i(up)g(to)g(this)f(man)o(y)f(c)o
(haracters)k(in)o(to)d Fw(name)p FA(.)291 1952 y(The)j(n)o(um)o(b)q(er)
e(of)h(c)o(haracters)j(actually)c(written)i(is)g(returned)h(in)e(the)h
(output)g(argumen)o(t,)249 2006 y Fw(resultlen)p FA(.)249
2097 y FB(R)n(ationale.)78 b FA(The)21 b(de\014nition)f(of)g(this)h
(function)f(do)q(es)i(not)e(preclude)i Fw(MPI)e FA(implemen-)249
2151 y(tations)e(that)g(do)g(pro)q(cess)i(migration.)28
b(In)18 b(suc)o(h)g(a)g(case,)i(successiv)o(e)g(calls)e(to)g
Fw(MPI)p 1637 2151 V 14 w(GET-)p 249 2205 V 262 2205
a(PROCESSOR)p 505 2205 V 12 w(NAME)e FA(b)o(y)f(the)i(same)d(pro)q
(cess)k(ma)o(y)c(return)j(di\013eren)o(t)f(v)n(alues.)23
b(Note)16 b(that)249 2259 y(nothing)f(in)g Fw(MPI)g FA(requires)i(or)f
(de\014nes)h(pro)q(cess)g(migration;)d(this)h(de\014nition)h(of)f
Fw(MPI)p 1637 2259 V 14 w(GET-)p 249 2313 V 262 2313
a(PROCESSOR)p 505 2313 V 12 w(NAME)f FA(simply)e(allo)o(ws)h(suc)o(h)h
(an)g(implemen)o(tatio)o(n.)h(\()p FB(End)h(of)f(r)n(ationale.)p
FA(\))249 2405 y FB(A)n(dvic)n(e)20 b(to)f(users.)68
b FA(The)19 b(user)h(m)o(ust)e(pro)o(vide)h(at)g(least)h
Fq(MPI)p 1290 2405 12 2 v 12 w(MAX)p 1388 2405 V 13 w(PROCESSOR)p
1622 2405 V 14 w(NAME)249 2459 y FA(space)c(to)f(write)h(the)f(pro)q
(cessor)i(name)d(|)h(pro)q(cessor)i(names)d(can)h(b)q(e)h(this)f(long.)
21 b(The)15 b(user)p eop
%%Page: 290 304
290 303 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(290)1256 b(Chapter)13 b(7)249
507 y FA(should)j(examine)f(the)h(output)g(argumen)o(t,)f
Fw(resultlen)p FA(,)j(to)e(determine)g(the)g(actual)g(length)g(of)249
561 y(the)f(name.)h(\()p FB(End)g(of)f(advic)n(e)g(to)g(users.)p
FA(\))291 653 y(The)c(constan)o(t)h Fq(MPI)p 610 653
12 2 v 13 w(BSEND)p 748 653 V 13 w(O)o(VERHEAD)f FA(pro)o(vides)h(an)f
(upp)q(er)h(b)q(ound)f(on)g(the)h(\014xed)g(o)o(v)o(er-)249
707 y(head)i(p)q(er)h(message)f(bu\013ered)h(b)o(y)f(a)f(call)g(to)h
Fw(MPI)p 1037 707 13 2 v 14 w(BSEND)p FA(.)249 827 y
FD(7.2)52 b(Timers)17 b(and)h(Sync)o(hronization)249
935 y Fw(MPI)c FA(de\014nes)h(a)f(timer.)19 b(A)14 b(timer)f(is)i(sp)q
(eci\014ed)g(ev)o(en)g(though)g(it)f(is)g(not)g(\\message-passing,")249
989 y(b)q(ecause)f(timing)d(parallel)g(programs)h(is)g(imp)q(ortan)o(t)
f(in)h(\\p)q(erformance)h(debugging")e(and)i(b)q(e-)249
1043 y(cause)h(existing)e(timers)h(\(b)q(oth)g(in)f(POSIX)i
(1003.1-1988)c(and)i(1003.4D)f(14.1)h(and)g(in)h(F)m(ortran)249
1097 y(90\))18 b(are)g(either)h(incon)o(v)o(enien)o(t)f(or)g(do)g(not)g
(pro)o(vide)g(adequate)h(access)g(to)f(high-resolution)249
1151 y(timers.)249 1276 y Fw(MPI)p 326 1276 V 14 w(WTIME\(\))249
1365 y Fr(double)j(MPI)p 471 1365 14 2 v 15 w(Wtime\(void\))249
1449 y(DOUBLE)g(PRECISION)f(MPI)p 689 1449 V 15 w(WTIME\(\))291
1533 y Fw(MPI)p 368 1533 13 2 v 14 w(WTIME)f FA(returns)j(a)d
(\015oating-p)q(oin)o(t)f(n)o(um)o(b)q(er)h(of)g(seconds,)j(represen)o
(ting)f(elapsed)249 1587 y(w)o(all-clo)q(c)o(k)12 b(time)h(since)i
(some)e(time)f(in)i(the)g(past.)291 1641 y(The)e(\\time)f(in)g(the)i
(past")f(is)g(guaran)o(teed)g(not)g(to)g(c)o(hange)g(during)g(the)h
(life)e(of)g(the)i(pro)q(cess.)249 1695 y(The)18 b(user)g(is)g(resp)q
(onsible)g(for)f(con)o(v)o(erting)h(large)f(n)o(um)o(b)q(ers)g(of)g
(seconds)h(to)g(other)g(units)f(if)249 1749 y(they)d(are)h(preferred.)
291 1803 y(This)9 b(function)g(is)g(p)q(ortable)g(\(it)g(returns)i
(seconds,)g(not)f(\\tic)o(ks"\),)f(it)g(allo)o(ws)f(high-resolution,)
249 1857 y(and)14 b(carries)h(no)e(unnecessary)j(baggage.)i(One)c(w)o
(ould)f(use)i(it)f(lik)o(e)f(this:)249 1952 y Fr({)314
2006 y(double)21 b(starttime,)f(endtime;)314 2060 y(starttime)g(=)i
(MPI_Wtime\(\);)336 2114 y(....)43 b(stuff)21 b(to)g(be)h(timed)42
b(...)314 2168 y(endtime)64 b(=)22 b(MPI_Wtime\(\);)314
2222 y(printf\("That)e(took)h(\045f)g(seconds\\n",endtime)o(-star)o
(ttime)o(\);)249 2276 y(})291 2371 y FA(The)14 b(times)g(returned)i
(are)f(lo)q(cal)f(to)g(the)h(no)q(de)g(that)f(called)h(them.)k(There)c
(is)f(no)h(require-)249 2425 y(men)o(t)f(that)h(di\013eren)o(t)h(no)q
(des)g(return)g(\\the)f(same)f(time.")20 b(\(But)c(see)g(also)e(the)i
(discussion)f(of)249 2479 y Fq(MPI)p 321 2479 12 2 v
13 w(WTIME)p 464 2479 V 13 w(IS)p 509 2479 V 14 w(GLOBAL)e
FA(in)h(Section)g(7.1.1\).)p eop
%%Page: 291 305
291 304 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(En)o(vironmen)o(tal)16 b(Managemen)o(t)963
b(291)249 507 y Fw(MPI)p 326 507 13 2 v 14 w(WTICK\(\))249
597 y Fr(double)21 b(MPI)p 471 597 14 2 v 15 w(Wtick\(void\))249
681 y(DOUBLE)g(PRECISION)f(MPI)p 689 681 V 15 w(WTICK\(\))291
765 y Fw(MPI)p 368 765 13 2 v 14 w(WTICK)9 b FA(returns)j(the)f
(resolution)f(of)g Fw(MPI)p 1041 765 V 14 w(WTIME)h FA(in)f(seconds.)18
b(That)10 b(is,)g(it)g(returns,)249 819 y(as)15 b(a)f(double)h
(precision)g(v)n(alue,)f(the)h(n)o(um)o(b)q(er)f(of)h(seconds)h(b)q(et)
o(w)o(een)g(successiv)o(e)h(clo)q(c)o(k)e(tic)o(ks.)249
873 y(F)m(or)k(example,)h(if)e(the)i(clo)q(c)o(k)g(is)g(implem)o(en)o
(ted)e(b)o(y)h(the)h(hardw)o(are)g(as)g(a)f(coun)o(ter)i(that)f(is)249
926 y(incremen)o(ted)14 b(ev)o(ery)g(millisecond,)d(the)j(v)n(alue)f
(returned)i(b)o(y)e Fw(MPI)p 1298 926 V 15 w(WTICK)f
FA(should)i(b)q(e)g(10)1688 911 y Fm(\000)p Fk(3)1732
926 y FA(.)249 1047 y FD(7.3)52 b(Initializat)q(ion)21
b(and)d(Exit)249 1155 y FA(One)i(goal)e(of)g Fw(MPI)h
FA(is)g(to)g(ac)o(hiev)o(e)g FB(sour)n(c)n(e)h(c)n(o)n(de)g(p)n
(ortability)p FA(.)33 b(By)19 b(this)g(w)o(e)h(mean)e(that)h(a)249
1209 y(program)d(written)i(using)f Fw(MPI)f FA(and)h(complying)e(with)i
(the)h(relev)n(an)o(t)f(language)g(standards)249 1263
y(is)d(p)q(ortable)g(as)g(written,)h(and)f(m)o(ust)f(not)h(require)h
(an)o(y)e(source)j(co)q(de)f(c)o(hanges)f(when)h(mo)o(v)o(ed)249
1317 y(from)f(one)i(system)f(to)g(another.)24 b(This)15
b(explicitly)g(do)q(es)h FB(not)k FA(sa)o(y)15 b(an)o(ything)g(ab)q
(out)g(ho)o(w)h(an)249 1371 y Fw(MPI)i FA(program)f(is)h(started)h(or)g
(launc)o(hed)g(from)d(the)j(command)d(line,)j(nor)f(what)g(the)h(user)
249 1425 y(m)o(ust)11 b(do)h(to)g(set)h(up)f(the)h(en)o(vironmen)o(t)e
(in)h(whic)o(h)g(an)g Fw(MPI)f FA(program)g(will)f(run.)18
b(Ho)o(w)o(ev)o(er,)13 b(an)249 1479 y(implemen)o(tation)c(ma)o(y)h
(require)j(some)e(setup)i(to)f(b)q(e)h(p)q(erformed)f(b)q(efore)h
(other)f Fw(MPI)g FA(routines)249 1533 y(ma)o(y)e(b)q(e)i(called.)18
b(T)m(o)11 b(pro)o(vide)g(for)h(this,)g Fw(MPI)f FA(includes)h(an)g
(initialization)d(routine)j Fw(MPI)p 1639 1533 V 14 w(INIT)p
FA(.)249 1657 y Fw(MPI)p 326 1657 V 14 w(INIT\(\))249
1747 y Fr(int)21 b(MPI)p 405 1747 14 2 v 15 w(Init\(int)f(*argc,)h
(char)g(***argv\))249 1831 y(MPI)p 318 1831 V 15 w(INIT\(IERROR\))336
1885 y(INTEGER)g(IERROR)291 1969 y FA(This)15 b(routine)g(m)o(ust)f(b)q
(e)i(called)f(b)q(efore)h(an)o(y)e(other)i Fw(MPI)f FA(routine.)22
b(It)15 b(m)o(ust)f(b)q(e)i(called)f(at)249 2023 y(most)e(once;)h
(subsequen)o(t)h(calls)f(are)g(erroneous)i(\(see)f Fw(MPI)p
1179 2023 13 2 v 14 w(INITIALIZED)p FA(\).)291 2077 y(All)f
Fw(MPI)h FA(programs)f(m)o(ust)h(con)o(tain)g(a)g(call)g(to)g
Fw(MPI)p 1130 2077 V 14 w(INIT)p FA(;)g(this)g(routine)h(m)o(ust)f(b)q
(e)h(called)249 2131 y(b)q(efore)d(an)o(y)f(other)h Fw(MPI)f
FA(routine)h(\(apart)f(from)f Fw(MPI)p 1084 2131 V 14
w(INITIALIZED)p FA(\))h(is)g(called.)17 b(The)c(v)o(ersion)249
2185 y(for)h(ANSI)g(C)g(accepts)h(the)g Fq(a)o(rgc)f
FA(and)g Fq(a)o(rgv)g FA(that)g(are)g(pro)o(vided)g(b)o(y)g(the)g
(argumen)o(ts)f(to)h Fr(main)p FA(:)249 2272 y Fr(int)21
b(main\(argc,)f(argv\))249 2326 y(int)h(argc;)249 2380
y(char)g(**argv;)249 2434 y({)336 2488 y(MPI_Init\(&argc,)e(&argv\);)p
eop
%%Page: 292 306
292 305 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(292)1256 b(Chapter)13 b(7)336
561 y Fr(/*)22 b(parse)e(arguments)g(*/)336 615 y(/*)i(main)f(program)
85 b(*/)336 723 y(MPI_Finalize\(\);)106 b(/*)21 b(see)h(below)e(*/)249
777 y(})291 864 y FA(The)14 b(F)m(ortran)g(v)o(ersion)g(tak)o(es)g
(only)f Fq(IERROR)p FA(.)291 918 y(An)j Fw(MPI)f FA(implem)o(en)o
(tation)e(is)j(free)g(to)g(require)h(that)e(the)i(argumen)o(ts)e(in)g
(the)i(C)e(binding)249 972 y(m)o(ust)e(b)q(e)h(the)h(argumen)o(ts)e(to)
h Fr(main)p FA(.)249 1064 y FB(R)n(ationale.)36 b FA(The)12
b(command)e(line)h(argumen)o(ts)g(are)i(pro)o(vided)f
FB(to)g Fw(MPI)p 1377 1064 13 2 v 14 w(Init)g FA(to)g(allo)o(w)e(an)i
Fw(MPI)249 1117 y FA(implemen)o(tation)f(to)j(use)h(them)f(in)g
(initializing)e(the)j Fw(MPI)e FA(en)o(vironmen)o(t.)19
b(They)c(are)f(passed)249 1171 y(b)o(y)c(reference)i(to)e(allo)o(w)e
(an)i Fw(MPI)f FA(implemen)o(tati)o(on)e(to)j FB(pr)n(ovide)g
FA(them)f(in)g(en)o(vironmen)o(ts)g(where)249 1225 y(the)15
b(command-l)o(ine)c(argumen)o(ts)i(are)i(not)e(pro)o(vided)h(to)g
Fr(main)p FA(.)j(\()p FB(End)f(of)e(r)n(ationale.)p FA(\))249
1388 y Fw(MPI)p 326 1388 V 14 w(FINALIZE\(\))249 1477
y Fr(int)21 b(MPI)p 405 1477 14 2 v 15 w(Finalize\(void\))249
1561 y(MPI)p 318 1561 V 15 w(FINALIZE\(IERROR\))336 1615
y(INTEGER)g(IERROR)291 1699 y FA(This)12 b(routines)g(cleans)h(up)f
(all)f Fw(MPI)g FA(state.)19 b(Once)13 b(this)f(routine)g(is)g(called,)
g(no)g Fw(MPI)f FA(routine)249 1753 y(\(ev)o(en)16 b
Fw(MPI)p 438 1753 13 2 v 14 w(INIT)p FA(\))f(ma)o(y)e(b)q(e)i(called.)
21 b(The)15 b(user)h(m)o(ust)e(ensure)i(that)f(all)f(p)q(ending)h(comm)
o(uni-)249 1807 y(cations)f(in)o(v)o(olving)e(a)h(pro)q(cess)j
(complete)d(b)q(efore)i(the)f(pro)q(cess)i(calls)d Fw(MPI)p
1432 1807 V 15 w(FINALIZE)p FA(.)249 1932 y Fw(MPI)p
326 1932 V 14 w(INITIALIZED\()g(\015ag)h(\))332 2006
y Fv(OUT)114 b Fw(\015ag)483 b Fv(F)p FA(lag)9 b(is)g(true)h(if)e
Fw(MPI)p 1397 2006 V 15 w(INIT)h FA(has)g(b)q(een)h(called)1079
2060 y(and)k(false)g(otherwise.)249 2170 y Fr(int)21
b(MPI)p 405 2170 14 2 v 15 w(Initialized\(int)e(*flag\))249
2254 y(MPI)p 318 2254 V 15 w(INITIALIZED\(FLAG,)f(IERROR\))336
2308 y(LOGICAL)j(FLAG)336 2362 y(INTEGER)g(IERROR)291
2446 y FA(This)14 b(routine)g(ma)o(y)f(b)q(e)i(used)g(to)f(determine)h
(whether)g Fw(MPI)p 1254 2446 13 2 v 15 w(INIT)f FA(has)g(b)q(een)i
(called.)j(It)c(is)249 2500 y(the)g FB(only)f FA(routine)g(that)g(ma)o
(y)e(b)q(e)i(called)g(b)q(efore)g Fw(MPI)p 1108 2500
V 15 w(INIT)f FA(is)h(called.)p eop
%%Page: 293 307
293 306 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(En)o(vironmen)o(tal)16 b(Managemen)o(t)963
b(293)249 507 y Fw(MPI)p 326 507 13 2 v 14 w(ABORT\()13
b(comm,)f(erro)o(rco)q(de)k(\))332 582 y Fv(IN)158 b
Fw(comm)439 b Fv(comm)o(unicator)15 b(of)e(tasks)g(to)g(ab)q(ort)332
632 y(IN)158 b Fw(erro)o(rco)q(de)387 b Fv(error)10 b(co)q(de)g(to)g
(return)g(to)g(in)o(v)o(oking)i(en)o(viron-)1079 686
y(men)o(t)249 796 y Fr(int)21 b(MPI)p 405 796 14 2 v
15 w(Abort\(MPI)p 618 796 V 14 w(Comm)g(comm,)g(int)g(errorcode\))249
880 y(MPI)p 318 880 V 15 w(ABORT\(COMM,)f(ERRORCODE,)f(IERROR\))336
934 y(INTEGER)i(COMM,)f(ERRORCODE,)g(IERROR)291 1018
y FA(This)c(routine)h(mak)o(es)e(a)i(\\b)q(est)g(attempt")f(to)h(ab)q
(ort)f(all)g(tasks)h(in)f(the)h(group)g(of)f Fw(comm)p
FA(.)249 1072 y(This)d(function)g(do)q(es)h(not)f(require)g(that)h(the)
f(in)o(v)o(oking)e(en)o(vironmen)o(t)h(tak)o(e)h(an)o(y)g(action)g
(with)249 1126 y(the)k(error)h(co)q(de.)27 b(Ho)o(w)o(ev)o(er,)18
b(a)e(Unix)g(or)h(POSIX)g(en)o(vironmen)o(t)f(should)h(handle)f(this)h
(as)g(a)249 1180 y Fr(return)k(errorcode)12 b FA(from)g(the)i(main)e
(program)g(or)i(an)g Fr(abort\(errorcode\))o FA(.)291
1234 y Fw(MPI)d FA(implemen)o(tations)e(are)k(required)g(to)f(de\014ne)
i(the)f(b)q(eha)o(vior)f(of)g Fw(MPI)p 1446 1234 13 2
v 14 w(ABORT)f FA(at)h(least)249 1288 y(for)j(a)f Fr(comm)g
FA(of)h Fq(MPI)p 572 1288 12 2 v 13 w(COMM)p 706 1288
V 12 w(W)o(ORLD)p FA(.)g Fw(MPI)f FA(implemen)o(tations)e(ma)o(y)h
(ignore)i(the)h Fw(comm)d FA(ar-)249 1342 y(gumen)o(t)g(and)h(act)g(as)
g(if)f(the)h Fr(comm)f FA(w)o(as)h Fq(MPI)p 961 1342
V 13 w(COMM)p 1095 1342 V 13 w(W)o(ORLD)p FA(.)249 1433
y FB(A)n(dvic)n(e)h(to)h(users.)41 b FA(The)15 b(b)q(eha)o(vior)f(of)g
Fw(MPI)p 961 1433 13 2 v 14 w(ABORT\(comm,)e(erro)o(rco)q(de\))p
FA(,)k(for)e Fw(comm)f FA(other)249 1487 y(then)g Fq(MPI)p
414 1487 12 2 v 13 w(COMM)p 548 1487 V 12 w(W)o(ORLD)p
FA(,)f(is)g(implemen)o(tation-dep)q(enden)o(t.)k(One)d(the)g(other)f
(hand,)g(a)g(call)249 1541 y(to)i Fw(MPI)p 377 1541 13
2 v 14 w(ABORT\(MPI)p 624 1541 V 14 w(COMM)p 768 1541
V 14 w(W)o(ORLD,)g(erro)o(rco)q(de\))h FA(should)f(alw)o(a)o(ys)f
(cause)i(all)e(pro)q(cesses)249 1595 y(in)g(the)i(group)f(of)f
Fq(MPI)p 606 1595 12 2 v 13 w(COMM)p 740 1595 V 12 w(W)o(ORLD)i
FA(to)e(ab)q(ort.)18 b(\()p FB(End)e(of)f(advic)n(e)g(to)g(users.)p
FA(\))249 1715 y FD(7.4)52 b(Error)17 b(Handling)249
1823 y Fw(MPI)11 b FA(pro)o(vides)h(the)g(user)h(with)e(reliable)g
(message)g(transmission.)17 b(A)11 b(message)h(sen)o(t)g(is)f(alw)o(a)o
(ys)249 1877 y(receiv)o(ed)h(correctly)m(,)g(and)e(the)h(user)h(do)q
(es)g(not)e(need)i(to)e(c)o(hec)o(k)i(for)e(transmission)g(errors,)i
(time-)249 1931 y(outs,)i(or)h(other)g(error)g(conditions.)k(In)14
b(other)h(w)o(ords,)f Fw(MPI)g FA(do)q(es)h(not)f(pro)o(vide)g(mec)o
(hanisms)249 1985 y(for)c(dealing)g(with)g(failures)g(in)f(the)i(comm)o
(unication)c(system.)17 b(If)10 b(the)h Fw(MPI)f FA(implem)o(en)o
(tation)e(is)249 2039 y(built)13 b(on)f(an)h(unreliable)g(underlying)g
(mec)o(hanism,)e(then)j(it)e(is)h(the)h(job)f(of)f(the)i(implemen)o
(tor)249 2093 y(of)20 b(the)h Fw(MPI)f FA(subsystem)h(to)g(insulate)f
(the)i(user)f(from)e(this)i(unreliabilit)o(y)m(,)f(or)g(to)h(re\015ect)
249 2147 y(unreco)o(v)o(erable)15 b(errors)g(as)f(exceptions.)291
2201 y(Of)d(course,)i(errors)g(can)f(o)q(ccur)h(during)e
Fw(MPI)g FA(calls)g(for)g(a)h(v)n(ariet)o(y)f(of)g(reasons.)18
b(A)12 b Fs(program)249 2255 y(error)i FA(can)i(o)q(ccur)h(when)f(an)g
Fw(MPI)f FA(routine)g(is)h(called)f(with)h(an)f(incorrect)i(argumen)o
(t)e(\(non-)249 2309 y(existing)10 b(destination)g(in)g(a)g(send)h(op)q
(eration,)f(bu\013er)h(to)q(o)f(small)e(in)i(a)g(receiv)o(e)h(op)q
(eration,)g(etc.\))249 2363 y(This)17 b(t)o(yp)q(e)h(of)f(error)h(w)o
(ould)f(o)q(ccur)h(in)f(an)o(y)g(implemen)o(tatio)o(n.)26
b(In)17 b(addition,)g(a)g Fs(resource)249 2417 y(error)10
b FA(ma)o(y)g(o)q(ccur)j(when)f(a)f(program)f(exceeds)k(the)e(amoun)o
(t)e(of)h(a)o(v)n(ailable)f(system)h(resources)249 2471
y(\(n)o(um)o(b)q(er)i(of)f(p)q(ending)h(messages,)g(system)g
(bu\013ers,)i(etc.\).)j(The)c(o)q(ccurrence)i(of)c(this)h(t)o(yp)q(e)h
(of)p eop
%%Page: 294 308
294 307 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(294)1256 b(Chapter)13 b(7)249
507 y FA(error)i(dep)q(ends)g(on)f(the)g(amoun)o(t)e(of)h(a)o(v)n
(ailable)e(resources)16 b(in)e(the)g(system)g(and)f(the)h(resource)249
561 y(allo)q(cation)f(mec)o(hanism)e(used;)k(this)f(ma)o(y)e(di\013er)j
(from)d(system)i(to)g(system.)k(A)d(high-qualit)o(y)249
615 y(implemen)o(tation)f(will)j(pro)o(vide)g(generous)i(limits)d(on)h
(the)i(imp)q(ortan)o(t)d(resources)k(so)e(as)g(to)249
669 y(alleviate)13 b(the)h(p)q(ortabilit)o(y)f(problem)g(this)g
(represen)o(ts.)291 723 y(An)k Fw(MPI)f FA(implem)o(en)o(tation)e
(cannot)j(or)g(ma)o(y)e(c)o(ho)q(ose)i(not)g(to)g(handle)f(some)g
(errors)i(that)249 777 y(o)q(ccur)c(during)e Fw(MPI)f
FA(calls.)18 b(These)13 b(can)g(include)f(errors)i(that)f(generate)g
(exceptions)h(or)e(traps,)249 831 y(suc)o(h)17 b(as)f(\015oating)e(p)q
(oin)o(t)i(errors)h(or)f(access)h(violations;)e(errors)i(that)f(are)g
(to)q(o)g(exp)q(ensiv)o(e)h(to)249 885 y(detect)e(in)e(normal)e
(execution)j(mo)q(de;)e(or)h(\\catastrophic")h(errors)g(whic)o(h)f(ma)o
(y)f(prev)o(en)o(t)i Fw(MPI)249 939 y FA(from)e(returning)j(con)o(trol)
e(to)h(the)g(caller)g(in)g(a)f(consisten)o(t)i(state.)291
993 y(Another)i(subtle)g(issue)h(arises)f(b)q(ecause)i(of)d(the)h
(nature)h(of)e(async)o(hronous)i(comm)o(uni)o(ca-)249
1047 y(tions.)g Fw(MPI)12 b FA(can)i(only)f(handle)g(errors)h(that)g
(can)f(b)q(e)h(attac)o(hed)g(to)f(a)h(sp)q(eci\014c)g
Fw(MPI)f FA(call.)k Fw(MPI)249 1101 y FA(calls)d(\(b)q(oth)h(blo)q(c)o
(king)f(and)h(non)o(blo)q(c)o(king\))e(ma)o(y)g(initiate)h(op)q
(erations)h(that)g(con)o(tin)o(ue)g(asyn-)249 1155 y(c)o(hronously)i
(after)g(the)h(call)e(returned.)29 b(Th)o(us,)17 b(the)h(call)e(ma)o(y)
f(complete)h(successfully)m(,)i(y)o(et)249 1209 y(the)c(op)q(eration)f
(ma)o(y)f(later)h(cause)h(an)g(error.)k(If)13 b(there)i(is)e(a)g
(subsequen)o(t)i(call)e(that)g(relates)i(to)249 1263
y(the)h(same)f(op)q(eration)g(\(e.g.,)g(a)h(w)o(ait)e(or)i(test)g(call)
f(that)h(completes)f(a)g(non)o(blo)q(c)o(king)g(call,)f(or)249
1317 y(a)i(receiv)o(e)i(that)f(completes)f(a)g(comm)o(unication)d
(initiated)j(b)o(y)g(a)h(blo)q(c)o(king)e(send\))j(then)f(the)249
1371 y(error)e(can)g(b)q(e)f(asso)q(ciated)h(with)f(this)h(call.)j(In)c
(some)f(cases,)j(the)e(error)i(ma)o(y)c(o)q(ccur)j(after)g(all)249
1425 y(calls)h(that)h(relate)g(to)f(the)h(op)q(eration)f(ha)o(v)o(e)g
(completed.)26 b(\(Consider)17 b(the)g(case)g(of)f(a)g(blo)q(c)o(k-)249
1479 y(ing)f(ready)h(mo)q(de)e(send)j(op)q(eration,)e(where)h(the)g
(outgoing)f(message)g(is)g(bu\013ered,)i(and)e(it)h(is)249
1533 y(subsequen)o(tly)i(found)f(that)h(no)f(matc)o(hing)e(receiv)o(e)j
(is)g(p)q(osted.\))29 b(Suc)o(h)17 b(errors)i(will)d(not)h(b)q(e)249
1587 y(handled)d(b)o(y)g Fw(MPI)p FA(.)291 1641 y(The)22
b(set)h(of)f(errors)h(in)f Fw(MPI)g FA(calls)g(that)g(are)g(handled)h
(b)o(y)f Fw(MPI)f FA(is)h(implemen)o(tation-)249 1694
y(dep)q(enden)o(t.)29 b(Eac)o(h)17 b(suc)o(h)h(error)g(generates)g(an)f
Fw(MPI)i Fs(exception)p FA(.)52 b(A)17 b(go)q(o)q(d)g(qualit)o(y)f(im-)
249 1748 y(plemen)o(tation)c(will)g(attempt)g(to)i(handle)f(as)g(man)o
(y)f(errors)i(as)g(p)q(ossible)g(as)f Fw(MPI)g FA(exceptions.)249
1802 y(Errors)j(that)e(are)h(not)g(handled)f(b)o(y)h
Fw(MPI)e FA(will)h(b)q(e)h(handled)f(b)o(y)h(the)g(error)g(handling)e
(mec)o(ha-)249 1856 y(nisms)g(of)g(the)h(language)f(run-time)g(or)h
(the)g(op)q(erating)g(system.)k(T)o(ypically)m(,)11 b(errors)k(that)f
(are)249 1910 y(not)g(handled)g(b)o(y)f Fw(MPI)h FA(will)e(cause)j(the)
f(parallel)f(program)f(to)i(ab)q(ort.)291 1964 y(The)g(o)q(ccurrence)j
(of)c(an)g Fw(MPI)h FA(exception)g(has)g(t)o(w)o(o)g(e\013ects:)208
2047 y Ft(\017)20 b FA(An)14 b Fw(MPI)f Fs(error)i(handler)c
FA(will)i(b)q(e)h(in)o(v)o(ok)o(ed.)208 2118 y Ft(\017)20
b FA(If)c(the)i(error)f(handler)g(did)f(not)h(cause)g(the)h(pro)q(cess)
g(to)f(halt,)f(then)h(a)g(suitable)f(error)i(co)q(de)249
2172 y(will)12 b(b)q(e)j(returned)h(b)o(y)d(the)i Fw(MPI)e
FA(call.)291 2255 y(Some)i Fw(MPI)h FA(calls)h(ma)o(y)e(cause)j(more)d
(than)i(one)g Fw(MPI)f FA(exception)i(\(see)g(Section)f(2.9\).)26
b(In)249 2309 y(suc)o(h)18 b(a)g(case,)h(the)f Fw(MPI)f
FA(error)h(handler)g(will)e(b)q(e)i(in)o(v)o(ok)o(ed)f(once)h(for)g
(eac)o(h)g(exception,)h(and)249 2363 y(m)o(ultiple)12
b(error)i(co)q(des)i(will)c(b)q(e)i(returned.)291 2417
y(After)e(an)g(error)h(is)g(detected,)h(the)f(state)g(of)e
Fw(MPI)h FA(is)g(unde\014ned.)18 b(That)12 b(is,)g(the)h(state)g(of)f
(the)249 2471 y(computation)e(after)i(the)h(error-handler)g(executed)h
(do)q(es)e FB(not)17 b FA(necessarily)c(allo)o(w)d(the)j(user)g(to)p
eop
%%Page: 295 309
295 308 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(En)o(vironmen)o(tal)16 b(Managemen)o(t)963
b(295)249 507 y FA(con)o(tin)o(ue)13 b(to)g(use)h Fw(MPI)p
FA(.)d(The)j(purp)q(ose)g(of)e(these)i(error)g(handlers)g(is)e(to)h
(allo)o(w)e(a)i(user)h(to)f(issue)249 561 y(user-de\014ned)j(error)f
(messages)e(and)h(to)f(tak)o(e)h(actions)g(unrelated)g(to)g
Fw(MPI)f FA(\(suc)o(h)i(as)f(\015ushing)249 615 y(I/O)h(bu\013ers\))h
(b)q(efore)g(a)f(program)e(exits.)21 b(An)15 b Fw(MPI)f
FA(implemen)o(tation)e(is)i(free)i(to)f(allo)o(w)e Fw(MPI)249
669 y FA(to)h(con)o(tin)o(ue)g(after)g(an)g(error)g(but)h(is)e(not)h
(required)h(to)f(do)f(so.)249 757 y FB(A)n(dvic)n(e)20
b(to)f(implementors.)69 b FA(A)19 b(go)q(o)q(d)g(qualit)o(y)f(implemen)
o(tatio)o(n)f(will,)h(to)h(the)h(greatest)249 811 y(p)q(ossible)13
b(exten)o(t,)g(circumscrib)q(e)h(the)f(impact)e(of)h(an)h(error,)g(so)g
(that)g(normal)d(pro)q(cessing)k(can)249 865 y(con)o(tin)o(ue)i(after)g
(an)g(error)h(handler)f(w)o(as)g(in)o(v)o(ok)o(ed.)23
b(The)16 b(implemen)o(tation)d(do)q(cumen)o(tation)249
919 y(will)d(pro)o(vide)h(information)d(on)j(the)h(p)q(ossible)g
(e\013ect)h(of)e(eac)o(h)g(class)h(of)f(errors.)18 b(\()p
FB(End)c(of)e(advic)n(e)249 973 y(to)j(implementors.)p
FA(\))249 1061 y Fs(7.4.1)48 b(Error)15 b(Handlers)249
1144 y FA(A)20 b(user)h(can)f(asso)q(ciate)h(an)e(error)i(handler)f
(with)g(a)f(comm)o(unicator.)33 b(The)21 b(sp)q(eci\014ed)g(er-)249
1198 y(ror)16 b(handling)e(routine)i(will)d(b)q(e)j(used)h(for)e(an)o
(y)g Fw(MPI)f FA(exception)j(that)e(o)q(ccurs)i(during)e(a)g(call)249
1252 y(to)i Fw(MPI)f FA(for)g(a)h(comm)o(uni)o(cation)d(with)i(this)h
(comm)o(unicator.)24 b Fw(MPI)16 b FA(calls)g(that)h(are)g(not)g(re-)
249 1306 y(lated)i(to)h(an)o(y)f(comm)o(unicator)d(are)k(considered)h
(to)f(b)q(e)g(attac)o(hed)g(to)f(the)h(comm)o(unicator)249
1360 y Fq(MPI)p 321 1360 12 2 v 13 w(COMM)p 455 1360
V 13 w(W)o(ORLD)p FA(.)13 b(The)i(attac)o(hmen)o(t)e(of)g(error)i
(handlers)g(to)f(comm)o(unicators)d(is)j(purely)249 1414
y(lo)q(cal:)j(di\013eren)o(t)e(pro)q(cesses)h(ma)o(y)c(attac)o(h)i
(di\013eren)o(t)h(error)g(handlers)f(to)f(comm)o(unicators)f(for)249
1468 y(the)j(same)e(comm)o(uni)o(cation)e(domain.)291
1522 y(A)i(newly)f(created)j(comm)o(unicator)10 b(inherits)j(the)h
(error)f(handler)g(that)g(is)g(asso)q(ciated)h(with)249
1576 y(the)k(\\paren)o(t")g(comm)o(unicator.)26 b(In)18
b(particular,)g(the)g(user)h(can)f(sp)q(ecify)g(a)f(\\global")e(error)
249 1630 y(handler)g(for)g(all)f(comm)o(unicators)f(b)o(y)i(asso)q
(ciating)f(this)h(handler)h(with)e(the)i(comm)o(unicator)249
1684 y Fq(MPI)p 321 1684 V 13 w(COMM)p 455 1684 V 13
w(W)o(ORLD)e FA(imm)o(ediately)d(after)j(initialization.)291
1738 y(Sev)o(eral)g(prede\014ned)h(error)g(handlers)g(are)f(a)o(v)n
(ailable)e(in)h Fw(MPI)p FA(:)249 1821 y Fq(MPI)p 321
1821 V 13 w(ERRORS)p 481 1821 V 14 w(ARE)p 569 1821 V
13 w(F)m(A)m(T)m(AL)20 b FA(The)11 b(handler,)h(when)f(called,)g
(causes)i(the)e(program)f(to)h(ab)q(ort)g(on)249 1875
y(all)e(executing)j(pro)q(cesses.)19 b(This)11 b(has)f(the)i(same)d
(e\013ect)k(as)d(if)g Fw(MPI)p 1277 1875 13 2 v 14 w(ABORT)g
FA(w)o(as)g(called)g(b)o(y)h(the)249 1929 y(pro)q(cess)g(that)e(in)o(v)
o(ok)o(ed)g(the)h(handler)f(\(with)g(comm)o(unicator)e(argumen)o(t)h
Fq(MPI)p 1459 1929 12 2 v 13 w(COMM)p 1593 1929 V 12
w(W)o(ORLD)p FA(\).)249 1993 y Fq(MPI)p 321 1993 V 13
w(ERRORS)p 481 1993 V 14 w(RETURN)21 b FA(The)e(handler)f(has)g(no)g
(e\013ect)i(\(other)e(than)g(returning)h(the)f(error)249
2047 y(co)q(de)d(to)f(the)g(user\).)291 2130 y(Implemen)o(tatio)o(ns)c
(ma)o(y)g(pro)o(vide)j(additional)d(prede\014ned)k(error)f(handlers)g
(and)f(program-)249 2184 y(mers)i(can)g(co)q(de)g(their)h(o)o(wn)e
(error)i(handlers.)291 2238 y(The)k(error)h(handler)f
Fq(MPI)p 715 2238 V 13 w(ERRORS)p 875 2238 V 14 w(ARE)p
963 2238 V 14 w(F)m(A)m(T)m(AL)f FA(is)h(asso)q(ciated)g(b)o(y)g
(default)g(with)g Fq(MPI-)p 249 2292 V 261 2292 a(COMM)p
384 2292 V 12 w(W)o(ORLD)d FA(after)h(initialization.)k(Th)o(us,)16
b(if)f(the)i(user)g(c)o(ho)q(oses)g(not)f(to)g(con)o(trol)f(error)249
2346 y(handling,)f(ev)o(ery)i(error)g(that)f Fw(MPI)f
FA(handles)h(is)g(treated)i(as)e(fatal.)20 b(Since)c(\(almost\))d(all)h
Fw(MPI)249 2400 y FA(calls)9 b(return)i(an)e(error)i(co)q(de,)g(a)e
(user)i(ma)o(y)d(c)o(ho)q(ose)i(to)f(handle)h(errors)h(in)e(his)h(or)f
(her)i(main)c(co)q(de,)249 2454 y(b)o(y)k(testing)h(the)h(return)g(co)q
(de)f(of)f Fw(MPI)g FA(calls)g(and)h(executing)g(a)f(suitable)h(reco)o
(v)o(ery)g(co)q(de)h(when)249 2508 y(the)k(call)f(w)o(as)h(not)f
(successful.)28 b(In)17 b(this)g(case,)g(the)h(error)f(handler)g
Fq(MPI)p 1419 2508 V 13 w(ERRORS)p 1579 2508 V 14 w(RETURN)p
eop
%%Page: 296 310
296 309 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(296)1256 b(Chapter)13 b(7)249
507 y FA(will)f(b)q(e)i(used.)19 b(Usually)13 b(it)g(is)g(more)g(con)o
(v)o(enien)o(t)h(and)f(more)g(e\016cien)o(t)h(not)f(to)g(test)i(for)e
(errors)249 561 y(after)19 b(eac)o(h)g Fw(MPI)f FA(call,)h(and)f(ha)o
(v)o(e)h(suc)o(h)g(an)g(error)g(handled)g(b)o(y)f(a)h(non-trivial)e
Fw(MPI)g FA(error)249 615 y(handler.)291 669 y(An)e Fw(MPI)g
FA(error)h(handler)g(is)f(an)g(opaque)h(ob)r(ject,)g(whic)o(h)f(is)g
(accessed)j(b)o(y)d(a)h(handle.)22 b Fw(MPI)249 723 y
FA(calls)c(are)g(pro)o(vided)g(to)g(create)h(new)f(error)h(handlers,)g
(to)f(asso)q(ciate)g(error)h(handlers)g(with)249 777
y(comm)o(unicators,)9 b(and)j(to)f(test)i(whic)o(h)e(error)i(handler)e
(is)h(asso)q(ciated)g(with)f(a)h(comm)o(unicator.)249
902 y Fw(MPI)p 326 902 13 2 v 14 w(ERRHANDLER)p 609 902
V 15 w(CREA)m(TE\(function,)h(errhandler\))332 977 y
Fv(IN)158 b Fw(function)406 b Fv(user)14 b(de\014ned)g(error)f
(handling)j(pro)q(cedure)332 1026 y(OUT)114 b Fw(errhandler)375
b Fv(MPI)13 b(error)g(handler)249 1137 y Fr(int)21 b(MPI)p
405 1137 14 2 v 15 w(Errhandler)p 640 1137 V 14 w(create\(MPI)p
874 1137 V 14 w(Handler)p 1042 1137 V 14 w(function)f(*function,)540
1191 y(MPI)p 609 1191 V 15 w(Errhandler)f(*errhandler\))249
1275 y(MPI)p 318 1275 V 15 w(ERRHANDLER)p 553 1275 V
14 w(CREATE\(FUNCTION,)f(HANDLER,)i(IERROR\))336 1329
y(EXTERNAL)g(FUNCTION)336 1382 y(INTEGER)h(ERRHANDLER,)e(IERROR)291
1466 y FA(Register)14 b(the)h(user)h(routine)e Fw(function)h
FA(for)f(use)h(as)g(an)f Fw(MPI)f FA(exception)i(handler.)20
b(Returns)249 1520 y(in)13 b Fw(errhandler)k FA(a)d(handle)f(to)h(the)h
(registered)g(exception)g(handler.)291 1574 y(In)f(the)h(C)g(language,)
e(the)i(user)h(routine)e(should)h(b)q(e)g(a)f(C)g(function)g(of)g(t)o
(yp)q(e)h Fq(MPI)p 1595 1574 12 2 v 13 w(Handler-)p 249
1628 V 261 1628 a(function)p FA(,)c(whic)o(h)j(is)g(de\014ned)h(as:)249
1724 y Fr(typedef)20 b(void)h(\(MPI_Handler_functi)o(on\)\(M)o(PI_Co)o
(mm)e(*,)i(int)g(*,)h(...\);)249 1819 y FA(The)c(\014rst)f(argumen)o(t)
f(is)h(the)h(comm)o(unicator)c(in)i(use.)29 b(The)17
b(second)h(is)f(the)h(error)g(co)q(de)g(to)249 1873 y(b)q(e)g(returned)
g(b)o(y)f(the)h Fw(MPI)e FA(routine)h(that)g(raised)h(the)g(error.)28
b(If)17 b(the)g(routine)g(w)o(ould)g(ha)o(v)o(e)249 1927
y(returned)f(m)o(ultiple)11 b(error)k(co)q(des)g(\(see)g(Section)f
(2.9\),)f(it)g(is)h(the)g(error)h(co)q(de)g(returned)g(in)f(the)249
1981 y(status)c(for)f(the)h(request)h(that)f(caused)g(the)g(error)h
(handler)e(to)h(b)q(e)g(in)o(v)o(ok)o(ed.)15 b(The)10
b(remaining)e(ar-)249 2035 y(gumen)o(ts)k(are)i(\\)p
Fr(stdargs)p FA(")d(argumen)o(ts)h(whose)h(n)o(um)o(b)q(er)f(and)h
(meaning)e(is)i(implemen)o(tation-)249 2089 y(dep)q(enden)o(t.)36
b(An)19 b(implemen)o(tation)d(should)j(clearly)g(do)q(cumen)o(t)g
(these)i(argumen)o(ts.)33 b(Ad-)249 2143 y(dresses)16
b(are)f(used)f(so)g(that)g(the)h(handler)f(ma)o(y)e(b)q(e)i(written)h
(in)e(F)m(ortran.)249 2234 y FB(R)n(ationale.)50 b FA(The)16
b(v)n(ariable)f(argumen)o(t)g(list)g(is)h(pro)o(vided)g(b)q(ecause)i
(it)d(pro)o(vides)i(an)e(ANSI-)249 2288 y(standard)i(ho)q(ok)e(for)h
(pro)o(viding)f(additional)g(information)e(to)j(the)h(error)g(handler;)
g(without)249 2342 y(this)d(ho)q(ok,)f(ANSI)h(C)g(prohibits)g
(additional)e(argumen)o(ts.)17 b(\()p FB(End)f(of)e(r)n(ationale.)p
FA(\))p eop
%%Page: 297 311
297 310 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(En)o(vironmen)o(tal)16 b(Managemen)o(t)963
b(297)249 507 y Fw(MPI)p 326 507 13 2 v 14 w(ERRHANDLER)p
609 507 V 15 w(SET\(comm,)12 b(errhandler\))332 582 y
Fv(IN)158 b Fw(comm)439 b Fv(comm)o(unicator)19 b(to)e(set)g(the)g
(error)h(handler)1079 636 y(for)332 686 y(IN)158 b Fw(errhandler)375
b Fv(new)14 b(MPI)g(error)g(handler)h(for)f(comm)o(unica-)1079
740 y(tor)249 850 y Fr(int)21 b(MPI)p 405 850 14 2 v
15 w(Errhandler)p 640 850 V 14 w(set\(MPI)p 808 850 V
14 w(Comm)g(comm,)g(MPI)p 1128 850 V 15 w(Errhandler)f(errhandler\))249
934 y(MPI)p 318 934 V 15 w(ERRHANDLER)p 553 934 V 14
w(SET\(COMM,)g(ERRHANDLER,)f(IERROR\))336 988 y(INTEGER)i(COMM,)f
(ERRHANDLER,)g(IERROR)291 1072 y FA(Asso)q(ciates)e(the)f(new)g(error)h
(handler)f Fw(erro)o(rhandler)i FA(with)d(comm)o(unicator)e
Fw(comm)h FA(at)i(the)249 1126 y(calling)d(pro)q(cess.)24
b(Note)16 b(that)f(an)g(error)i(handler)e(is)g(alw)o(a)o(ys)f(asso)q
(ciated)i(with)f(the)h(comm)o(u-)249 1180 y(nicator.)249
1305 y Fw(MPI)p 326 1305 13 2 v 14 w(ERRHANDLER)p 609
1305 V 15 w(GET\(comm,)c(errhandler\))332 1379 y Fv(IN)158
b Fw(comm)439 b Fv(comm)o(unicator)18 b(to)e(get)h(the)f(error)h
(handler)1079 1433 y(from)332 1483 y(OUT)114 b Fw(errhandler)375
b Fv(MPI)15 b(error)h(handler)h(curren)o(tly)f(asso)q(ciated)1079
1537 y(with)e(comm)o(unicator)249 1647 y Fr(int)21 b(MPI)p
405 1647 14 2 v 15 w(Errhandler)p 640 1647 V 14 w(get\(MPI)p
808 1647 V 14 w(Comm)g(comm,)g(MPI)p 1128 1647 V 15 w(Errhandler)f
(*errhandler\))249 1731 y(MPI)p 318 1731 V 15 w(ERRHANDLER)p
553 1731 V 14 w(GET\(COMM,)g(ERRHANDLER,)f(IERROR\))336
1785 y(INTEGER)i(COMM,)f(ERRHANDLER,)g(IERROR)291 1869
y FA(Returns)14 b(in)e Fw(errhandler)k FA(\(a)d(handle)g(to\))g(the)h
(error)g(handler)f(that)h(is)f(curren)o(tly)h(asso)q(ciated)249
1923 y(with)g(comm)o(unicator)d Fw(comm)p FA(.)291 1977
y(Example:)24 b(A)19 b(library)e(function)h(ma)o(y)e(register)j(at)f
(its)g(en)o(try)h(p)q(oin)o(t)e(the)i(curren)o(t)g(error)249
2031 y(handler)10 b(for)f(a)g(comm)o(unicator,)f(set)i(its)g(o)o(wn)f
(priv)n(ate)g(error)i(handler)f(for)f(this)h(comm)o(unicator,)249
2085 y(and)k(restore)h(b)q(efore)g(exiting)e(the)i(previous)f(error)h
(handler.)249 2210 y Fw(MPI)p 326 2210 13 2 v 14 w(ERRHANDLER)p
609 2210 V 15 w(FREE\(errhandler\))332 2284 y Fv(IN)158
b Fw(errhandler)375 b Fv(MPI)13 b(error)g(handler)249
2395 y Fr(int)21 b(MPI)p 405 2395 14 2 v 15 w(Errhandler)p
640 2395 V 14 w(free\(MPI)p 830 2395 V 14 w(Errhandler)f(*errhandler\))
249 2479 y(MPI)p 318 2479 V 15 w(ERRHANDLER)p 553 2479
V 14 w(FREE\(ERRHANDLER,)e(IERROR\))p eop
%%Page: 298 312
298 311 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(298)1256 b(Chapter)13 b(7)336
507 y Fr(INTEGER)21 b(ERRHANDLER,)e(IERROR)291 591 y
FA(Marks)c(the)i(error)f(handler)g(asso)q(ciated)g(with)g
Fw(errhandler)i FA(for)d(deallo)q(cation)g(and)g(sets)i
Fw(er-)249 645 y(rhandler)e FA(to)e Fq(MPI)p 525 645
12 2 v 12 w(ERRHANDLER)p 787 645 V 14 w(NULL)p FA(.)f(The)i(error)g
(handler)f(will)e(b)q(e)j(deallo)q(cated)e(after)i(all)249
699 y(comm)o(unicators)e(asso)q(ciated)i(with)g(it)f(ha)o(v)o(e)h(b)q
(een)h(deallo)q(cated.)249 782 y Fs(7.4.2)48 b(Error)15
b(Co)q(des)249 865 y FA(Most)e Fw(MPI)f FA(functions)h(return)h(an)e
(error)i(co)q(de)f(indicating)f(successful)i(execution)g(\()p
Fq(MPI)p 1648 865 V 12 w(SUC-)249 919 y(CESS)p FA(\),)j(or)g(pro)o
(viding)f(information)e(on)j(the)h(t)o(yp)q(e)f(of)g
Fw(MPI)f FA(exception)i(that)f(o)q(ccurred.)29 b(In)249
973 y(certain)18 b(circumstances,)h(when)f(the)h Fw(MPI)e
FA(function)g(ma)o(y)f(complete)h(sev)o(eral)h(distinct)g(op-)249
1027 y(erations,)c(and)g(therefore)i(ma)o(y)d(generate)i(sev)o(eral)g
(indep)q(enden)o(t)h(errors,)f(the)g Fw(MPI)f FA(function)249
1081 y(ma)o(y)f(return)i(m)o(ultiple)d(error)k(co)q(des.)21
b(This)14 b(ma)o(y)e(o)q(ccur)k(with)e(some)g(of)g(the)h(calls)f
(describ)q(ed)249 1135 y(in)i(Section)g(2.9)f(that)h(complete)f(m)o
(ultiple)f(non)o(blo)q(c)o(king)g(comm)o(unications.)21
b(As)c(describ)q(ed)249 1189 y(in)d(that)h(section,)g(the)h(call)e(ma)o
(y)e(return)k(the)g(co)q(de)f Fq(MPI)p 1149 1189 V 13
w(ERR)p 1235 1189 V 13 w(IN)p 1286 1189 V 14 w(ST)m(A)m(TUS)p
FA(,)g(in)f(whic)o(h)h(case)h(a)249 1243 y(detailed)e(error)h(co)q(de)f
(is)g(returned)i(with)d(the)i(status)f(of)g(eac)o(h)g(comm)o
(unication.)291 1297 y(The)j(error)g(co)q(des)h(returned)g(b)o(y)e
Fw(MPI)g FA(are)h(left)f(en)o(tirely)h(to)f(the)i(implem)o(en)o(tation)
c(\(with)249 1351 y(the)f(exception)h(of)e Fq(MPI)p 622
1351 V 13 w(SUCCESS)p FA(,)h Fq(MPI)p 892 1351 V 12 w(ERR)p
977 1351 V 14 w(IN)p 1029 1351 V 14 w(ST)m(A)m(TUS)g
FA(and)g Fq(MPI)p 1346 1351 V 13 w(ERR)p 1432 1351 V
13 w(PENDING)p FA(\).)25 b(This)249 1405 y(is)15 b(done)g(to)g(allo)o
(w)e(an)i(implemen)o(tation)d(to)j(pro)o(vide)f(as)i(m)o(uc)o(h)d
(information)g(as)i(p)q(ossible)g(in)249 1459 y(the)h(error)g(co)q(de.)
22 b(Error)16 b(co)q(des)g(can)g(b)q(e)f(translated)h(in)o(to)e
(meaningful)f(messages)i(using)g(the)249 1513 y(function)f(b)q(elo)o
(w.)249 1638 y Fw(MPI)p 326 1638 13 2 v 14 w(ERROR)p
477 1638 V 14 w(STRING\()g(erro)o(rco)q(de,)h(string,)f(resultlen)h(\))
332 1712 y Fv(IN)158 b Fw(erro)o(rco)q(de)387 b Fv(Error)13
b(co)q(de)h(returned)g(b)o(y)f(an)h(MPI)f(routine)332
1762 y(OUT)114 b Fw(string)449 b Fv(T)m(ext)13 b(that)g(corresp)q(onds)
i(to)e(the)g Fq(erro)o(rco)q(de)332 1812 y Fv(OUT)114
b Fw(resultlen)403 b Fv(Length)17 b(\(in)g(prin)o(table)h(c)o
(haracters\))f(of)f(the)1079 1866 y(result)e(returned)g(in)g
Fq(string)249 1976 y Fr(int)21 b(MPI)p 405 1976 14 2
v 15 w(Error)p 530 1976 V 15 w(string\(int)f(errorcode,)f(char)i
(*string,)g(int)g(*resultlen\))249 2060 y(MPI)p 318 2060
V 15 w(ERROR)p 443 2060 V 15 w(STRING\(ERRORCODE)o(,)e(STRING,)h
(RESULTLEN,)g(IERROR\))336 2114 y(INTEGER)h(ERRORCODE,)e(RESULTLEN,)h
(IERROR)336 2168 y(CHARACTER*\(*\))f(STRING)291 2252
y FA(Returns)e(the)g(error)g(string)g(asso)q(ciated)g(with)f(an)g
(error)h(co)q(de)g(or)g(class.)26 b(The)17 b(argumen)o(t)249
2306 y Fw(string)g FA(m)o(ust)e(represen)o(t)k(storage)e(that)g(is)f
(at)g(least)h Fq(MPI)p 1158 2306 12 2 v 13 w(MAX)p 1257
2306 V 12 w(ERROR)p 1395 2306 V 14 w(STRING)g FA(c)o(haracters)249
2360 y(long.)291 2414 y(The)f(n)o(um)o(b)q(er)e(of)h(c)o(haracters)j
(actually)c(written)i(is)g(returned)h(in)e(the)h(output)g(argumen)o(t,)
249 2468 y Fw(resultlen)p FA(.)p eop
%%Page: 299 313
299 312 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(En)o(vironmen)o(tal)16 b(Managemen)o(t)963
b(299)249 507 y FB(R)n(ationale.)69 b FA(The)19 b(form)f(of)g(this)h
(function)g(w)o(as)g(c)o(hosen)h(to)f(mak)o(e)f(the)i(F)m(ortran)f(and)
f(C)249 561 y(bindings)d(similar.)21 b(A)16 b(v)o(ersion)f(that)h
(returns)h(a)f(p)q(oin)o(ter)g(to)f(a)h(string)f(has)h(t)o(w)o(o)f
(di\016culties.)249 615 y(First,)d(the)f(return)h(string)g(m)o(ust)e(b)
q(e)h(statically)f(allo)q(cated)h(and)g(di\013eren)o(t)h(for)f(eac)o(h)
g(error)h(mes-)249 669 y(sage)i(\(allo)o(wing)d(the)j(p)q(oin)o(ters)g
(returned)h(b)o(y)e(successiv)o(e)j(calls)d(to)g Fw(MPI)p
1383 669 13 2 v 15 w(ERROR)p 1535 669 V 13 w(STRING)h
FA(to)249 723 y(p)q(oin)o(t)f(to)f(the)i(correct)h(message\).)i
(Second,)d(in)e(F)m(ortran,)h(a)f(function)h(declared)h(as)f(returning)
249 777 y Fq(CHARA)o(CTER*\(*\))i FA(can)h(not)f(b)q(e)i(referenced)h
(in,)d(for)h(example,)e(a)i Fq(PRINT)f FA(statemen)o(t.)24
b(\()p FB(End)249 831 y(of)15 b(r)n(ationale.)p FA(\))291
918 y(The)c(use)h(of)e(implemen)o(tation-dep)q(enden)o(t)f(error)j(co)q
(des)h(allo)o(ws)c(implemen)o(ters)h(to)h(pro)o(vide)249
972 y(more)i(information,)d(but)k(prev)o(en)o(ts)h(one)f(from)e
(writing)h(p)q(ortable)h(error-handling)f(co)q(de.)19
b(T)m(o)249 1026 y(solv)o(e)f(this)h(problem,)f Fw(MPI)g
FA(pro)o(vides)h(a)f(standard)h(set)g(of)f(sp)q(eci\014ed)i(error)g(v)n
(alues,)f(called)249 1080 y Fs(error)13 b(classes)p FA(,)e(and)g(a)h
(function)g(that)g(maps)f(eac)o(h)i(error)g(co)q(de)f(in)o(to)g(a)g
(suitable)f(error)i(class.)291 1188 y(V)m(alid)f(error)j(classes)g(are)
452 1251 y Fq(MPI)p 524 1251 12 2 v 12 w(SUCCESS)183
b FA(No)13 b(error)452 1305 y Fq(MPI)p 524 1305 V 12
w(ERR)p 609 1305 V 14 w(BUFFER)114 b FA(In)o(v)n(alid)12
b(bu\013er)j(p)q(oin)o(ter)452 1359 y Fq(MPI)p 524 1359
V 12 w(ERR)p 609 1359 V 14 w(COUNT)126 b FA(In)o(v)n(alid)12
b(coun)o(t)i(argumen)o(t)452 1413 y Fq(MPI)p 524 1413
V 12 w(ERR)p 609 1413 V 14 w(TYPE)158 b FA(In)o(v)n(alid)12
b(datat)o(yp)q(e)i(argumen)o(t)452 1467 y Fq(MPI)p 524
1467 V 12 w(ERR)p 609 1467 V 14 w(T)m(A)o(G)184 b FA(In)o(v)n(alid)12
b(tag)h(argumen)o(t)452 1521 y Fq(MPI)p 524 1521 V 12
w(ERR)p 609 1521 V 14 w(COMM)137 b FA(In)o(v)n(alid)12
b(comm)o(unicator)452 1575 y Fq(MPI)p 524 1575 V 12 w(ERR)p
609 1575 V 14 w(RANK)153 b FA(In)o(v)n(alid)12 b(rank)452
1629 y Fq(MPI)p 524 1629 V 12 w(ERR)p 609 1629 V 14 w(REQUEST)86
b FA(In)o(v)n(alid)12 b(request)452 1683 y Fq(MPI)p 524
1683 V 12 w(ERR)p 609 1683 V 14 w(ROOT)151 b FA(In)o(v)n(alid)12
b(ro)q(ot)452 1737 y Fq(MPI)p 524 1737 V 12 w(ERR)p 609
1737 V 14 w(GROUP)128 b FA(In)o(v)n(alid)12 b(group)452
1791 y Fq(MPI)p 524 1791 V 12 w(ERR)p 609 1791 V 14 w(OP)205
b FA(In)o(v)n(alid)12 b(op)q(eration)452 1844 y Fq(MPI)p
524 1844 V 12 w(ERR)p 609 1844 V 14 w(TOPOLOGY)50 b FA(In)o(v)n(alid)12
b(top)q(ology)452 1898 y Fq(MPI)p 524 1898 V 12 w(ERR)p
609 1898 V 14 w(DIMS)164 b FA(In)o(v)n(alid)12 b(dimension)g(argumen)o
(t)452 1952 y Fq(MPI)p 524 1952 V 12 w(ERR)p 609 1952
V 14 w(ARG)181 b FA(In)o(v)n(alid)12 b(argumen)o(t)h(of)g(some)g(other)
h(kind)452 2006 y Fq(MPI)p 524 2006 V 12 w(ERR)p 609
2006 V 14 w(UNKNO)o(WN)61 b FA(Unkno)o(wn)13 b(error)452
2060 y Fq(MPI)p 524 2060 V 12 w(ERR)p 609 2060 V 14 w(TRUNCA)m(TE)57
b FA(Message)15 b(truncated)g(on)f(receiv)o(e)452 2114
y Fq(MPI)p 524 2114 V 12 w(ERR)p 609 2114 V 14 w(OTHER)129
b FA(Kno)o(wn)14 b(error)g(not)g(in)g(this)g(list)452
2168 y Fq(MPI)p 524 2168 V 12 w(ERR)p 609 2168 V 14 w(INTERN)119
b FA(In)o(ternal)14 b(MPI)g(error)452 2222 y Fq(MPI)p
524 2222 V 12 w(ERR)p 609 2222 V 14 w(IN)p 661 2222 V
14 w(ST)m(A)m(TUS)66 b FA(Error)14 b(co)q(de)h(is)f(in)f(status)452
2276 y Fq(MPI)p 524 2276 V 12 w(ERR)p 609 2276 V 14 w(PENDING)91
b FA(P)o(ending)14 b(request)452 2330 y Fq(MPI)p 524
2330 V 12 w(ERR)p 609 2330 V 14 w(LASTCODE)60 b FA(Last)14
b(error)h(co)q(de)291 2400 y(Most)h(of)g(these)i(classes)f(are)g(self)f
(explanatory)m(.)25 b(The)17 b(use)g(of)f Fq(MPI)p 1371
2400 V 12 w(ERR)p 1456 2400 V 14 w(IN)p 1508 2400 V 14
w(ST)m(A)m(TUS)h FA(and)249 2454 y Fq(MPI)p 321 2454
V 13 w(ERR)p 407 2454 V 13 w(PENDING)c FA(is)h(explained)g(in)f
(Section)i(2.9.)i(The)d(list)g(of)f(standard)i(classes)g(ma)o(y)d(b)q
(e)249 2508 y(extended)j(in)f(the)g(future.)p eop
%%Page: 300 314
300 313 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(300)1256 b(Chapter)13 b(7)291
507 y FA(The)i(function)g Fw(MPI)p 618 507 13 2 v 15
w(ERROR)p 770 507 V 13 w(STRING)g FA(can)h(b)q(e)g(used)g(to)f(compute)
g(the)h(error)g(string)f(as-)249 561 y(so)q(ciated)g(with)e(an)h(error)
h(class.)291 615 y(The)f(error)h(co)q(des)g(satisfy)m(,)461
710 y(0)c(=)h Fw(MPI)p 614 710 12 2 v 13 w(SUCCESS)e
Fp(<)i Fw(MPI)p 933 710 V 13 w(ERR)p 1025 710 V 13 w
Fp(:::)f Ft(\024)g Fw(MPI)p 1203 710 V 14 w(ERR)p 1296
710 V 13 w(LASTCODE)o Fp(:)249 876 y Fw(MPI)p 326 876
13 2 v 14 w(ERROR)p 477 876 V 14 w(CLASS\()j(erro)o(rco)q(de,)h(erro)o
(rclass)g(\))332 950 y Fv(IN)158 b Fw(erro)o(rco)q(de)387
b Fv(Error)13 b(co)q(de)h(returned)g(b)o(y)f(an)h(MPI)f(routine)332
1000 y(OUT)114 b Fw(erro)o(rclass)386 b Fv(Error)13 b(class)h(asso)q
(ciated)h(with)f Fq(erro)o(rco)q(de)249 1110 y Fr(int)21
b(MPI)p 405 1110 14 2 v 15 w(Error)p 530 1110 V 15 w(class\(int)f
(errorcode,)g(int)h(*errorclass\))249 1194 y(MPI)p 318
1194 V 15 w(ERROR)p 443 1194 V 15 w(CLASS\(ERRORCODE,)d(ERRORCLASS,)i
(IERROR\))336 1248 y(INTEGER)h(ERRORCODE,)e(ERRORCLASS,)h(IERROR)291
1332 y FA(The)f(function)f Fw(MPI)p 625 1332 13 2 v 15
w(ERROR)p 777 1332 V 13 w(CLASS)h FA(maps)e(eac)o(h)j(error)f(co)q(de)h
(in)o(to)e(a)g(standard)h(error)249 1386 y(co)q(de)c(\(error)g
(class\).)j(It)c(maps)f(eac)o(h)h(standard)h(error)f(co)q(de)h(on)o(to)
f(itself.)249 1477 y FB(R)n(ationale.)49 b FA(The)16
b(di\013erence)i(b)q(et)o(w)o(een)f Fq(MPI)p 991 1477
12 2 v 13 w(ERR)p 1077 1477 V 13 w(UNKNO)o(WN)g FA(and)f
Fq(MPI)p 1457 1477 V 13 w(ERR)p 1543 1477 V 13 w(OTHER)h
FA(is)249 1531 y(that)d Fw(MPI)p 416 1531 13 2 v 14 w(ERROR)p
567 1531 V 14 w(STRING)g FA(can)g(return)h(useful)f(information)d(ab)q
(out)j Fq(MPI)p 1478 1531 12 2 v 12 w(ERR)p 1563 1531
V 14 w(OTHER)p FA(.)249 1602 y(Note)g(that)g Fq(MPI)p
511 1602 V 13 w(SUCCESS)g FA(=)e(0)i(is)g(necessary)h(to)f(b)q(e)h
(consisten)o(t)g(with)e(C)h(practice.)249 1672 y(The)j(v)n(alue)f(of)h
Fq(MPI)p 570 1672 V 12 w(ERR)p 655 1672 V 14 w(LASTCODE)g
FA(can)g(b)q(e)g(used)h(for)e(error-c)o(hec)o(king,)i(or)f(for)g
(selecting)249 1726 y(error)e(co)q(des)g(for)e(libraries)h(that)g(do)g
(not)f(con\015ict)i(with)e Fw(MPI)h FA(error)g(co)q(des.)249
1796 y(\()p FB(End)i(of)f(r)n(ationale.)p FA(\))249 1888
y FB(A)n(dvic)n(e)j(to)h(implementors.)59 b FA(An)18
b Fw(MPI)f FA(implemen)o(tation)e(ma)o(y)h(use)i(error)h(classes)g(as)f
(the)249 1942 y(error)e(co)q(des)g(returned)h(b)o(y)e(some)g(or)g(all)f
Fw(MPI)g FA(functions.)22 b(Another)16 b(c)o(hoice)f(is)h(to)e(use)i
(error)249 1996 y(classes)e(as)f(\\ma)r(jor)e(error)j(co)q(des",)g
(extended)g(with)f(additional)e(bits)i(that)g(pro)o(vide)g(\\minor")249
2050 y(error)j(co)q(des.)22 b(Then,)15 b(the)g Fw(MPI)p
753 2050 13 2 v 14 w(ERROR)p 904 2050 V 14 w(CLASS)g
FA(function)f(merely)g(needs)i(to)f(truncate)h(the)249
2104 y(full)d(error)i(co)q(de.)249 2174 y(Implemen)o(tations)f(ma)o(y)h
(go)h(b)q(ey)o(ond)i(this)f(do)q(cumen)o(t)f(in)g(supp)q(orting)h
Fw(MPI)g FA(calls)f(that)h(are)249 2228 y(de\014ned)d(here)f(to)g(b)q
(e)g(erroneous.)19 b(F)m(or)12 b(example,)f Fw(MPI)h
FA(sp)q(eci\014es)i(strict)f(t)o(yp)q(e)g(matc)o(hing)e(rules)249
2282 y(b)q(et)o(w)o(een)18 b(matc)o(hing)d(send)j(and)e(receiv)o(e)i
(op)q(erations:)24 b(it)16 b(is)h(erroneous)h(to)e(send)i(a)e
(\015oating)249 2336 y(p)q(oin)o(t)e(v)n(ariable)g(and)g(receiv)o(e)i
(an)f(in)o(teger.)21 b(Implemen)o(tations)12 b(ma)o(y)h(go)h(b)q(ey)o
(ond)h(these)h(t)o(yp)q(e)249 2390 y(matc)o(hing)e(rules,)i(and)g(pro)o
(vide)g(automatic)e(t)o(yp)q(e)i(con)o(v)o(ersion)g(in)f(suc)o(h)i
(situations.)23 b(It)16 b(will)249 2444 y(b)q(e)g(helpful)f(to)g
(generate)i(w)o(arnings)e(for)g(suc)o(h)i(nonconforming)c(b)q(eha)o
(vior.)23 b(\()p FB(End)17 b(of)f(advic)n(e)249 2498
y(to)f(implementors.)p FA(\))p eop
%%Page: 301 315
301 314 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(En)o(vironmen)o(tal)16 b(Managemen)o(t)963
b(301)249 507 y FD(7.5)52 b(In)o(teraction)18 b(with)h(Executing)f(En)o
(vironmen)o(t)249 615 y FA(There)e(are)f(a)f(n)o(um)o(b)q(er)g(of)f
(areas)i(where)h(an)e Fw(MPI)g FA(implemen)o(tation)d(ma)o(y)i(in)o
(teract)i(with)f(the)249 669 y(op)q(erating)e(en)o(vironmen)o(t)f(and)h
(system.)17 b(While)12 b Fw(MPI)f FA(do)q(es)i(not)f(mandate)f(that)h
(an)o(y)g(services)249 723 y(\(suc)o(h)i(as)f(I/O)g(or)g(signal)f
(handling\))g(b)q(e)h(pro)o(vided,)g(it)g(do)q(es)g(strongly)g(suggest)
h(the)g(b)q(eha)o(vior)249 777 y(to)c(b)q(e)g(pro)o(vided)g(if)f(those)
i(services)g(are)g(a)o(v)n(ailable.)j(This)c(is)g(an)f(imp)q(ortan)o(t)
f(p)q(oin)o(t)i(in)f(ac)o(hieving)249 831 y(p)q(ortabilit)o(y)k(across)
h(platforms)e(that)i(pro)o(vide)g(the)h(same)e(set)h(of)g(services.)249
914 y Fs(7.5.1)48 b(Indep)q(endence)13 b(of)i(Basic)h(Run)o(time)d
(Routines)249 997 y Fw(MPI)19 b FA(programs)f(require)j(that)e(library)
g(routines)h(that)g(are)g(part)g(of)e(the)j(basic)e(language)249
1051 y(en)o(vironmen)o(t)12 b(\(suc)o(h)i(as)g Fr(date)e
FA(and)h Fr(write)f FA(in)h(F)m(ortran)g(and)g Fr(printf)f
FA(and)h Fr(malloc)f FA(in)h(ANSI)249 1105 y(C\))c(and)h(are)f
(executed)i(after)f Fr(MPI)p 775 1105 14 2 v 15 w(INIT)f
FA(and)g(b)q(efore)h Fr(MPI)p 1149 1105 V 15 w(FINALIZE)d
FA(op)q(erate)k(indep)q(enden)o(tly)249 1159 y(and)h(that)g(their)h
FB(c)n(ompletion)j FA(is)c(indep)q(enden)o(t)h(of)f(the)h(action)f(of)f
(other)i(pro)q(cesses)i(in)d(an)g Fw(MPI)249 1213 y FA(program.)291
1267 y(Note)k(that)g(this)h(in)e(no)h(w)o(a)o(y)g(prev)o(en)o(ts)h(the)
g(creation)g(of)e(library)h(routines)g(that)h(pro)o(vide)249
1321 y(parallel)e(services)j(whose)f(op)q(eration)f(is)g(collectiv)o
(e.)26 b(Ho)o(w)o(ev)o(er,)16 b(the)h(follo)o(wing)d(program)h(is)249
1375 y(exp)q(ected)k(to)d(complete)g(in)g(an)g(ANSI)h(C)f(en)o
(vironmen)o(t)f(regardless)j(of)e(the)h(size)g(of)249
1429 y Fr(MPI)p 318 1429 V 15 w(COMM)p 421 1429 V 15
w(WORLD)c FA(\(assuming)f(that)i(I/O)g(is)g(a)o(v)n(ailable)d(at)j(the)
h(executing)f(no)q(des\).)249 1483 y Fr(int)21 b(rank;)249
1537 y(MPI_Init\()f(argc,)h(argv)g(\);)249 1591 y(MPI_Comm_rank\()e
(MPI_COMM_WORLD,)g(&rank)h(\);)249 1645 y(if)h(\(rank)g(==)h(0\))f
(printf\()f("Starting)g(program\\n")g(\);)249 1699 y(MPI_Finalize\(\);)
291 1807 y FA(The)14 b(corresp)q(onding)h(F)m(ortran)e(77)h(program)e
(is)i(also)f(exp)q(ected)j(to)e(complete.)291 1861 y(An)9
b(example)f(of)h(what)g(is)g FB(not)14 b FA(required)c(is)f(an)o(y)g
(particular)g(ordering)h(of)e(the)i(action)f(of)g(these)249
1914 y(routines)h(when)h(called)e(b)o(y)g(sev)o(eral)i(tasks.)17
b(F)m(or)9 b(example,)g Fw(MPI)g FA(mak)o(es)f(neither)j(requiremen)o
(ts)249 1968 y(nor)k(recommendations)f(for)h(the)h(output)g(from)d(the)
j(follo)o(wing)d(program)h(\(again)g(assuming)249 2022
y(that)g(I/O)g(is)g(a)o(v)n(ailable)d(at)j(the)h(executing)f(no)q
(des\).)249 2101 y Fr(MPI_Comm_rank\()19 b(MPI_COMM_WORLD,)g(&rank)h
(\);)249 2155 y(printf\()g("Output)h(from)g(task)g(rank)g(\045d\\n",)f
(rank)h(\);)291 2234 y FA(In)f(addition,)h(calls)g(that)g(fail)e(b)q
(ecause)j(of)e(resource)j(exhaustion)e(or)g(other)g(error)h(are)249
2288 y(not)14 b(considered)i(a)e(violation)e(of)i(the)h(requiremen)o
(ts)g(here)g(\(ho)o(w)o(ev)o(er,)g(they)g(are)f(required)i(to)249
2342 y(complete,)d(just)h(not)g(to)f(complete)h(successfully\).)249
2425 y Fs(7.5.2)48 b(In)o(teraction)13 b(with)i(Signals)e(in)i(POSIX)
249 2508 y Fw(MPI)i FA(do)q(es)h(not)f(sp)q(ecify)h(either)g(the)g(in)o
(teraction)f(of)f(pro)q(cesses)k(with)d(signals,)g(in)g(a)g(UNIX)p
eop
%%Page: 302 316
302 315 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(302)1256 b(Chapter)13 b(7)249
507 y FA(en)o(vironmen)o(t,)f(or)h(with)g(other)h(ev)o(en)o(ts)g(that)g
(do)f(not)g(relate)g(to)h Fw(MPI)e FA(comm)o(unication.)j(That)249
561 y(is,)e(signals)f(are)i(not)f(signi\014can)o(t)f(from)f(the)j(view)
f(p)q(oin)o(t)g(of)f Fw(MPI)p FA(,)g(and)h(implemen)o(tors)e(should)249
615 y(attempt)i(to)h(implemen)o(t)d Fw(MPI)i FA(so)h(that)g(signals)g
(are)g(transparen)o(t:)19 b(an)14 b Fw(MPI)f FA(call)g(susp)q(ended)249
669 y(b)o(y)h(a)f(signal)g(should)h(resume)g(and)f(complete)g(after)i
(the)f(signal)f(is)g(handled.)18 b(Generally)m(,)13 b(the)249
723 y(state)20 b(of)e(a)h(computation)e(that)i(is)g(visible)f(or)h
(signi\014can)o(t)f(from)f(the)j(view-p)q(oin)o(t)e(of)g
Fw(MPI)249 777 y FA(should)c(only)f(b)q(e)h(a\013ected)i(b)o(y)d
Fw(MPI)h FA(calls.)291 831 y(The)i(in)o(ten)o(t)f(of)g
Fw(MPI)g FA(to)g(b)q(e)h(thread)g(and)g(signal)e(safe)i(has)f(a)h(n)o
(um)o(b)q(er)e(of)31 b(subtle)16 b(e\013ects.)249 885
y(F)m(or)i(example,)f(on)h(Unix)g(systems,)h(a)e(catc)o(hable)i(signal)
e(suc)o(h)i(as)f(SIGALRM)g(\(an)g(alarm)249 939 y(signal\))c(m)o(ust)f
(not)h(cause)i(an)e Fw(MPI)g FA(routine)g(to)h(b)q(eha)o(v)o(e)g
(di\013eren)o(tly)g(than)f(it)g(w)o(ould)g(ha)o(v)o(e)g(in)249
993 y(the)d(absence)i(of)d(the)h(signal.)16 b(Of)11 b(course,)h(if)e
(the)h(signal)f(handler)h(issues)h Fw(MPI)e FA(calls)g(or)h(c)o(hanges)
249 1047 y(the)i(en)o(vironmen)o(t)f(in)g(whic)o(h)g(the)h
Fw(MPI)f FA(routine)h(is)f(op)q(erating)g(\(for)h(example,)e(consuming)
g(all)249 1101 y(a)o(v)n(ailable)k(memory)g(space\),)k(the)e
Fw(MPI)g FA(routine)g(should)g(b)q(eha)o(v)o(e)h(as)f(appropriate)h
(for)e(that)249 1155 y(situation)j(\(in)h(particular,)g(in)f(this)h
(case,)i(the)e(b)q(eha)o(vior)g(should)f(b)q(e)h(the)h(same)e(as)g(for)
h(a)249 1209 y(m)o(ultithreaded)13 b Fw(MPI)g FA(implemen)o(tation\).)
291 1263 y(A)e(second)h(e\013ect)g(is)f(that)g(a)g(signal)f(handler)h
(that)g(p)q(erforms)g Fw(MPI)f FA(calls)g(m)o(ust)g(not)h(in)o(terfere)
249 1317 y(with)17 b(the)g(op)q(eration)g(of)f Fw(MPI)p
FA(.)f(F)m(or)i(example,)f(an)g Fw(MPI)g FA(receiv)o(e)i(of)e(an)o(y)h
(t)o(yp)q(e)g(that)g(o)q(ccurs)249 1371 y(within)d(a)h(signal)f
(handler)h(m)o(ust)e(not)i(cause)h(erroneous)g(b)q(eha)o(vior)f(b)o(y)g
(the)g Fw(MPI)f FA(implemen-)249 1425 y(tation.)19 b(Note)c(that)g(an)f
(implemen)o(tation)d(is)k(p)q(ermitted)f(to)h(prohibit)e(the)j(use)f
(of)f Fw(MPI)g FA(calls)249 1479 y(from)e(within)h(a)h(signal)f
(handler,)g(and)h(is)g(not)g(required)g(to)g(detect)i(suc)o(h)e(use.)
291 1533 y(It)h(is)g(highly)g(desirable)g(that)h Fw(MPI)f
FA(not)g(use)h(SIGALRM,)f(SIGFPE,)g(or)g(SIGIO.)g(An)h(im-)249
1587 y(plemen)o(tation)c(is)h FB(r)n(e)n(quir)n(e)n(d)k
FA(to)d(clearly)f(do)q(cumen)o(t)g(all)g(of)g(the)h(signals)f(that)g
(the)i Fw(MPI)d FA(imple-)249 1641 y(men)o(tation)g(uses;)j(a)e(go)q(o)
q(d)h(place)g(for)g(this)f(information)e(is)j(a)g(Unix)f(`)p
Fr(man)p FA(')g(page)g(on)h Fw(MPI)p FA(.)p eop
%%Page: 303 317
303 316 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 325 a Fu(8)25 b FD(The)18 b Fw(MPI)e
FD(Pro\014ling)j(In)o(terface)249 628 y(8.1)52 b(Requiremen)o(ts)249
736 y FA(T)m(o)11 b(satisfy)h(the)g(requiremen)o(ts)g(of)f(the)i
Fw(MPI)e FA(pro\014ling)g(in)o(terface,)h(an)f(implemen)o(tation)e(of)i
(the)249 790 y Fw(MPI)i FA(functions)h FB(must)249 873
y FA(1.)20 b(pro)o(vide)e(a)g(mec)o(hanism)e(through)i(whic)o(h)g(all)f
(of)g(the)i Fw(MPI)e FA(de\014ned)i(functions)g(ma)o(y)d(b)q(e)249
927 y(accessed)j(with)d(a)g(name)f(shift.)25 b(Th)o(us)17
b(all)e(of)h(the)h Fw(MPI)e FA(functions)i(\(whic)o(h)f(normally)e
(start)249 981 y(with)g(the)g(pre\014x)h(\\)p Fr(MPI)p
622 981 14 2 v 15 w FA("\))e(should)h(also)f(b)q(e)i(accessible)g(with)
e(the)i(pre\014x)g(\\)p Fr(PMPI)p 1538 981 V 14 w FA(".)249
1034 y(2.)20 b(ensure)c(that)e(those)g Fw(MPI)g FA(functions)g(whic)o
(h)f(are)i(not)e(replaced)i(ma)o(y)d(still)h(b)q(e)i(link)o(ed)e(in)o
(to)249 1088 y(an)h(executable)h(image)d(without)h(causing)h(name)f
(clashes.)249 1142 y(3.)20 b(do)q(cumen)o(t)11 b(the)g(implemen)o
(tatio)o(n)d(of)j(di\013eren)o(t)h(language)e(bindings)g(of)g(the)i
Fw(MPI)e FA(in)o(terface)249 1196 y(if)g(they)g(are)h(la)o(y)o(ered)g
(on)f(top)g(of)g(eac)o(h)h(other,)g(so)f(that)h(the)g(pro\014ler)g(dev)
o(elop)q(er)g(kno)o(ws)f(whether)249 1250 y(the)15 b(pro\014le)f(in)o
(terface)h(m)o(ust)e(b)q(e)h(implemen)o(ted)e(for)i(eac)o(h)g(binding,)
f(or)h(whether)h(it)f(needs)i(to)249 1304 y(b)q(e)f(implem)o(en)o(ted)d
(only)h(for)h(the)g(lo)o(w)o(est)g(lev)o(el)g(routines.)249
1358 y(4.)20 b(ensure)h(that)f(where)h(the)f(implem)o(en)o(tation)d(of)
i(di\013eren)o(t)h(language)f(bindings)g(is)g(done)249
1412 y(through)10 b(a)g(la)o(y)o(ered)h(approac)o(h)f(\(e.g.)17
b(the)10 b(F)m(ortran)g(binding)g(is)g(a)g(set)h(of)f(\\wrapp)q(er")g
(functions)249 1466 y(whic)o(h)k(call)g(the)h(C)f(implemen)o(tatio)o
(n\),)d(these)16 b(wrapp)q(er)f(functions)g(are)f(separable)h(from)e
(the)249 1520 y(rest)20 b(of)e(the)h(library)m(.)32 b(This)18
b(is)h(necessary)i(to)d(allo)o(w)f(a)i(separate)h(pro\014ling)d
(library)h(to)h(b)q(e)249 1574 y(correctly)i(implemen)o(ted,)e(since)i
(\(at)f(least)g(with)f(Unix)h(link)o(er)f(seman)o(tics\))h(the)g
(pro\014ling)249 1628 y(library)14 b(m)o(ust)g(con)o(tain)g(these)i
(wrapp)q(er)g(functions)e(if)g(it)g(is)h(to)f(p)q(erform)g(as)h(exp)q
(ected.)23 b(This)249 1682 y(requiremen)o(t)d(allo)o(ws)f(the)i(p)q
(erson)g(who)f(builds)g(the)h(pro\014ling)e(library)h(to)g(extract)h
(these)249 1736 y(functions)e(from)f(the)i(original)d
Fw(MPI)i FA(library)f(and)h(add)g(them)g(in)o(to)f(the)i(pro\014ling)e
(library)249 1790 y(without)c(bringing)e(along)h(an)o(y)h(other)g
(unnecessary)i(co)q(de.)249 1844 y(5.)k(pro)o(vide)14
b(a)f(no-op)h(routine)g Fw(MPI)p 820 1844 13 2 v 14 w(PCONTROL)f
FA(in)h(the)g Fw(MPI)f FA(library)m(.)249 1964 y FD(8.2)52
b(Discussion)249 2072 y FA(The)17 b(ob)r(jectiv)o(e)g(of)g(the)g
Fw(MPI)f FA(pro\014ling)g(in)o(terface)h(is)f(to)h(ensure)h(that)f(it)f
(is)h(relativ)o(ely)f(easy)249 2126 y(for)i(authors)g(of)g(pro\014ling)
f(\(and)h(other)h(similar\))d(to)q(ols)i(to)f(in)o(terface)i(their)g
(co)q(des)g(to)f Fw(MPI)249 2180 y FA(implemen)o(tations)11
b(on)i(di\013eren)o(t)i(mac)o(hines.)291 2234 y(Since)g
Fw(MPI)g FA(is)g(a)g(mac)o(hine)e(indep)q(enden)o(t)k(standard)e(with)g
(man)o(y)f(di\013eren)o(t)i(implem)o(en)o(ta-)249 2288
y(tions,)g(it)f(is)h(unreasonable)g(to)g(exp)q(ect)h(that)f(the)g
(authors)g(of)f(pro\014ling)g(to)q(ols)g(for)h Fw(MPI)f
FA(will)249 2342 y(ha)o(v)o(e)g(access)i(to)e(the)h(source)g(co)q(de)g
(whic)o(h)f(implemen)o(ts)e Fw(MPI)i FA(on)g(an)o(y)f(particular)h(mac)
o(hine.)249 2396 y(It)d(is)f(therefore)i(necessary)h(to)d(pro)o(vide)h
(a)f(mec)o(hanism)e(b)o(y)j(whic)o(h)f(the)h(implemen)o(tors)e(of)h
(suc)o(h)249 2450 y(to)q(ols)h(can)h(collect)f(whatev)o(er)h(p)q
(erformance)f(information)e(they)j(wish)f FB(without)g
FA(access)i(to)e(the)249 2504 y(underlying)i(implem)o(en)o(tation.)965
2613 y(303)p eop
%%Page: 304 318
304 317 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(304)1256 b(Chapter)13 b(8)291
507 y FA(The)h Fw(MPI)f FA(F)m(orum)f(b)q(eliev)o(ed)j(that)f(ha)o
(ving)f(suc)o(h)h(an)g(in)o(terface)g(is)g(imp)q(ortan)o(t)e(if)i
Fw(MPI)f FA(is)h(to)249 561 y(b)q(e)j(attractiv)o(e)g(to)g(end)g
(users,)h(since)f(the)g(a)o(v)n(ailabilit)o(y)c(of)j(man)o(y)f
(di\013eren)o(t)i(to)q(ols)f(will)g(b)q(e)h(a)249 615
y(signi\014can)o(t)c(factor)h(in)g(attracting)g(users)h(to)f(the)g
Fw(MPI)f FA(standard.)291 669 y(The)j(pro\014ling)e(in)o(terface)i(is)g
(just)f(that,)h(an)f(in)o(terface.)24 b(It)16 b(sa)o(ys)f
FB(nothing)i FA(ab)q(out)e(the)h(w)o(a)o(y)249 723 y(in)c(whic)o(h)h
(it)g(is)f(used.)19 b(Therefore,)14 b(there)g(is)e(no)h(attempt)f(to)h
(la)o(y)f(do)o(wn)g(what)h(information)d(is)249 777 y(collected)15
b(through)g(the)g(in)o(terface,)g(or)f(ho)o(w)g(the)h(collected)h
(information)11 b(is)k(sa)o(v)o(ed,)f(\014ltered,)249
831 y(or)g(displa)o(y)o(ed.)291 885 y(While)j(the)h(initial)e(imp)q
(etus)h(for)g(the)i(dev)o(elopmen)o(t)e(of)g(this)h(in)o(terface)g
(arose)h(from)d(the)249 939 y(desire)11 b(to)e(p)q(ermit)f(the)j
(implem)o(en)o(tation)6 b(of)j(pro\014ling)g(to)q(ols,)g(it)g(is)h
(clear)f(that)h(an)f(in)o(terface)h(lik)o(e)249 993 y(that)15
b(sp)q(eci\014ed)h(ma)o(y)c(also)i(pro)o(v)o(e)h(useful)f(for)g(other)i
(purp)q(oses,)f(suc)o(h)g(as)g(\\in)o(ternet)o(w)o(orking")249
1047 y(m)o(ultiple)d Fw(MPI)h FA(implemen)o(tations.)j(Since)e(all)f
(that)h(is)g(de\014ned)h(is)f(an)g(in)o(terface,)g(there)i(is)e(no)249
1101 y(imp)q(edimen)o(t)d(to)j(it)g(b)q(eing)f(used)i(wherev)o(er)h(it)
d(is)h(useful.)291 1155 y(As)g(the)g(issues)h(b)q(eing)f(addressed)h
(here)g(are)f(in)o(timately)e(tied)i(up)f(with)h(the)g(w)o(a)o(y)f(in)h
(whic)o(h)249 1209 y(executable)19 b(images)e(are)h(built,)g(whic)o(h)g
(ma)o(y)f(di\013er)h(greatly)g(on)g(di\013eren)o(t)h(mac)o(hines,)f
(the)249 1263 y(examples)11 b(giv)o(en)h(b)q(elo)o(w)g(should)h(b)q(e)f
(treated)i(solely)e(as)g(one)h(w)o(a)o(y)f(of)f(implemen)o(ting)e(the)k
Fw(MPI)249 1317 y FA(pro\014ling)h(in)o(terface.)22 b(The)15
b(actual)g(requiremen)o(ts)g(made)f(of)g(an)h(implemen)o(tatio)o(n)d
(are)k(those)249 1371 y(detailed)j(in)g(Section)h(8.1,)g(the)g(whole)f
(of)g(the)h(rest)g(of)f(this)h(c)o(hapter)g(is)g(only)e(presen)o(t)j
(as)249 1425 y(justi\014cation)13 b(and)h(discussion)h(of)e(the)h
(logic)f(for)h(those)g(requiremen)o(ts.)291 1479 y(The)k(examples)e(b)q
(elo)o(w)h(sho)o(w)h(one)g(w)o(a)o(y)e(in)h(whic)o(h)h(an)f(implemen)o
(tatio)o(n)e(could)i(b)q(e)h(con-)249 1533 y(structed)i(to)d(meet)g
(the)i(requiremen)o(ts)f(on)f(a)g(Unix)g(system)h(\(there)h(are)f
(doubtless)g(others)249 1587 y(whic)o(h)c(w)o(ould)f(b)q(e)h(equally)f
(v)n(alid\).)249 1707 y FD(8.3)52 b(Logic)19 b(of)f(the)f(Design)249
1815 y FA(Pro)o(vided)12 b(that)g(an)g Fw(MPI)g FA(implemen)o(tati)o
(on)d(meets)j(the)h(requiremen)o(ts)g(listed)f(in)f(Section)i(8.1,)249
1869 y(it)f(is)h(p)q(ossible)g(for)f(the)i(implemen)o(tor)c(of)i(the)h
(pro\014ling)f(system)g(to)h(in)o(tercept)h(all)e(of)g(the)h
Fw(MPI)249 1923 y FA(calls)i(whic)o(h)g(are)h(made)e(b)o(y)i(the)g
(user)g(program.)21 b(Whatev)o(er)16 b(information)d(is)i(required)h
(can)249 1977 y(then)i(b)q(e)g(collected)h(b)q(efore)f(calling)e(the)j
(underlying)e Fw(MPI)g FA(implem)o(en)o(tation)e(\(through)i(its)249
2031 y(name)c(shifted)h(en)o(try)g(p)q(oin)o(ts\))g(to)g(ac)o(hiev)o(e)
g(the)h(desired)g(e\013ects.)249 2114 y Fs(8.3.1)48 b(Miscellaneous)13
b(Con)o(trol)g(of)j(Pro\014ling)249 2197 y FA(There)j(is)f(a)g(clear)h
(requiremen)o(t)f(for)f(the)i(user)g(co)q(de)g(to)f(b)q(e)h(able)f(to)g
(con)o(trol)f(the)i(pro\014ler)249 2251 y(dynamically)11
b(at)j(run)g(time.)j(This)c(is)h(normally)d(used)k(for)f(\(at)g
(least\))g(the)g(purp)q(oses)i(of)249 2334 y Ft(\017)29
b FA(Enabling)13 b(and)g(disabling)g(pro\014ling)g(dep)q(ending)h(on)g
(the)g(state)h(of)e(the)i(calculation.)249 2388 y Ft(\017)29
b FA(Flushing)13 b(trace)i(bu\013ers)g(at)f(non-critical)f(p)q(oin)o
(ts)h(in)f(the)i(calculation)249 2442 y Ft(\017)29 b
FA(Adding)13 b(user)i(ev)o(en)o(ts)g(to)f(a)g(trace)g(\014le.)p
eop
%%Page: 305 319
305 318 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 254 a Fv(The)13 b Fw(MPI)f Fv(Pro\014ling)k(In)o
(terface)968 b(305)291 507 y FA(These)15 b(requiremen)o(ts)f(are)g(met)
f(b)o(y)h(use)h(of)e(the)h Fw(MPI)p 1135 507 13 2 v 15
w(PCONTROL)p FA(.)249 632 y Fw(MPI)p 326 632 V 14 w(PCONTROL\(level,)g
Fp(:)7 b(:)g(:)e Fw(\))332 707 y Fv(IN)158 b Fw(level)471
b Fv(Pro\014ling)16 b(lev)o(el)249 817 y Fr(int)21 b(MPI)p
405 817 14 2 v 15 w(Pcontrol\(const)e(int)i(level,)g
Fp(:)7 b(:)g(:)e Fr(\))249 901 y(MPI)p 318 901 V 15 w
(PCONTROL\(level\))336 955 y(INTEGER)21 b(LEVEL)291 1039
y Fw(MPI)15 b FA(libraries)g(themselv)o(es)h(mak)o(e)e(no)i(use)g(of)f
(this)h(routine,)g(and)g(simply)e(return)i(imme-)249
1093 y(diately)i(to)g(the)h(user)g(co)q(de.)32 b(Ho)o(w)o(ev)o(er)19
b(the)g(presence)i(of)d(calls)g(to)g(this)g(routine)h(allo)o(ws)e(a)249
1147 y(pro\014ling)c(pac)o(k)n(age)g(to)h(b)q(e)h(explicitly)e(called)g
(b)o(y)h(the)g(user.)291 1201 y(Since)h Fw(MPI)f FA(has)h(no)g(con)o
(trol)g(of)f(the)h(implemen)o(tation)d(of)i(the)h(pro\014ling)f(co)q
(de,)i(The)f(MPI)249 1255 y(F)m(orum)10 b(w)o(as)h(unable)h(to)f(sp)q
(ecify)h(precisely)h(the)f(seman)o(tics)f(whic)o(h)h(will)e(b)q(e)i
(pro)o(vided)f(b)o(y)h(calls)249 1309 y(to)17 b Fw(MPI)p
380 1309 13 2 v 15 w(PCONTROL)p FA(.)f(This)h(v)n(agueness)i(extends)g
(to)e(the)h(n)o(um)o(b)q(er)f(of)g(argumen)o(ts)f(to)i(the)249
1363 y(function,)13 b(and)h(their)g(datat)o(yp)q(es.)291
1417 y(Ho)o(w)o(ev)o(er)i(to)f(pro)o(vide)h(some)f(lev)o(el)g(of)h(p)q
(ortabilit)o(y)e(of)h(user)i(co)q(des)g(to)f(di\013eren)o(t)g
(pro\014ling)249 1471 y(libraries,)j(the)g(MPI)f(F)m(orum)f(requested)j
(the)f(follo)o(wing)d(meanings)h(for)h(certain)h(v)n(alues)f(of)249
1525 y(lev)o(el.)249 1608 y Ft(\017)29 b Fr(level)21
b(=)g(0:)d FA(Pro\014ling)13 b(is)h(disabled.)249 1662
y Ft(\017)29 b Fr(level)21 b(=)g(1:)d FA(Pro\014ling)13
b(is)h(enabled)g(at)g(a)g(normal)d(default)j(lev)o(el)f(of)h(detail.)
249 1716 y Ft(\017)29 b Fr(level)21 b(=)g(2:)c FA(Pro\014le)c
(bu\013ers)g(are)g(\015ushed.)18 b(\(This)13 b(ma)o(y)d(b)q(e)j(a)e
(no-op)h(in)g(some)f(pro\014lers\).)249 1769 y Ft(\017)29
b FA(All)15 b(other)h(v)n(alues)f(of)g Fr(level)f FA(ha)o(v)o(e)i
(pro\014le)f(library)g(de\014ned)i(e\013ects)h(and)d(additional)f(ar-)
249 1823 y(gumen)o(ts.)291 1906 y(The)i(MPI)h(F)m(orum)d(also)i
(requested)i(that)e(the)h(default)f(state)h(after)g Fw(MPI)p
1474 1906 V 14 w(INIT)f FA(has)g(b)q(een)249 1960 y(called)f(is)g(for)g
(pro\014ling)g(to)g(b)q(e)h(enabled)g(at)f(the)h(normal)d(default)i
(lev)o(el.)23 b(\(i.e.)f(as)15 b(if)g Fw(MPI)p 1691 1960
V 14 w(P-)249 2014 y(CONTROL)i FA(had)g(just)g(b)q(een)h(called)f(with)
f(the)i(argumen)o(t)e(1\).)27 b(This)17 b(allo)o(ws)f(users)j(to)d
(link)249 2068 y(with)g(a)g(pro\014ling)f(library)h(and)g(obtain)g
(pro\014le)g(output)h(without)f(ha)o(ving)f(to)h(mo)q(dify)e(their)249
2122 y(source)h(co)q(de)g(at)f(all.)291 2176 y(The)f(pro)o(vision)f(of)
h Fw(MPI)p 676 2176 V 14 w(PCONTROL)f FA(as)i(a)e(no-op)h(in)g(the)g
(standard)h Fw(MPI)e FA(library)h(allo)o(ws)249 2230
y(users)g(to)f(mo)q(dify)d(their)j(source)h(co)q(de)g(to)e(obtain)g
(more)g(detailed)h(pro\014ling)e(information,)f(but)249
2284 y(still)k(b)q(e)i(able)e(to)h(link)f(exactly)h(the)g(same)f(co)q
(de)i(against)e(the)i(standard)f Fw(MPI)f FA(library)m(.)p
eop
%%Page: 306 320
306 319 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(306)1256 b(Chapter)13 b(8)249
507 y FD(8.4)52 b(Examples)249 615 y Fs(8.4.1)c(Pro\014ler)13
b(Implemen)o(tati)o(on)249 698 y FA(Supp)q(ose)18 b(that)e(the)h
(pro\014ler)g(wishes)g(to)g(accum)o(ulate)e(the)j(total)d(amoun)o(t)g
(of)h(data)g(sen)o(t)i(b)o(y)249 752 y(the)e Fr(MPI)p
391 752 14 2 v 15 w(Send\(\))e FA(function,)h(along)f(with)g(the)i
(total)f(elapsed)h(time)d(sp)q(en)o(t)k(in)d(the)i(function.)249
806 y(This)e(could)g(trivially)d(b)q(e)k(ac)o(hiev)o(ed)f(th)o(us)249
914 y Fr(static)21 b(int)g(totalBytes;)249 968 y(static)g(double)f
(totalTime;)249 1022 y(int)h(MPI_Send\(void)e(*)j(buffer,)e(const)h
(int)g(count,)g(MPI_Datatype)e(datatype,)532 1076 y(int)j(dest,)e(int)h
(tag,)g(MPI_comm)g(comm\))249 1130 y({)314 1184 y(double)g(tstart)g(=)g
(MPI_Wtime\(\);)150 b(/*)22 b(Pass)f(on)g(all)g(the)g(arguments)f(*/)
314 1238 y(int)i(extent;)314 1292 y(int)g(result)86 b(=)21
b(PMPI_Send\(buffer,c)o(ount,)o(datat)o(ype,d)o(est,)o(tag,c)o(omm\);)
314 1400 y(MPI_Type_size\(dataty)o(pe,&)o(exten)o(t\);)40
b(/*)22 b(Compute)e(size)h(*/)314 1454 y(totalBytes)f(+=)i(count)e(*)i
(extent;)314 1562 y(totalTime)42 b(+=)22 b(MPI_Wtime\(\))d(-)j(tstart;)
314 1670 y(return)f(result;)249 1724 y(})249 1807 y Fs(8.4.2)48
b Fw(MPI)15 b Fs(Library)f(Implemen)o(tati)o(on)249 1890
y FA(On)i(a)g(Unix)f(system,)h(in)f(whic)o(h)h(the)h
Fw(MPI)e FA(library)g(is)h(implemen)o(ted)d(in)j(C,)f(then)i(there)g
(are)249 1944 y(v)n(arious)9 b(p)q(ossible)g(options,)h(of)e(whic)o(h)i
(t)o(w)o(o)f(of)f(the)i(most)e(ob)o(vious)h(are)h(presen)o(ted)h(here.)
18 b(Whic)o(h)249 1998 y(is)c(b)q(etter)h(dep)q(ends)h(on)d(whether)j
(the)e(link)o(er)g(and)f(compiler)g(supp)q(ort)i(w)o(eak)e(sym)o(b)q
(ols.)249 2081 y Fs(Systems)e(With)f(W)l(eak)j(sym)o(b)q(ols)40
b FA(If)10 b(the)h(compiler)e(and)h(link)o(er)g(supp)q(ort)i(w)o(eak)e
(external)249 2135 y(sym)o(b)q(ols)i(\(e.g.)18 b(Solaris)13
b(2.x,)f(other)i(system)g(V.4)f(mac)o(hines\),)f(then)i(only)f(a)g
(single)h(library)f(is)249 2188 y(required)i(through)f(the)g(use)h(of)e
Fr(#pragma)21 b(weak)13 b FA(th)o(us)249 2284 y Fr(#pragma)20
b(weak)h(MPI_Send)g(=)g(PMPI_Send)249 2338 y(int)g(PMPI_Send\(/*)f
(appropriate)f(args)i(*/\))249 2392 y({)336 2446 y(/*)h(Useful)e
(content)h(*/)249 2500 y(})p eop
%%Page: 307 321
307 320 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 254 a Fv(The)13 b Fw(MPI)f Fv(Pro\014ling)k(In)o
(terface)968 b(307)249 466 y
 23592960 6606024 3289088 3289088 29601792 10853990 startTexFig
 249 466 a
%%BeginDocument: ../figures/prof-resolve-weak.ps
% Cookbook Example Program from First Printing, Revised 7 Jan 1985
% Program: Drawing Arrows     Number: 8
%-----------------------------------------------------------------------------
%
/arrowdict 13 dict def                      % Local storage for the procedure
					    % ``arrow.''
							
/arrow                                      % The procedure ``arrow'' adds an
  { arrowdict begin                         % arrow shape to the current path.
      /headlength exch def                  % It takes seven arguments: the x
      /halfheadthickness exch 2 div def     % and y coordinates of the tail
      /halfthickness exch 2 div def         % (imagine that a line has been
      /tipy exch def /tipx exch def         % drawn down the center of the
      /taily exch def /tailx exch def       % arrow from the tip to the tail,
					    % then x and y lie on this line),
					    % the x and y coordinates of the
					    % tip of the arrow, the thickness
					    % of the arrow in the tail
					    % portion, the thickness of the
					    % arrow at the widest part of the
					    % arrowhead and the length of the
					    % arrowhead.
							
      /dx tipx tailx sub def                % Compute the differences in x and
      /dy tipy taily sub def                % y for the tip and tail. These
      /arrowlength dx dx mul dy dy mul add  % will be used to compute the
	sqrt def                            % length of the arrow and to
      /angle dy dx atan def                 % compute the angle of direction
					    % that the arrow is facing with
					    % respect to the current user
					    % coordinate system origin.
      /base arrowlength headlength sub def  % Compute where the base of the
					    % arrowhead will be.
								
      /savematrix matrix currentmatrix def  % Save the current user coordinate
					    % system. We are using the same
					    % strategy to localize the effect
					    % of transformations as was used
					    % in the program to draw an
					    % ellipse.
      tailx taily translate                 % Translate to the starting point
					    % of the tail.
      angle rotate                          % Rotate the x-axis to correspond
					    % with the center line of the
					    % arrow.
      0 halfthickness neg moveto            % Add the arrow shape to the
					    % current path.
      base halfthickness neg lineto
      base halfheadthickness neg lineto
      arrowlength 0 lineto
      base halfheadthickness lineto
      base halfthickness lineto
      0 halfthickness lineto
      closepath
	       
      savematrix setmatrix                  % Restore the current user
					    % coordinate system.
    end
  } def

/Box{   % left bottom width height
  4 -2 roll 
  moveto 
  dup 0 exch rlineto % up
  exch 0 rlineto     % right
  neg 0 exch rlineto % down
  closepath          % left
} def

/Cstring{  % string x-center y-center
  3 -1 roll dup stringwidth pop 4 -1 roll exch 2 div sub 3 -1 roll moveto show
} def

/Bwidth 80 def
/B1 100 def
/B2 70 def
/B3 100 def
/Off1 160 def
/Off2 {Off1 2 mul} def

0 setlinecap 0 setlinejoin

50 50 translate

/Helvetica findfont 12 scalefont setfont
0 0 Bwidth B1 Box stroke
(Application) Bwidth 2 div B1 5 add Cstring
6 B1 .66 mul moveto (MPI_Send) show
6 B1 .10 mul moveto (MPI_Bcast) show

Off1 B1 B2 sub Bwidth B2 Box stroke
(prof library) Off1 Bwidth 2 div add B1 5 add Cstring
Off1 6 add B1 .66 mul moveto (MPI_Send) show

Off1 6 add (MPI_Send) stringwidth pop 2 div add B1 .66 mul 4 sub
Off1 6 add (MPI_Send) stringwidth pop 2 div add B1 .66 mul 18 sub
1 6 7 arrow gsave 0 setgray fill grestore stroke
Off1 15 add B1 .66 mul 30 sub moveto (PMPI_Send) show

Off2 B1 B3 sub Bwidth B3 Box stroke
(mpi library) Off2 Bwidth 2 div add B1 5 add Cstring
Off2 6 add B1 .66 mul 30 sub moveto (PMPI_Send) show
Off2 6 add B1 .10 mul moveto (PMPI_Bcast) show

(MPI_Bcast) stringwidth pop 6 add 3 add
dup B1 .66 mul 3 add dup Off1 2 sub exch 1 6 7 arrow 
gsave 0 setgray fill grestore stroke
dup B1 .10 mul 3 add dup Off2 2 sub exch 1 6 7 arrow 
gsave 0 setgray fill grestore stroke
(PMPI_Send) stringwidth pop 15 add 3 add Off1 add
dup B1 .66 mul 3 add 30 sub dup Off2 2 sub exch 1 6 7 arrow 
gsave 0 setgray fill grestore stroke

%%EndDocument

 endTexFig
 249 946 a Fo(Figure)13 b(8.1)249 984 y Fz(Resolution)c(of)i
Fw(MPI)h Fz(calls)e(on)h(systems)f(with)h(w)o(eak)h(links.)291
1107 y FA(The)j(e\013ect)i(of)e(this)g Fr(#pragma)f FA(is)h(to)g
(de\014ne)i(the)e(external)h(sym)o(b)q(ol)e Fr(MPI)p
1451 1107 14 2 v 15 w(Send)g FA(as)i(a)f(w)o(eak)249
1160 y(de\014nition.)29 b(This)18 b(means)f(that)h(the)g(link)o(er)g
(will)e(not)i(complain)d(if)i(there)j(is)d(another)h(def-)249
1214 y(inition)f(of)i(the)g(sym)o(b)q(ol)e(\(for)h(instance)i(in)e(the)
i(pro\014ling)d(library\),)i(ho)o(w)o(ev)o(er)g(if)f(no)h(other)249
1268 y(de\014nition)12 b(exists,)h(then)g(the)g(link)o(er)f(will)f(use)
i(the)g(w)o(eak)f(de\014nition.)17 b(This)12 b(t)o(yp)q(e)h(of)f
(situation)249 1322 y(is)i(illustrated)g(in)g(Fig.)f(8.1,)g(in)h(whic)o
(h)g(a)g(pro\014ling)f(library)g(has)i(b)q(een)g(written)g(that)f
(pro\014les)249 1376 y(calls)f(to)g Fr(MPI)p 460 1376
V 15 w(Send\(\))f FA(but)h(not)g(calls)g(to)g Fr(MPI)p
975 1376 V 15 w(Bcast\(\))p FA(.)k(On)c(systems)g(with)g(w)o(eak)g
(links)g(the)249 1430 y(link)g(step)i(for)e(an)h(application)e(w)o
(ould)i(b)q(e)g(something)f(lik)o(e)249 1526 y Fr(\045)22
b(cc)f(...)g(-lprof)g(-lmpi)291 1621 y FA(References)15
b(to)e Fr(MPI)p 614 1621 V 15 w(Send\(\))g FA(are)g(resolv)o(ed)h(in)f
(the)h(pro\014ling)f(library)m(,)f(where)i(the)g(routine)249
1675 y(then)h(calls)e Fr(PMPI)p 527 1675 V 15 w(Send\(\))g
FA(whic)o(h)h(is)g(resolv)o(ed)g(in)g(the)g Fw(MPI)g
FA(library)m(.)j(In)d(this)g(case)h(the)g(w)o(eak)249
1729 y(link)d(to)h Fr(PMPI)p 471 1729 V 15 w(Send\(\))f
FA(is)h(ignored.)18 b(Ho)o(w)o(ev)o(er,)13 b(since)h
Fr(MPI)p 1180 1729 V 16 w(Bcast\(\))d FA(is)i(not)h(included)f(in)g
(the)249 1783 y(pro\014ling)i(library)m(,)h(references)j(to)d(it)g(are)
h(resolv)o(ed)g(via)e(a)h(w)o(eak)h(link)e(to)h Fr(PMPI)p
1528 1783 V 15 w(Bcast\(\))f FA(in)249 1837 y(the)g Fw(MPI)e
FA(library)m(.)249 1920 y Fs(Systems)19 b(without)g(W)l(eak)i(Sym)o(b)q
(ols)39 b FA(In)18 b(the)h(absence)g(of)e(w)o(eak)h(sym)o(b)q(ols)f
(then)h(one)249 1974 y(p)q(ossible)c(solution)f(w)o(ould)g(b)q(e)i(to)f
(use)g(the)h(C)f(macro)e(pre-pro)q(cessor)17 b(th)o(us)249
2070 y Fr(#ifdef)k(PROFILELIB)249 2124 y(#)87 b(ifdef)21
b(__STDC__)249 2177 y(#)174 b(define)21 b(FUNCTION\(name\))e(P##name)
249 2231 y(#)87 b(else)249 2285 y(#)174 b(define)21 b(FUNCTION\(name\))
e(P/**/name)249 2339 y(#)87 b(endif)249 2393 y(#else)249
2447 y(#)g(define)21 b(FUNCTION\(name\))d(name)249 2501
y(#endif)p eop
%%Page: 308 322
308 321 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(308)1256 b(Chapter)13 b(8)249
466 y
 23592960 8965320 3289088 3289088 29601792 13485260 startTexFig
 249 466 a
%%BeginDocument: ../figures/prof-resolve-noweak.ps
% Cookbook Example Program from First Printing, Revised 7 Jan 1985
% Program: Drawing Arrows     Number: 8
%-----------------------------------------------------------------------------
%
/arrowdict 13 dict def                      % Local storage for the procedure
					    % ``arrow.''
							
/arrow                                      % The procedure ``arrow'' adds an
  { arrowdict begin                         % arrow shape to the current path.
      /headlength exch def                  % It takes seven arguments: the x
      /halfheadthickness exch 2 div def     % and y coordinates of the tail
      /halfthickness exch 2 div def         % (imagine that a line has been
      /tipy exch def /tipx exch def         % drawn down the center of the
      /taily exch def /tailx exch def       % arrow from the tip to the tail,
					    % then x and y lie on this line),
					    % the x and y coordinates of the
					    % tip of the arrow, the thickness
					    % of the arrow in the tail
					    % portion, the thickness of the
					    % arrow at the widest part of the
					    % arrowhead and the length of the
					    % arrowhead.
							
      /dx tipx tailx sub def                % Compute the differences in x and
      /dy tipy taily sub def                % y for the tip and tail. These
      /arrowlength dx dx mul dy dy mul add  % will be used to compute the
	sqrt def                            % length of the arrow and to
      /angle dy dx atan def                 % compute the angle of direction
					    % that the arrow is facing with
					    % respect to the current user
					    % coordinate system origin.
      /base arrowlength headlength sub def  % Compute where the base of the
					    % arrowhead will be.
								
      /savematrix matrix currentmatrix def  % Save the current user coordinate
					    % system. We are using the same
					    % strategy to localize the effect
					    % of transformations as was used
					    % in the program to draw an
					    % ellipse.
      tailx taily translate                 % Translate to the starting point
					    % of the tail.
      angle rotate                          % Rotate the x-axis to correspond
					    % with the center line of the
					    % arrow.
      0 halfthickness neg moveto            % Add the arrow shape to the
					    % current path.
      base halfthickness neg lineto
      base halfheadthickness neg lineto
      arrowlength 0 lineto
      base halfheadthickness lineto
      base halfthickness lineto
      0 halfthickness lineto
      closepath
	       
      savematrix setmatrix                  % Restore the current user
					    % coordinate system.
    end
  } def

/Box{   % left bottom width height
  4 -2 roll 
  moveto 
  dup 0 exch rlineto % up
  exch 0 rlineto     % right
  neg 0 exch rlineto % down
  closepath          % left
} def

/Cstring{  % string x-center y-center
  3 -1 roll dup stringwidth pop 4 -1 roll exch 2 div sub 3 -1 roll moveto show
} def

/Bwidth 80 def
/B2 50 def
/B3 50 def
/B4 50 def
/B1 140 def
/Off1 160 def
/Off2 {Off1 2 mul} def

0 setlinecap 0 setlinejoin

50 50 translate

/Helvetica findfont 12 scalefont setfont
0 0 Bwidth B1 Box stroke
(Application) Bwidth 2 div B1 5 add Cstring
6 B1 .90 mul moveto (MPI_Send) show
6 B1 .10 mul moveto (MPI_Bcast) show

Off1 B1 B2 sub Bwidth B2 Box stroke
(prof library) Off1 Bwidth 2 div add B1 5 add Cstring
Off1 6 add B1 .90 mul moveto (MPI_Send) show

Off1 6 add (MPI_Send) stringwidth pop 2 div add B1 .90 mul 4 sub
Off1 6 add (MPI_Send) stringwidth pop 2 div add B1 .90 mul 18 sub
1 6 7 arrow gsave 0 setgray fill grestore stroke
Off1 15 add B1 .90 mul 30 sub moveto (PMPI_Send) show

Off2 B1 B3 sub Bwidth B3 Box stroke
(pmpi library) Off2 Bwidth 2 div add B1 5 add Cstring
Off2 6 add B1 .90 mul 30 sub moveto (PMPI_Send) show

Off2 B1 B3 sub B4 sub 40 sub Bwidth B3 Box stroke
(mpi library) Off2 Bwidth 2 div add B4 5 add Cstring
Off2 6 add B1 .10 mul moveto (MPI_Bcast) show

(MPI_Bcast) stringwidth pop 6 add 3 add
dup B1 .90 mul 3 add dup Off1 2 sub exch 1 6 7 arrow 
gsave 0 setgray fill grestore stroke
dup B1 .10 mul 3 add dup Off2 2 sub exch 1 6 7 arrow 
gsave 0 setgray fill grestore stroke
(PMPI_Send) stringwidth pop 15 add 3 add Off1 add
dup B1 .90 mul 3 add 30 sub dup Off2 2 sub exch 1 6 7 arrow 
gsave 0 setgray fill grestore stroke

%%EndDocument

 endTexFig
 249 1096 a Fo(Figure)g(8.2)249 1133 y Fz(Resolution)c(of)i
Fw(MPI)h Fz(calls)e(on)h(systems)f(without)g(w)o(eak)i(links.)291
1256 y FA(Eac)o(h)i(of)f(the)i(user)g(visible)e(functions)h(in)f(the)i
(library)e(w)o(ould)g(then)h(b)q(e)h(declared)g(th)o(us)249
1351 y Fr(int)21 b(FUNCTION\(MPI_Send\)\()o(/*)e(appropriate)g(args)i
(*/\))249 1405 y({)336 1459 y(/*)h(Useful)e(content)h(*/)249
1513 y(})291 1609 y FA(The)c(same)f(source)j(\014le)e(can)g(then)h(b)q
(e)g(compiled)d(to)i(pro)q(duce)i(the)e Fw(MPI)g FA(and)g(the)h
Fw(PMPI)249 1663 y FA(v)o(ersions)c(of)g(the)g(library)m(,)e(dep)q
(ending)j(on)f(the)g(state)h(of)e(the)i Fr(PROFILELIB)c
FA(macro)i(sym)o(b)q(ol.)291 1717 y(It)19 b(is)g(required)h(that)g(the)
g(standard)f Fw(MPI)g FA(library)f(b)q(e)i(built)f(in)g(suc)o(h)h(a)f
(w)o(a)o(y)f(that)i(the)249 1771 y(inclusion)e(of)h Fw(MPI)f
FA(functions)i(can)f(b)q(e)h(ac)o(hiev)o(ed)f(one)g(at)g(a)g(time.)33
b(This)19 b(is)g(a)f(somewhat)249 1825 y(unpleasan)o(t)e(requiremen)o
(t,)g(since)h(it)e(ma)o(y)f(mean)h(that)h(eac)o(h)h(external)f
(function)g(has)g(to)g(b)q(e)249 1879 y(compiled)d(from)g(a)i(separate)
h(\014le.)k(Ho)o(w)o(ev)o(er)c(this)e(is)h(necessary)i(so)e(that)g(the)
g(author)g(of)f(the)249 1933 y(pro\014ling)i(library)f(need)j(only)e
(de\014ne)h(those)g Fw(MPI)f FA(functions)h(that)g(are)f(to)h(b)q(e)g
(in)o(tercepted,)249 1987 y(references)i(to)e(an)o(y)f(others)h(b)q
(eing)g(ful\014lled)e(b)o(y)i(the)g(normal)d Fw(MPI)i
FA(library)m(.)25 b(Therefore)18 b(the)249 2041 y(link)13
b(step)i(can)f(lo)q(ok)f(something)f(lik)o(e)i(this)249
2136 y Fr(\045)22 b(cc)f(...)g(-lprof)g(-lpmpi)f(-lmpi)291
2231 y FA(Here)15 b Fr(libprof.a)c FA(con)o(tains)j(the)g(pro\014ler)g
(functions)g(whic)o(h)g(in)o(tercept)h(some)e(of)g(the)h
Fw(MPI)249 2285 y FA(functions.)27 b Fr(libpmpi.a)15
b FA(con)o(tains)i(the)h(\\name)d(shifted")i Fw(MPI)f
FA(functions,)h(and)g Fr(libmpi.a)249 2339 y FA(con)o(tains)g(the)i
(normal)c(de\014nitions)i(of)g(the)h Fw(MPI)f FA(functions.)29
b(Th)o(us,)18 b(on)f(systems)h(without)249 2393 y(w)o(eak)c(links)f
(the)i(example)d(sho)o(wn)i(in)g(Fig.)e(8.1)h(w)o(ould)g(b)q(e)i
(resolv)o(ed)f(as)g(sho)o(wn)g(in)f(Fig.)g(8.2)p eop
%%Page: 309 323
309 322 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 254 a Fv(The)13 b Fw(MPI)f Fv(Pro\014ling)k(In)o
(terface)968 b(309)249 507 y Fs(8.4.3)48 b(Complications)249
590 y(Multiple)17 b(Coun)o(ting)39 b FA(Since)19 b(parts)f(of)g(the)g
Fw(MPI)f FA(library)h(ma)o(y)e(themselv)o(es)i(b)q(e)g(imple-)249
644 y(men)o(ted)h(using)f(more)g(basic)i Fw(MPI)e FA(functions)h
(\(e.g.)33 b(a)19 b(p)q(ortable)g(implemen)o(tatio)o(n)d(of)j(the)249
698 y(collectiv)o(e)d(op)q(erations)h(implemen)o(ted)d(using)i(p)q(oin)
o(t)g(to)g(p)q(oin)o(t)g(comm)o(unications\),)e(there)k(is)249
752 y(p)q(oten)o(tial)11 b(for)g(pro\014ling)f(functions)i(to)f(b)q(e)h
(called)f(from)f(within)g(an)h Fw(MPI)g FA(function)g(whic)o(h)h(w)o
(as)249 806 y(called)j(from)e(a)h(pro\014ling)g(function.)20
b(This)15 b(could)f(lead)h(to)g(\\double)f(coun)o(ting")g(of)g(the)i
(time)249 860 y(sp)q(en)o(t)i(in)f(the)g(inner)h(routine.)27
b(Since)18 b(this)f(e\013ect)i(could)e(actually)f(b)q(e)h(useful)g
(under)h(some)249 914 y(circumstances)e(\(e.g.)21 b(it)14
b(migh)o(t)f(allo)o(w)g(one)i(to)g(answ)o(er)g(the)h(question)f(\\Ho)o
(w)f(m)o(uc)o(h)g(time)g(is)249 968 y(sp)q(en)o(t)j(in)f(the)h(p)q(oin)
o(t)f(to)g(p)q(oin)o(t)f(routines)i(when)g(they're)g(called)f(from)e
(collectiv)o(e)i(functions)249 1022 y(?"\),)10 b(the)h(MPI)g(F)m(orum)d
(decided)k(not)e(to)g(enforce)h(an)o(y)f(restrictions)i(on)e(the)h
(author)f(of)g(the)h Fw(MPI)249 1076 y FA(library)16
b(whic)o(h)g(w)o(ould)f(o)o(v)o(ercome)h(this.)25 b(Therefore,)18
b(the)f(author)f(of)g(the)h(pro\014ling)e(library)249
1130 y(should)g(b)q(e)g(a)o(w)o(are)f(of)g(this)h(problem,)e(and)i
(guard)f(against)g(it.)20 b(In)15 b(a)f(single)g(threaded)i(w)o(orld)
249 1184 y(this)g(is)f(easily)h(ac)o(hiev)o(ed)g(through)g(use)g(of)f
(a)h(static)g(v)n(ariable)f(in)g(the)h(pro\014ling)f(co)q(de)i(whic)o
(h)249 1238 y(remem)o(b)q(ers)d(if)g(y)o(ou)h(are)g(already)g(inside)f
(a)h(pro\014ling)f(routine.)21 b(It)15 b(b)q(ecomes)g(more)f(complex)
249 1292 y(in)f(a)h(m)o(ulti-threaded)f(en)o(vironmen)o(t)g(\(as)h(do)q
(es)g(the)h(meaning)d(of)h(the)i(times)d(recorded!\))249
1375 y Fs(Link)o(er)j(Oddities)38 b FA(The)15 b(Unix)f(link)o(er)h
(traditionally)d(op)q(erates)k(in)f(one)g(pass.)21 b(The)15
b(e\013ect)249 1429 y(of)h(this)h(is)g(that)g(functions)g(from)e
(libraries)h(are)i(only)e(included)h(in)f(the)i(image)d(if)h(they)h
(are)249 1483 y(needed)i(at)f(the)h(time)d(the)j(library)e(is)h
(scanned.)31 b(When)18 b(com)o(bined)f(with)h(w)o(eak)f(sym)o(b)q(ols,)
249 1537 y(or)e(m)o(ultiple)e(de\014nitions)i(of)g(the)g(same)g
(function,)f(this)h(can)h(cause)g(o)q(dd)f(\(and)g(unexp)q(ected\))249
1591 y(e\013ects.)291 1645 y(Consider,)d(for)f(instance,)h(an)g
(implemen)o(tatio)o(n)d(of)i Fw(MPI)g FA(in)g(whic)o(h)h(the)g(F)m
(ortran)g(binding)f(is)249 1699 y(ac)o(hiev)o(ed)k(b)o(y)f(using)g
(wrapp)q(er)h(functions)g(on)f(top)g(of)g(the)h(C)g(implem)o(en)o
(tation.)i(The)d(author)249 1753 y(of)f(the)h(pro\014le)f(library)g
(then)g(assumes)h(that)f(it)g(is)g(reasonable)h(to)f(pro)o(vide)g
(pro\014le)g(functions)249 1807 y(only)g(for)g(the)i(C)e(binding,)g
(since)h(F)m(ortran)g(will)e(ev)o(en)o(tually)h(call)g(these,)i(and)e
(the)h(cost)h(of)e(the)249 1861 y(wrapp)q(ers)i(is)e(assumed)h(to)f(b)q
(e)h(small.)i(Ho)o(w)o(ev)o(er,)d(if)g(the)h(wrapp)q(er)h(functions)e
(are)h(not)g(in)f(the)249 1914 y(pro\014ling)g(library)m(,)f(then)j
(none)f(of)g(the)g(pro\014led)g(en)o(try)h(p)q(oin)o(ts)f(will)e(b)q(e)
j(unde\014ned)g(when)g(the)249 1968 y(pro\014ling)f(library)h(is)g
(called.)21 b(Therefore)16 b(none)g(of)e(the)i(pro\014ling)e(co)q(de)i
(will)e(b)q(e)i(included)f(in)249 2022 y(the)h(image.)21
b(When)15 b(the)h(standard)g Fw(MPI)f FA(library)f(is)i(scanned,)g(the)
g(F)m(ortran)f(wrapp)q(ers)i(will)249 2076 y(b)q(e)12
b(resolv)o(ed,)g(and)f(will)f(also)h(pull)g(in)g(the)h(base)g(v)o
(ersions)g(of)f(the)h Fw(MPI)e FA(functions.)18 b(The)12
b(o)o(v)o(erall)249 2130 y(e\013ect)k(is)d(that)h(the)h(co)q(de)f(will)
f(link)g(successfully)m(,)h(but)g(will)e(not)i(b)q(e)h(pro\014led.)291
2184 y(T)m(o)9 b(o)o(v)o(ercome)h(this)h(w)o(e)g(m)o(ust)e(ensure)k
(that)d(the)i(F)m(ortran)e(wrapp)q(er)i(functions)e(are)h(included)249
2238 y(in)j(the)i(pro\014ling)d(v)o(ersion)i(of)f(the)h(library)m(.)20
b(W)m(e)14 b(ensure)i(that)f(this)g(is)f(p)q(ossible)h(b)o(y)g
(requiring)249 2292 y(that)f(these)h(b)q(e)g(separable)f(from)e(the)j
(rest)g(of)e(the)i(base)f Fw(MPI)f FA(library)m(.)k(This)d(allo)o(ws)e
(them)i(to)249 2346 y(b)q(e)h(extracted)h(out)e(of)f(the)i(base)g
(library)e(and)h(placed)g(in)o(to)g(the)g(pro\014ling)g(library)f
(using)h(the)249 2400 y(Unix)g Fr(ar)f FA(command.)p
eop
%%Page: 310 324
310 323 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(310)1256 b(Chapter)13 b(8)249
507 y FD(8.5)52 b(Multiple)19 b(Lev)o(els)e(of)h(In)o(terception)249
615 y FA(The)c(sc)o(heme)f(giv)o(en)g(here)i(do)q(es)f(not)f(directly)h
(supp)q(ort)g(the)g(nesting)g(of)e(pro\014ling)h(functions,)249
669 y(since)k(it)f(pro)o(vides)h(only)e(a)h(single)g(alternativ)o(e)h
(name)e(for)h(eac)o(h)h Fw(MPI)e FA(function.)25 b(The)17
b(MPI)249 723 y(F)m(orum)c(ga)o(v)o(e)g(consideration)i(to)f(an)g
(implem)o(en)o(tation)d(whic)o(h)j(w)o(ould)g(allo)o(w)e(m)o(ultiple)g
(lev)o(els)249 777 y(of)i(call)f(in)o(terception;)h(ho)o(w)o(ev)o(er,)g
(it)g(w)o(as)g(unable)g(to)g(construct)i(an)d(implemen)o(tation)e(of)i
(this)249 831 y(whic)o(h)h(did)f(not)h(ha)o(v)o(e)g(the)g(follo)o(wing)
e(disadv)n(an)o(tages)249 914 y Ft(\017)29 b FA(assuming)12
b(a)i(particular)f(implemen)o(tation)e(language.)249
968 y Ft(\017)29 b FA(imp)q(osing)12 b(a)h(run)h(time)f(cost)h(ev)o(en)
h(when)f(no)g(pro\014ling)f(w)o(as)h(taking)f(place.)249
1051 y(Since)d(one)f(of)g(the)h(ob)r(jectiv)o(es)g(of)f
Fw(MPI)f FA(is)h(to)h(p)q(ermit)e(e\016cien)o(t,)i(lo)o(w)f(latency)g
(implemen)o(tatio)o(ns,)249 1105 y(and)19 b(it)g(is)g(not)g(the)h
(business)g(of)f(a)g(standard)g(to)g(require)h(a)f(particular)g
(implemen)o(tatio)o(n)249 1159 y(language,)13 b(the)h(MPI)g(F)m(orum)e
(decided)j(to)f(accept)h(the)g(sc)o(heme)f(outlined)f(ab)q(o)o(v)o(e.)
291 1213 y(Note,)g(ho)o(w)o(ev)o(er,)g(that)g(it)g(is)f(p)q(ossible)i
(to)f(use)g(the)h(sc)o(heme)f(ab)q(o)o(v)o(e)g(to)g(implemen)o(t)d(a)j
(m)o(ulti-)249 1267 y(lev)o(el)g(system,)f(since)i(the)f(function)g
(called)f(b)o(y)h(the)h(user)g(ma)o(y)c(call)j(man)o(y)e(di\013eren)o
(t)i(pro\014ling)249 1321 y(functions)h(b)q(efore)h(calling)d(the)j
(underlying)e Fw(MPI)g FA(function.)291 1375 y(Unfortunately)k(suc)o(h)
i(an)e(implemen)o(tatio)o(n)e(ma)o(y)h(require)i(more)f(co)q(op)q
(eration)h(b)q(et)o(w)o(een)249 1429 y(the)d(di\013eren)o(t)h
(pro\014ling)d(libraries)h(than)h(is)f(required)h(for)g(the)g(single)f
(lev)o(el)g(implemen)o(tatio)o(n)249 1483 y(detailed)g(ab)q(o)o(v)o(e.)
p eop
%%Page: 311 325
311 324 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 325 a Fu(9)25 b FD(Conclusions)264 507
y FA(This)14 b(b)q(o)q(ok)g(has)h(attempted)f(to)h(giv)o(e)f(a)g
(complete)g(description)h(of)f(the)h Fw(MPI)f FA(sp)q(eci\014cation,)
249 561 y(and)i(includes)h(co)q(de)f(examples)g(to)g(illustrate)f(asp)q
(ects)j(of)e(the)g(use)h(of)f Fw(MPI)p FA(.)f(After)i(reading)249
615 y(the)e(preceding)g(c)o(hapters)g(programmers)d(should)i(feel)g
(comfortable)e(using)i Fw(MPI)g FA(to)f(dev)o(elop)249
669 y(message-passing)i(applications.)22 b(This)16 b(\014nal)e(c)o
(hapter)j(addresses)h(some)c(imp)q(ortan)o(t)g(topics)249
723 y(that)c(either)h(do)e(not)h(easily)f(\014t)h(in)o(to)g(the)g
(other)h(c)o(hapters,)g(or)f(whic)o(h)g(are)g(b)q(est)h(dealt)f(with)f
(after)249 777 y(a)14 b(go)q(o)q(d)g(o)o(v)o(erall)g(understanding)h
(of)f Fw(MPI)f FA(has)i(b)q(een)h(gained.)j(These)d(topics)f(are)f
(concerned)249 831 y(more)9 b(with)g(the)i(in)o(terpretation)f(of)f
(the)i Fw(MPI)e FA(sp)q(eci\014cation,)i(and)f(the)g(rationale)f(b)q
(ehind)h(some)249 885 y(asp)q(ects)16 b(of)d(its)h(design,)g(rather)g
(than)g(with)g(seman)o(tics)f(and)h(syn)o(tax.)k(F)m(uture)d
(extensions)g(to)249 939 y Fw(MPI)e FA(and)h(the)g(curren)o(t)i(status)
f(of)e Fw(MPI)g FA(implemen)o(tatio)o(ns)f(will)g(also)h(b)q(e)i
(discussed.)249 1059 y FD(9.1)52 b(Design)18 b(Issues)249
1167 y Fs(9.1.1)48 b(Wh)o(y)16 b(is)f Fw(MPI)g Fs(so)g(big?)249
1250 y FA(One)21 b(asp)q(ect)g(of)f(concern,)j(particularly)c(to)h(no)o
(vices,)h(is)f(the)h(large)f(n)o(um)o(b)q(er)f(of)h(routines)249
1304 y(comprising)15 b(the)j Fw(MPI)e FA(sp)q(eci\014cation.)29
b(In)17 b(all)e(there)k(are)e(128)f Fw(MPI)h FA(routines,)h(and)f
(further)249 1358 y(extensions)i(\(see)g(Section)g(9.5\))e(will)f
(probably)h(increase)j(their)e(n)o(um)o(b)q(er.)29 b(There)20
b(are)e(t)o(w)o(o)249 1412 y(fundamen)o(tal)11 b(reasons)k(for)e(the)h
(size)g(of)f Fw(MPI)p FA(.)f(The)i(\014rst)g(reason)g(is)f(that)h
Fw(MPI)e FA(w)o(as)i(designed)249 1466 y(to)e(b)q(e)h(ric)o(h)g(in)f
(functionalit)o(y)m(.)k(This)c(is)g(re\015ected)j(in)d
Fw(MPI)p FA('s)g(supp)q(ort)h(for)f(deriv)o(ed)h(datat)o(yp)q(es,)249
1520 y(mo)q(dular)k(comm)o(unication)f(via)i(the)i(comm)o(unicator)d
(abstraction,)j(cac)o(hing,)g(application)249 1574 y(top)q(ologies,)e
(and)g(the)h(fully-featured)f(set)h(of)f(collectiv)o(e)g(comm)o
(unication)d(routines.)32 b(The)249 1628 y(second)17
b(reason)g(for)f(the)h(size)g(of)f Fw(MPI)f FA(re\015ects)k(the)e(div)o
(ersit)o(y)f(and)g(complexit)o(y)e(of)i(to)q(da)o(y's)249
1682 y(high)g(p)q(erformance)g(computers.)25 b(This)16
b(is)g(particularly)g(true)h(with)f(resp)q(ect)i(to)e(the)h(p)q(oin)o
(t-)249 1736 y(to-p)q(oin)o(t)i(comm)o(unicati)o(on)e(routines)j(where)
g(the)g(di\013eren)o(t)g(comm)o(unication)c(mo)q(des)j(\(see)249
1790 y(Sections)12 b(2.1)e(and)g(2.13\))g(arise)h(mainly)e(as)i(a)f
(means)g(of)h(pro)o(viding)e(a)i(set)h(of)e(the)h(most)f(widely-)249
1844 y(used)h(comm)o(unicatio)o(n)c(proto)q(cols.)17
b(F)m(or)10 b(example,)f(the)h(sync)o(hronous)h(comm)o(unication)6
b(mo)q(de)249 1898 y(corresp)q(onds)16 b(closely)d(to)g(a)g(proto)q
(col)h(that)f(minimi)o(zes)f(the)i(cop)o(ying)f(and)g(bu\013ering)h(of)
f(data)249 1952 y(through)18 b(a)g(rendezv)o(ous)i(mec)o(hanism.)29
b(A)18 b(proto)q(col)g(that)g(attempts)g(to)g(initiate)g(deliv)o(ery)
249 2006 y(of)h(messages)i(as)f(so)q(on)g(as)g(p)q(ossible)g(w)o(ould)f
(pro)o(vide)h(bu\013ering)h(for)e(messages,)i(and)f(this)249
2060 y(corresp)q(onds)c(closely)e(to)g(the)h(bu\013ered)g(comm)o
(unication)c(mo)q(de)i(\(or)h(the)h(standard)f(mo)q(de)f(if)249
2114 y(this)j(is)h(implem)o(en)o(ted)e(with)h(su\016cien)o(t)h
(bu\013ering\).)26 b(One)17 b(could)f(decrease)i(the)f(n)o(um)o(b)q(er)
f(of)249 2168 y(functions)e(b)o(y)g(increasing)h(the)f(n)o(um)o(b)q(er)
g(of)f(parameters)h(in)g(eac)o(h)h(call.)j(But)d(suc)o(h)f(approac)o(h)
249 2222 y(w)o(ould)c(increase)j(the)f(call)e(o)o(v)o(erhead)h(and)g(w)
o(ould)g(mak)o(e)f(the)h(use)h(of)f(the)h(most)e(prev)n(alen)o(t)h
(calls)249 2276 y(more)f(complex.)16 b(The)c(a)o(v)n(ailabilit)o(y)c
(of)j(a)g(large)g(n)o(um)o(b)q(er)f(of)h(calls)g(to)g(deal)h(with)f
(more)f(esoteric)249 2330 y(features)i(of)e Fw(MPI)f
FA(allo)o(ws)h(one)g(to)h(pro)o(vide)f(a)g(simpler)g(in)o(terface)h(to)
f(the)h(more)f(frequen)o(tly)h(used)249 2384 y(functions.)965
2613 y(311)p eop
%%Page: 312 326
312 325 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(312)1256 b(Chapter)13 b(9)249
507 y Fs(9.1.2)48 b(Should)13 b(w)o(e)j(b)q(e)g(concerned)e(ab)q(out)h
(the)g(size)g(of)g Fw(MPI)p Fs(?)249 590 y FA(There)22
b(are)f(t)o(w)o(o)f(p)q(oten)o(tial)f(reasons)j(wh)o(y)e(w)o(e)h(migh)o
(t)d(b)q(e)j(concerned)h(ab)q(out)f(the)g(size)g(of)249
644 y Fw(MPI)p FA(.)12 b(The)h(\014rst)g(is)f(that)h(p)q(oten)o(tial)f
(users)i(migh)o(t)c(equate)k(size)f(with)f(complexit)o(y)f(and)h
(decide)249 698 y(that)i Fw(MPI)g FA(is)g(to)q(o)g(complicated)f(to)h
(b)q(other)h(learning.)j(The)c(second)i(is)e(that)g(v)o(endors)h(migh)o
(t)249 752 y(decide)e(that)f Fw(MPI)g FA(is)g(to)q(o)g(di\016cult)g(to)
g(implem)o(en)o(t.)j(The)e(design)f(of)g Fw(MPI)f FA(addresses)k(the)e
(\014rst)249 806 y(of)h(these)i(concerns)g(b)o(y)e(adopting)f(a)h(la)o
(y)o(ered)h(approac)o(h.)k(F)m(or)14 b(example,)f(no)o(vices)h(can)h(a)
o(v)o(oid)249 860 y(ha)o(ving)10 b(to)g(w)o(orry)h(ab)q(out)f(groups)h
(and)g(comm)o(unicators)d(b)o(y)i(p)q(erforming)f(all)h(comm)o
(unicatio)o(n)249 914 y(in)15 b(the)g(pre-de\014ned)i(comm)o(unicator)
12 b Fr(MPI)p 928 914 14 2 v 15 w(COMM)p 1031 914 V 15
w(WORLD)p FA(.)i(In)h(fact,)f(most)g(existing)h(message-)249
968 y(passing)c(applications)g(can)h(b)q(e)g(p)q(orted)g(to)g
Fw(MPI)e FA(simply)g(b)o(y)h(con)o(v)o(erting)h(the)g(comm)o(unicatio)o
(n)249 1022 y(routines)18 b(on)g(a)f(one-for-one)g(basis)h(\(although)f
(the)h(resulting)g Fw(MPI)f FA(application)f(ma)o(y)g(not)249
1076 y(b)q(e)i(optimally)13 b(e\016cien)o(t\).)28 b(T)m(o)17
b(alla)o(y)e(the)i(concerns)i(of)e(p)q(oten)o(tial)f(implemen)o(tors)f
(the)i Fw(MPI)249 1130 y FA(F)m(orum)f(at)i(one)g(stage)g(considered)i
(de\014ning)d(a)h(core)h(subset)g(of)e Fw(MPI)g FA(kno)o(wn)h(as)g(the)
g Fw(MPI)249 1184 y FA(subset)h(that)e(w)o(ould)g(b)q(e)g(substan)o
(tially)g(smaller)e(than)j Fw(MPI)e FA(and)h(include)h(just)f(the)h(p)q
(oin)o(t-)249 1238 y(to-p)q(oin)o(t)d(comm)o(uni)o(cation)d(routines)k
(and)f(a)g(few)g(of)g(the)h(more)e(commonly)o(-used)f(collectiv)o(e)249
1292 y(comm)o(unication)i(routines.)33 b(Ho)o(w)o(ev)o(er,)19
b(early)g(w)o(ork)f(b)o(y)g(Lusk,)i(Gropp,)f(Skjellum,)e(Doss,)249
1346 y(F)m(rank)o(e)e(and)h(others)g(on)f(early)h(implemen)o(tatio)o
(ns)d(of)i Fw(MPI)g FA(sho)o(w)o(ed)h(that)f(it)g(could)h(b)q(e)g
(fully)249 1400 y(implemen)o(ted)e(without)i(a)g(prohibitiv)o(ely)f
(large)h(e\013ort)h([12)o(,)f(16].)24 b(Th)o(us,)17 b(the)g(rationale)f
(for)249 1454 y(the)f Fw(MPI)e FA(subset)i(w)o(as)f(lost,)f(and)h(this)
g(idea)f(w)o(as)h(dropp)q(ed.)249 1537 y Fs(9.1.3)48
b(Wh)o(y)16 b(do)q(es)f Fw(MPI)g Fs(not)g(guaran)o(tee)f(bu\013ering?)
249 1620 y Fw(MPI)j FA(do)q(es)h(not)g(guaran)o(tee)g(to)f(bu\013er)h
(arbitrary)g(messages)f(b)q(ecause)j(memory)15 b(is)i(a)g(\014nite)249
1674 y(resource)g(on)e(all)f(computers.)22 b(Th)o(us,)15
b(all)f(computers)h(will)f(fail)f(under)j(su\016cien)o(tly)f(adv)o
(erse)249 1728 y(comm)o(unication)9 b(loads.)17 b(Di\013eren)o(t)c
(computers)g(at)f(di\013eren)o(t)i(times)e(are)h(capable)f(of)g(pro)o
(vid-)249 1782 y(ing)k(di\013ering)h(amoun)o(ts)f(of)h(bu\013ering,)g
(so)h(if)e(a)h(program)e(relies)j(on)f(bu\013ering)g(it)g(ma)o(y)e
(fail)249 1836 y(under)e(certain)g(conditions,)e(but)i(w)o(ork)f
(correctly)h(under)g(other)f(conditions.)18 b(This)12
b(is)g(clearly)249 1890 y(undesirable.)291 1944 y(Giv)o(en)21
b(that)h(no)g(message)f(passing)h(system)g(can)g(guaran)o(tee)g(that)g
(messages)g(will)f(b)q(e)249 1998 y(bu\013ered)h(as)f(required)g(under)
h(all)d(circumstances,)k(it)d(migh)o(t)e(b)q(e)k(ask)o(ed)e(wh)o(y)h
Fw(MPI)f FA(do)q(es)249 2051 y(not)c(guaran)o(tee)h(a)f(minim)n(um)c
(amoun)o(t)j(of)g(memory)f(a)o(v)n(ailable)g(for)i(bu\013ering.)26
b(One)17 b(ma)r(jor)249 2105 y(problem)f(is)g(that)h(it)f(is)h(not)g
(ob)o(vious)f(ho)o(w)g(to)h(sp)q(ecify)g(the)h(amoun)o(t)d(of)h
(bu\013er)i(space)f(that)249 2159 y(is)h(a)o(v)n(ailable,)f(nor)h(is)g
(it)g(easy)h(to)f(estimate)f(ho)o(w)h(m)o(uc)o(h)f(bu\013er)i(space)h
(is)e(consumed)g(b)o(y)g(a)249 2213 y(particular)c(program.)291
2267 y(Di\013eren)o(t)i(bu\013ering)g(p)q(olicies)f(mak)o(e)f(sense)k
(in)d(di\013eren)o(t)h(en)o(vironmen)o(ts.)23 b(Messages)17
b(can)249 2321 y(b)q(e)g(bu\013ered)g(at)f(the)h(sending)f(no)q(de)h
(or)f(at)g(the)h(receiving)f(no)q(de,)h(or)f(b)q(oth.)25
b(In)16 b(the)g(former)249 2375 y(case,)208 2458 y Ft(\017)k
FA(bu\013ers)15 b(can)f(b)q(e)h(dedicated)g(to)e(one)i(destination)e
(in)h(one)g(comm)o(unicatio)o(n)d(domain,)p eop
%%Page: 313 327
313 326 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Conclusions)1241 b(313)208 507
y Ft(\017)20 b FA(or)14 b(dedicated)h(to)e(one)i(destination)e(for)h
(all)e(comm)o(unication)f(domains,)208 578 y Ft(\017)20
b FA(or)14 b(shared)h(b)o(y)e(all)g(outgoing)g(comm)o(unicati)o(ons,)
208 648 y Ft(\017)20 b FA(or)14 b(shared)h(b)o(y)e(all)g(pro)q(cesses)k
(running)c(at)h(a)g(pro)q(cessor)h(no)q(de,)208 719 y
Ft(\017)20 b FA(or)14 b(part)g(of)f(the)i(bu\013er)g(p)q(o)q(ol)e(ma)o
(y)f(b)q(e)i(dedicated,)h(and)e(part)h(shared.)249 802
y(Similar)e(c)o(hoices)17 b(o)q(ccur)f(if)e(messages)h(are)h
(bu\013ered)h(at)e(the)h(destination.)21 b(Comm)o(unicatio)o(n)249
856 y(bu\013ers)14 b(ma)o(y)d(b)q(e)j(\014xed)f(in)f(size,)i(or)e(they)
i(ma)o(y)d(b)q(e)i(allo)q(cated)f(dynamically)e(out)j(of)f(the)i(heap,)
249 910 y(in)h(comp)q(etition)g(with)g(the)i(application.)22
b(The)16 b(bu\013er)h(allo)q(cation)e(p)q(olicy)g(ma)o(y)f(dep)q(end)j
(on)249 964 y(the)d(size)g(of)f(the)h(messages)f(\(preferably)h
(bu\013ering)g(short)g(messages\),)f(and)h(ma)o(y)d(dep)q(end)k(on)249
1018 y(comm)o(unication)10 b(history)k(\(preferably)h(bu\013ering)f(on)
g(busy)g(c)o(hannels\).)291 1072 y(The)d(c)o(hoice)g(of)f(the)i(righ)o
(t)e(p)q(olicy)g(is)h(strongly)f(dep)q(enden)o(t)j(on)d(the)i(hardw)o
(are)f(and)f(soft)o(w)o(are)249 1126 y(en)o(vironmen)o(t.)17
b(F)m(or)c(instance,)h(in)f(a)g(dedicated)h(en)o(vironmen)o(t,)e(a)h
(pro)q(cessor)i(with)e(a)h(pro)q(cess)249 1180 y(blo)q(c)o(k)o(ed)d(on)
g(a)f(send)i(is)f(idle)f(and)h(so)g(computing)e(resources)k(are)e(not)g
(w)o(asted)h(if)e(this)h(pro)q(cessor)249 1234 y(copies)16
b(the)h(outgoing)d(message)h(to)h(a)f(bu\013er.)25 b(In)16
b(a)f(time)f(shared)j(en)o(vironmen)o(t,)e(the)h(com-)249
1288 y(puting)e(resources)j(ma)o(y)c(b)q(e)j(used)f(b)o(y)g(another)g
(pro)q(cess.)22 b(In)15 b(a)f(system)h(where)h(bu\013er)f(space)249
1342 y(can)d(b)q(e)g(in)g(paged)f(memory)m(,)e(suc)o(h)j(space)h(can)f
(b)q(e)g(allo)q(cated)g(from)d(heap.)18 b(If)11 b(the)i(bu\013er)f
(space)249 1396 y(cannot)18 b(b)q(e)g(paged,)g(or)f(has)h(to)f(b)q(e)h
(in)f(k)o(ernel)h(space,)h(then)f(a)f(separate)i(bu\013er)f(is)f
(needed.)249 1450 y(Flo)o(w)e(con)o(trol)h(ma)o(y)e(require)j(that)f
(some)f(amoun)o(t)f(of)i(bu\013er)h(space)g(b)q(e)f(dedicated)h(to)f
(eac)o(h)249 1504 y(pair)e(of)f(comm)o(unicating)d(pro)q(cesses.)291
1558 y(The)i(optimal)c(strategy)13 b(strongly)e(dep)q(ends)i(on)e(v)n
(arious)g(p)q(erformance)g(parameters)h(of)f(the)249
1611 y(system:)19 b(the)c(bandwidth,)f(the)h(comm)o(unication)d
(start-up)j(time,)e(sc)o(heduling)h(and)h(con)o(text)249
1665 y(switc)o(hing)f(o)o(v)o(erheads,)g(the)h(amoun)o(t)e(of)g(p)q
(oten)o(tial)h(o)o(v)o(erlap)f(b)q(et)o(w)o(een)j(comm)o(unicatio)o(n)c
(and)249 1719 y(computation,)19 b(etc.)36 b(The)20 b(c)o(hoice)g(of)f
(a)h(bu\013ering)f(and)h(sc)o(heduling)g(p)q(olicy)f(ma)o(y)e(not)j(b)q
(e)249 1773 y(en)o(tirely)e(under)h(the)g(con)o(trol)f(of)f(the)i
Fw(MPI)e FA(implemen)o(tor,)f(as)i(it)g(is)g(partially)e(determined)249
1827 y(b)o(y)f(the)g(prop)q(erties)i(of)d(the)i(underlying)f(comm)o
(uni)o(cation)d(la)o(y)o(er.)21 b(Also,)15 b(exp)q(erience)i(in)d(this)
249 1881 y(arena)c(is)g(quite)g(limited,)e(and)i(underlying)g(tec)o
(hnology)g(can)g(b)q(e)g(exp)q(ected)j(to)c(c)o(hange)i(rapidly:)249
1935 y(fast,)17 b(user-space)i(in)o(terpro)q(cessor)g(comm)o(unication)
14 b(mec)o(hanisms)h(are)i(an)g(activ)o(e)g(researc)o(h)249
1989 y(area)d([28)o(,)g(20)o(].)291 2043 y(A)o(ttempts)i(b)o(y)g(the)h
Fw(MPI)f FA(F)m(orum)f(to)h(design)h(mec)o(hanisms)e(for)h(querying)g
(or)h(setting)g(the)249 2097 y(amoun)o(t)c(of)g(bu\013er)j(space)f(a)o
(v)n(ailable)e(to)h(standard)h(comm)o(unicati)o(on)d(led)i(to)g(the)h
(conclusion)249 2151 y(that)j(suc)o(h)h(mec)o(hanisms)d(will)h(either)i
(restrict)h(allo)o(w)o(ed)d(implem)o(en)o(tations)f(unacceptably)m(,)
249 2205 y(or)g(pro)o(vide)f(b)q(ounds)h(that)g(will)e(b)q(e)i
(extremely)f(p)q(essimistic)h(on)f(most)f(implemen)o(tations)f(in)249
2259 y(most)h(cases.)22 b(Another)15 b(problem)f(is)g(that)h
(parameters)g(suc)o(h)g(as)g(bu\013er)h(sizes)g(w)o(ork)e(against)249
2313 y(p)q(ortabilit)o(y)m(.)36 b(Rather)21 b(then)g(restricting)h(the)
f(implemen)o(tatio)o(n)d(strategies)k(for)e(standard)249
2367 y(comm)o(unication,)11 b(the)k(c)o(hoice)h(w)o(as)e(tak)o(en)h(to)
f(pro)o(vide)h(additional)e(comm)o(unicatio)o(n)f(mo)q(des)249
2421 y(for)18 b(those)g(users)i(that)e(do)g(not)g(w)o(an)o(t)f(to)h
(trust)h(the)f(implemen)o(tation)d(to)j(mak)o(e)e(the)j(righ)o(t)249
2475 y(c)o(hoice)14 b(for)g(them.)p eop
%%Page: 314 328
314 327 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(314)1256 b(Chapter)13 b(9)249
507 y FD(9.2)52 b(P)o(ortable)18 b(Programming)e(with)j
Fw(MPI)249 615 y FA(The)c Fw(MPI)g FA(sp)q(eci\014cation)g(w)o(as)g
(designed)g(to)g(mak)o(e)e(it)i(p)q(ossible)g(to)g(write)g(p)q(ortable)
g(message)249 669 y(passing)j(programs)e(while)h(a)o(v)o(oiding)f
(unacceptable)i(p)q(erformance)g(degradation.)28 b(Within)249
723 y(the)16 b(con)o(text)g(of)e Fw(MPI)p FA(,)g(\\p)q(ortable")h(is)g
(synon)o(ymous)f(with)g(\\safe.")22 b(Unsafe)15 b(programs)f(ma)o(y)249
777 y(exhibit)c(a)h(di\013eren)o(t)g(b)q(eha)o(vior)g(on)f(di\013eren)o
(t)h(systems)g(b)q(ecause)i(they)e(are)g(non-deterministic:)249
831 y(Sev)o(eral)h(outcomes)f(are)h(consisten)o(t)h(with)e(the)h
Fw(MPI)f FA(sp)q(eci\014cation,)h(and)g(the)g(actual)f(outcome)249
885 y(to)17 b(o)q(ccur)i(dep)q(ends)g(on)e(the)h(precise)h(timing)c(of)
i(ev)o(en)o(ts.)30 b(Unsafe)18 b(programs)e(ma)o(y)g(require)249
939 y(resources)f(that)d(are)h(not)f(alw)o(a)o(ys)f(guaran)o(teed)i(b)o
(y)f Fw(MPI)p FA(,)f(in)h(order)g(to)h(complete)e(successfully)m(.)249
993 y(On)19 b(systems)g(where)h(suc)o(h)f(resources)i(are)f(una)o(v)n
(ailable,)d(the)i(program)e(will)h(encoun)o(ter)i(a)249
1047 y(resource)14 b(error.)19 b(Suc)o(h)13 b(an)f(error)h(will)e
(manifest)g(itself)h(as)g(an)h(actual)f(program)e(error,)k(or)e(will)
249 1101 y(result)j(in)e(deadlo)q(c)o(k.)291 1155 y(There)18
b(are)g(three)h(main)c(issues)k(relating)e(to)h(the)g(p)q(ortabilit)o
(y)e(of)h Fw(MPI)g FA(programs)f(\(and,)249 1209 y(indeed,)e(message)g
(passing)f(programs)g(in)g(general\).)196 1300 y(1.)20
b(The)12 b(program)e(should)h(not)g(dep)q(end)i(on)e(the)h(bu\013ering)
f(of)g(messages)g(b)o(y)g Fw(MPI)g FA(or)g(lo)o(w)o(er)g(lev)o(els)249
1354 y(of)g(the)h(comm)o(unicatio)o(n)d(system.)17 b(A)11
b(v)n(alid)f Fw(MPI)h FA(implemen)o(tation)d(ma)o(y)m(,)h(or)j(ma)o(y)d
(not,)i(bu\013er)249 1408 y(messages)j(of)f(a)h(giv)o(en)f(size)i(\(in)
e(standard)i(mo)q(de\).)196 1479 y(2.)20 b(The)15 b(program)d(should)i
(not)g(dep)q(end)i(up)q(on)e(whether)h(collectiv)o(e)g(comm)o(uni)o
(cation)c(routines,)249 1533 y(suc)o(h)18 b(as)f Fr(MPI)p
469 1533 14 2 v 15 w(Bcast\(\))p FA(,)e(act)j(as)f(barrier)g(sync)o
(hronizations.)27 b(In)17 b(a)g(v)n(alid)e Fw(MPI)h FA(implemen-)249
1587 y(tation)f(collectiv)o(e)h(comm)o(unication)d(routines)j(ma)o(y)m
(,)e(or)i(ma)o(y)e(not,)i(ha)o(v)o(e)g(the)g(side)g(e\013ect)i(of)249
1641 y(p)q(erforming)12 b(a)i(barrier)g(sync)o(hronization.)196
1711 y(3.)20 b(The)g(program)d(should)i(ensure)i(that)e(messages)h(are)
f(matc)o(hed)g(b)o(y)g(the)g(in)o(tended)h(receiv)o(e)249
1765 y(call.)30 b(Am)o(biguities)16 b(in)h(the)i(sp)q(eci\014cation)f
(of)g(comm)o(unicatio)o(n)d(can)k(lead)e(to)h(incorrect)h(or)249
1819 y(non-deterministic)12 b(programs)g(since)i(race)g(conditions)e
(ma)o(y)f(arise.)18 b Fw(MPI)13 b FA(pro)o(vides)g(message)249
1873 y(tags)h(and)g(comm)o(unicators)d(to)j(help)g(a)o(v)o(oid)e(these)
k(t)o(yp)q(es)e(of)g(problem.)291 1964 y(If)g(prop)q(er)i(atten)o(tion)
f(is)g(not)g(paid)g(to)g(these)i(factors)e(a)g(message)g(passing)g(co)q
(de)h(ma)o(y)d(fail)249 2018 y(in)o(termitten)o(tly)e(on)i(a)f(giv)o
(en)g(computer,)g(or)h(ma)o(y)e(w)o(ork)h(correctly)i(on)e(one)h(mac)o
(hine)f(but)h(not)249 2072 y(on)g(another.)18 b(Clearly)12
b(suc)o(h)i(a)f(program)e(is)i(not)g(p)q(ortable.)18
b(W)m(e)13 b(shall)f(no)o(w)h(consider)g(eac)o(h)h(of)249
2126 y(the)h(ab)q(o)o(v)o(e)e(factors)h(in)g(more)f(detail.)249
2209 y Fs(9.2.1)48 b(Dep)q(endency)14 b(on)h(Bu\013ering)249
2292 y FA(A)d(message)f(passing)g(program)f(is)h(dep)q(enden)o(t)j(on)d
(the)h(bu\013ering)g(of)f(messages)g(if)g(its)g(comm)o(u-)249
2346 y(nication)h(graph)h(has)h(a)f(cycle.)18 b(The)c(comm)o(unicatio)o
(n)c(graph)j(is)g(a)g(directed)i(graph)e(in)g(whic)o(h)249
2400 y(the)f(no)q(des)h(represen)o(t)h Fw(MPI)d FA(comm)o(unicatio)o(n)
e(calls)i(and)h(the)g(edges)h(represen)o(t)h(dep)q(endencies)249
2454 y(b)q(et)o(w)o(een)20 b(these)f(calls:)26 b(a)18
b(directed)i(edge)e Fw(uv)h FA(indicates)f(that)h(op)q(eration)f
Fw(v)g FA(migh)o(t)e(not)i(b)q(e)249 2508 y(able)f(to)g(complete)f(b)q
(efore)i(op)q(eration)f Fw(u)h FA(is)f(started.)29 b(Calls)16
b(ma)o(y)f(b)q(e)j(dep)q(enden)o(t)h(b)q(ecause)p eop
%%Page: 315 329
315 328 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Conclusions)1241 b(315)249 507
y FA(they)17 b(ha)o(v)o(e)g(to)f(b)q(e)h(executed)i(in)d(succession)i
(b)o(y)f(the)g(same)e(pro)q(cess,)k(or)e(b)q(ecause)h(they)f(are)249
561 y(matc)o(hing)12 b(send)j(and)f(receiv)o(e)h(calls.)249
646 y Fs(Example)g(9.1)21 b FA(Co)q(de)16 b(for)f(p)q(erio)q(dic)g
(shift)g(in)g(whic)o(h)g(the)h(pro)q(cesses)i(are)e(arranged)g(with)f
(a)249 700 y(ring)d(top)q(ology)e(\(i.e.)17 b(a)12 b(one-dimensional,)e
(p)q(erio)q(dic)i(top)q(ology\))f(where)i(comm)o(unicates)d(data)249
754 y(to)15 b(its)f(clo)q(c)o(kwise)i(neigh)o(b)q(or.)k(A)15
b(degenerate)h(instance)g(of)e(this)h(is)f(when)i(a)e(pro)q(cess)j
(sends)f(a)249 808 y(message)11 b(to)g(itself.)17 b(The)11
b(follo)o(wing)e(co)q(de)j(uses)g(a)f(blo)q(c)o(king)f(send)i(in)f
(standard)g(mo)q(de)g(to)g(send)249 862 y(a)17 b(message)g(to)g(its)g
(clo)q(c)o(kwise)h(neigh)o(b)q(or,)f(and)g(a)g(blo)q(c)o(king)g(receiv)
o(e)h(to)f(receiv)o(e)i(a)e(message)249 916 y(from)12
b(its)i(an)o(ti-clo)q(c)o(kwise)g(neigh)o(b)q(or.)249
994 y Fr(...)249 1048 y(MPI_Comm_size\(comm)o(,)19 b(&size\);)249
1102 y(MPI_Comm_rank\(comm)o(,)g(&rank\);)249 1156 y(clock)i(=)g
(\(rank+1\)\045size;)249 1210 y(anticlock)f(=)i(\(rank+size-1\)\045s)o
(ize;)249 1318 y(MPI_Send)e(\(buf1,)h(count,)f(MPI_INT,)g(clock,)h
(tag,)g(comm\);)249 1372 y(MPI_Recv)f(\(buf2,)h(count,)f(MPI_INT,)g
(anticlock,)g(tag,)h(comm,)g(&status\);)291 1456 y FA(The)d(execution)h
(of)f(the)g(co)q(de)h(results)h(in)d(the)i(dep)q(endency)i(graph)d
(illustrated)g(in)f(Fig-)249 1510 y(ure)e(9.1,)d(for)i(the)g(case)h(of)
e(a)h(three)h(pro)q(cess)h(group.)471 1564 y
 16577003 10940820 0 0 27825684 18418892 startTexFig
 471 1564
a
%%BeginDocument: ../figures/conc-cycle.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-63.0 378.0 translate 0.900 -0.900 scale
/Times-Bold findfont 18.00 scalefont setfont
279 264 m 
gs 1 -1 scale (Receive) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
99 304 m 
gs 1 -1 scale (Send) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
99 404 m 
gs 1 -1 scale (Receive) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
459 304 m 
gs 1 -1 scale (Send) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
459 404 m 
gs 1 -1 scale (Receive) col-1 show gr
1.000 setlinewidth
% Polyline
n 266 139 m 259 139 259 272 7 arcto 4 {pop} repeat 259 279 352 279 7 arcto 4 {pop} repeat 359 279 359 146 7 arcto 4 {pop} repeat 359 139 266 139 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 266 139 m 259 139 259 272 7 arcto 4 {pop} repeat 259 279 352 279 7 arcto 4 {pop} repeat 359 279 359 146 7 arcto 4 {pop} repeat 359 139 266 139 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 86 279 m 79 279 79 412 7 arcto 4 {pop} repeat 79 419 172 419 7 arcto 4 {pop} repeat 179 419 179 286 7 arcto 4 {pop} repeat 179 279 86 279 7 arcto 4 {pop} repeat clp gs col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
279 164 m 
gs 1 -1 scale (Send) col-1 show gr
% Polyline
n 446 279 m 439 279 439 412 7 arcto 4 {pop} repeat 439 419 532 419 7 arcto 4 {pop} repeat 539 419 539 286 7 arcto 4 {pop} repeat 539 279 446 279 7 arcto 4 {pop} repeat clp gs col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
69 264 m 
gs 1 -1 scale (2) col-1 show gr
% Polyline
n 119 319 m 119 379 l gs col-1 s gr
n 123.000 363.000 m 119.000 379.000 l 115.000 363.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 479 319 m 479 379 l gs col-1 s gr
n 483.000 363.000 m 479.000 379.000 l 475.000 363.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 299 179 m 299 239 l gs col-1 s gr
n 303.000 223.000 m 299.000 239.000 l 295.000 223.000 l gs 2 setlinejoin col-1 s gr
n 437.554 299.231 m 454.000 298.000 l 440.068 306.826 l gs 2 setlinejoin col-1 s gr
% Polyline
n 454 298 m 164 394 l gs col-1 s gr
n 180.446 392.769 m 164.000 394.000 l 177.932 385.174 l gs 2 setlinejoin col-1 s gr
n 160.492 289.156 m 144.000 289.000 l 158.625 281.376 l gs 2 setlinejoin col-1 s gr
% Polyline
n 144 289 m 269 259 l gs col-1 s gr
n 252.508 258.844 m 269.000 259.000 l 254.375 266.624 l gs 2 setlinejoin col-1 s gr
n 323.959 179.729 m 319.000 164.000 l 330.778 175.545 l gs 2 setlinejoin col-1 s gr
% Polyline
n 319 164 m 454 384 l gs col-1 s gr
n 449.041 368.271 m 454.000 384.000 l 442.222 372.455 l gs 2 setlinejoin col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
249 129 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
429 264 m 
gs 1 -1 scale (1) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 2319 a Fo(Figure)d(9.1)249 2356 y Fz(Cycle)e(in)g(comm)o(unicat)o
(ion)d(graph)i(for)h(cyclic)f(shift.)291 2454 y FA(The)k(arro)o(w)f
(from)f(eac)o(h)i(send)g(to)f(the)h(follo)o(wing)d(receiv)o(e)k
(executed)h(b)o(y)d(the)h(same)f(pro)q(cess)249 2508
y(re\015ects)20 b(the)e(program)e(dep)q(endency)j(within)e(eac)o(h)h
(pro)q(cess:)27 b(the)19 b(receiv)o(e)f(call)f(cannot)h(b)q(e)p
eop
%%Page: 316 330
316 329 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(316)1256 b(Chapter)13 b(9)249
507 y FA(executed)19 b(un)o(til)e(the)h(previous)g(send)g(call)f(has)g
(completed.)29 b(The)17 b(double)h(arro)o(w)f(b)q(et)o(w)o(een)249
561 y(eac)o(h)g(send)f(and)g(the)h(matc)o(hing)d(receiv)o(e)j
(re\015ects)h(their)f(m)o(utual)d(dep)q(endency:)24 b(Ob)o(viously)m(,)
249 615 y(the)19 b(receiv)o(e)h(cannot)e(complete)g(unless)h(the)g
(matc)o(hing)e(send)i(w)o(as)f(in)o(v)o(ok)o(ed.)31 b(Con)o(v)o(ersely)
m(,)249 669 y(since)16 b(a)e(standard)i(mo)q(de)e(send)h(is)g(used,)h
(it)e(ma)o(y)f(b)q(e)j(the)f(case)h(that)f(the)h(send)f(blo)q(c)o(ks)g
(un)o(til)249 723 y(a)f(matc)o(hing)e(receiv)o(e)j(o)q(ccurs.)291
777 y(The)21 b(dep)q(endency)h(graph)f(has)g(a)f(cycle.)39
b(This)21 b(co)q(de)g(will)e(only)h(w)o(ork)h(if)e(the)j(system)249
831 y(pro)o(vides)13 b(su\016cien)o(t)f(bu\013ering,)h(in)f(whic)o(h)g
(case)i(the)f(send)g(op)q(eration)f(will)f(complete)h(lo)q(cally)m(,)
249 885 y(the)18 b(call)f(to)g Fr(MPI)p 527 885 14 2
v 15 w(Send\(\))f FA(will)g(return,)j(and)e(the)h(matc)o(hing)e(call)g
(to)i Fr(MPI)p 1459 885 V 15 w(Recv\(\))e FA(will)g(b)q(e)249
939 y(p)q(erformed.)i(In)13 b(the)h(absence)h(of)d(su\016cien)o(t)i
(bu\013ering)g Fw(MPI)e FA(do)q(es)j(not)e(sp)q(ecify)h(an)f(outcome,)
249 993 y(but)h(for)g(most)e(implemen)o(tations)f(deadlo)q(c)o(k)j
(will)e(o)q(ccur,)j(i.e.,)d(the)i(call)g(to)f Fr(MPI)p
1522 993 V 15 w(Send\(\))g FA(will)249 1047 y(nev)o(er)j(return:)23
b(eac)o(h)16 b(pro)q(cess)h(will)d(w)o(ait)h(for)g(the)h(next)g(pro)q
(cess)h(on)e(the)h(ring)f(to)g(execute)j(a)249 1101 y(matc)o(hing)10
b(receiv)o(e.)18 b(Th)o(us,)12 b(the)g(b)q(eha)o(vior)g(of)e(this)i(co)
q(de)g(will)f(di\013er)h(from)d(system)j(to)f(system,)249
1155 y(or)j(on)g(the)g(same)f(system,)g(when)i(message)e(size)i(\()p
Fw(count)p FA(\))g(is)f(c)o(hanged.)291 1209 y(There)e(are)g(a)f(n)o
(um)o(b)q(er)f(of)h(w)o(a)o(ys)g(in)f(whic)o(h)i(a)e(shift)h(op)q
(eration)h(can)f(b)q(e)h(p)q(erformed)f(p)q(ortably)249
1263 y(using)j Fw(MPI)p FA(.)e(These)k(are)196 1354 y(1.)k(alternate)14
b(send)h(and)f(receiv)o(e)h(calls)f(\(only)f(w)o(orks)h(if)f(more)g
(than)h(one)g(pro)q(cess\),)196 1425 y(2.)20 b(use)15
b(a)e(blo)q(c)o(king)g(send)i(in)e(bu\013ered)j(mo)q(de,)196
1495 y(3.)k(use)15 b(a)e(non)o(blo)q(c)o(king)g(send)i(and/or)e(receiv)
o(e,)196 1566 y(4.)20 b(use)15 b(a)e(call)g(to)h Fr(MPI)p
551 1566 V 15 w(Sendrecv\(\))p FA(,)291 1657 y(If)j(at)h(least)g(one)g
(pro)q(cess)h(in)f(a)f(shift)h(op)q(eration)f(calls)h(the)g(receiv)o(e)
h(routine)f(b)q(efore)h(the)249 1711 y(send)i(routine,)f(and)g(at)f
(least)h(one)g(pro)q(cess)h(calls)e(the)h(send)h(routine)f(b)q(efore)g
(the)g(receiv)o(e)249 1765 y(routine,)e(then)g(at)f(least)h(one)f(comm)
o(unication)d(can)j(pro)q(ceed,)j(and,)d(ev)o(en)o(tually)m(,)g(the)h
(shift)249 1819 y(will)9 b(complete)g(successfully)m(.)18
b(One)10 b(of)g(the)g(most)f(e\016cien)o(t)i(w)o(a)o(ys)e(of)h(doing)f
(this)h(is)g(to)g(alternate)249 1873 y(the)15 b(send)h(and)f(receiv)o
(e)h(calls)e(so)h(that)g(all)f(pro)q(cesses)j(with)e(ev)o(en)g(rank)g
(send)h(\014rst)f(and)g(then)249 1927 y(receiv)o(e,)21
b(and)d(all)g(pro)q(cesses)j(with)d(o)q(dd)h(rank)g(receiv)o(e)h
(\014rst)f(and)g(then)g(send.)33 b(Th)o(us,)20 b(the)249
1981 y(follo)o(wing)11 b(co)q(de)k(is)e(p)q(ortable)h(pro)o(vided)f
(there)i(is)f(more)e(than)i(one)g(pro)q(cess,)h(i.e.,)d
Fr(clock)h FA(and)249 2035 y Fr(anticlock)f FA(are)i(di\013eren)o(t:)
249 2122 y Fr(if)21 b(\(rank\0452\))g({)314 2176 y(MPI_Recv)g(\(buf2,)f
(count,)h(MPI_INT,)f(anticlock,)g(tag,)h(comm,)f(&status\);)314
2230 y(MPI_Send)h(\(buf1,)f(count,)h(MPI_INT,)f(clock,)g(tag,)h
(comm\);)314 2284 y(})249 2338 y(else)g({)314 2392 y(MPI_Send)g
(\(buf1,)f(count,)h(MPI_INT,)f(clock,)g(tag,)h(comm\);)314
2446 y(MPI_Recv)g(\(buf2,)f(count,)h(MPI_INT,)f(anticlock,)g(tag,)h
(comm,)f(&status\);)314 2500 y(})p eop
%%Page: 317 331
317 330 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Conclusions)1241 b(317)249 507
y FA(The)21 b(resulting)g(comm)o(unicatio)o(n)d(graph)j(is)f
(illustrated)g(in)h(Figure)f(9.2.)38 b(This)20 b(graph)h(is)249
561 y(acyclic.)471 618 y
 16577003 10940820 0 0 27825684 18418892 startTexFig
 471 618 a
%%BeginDocument: ../figures/conc-nocycle.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-63.0 378.0 translate 0.900 -0.900 scale
/Times-Bold findfont 18.00 scalefont setfont
279 264 m 
gs 1 -1 scale (Receive) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
99 304 m 
gs 1 -1 scale (Send) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
99 404 m 
gs 1 -1 scale (Receive) col-1 show gr
1.000 setlinewidth
% Polyline
n 266 139 m 259 139 259 272 7 arcto 4 {pop} repeat 259 279 352 279 7 arcto 4 {pop} repeat 359 279 359 146 7 arcto 4 {pop} repeat 359 139 266 139 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 266 139 m 259 139 259 272 7 arcto 4 {pop} repeat 259 279 352 279 7 arcto 4 {pop} repeat 359 279 359 146 7 arcto 4 {pop} repeat 359 139 266 139 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 86 279 m 79 279 79 412 7 arcto 4 {pop} repeat 79 419 172 419 7 arcto 4 {pop} repeat 179 419 179 286 7 arcto 4 {pop} repeat 179 279 86 279 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 446 279 m 439 279 439 412 7 arcto 4 {pop} repeat 439 419 532 419 7 arcto 4 {pop} repeat 539 419 539 286 7 arcto 4 {pop} repeat 539 279 446 279 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 119 319 m 119 379 l gs col-1 s gr
n 123.000 363.000 m 119.000 379.000 l 115.000 363.000 l gs 2 setlinejoin col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
279 164 m 
gs 1 -1 scale (Send) col-1 show gr
% Polyline
n 479 319 m 479 379 l gs col-1 s gr
n 483.000 363.000 m 479.000 379.000 l 475.000 363.000 l gs 2 setlinejoin col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
459 404 m 
gs 1 -1 scale (Send) col-1 show gr
% Polyline
n 299 179 m 299 239 l gs col-1 s gr
n 303.000 223.000 m 299.000 239.000 l 295.000 223.000 l gs 2 setlinejoin col-1 s gr
n 438.000 395.000 m 454.000 399.000 l 438.000 403.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 454 399 m 164 399 l gs col-1 s gr
n 180.000 403.000 m 164.000 399.000 l 180.000 395.000 l gs 2 setlinejoin col-1 s gr
n 327.485 178.142 m 319.000 164.000 l 333.142 172.485 l gs 2 setlinejoin col-1 s gr
% Polyline
n 319 164 m 449 294 l gs col-1 s gr
n 440.515 279.858 m 449.000 294.000 l 434.858 285.515 l gs 2 setlinejoin col-1 s gr
n 160.492 289.156 m 144.000 289.000 l 158.625 281.376 l gs 2 setlinejoin col-1 s gr
% Polyline
n 144 289 m 269 259 l gs col-1 s gr
n 252.508 258.844 m 269.000 259.000 l 254.375 266.624 l gs 2 setlinejoin col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
249 129 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
429 264 m 
gs 1 -1 scale (1) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
69 264 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
459 304 m 
gs 1 -1 scale (Receive) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1374 a Fo(Figure)13 b(9.2)249 1411 y Fz(Cycle)e(in)g(comm)o
(unicat)o(ion)d(graph)i(is)i(brok)o(en)d(b)o(y)i(reordering)e(send)i
(and)f(receiv)o(e.)291 1512 y FA(If)g(there)j(is)e(only)g(one)g(pro)q
(cess)i(then)f(clearly)f(blo)q(c)o(king)g(send)h(and)f(receiv)o(e)h
(routines)g(cannot)249 1566 y(b)q(e)k(used)h(since)f(the)h(send)f(m)o
(ust)f(b)q(e)h(called)f(b)q(efore)i(the)f(receiv)o(e,)h(and)e(so)h
(cannot)g(complete)249 1620 y(in)d(the)i(absence)g(of)f(bu\013ering.)
291 1674 y(W)m(e)d(no)o(w)h(consider)h(metho)q(ds)e(for)h(p)q
(erforming)e(shift)i(op)q(erations)g(that)h(w)o(ork)e(ev)o(en)i(if)e
(there)249 1728 y(is)18 b(only)g(one)h(pro)q(cess)h(in)o(v)o(olv)o(ed.)
30 b(A)19 b(blo)q(c)o(king)e(send)i(in)f(bu\013ered)i(mo)q(de)e(can)g
(b)q(e)h(used)h(to)249 1782 y(p)q(erform)e(a)h(shift)f(op)q(eration.)33
b(In)19 b(this)g(case)h(the)f(application)e(program)h(passes)i(a)e
(bu\013er)249 1836 y(to)g(the)g Fw(MPI)f FA(comm)o(unicatio)o(n)e
(system,)j(and)g Fw(MPI)f FA(can)h(use)g(this)g(to)g(bu\013er)g
(messages.)30 b(If)249 1890 y(the)16 b(bu\013er)g(pro)o(vided)f(is)f
(large)h(enough,)g(then)h(the)f(shift)g(will)f(complete)g(successfully)
m(.)22 b(The)249 1944 y(follo)o(wing)9 b(co)q(de)k(sho)o(ws)f(ho)o(w)g
(to)f(use)i(bu\013ered)g(mo)q(de)e(to)h(create)h(a)e(p)q(ortable)h
(shift)g(op)q(eration.)249 2037 y Fr(...)249 2091 y(MPI_Pack_size)19
b(\(count,)i(MPI_INT,)f(comm,)g(&buffsize\))249 2145
y(buffsize)g(+=)i(MPI_BSEND_OVERH)o(EAD)249 2199 y(userbuf)e(=)i
(malloc)f(\(buffsize\))249 2253 y(MPI_Buffer_attach)d(\(userbuf,)i
(buffsize\);)249 2307 y(MPI_Bsend)g(\(buf1,)h(count,)f(MPI_INT,)g
(clock,)h(tag,)g(comm\);)249 2361 y(MPI_Recv)42 b(\(buf2,)21
b(count,)f(MPI_INT,)g(anticlock,)g(tag,)h(comm,)g(&status\);)291
2454 y Fw(MPI)9 b FA(guaran)o(tees)i(that)g(the)g(bu\013er)g(supplied)g
(b)o(y)f(a)g(call)g(to)g Fr(MPI)p 1283 2454 14 2 v 15
w(Buffer)p 1430 2454 V 14 w(attach\(\))f FA(will)g(b)q(e)249
2508 y(used)15 b(if)e(it)h(is)g(needed)h(to)f(bu\013er)h(the)f
(message.)k(\(In)d(an)e(implemen)o(tation)e(of)i Fw(MPI)h
FA(that)g(pro-)p eop
%%Page: 318 332
318 331 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(318)1256 b(Chapter)13 b(9)249
507 y FA(vides)i(su\016cien)o(t)g(bu\013ering,)g(the)h(user-supplied)f
(bu\013er)h(ma)o(y)d(b)q(e)i(ignored.\))21 b(Eac)o(h)15
b(bu\013ered)249 561 y(send)e(op)q(erations)e(can)h(complete)f(lo)q
(cally)m(,)f(so)i(that)f(a)h(deadlo)q(c)o(k)f(will)f(not)i(o)q(ccur.)18
b(The)12 b(acyclic)249 615 y(comm)o(unication)g(graph)j(for)g(this)h
(mo)q(di\014ed)e(co)q(de)i(is)g(sho)o(wn)f(in)g(Figure)h(9.3.)21
b(Eac)o(h)16 b(receiv)o(e)249 669 y(dep)q(ends)22 b(on)d(the)i(matc)o
(hing)d(send,)k(but)e(the)g(send)h(do)q(es)g(not)f(dep)q(end)h(an)o
(ymore)d(on)i(the)249 723 y(matc)o(hing)12 b(receiv)o(e.)471
781 y
 16577003 10940820 0 0 27825684 18418892 startTexFig
 471 781 a
%%BeginDocument: ../figures/conc-nocycle2.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-63.0 378.0 translate 0.900 -0.900 scale
/Times-Bold findfont 18.00 scalefont setfont
279 264 m 
gs 1 -1 scale (Receive) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
99 304 m 
gs 1 -1 scale (Send) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
99 404 m 
gs 1 -1 scale (Receive) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
459 304 m 
gs 1 -1 scale (Send) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
459 404 m 
gs 1 -1 scale (Receive) col-1 show gr
1.000 setlinewidth
% Polyline
n 266 139 m 259 139 259 272 7 arcto 4 {pop} repeat 259 279 352 279 7 arcto 4 {pop} repeat 359 279 359 146 7 arcto 4 {pop} repeat 359 139 266 139 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 266 139 m 259 139 259 272 7 arcto 4 {pop} repeat 259 279 352 279 7 arcto 4 {pop} repeat 359 279 359 146 7 arcto 4 {pop} repeat 359 139 266 139 7 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 86 279 m 79 279 79 412 7 arcto 4 {pop} repeat 79 419 172 419 7 arcto 4 {pop} repeat 179 419 179 286 7 arcto 4 {pop} repeat 179 279 86 279 7 arcto 4 {pop} repeat clp gs col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
279 164 m 
gs 1 -1 scale (Send) col-1 show gr
% Polyline
n 446 279 m 439 279 439 412 7 arcto 4 {pop} repeat 439 419 532 419 7 arcto 4 {pop} repeat 539 419 539 286 7 arcto 4 {pop} repeat 539 279 446 279 7 arcto 4 {pop} repeat clp gs col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
69 264 m 
gs 1 -1 scale (2) col-1 show gr
% Polyline
n 454 298 m 164 394 l gs col-1 s gr
n 180.446 392.769 m 164.000 394.000 l 177.932 385.174 l gs 2 setlinejoin col-1 s gr
% Polyline
n 144 289 m 269 259 l gs col-1 s gr
n 252.508 258.844 m 269.000 259.000 l 254.375 266.624 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 319 m 119 379 l gs col-1 s gr
n 123.000 363.000 m 119.000 379.000 l 115.000 363.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 299 179 m 299 239 l gs col-1 s gr
n 303.000 223.000 m 299.000 239.000 l 295.000 223.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 319 164 m 454 384 l gs col-1 s gr
n 449.041 368.271 m 454.000 384.000 l 442.222 372.455 l gs 2 setlinejoin col-1 s gr
% Polyline
n 479 319 m 479 379 l gs col-1 s gr
n 483.000 363.000 m 479.000 379.000 l 475.000 363.000 l gs 2 setlinejoin col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
249 129 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
429 264 m 
gs 1 -1 scale (1) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1536 a Fo(Figure)h(9.3)249 1574 y Fz(Cycle)e(in)g(comm)o(unicat)o
(ion)d(graph)i(is)i(brok)o(en)d(b)o(y)i(using)g(bu\013ered)e(sends.)291
1676 y FA(Another)17 b(approac)o(h)g(is)f(to)h(use)h(non)o(blo)q(c)o
(king)d(comm)o(unication.)23 b(One)18 b(can)f(either)g(use)h(a)249
1730 y(non)o(blo)q(c)o(king)e(send,)i(a)e(non)o(blo)q(c)o(king)g
(receiv)o(e,)j(or)d(b)q(oth.)28 b(If)16 b(a)h(non)o(blo)q(c)o(king)e
(send)j(is)f(used,)249 1784 y(the)h(call)f(to)h Fr(MPI)p
528 1784 14 2 v 15 w(Isend\(\))f FA(initiates)g(the)h(send)h(op)q
(eration)f(and)f(then)i(returns.)31 b(The)18 b(call)249
1838 y(to)e Fr(MPI)p 371 1838 V 15 w(Recv\(\))e FA(can)i(then)h(b)q(e)f
(made,)e(and)i(the)g(comm)o(unication)d(completes)i(successfully)m(.)
249 1892 y(After)h(the)f(call)g(to)g Fr(MPI)p 630 1892
V 15 w(Isend\(\))p FA(,)e(the)j(data)e(in)h Fr(buf1)f
FA(m)o(ust)g(not)h(b)q(e)h(c)o(hanged)f(un)o(til)f(one)i(is)249
1946 y(certain)h(that)g(the)h(data)e(ha)o(v)o(e)h(b)q(een)h(sen)o(t)f
(or)g(copied)g(b)o(y)g(the)g(system.)27 b Fw(MPI)16 b
FA(pro)o(vides)h(the)249 2000 y(routines)d Fr(MPI)p 477
2000 V 15 w(Wait\(\))f FA(and)h Fr(MPI)p 784 2000 V 15
w(Test\(\))e FA(to)i(c)o(hec)o(k)g(on)g(this.)k(Th)o(us,)13
b(the)i(follo)o(wing)c(co)q(de)k(is)249 2054 y(p)q(ortable,)249
2149 y Fr(...)249 2203 y(MPI_Isend)20 b(\(buf1,)h(count,)f(MPI_INT,)g
(clock,)h(tag,)g(comm,)g(&request\);)249 2257 y(MPI_Recv)f(\(buf2,)h
(count,)f(MPI_INT,)g(anticlock,)g(tag,)h(comm,)g(&status\);)249
2311 y(MPI_Wait)f(\(&request,)g(&status\);)p eop
%%Page: 319 333
319 332 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Conclusions)1241 b(319)291 507
y FA(The)17 b(corresp)q(onding)h(acyclic)f(comm)o(unication)d(graph)j
(is)g(sho)o(wn)g(in)g(Figure)g(9.4.)27 b(Eac)o(h)471
565 y
 16577003 13593140 0 0 34930114 28746629 startTexFig
 471 565 a
%%BeginDocument: ../figures/conc-nocycle3.ps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
/col8 {.68 .85 .9 setrgbcolor} bind def
/col9 {0 .39 0 setrgbcolor} bind def
/col10 {.65 .17 .17 setrgbcolor} bind def
/col11 {1 .51 0 setrgbcolor} bind def
/col12 {.63 .13 .94 setrgbcolor} bind def
/col13 {1 .75 .8 setrgbcolor} bind def
/col14 {.7 .13 .13 setrgbcolor} bind def
/col15 {1 .84 0 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-18.0 535.0 translate 0.900 -0.900 scale
1.000 setlinewidth
n 518.453 448.468 m 524.000 464.000 l 511.797 452.906 l gs 2 setlinejoin col-1 s gr
% Polyline
n 524 464 m 324 164 l gs col-1 s gr
n 125.489 469.329 m 109.000 469.000 l 123.704 461.531 l gs 2 setlinejoin col-1 s gr
% Polyline
n 109 469 m 524 374 l gs col-1 s gr
n 253.432 259.444 m 269.000 254.000 l 257.825 266.130 l gs 2 setlinejoin col-1 s gr
% Polyline
n 269 254 m 94 369 l gs col-1 s gr
% Polyline
n 69 494 m 69 554 l gs col-1 s gr
n 73.000 538.000 m 69.000 554.000 l 65.000 538.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 69 394 m 69 454 l gs col-1 s gr
n 73.000 438.000 m 69.000 454.000 l 65.000 438.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 269 139 m 259 139 259 369 10 arcto 4 {pop} repeat 259 379 349 379 10 arcto 4 {pop} repeat 359 379 359 149 10 arcto 4 {pop} repeat 359 139 269 139 10 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 299 279 m 299 339 l gs col-1 s gr
n 303.000 323.000 m 299.000 339.000 l 295.000 323.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 299 179 m 299 239 l gs col-1 s gr
n 303.000 223.000 m 299.000 239.000 l 295.000 223.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 524 474 m 319 364 l gs col-1 s gr
n 331.207 375.090 m 319.000 364.000 l 334.990 368.040 l gs 2 setlinejoin col-1 s gr
% Polyline
n 114 479 m 524 574 l gs col-1 s gr
n 509.316 566.492 m 524.000 574.000 l 507.510 574.285 l gs 2 setlinejoin col-1 s gr
% Polyline
n 274 264 m 94 569 l gs col-1 s gr
n 105.577 557.254 m 94.000 569.000 l 98.687 553.188 l gs 2 setlinejoin col-1 s gr
% Polyline
n 519 354 m 509 354 509 584 10 arcto 4 {pop} repeat 509 594 599 594 10 arcto 4 {pop} repeat 609 594 609 364 10 arcto 4 {pop} repeat 609 354 519 354 10 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 39 354 m 29 354 29 584 10 arcto 4 {pop} repeat 29 594 119 594 10 arcto 4 {pop} repeat 129 594 129 364 10 arcto 4 {pop} repeat 129 354 39 354 10 arcto 4 {pop} repeat clp gs col-1 s gr
% Polyline
n 549 494 m 549 554 l gs col-1 s gr
n 553.000 538.000 m 549.000 554.000 l 545.000 538.000 l gs 2 setlinejoin col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
529 379 m 
gs 1 -1 scale (Isend) col-1 show gr
% Polyline
n 549 394 m 549 454 l gs col-1 s gr
n 553.000 438.000 m 549.000 454.000 l 545.000 438.000 l gs 2 setlinejoin col-1 s gr
/Times-Bold findfont 18.00 scalefont setfont
49 479 m 
gs 1 -1 scale (Receive) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
49 579 m 
gs 1 -1 scale (Wait) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
19 344 m 
gs 1 -1 scale (2) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
249 129 m 
gs 1 -1 scale (0) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
279 264 m 
gs 1 -1 scale (Receive) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
279 364 m 
gs 1 -1 scale (Wait) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
279 164 m 
gs 1 -1 scale (Isend) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
49 379 m 
gs 1 -1 scale (Isend) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
529 479 m 
gs 1 -1 scale (Receive) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
529 579 m 
gs 1 -1 scale (Wait) col-1 show gr
/Times-Bold findfont 18.00 scalefont setfont
499 344 m 
gs 1 -1 scale (1) col-1 show gr
$F2psEnd
%%EndDocument

 endTexFig
 249 1488 a Fo(Figure)13 b(9.4)249 1526 y Fz(Cycle)e(in)g(comm)o
(unicat)o(ion)d(graph)i(is)i(brok)o(en)d(b)o(y)i(using)g(non)o(blo)q(c)
o(kin)o(g)e(sends.)249 1628 y FA(receiv)o(e)20 b(op)q(eration)e(dep)q
(ends)i(on)e(the)h(matc)o(hing)d(send,)k(and)e(eac)o(h)h(w)o(ait)f(dep)
q(ends)i(on)e(the)249 1682 y(matc)o(hing)12 b(comm)o(unication;)f(the)k
(send)g(do)q(es)g(not)f(dep)q(end)i(on)e(the)h(matc)o(hing)d(receiv)o
(e,)j(as)g(a)249 1736 y(non)o(blo)q(c)o(king)e(send)h(call)g(will)e
(return)j(ev)o(en)g(if)e(no)g(matc)o(hing)f(receiv)o(e)k(is)d(p)q
(osted.)291 1790 y(\(P)o(osted)19 b(non)o(blo)q(c)o(king)f(comm)o
(unications)e(do)j(consume)f(resources:)31 b Fw(MPI)18
b FA(has)h(to)g(k)o(eep)249 1844 y(trac)o(k)f(of)e(suc)o(h)i(p)q(osted)
g(comm)o(unications.)25 b(But)18 b(the)f(amoun)o(t)f(of)g(resources)k
(consumed)d(is)249 1898 y(prop)q(ortional)i(to)h(the)h(n)o(um)o(b)q(er)
f(of)f(p)q(osted)i(comm)o(unications,)e(not)h(to)g(the)h(total)e(size)i
(of)249 1952 y(the)e(p)q(ending)f(messages.)32 b(Go)q(o)q(d)17
b Fw(MPI)h FA(implemen)o(tatio)o(ns)e(will)h(supp)q(ort)i(a)f(large)g
(n)o(um)o(b)q(er)249 2006 y(of)i(p)q(ending)g(non)o(blo)q(c)o(king)f
(comm)o(uni)o(cations,)g(so)h(that)g(this)g(will)f(not)h(cause)h(p)q
(ortabilit)o(y)249 2060 y(problems.\))291 2114 y(An)15
b(alternativ)o(e)g(approac)o(h)g(is)g(to)g(p)q(erform)f(a)h(non)o(blo)q
(c)o(king)f(receiv)o(e)i(\014rst)g(to)f(initiate)f(\(or)249
2168 y(\\p)q(ost"\))g(the)h(receiv)o(e,)f(and)g(then)h(to)e(p)q(erform)
g(a)h(blo)q(c)o(king)f(send)i(in)e(standard)h(mo)q(de.)249
2263 y Fr(...)249 2317 y(MPI_Irecv)20 b(\(buf2,)h(count,)f(MPI_INT,)g
(anticlock,)g(tag,)h(comm,)g(&request\);)249 2371 y(MPI_Send)f(\(buf1,)
h(count,)f(MPI_INT,)g(clock,)h(tag,)g(comm\):)249 2425
y(MPI_Wait)f(\(&request,)g(&status\);)p eop
%%Page: 320 334
320 333 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(320)1256 b(Chapter)13 b(9)291
507 y FA(The)f(call)f(to)g Fr(MPI)p 565 507 14 2 v 15
w(Irecv\(\))f FA(indicates)i(to)g Fw(MPI)f FA(that)h(incoming)d(data)i
(should)h(b)q(e)g(stored)h(in)249 561 y Fr(buf2)p FA(;)e(th)o(us,)g(no)
g(bu\013ering)h(is)f(required.)18 b(The)11 b(call)f(to)h
Fr(MPI)p 1176 561 V 15 w(Wait\(\))f FA(is)h(needed)i(to)e(blo)q(c)o(k)f
(un)o(til)249 615 y(the)h(data)f(has)g(actually)f(b)q(een)j(receiv)o
(ed)f(in)o(to)f Fr(buf2)p FA(.)16 b(This)10 b(alternativ)o(e)g(co)q(de)
h(will)d(often)j(result)249 669 y(in)19 b(impro)o(v)o(ed)f(p)q
(erformance,)i(since)h(sends)g(complete)e(faster)h(in)f(man)o(y)f
(implem)o(en)o(tations)249 723 y(when)c(the)h(matc)o(hing)d(receiv)o(e)
j(is)f(already)f(p)q(osted.)291 777 y(Finally)m(,)i(a)h(p)q(ortable)i
(shift)e(op)q(eration)h(can)g(b)q(e)h(implemen)o(ted)d(using)h(the)i
(routine)f Fw(MPI-)p 249 831 13 2 v 262 831 a(Sendrecv\(\))p
FA(,)j(whic)o(h)d(w)o(as)g(explicitly)f(designed)i(to)f(send)h(to)f
(one)g(pro)q(cess)i(while)e(receiving)249 885 y(from)12
b(another)i(in)f(a)g(safe)h(and)g(p)q(ortable)g(w)o(a)o(y)m(.)i(In)e
(this)g(case)g(only)f(a)g(single)h(call)e(is)i(required;)249
965 y Fr(...)249 1019 y(MPI_Sendrecv)19 b(\(buf1,)i(count,)f(MPI_INT,)h
(clock,)f(tag,)554 1073 y(buf2,)h(count,)f(MPI_INT,)h(anticlock,)e
(tag,)i(comm,)g(&status\);)249 1153 y Fs(9.2.2)48 b(Collectiv)o(e)13
b(Comm)o(unication)g(and)i(Sync)o(hronizati)o(on)249
1236 y FA(The)20 b Fw(MPI)f FA(sp)q(eci\014cation)i(purp)q(osefully)f
(do)q(es)g(not)g(mandate)f(whether)i(or)f(not)f(collectiv)o(e)249
1290 y(comm)o(unication)11 b(op)q(erations)k(ha)o(v)o(e)g(the)g(side)g
(e\013ect)i(of)d(sync)o(hronizing)h(the)g(pro)q(cesses)i(o)o(v)o(er)249
1344 y(whic)o(h)f(they)g(op)q(erate.)26 b(Th)o(us,)16
b(in)g(one)g(v)n(alid)e(implemen)o(tation)f(collectiv)o(e)j(comm)o
(unicatio)o(n)249 1398 y(op)q(erations)f(ma)o(y)e(sync)o(hronize)j(pro)
q(cesses,)i(while)c(in)h(another)g(equally)f(v)n(alid)g(implem)o(en)o
(ta-)249 1452 y(tion)h(they)g(do)g(not.)22 b(P)o(ortable)15
b Fw(MPI)f FA(programs,)g(therefore,)j(m)o(ust)d(not)h(rely)g(on)g
(whether)h(or)249 1506 y(not)11 b(collectiv)o(e)g(comm)o(unication)d
(op)q(erations)j(sync)o(hronize)h(pro)q(cesses.)20 b(Th)o(us,)11
b(the)h(follo)o(wing)249 1560 y(assumptions)h(m)o(ust)g(b)q(e)h(a)o(v)o
(oided.)196 1643 y(1.)20 b(W)m(e)14 b(assume)f Fr(MPI)p
533 1643 14 2 v 15 w(Bcast\(\))f FA(acts)j(as)f(a)g(barrier)g(sync)o
(hronization)g(and)g(it)f(do)q(esn't.)249 1744 y Fr(MPI_Irecv)20
b(\(buf2,)h(count,)f(MPI_INT,)g(anticlock,)g(tag,)h(comm,)g(&status\);)
249 1798 y(MPI_Bcast)f(\(buf3,)h(1,)g(MPI_CHAR,)f(0,)h(comm\);)249
1852 y(MPI_Rsend)f(\(buf1,)h(count,)f(MPI_INT,)g(clock,)h(tag,)g
(comm\);)249 1954 y FA(Here)d(if)d(w)o(e)i(w)o(an)o(t)f(to)g(p)q
(erform)g(the)h(send)g(in)f(ready)h(mo)q(de)e(w)o(e)i(m)o(ust)e(b)q(e)i
(certain)g(that)g(the)249 2008 y(receiv)o(e)12 b(has)f(already)f(b)q
(een)h(initiated)f(at)h(the)g(destination.)16 b(The)11
b(ab)q(o)o(v)o(e)g(co)q(de)g(is)f(nonp)q(ortable)249
2062 y(b)q(ecause)j(if)d(the)h(broadcast)h(do)q(es)f(not)g(act)g(as)g
(a)g(barrier)g(sync)o(hronization)g(w)o(e)g(cannot)g(b)q(e)g(sure)249
2116 y(this)j(is)g(the)g(case.)196 2180 y(2.)20 b(W)m(e)g(assume)g
(that)g Fr(MPI)p 642 2180 V 15 w(Bcast\(\))f FA(do)q(es)i(not)f(act)h
(as)f(a)h(barrier)f(sync)o(hronization)h(and)f(it)249
2234 y(do)q(es.)f(Examples)13 b(of)g(this)h(case)h(are)f(giv)o(en)f(in)
h(Examples)e(4.24,)g(4.25,)h(and)g(4.26)g(starting)h(on)249
2288 y(page)g(196.)249 2371 y Fs(9.2.3)48 b(Am)o(biguous)13
b(Comm)o(unication)o(s)g(and)i(P)o(ortabili)o(t)n(y)249
2454 y Fw(MPI)e FA(emplo)o(ys)e(the)j(comm)o(unicator)c(abstraction)k
(to)f(promote)f(soft)o(w)o(are)h(mo)q(dularit)o(y)d(b)o(y)j(al-)249
2508 y(lo)o(wing)e(the)j(construction)g(of)e(indep)q(enden)o(t)j(comm)o
(uni)o(cation)10 b(streams)j(b)q(et)o(w)o(een)h(pro)q(cesses,)p
eop
%%Page: 321 335
321 334 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Conclusions)1241 b(321)249 507
y FA(thereb)o(y)17 b(ensuring)e(that)h(messages)f(sen)o(t)h(in)f(one)h
(phase)g(of)f(an)g(application)f(are)h(not)h(incor-)249
561 y(rectly)e(in)o(tercepted)h(b)o(y)f(another)g(phase.)k(Comm)o
(unicators)11 b(are)j(particularly)e(imp)q(ortan)o(t)g(in)249
615 y(allo)o(wing)h(libraries)h(that)h(mak)o(e)f(message)h(passing)f
(calls)h(to)g(b)q(e)g(used)h(safely)f(within)f(an)h(ap-)249
669 y(plication.)j(The)d(p)q(oin)o(t)f(here)i(is)e(that)g(the)h
(application)e(dev)o(elop)q(er)i(has)g(no)f(w)o(a)o(y)g(of)g(kno)o
(wing)249 723 y(if)h(the)i(tag,)f(group,)g(and)g(rank)g(completely)f
(disam)o(biguate)f(the)j(message)f(tra\016c)h(of)e(di\013er-)249
777 y(en)o(t)g(libraries)f(and)h(the)g(rest)h(of)e(the)h(application.)k
(Comm)n(unicators,)12 b(in)i(e\013ect,)i(pro)o(vide)f(an)249
831 y(additional)h(criterion)i(for)f(message)h(selection,)g(and)g
(hence)h(p)q(ermits)e(the)h(construction)h(of)249 885
y(indep)q(enden)o(t)c(tag)f(spaces.)291 939 y(W)m(e)f(discussed)j(in)e
(Section)g(5.5)f(p)q(ossible)h(hazards)h(when)g(a)e(library)h(uses)h
(the)g(same)e(com-)249 993 y(m)o(unicator)j(as)h(the)h(calling)d(co)q
(de.)29 b(The)18 b(incorrect)g(matc)o(hing)e(of)g(sends)j(executed)g(b)
o(y)e(the)249 1047 y(caller)c(co)q(de)h(with)f(receiv)o(es)i(executed)h
(b)o(y)d(the)g(library)g(o)q(ccurred)i(b)q(ecause)g(the)f(library)f(co)
q(de)249 1101 y(used)h(wildcarded)f(receiv)o(es.)19 b(Con)o(v)o(ersely)
m(,)12 b(incorrect)j(matc)o(hes)d(ma)o(y)f(o)q(ccur)j(when)f(the)g
(caller)249 1155 y(co)q(de)i(uses)g(wildcarded)f(receiv)o(es,)h(ev)o
(en)f(if)g(the)g(library)f(co)q(de)i(b)o(y)f(itself)f(is)h
(deterministic.)291 1209 y(Consider)e(the)g(example)f(in)g(Figure)h
(9.5.)k(If)c(the)g(program)f(b)q(eha)o(v)o(es)h(correctly)h(pro)q
(cesses)i(0)249 1263 y(and)e(1)g(eac)o(h)h(receiv)o(e)h(a)d(message)h
(from)f(pro)q(cess)j(2,)e(using)g(a)g(wildcarded)g(selection)h
(criterion)249 1317 y(to)d(indicate)g(that)h(they)f(are)h(prepared)h
(to)e(receiv)o(e)h(a)f(message)g(from)f(an)o(y)g(pro)q(cess.)19
b(The)12 b(three)249 1371 y(pro)q(cesses)19 b(then)e(pass)g(data)g
(around)f(in)g(a)g(ring)g(within)g(the)h(library)f(routine.)26
b(If)16 b(separate)249 1425 y(comm)o(unicators)8 b(are)k(not)e(used)i
(for)e(the)i(comm)o(unicatio)o(n)c(inside)j(and)f(outside)i(of)e(the)h
(library)249 1479 y(routine)j(this)g(program)f(ma)o(y)f(in)o(termitten)
o(tly)h(fail.)k(Supp)q(ose)e(w)o(e)f(dela)o(y)f(the)i(sending)f(of)g
(the)249 1533 y(second)h(message)f(sen)o(t)h(b)o(y)f(pro)q(cess)i(2,)e
(for)g(example,)e(b)o(y)i(inserting)h(some)e(computation,)f(as)249
1587 y(sho)o(wn)i(in)f(Figure)g(9.6.)k(In)d(this)f(case)i(the)f
(wildcarded)g(receiv)o(e)g(in)f(pro)q(cess)j(0)d(is)g(satis\014ed)i(b)o
(y)249 1641 y(a)f(message)f(sen)o(t)i(from)d(pro)q(cess)k(1,)d(rather)i
(than)f(from)e(pro)q(cess)j(2,)f(and)f(deadlo)q(c)o(k)h(results.)291
1694 y(Ev)o(en)h(if)g(neither)h(caller)f(nor)h(callee)f(use)h
(wildcarded)g(receiv)o(es,)h(incorrect)f(matc)o(hes)f(ma)o(y)249
1748 y(still)10 b(o)q(ccur)h(if)f(a)g(send)i(initiated)e(b)q(efore)h
(the)g(collectiv)o(e)g(library)f(in)o(v)o(o)q(cation)f(is)h(to)h(b)q(e)
g(matc)o(hed)249 1802 y(b)o(y)j(a)g(receiv)o(e)i(p)q(osted)f(after)g
(the)g(in)o(v)o(o)q(cation)e(\(Ex.)h(5.10,)f(page)i(226\).)k(By)14
b(using)g(a)g(di\013eren)o(t)249 1856 y(comm)o(unicator)g(in)i(the)h
(library)f(routine)g(w)o(e)h(can)g(ensure)h(that)e(the)h(program)e(is)h
(executed)249 1910 y(correctly)m(,)e(regardless)h(of)f(when)g(the)g
(pro)q(cesses)j(en)o(ter)e(the)g(library)e(routine.)249
2031 y FD(9.3)52 b(Heterogeneous)17 b(Computing)h(with)g
Fw(MPI)249 2139 y FA(Heterogeneous)c(computing)c(uses)j(di\013eren)o(t)
f(computers)g(connected)h(b)o(y)f(a)f(net)o(w)o(ork)h(to)g(solv)o(e)249
2193 y(a)g(problem)f(in)h(parallel.)17 b(With)11 b(heterogeneous)k
(computing)10 b(a)j(n)o(um)o(b)q(er)e(of)h(issues)i(arise)e(that)249
2247 y(are)i(not)f(applicable)g(when)h(using)f(a)g(homogeneous)f
(parallel)g(computer.)18 b(F)m(or)13 b(example,)f(the)249
2301 y(computers)i(ma)o(y)e(b)q(e)j(of)f(di\013ering)g(computational)d
(p)q(o)o(w)o(er,)j(so)h(care)g(m)o(ust)e(b)q(e)h(tak)o(en)h(to)f(dis-)
249 2355 y(tribute)f(the)g(w)o(ork)f(b)q(et)o(w)o(een)i(them)e(to)g(a)o
(v)o(oid)f(load)h(im)o(balance.)j(Other)f(problems)e(ma)o(y)e(arise)249
2408 y(b)q(ecause)k(of)e(the)h(di\013eren)o(t)g(b)q(eha)o(vior)g(of)e
(\015oating)h(p)q(oin)o(t)g(arithmetic)f(on)h(di\013eren)o(t)i(mac)o
(hines.)249 2462 y(Ho)o(w)o(ev)o(er,)19 b(the)g(t)o(w)o(o)f(most)f
(fundamen)o(tal)f(issues)k(that)e(m)o(ust)f(b)q(e)i(faced)g(in)e
(heterogeneous)p eop
%%Page: 322 336
322 335 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(322)1256 b(Chapter)13 b(9)249
1066 y @beginspecial @setspecial
%%BeginDocument: ../figures/conclusion-lib1.ps
% Cookbook Example Program from First Printing, Revised 7 Jan 1985
% Program: Drawing Arrows     Number: 8
%-----------------------------------------------------------------------------
%
/arrowdict 13 dict def                      % Local storage for the procedure
					    % ``arrow.''
							
/arrow                                      % The procedure ``arrow'' adds an
  { arrowdict begin                         % arrow shape to the current path.
      /headlength exch def                  % It takes seven arguments: the x
      /halfheadthickness exch 2 div def     % and y coordinates of the tail
      /halfthickness exch 2 div def         % (imagine that a line has been
      /tipy exch def /tipx exch def         % drawn down the center of the
      /taily exch def /tailx exch def       % arrow from the tip to the tail,
					    % then x and y lie on this line),
					    % the x and y coordinates of the
					    % tip of the arrow, the thickness
					    % of the arrow in the tail
					    % portion, the thickness of the
					    % arrow at the widest part of the
					    % arrowhead and the length of the
					    % arrowhead.
							
      /dx tipx tailx sub def                % Compute the differences in x and
      /dy tipy taily sub def                % y for the tip and tail. These
      /arrowlength dx dx mul dy dy mul add  % will be used to compute the
	sqrt def                            % length of the arrow and to
      /angle dy dx atan def                 % compute the angle of direction
					    % that the arrow is facing with
					    % respect to the current user
					    % coordinate system origin.
      /base arrowlength headlength sub def  % Compute where the base of the
					    % arrowhead will be.
								
      /savematrix matrix currentmatrix def  % Save the current user coordinate
					    % system. We are using the same
					    % strategy to localize the effect
					    % of transformations as was used
					    % in the program to draw an
					    % ellipse.
      tailx taily translate                 % Translate to the starting point
					    % of the tail.
      angle rotate                          % Rotate the x-axis to correspond
					    % with the center line of the
					    % arrow.
      0 halfthickness neg moveto            % Add the arrow shape to the
					    % current path.
      base halfthickness neg lineto
      base halfheadthickness neg lineto
      arrowlength 0 lineto
      base halfheadthickness lineto
      base halfthickness lineto
      0 halfthickness lineto
      closepath
	       
      savematrix setmatrix                  % Restore the current user
					    % coordinate system.
    end
  } def
/Box
{ /height exch def
  /length exch def

   length 0 rlineto
   0 height rlineto
   length neg 0 rlineto
   closepath
} def
                       
/c1  100 def
/c2  200 def
/c3  300 def
/alpha .75 def
/wid c2 c1 sub alpha mul def
/libg c2 c1 sub alpha mul 8 sub def

2 setlinewidth
5.625 72 mul 2 div c2 .7 mul sub 120 translate
-30 0 translate
0.7 0.7 scale

/Helvetica findfont 16 scalefont setfont

(Process 0) dup stringwidth pop 2 div c1 exch sub 0 moveto show
(Process 1) dup stringwidth pop 2 div c2 exch sub 0 moveto show
(Process 2) dup stringwidth pop 2 div c3 exch sub 0 moveto show

c1 wid 2 div sub -60 moveto 
wid 50 Box stroke

c2 wid 2 div sub -32 moveto 
wid 22 Box stroke

c3 wid 2 div sub -32 moveto 
wid 22 Box stroke

(recv\050any\051) dup stringwidth pop 2 div c1 exch sub -25 moveto show
(recv\050any\051) dup stringwidth pop 2 div c2 exch sub -25 moveto show
(send\0501\051) dup stringwidth pop 2 div c3 exch sub -25 moveto show

c3 wid 2 div sub -32 c2 wid 2 div add -32 1 7 8 arrow fill

c3 wid 2 div sub -60 moveto 
wid 22 Box stroke
(send\0500\051) dup stringwidth pop 2 div c3 exch sub -53 moveto show
c3 wid 2 div sub -60 c1 wid 2 div add -60 1 7 8 arrow fill

c1 wid 2 div sub -134 moveto
wid 66 Box gsave 0.85 setgray fill grestore stroke

c1 libg 2 div sub -98 moveto
libg 22 Box gsave 1 setgray fill grestore stroke

c1 libg 2 div sub -126 moveto
libg 22 Box gsave 1 setgray fill grestore stroke

(recv\0501\051) dup stringwidth pop 2 div c1 exch sub -91 moveto show
(send\0502\051) dup stringwidth pop 2 div c1 exch sub -119 moveto show

c3 wid 2 div sub -162 moveto
wid 94 Box gsave 0.85 setgray fill grestore stroke

c3 libg 2 div sub -126 moveto
libg 50 Box gsave 1 setgray fill grestore stroke

c3 libg 2 div sub -154 moveto
libg 22 Box gsave 1 setgray fill grestore stroke

(recv\0500\051) dup stringwidth pop 2 div c3 exch sub -91 moveto show
(send\0501\051) dup stringwidth pop 2 div c3 exch sub -147 moveto show
c1 libg 2 div add -126 c3 libg 2 div sub -126 1 7 8 arrow fill

c2 wid 2 div sub -162 moveto
wid 122 Box gsave 0.85 setgray fill grestore stroke

c2 libg 2 div sub -70 moveto
libg 22 Box gsave 1 setgray fill grestore stroke

c2 libg 2 div sub -154 moveto
libg 78 Box gsave 1 setgray fill grestore stroke

(send\0500\051) dup stringwidth pop 2 div c2 exch sub -63 moveto show
(recv\0502\051) dup stringwidth pop 2 div c2 exch sub -91 moveto show

c2 libg 2 div sub -70 c1 libg 2 div add -98 1 7 8 arrow fill
c3 libg 2 div sub -154 c2 libg 2 div add -154 1 7 8 arrow fill


%%EndDocument
 @endspecial 62 x Fo(Figure)g(9.5)249 1165 y Fz(Use)f(of)f(comm)o
(unicat)o(ors.)h(Num)o(b)q(ers)e(in)h(paren)o(theses)e(indicate)g(the)i
(pro)q(cess)f(to)h(whic)o(h)g(data)f(are)h(b)q(eing)249
1203 y(sen)o(t)g(or)g(receiv)o(ed.)i(The)e(gra)o(y)g(shaded)f(area)g
(represen)o(ts)f(the)i(library)f(routine)f(call.)15 b(In)c(this)g(case)
f(the)249 1240 y(program)f(b)q(eha)o(v)o(es)h(as)h(in)o(tended.)i(Note)
e(that)g(the)f(second)g(message)g(sen)o(t)h(b)o(y)g(pro)q(cess)f(2)h
(is)g(receiv)o(ed)f(b)o(y)249 1277 y(pro)q(cess)g(0,)h(and)g(that)f
(the)h(message)f(sen)o(t)g(b)o(y)h(pro)q(cess)f(0)i(is)f(receiv)o(ed)f
(b)o(y)h(pro)q(cess)e(2.)249 1400 y FA(computing)j(are,)208
1483 y Ft(\017)20 b FA(incompatible)12 b(data)h(represen)o(tation,)208
1554 y Ft(\017)20 b FA(in)o(terop)q(erabilit)o(y)13 b(of)g(di\013ering)
h(implemen)o(tations)d(of)i(the)i(message)e(passing)h(la)o(y)o(er.)291
1637 y(Incompatible)9 b(data)i(represen)o(tations)i(arise)f(when)f
(computers)h(use)g(di\013eren)o(t)g(binary)f(rep-)249
1691 y(resen)o(tations)22 b(for)f(the)h(same)e(n)o(um)o(b)q(er.)40
b(In)21 b Fw(MPI)f FA(all)g(comm)o(unication)e(routines)k(ha)o(v)o(e)f
(a)249 1745 y(datat)o(yp)q(e)e(argumen)o(t)f(so)h(implemen)o(tations)d
(can)k(use)f(this)h(information)c(to)j(p)q(erform)f(the)249
1799 y(appropriate)13 b(represen)o(tation)i(con)o(v)o(ersion)e(when)h
(comm)o(unicati)o(ng)c(data)j(b)q(et)o(w)o(een)i(comput-)249
1853 y(ers.)291 1907 y(In)o(terop)q(erabilit)o(y)d(refers)i(to)f(the)h
(abilit)o(y)d(of)h(di\013eren)o(t)i(implem)o(en)o(tations)c(of)j(a)f
(giv)o(en)h(piece)249 1961 y(of)18 b(soft)o(w)o(are)h(to)g(w)o(ork)g
(together)h(as)f(if)f(they)h(w)o(ere)h(a)f(single)g(homogeneous)f
(implem)o(en)o(ta-)249 2015 y(tion.)f(A)12 b(prerequisite)i(of)d(in)o
(terop)q(erabilit)o(y)h(for)g Fw(MPI)f FA(w)o(ould)h(b)q(e)h(the)f
(standardization)g(of)g(the)249 2068 y Fw(MPI)p FA('s)17
b(in)o(ternal)g(data)g(structures,)j(of)c(the)i(comm)o(unication)c
(proto)q(cols,)k(of)f(the)h(initializa-)249 2122 y(tion,)10
b(termination)f(and)i(error)g(handling)f(pro)q(cedures,)j(of)d(the)h
(implemen)o(tation)c(of)j(collectiv)o(e)249 2176 y(op)q(erations,)18
b(and)f(so)g(on.)28 b(Since)18 b(this)f(has)g(not)g(b)q(een)i(done,)f
(there)g(is)f(no)g(supp)q(ort)h(for)f(in-)249 2230 y(terop)q(erabilit)o
(y)h(in)g Fw(MPI)p FA(.)f(In)i(general,)g(hardw)o(are-sp)q(eci\014c)h
(implemen)o(tations)15 b(of)j Fw(MPI)g FA(will)249 2284
y(not)c(b)q(e)g(in)o(terop)q(erable.)k(Ho)o(w)o(ev)o(er)c(it)g(is)f
(still)g(p)q(ossible)h(for)f(di\013eren)o(t)h(arc)o(hitectures)i(to)e
(w)o(ork)249 2338 y(together)h(if)e(they)h(b)q(oth)g(use)h(the)g(same)e
(p)q(ortable)h Fw(MPI)f FA(implemen)o(tatio)o(n.)p eop
%%Page: 323 337
323 336 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Conclusions)1241 b(323)249 1066
y @beginspecial @setspecial
%%BeginDocument: ../figures/conclusion-lib2.ps
% Cookbook Example Program from First Printing, Revised 7 Jan 1985
% Program: Drawing Arrows     Number: 8
%-----------------------------------------------------------------------------
%
/arrowdict 13 dict def                      % Local storage for the procedure
					    % ``arrow.''
							
/arrow                                      % The procedure ``arrow'' adds an
  { arrowdict begin                         % arrow shape to the current path.
      /headlength exch def                  % It takes seven arguments: the x
      /halfheadthickness exch 2 div def     % and y coordinates of the tail
      /halfthickness exch 2 div def         % (imagine that a line has been
      /tipy exch def /tipx exch def         % drawn down the center of the
      /taily exch def /tailx exch def       % arrow from the tip to the tail,
					    % then x and y lie on this line),
					    % the x and y coordinates of the
					    % tip of the arrow, the thickness
					    % of the arrow in the tail
					    % portion, the thickness of the
					    % arrow at the widest part of the
					    % arrowhead and the length of the
					    % arrowhead.
							
      /dx tipx tailx sub def                % Compute the differences in x and
      /dy tipy taily sub def                % y for the tip and tail. These
      /arrowlength dx dx mul dy dy mul add  % will be used to compute the
	sqrt def                            % length of the arrow and to
      /angle dy dx atan def                 % compute the angle of direction
					    % that the arrow is facing with
					    % respect to the current user
					    % coordinate system origin.
      /base arrowlength headlength sub def  % Compute where the base of the
					    % arrowhead will be.
								
      /savematrix matrix currentmatrix def  % Save the current user coordinate
					    % system. We are using the same
					    % strategy to localize the effect
					    % of transformations as was used
					    % in the program to draw an
					    % ellipse.
      tailx taily translate                 % Translate to the starting point
					    % of the tail.
      angle rotate                          % Rotate the x-axis to correspond
					    % with the center line of the
					    % arrow.
      0 halfthickness neg moveto            % Add the arrow shape to the
					    % current path.
      base halfthickness neg lineto
      base halfheadthickness neg lineto
      arrowlength 0 lineto
      base halfheadthickness lineto
      base halfthickness lineto
      0 halfthickness lineto
      closepath
	       
      savematrix setmatrix                  % Restore the current user
					    % coordinate system.
    end
  } def
/Box
{ /height exch def
  /length exch def

   length 0 rlineto
   0 height rlineto
   length neg 0 rlineto
   closepath
} def
                       
/c1  100 def
/c2  200 def
/c3  300 def
/alpha .75 def
/wid c2 c1 sub alpha mul def
/libg c2 c1 sub alpha mul 8 sub def

2 setlinewidth
5.625 72 mul 2 div c2 .7 mul sub 120 translate
-30 0 translate
.7 .7 scale

/Helvetica findfont 16 scalefont setfont

(Process 0) dup stringwidth pop 2 div c1 exch sub 0 moveto show
(Process 1) dup stringwidth pop 2 div c2 exch sub 0 moveto show
(Process 2) dup stringwidth pop 2 div c3 exch sub 0 moveto show

c1 wid 2 div sub -70 moveto 
wid 60 Box stroke

c2 wid 2 div sub -32 moveto 
wid 22 Box stroke

c3 wid 2 div sub -32 moveto 
wid 22 Box stroke

c3 wid 2 div sub -75 moveto 
wid 35 Box stroke

c3 wid 2 div sub -105 moveto 
wid 22 Box stroke

(recv\050any\051) dup stringwidth pop 2 div c1 exch sub -25 moveto show
(recv\050any\051) dup stringwidth pop 2 div c2 exch sub -25 moveto show
(send\0501\051) dup stringwidth pop 2 div c3 exch sub -25 moveto show
(compute) dup stringwidth pop 2 div c3 exch sub -55 moveto show
(send\0500\051) dup stringwidth pop 2 div c3 exch sub -98 moveto show

c3 wid 2 div sub -105 c2 wid 2 div add  12 add -105 1 7 8 arrow fill
c3 wid 2 div sub -32 c2 wid 2 div add -32 1 7 8 arrow fill

c2 wid 2 div sub -173 moveto 
wid 133 Box 0.85 setgray fill 0 setgray

c2 libg 2 div sub -70 moveto 
libg 22 Box gsave 1 setgray fill grestore stroke

c2 libg 2 div sub -173 moveto
libg 97 Box 1 setgray fill 0 setgray

c2 libg 2 div add -173 moveto
c2 libg 2 div add -76 lineto
c2 libg 2 div sub -76 lineto
c2 libg 2 div sub -173 lineto stroke

[3 3] 0 setdash
c2 wid 2 div sub -173 moveto
c2 wid 2 div add -173 lineto
stroke
[] 0 setdash
c2 wid 2 div add -173 moveto
c2 wid 2 div add -40 lineto
c2 wid 2 div sub -40 lineto
c2 wid 2 div sub -173 lineto stroke

(send\0500\051) dup stringwidth pop 2 div c2 exch sub -63 moveto show
(recv\0502\051) dup stringwidth pop 2 div c2 exch sub -91 moveto show

c2 libg 2 div sub -70 c1 wid 2 div add -70 1 7 8 arrow fill

c1 wid 2 div sub -173 moveto
wid 95 Box 0.85 setgray fill 0 setgray

c1 libg 2 div sub -173 moveto
libg 87 Box 1 setgray fill 0 setgray

c1 libg 2 div add -173 moveto
c1 libg 2 div add -86 lineto
c1 libg 2 div sub -86 lineto
c1 libg 2 div sub -174 lineto stroke

[3 3] 0 setdash
c1 wid 2 div sub -173 moveto
c1 wid 2 div add -173 lineto 
stroke
[] 0 setdash
c1 wid 2 div add -173 moveto 
c1 wid 2 div add -78 lineto
c1 wid 2 div sub -78 lineto
c1 wid 2 div sub -173 lineto stroke

(recv\0501\051) dup stringwidth pop 2 div c1 exch sub -101 moveto show

c3 wid 2 div sub -173 moveto
wid 60 Box 0.85 setgray fill 0 setgray

c3 libg 2 div sub -173 moveto
libg 52 Box 1 setgray fill 0 setgray

c3 libg 2 div add -173 moveto
c3 libg 2 div add -121 lineto
c3 libg 2 div sub -121 lineto
c3 libg 2 div sub -174 lineto stroke

[3 3] 0 setdash
c3 wid 2 div sub -173 moveto
c3 wid 2 div add -173 lineto 
stroke
c3 wid 2 div add -173 moveto 
[] 0 setdash
c3 wid 2 div add -113 lineto
c3 wid 2 div sub -113 lineto
c3 wid 2 div sub -173 lineto stroke

(recv\0500\051) dup stringwidth pop 2 div c3 exch sub -136 moveto show

%showpage


%%EndDocument
 @endspecial 62 x Fo(Figure)13 b(9.6)249 1165 y Fz(Unin)o(tended)c(b)q
(eha)o(vior)g(of)i(program.)i(In)e(this)g(case)g(the)g(message)e(from)i
(pro)q(cess)f(2)h(to)g(pro)q(cess)f(0)i(is)f(nev)o(er)249
1203 y(receiv)o(ed,)e(and)i(deadlo)q(c)o(k)e(results.)249
1324 y FD(9.4)52 b Fw(MPI)17 b FD(Implemen)o(tations)249
1432 y FA(A)o(t)d(the)h(time)d(of)h(writing)g(sev)o(eral)i(p)q(ortable)
f(implemen)o(tatio)o(ns)e(of)h Fw(MPI)g FA(exist,)208
1515 y Ft(\017)20 b FA(the)g(MPICH)f(implemen)o(tation)d(from)h
(Argonne)i(National)f(Lab)q(oratory)h(and)g(Mississippi)249
1569 y(State)11 b(Univ)o(ersit)o(y)g([12)o(],)f(a)o(v)n(ailable)f(b)o
(y)i(anon)o(ymous)d(ftp)j(at)g Fw(info.mcs.anl.gov/pub/mpi)p
FA(.)k(This)249 1622 y(v)o(ersion)f(is)g(la)o(y)o(ered)g(on)f(PVM)i(or)
f(P4)f(and)h(can)g(b)q(e)h(run)f(on)g(man)o(y)e(systems.)208
1692 y Ft(\017)20 b FA(The)12 b(CHIMP)g(implemen)o(tatio)o(n)d(from)h
(Edin)o(burgh)h(P)o(arallel)g(Computing)e(Cen)o(ter,)k(a)o(v)n(ailable)
249 1746 y(b)o(y)h(anon)o(ymous)e(ftp)h(at)h Fw(ftp.ep)q
(cc.ed.ac.uk/pub)q(/chimp/release)q(/chimp.ta)o(r.Z)p
FA(.)208 1816 y Ft(\017)20 b FA(the)15 b(LAM)f(implemen)o(tation)d
(from)h(the)j(Ohio)f(Sup)q(ercomputing)g(Cen)o(ter,)h(a)f(full)f
Fw(MPI)g FA(stan-)249 1870 y(dard)i(implemen)o(tation)d(using)i(LAM,)h
(a)g(UNIX)g(cluster)h(computing)e(en)o(vironmen)o(t.)20
b(Av)n(ail-)249 1924 y(able)14 b(b)o(y)f(anon)o(ymous)f(ftp)i(at)g
Fw(tbag.osc.edu/pub/lam)p FA(.)208 1993 y Ft(\017)20
b FA(The)15 b(UNIFY)f(system)g(pro)o(vides)h(a)f(subset)h(of)f
Fw(MPI)f FA(within)h(the)h(PVM)f(en)o(vironmen)o(t,)f(with-)249
2047 y(out)18 b(sacri\014cing)h(the)g(PVM)g(calls)f(already)g(a)o(v)n
(ailable.)29 b(Av)n(ailable)17 b(b)o(y)h(anon)o(ymous)e(ftp)j(at)249
2101 y Fw(ftp.erc.msstate.edu/unify)p FA(.)291 2184 y(In)13
b(addition,)g(hardw)o(are-sp)q(eci\014c)i Fw(MPI)e FA(implemen)o
(tations)e(exist)j(for)f(the)i(Cra)o(y)e(T3D,)g(the)249
2238 y(IBM)h(SP-2,)g(The)g(NEC)g(Cinju,)f(and)h(the)g(F)m(ujitsu)f
(AP1000.)291 2292 y(Information)8 b(on)j Fw(MPI)f FA(implemen)o
(tations)e(and)j(other)g(useful)g(information)e(on)h
Fw(MPI)h FA(can)g(b)q(e)249 2346 y(found)f(on)g(the)h
Fw(MPI)e FA(w)o(eb)i(pages)g(at)f(Argonne)g(National)f(Lab)q(oratory)h
(\()p Fw(http://www.mcs.anl.-)249 2400 y(gov/mpi)p FA(\),)k(and)i(at)f
(Mississippi)g(State)h(Univ)f(\()p Fw(http://www.erc.msstate.edu/mpi)p
FA(\).)24 b(Addi-)249 2454 y(tional)16 b(information)f(can)i(b)q(e)h
(found)f(on)g(the)h Fw(MPI)f FA(newsgroup)h Fw(comp.pa)o(rallel.mpi)d
FA(and)j(on)249 2508 y(netlib.)p eop
%%Page: 324 338
324 337 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(324)1256 b(Chapter)13 b(9)249
507 y FD(9.5)52 b(Extensions)18 b(to)g Fw(MPI)249 615
y FA(When)c(the)h Fw(MPI)e FA(F)m(orum)g(recon)o(v)o(ened)i(in)f(Marc)o
(h)g(1995,)f(the)i(main)d(reason)i(w)o(as)g(to)g(pro)q(duce)249
669 y(a)h(new)i(v)o(ersion)e(of)g Fw(MPI)g FA(that)h(w)o(ould)f(ha)o(v)
o(e)g(signi\014can)o(t)h(new)g(features.)24 b(The)16
b(original)e Fw(MPI)249 723 y FA(is)i(b)q(eing)g(referred)i(to)e(as)g
Fw(MPI)p FA(-1)f(and)h(the)g(new)h(e\013ort)g(is)f(b)q(eing)g(called)f
Fw(MPI)p FA(-2.)24 b(The)16 b(need)249 777 y(and)e(desire)g(to)g
(extend)g Fw(MPI)p FA(-1)f(arose)h(from)e(sev)o(eral)i(factors.)19
b(One)14 b(consideration)g(w)o(as)f(that)249 831 y(the)18
b Fw(MPI)p FA(-1)e(e\013ort)i(had)f(a)g(constrained)h(scop)q(e.)29
b(This)17 b(w)o(as)g(done)g(to)g(a)o(v)o(oid)f(in)o(tro)q(ducing)h(a)
249 885 y(standard)d(that)f(w)o(as)g(seen)i(as)e(to)q(o)g(large)g(and)h
(burdensome)f(for)g(implemen)o(tors.)i(It)f(w)o(as)f(also)249
939 y(done)19 b(to)g(complete)g Fw(MPI)p FA(-1)f(in)h(the)g(F)m
(orum-imp)q(osed)d(deadline)j(of)g(one)g(y)o(ear.)34
b(A)19 b(second)249 993 y(consideration)h(for)f(limiting)d
Fw(MPI)p FA(-1)j(w)o(as)h(the)g(feeling)f(b)o(y)g(man)o(y)f(F)m(orum)g
(mem)o(b)q(ers)g(that)249 1047 y(some)f(prop)q(osed)h(areas)g(w)o(ere)h
(still)d(under)j(in)o(v)o(estigation.)27 b(As)18 b(a)f(result,)i(the)f
Fw(MPI)f FA(F)m(orum)249 1101 y(decided)j(not)e(to)g(prop)q(ose)h(a)g
(standard)f(in)g(these)i(areas)f(for)f(fear)h(of)f(discouraging)f
(useful)249 1155 y(in)o(v)o(estigations)c(in)o(to)g(impro)o(v)o(ed)f
(metho)q(ds.)291 1209 y(The)h Fw(MPI)e FA(F)m(orum)g(is)i(no)o(w)f
(activ)o(ely)g(meeting)f(and)i(discussing)g(extensions)g(to)g
Fw(MPI)p FA(-1)e(that)249 1263 y(will)h(b)q(ecome)i Fw(MPI)p
FA(-2.)j(The)d(areas)h(that)f(are)g(curren)o(tly)h(under)g(discussion)f
(are:)249 1347 y Fs(External)k(In)o(terfaces:)k FA(This)16
b(will)f(de\014ne)j(in)o(terfaces)f(to)f(allo)o(w)f(easy)i(extension)g
(of)f Fw(MPI)249 1401 y FA(with)c(libraries,)g(and)g(facilitate)g(the)h
(implemen)o(tatio)o(n)d(of)i(pac)o(k)n(ages)g(suc)o(h)h(as)g(debuggers)
h(and)249 1455 y(pro\014lers.)j(Among)9 b(the)h(issues)h(considered)g
(are)f(mec)o(hanisms)e(for)i(de\014ning)f(new)i(non)o(blo)q(c)o(king)
249 1509 y(op)q(erations)j(and)g(mec)o(hanisms)e(for)h(accessing)i(in)o
(ternal)f Fw(MPI)f FA(information.)249 1563 y Fs(One-Sided)20
b(Comm)o(unication)o(s:)27 b FA(This)20 b(will)e(extend)j
Fw(MPI)e FA(to)h(allo)o(w)e(comm)o(unicatio)o(n)249 1617
y(that)12 b(do)q(es)g(not)g(require)g(execution)h(of)e(matc)o(hing)f
(calls)h(at)g(b)q(oth)h(comm)o(unicating)c(pro)q(cesses.)249
1671 y(Examples)13 b(of)h(suc)o(h)g(op)q(erations)h(are)f(put/get)h(op)
q(erations)f(that)g(allo)o(w)f(a)h(pro)q(cess)i(to)e(access)249
1724 y(data)f(in)g(another)i(pro)q(cess')g(memory)m(,)10
b(messages)j(with)h(in)o(terrupts)g(\(e.g.,)f(activ)o(e)h(messages\),)
249 1778 y(and)g(Read-Mo)q(dify-W)m(rite)e(op)q(erations)i(\(e.g.,)f
(fetc)o(h)h(and)g(add\).)249 1832 y Fs(Dynamic)d(Resource)f(Managemen)o
(t:)15 b FA(This)c(will)e(extend)i Fw(MPI)f FA(to)g(allo)o(w)e(the)j
(acquisition)249 1886 y(of)19 b(computational)d(resources)22
b(and)d(the)g(spa)o(wning)g(and)g(destruction)h(of)e(pro)q(cesses)k
(after)249 1940 y Fw(MPI)p 326 1940 13 2 v 14 w(INIT)p
FA(.)249 1994 y Fs(Extended)11 b(Collectiv)o(e:)k FA(This)c(will)f
(extend)i(the)g(collectiv)o(e)f(calls)g(to)g(b)q(e)h(non-blo)q(c)o
(king)e(and)249 2048 y(apply)j(to)h(in)o(ter-comm)o(unicators.)249
2102 y Fs(Bindings:)i FA(This)d(will)g(pro)q(duce)i(bindings)e(for)h(F)
m(ortran)f(90)h(and)f(C++.)249 2156 y Fs(Real)i(Time:)j
FA(This)c(will)e(pro)o(vide)i(some)f(supp)q(ort)i(for)e(real)h(time)f
(pro)q(cessing.)249 2240 y(Since)j(the)f Fw(MPI)p FA(-2)f(e\013ort)i
(is)e(ongoing,)g(the)h(topics)h(and)e(areas)i(co)o(v)o(ered)g(are)f
(still)f(sub)r(ject)j(to)249 2294 y(c)o(hange.)291 2348
y(The)h Fw(MPI)f FA(F)m(orum)f(set)j(a)e(timetable)g(at)g(its)h
(\014rst)h(meeting)d(in)i(Marc)o(h)g(1995.)28 b(The)19
b(goal)249 2402 y(is)d(release)i(of)e(a)g(preliminary)e(v)o(ersion)j
(of)e(certain)i(parts)g(of)f Fw(MPI)p FA(-2)f(in)h(Decem)o(b)q(er)h
(1995)f(at)249 2456 y(Sup)q(ercomputing)e('95.)21 b(This)15
b(is)g(to)f(include)i(dynamic)d(pro)q(cesses.)24 b(The)15
b(goal)f(of)g(this)i(early)p eop
%%Page: 325 339
325 338 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Conclusions)1241 b(325)249 507
y FA(release)18 b(is)f(to)g(allo)o(w)e(testing)j(of)e(the)i(ideas)f
(and)f(to)h(receiv)o(e)i(extended)f(public)f(commen)o(ts.)249
561 y(The)i(complete)g(v)o(ersion)g(of)f Fw(MPI)p FA(-2)g(will)g(b)q(e)
h(released)h(at)f(Sup)q(ercomputing)g('96)e(for)i(\014nal)249
615 y(public)c(commen)o(t.)22 b(The)16 b(\014nal)f(v)o(ersion)h(of)f
Fw(MPI)p FA(-2)g(is)g(sc)o(heduled)i(for)f(release)h(in)e(the)h(spring)
249 669 y(of)d(1997.)p eop
%%Page: 326 340
326 339 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v eop
%%Page: 327 341
327 340 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 260 a FD(Bibliograph)o(y)276 499 y Fz([1])20
b(V.)14 b(Bala)e(and)h(S.)f(Kipnis.)20 b(Pro)q(cess)12
b(groups:)k(a)d(mec)o(hanism)e(for)h(the)g(co)q(ordination)e(of)j(and)f
(comm)o(u-)334 536 y(nication)f(among)g(pro)q(cesses)f(in)j(the)e(Ven)o
(us)i(collectiv)o(e)d(comm)o(unic)o(atio)o(n)g(library)m(.)17
b(T)m(ec)o(hnical)11 b(rep)q(ort,)334 574 y(IBM)h(T.)g(J.)g(W)m(atson)e
(Researc)o(h)g(Cen)o(ter,)h(Octob)q(er)f(1992.)k(Preprin)o(t.)276
628 y([2])20 b(V.)14 b(Bala,)e(S.)g(Kipnis,)h(L.)g(Rudolph,)d(and)i
(Marc)h(Snir.)18 b(Designing)10 b(e\016cien)o(t,)i(scalable,)f(and)h(p)
q(ortable)334 665 y(collectiv)o(e)h(comm)o(unica)o(tio)o(n)f
(libraries.)24 b(In)15 b Fa(SIAM)h(1993)h(Confer)n(enc)n(e)g(on)g(Par)n
(al)r(lel)g(Pr)n(o)n(c)n(essing)g(for)334 702 y(Scienti\014c)d
(Computing)p Fz(,)e(pages)e(862{872,)f(Marc)o(h)i(1993.)276
756 y([3])20 b(Luc)d(Bomans)e(and)g(Rolf)h(Hemp)q(el.)30
b(The)16 b(Argonne/GMD)f(macros)g(in)h(F)o(OR)m(TRAN)j(for)d(p)q
(ortable)334 794 y(parallel)11 b(programming)f(and)i(their)g(implemen)o
(t)o(ati)o(on)e(on)i(the)h(In)o(tel)f(iPSC/2.)19 b Fa(Par)n(al)r(lel)c
(Computing)p Fz(,)334 831 y(15:119{132,)9 b(1990.)276
885 y([4])20 b(J.)10 b(Bruc)o(k,)f(R.)h(Cypher,)f(P)m(.)h(Elustond,)e
(A.)i(Ho,)g(C-T.)h(Ho,)f(V.)g(Bala,)f(S.)h(Kipnis,)f(,)h(and)f(M.)h
(Snir.)j(Ccl:)i(A)334 922 y(p)q(ortable)8 b(and)i(tunable)e(collectiv)o
(e)f(comm)o(unicati)o(onl)o(ibra)o(ry)g(for)j(scalable)e(parallel)g
(computers.)k Fa(IEEE)334 960 y(T)m(r)n(ans.)h(on)g(Par)n(al)r(lel)h
(and)f(Distribute)n(d)g(Systems)p Fz(,)f(6\(2\):154{16)o(4,)c(1995.)276
1014 y([5])20 b(R.)c(Butler)f(and)g(E.)h(Lusk.)27 b(User's)16
b(guide)e(to)i(the)f(p4)g(programming)d(system.)27 b(T)m(ec)o(hnical)14
b(Rep)q(ort)334 1051 y(TM-ANL{92/17,)d(Argonne)f(National)g(Lab)q
(oratory)m(,)f(1992.)276 1105 y([6])20 b(Ralph)12 b(Butler)f(and)g
(Ewing)h(Lusk.)17 b(Monitors,)11 b(messages,)g(and)g(clusters:)k(the)d
(p4)g(parallel)e(program-)334 1142 y(ming)h(system.)i
Fa(Journal)h(of)e(Par)n(al)r(lel)j(Computing)p Fz(,)d(20\(4\):547{)o
(564)o(,)d(April)i(1994.)276 1196 y([7])20 b(Robin)12
b(Calkin,)g(Rolf)g(Hemp)q(el,)f(Hans-Christian)g(Hopp)q(e,)h(and)f(P)o
(eter)h(Wypior.)18 b(P)o(ortable)10 b(program-)334 1234
y(ming)i(with)g(the)g(parmacs)e(message{passin)o(g)g(library)m(.)16
b Fa(Par)n(al)r(lel)f(Computing)p Fz(,)f(20\(4\):615{)o(632)o(,)c
(April)334 1271 y(1994.)276 1325 y([8])20 b(S.)12 b(Chittor)f(and)f(R.)
i(J.)g(En)o(b)q(o)q(dy)m(.)j(P)o(erformance)8 b(ev)n(aluation)h(of)j
(mesh{conn)o(ect)o(ed)d(w)o(ormhole{rou)o(ted)334 1362
y(net)o(w)o(orks)j(for)h(in)o(terpro)q(cesso)o(r)d(comm)o(unicati)o(on)
g(in)j(m)o(ulticompu)o(ter)o(s.)18 b(In)12 b Fa(Pr)n(o)n(c)n(e)n(e)n
(ding)q(s)k(of)f(the)g(1990)334 1400 y(Sup)n(er)n(c)n(omputing)h
(Confer)n(enc)n(e)p Fz(,)d(pages)d(647{656,)f(1990.)276
1454 y([9])20 b(S.)13 b(Chittor)e(and)h(R.)g(J.)h(En)o(b)q(o)q(dy)m(.)k
(Predicting)10 b(the)h(e\013ect)h(of)g(mapping)e(on)i(the)g(comm)o
(unic)o(atio)o(n)e(p)q(er-)334 1491 y(formance)g(of)h(large)g(m)o
(ulticompu)o(ter)o(s.)j(In)d Fa(Pr)n(o)n(c)n(e)n(e)n(dings)16
b(of)d(the)h(1991)g(International)f(Confer)n(enc)n(e)i(on)334
1528 y(Par)n(al)r(lel)f(Pr)n(o)n(c)n(essing,)g(vol.)g(II)e(\(Softwar)n
(e\))p Fz(,)f(pages)f(I)q(I{1)h({)g(I)q(I{4,)g(1991.)259
1582 y([10])19 b(R.)12 b(Cypher)f(and)g(E.)g(Leu.)16
b(The)c(seman)o(tics)d(of)i(blo)q(c)o(king)f(and)h(non)o(blo)q(c)o(kin)
o(g)e(send)i(and)f(receiv)o(e)g(primi-)334 1620 y(tiv)o(es.)15
b(In)c Fa(8th)i(International)g(Par)n(al)r(lel)h(Pr)n(o)n(c)n(essing)g
(Symp)n(osium)p Fz(,)f(pages)d(729{735,)f(April)i(1994.)259
1674 y([11])19 b(J.)14 b(J.)f(Dongarra,)f(R.)h(Hemp)q(el,)f(A.)i(J.)g
(G.)f(Hey)m(,)g(and)g(D.)g(W.)h(W)m(alk)o(er.)19 b(A)14
b(prop)q(osal)d(for)i(a)g(user-lev)o(el,)334 1711 y(message)i(passing)f
(in)o(terface)g(in)i(a)g(distributed)e(memory)g(en)o(vironmen)n(t.)26
b(T)m(ec)o(hnical)15 b(Rep)q(ort)g(TM-)334 1748 y(12231,)10
b(Oak)i(Ridge)e(National)g(Lab)q(oratory)m(,)f(F)m(ebruary)g(1993.)259
1802 y([12])19 b(Nathan)8 b(Doss,)h(William)f(Gropp,)g(Ewing)g(Lusk,)h
(and)f(An)o(thon)o(y)g(Skjellum.)j(A)f(mo)q(del)d(implemen)o(tat)o(ion)
334 1840 y(of)12 b(MPI.)j(T)m(ec)o(hnical)10 b(rep)q(ort,)g(Argonne)g
(National)g(Lab)q(oratory)m(,)e(1993.)259 1894 y([13])19
b(Edin)o(burgh)12 b(P)o(arallel)h(Computing)f(Cen)o(tre,)i(Univ)o
(ersit)o(y)e(of)i(Edin)o(burgh.)21 b Fa(CHIMP)15 b(Conc)n(epts)p
Fz(,)g(June)334 1931 y(1991.)259 1985 y([14])k(Edin)o(burgh)12
b(P)o(arallel)g(Computing)f(Cen)o(tre,)j(Univ)o(ersit)o(y)e(of)h(Edin)o
(burgh.)19 b Fa(CHIMP)c(V)m(ersion)h(1.0)f(In-)334 2022
y(terfac)n(e)p Fz(,)e(Ma)o(y)f(1992.)259 2076 y([15])19
b(Message)8 b(P)o(assing)f(In)o(terface)f(F)m(orum.)12
b(MPI:)d(A)g(message-passi)o(ng)c(in)o(terface)h(standard.)12
b Fa(International)334 2114 y(Journal)i(of)e(Sup)n(er)n(c)n(omputer)k
(Applic)n(ations)p Fz(,)d(8\(3/4\),)c(1994.)14 b(Sp)q(ecial)c(issue)h
(on)g(MPI.)259 2168 y([16])19 b(H.)13 b(F)m(rank)o(e,)f(H.)g(W)m(u,)h
(C.E.)g(Riviere,)e(P)m(.P)o(attnaik,)f(and)i(M.)h(Snir.)k(MPI)c
(programmi)o(ng)c(en)o(vironmen)o(t)334 2205 y(for)14
b(IBM)h(SP1/SP2.)22 b(In)14 b Fa(15th)i(International)g(Confer)n(enc)n
(e)h(on)f(Distribute)n(d)g(Computing)g(Systems)p Fz(,)334
2242 y(pages)11 b(127{135,)e(June)h(1995.)259 2296 y([17])19
b(A.)c(Geist,)g(A.)g(Beguelin,)e(J.)h(Dongarra,)f(W.)i(Jiang,)f(R.)h
(Manc)o(hek,)e(and)h(V.)h(Sunderam.)21 b Fa(PVM:)16 b(A)334
2334 y(Users')d(Guide)g(and)g(T)m(utorial)g(for)g(Networke)n(d)i(Par)n
(al)r(lel)f(Computing)p Fz(.)i(MIT)c(Press,)f(1994.)j(The)d(b)q(o)q(ok)
334 2376 y(is)h(a)o(v)n(ailable)d(electronical)o(ly)m(,)f(the)j(url)g
(is)h Fw(ftp://www.netlib.o)o(rg/pvm3/b)q(o)q(ok/pvm-b)q(o)q(ok.ps)p
Fz(.)259 2429 y([18])19 b(G.)e(A.)g(Geist,)g(M.)g(T.)g(Heath,)g(B.)g
(W.)g(P)o(eyton,)f(and)g(P)m(.)g(H.)h(W)m(orley)m(.)30
b(A)17 b(user's)f(guide)f(to)h(PICL:)334 2467 y(a)f(p)q(ortable)d
(instrumen)o(te)o(d)g(comm)o(unica)o(tion)f(library)m(.)22
b(T)m(ec)o(hnical)13 b(Rep)q(ort)g(TM-11616,)h(Oak)h(Ridge)334
2504 y(National)10 b(Lab)q(oratory)m(,)f(Octob)q(er)h(1990.)p
eop
%%Page: 328 342
328 341 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 259 507 a Fz([19])19 b(William)11 b(D.)h(Gropp)f(and)g
(Barry)g(Smith.)16 b(Chameleon)9 b(parallel)h(programming)f(to)q(ols)i
(users)g(man)o(ual.)334 545 y(T)m(ec)o(hnical)f(Rep)q(ort)g(ANL-93/23,)
h(Argonne)f(National)g(Lab)q(oratory)m(,)f(Marc)o(h)h(1993.)259
599 y([20])19 b(V.)c(Karamc)o(heti)c(and)i(A.A.)h(Chien.)21
b(Soft)o(w)o(are)13 b(o)o(v)o(erheads)e(in)i(messaging)e(la)o(y)o(ers:)
19 b(Where)13 b(do)q(es)f(the)334 636 y(time)f(go?)22
b(In)12 b Fa(6th)h(International)h(Confer)n(enc)n(e)h(on)f(A)o(r)n
(chite)n(ctur)n(al)i(Supp)n(ort)e(for)f(Pr)n(o)n(gr)n(amming)j(L)n(an-)
334 673 y(guages)e(and)f(Op)n(er)n(ating)i(Systems)e(\(ASPLOS)g(VI\))p
Fz(,)f(pages)e(51{60,)g(Octob)q(er)g(1994.)259 727 y([21])19
b(O.)c(Kr\177)-18 b(amer)12 b(and)h(H.)i(M)q(\177)-19
b(uhlen)o(b)q(ein.)19 b(Mapping)12 b(strategies)g(in)h(message{based)d
(m)o(ultipro)q(cesso)o(r)h(sys-)334 765 y(tems.)k Fa(Par)n(al)r(lel)f
(Computing)p Fz(,)e(9:213{225,)c(1989.)259 819 y([22])19
b(nCUBE)13 b(Corp)q(oration.)f Fa(nCUBE)h(2)g(Pr)n(o)n(gr)n(ammers)i
(Guide,)e(r2.0)p Fz(,)f(Decem)o(b)q(er)d(1990.)259 873
y([23])19 b(P)o(arasoft)10 b(Corp)q(oration,)f(P)o(asadena,)g(CA.)17
b Fa(Expr)n(ess)c(User's)g(Guide)p Fz(,)f(v)o(ersion)d(3.2.5)i
(edition,)e(1992.)259 927 y([24])19 b(P)o(aul)e(Pierce.)31
b(The)17 b(NX/2)h(op)q(erating)c(system.)31 b(In)17 b
Fa(Pr)n(o)n(c)n(e)n(e)n(dings)k(of)d(the)g(Thir)n(d)g(Confer)n(enc)n(e)
i(on)334 964 y(Hyp)n(er)n(cub)n(e)c(Concurr)n(ent)e(Computers)f(and)g
(Applic)n(ations)p Fz(,)g(pages)d(384{390.)f(A)o(CM)k(Press,)e(1988.)
259 1018 y([25])19 b(A.)12 b(Skjellum)c(and)j(A.)g(Leung.)j(Zip)q(co)q
(de:)f(a)e(p)q(ortable)d(m)o(ulticomput)o(er)g(comm)o(unicat)o(ion)g
(library)h(atop)334 1055 y(the)15 b(reactiv)o(e)f(k)o(ernel.)25
b(In)15 b(D.)h(W.)f(W)m(alk)o(er)g(and)g(Q.)h(F.)f(Stout,)g(editors,)g
Fa(Pr)n(o)n(c)n(e)n(e)n(dings)k(of)d(the)h(Fifth)334
1093 y(Distribute)n(d)d(Memory)f(Concurr)n(ent)h(Computing)f(Confer)n
(enc)n(e)p Fz(,)g(pages)e(767{776.)e(IEEE)i(Press,)g(1990.)259
1147 y([26])19 b(A.)c(Skjellum,)e(S.)h(Smith,)f(C.)i(Still,)f(A.)h
(Leung,)f(and)f(M.)i(Morari.)23 b(The)15 b(Zip)q(co)q(de)d(message)g
(passing)334 1184 y(system.)i(T)m(ec)o(hnical)c(rep)q(ort,)g(La)o
(wrence)g(Liv)o(ermore)f(National)h(Lab)q(oratory)m(,)f(Septem)o(b)q
(er)f(1992.)259 1238 y([27])19 b(V.S.)10 b(Sunderam,)c(G.A.)k(Geist,)e
(J.)i(Dongarra,)d(and)i(R.)g(Manc)o(hek.)k(The)c(PVM)h(concurren)o(t)d
(computing)334 1275 y(system:)13 b(Ev)o(olution,)8 b(exp)q(eriences,)g
(and)h(trends.)k Fa(Par)n(al)r(lel)g(Computing)p Fz(,)e(20\(4\):531{5)o
(45,)c(April)j(1994.)259 1329 y([28])19 b(T.)9 b(v)o(on)e(Eic)o(k)o
(en,)g(D.E.)h(Culler,)f(S.C.)h(Goldstein,)e(and)h(K.E.)h(Shauser.)k
(Activ)o(e)7 b(messages:)12 b(a)c(mec)o(hanism)334 1367
y(for)13 b(in)o(tegrated)d(comm)o(unic)o(atio)o(n)g(and)i(computatio)o
(n.)k(In)c Fa(19th)j(A)o(nnual)g(International)g(Symp)n(osium)334
1404 y(on)e(Computer)h(A)o(r)n(chite)n(ctur)n(e)p Fz(,)g(pages)c
(256{266,)f(Ma)o(y)j(1992.)259 1458 y([29])19 b(D.)12
b(W)m(alk)o(er.)i(Standards)8 b(for)j(message)f(passing)f(in)i(a)g
(distributed)e(memory)g(en)o(vironmen)n(t.)j(T)m(ec)o(hnical)334
1495 y(Rep)q(ort)e(TM-12147,)h(Oak)g(Ridge)g(National)f(Lab)q(oratory)m
(,)e(August)j(1992.)p eop
%%Page: 329 343
329 342 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 218 a FD(Index)249 507 y Fz(activ)o(e)10
b(request)g(handle,)f(86)249 545 y(address,)h(128,)g(133,)h(134)249
582 y(aliased)f(argumen)o(ts,)e(7)249 619 y(alignmen)o(t,)h(104,)h
(128,)h(130)249 657 y(all)g(reduce,)f(185)249 694 y(all)h(to)g(all,)g
(173)249 731 y(all)g(to)g(all,)g(v)o(ector)f(v)n(arian)o(t,)f(174)249
769 y(am)o(biguit)o(y)g(of)i(comm)o(unica)o(tion)o(s,)e(320)249
806 y(argumen)o(ts,)g(7)249 844 y(asso)q(ciativit)o(y)f(and)j
(reduction,)e(177)249 881 y(asso)q(ciativit)o(y)m(,)c(and)i
(user-de\014ned)t(op)q(eration,)f(190)249 918 y(asymmetry)m(,)i(24)249
956 y(attribute,)h(229,)h(230)249 993 y(attribute,)f(k)o(ey)m(,)h(230,)
h(232,)f(235)249 1030 y(attribute,)f(prede\014ned,)f(287)249
1068 y(attribute,)h(top)q(ology)m(,)g(253,)h(256)249
1147 y(bac)o(kmasking)o(,)f(239)249 1184 y(balance,)g(hot)i(sp)q(ot,)f
(64)249 1221 y(barrier,)g(152)249 1259 y(blo)q(c)o(king,)f(9,)i(17,)g
(32,)g(149)249 1296 y(broadcast,)e(152)249 1333 y(bu\013er)h(attac)o
(h,)g(95)249 1371 y(bu\013er)g(p)q(olicy)m(,)g(97)249
1408 y(bu\013er,)g(receiv)o(e,)f(22)249 1445 y(bu\013er,)h(send,)g(19)
249 1483 y(bu\013ered)f(mo)q(de,)h(18,)h(89,)g(95)249
1520 y(bu\013ering,)e(17,)i(32,)g(33,)f(312,)h(314)249
1558 y(bu\013ering,)e(non)o(blo)q(c)o(king)o(,)g(63)249
1636 y(cac)o(hing,)g(204,)i(229)249 1674 y(callbac)o(k)e(function,)g
(230,)i(231)249 1711 y(callbac)o(k)e(function,)g(cop)o(y)m(,)i(219,)f
(232,)g(234)249 1748 y(callbac)o(k)f(function,)g(delete,)h(223,)h(234)
249 1786 y(cancelation,)d(75,)j(79)249 1823 y(c)o(hoice,)f(12)249
1861 y(clo)q(c)o(k,)g(290)249 1898 y(clo)q(c)o(k)g(sync)o(hronizati)o
(on,)e(287,)j(288)249 1935 y(collectiv)o(e,)e(9)249 1973
y(collectiv)o(e)g(comm)o(unica)o(tion)o(,)g(147)249 2010
y(collectiv)o(e,)g(and)h(blo)q(c)o(king)g(seman)o(tics,)e(149)249
2047 y(collectiv)o(e,)h(and)h(comm)o(unicato)o(r,)f(151)249
2085 y(collectiv)o(e,)g(and)h(correctness,)f(149)249
2122 y(collectiv)o(e,)g(and)h(deadlo)q(c)o(k,)f(195)249
2159 y(collectiv)o(e,)g(and)h(in)o(tercomm)o(un)o(ica)o(tor,)e(151)249
2197 y(collectiv)o(e,)h(and)h(message)g(tag,)h(149)249
2234 y(collectiv)o(e,)e(and)h(mo)q(des,)g(149)249 2271
y(collectiv)o(e,)f(and)h(nondetermin)o(ism,)e(197)249
2309 y(collectiv)o(e,)h(and)h(p)q(ortabilit)o(y)m(,)f(149,)h(195)249
2346 y(collectiv)o(e,)f(and)h(threads,)g(198)249 2384
y(collectiv)o(e,)f(and)h(t)o(yp)q(e)h(matc)o(hing,)d(150)249
2421 y(collectiv)o(e,)e(compatibilit)n(y)f(with)j(p)q(oin)o(t-to-p)q
(oi)o(n)o(t,)299 2458 y(149)249 2496 y(collectiv)o(e,)h(pro)q(cess)h
(group,)g(151)1069 507 y(collectiv)o(e,)f(restrictions,)f(149)1069
545 y(collectiv)o(e,)h(seman)o(tics)g(of,)i(195,)f(320)1069
582 y(collectiv)o(e,)f(v)o(ector)g(v)n(arian)o(ts,)h(147)1069
619 y(commit,)f(123)1069 657 y(comm)o(unica)o(tion)e(domain,)h(15,)j
(20,)f(25,)g(203,)g(204)1069 694 y(comm)o(unica)o(tion)e(domain,)h(in)o
(ter,)h(243)1069 731 y(comm)o(unica)o(tion)e(domain,)h(in)o(tra,)h(204)
1069 769 y(comm)o(unica)o(tion)e(hot)j(sp)q(ot,)f(64)1069
806 y(comm)o(unica)o(tion)e(mo)q(des,)i(32,)h(89)1069
844 y(comm)o(unica)o(tion)d(mo)q(des,)i(commen)o(ts,)e(98)1069
881 y(comm)o(unica)o(tion)g(proto)q(col,)h(32)1069 918
y(comm)o(unica)o(tion)o(,)g(non)o(blo)q(c)o(kin)o(g,)g(49)1069
956 y(comm)o(unica)o(tor,)f(15,)j(20,)g(203)1069 993
y(comm)o(unica)o(tor,)d(accessors,)h(217)1069 1030 y(comm)o(unica)o
(tor,)f(and)j(collectiv)o(e,)d(151)1069 1068 y(comm)o(unica)o(tor,)g
(cac)o(hing,)h(204,)i(229)1069 1105 y(comm)o(unica)o(tor,)d
(constructors,)g(219)1069 1142 y(comm)o(unica)o(tor,)g(destructor,)h
(223)1069 1180 y(comm)o(unica)o(tor,)f(hidden,)i(151)1069
1217 y(comm)o(unica)o(tor,)e(in)o(tra)i(vs)i(in)o(ter,)e(204)1069
1254 y(comm)o(unica)o(tor,)e(manipulatio)o(n,)h(216)1069
1292 y(comm)o(utativ)o(it)o(y)f(and)j(reduction,)d(177)1069
1329 y(comm)o(utativ)o(it)o(y)l(,)13 b(and)g(user-de\014ned)f(op)q
(eration,)1119 1367 y(190)1069 1404 y(complete-re)o(cei)o(v)o(e,)c(50)
1069 1441 y(complete-se)o(nd,)g(49)1069 1479 y(completion)g(functions,)
h(52)1069 1516 y(completion)o(,)g(m)o(ultiple,)g(67)1069
1553 y(complexit)o(y)f(of)j Fw(MPI)p Fz(,)g(311)1069
1591 y(con)o(text)e(id,)i(21,)g(205)1069 1628 y(con)o(v)o(ersion,)d(26)
1069 1665 y(con)o(v)o(ersion,)g(represen)o(tation)o(,)h(30)1069
1703 y(con)o(v)o(ersion,)f(t)o(yp)q(e,)j(30)1069 1740
y(correctness,)e(149)1069 1778 y(cycles,)h(44)1069 1856
y(data)g(con)o(v)o(ersion,)f(16,)i(29)1069 1894 y(data)f(distribution,)
e(39)1069 1931 y(datat)o(yp)q(e,)h(19)1069 1968 y(datat)o(yp)q(e)g
(matc)o(hing,)g(16)1069 2006 y(deadlo)q(c)o(k,)g(33,)i(44)1069
2043 y(deriv)o(ed)e(datat)o(yp)q(e,)g(101,)i(102)1069
2081 y(deriv)o(ed)e(datat)o(yp)q(e,)g(address,)h(128,)g(133,)h(134)1069
2118 y(deriv)o(ed)e(datat)o(yp)q(e,)g(commit,)g(123)1069
2155 y(deriv)o(ed)g(datat)o(yp)q(e,)g(constructor,)g(101,)h(105)1069
2193 y(deriv)o(ed)f(datat)o(yp)q(e,)g(destructor,)g(124)1069
2230 y(deriv)o(ed)g(datat)o(yp)q(e,)g(exten)o(t,)h(103,)g(105,)h(131)
1069 2267 y(deriv)o(ed)e(datat)o(yp)q(e,)g(lo)o(w)o(er)i(b)q(ound,)f
(104,)g(131)1069 2305 y(deriv)o(ed)f(datat)o(yp)q(e,)g(map,)h(103)1069
2342 y(deriv)o(ed)f(datat)o(yp)q(e,)g(mark)o(ers,)h(130)1069
2379 y(deriv)o(ed)f(datat)o(yp)q(e,)g(matc)o(hing,)g(125)1069
2417 y(deriv)o(ed)g(datat)o(yp)q(e,)g(o)o(v)o(erlapping)f(en)o(tries,)i
(125)1069 2454 y(deriv)o(ed)f(datat)o(yp)q(e,)g(signature,)g(103)1069
2492 y(deriv)o(ed)g(datat)o(yp)q(e,)g(upp)q(er)h(b)q(ound,)g(104,)g
(131)p eop
%%Page: 330 344
330 343 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(330)1344 b(Index)249 507 y Fz(destination,)8
b(20,)j(21)249 545 y(deterministic)d(programs,)h(36)249
624 y(e\016ciency)m(,)h(2)249 661 y(enabled)f(comm)o(unicati)o(on,)f
(62)249 698 y(encapsulatio)o(n,)h(21)249 736 y(en)o(vironmen)n(tal)f
(parameters,)h(287)249 773 y(error)h(classes,)h(299)249
810 y(error)f(co)q(de,)h(23)249 848 y(error)f(co)q(des,)g(298)249
885 y(error)g(handler,)g(295)249 922 y(error)g(handler,)g(prede\014ned)
o(,)f(295)249 960 y(error)h(handling,)f(287,)i(293)249
997 y(error,)f(program,)f(293)249 1034 y(error,)h(resource,)f(293)249
1072 y(exception,)g(294)249 1109 y(exc)o(hange)g(comm)o(unica)o(tion)o
(,)g(44)249 1147 y(exit,)h(287,)h(291)249 1184 y(extensions,)e(324)249
1221 y(exten)o(t,)h(103,)g(105,)h(131)249 1300 y(failure,)f(65)249
1337 y(fairness,)g(38)249 1375 y(fairness,)g(and)g(serv)o(er,)g(70,)h
(74)249 1412 y(fairness,)f(non)o(blo)q(c)o(kin)o(g,)f(62)249
1450 y(\014rst-come-\014r)o(st-se)o(rv)o(e)o(d,)g(57)249
1528 y(gather,)h(154)249 1566 y(gather)g(and)g(scatter,)g(173)249
1603 y(gather)g(to)h(all,)g(170)249 1641 y(gather)f(to)h(all,)g(v)o
(ector)f(v)n(arian)o(t,)f(172)249 1678 y(gather,)h(v)o(ector)g(v)n
(arian)o(t,)f(157)249 1715 y(global)h(reduction,)f(175)249
1753 y(group,)h(20,)h(201,)f(203,)h(207,)f(253)249 1790
y(group,)g(for)h(collectiv)o(e,)e(151)249 1827 y(group,)h(lo)q(cal)g
(and)h(remote,)e(243)249 1906 y(half-c)o(hanne)o(l,)g(81)249
1944 y(handle,)h(n)o(ull,)g(10)249 1981 y(handles,)f(9)249
2018 y(heterogeneo)o(us,)f(2,)k(29,)f(321)249 2056 y(hidden)f(comm)o
(unica)o(tor)o(,)f(151,)h(198)249 2093 y(host)h(pro)q(cess,)e(287,)i
(288)249 2130 y(hot)g(sp)q(ot,)f(64)249 2209 y(I/O)i(inquiry)m(,)d
(287,)i(288)249 2247 y(implemen)o(ta)o(tion)o(s,)e(323)249
2284 y(IN,)j(7)249 2321 y(inactiv)o(e)d(request)h(handle,)g(86)249
2359 y(include)g(\014le,)g(13,)h(14)249 2396 y(initialization)o(,)e
(287,)h(291)249 2433 y(INOUT,)j(7)249 2471 y(in)o(ter-group)8
b(comm)o(unicati)o(on)g(domain,)i(204)249 2508 y(in)o(ter-langua)o(ge)e
(comm)o(unicati)o(on,)g(31)1069 507 y(in)o(teraction,)d
Fw(MPI)i Fz(with)h(execution)d(en)o(vironme)o(n)o(t,)1119
545 y(287,)10 b(301)1069 582 y(in)o(tercomm)o(u)o(nic)o(ati)o(on,)e
(243)1069 619 y(in)o(tercomm)o(u)o(nic)o(ati)o(on,)g(and)j(collectiv)o
(e,)e(245)1069 657 y(in)o(tercomm)o(u)o(nic)o(ati)o(on,)f(summary)m(,)h
(244)1069 694 y(in)o(tercomm)o(u)o(nic)o(ato)o(r,)g(20,)h(204)1069
731 y(in)o(tercomm)o(u)o(nic)o(ato)o(r,)f(accessors,)g(247)1069
769 y(in)o(tercomm)o(u)o(nic)o(ato)o(r,)g(and)h(collectiv)o(e,)f(151)
1069 806 y(in)o(tercomm)o(u)o(nic)o(ato)o(r,)g(constructor)o(s,)g(249)
1069 844 y(in)o(terop)q(erab)o(ilit)o(y)l(,)g(2,)i(322)1069
881 y(in)o(terop)q(erab)o(ilit)o(y)l(,)e(language,)g(12)1069
918 y(in)o(tra-group)f(comm)o(unicat)o(ion)g(domain,)h(203)1069
956 y(in)o(tracomm)o(u)o(nic)o(ato)o(r,)g(20,)h(203)1069
1034 y(Jacobi,)g(39,)h(41)1069 1072 y(Jacobi,)f(safe)h(v)o(ersion,)e
(43)1069 1109 y(Jacobi,)h(using)g(non)o(blo)q(c)o(king,)e(54)1069
1147 y(Jacobi,)i(using)g(send-receiv)o(e,)e(46)1069 1184
y(Jacobi,)i(with)h(n)o(ull)g(pro)q(cesses,)e(48)1069
1221 y(Jacobi,)h(with)h(p)q(ersisten)o(t)e(requests,)h(84)1069
1259 y(Jacobi,)g(with)h Fw(MPI)p 1346 1259 13 2 v 15
w(W)m(AIT)m(ALL)p Fz(,)g(71)1069 1337 y(k)o(ey)m(,)f(230,)h(232,)f(235)
1069 1416 y(la)o(y)o(ering,)f(135,)i(202,)f(303)1069
1454 y(libraries,)f(25,)i(201,)g(303)1069 1491 y(libraries,)e(safet)o
(y)m(,)h(202,)h(223,)f(320)1069 1528 y(lo)q(cal,)g(9)1069
1566 y(long)g(proto)q(col,)f(65)1069 1603 y(lo)o(w)o(er)i(b)q(ound,)f
(104,)g(131)1069 1682 y(mark)o(ers,)f(130)1069 1719 y(matc)o(hing,)g
(36)1069 1757 y(matc)o(hing,)g(narro)o(w,)h(25)1069 1794
y(matc)o(hing,)f(t)o(yp)q(e,)h(26)1069 1831 y(matrix)g(pro)q(duct,)f
(273)1069 1869 y(maxim)o(um)g(and)h(lo)q(cation,)f(180)1069
1906 y(message)h(destination)o(,)f(21)1069 1944 y(message)h(en)o(v)o
(elop)q(e,)e(20)1069 1981 y(message)i(matc)o(hing,)e(36)1069
2018 y(message)i(order,)g(35)1069 2056 y(message)g(selection,)f(22)1069
2093 y(message)h(source,)f(20,)i(23)1069 2130 y(message)f(tag,)g(15,)h
(21,)g(23)1069 2168 y(message,)e(self,)i(24)1069 2205
y(message,)e(self-t)o(yp)q(ed,)g(25)1069 2242 y(minim)o(um)g(and)h(lo)q
(cation,)f(180)1069 2280 y(mo)q(de,)h(89)1069 2317 y(mo)q(de,)g
(bu\013ered,)f(89,)i(95)1069 2355 y(mo)q(de,)f(commen)o(ts,)e(98)1069
2392 y(mo)q(de,)i(ready)m(,)g(89)1069 2429 y(mo)q(de,)g(standard,)f
(32,)i(89)1069 2467 y(mo)q(de,)f(sync)o(hronou)o(s,)f(89)1069
2504 y(mo)q(des,)h(17,)h(32,)f(89,)h(149)p eop
%%Page: 331 345
331 344 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(Index)1344 b(331)249 507 y Fz(mo)q(dularit)o
(y)m(,)8 b(202,)j(223,)f(320)249 545 y Fw(MPI)p Fz(-2,)g(324)249
590 y Fq(MPI)p 321 590 12 2 v 13 w(BYTE)i(,)h(27,)f(29,)h(30)249
636 y(MPI)p 321 636 V 13 w(CHARA)o(CTER)e(,)i(28)249
682 y(MPI)p 321 682 V 13 w(COMM)p 455 682 V 13 w(W)o(ORLD,)f(15)249
727 y(MPI)p 321 727 V 13 w(P)m(A)o(CKED)f(,)h(27)249
773 y(MPI)g(exception,)f(294)249 819 y(mpif.h,)g(13,)i(14)249
864 y(MPI)f(F)o(o)o(rum,)h(1)249 910 y(MPI)f(implementations,)e(323)249
956 y(multiple)g(completion,)i(67)249 1043 y(name)i(shift,)c(303)249
1088 y(na)o(rro)o(w)k(matching,)e(25)249 1134 y(non-blo)q(cking,)e(9)
249 1180 y(non-lo)q(cal,)h(9,)i(32)249 1225 y(nonblo)q(cking,)e(17,)i
(34)249 1271 y(nonblo)q(cking)e(communication,)h(49)249
1317 y(nonblo)q(cking,)f(bu\013ering,)h(63)249 1362 y(nonblo)q(cking,)f
(fairness,)g(62)249 1408 y(nonblo)q(cking,)g(o)o(rder,)h(60)249
1454 y(nonblo)q(cking,)f(p)o(rogress,)h(61)249 1499 y(nonblo)q(cking,)f
(safet)o(y)m(,)g(63)249 1545 y(nondeterminism)h(and)g(collective,)e
(197)249 1591 y(null)h(p)o(ro)q(cess,)h(47)249 1636 y(null)f(request)h
(handle,)g(86)249 1724 y(opaque)h(objects,)g(9)249 1769
y(o)o(rder,)g(35)249 1815 y(o)o(rder,)g(nonblo)q(cking,)d(60)249
1861 y(o)o(rder,)j(with)f(threads,)g(36)249 1906 y(OUT,)i(7)249
1952 y(over\015o)o(w,)f(22,)f(30)249 1998 y(overlap,)g(54)249
2085 y(pack,)h(101,)g(135)249 2130 y(packing)f(unit,)f(137)249
2176 y(pa)o(rallel)g(p)o(re\014x,)h(188)249 2222 y(p)q(ersistent)f
(request,)h(81)249 2267 y(p)q(olling,)e(75)249 2313 y(p)q(o)o(rt,)j(81)
249 2359 y(p)q(o)o(rtabilit)o(y)m(,)d(1,)i(149,)h(195)249
2404 y(p)q(o)o(rtable)f(p)o(rogramming,)i(314)249 2450
y(p)q(ost-receive,)d(49)249 2496 y(p)q(ost-send,)g(49)1069
507 y(p)q(ost-send,)g(failure)h(of,)g(65)1069 553 y(p)q(osting,)f(17)
1069 599 y(p)q(osting)h(functions,)e(51)1069 644 y(p)o(rede\014ned)i
(attributes,)f(287)1069 690 y(p)o(robing,)g(75)1069 736
y(p)o(ro)q(cedure)i(sp)q(eci\014cation,)d(7)1069 781
y(p)o(ro)q(cess)i(allo)q(cation,)g(8)1069 827 y(p)o(ro)q(cess)g(group,)
h(20,)g(201,)g(203,)g(207,)g(253)1069 873 y(p)o(ro)q(cess)f(group,)h
(lo)q(cal)f(and)h(remote,)g(243)1069 918 y(p)o(ro)q(cess)f(rank,)h(20,)
g(203,)g(253)1069 964 y(p)o(ro)q(cesses,)f(8)1069 1010
y(p)o(ro)q(ducer-consumer,)h(56,)f(70,)h(87)1069 1055
y(p)o(ro\014le)f(interface,)f(303)1069 1101 y(p)o(rogress,)h(37)1069
1147 y(p)o(rogress,)g(fo)o(r)h(p)o(rob)q(e,)g(77)1069
1192 y(p)o(rogress,)f(nonblo)q(cking,)f(61)1069 1238
y(p)o(roto)q(col,)h(communication,)g(32)1069 1284 y(p)o(roto)q(col,)g
(t)o(w)o(o-phase,)g(25)1069 1329 y(p)o(roto)q(cols,)g(17)1069
1416 y(rank,)h(15,)f(20,)h(203,)g(253)1069 1462 y(ready)g(mo)q(de,)g
(18,)g(89)1069 1508 y(receive,)f(22)1069 1553 y(receive)g(bu\013er,)h
(22)1069 1599 y(receive,)f(wildca)o(rd,)f(25)1069 1645
y(reduce,)h(175)1069 1690 y(reduce)h(and)g(scatter,)f(186)1069
1736 y(reduce,)g(list)f(of)i(op)q(erations,)f(178)1069
1782 y(reduce,)g(user-de\014ned,)g(189)1069 1827 y(reduction,)f(175)
1069 1873 y(reduction)h(and)h(asso)q(ciativit)o(y)m(,)c(177)1069
1919 y(reduction)j(and)h(commutativit)o(y)m(,)e(177)1069
1964 y(remote)j(p)o(ro)q(cedure)e(call,)g(44)1069 2010
y(rendezvous,)f(17,)i(89)1069 2056 y(rep)o(resentation)f(conversion,)f
(16,)i(30)1069 2101 y(request)f(object,)h(50)1069 2147
y(request)f(object,)h(allo)q(cation)e(of,)i(52)1069 2193
y(request)f(object,)h(deallo)q(cation)e(of,)i(59)1069
2238 y(request,)f(inactive)f(vs)h(active,)g(86)1069 2284
y(request,)g(null)f(handle,)g(86)1069 2330 y(request,)h(p)q(ersistent,)
f(81)1069 2375 y(resource)i(limitations,)c(63)1069 2421
y(return)k(co)q(des,)f(12,)h(14)1069 2467 y(return)g(status,)e(23)p
eop
%%Page: 332 346
332 345 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(332)1344 b(Index)249 507 y Fq(ro)q(ot,)13
b(147)249 553 y(round-robin,)e(57)249 640 y(safe)i(p)o(rogram,)h(33)249
686 y(safet)o(y)m(,)e(32,)h(64,)g(195,)g(202)249 731
y(scalabilit)o(y)m(,)c(3)249 777 y(scan,)k(188)249 823
y(scan,)g(inclusiv)o(e)d(vs)i(exclusive,)e(189)249 868
y(scan,)j(segmented,)f(194)249 914 y(scan,)h(user-de\014ned,)e(189)249
960 y(scatter,)i(165)249 1005 y(scatter)g(and)g(gather,)g(173)249
1051 y(scatter,)g(vecto)o(r)f(va)o(riant,)g(167)249 1097
y(selection,)f(22)249 1142 y(self)h(message,)h(24)249
1188 y(self-t)o(yp)q(ed)e(message,)i(25)249 1234 y(semantics,)f(17,)h
(32)249 1279 y(semantics)f(of)h(collective,)d(195)249
1325 y(semantics,)i(nonblo)q(cking,)f(60)249 1371 y(send,)h(18)249
1416 y(send)g(bu\013er,)h(19)249 1462 y(send-receive,)e(44)249
1508 y(sequential)g(sto)o(rage,)i(134)249 1553 y(server,)f(and)h
(fairness,)e(70,)i(74)249 1599 y(sho)o(rt)g(p)o(roto)q(col,)f(65)249
1645 y(signal)f(safet)o(y)m(,)h(302)249 1690 y(source,)h(20,)f(23)249
1736 y(standa)o(rd)h(mo)q(de,)g(18,)g(32,)g(89)249 1782
y(sta)o(rvation,)f(38,)h(70,)g(74,)f(87)249 1827 y(status,)g(23,)h(25)
249 1873 y(status,)f(empt)o(y)m(,)g(86)249 1919 y(synchronization,)e
(147,)j(152)249 1964 y(synchronous)f(mo)q(de,)h(18,)g(89)249
2051 y(tag,)g(15,)g(20,)g(21,)g(23,)f(149)249 2097 y(tag,)h(upp)q(er)g
(b)q(ound,)f(287)249 2143 y(test-fo)o(r-completion,)f(17)249
2188 y(thread)i(safet)o(y)m(,)f(26,)h(302)249 2234 y(threads,)f(8,)h
(35,)g(49)249 2280 y(threads)g(and)g(collective,)d(198)249
2325 y(throttle)i(e\013ect,)h(33)249 2371 y(time)f(function,)f(290)249
2417 y(top)q(ology)m(,)h(253,)h(256)249 2462 y(top)q(ology)f(and)h
(intercommunicato)o(r,)f(253)249 2508 y(top)q(ology)m(,)g(Ca)o
(rtesian,)f(257)1069 507 y(top)q(ology)m(,)h(general)g(graph,)h(267)
1069 553 y(top)q(ology)m(,)f(overlapping,)f(255)1069
599 y(top)q(ology)m(,)h(virtual)f(vs)h(physical,)e(253)1069
644 y(t)o(w)o(o-phase)j(p)o(roto)q(col,)f(25)1069 690
y(t)o(yp)q(e)g(constructo)o(r,)g(101,)i(105)1069 736
y(t)o(yp)q(e)e(conversion,)g(30)1069 781 y(t)o(yp)q(e)g(map,)h(103)1069
827 y(t)o(yp)q(e)f(matching,)h(16,)f(26,)h(125,)g(150)1069
873 y(t)o(yp)q(e)f(signature,)g(103)1069 918 y(t)o(yp)q(ed)g(data,)h
(15)1069 1005 y(under\015o)o(w,)f(30)1069 1051 y(unpack,)g(101,)h(135)
1069 1097 y(upp)q(er)f(b)q(ound,)h(104,)g(131)1069 1142
y(user-de\014ned)e(op)q(erations,)h(189)1069 1188 y(user-de\014ned)f
(reduction,)h(192)1069 1275 y(wildca)o(rd,)f(22)1069
1321 y(wildca)o(rd)h(receive,)f(25)p eop
%%Page: 333 347
333 346 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 218 a FD(Constan)o(ts)17 b(Index)249
507 y Fz(MPI)p 320 507 11 2 v 13 w(2DOUBLE)p 502 507
V 13 w(PRECISION,)12 b(182)249 545 y(MPI)p 320 545 V
13 w(2INT,)g(182)249 582 y(MPI)p 320 582 V 13 w(2INTEGER,)f(182)249
619 y(MPI)p 320 619 V 13 w(2REAL,)g(182)249 657 y(MPI)p
320 657 V 13 w(ANY)p 411 657 V 14 w(SOUR)o(CE,)i(22,)e(36,)g(38,)g(76,)
g(78,)h(86,)299 694 y(288)249 731 y(MPI)p 320 731 V 13
w(ANY)p 411 731 V 14 w(T)m(A)o(G,)g(11,)f(23,)g(25,)g(76,)f(78,)h(86)
249 769 y(MPI)p 320 769 V 13 w(BAND,)h(178)249 806 y(MPI)p
320 806 V 13 w(BOR,)g(178)249 844 y(MPI)p 320 844 V 13
w(BOTTOM,)h(11,)e(13,)g(133{135)249 881 y(MPI)p 320 881
V 13 w(BSEND)p 455 881 V 12 w(O)o(VERHEAD,)j(97,)c(290)249
918 y(MPI)p 320 918 V 13 w(BX)o(OR,)i(178)249 956 y(MPI)p
320 956 V 13 w(BYTE,)g(19,)f(29,)g(30)249 993 y(MPI)p
320 993 V 13 w(CAR)m(T,)i(273)249 1030 y(MPI)p 320 1030
V 13 w(CHAR,)g(19,)d(30)249 1068 y(MPI)p 320 1068 V 13
w(CHARA)o(CTER,)k(19,)d(28,)g(30)249 1105 y(MPI)p 320
1105 V 13 w(COMM)p 449 1105 V 14 w(NULL,)g(220,)e(222,)g(223,)g(258,)h
(267)249 1142 y(MPI)p 320 1142 V 13 w(COMM)p 449 1142
V 14 w(SELF,)h(207,)g(231)249 1180 y(MPI)p 320 1180 V
13 w(COMM)p 449 1180 V 14 w(W)o(ORLD,)d(11,)g(21,)g(207,)f(217,)g(287,)
299 1217 y(293,)j(295)249 1254 y(MPI)p 320 1254 V 13
w(COMPLEX,)j(19)249 1292 y(MPI)p 320 1292 V 13 w(CONGR)o(UENT,)h(218,)c
(248)249 1329 y(MPI)p 320 1329 V 13 w(D)o(A)m(T)m(A)m(TYPE)p
526 1329 V 15 w(NULL,)i(124)249 1367 y(MPI)p 320 1367
V 13 w(DOUBLE,)g(19)249 1404 y(MPI)p 320 1404 V 13 w(DOUBLE)p
484 1404 V 13 w(COMPLEX,)i(20)249 1441 y(MPI)p 320 1441
V 13 w(DOUBLE)p 484 1441 V 13 w(INT,)e(182)249 1479 y(MPI)p
320 1479 V 13 w(DOUBLE)p 484 1479 V 13 w(PRECISION,)g(19)249
1516 y(MPI)p 320 1516 V 13 w(ERR)p 409 1516 V 12 w(AR)o(G,)g(299)249
1553 y(MPI)p 320 1553 V 13 w(ERR)p 409 1553 V 12 w(BUFFER,)g(299)249
1591 y(MPI)p 320 1591 V 13 w(ERR)p 409 1591 V 12 w(COMM,)i(299)249
1628 y(MPI)p 320 1628 V 13 w(ERR)p 409 1628 V 12 w(COUNT,)g(299)249
1665 y(MPI)p 320 1665 V 13 w(ERR)p 409 1665 V 12 w(DIMS,)e(299)249
1703 y(MPI)p 320 1703 V 13 w(ERR)p 409 1703 V 12 w(GR)o(OUP)m(,)h(299)
249 1740 y(MPI)p 320 1740 V 13 w(ERR)p 409 1740 V 12
w(IN)p 460 1740 V 13 w(ST)m(A)m(TUS,)g(70,)e(73,)g(298,)f(299)249
1778 y(MPI)p 320 1778 V 13 w(ERR)p 409 1778 V 12 w(INTERN,)j(299)249
1815 y(MPI)p 320 1815 V 13 w(ERR)p 409 1815 V 12 w(LASTCODE,)g(299)249
1852 y(MPI)p 320 1852 V 13 w(ERR)p 409 1852 V 12 w(OP)m(,)f(299)249
1890 y(MPI)p 320 1890 V 13 w(ERR)p 409 1890 V 12 w(OTHER,)h(299,)e(300)
249 1927 y(MPI)p 320 1927 V 13 w(ERR)p 409 1927 V 12
w(PENDING,)h(298,)f(299)249 1964 y(MPI)p 320 1964 V 13
w(ERR)p 409 1964 V 12 w(RANK,)i(299)249 2002 y(MPI)p
320 2002 V 13 w(ERR)p 409 2002 V 12 w(REQUEST,)g(299)249
2039 y(MPI)p 320 2039 V 13 w(ERR)p 409 2039 V 12 w(R)o(OOT,)g(299)249
2076 y(MPI)p 320 2076 V 13 w(ERR)p 409 2076 V 12 w(T)m(A)o(G,)g(299)249
2114 y(MPI)p 320 2114 V 13 w(ERR)p 409 2114 V 12 w(TOPOLOGY,)h(299)249
2151 y(MPI)p 320 2151 V 13 w(ERR)p 409 2151 V 12 w(TR)o(UNCA)m(TE,)h
(299)249 2188 y(MPI)p 320 2188 V 13 w(ERR)p 409 2188
V 12 w(TYPE,)e(299)249 2226 y(MPI)p 320 2226 V 13 w(ERR)p
409 2226 V 12 w(UNKNO)o(WN,)i(299,)10 b(300)249 2263
y(MPI)p 320 2263 V 13 w(ERRHANDLER)p 586 2263 V 14 w(NULL,)i(298)249
2301 y(MPI)p 320 2301 V 13 w(ERR)o(OR,)g(23)249 2338
y(MPI)p 320 2338 V 13 w(ERR)o(ORS)p 481 2338 V 12 w(ARE)p
569 2338 V 13 w(F)l(A)m(T)m(AL,)i(295)249 2375 y(MPI)p
320 2375 V 13 w(ERR)o(ORS)p 481 2375 V 12 w(RETURN,)f(295,)e(296)249
2413 y(MPI)p 320 2413 V 13 w(FLO)o(A)m(T,)i(19)249 2450
y(MPI)p 320 2450 V 13 w(FLO)o(A)m(T)p 452 2450 V 14 w(INT,)f(182)249
2487 y(MPI)p 320 2487 V 13 w(GRAPH,)g(273)1069 507 y(MPI)p
1140 507 V 13 w(GR)o(OUP)p 1283 507 V 13 w(EMPTY,)h(203,)d(212{214)1069
545 y(MPI)p 1140 545 V 13 w(GR)o(OUP)p 1283 545 V 13
w(NULL,)i(203,)f(216)1069 582 y(MPI)p 1140 582 V 13 w(HOST,)h(287,)f
(288)1069 619 y(MPI)p 1140 619 V 13 w(IDENT,)h(209,)e(218)1069
657 y(MPI)p 1140 657 V 13 w(INT,)i(19,)f(32,)g(103)1069
694 y(MPI)p 1140 694 V 13 w(INTEGER,)g(19,)g(32)1069
731 y(MPI)p 1140 731 V 13 w(INTEGER1,)g(20)1069 769 y(MPI)p
1140 769 V 13 w(INTEGER2,)g(20)1069 806 y(MPI)p 1140
806 V 13 w(INTEGER4,)g(20)1069 844 y(MPI)p 1140 844 V
13 w(IO,)g(287,)g(288)1069 881 y(MPI)p 1140 881 V 13
w(KEYV)l(AL)p 1300 881 V 14 w(INV)l(ALID,)h(232,)f(235)1069
918 y(MPI)p 1140 918 V 13 w(LAND,)h(178)1069 956 y(MPI)p
1140 956 V 13 w(LB,)f(130)1069 993 y(MPI)p 1140 993 V
13 w(LOGICAL,)h(19)1069 1030 y(MPI)p 1140 1030 V 13 w(LONG,)g(19)1069
1068 y(MPI)p 1140 1068 V 13 w(LONG)p 1256 1068 V 13 w(DOUBLE,)g(19)1069
1105 y(MPI)p 1140 1105 V 13 w(LONG)p 1256 1105 V 13 w(DOUBLE)p
1420 1105 V 13 w(INT,)h(182)1069 1142 y(MPI)p 1140 1142
V 13 w(LONG)p 1256 1142 V 13 w(INT,)f(182)1069 1180 y(MPI)p
1140 1180 V 13 w(LONG)p 1256 1180 V 13 w(LONG,)g(20)1069
1217 y(MPI)p 1140 1217 V 13 w(LOR,)g(178)1069 1254 y(MPI)p
1140 1254 V 13 w(LX)o(OR,)g(178)1069 1292 y(MPI)p 1140
1292 V 13 w(MAX,)g(177,)f(178)1069 1329 y(MPI)p 1140
1329 V 13 w(MAX)p 1237 1329 V 13 w(ERR)o(OR)p 1378 1329
V 14 w(STRING,)g(298)1069 1367 y(MPI)p 1140 1367 V 13
w(MAX)p 1237 1367 V 13 w(PR)o(OCESSOR)p 1468 1367 V 14
w(NAME,)h(289)1069 1404 y(MPI)p 1140 1404 V 13 w(MAXLOC,)h(178,)e(180,)
f(181,)h(185)1069 1441 y(MPI)p 1140 1441 V 13 w(MIN,)h(178)1069
1479 y(MPI)p 1140 1479 V 13 w(MINLOC,)h(178,)d(180,)h(181,)f(185)1069
1516 y(MPI)p 1140 1516 V 13 w(OP)p 1204 1516 V 13 w(NULL,)i(192)1069
1553 y(MPI)p 1140 1553 V 13 w(P)m(A)o(CKED,)h(19,)d(20,)h(138{140)1069
1591 y(MPI)p 1140 1591 V 13 w(PENDING,)g(70)1069 1628
y(MPI)p 1140 1628 V 13 w(PR)o(OC)p 1254 1628 V 13 w(NULL,)i(47,)e(262,)
f(264,)h(287,)f(288)1069 1665 y(MPI)p 1140 1665 V 13
w(PR)o(OD,)i(178)1069 1703 y(MPI)p 1140 1703 V 13 w(REAL,)g(19)1069
1740 y(MPI)p 1140 1740 V 13 w(REAL2,)f(20)1069 1778 y(MPI)p
1140 1778 V 13 w(REAL4,)g(20)1069 1815 y(MPI)p 1140 1815
V 13 w(REAL8,)g(20)1069 1852 y(MPI)p 1140 1852 V 13 w(REQUEST)p
1325 1852 V 13 w(NULL,)k(53,)g(59,)f(68,)g(70,)g(71,)1119
1890 y(73,)d(86)1069 1927 y(MPI)p 1140 1927 V 13 w(SHOR)m(T,)h(19)1069
1964 y(MPI)p 1140 1964 V 13 w(SHOR)m(T)p 1274 1964 V
13 w(INT,)g(182)1069 2002 y(MPI)p 1140 2002 V 13 w(SIMILAR,)f(209,)f
(218,)h(248)1069 2039 y(MPI)p 1140 2039 V 13 w(SOUR)o(CE,)h(23)1069
2076 y(MPI)p 1140 2076 V 13 w(ST)m(A)m(TUS)p 1289 2076
V 13 w(SIZE,)f(23)1069 2114 y(MPI)p 1140 2114 V 13 w(SUCCESS,)g(12,)g
(70,)g(73,)g(233,)f(298{300)1069 2151 y(MPI)p 1140 2151
V 13 w(SUM,)i(178)1069 2188 y(MPI)p 1140 2188 V 13 w(T)m(A)o(G,)g(23)
1069 2226 y(MPI)p 1140 2226 V 13 w(T)m(A)o(G)p 1228 2226
V 13 w(UB,)g(21,)f(287,)f(288)1069 2263 y(MPI)p 1140
2263 V 13 w(UB,)i(130)1069 2301 y(MPI)p 1140 2301 V 13
w(UNDEFINED,)c(24,)g(68,)g(87,)g(126,)g(272,)g(273)1069
2338 y(MPI)p 1140 2338 V 13 w(UNEQUAL,)13 b(209,)e(218,)f(248)1069
2375 y(MPI)p 1140 2375 V 13 w(UNSIGNED,)h(19)1069 2413
y(MPI)p 1140 2413 V 13 w(UNSIGNED)p 1343 2413 V 13 w(CHAR,)h(19)1069
2450 y(MPI)p 1140 2450 V 13 w(UNSIGNED)p 1343 2450 V
13 w(LONG,)g(19)1069 2487 y(MPI)p 1140 2487 V 13 w(UNSIGNED)p
1343 2487 V 13 w(SHOR)m(T,)g(19)p eop
%%Page: 334 348
334 347 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(334)1163 b(Constan)o(ts)14 b(Index)249
507 y Fz(MPI)p 320 507 11 2 v 13 w(WTIME)p 463 507 V
13 w(IS)p 509 507 V 12 w(GLOBAL,)e(287{290)p eop
%%Page: 335 349
335 348 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 218 a FD(F)l(unction)18 b(Index)249 507
y Fz(MPI)p 320 507 11 2 v 13 w(ABOR)m(T,)13 b(293)249
545 y(MPI)p 320 545 V 13 w(ADDRESS,)e(128)249 582 y(MPI)p
320 582 V 13 w(ALLGA)m(THER,)i(170)249 619 y(MPI)p 320
619 V 13 w(ALLGA)m(THER)l(V,)g(172)249 657 y(MPI)p 320
657 V 13 w(ALLREDUCE,)g(185)249 694 y(MPI)p 320 694 V
13 w(ALL)m(TO)o(ALL,)g(173)249 731 y(MPI)p 320 731 V
13 w(ALL)m(TO)o(ALL)l(V,)h(174)249 769 y(MPI)p 320 769
V 13 w(A)m(TTR)p 432 769 V 14 w(DELETE,)e(237)249 806
y(MPI)p 320 806 V 13 w(A)m(TTR)p 432 806 V 14 w(GET,)g(236)249
844 y(MPI)p 320 844 V 13 w(A)m(TTR)p 432 844 V 14 w(PUT,)g(235)249
881 y(MPI)p 320 881 V 13 w(BARRIER,)f(152)249 918 y(MPI)p
320 918 V 13 w(BCAST,)h(152)249 956 y(MPI)p 320 956 V
13 w(BSEND)f(,)h(90)249 993 y(MPI)p 320 993 V 13 w(BSEND)p
455 993 V 12 w(INIT,)g(93)249 1030 y(MPI)p 320 1030 V
13 w(BUFFER)p 480 1030 V 13 w(A)m(TT)m(A)o(CH,)i(95)249
1068 y(MPI)p 320 1068 V 13 w(BUFFER)p 480 1068 V 13 w(DET)m(A)o(CH,)f
(96)249 1105 y(MPI)p 320 1105 V 13 w(CANCEL,)g(79)249
1142 y(MPI)p 320 1142 V 13 w(CAR)m(T)p 432 1142 V 14
w(COORDS,)f(261)249 1180 y(MPI)p 320 1180 V 13 w(CAR)m(T)p
432 1180 V 14 w(CREA)m(TE,)h(257)249 1217 y(MPI)p 320
1217 V 13 w(CAR)m(T)p 432 1217 V 14 w(GET,)f(260)249
1254 y(MPI)p 320 1254 V 13 w(CAR)m(T)p 432 1254 V 14
w(MAP)m(,)g(266)249 1292 y(MPI)p 320 1292 V 13 w(CAR)m(T)p
432 1292 V 14 w(RANK,)h(260)249 1329 y(MPI)p 320 1329
V 13 w(CAR)m(T)p 432 1329 V 14 w(SHIFT,)f(262)249 1367
y(MPI)p 320 1367 V 13 w(CAR)m(T)p 432 1367 V 14 w(SUB,)f(265)249
1404 y(MPI)p 320 1404 V 13 w(CAR)m(TDIM)p 504 1404 V
14 w(GET,)h(259)249 1441 y(MPI)p 320 1441 V 13 w(COMM)p
449 1441 V 14 w(COMP)m(ARE,)h(218)249 1479 y(MPI)p 320
1479 V 13 w(COMM)p 449 1479 V 14 w(CREA)m(TE,)g(220)249
1516 y(MPI)p 320 1516 V 13 w(COMM)p 449 1516 V 14 w(DUP)m(,)f(219)249
1553 y(MPI)p 320 1553 V 13 w(COMM)p 449 1553 V 14 w(FREE,)g(223)249
1591 y(MPI)p 320 1591 V 13 w(COMM)p 449 1591 V 14 w(GR)o(OUP)m(,)g(210)
249 1628 y(MPI)p 320 1628 V 13 w(COMM)p 449 1628 V 14
w(RANK,)h(217)249 1665 y(MPI)p 320 1665 V 13 w(COMM)p
449 1665 V 14 w(REMOTE)p 621 1665 V 14 w(GR)o(OUP)m(,)f(248)249
1703 y(MPI)p 320 1703 V 13 w(COMM)p 449 1703 V 14 w(REMOTE)p
621 1703 V 14 w(SIZE,)e(248)249 1740 y(MPI)p 320 1740
V 13 w(COMM)p 449 1740 V 14 w(SIZE,)g(217)249 1778 y(MPI)p
320 1778 V 13 w(COMM)p 449 1778 V 14 w(SPLIT,)h(221)249
1815 y(MPI)p 320 1815 V 13 w(COMM)p 449 1815 V 14 w(TEST)p
557 1815 V 13 w(INTER,)h(247)249 1852 y(MPI)p 320 1852
V 13 w(DIMS)p 425 1852 V 12 w(CREA)m(TE,)h(258)249 1890
y(MPI)p 320 1890 V 13 w(ERRHANDLER)p 586 1890 V 14 w(CREA)m(TE,)g(296)
249 1927 y(MPI)p 320 1927 V 13 w(ERRHANDLER)p 586 1927
V 14 w(FREE,)e(297)249 1964 y(MPI)p 320 1964 V 13 w(ERRHANDLER)p
586 1964 V 14 w(GET,)g(297)249 2002 y(MPI)p 320 2002
V 13 w(ERRHANDLER)p 586 2002 V 14 w(SET,)g(297)249 2039
y(MPI)p 320 2039 V 13 w(ERR)o(OR)p 461 2039 V 13 w(CLASS,)h(300)249
2076 y(MPI)p 320 2076 V 13 w(ERR)o(OR)p 461 2076 V 13
w(STRING,)f(298)249 2114 y(MPI)p 320 2114 V 13 w(FINALIZE,)g(292)249
2151 y(MPI)p 320 2151 V 13 w(GA)m(THER)i(,)e(154)249
2188 y(MPI)p 320 2188 V 13 w(GA)m(THER)l(V)i(,)f(157)249
2226 y(MPI)p 320 2226 V 13 w(GET)p 410 2226 V 13 w(COUNT,)h(24)249
2263 y(MPI)p 320 2263 V 13 w(GET)p 410 2263 V 13 w(ELEMENTS,)f(126)249
2301 y(MPI)p 320 2301 V 13 w(GET)p 410 2301 V 13 w(PR)o(OCESSOR)p
641 2301 V 13 w(NAME,)h(289)249 2338 y(MPI)p 320 2338
V 13 w(GRAPH)p 463 2338 V 13 w(CREA)m(TE,)g(267)249 2375
y(MPI)p 320 2375 V 13 w(GRAPH)p 463 2375 V 13 w(GET,)f(270)249
2413 y(MPI)p 320 2413 V 13 w(GRAPH)p 463 2413 V 13 w(MAP)m(,)g(272)249
2450 y(MPI)p 320 2450 V 13 w(GRAPH)p 463 2450 V 13 w(NEIGHBORS,)g(271)
249 2487 y(MPI)p 320 2487 V 13 w(GRAPH)p 463 2487 V 13
w(NEIGHBORS)p 691 2487 V 13 w(COUNT,)i(270)1069 507 y(MPI)p
1140 507 V 13 w(GRAPHDIMS)p 1375 507 V 12 w(GET,)e(269)1069
545 y(MPI)p 1140 545 V 13 w(GR)o(OUP)p 1283 545 V 13
w(COMP)m(ARE,)h(209)1069 582 y(MPI)p 1140 582 V 13 w(GR)o(OUP)p
1283 582 V 13 w(DIFFERENCE,)f(211)1069 619 y(MPI)p 1140
619 V 13 w(GR)o(OUP)p 1283 619 V 13 w(EX)o(CL,)g(213)1069
657 y(MPI)p 1140 657 V 13 w(GR)o(OUP)p 1283 657 V 13
w(FREE,)f(216)1069 694 y(MPI)p 1140 694 V 13 w(GR)o(OUP)p
1283 694 V 13 w(INCL,)h(212)1069 731 y(MPI)p 1140 731
V 13 w(GR)o(OUP)p 1283 731 V 13 w(INTERSECTION,)h(211)1069
769 y(MPI)p 1140 769 V 13 w(GR)o(OUP)p 1283 769 V 13
w(RANGE)p 1426 769 V 13 w(EX)o(CL,)g(215)1069 806 y(MPI)p
1140 806 V 13 w(GR)o(OUP)p 1283 806 V 13 w(RANGE)p 1426
806 V 13 w(INCL,)f(214)1069 844 y(MPI)p 1140 844 V 13
w(GR)o(OUP)p 1283 844 V 13 w(RANK,)h(208)1069 881 y(MPI)p
1140 881 V 13 w(GR)o(OUP)p 1283 881 V 13 w(SIZE,)d(208)1069
918 y(MPI)p 1140 918 V 13 w(GR)o(OUP)p 1283 918 V 13
w(TRANSLA)m(TE)p 1513 918 V 14 w(RANKS)j(,)f(208)1069
956 y(MPI)p 1140 956 V 13 w(GR)o(OUP)p 1283 956 V 13
w(UNION,)h(211)1069 993 y(MPI)p 1140 993 V 13 w(IBSEND,)e(92)1069
1030 y(MPI)p 1140 1030 V 13 w(INIT,)h(291)1069 1068 y(MPI)p
1140 1068 V 13 w(INITIALIZED,)f(292)1069 1105 y(MPI)p
1140 1105 V 13 w(INTER)o(COMM)p 1382 1105 V 14 w(CREA)m(TE,)i(249)1069
1142 y(MPI)p 1140 1142 V 13 w(INTER)o(COMM)p 1382 1142
V 14 w(MER)o(GE,)f(250)1069 1180 y(MPI)p 1140 1180 V
13 w(IPR)o(OBE,)f(76)1069 1217 y(MPI)p 1140 1217 V 13
w(IRECV)h(,)g(51)1069 1254 y(MPI)p 1140 1254 V 13 w(IRSEND,)f(93)1069
1292 y(MPI)p 1140 1292 V 13 w(ISEND,)g(51)1069 1329 y(MPI)p
1140 1329 V 13 w(ISSEND,)f(92)1069 1367 y(MPI)p 1140
1367 V 13 w(KEYV)l(AL)p 1300 1367 V 14 w(CREA)m(TE,)j(232)1069
1404 y(MPI)p 1140 1404 V 13 w(KEYV)l(AL)p 1300 1404 V
14 w(FREE,)f(235)1069 1441 y(MPI)p 1140 1441 V 13 w(OP)p
1204 1441 V 13 w(CREA)m(TE,)h(189)1069 1479 y(MPI)p 1140
1479 V 13 w(OP)p 1204 1479 V 13 w(FREE,)e(192)1069 1516
y(MPI)p 1140 1516 V 13 w(P)m(A)o(CK,)i(136)1069 1553
y(MPI)p 1140 1553 V 13 w(P)m(A)o(CK)p 1251 1553 V 14
w(SIZE,)d(140)1069 1591 y(MPI)p 1140 1591 V 13 w(PCONTR)o(OL,)j(305)
1069 1628 y(MPI)p 1140 1628 V 13 w(PR)o(OBE,)f(76)1069
1665 y(MPI)p 1140 1665 V 13 w(RECV)g(,)g(22)1069 1703
y(MPI)p 1140 1703 V 13 w(RECV)p 1254 1703 V 13 w(INIT,)g(82)1069
1740 y(MPI)p 1140 1740 V 13 w(REDUCE,)g(175)1069 1778
y(MPI)p 1140 1778 V 13 w(REDUCE)p 1305 1778 V 13 w(SCA)m(TTER,)h(186)
1069 1815 y(MPI)p 1140 1815 V 13 w(REQUEST)p 1325 1815
V 13 w(FREE,)f(59)1069 1852 y(MPI)p 1140 1852 V 13 w(RSEND)f(,)h(91)
1069 1890 y(MPI)p 1140 1890 V 13 w(RSEND)p 1276 1890
V 12 w(INIT,)g(94)1069 1927 y(MPI)p 1140 1927 V 13 w(SCAN,)g(188)1069
1964 y(MPI)p 1140 1964 V 13 w(SCA)m(TTER,)h(165)1069
2002 y(MPI)p 1140 2002 V 13 w(SCA)m(TTER)l(V,)g(167)1069
2039 y(MPI)p 1140 2039 V 13 w(SEND,)e(18)1069 2076 y(MPI)p
1140 2076 V 13 w(SEND)p 1250 2076 V 12 w(INIT,)h(81)1069
2114 y(MPI)p 1140 2114 V 13 w(SENDRECV,)g(45)1069 2151
y(MPI)p 1140 2151 V 13 w(SENDRECV)p 1351 2151 V 13 w(REPLA)o(CE,)h(46)
1069 2188 y(MPI)p 1140 2188 V 13 w(SSEND)e(,)h(90)1069
2226 y(MPI)p 1140 2226 V 13 w(SSEND)p 1270 2226 V 12
w(INIT,)g(94)1069 2263 y(MPI)p 1140 2263 V 13 w(ST)m(AR)m(T,)g(82)1069
2301 y(MPI)p 1140 2301 V 13 w(ST)m(AR)m(T)m(ALL,)h(83)1069
2338 y(MPI)p 1140 2338 V 13 w(TEST,)f(53)1069 2375 y(MPI)p
1140 2375 V 13 w(TEST)p 1247 2375 V 13 w(CANCELLED,)h(80)1069
2413 y(MPI)p 1140 2413 V 13 w(TEST)m(ALL,)f(71)1069 2450
y(MPI)p 1140 2450 V 13 w(TEST)m(ANY,)h(68)1069 2487 y(MPI)p
1140 2487 V 13 w(TESTSOME,)f(73)p eop
%%Page: 336 350
336 349 bop 2 223 2 150 v 2 76 150 2 v 1841 76 V 1988
225 2 150 v 249 251 a Fv(336)1183 b(F)m(unction)15 b(Index)249
507 y Fz(MPI)p 320 507 11 2 v 13 w(TOPO)p 436 507 V 14
w(TEST,)d(273)249 545 y(MPI)p 320 545 V 13 w(TYPE)p 432
545 V 13 w(COMMIT,)i(123)249 582 y(MPI)p 320 582 V 13
w(TYPE)p 432 582 V 13 w(CONTIGUOUS,)g(106)249 619 y(MPI)p
320 619 V 13 w(TYPE)p 432 619 V 13 w(EXTENT,)g(104)249
657 y(MPI)p 320 657 V 13 w(TYPE)p 432 657 V 13 w(FREE,)e(124)249
694 y(MPI)p 320 694 V 13 w(TYPE)p 432 694 V 13 w(HINDEXED,)h(116)249
731 y(MPI)p 320 731 V 13 w(TYPE)p 432 731 V 13 w(HVECTOR,)h(109)249
769 y(MPI)p 320 769 V 13 w(TYPE)p 432 769 V 13 w(INDEXED,)e(114)249
806 y(MPI)p 320 806 V 13 w(TYPE)p 432 806 V 13 w(LB,)g(132)249
844 y(MPI)p 320 844 V 13 w(TYPE)p 432 844 V 13 w(SIZE,)f(105)249
881 y(MPI)p 320 881 V 13 w(TYPE)p 432 881 V 13 w(STR)o(UCT,)i(118)249
918 y(MPI)p 320 918 V 13 w(TYPE)p 432 918 V 13 w(UB,)f(133)249
956 y(MPI)p 320 956 V 13 w(TYPE)p 432 956 V 13 w(VECTOR,)i(107)249
993 y(MPI)p 320 993 V 13 w(UNP)m(A)o(CK,)g(136)249 1030
y(MPI)p 320 1030 V 13 w(W)l(AIT,)e(52)249 1068 y(MPI)p
320 1068 V 13 w(W)l(AIT)m(ALL,)h(70)249 1105 y(MPI)p
320 1105 V 13 w(W)l(AIT)m(ANY)h(,)d(67)249 1142 y(MPI)p
320 1142 V 13 w(W)l(AITSOME,)i(72)249 1180 y(MPI)p 320
1180 V 13 w(WTICK,)g(291)249 1217 y(MPI)p 320 1217 V
13 w(WTIME,)f(290)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
